var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function t(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}function r(e,t){return Object.keys(t).forEach((function(r){"default"===r||"__esModule"===r||e.hasOwnProperty(r)||Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[r]}})})),e}var i={},n={},s=e.parcelRequire94c2;null==s&&((s=function(e){if(e in i)return i[e].exports;if(e in n){var t=n[e];delete n[e];var r={id:e,exports:{}};return i[e]=r,t.call(r.exports,r,r.exports),r.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){n[e]=t},e.parcelRequire94c2=s),s.register("bHyGd",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OrthographicCameraControls=e.exports.OrthographicCamera=e.exports.PerspectiveCameraControls=e.exports.PerspectiveCamera=e.exports.AbstractCamera=e.exports.HTMLElementAnchorData=e.exports.HTMLElementAnchorImageData=e.exports.HTMLElementAnchorTextData=e.exports.HTMLElementAnchorCustomData=e.exports.TEXTURE_FILTERING=e.exports.TEXTURE_WRAPPING=e.exports.MATERIAL_SHADING=e.exports.MATERIAL_ALPHA=e.exports.MATERIAL_SIDE=e.exports.MapData=e.exports.MaterialSpecularGlossinessData=e.exports.MaterialUnlitData=e.exports.AbstractMaterialData=e.exports.MaterialData=e.exports.MaterialStandardData=e.exports.SessionOutputData=e.exports.SessionData=e.exports.AnimationData=e.exports.GeometryData=e.exports.CustomData=e.exports.ThreejsData=e.exports.AbstractTreeNodeData=e.exports.TreeNode=e.exports.Tree=e.exports.FileParameter=e.exports.Output=e.exports.Export=e.exports.Parameter=e.exports.Session=e.exports.TONE_MAPPING=e.exports.TEXTURE_ENCODING=e.exports.ENVIRONMENT_MAP_CUBE=e.exports.ENVIRONMENT_MAP=e.exports.PARAMETERVISUALIZATION=e.exports.PARAMETERTYPE=e.exports.EXPORTTYPE=e.exports.EVENTTYPE=e.exports.LOGGINGLEVEL=e.exports.VISIBILITYMODE=e.exports.LIGHTTYPE=e.exports.ORTHOGRAPHIC_CAMERA_DIRECTION=e.exports.CAMERATYPE=e.exports.RENDERERTYPE=e.exports.settingsEngine=e.exports.api=void 0,e.exports.GLTFConverter=e.exports.GeometryEngine=e.exports.MaterialEngine=e.exports.DataEngine=e.exports.JUSTIFICATION=e.exports.TASKTYPE=e.exports.ATTRIBUTEVISUALIZATION=e.exports.SDTFAttributeVisualization=e.exports.GEOMETRYTYPEHINT=e.exports.PRIMITIVETYPEHINT=e.exports.SDTFAttributesData=e.exports.SDTFItemData=e.exports.SDTFAttributeOverview=e.exports.SDTFAttributeData=e.exports.AbstractLight=e.exports.LightScene=e.exports.SpotLight=e.exports.PointLight=e.exports.HemisphereLight=e.exports.DirectionalLight=e.exports.AmbientLight=void 0,s("chucq");var r=s("dk8Lz");Object.defineProperty(e.exports,"CAMERATYPE",{enumerable:!0,get:function(){return r.CAMERATYPE}}),Object.defineProperty(e.exports,"ORTHOGRAPHIC_CAMERA_DIRECTION",{enumerable:!0,get:function(){return r.ORTHOGRAPHIC_CAMERA_DIRECTION}}),s("yoicn");var i=s("bJEmL"),n=s("eAhLl");Object.defineProperty(e.exports,"LIGHTTYPE",{enumerable:!0,get:function(){return n.LIGHTTYPE}});var o=s("iBhyF");Object.defineProperty(e.exports,"RENDERERTYPE",{enumerable:!0,get:function(){return o.RENDERERTYPE}}),Object.defineProperty(e.exports,"TEXTURE_ENCODING",{enumerable:!0,get:function(){return o.TEXTURE_ENCODING}}),Object.defineProperty(e.exports,"TONE_MAPPING",{enumerable:!0,get:function(){return o.TONE_MAPPING}}),Object.defineProperty(e.exports,"VISIBILITYMODE",{enumerable:!0,get:function(){return o.VISIBILITYMODE}});var a=s("eYU63");Object.defineProperty(e.exports,"AbstractTreeNodeData",{enumerable:!0,get:function(){return a.AbstractTreeNodeData}}),Object.defineProperty(e.exports,"Tree",{enumerable:!0,get:function(){return a.Tree}}),Object.defineProperty(e.exports,"TreeNode",{enumerable:!0,get:function(){return a.TreeNode}});var l=s("iqwE1");Object.defineProperty(e.exports,"ENVIRONMENT_MAP",{enumerable:!0,get:function(){return l.ENVIRONMENT_MAP}}),Object.defineProperty(e.exports,"ENVIRONMENT_MAP_CUBE",{enumerable:!0,get:function(){return l.ENVIRONMENT_MAP_CUBE}}),Object.defineProperty(e.exports,"ThreejsData",{enumerable:!0,get:function(){return l.ThreejsData}});var c=s("12eGO");Object.defineProperty(e.exports,"CustomData",{enumerable:!0,get:function(){return c.CustomData}}),Object.defineProperty(e.exports,"GeometryData",{enumerable:!0,get:function(){return c.GeometryData}}),Object.defineProperty(e.exports,"MaterialStandardData",{enumerable:!0,get:function(){return c.MaterialStandardData}}),Object.defineProperty(e.exports,"MaterialData",{enumerable:!0,get:function(){return c.MaterialStandardData}}),Object.defineProperty(e.exports,"SDTFAttributeData",{enumerable:!0,get:function(){return c.SDTFAttributeData}}),Object.defineProperty(e.exports,"SDTFAttributeOverview",{enumerable:!0,get:function(){return c.SDTFAttributeOverview}}),Object.defineProperty(e.exports,"SDTFItemData",{enumerable:!0,get:function(){return c.SDTFItemData}}),Object.defineProperty(e.exports,"SDTFAttributesData",{enumerable:!0,get:function(){return c.SDTFAttributesData}}),Object.defineProperty(e.exports,"PRIMITIVETYPEHINT",{enumerable:!0,get:function(){return c.PRIMITIVETYPEHINT}}),Object.defineProperty(e.exports,"GEOMETRYTYPEHINT",{enumerable:!0,get:function(){return c.GEOMETRYTYPEHINT}}),Object.defineProperty(e.exports,"SDTFAttributeVisualization",{enumerable:!0,get:function(){return c.SDTFAttributeVisualization}}),Object.defineProperty(e.exports,"ATTRIBUTEVISUALIZATION",{enumerable:!0,get:function(){return c.ATTRIBUTEVISUALIZATION}}),Object.defineProperty(e.exports,"AnimationData",{enumerable:!0,get:function(){return c.AnimationData}}),Object.defineProperty(e.exports,"MATERIAL_ALPHA",{enumerable:!0,get:function(){return c.MATERIAL_ALPHA}}),Object.defineProperty(e.exports,"HTMLElementAnchorData",{enumerable:!0,get:function(){return c.HTMLElementAnchorData}}),Object.defineProperty(e.exports,"HTMLElementAnchorCustomData",{enumerable:!0,get:function(){return c.HTMLElementAnchorCustomData}}),Object.defineProperty(e.exports,"HTMLElementAnchorImageData",{enumerable:!0,get:function(){return c.HTMLElementAnchorImageData}}),Object.defineProperty(e.exports,"HTMLElementAnchorTextData",{enumerable:!0,get:function(){return c.HTMLElementAnchorTextData}}),Object.defineProperty(e.exports,"TASKTYPE",{enumerable:!0,get:function(){return c.TASKTYPE}}),Object.defineProperty(e.exports,"AbstractMaterialData",{enumerable:!0,get:function(){return c.AbstractMaterialData}}),Object.defineProperty(e.exports,"MapData",{enumerable:!0,get:function(){return c.MapData}}),Object.defineProperty(e.exports,"MATERIAL_SHADING",{enumerable:!0,get:function(){return c.MATERIAL_SHADING}}),Object.defineProperty(e.exports,"MATERIAL_SIDE",{enumerable:!0,get:function(){return c.MATERIAL_SIDE}}),Object.defineProperty(e.exports,"MaterialSpecularGlossinessData",{enumerable:!0,get:function(){return c.MaterialSpecularGlossinessData}}),Object.defineProperty(e.exports,"TEXTURE_FILTERING",{enumerable:!0,get:function(){return c.TEXTURE_FILTERING}}),Object.defineProperty(e.exports,"TEXTURE_WRAPPING",{enumerable:!0,get:function(){return c.TEXTURE_WRAPPING}}),Object.defineProperty(e.exports,"MaterialUnlitData",{enumerable:!0,get:function(){return c.MaterialUnlitData}});var u=s("cTTbu");Object.defineProperty(e.exports,"EVENTTYPE",{enumerable:!0,get:function(){return u.EVENTTYPE}}),Object.defineProperty(e.exports,"LOGGINGLEVEL",{enumerable:!0,get:function(){return u.LOGGINGLEVEL}});var h=s("dxpc0");Object.defineProperty(e.exports,"SessionData",{enumerable:!0,get:function(){return h.SessionData}}),Object.defineProperty(e.exports,"SessionOutputData",{enumerable:!0,get:function(){return h.SessionOutputData}});var d=s("l1HmL");Object.defineProperty(e.exports,"EXPORTTYPE",{enumerable:!0,get:function(){return d.ShapeDiverResponseExportDefinitionType}});var f=s("83NaM"),p=s("7BRF7");Object.defineProperty(e.exports,"Output",{enumerable:!0,get:function(){return p.Output}});var m=s("6OpRx");Object.defineProperty(e.exports,"Export",{enumerable:!0,get:function(){return m.Export}});var g=s("a83DK");Object.defineProperty(e.exports,"Session",{enumerable:!0,get:function(){return g.Session}});var v=s("kMmf7");Object.defineProperty(e.exports,"PerspectiveCameraControls",{enumerable:!0,get:function(){return v.PerspectiveCameraControls}});var _=s("5Ayxh");Object.defineProperty(e.exports,"OrthographicCamera",{enumerable:!0,get:function(){return _.OrthographicCamera}});var b=s("gtDbi");Object.defineProperty(e.exports,"PerspectiveCamera",{enumerable:!0,get:function(){return b.PerspectiveCamera}});var y=s("egF79");Object.defineProperty(e.exports,"OrthographicCameraControls",{enumerable:!0,get:function(){return y.OrthographicCameraControls}});var E=s("hTsEN");Object.defineProperty(e.exports,"AmbientLight",{enumerable:!0,get:function(){return E.AmbientLight}});var w=s("lXtIC");Object.defineProperty(e.exports,"DirectionalLight",{enumerable:!0,get:function(){return w.DirectionalLight}});var x=s("9Tlc8");Object.defineProperty(e.exports,"HemisphereLight",{enumerable:!0,get:function(){return x.HemisphereLight}});var A=s("4ADnQ");Object.defineProperty(e.exports,"PointLight",{enumerable:!0,get:function(){return A.PointLight}});var T=s("6BHFq");Object.defineProperty(e.exports,"SpotLight",{enumerable:!0,get:function(){return T.SpotLight}});var S=s("e1rbB");Object.defineProperty(e.exports,"LightScene",{enumerable:!0,get:function(){return S.LightScene}});var M=s("76DG9");Object.defineProperty(e.exports,"Parameter",{enumerable:!0,get:function(){return M.Parameter}}),Object.defineProperty(e.exports,"PARAMETERTYPE",{enumerable:!0,get:function(){return M.PARAMETERTYPE}}),Object.defineProperty(e.exports,"PARAMETERVISUALIZATION",{enumerable:!0,get:function(){return M.PARAMETERVISUALIZATION}});var C=s("czgB9");Object.defineProperty(e.exports,"FileParameter",{enumerable:!0,get:function(){return C.FileParameter}});var R=s("lDtT6");Object.defineProperty(e.exports,"AbstractLight",{enumerable:!0,get:function(){return R.AbstractLight}});var I=s("8uSp9");Object.defineProperty(e.exports,"AbstractCamera",{enumerable:!0,get:function(){return I.AbstractCamera}});var O=s("1BiQ9");Object.defineProperty(e.exports,"JUSTIFICATION",{enumerable:!0,get:function(){return O.JUSTIFICATION}});var P=s("6TMyR");Object.defineProperty(e.exports,"GeometryEngine",{enumerable:!0,get:function(){return P.GeometryEngine}});var k=s("kO6pq");Object.defineProperty(e.exports,"GLTFConverter",{enumerable:!0,get:function(){return k.GLTFConverter}});var L=s("fcs0K");Object.defineProperty(e.exports,"DataEngine",{enumerable:!0,get:function(){return L.DataEngine}});var N=s("loGDz");Object.defineProperty(e.exports,"MaterialEngine",{enumerable:!0,get:function(){return N.MaterialEngine}}),e.exports.api=i.instance.resolve(f.Api),e.exports.settingsEngine=i.instance.resolve(u.SettingsEngine)})),s.register("chucq",(function(t,r){var i,n=s("hPtJY");
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */!function(t){!function(r){var i="object"==typeof e?e:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),s=o(t);function o(e,t){return function(r,i){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:i}),t&&t(r,i)}}void 0===i.Reflect?i.Reflect=t:s=o(i.Reflect,s),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,i=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",s=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,l=!o&&!a,c={create:o?function(){return ne(Object.create(null))}:a?function(){return ne({__proto__:null})}:function(){return ne({})},has:l?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:l?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),h="object"==typeof n&&n.env&&!1,d=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?te():Map,f=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?re():Set,p=new(h||"function"!=typeof WeakMap?ie():WeakMap);function m(e,t,r,i){if(G(r)){if(!H(e))throw new TypeError;if(!Y(t))throw new TypeError;return T(e,t)}if(!H(e))throw new TypeError;if(!V(t))throw new TypeError;if(!V(i)&&!G(i)&&!D(i))throw new TypeError;return D(i)&&(i=void 0),S(e,t,r=W(r),i)}function g(e,t){function r(r,i){if(!V(r))throw new TypeError;if(!G(i)&&!q(i))throw new TypeError;P(e,t,r,i)}return r}function v(e,t,r,i){if(!V(r))throw new TypeError;return G(i)||(i=W(i)),P(e,t,r,i)}function _(e,t,r){if(!V(t))throw new TypeError;return G(r)||(r=W(r)),C(e,t,r)}function b(e,t,r){if(!V(t))throw new TypeError;return G(r)||(r=W(r)),R(e,t,r)}function y(e,t,r){if(!V(t))throw new TypeError;return G(r)||(r=W(r)),I(e,t,r)}function E(e,t,r){if(!V(t))throw new TypeError;return G(r)||(r=W(r)),O(e,t,r)}function w(e,t){if(!V(e))throw new TypeError;return G(t)||(t=W(t)),k(e,t)}function x(e,t){if(!V(e))throw new TypeError;return G(t)||(t=W(t)),L(e,t)}function A(e,t,r){if(!V(t))throw new TypeError;G(r)||(r=W(r));var i=M(t,r,!1);if(G(i))return!1;if(!i.delete(e))return!1;if(i.size>0)return!0;var n=p.get(t);return n.delete(r),n.size>0||p.delete(t),!0}function T(e,t){for(var r=e.length-1;r>=0;--r){var i=(0,e[r])(t);if(!G(i)&&!D(i)){if(!Y(i))throw new TypeError;t=i}}return t}function S(e,t,r,i){for(var n=e.length-1;n>=0;--n){var s=(0,e[n])(t,r,i);if(!G(s)&&!D(s)){if(!V(s))throw new TypeError;i=s}}return i}function M(e,t,r){var i=p.get(e);if(G(i)){if(!r)return;i=new d,p.set(e,i)}var n=i.get(t);if(G(n)){if(!r)return;n=new d,i.set(t,n)}return n}function C(e,t,r){if(R(e,t,r))return!0;var i=ee(t);return!D(i)&&C(e,i,r)}function R(e,t,r){var i=M(t,r,!1);return!G(i)&&j(i.has(e))}function I(e,t,r){if(R(e,t,r))return O(e,t,r);var i=ee(t);return D(i)?void 0:I(e,i,r)}function O(e,t,r){var i=M(t,r,!1);if(!G(i))return i.get(e)}function P(e,t,r,i){M(r,i,!0).set(e,t)}function k(e,t){var r=L(e,t),i=ee(e);if(null===i)return r;var n=k(i,t);if(n.length<=0)return r;if(r.length<=0)return n;for(var s=new f,o=[],a=0,l=r;a<l.length;a++){var c=l[a];s.has(c)||(s.add(c),o.push(c))}for(var u=0,h=n;u<h.length;u++){c=h[u];s.has(c)||(s.add(c),o.push(c))}return o}function L(e,t){var r=[],i=M(e,t,!1);if(G(i))return r;for(var n=Z(i.keys()),s=0;;){var o=K(n);if(!o)return r.length=s,r;var a=J(o);try{r[s]=a}catch(e){try{Q(n)}finally{throw e}}s++}}function N(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function G(e){return void 0===e}function D(e){return null===e}function U(e){return"symbol"==typeof e}function V(e){return"object"==typeof e?null!==e:"function"==typeof e}function B(e,t){switch(N(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",n=X(e,i);if(void 0!==n){var s=n.call(e,r);if(V(s))throw new TypeError;return s}return F(e,"default"===r?"number":r)}function F(e,t){if("string"===t){var r=e.toString;if($(r))if(!V(n=r.call(e)))return n;if($(i=e.valueOf))if(!V(n=i.call(e)))return n}else{var i;if($(i=e.valueOf))if(!V(n=i.call(e)))return n;var n,s=e.toString;if($(s))if(!V(n=s.call(e)))return n}throw new TypeError}function j(e){return!!e}function z(e){return""+e}function W(e){var t=B(e,3);return U(t)?t:z(t)}function H(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function $(e){return"function"==typeof e}function Y(e){return"function"==typeof e}function q(e){switch(N(e)){case 3:case 4:return!0;default:return!1}}function X(e,t){var r=e[t];if(null!=r){if(!$(r))throw new TypeError;return r}}function Z(e){var t=X(e,s);if(!$(t))throw new TypeError;var r=t.call(e);if(!V(r))throw new TypeError;return r}function J(e){return e.value}function K(e){var t=e.next();return!t.done&&t}function Q(e){var t=e.return;t&&t.call(e)}function ee(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var r=e.prototype,i=r&&Object.getPrototypeOf(r);if(null==i||i===Object.prototype)return t;var n=i.constructor;return"function"!=typeof n||n===e?t:n}function te(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[s]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var i=this._keys.length,n=r+1;n<i;n++)this._keys[n-1]=this._keys[n],this._values[n-1]=this._values[n];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,i)},t.prototype.values=function(){return new r(this._keys,this._values,n)},t.prototype.entries=function(){return new r(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[s]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function i(e,t){return e}function n(e,t){return t}function o(e,t){return[e,t]}}function re(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[s]=function(){return this.keys()},e}()}function ie(){var e=16,r=c.create(),i=n();return function(){function e(){this._key=n()}return e.prototype.has=function(e){var t=s(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=s(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return s(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=s(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=n()},e}();function n(){var e;do{e="@@WeakMap@@"+l()}while(c.has(r,e));return r[e]=!0,e}function s(e,r){if(!t.call(e,i)){if(!r)return;Object.defineProperty(e,i,{value:c.create()})}return e[i]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function l(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",i=0;i<e;++i){var n=t[i];4!==i&&6!==i&&8!==i||(r+="-"),n<16&&(r+="0"),r+=n.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",m),e("metadata",g),e("defineMetadata",v),e("hasMetadata",_),e("hasOwnMetadata",b),e("getMetadata",y),e("getOwnMetadata",E),e("getMetadataKeys",w),e("getOwnMetadataKeys",x),e("deleteMetadata",A)}(s)}()}(i||(i={}))})),s.register("hPtJY",(function(e,t){var r,i,n=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===s||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:s}catch(e){r=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var l,c=[],u=!1,h=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):h=-1,c.length&&f())}function f(){if(!u){var e=a(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++h<t;)l&&l[h].run();h=-1,t=c.length}l=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=m,n.addListener=m,n.once=m,n.off=m,n.removeListener=m,n.removeAllListeners=m,n.emit=m,n.prependListener=m,n.prependOnceListener=m,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}})),s.register("dk8Lz",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OrthographicCameraControls=e.exports.PerspectiveCameraControls=e.exports.OrthographicCamera=e.exports.PerspectiveCamera=e.exports.ORTHOGRAPHIC_CAMERA_DIRECTION=e.exports.CAMERATYPE=e.exports.AbstractCamera=e.exports.CameraEngine=void 0;var r=s("kEkrb");Object.defineProperty(e.exports,"AbstractCamera",{enumerable:!0,get:function(){return r.AbstractCamera}});var i=s("k481s");Object.defineProperty(e.exports,"CameraEngine",{enumerable:!0,get:function(){return i.CameraEngine}});var n=s("c6GJS");Object.defineProperty(e.exports,"CAMERATYPE",{enumerable:!0,get:function(){return n.CAMERATYPE}});var o=s("cNNnA");Object.defineProperty(e.exports,"OrthographicCamera",{enumerable:!0,get:function(){return o.OrthographicCamera}});var a=s("adtYh");Object.defineProperty(e.exports,"PerspectiveCamera",{enumerable:!0,get:function(){return a.PerspectiveCamera}});var l=s("7fzug");Object.defineProperty(e.exports,"OrthographicCameraControls",{enumerable:!0,get:function(){return l.OrthographicCameraControls}});var c=s("4K6tN");Object.defineProperty(e.exports,"PerspectiveCameraControls",{enumerable:!0,get:function(){return c.PerspectiveCameraControls}});var u=s("f8rvL");Object.defineProperty(e.exports,"ORTHOGRAPHIC_CAMERA_DIRECTION",{enumerable:!0,get:function(){return u.ORTHOGRAPHIC_CAMERA_DIRECTION}})})),s.register("kEkrb",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},o=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractCamera=void 0;const a=n(s("7niwS"));var l=s("eIStk"),c=s("cTTbu");s("yoicn");var u=s("bJEmL"),h=s("6UMiq"),d=s("eYU63");class f extends d.AbstractTreeNodeData{constructor(e,t){super(e),this._id=e,this._type=t,this._autoAdjust=!1,this._cameraMovementDuration=800,this._defaultPosition=l.create(),this._defaultTarget=l.create(),this._enableCameraControls=!0,this._far=1e3,this._near=1,this._useNodeData=!1,this._revertAtMouseUp=!1,this._revertAtMouseUpDuration=800,this._zoomExtentsFactor=1,this._eventEngine=u.instance.resolve(c.EventEngine),this._settingsEngine=u.instance.resolve(c.SettingsEngine),this._stateEngine=u.instance.resolve(c.StateEngine),this._boundingBox=new h.Box,this._position=l.create(),this._target=l.create()}get autoAdjust(){return this._autoAdjust}set autoAdjust(e){this._autoAdjust=e}set boundingBox(e){this._boundingBox=e}get cameraMovementDuration(){return this._cameraMovementDuration}set cameraMovementDuration(e){this._cameraMovementDuration=e}get controls(){return this._controls}get defaultPosition(){return this._defaultPosition}set defaultPosition(e){this._defaultPosition=e}get defaultTarget(){return this._defaultTarget}set defaultTarget(e){this._defaultTarget=e}get enableCameraControls(){return this._enableCameraControls}set enableCameraControls(e){this._enableCameraControls=e}get far(){return this._far}set far(e){this._far=e}get id(){return this._id}get near(){return this._near}set near(e){this._near=e}get node(){return this._node}set node(e){this._node=e}get useNodeData(){return this._useNodeData}set useNodeData(e){this._useNodeData=e}get order(){return this._order}set order(e){this._order=e}get position(){return this._position}set position(e){this._position=e,this._controls.position=e}get revertAtMouseUp(){return this._revertAtMouseUp}set revertAtMouseUp(e){this._revertAtMouseUp=e}get revertAtMouseUpDuration(){return this._revertAtMouseUpDuration}set revertAtMouseUpDuration(e){this._revertAtMouseUpDuration=e}get target(){return this._target}set target(e){this._target=e,this._controls.target=e}get type(){return this._type}get viewerId(){return this._viewerId}get zoomExtentsFactor(){return this._zoomExtentsFactor}set zoomExtentsFactor(e){this._zoomExtentsFactor=e}animate(e,t){return o(this,void 0,void 0,(function*(){if(0===e.length)return Promise.resolve(!1);if(!this._controls.isWithinRestrictions(e[e.length-1].position,e[e.length-1].target))return Promise.resolve(!1);t||(t={}),t.duration=t.duration>=0?t.duration:this.cameraMovementDuration;const r=yield this._controls.animate(e,t);return r&&(this._position=this._controls.position,this._target=this._controls.target),r}))}reset(e){return 0===this.defaultPosition[0]&&0===this.defaultPosition[1]&&0===this.defaultPosition[2]&&0===this.defaultTarget[0]&&0===this.defaultTarget[1]&&0===this.defaultTarget[2]?this.zoomTo(void 0,e):this.set(l.clone(this.defaultPosition),l.clone(this.defaultTarget),e)}set(e,t,r){return o(this,void 0,void 0,(function*(){if(!this._controls.isWithinRestrictions(e,t))return Promise.resolve(!1);r||(r={}),r.duration=r.duration>=0?r.duration:this.cameraMovementDuration;const i=yield this._controls.animate([{position:l.clone(this.position),target:l.clone(this.target)},{position:e,target:t}],r);return i&&(this._position=this._controls.position,this._target=this._controls.target),i}))}update(e){if(this.useNodeData&&this.node&&this._viewerId)return!0;{const{position:t,target:r}=this._controls.update(e);let i=!0;return l.equals(t,this.position)&&l.equals(r,this.target)&&(i=!1),this.position=l.clone(t),this.target=l.clone(r),i}}zoomTo(e,t){const{position:r,target:i}=this.getZoomPositionAndTarget(e);return this.set(r,i,t)}assignViewerInternal(e,t){this._viewerId=e,this._eventEngine.addListener(c.EVENTTYPE.SESSION.SESSION_CUSTOMIZED,(e=>{!0===this._autoAdjust&&this.zoomTo()}));const r=()=>{!0===this._revertAtMouseUp&&this.reset({duration:this._revertAtMouseUpDuration})};let i;t.addEventListener("mouseup",(()=>r()),!!a.supportsPassiveEvents&&{capture:!1,passive:!0}),t.addEventListener("mouseout",(()=>r()),!!a.supportsPassiveEvents&&{capture:!1,passive:!0}),t.addEventListener("touchend",(()=>r()),!!a.supportsPassiveEvents&&{capture:!1,passive:!0});let n=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";t.addEventListener(n,(()=>{clearTimeout(i),i=setTimeout(r,300)}),!!a.supportsPassiveEvents&&{capture:!1,passive:!0})}}e.exports.AbstractCamera=f})),s.register("7niwS",(function(e,r){t(e.exports,"supportsPassiveEvents",(()=>l)),t(e.exports,"supportsPointerEvents",(()=>c)),t(e.exports,"supportsTouchEvents",(()=>h)),t(e.exports,"deviceType",(()=>v)),t(e.exports,"primaryInput",(()=>_));var i="undefined"!=typeof window?window:{screen:{},navigator:{}},n=(i.matchMedia||function(){return{matches:!1}}).bind(i),s=!1,o={get passive(){return s=!0}},a=function(){};i.addEventListener&&i.addEventListener("p",a,o),i.removeEventListener&&i.removeEventListener("p",a,!1);var l=s,c="PointerEvent"in i,u="ontouchstart"in i,h=u||"TouchEvent"in i&&n("(any-pointer: coarse)").matches,d=(i.navigator.maxTouchPoints||0)>0||h,f=i.navigator.userAgent||"",p=n("(pointer: coarse)").matches&&/iPad|Macintosh/.test(f)&&Math.min(i.screen.width||0,i.screen.height||0)>=768,m=(n("(pointer: coarse)").matches||!n("(pointer: fine)").matches&&u)&&!/Windows.*Firefox/.test(f),g=n("(any-pointer: fine)").matches||n("(any-hover: hover)").matches||p||!u,v=!d||!g&&m?d?"touchOnly":"mouseOnly":"hybrid",_="mouseOnly"===v?"mouse":"touchOnly"===v||m?"touch":"mouse"})),s.register("bDSmI",(function(e,r){t(e.exports,"create",(()=>n)),t(e.exports,"fromMat4",(()=>o)),t(e.exports,"clone",(()=>a)),t(e.exports,"copy",(()=>l)),t(e.exports,"fromValues",(()=>c)),t(e.exports,"set",(()=>u)),t(e.exports,"identity",(()=>h)),t(e.exports,"transpose",(()=>d)),t(e.exports,"invert",(()=>f)),t(e.exports,"adjoint",(()=>p)),t(e.exports,"determinant",(()=>m)),t(e.exports,"multiply",(()=>g)),t(e.exports,"translate",(()=>v)),t(e.exports,"rotate",(()=>_)),t(e.exports,"scale",(()=>b)),t(e.exports,"fromTranslation",(()=>y)),t(e.exports,"fromRotation",(()=>E)),t(e.exports,"fromScaling",(()=>w)),t(e.exports,"fromMat2d",(()=>x)),t(e.exports,"fromQuat",(()=>A)),t(e.exports,"normalFromMat4",(()=>T)),t(e.exports,"projection",(()=>S)),t(e.exports,"str",(()=>M)),t(e.exports,"frob",(()=>C)),t(e.exports,"add",(()=>R)),t(e.exports,"subtract",(()=>I)),t(e.exports,"multiplyScalar",(()=>O)),t(e.exports,"multiplyScalarAndAdd",(()=>P)),t(e.exports,"exactEquals",(()=>k)),t(e.exports,"equals",(()=>L)),t(e.exports,"mul",(()=>N)),t(e.exports,"sub",(()=>G));var i=s("amnUE");function n(){var e=new i.ARRAY_TYPE(9);return i.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(e){var t=new i.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function l(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function c(e,t,r,n,s,o,a,l,c){var u=new i.ARRAY_TYPE(9);return u[0]=e,u[1]=t,u[2]=r,u[3]=n,u[4]=s,u[5]=o,u[6]=a,u[7]=l,u[8]=c,u}function u(e,t,r,i,n,s,o,a,l,c){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=o,e[6]=a,e[7]=l,e[8]=c,e}function h(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function d(e,t){if(e===t){var r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function f(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=u*o-a*c,d=-u*s+a*l,f=c*s-o*l,p=r*h+i*d+n*f;return p?(p=1/p,e[0]=h*p,e[1]=(-u*i+n*c)*p,e[2]=(a*i-n*o)*p,e[3]=d*p,e[4]=(u*r-n*l)*p,e[5]=(-a*r+n*s)*p,e[6]=f*p,e[7]=(-c*r+i*l)*p,e[8]=(o*r-i*s)*p,e):null}function p(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8];return e[0]=o*u-a*c,e[1]=n*c-i*u,e[2]=i*a-n*o,e[3]=a*l-s*u,e[4]=r*u-n*l,e[5]=n*s-r*a,e[6]=s*c-o*l,e[7]=i*l-r*c,e[8]=r*o-i*s,e}function m(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*(c*s-o*l)+r*(-c*n+o*a)+i*(l*n-s*a)}function g(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=r[0],f=r[1],p=r[2],m=r[3],g=r[4],v=r[5],_=r[6],b=r[7],y=r[8];return e[0]=d*i+f*o+p*c,e[1]=d*n+f*a+p*u,e[2]=d*s+f*l+p*h,e[3]=m*i+g*o+v*c,e[4]=m*n+g*a+v*u,e[5]=m*s+g*l+v*h,e[6]=_*i+b*o+y*c,e[7]=_*n+b*a+y*u,e[8]=_*s+b*l+y*h,e}function v(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=r[0],f=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=d*i+f*o+c,e[7]=d*n+f*a+u,e[8]=d*s+f*l+h,e}function _(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=Math.sin(r),f=Math.cos(r);return e[0]=f*i+d*o,e[1]=f*n+d*a,e[2]=f*s+d*l,e[3]=f*o-d*i,e[4]=f*a-d*n,e[5]=f*l-d*s,e[6]=c,e[7]=u,e[8]=h,e}function b(e,t,r){var i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function y(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function E(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function w(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function x(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function A(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=r+r,a=i+i,l=n+n,c=r*o,u=i*o,h=i*a,d=n*o,f=n*a,p=n*l,m=s*o,g=s*a,v=s*l;return e[0]=1-h-p,e[3]=u-v,e[6]=d+g,e[1]=u+v,e[4]=1-c-p,e[7]=f-m,e[2]=d-g,e[5]=f+m,e[8]=1-c-h,e}function T(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],_=r*a-i*o,b=r*l-n*o,y=r*c-s*o,E=i*l-n*a,w=i*c-s*a,x=n*c-s*l,A=u*m-h*p,T=u*g-d*p,S=u*v-f*p,M=h*g-d*m,C=h*v-f*m,R=d*v-f*g,I=_*R-b*C+y*M+E*S-w*T+x*A;return I?(I=1/I,e[0]=(a*R-l*C+c*M)*I,e[1]=(l*S-o*R-c*T)*I,e[2]=(o*C-a*S+c*A)*I,e[3]=(n*C-i*R-s*M)*I,e[4]=(r*R-n*S+s*T)*I,e[5]=(i*S-r*C-s*A)*I,e[6]=(m*x-g*w+v*E)*I,e[7]=(g*y-p*x-v*b)*I,e[8]=(p*w-m*y+v*_)*I,e):null}function S(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function M(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function C(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}function R(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function I(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function O(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function P(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e}function k(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function L(e,t){var r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=t[0],f=t[1],p=t[2],m=t[3],g=t[4],v=t[5],_=t[6],b=t[7],y=t[8];return Math.abs(r-d)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-f)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(s-p)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-m)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-g)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(g))&&Math.abs(l-v)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(v))&&Math.abs(c-_)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(_))&&Math.abs(u-b)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(h-y)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(y))}var N=g,G=I})),s.register("amnUE",(function(e,r){t(e.exports,"EPSILON",(()=>i)),t(e.exports,"ARRAY_TYPE",(()=>n)),t(e.exports,"RANDOM",(()=>s));var i=1e-6,n="undefined"!=typeof Float32Array?Float32Array:Array,s=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})})),s.register("3iqbd",(function(e,r){t(e.exports,"create",(()=>n)),t(e.exports,"clone",(()=>o)),t(e.exports,"copy",(()=>a)),t(e.exports,"fromValues",(()=>l)),t(e.exports,"set",(()=>c)),t(e.exports,"identity",(()=>u)),t(e.exports,"transpose",(()=>h)),t(e.exports,"invert",(()=>d)),t(e.exports,"adjoint",(()=>f)),t(e.exports,"determinant",(()=>p)),t(e.exports,"multiply",(()=>m)),t(e.exports,"translate",(()=>g)),t(e.exports,"scale",(()=>v)),t(e.exports,"rotate",(()=>_)),t(e.exports,"rotateX",(()=>b)),t(e.exports,"rotateY",(()=>y)),t(e.exports,"rotateZ",(()=>E)),t(e.exports,"fromTranslation",(()=>w)),t(e.exports,"fromScaling",(()=>x)),t(e.exports,"fromRotation",(()=>A)),t(e.exports,"fromXRotation",(()=>T)),t(e.exports,"fromYRotation",(()=>S)),t(e.exports,"fromZRotation",(()=>M)),t(e.exports,"fromRotationTranslation",(()=>C)),t(e.exports,"fromQuat2",(()=>R)),t(e.exports,"getTranslation",(()=>I)),t(e.exports,"getScaling",(()=>O)),t(e.exports,"getRotation",(()=>P)),t(e.exports,"fromRotationTranslationScale",(()=>k)),t(e.exports,"fromRotationTranslationScaleOrigin",(()=>L)),t(e.exports,"fromQuat",(()=>N)),t(e.exports,"frustum",(()=>G)),t(e.exports,"perspective",(()=>D)),t(e.exports,"perspectiveFromFieldOfView",(()=>U)),t(e.exports,"ortho",(()=>V)),t(e.exports,"lookAt",(()=>B)),t(e.exports,"targetTo",(()=>F)),t(e.exports,"str",(()=>j)),t(e.exports,"frob",(()=>z)),t(e.exports,"add",(()=>W)),t(e.exports,"subtract",(()=>H)),t(e.exports,"multiplyScalar",(()=>$)),t(e.exports,"multiplyScalarAndAdd",(()=>Y)),t(e.exports,"exactEquals",(()=>q)),t(e.exports,"equals",(()=>X)),t(e.exports,"mul",(()=>Z)),t(e.exports,"sub",(()=>J));var i=s("amnUE");function n(){var e=new i.ARRAY_TYPE(16);return i.ARRAY_TYPE!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function o(e){var t=new i.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function l(e,t,r,n,s,o,a,l,c,u,h,d,f,p,m,g){var v=new i.ARRAY_TYPE(16);return v[0]=e,v[1]=t,v[2]=r,v[3]=n,v[4]=s,v[5]=o,v[6]=a,v[7]=l,v[8]=c,v[9]=u,v[10]=h,v[11]=d,v[12]=f,v[13]=p,v[14]=m,v[15]=g,v}function c(e,t,r,i,n,s,o,a,l,c,u,h,d,f,p,m,g){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=o,e[6]=a,e[7]=l,e[8]=c,e[9]=u,e[10]=h,e[11]=d,e[12]=f,e[13]=p,e[14]=m,e[15]=g,e}function u(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function h(e,t){if(e===t){var r=t[1],i=t[2],n=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=s,e[11]=t[14],e[12]=n,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function d(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],_=r*a-i*o,b=r*l-n*o,y=r*c-s*o,E=i*l-n*a,w=i*c-s*a,x=n*c-s*l,A=u*m-h*p,T=u*g-d*p,S=u*v-f*p,M=h*g-d*m,C=h*v-f*m,R=d*v-f*g,I=_*R-b*C+y*M+E*S-w*T+x*A;return I?(I=1/I,e[0]=(a*R-l*C+c*M)*I,e[1]=(n*C-i*R-s*M)*I,e[2]=(m*x-g*w+v*E)*I,e[3]=(d*w-h*x-f*E)*I,e[4]=(l*S-o*R-c*T)*I,e[5]=(r*R-n*S+s*T)*I,e[6]=(g*y-p*x-v*b)*I,e[7]=(u*x-d*y+f*b)*I,e[8]=(o*C-a*S+c*A)*I,e[9]=(i*S-r*C-s*A)*I,e[10]=(p*w-m*y+v*_)*I,e[11]=(h*y-u*w-f*_)*I,e[12]=(a*T-o*M-l*A)*I,e[13]=(r*M-i*T+n*A)*I,e[14]=(m*b-p*E-g*_)*I,e[15]=(u*E-h*b+d*_)*I,e):null}function f(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15];return e[0]=a*(d*v-f*g)-h*(l*v-c*g)+m*(l*f-c*d),e[1]=-(i*(d*v-f*g)-h*(n*v-s*g)+m*(n*f-s*d)),e[2]=i*(l*v-c*g)-a*(n*v-s*g)+m*(n*c-s*l),e[3]=-(i*(l*f-c*d)-a*(n*f-s*d)+h*(n*c-s*l)),e[4]=-(o*(d*v-f*g)-u*(l*v-c*g)+p*(l*f-c*d)),e[5]=r*(d*v-f*g)-u*(n*v-s*g)+p*(n*f-s*d),e[6]=-(r*(l*v-c*g)-o*(n*v-s*g)+p*(n*c-s*l)),e[7]=r*(l*f-c*d)-o*(n*f-s*d)+u*(n*c-s*l),e[8]=o*(h*v-f*m)-u*(a*v-c*m)+p*(a*f-c*h),e[9]=-(r*(h*v-f*m)-u*(i*v-s*m)+p*(i*f-s*h)),e[10]=r*(a*v-c*m)-o*(i*v-s*m)+p*(i*c-s*a),e[11]=-(r*(a*f-c*h)-o*(i*f-s*h)+u*(i*c-s*a)),e[12]=-(o*(h*g-d*m)-u*(a*g-l*m)+p*(a*d-l*h)),e[13]=r*(h*g-d*m)-u*(i*g-n*m)+p*(i*d-n*h),e[14]=-(r*(a*g-l*m)-o*(i*g-n*m)+p*(i*l-n*a)),e[15]=r*(a*d-l*h)-o*(i*d-n*h)+u*(i*l-n*a),e}function p(e){var t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15];return(t*o-r*s)*(h*g-d*m)-(t*a-i*s)*(u*g-d*p)+(t*l-n*s)*(u*m-h*p)+(r*a-i*o)*(c*g-d*f)-(r*l-n*o)*(c*m-h*f)+(i*l-n*a)*(c*p-u*f)}function m(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],m=t[12],g=t[13],v=t[14],_=t[15],b=r[0],y=r[1],E=r[2],w=r[3];return e[0]=b*i+y*a+E*h+w*m,e[1]=b*n+y*l+E*d+w*g,e[2]=b*s+y*c+E*f+w*v,e[3]=b*o+y*u+E*p+w*_,b=r[4],y=r[5],E=r[6],w=r[7],e[4]=b*i+y*a+E*h+w*m,e[5]=b*n+y*l+E*d+w*g,e[6]=b*s+y*c+E*f+w*v,e[7]=b*o+y*u+E*p+w*_,b=r[8],y=r[9],E=r[10],w=r[11],e[8]=b*i+y*a+E*h+w*m,e[9]=b*n+y*l+E*d+w*g,e[10]=b*s+y*c+E*f+w*v,e[11]=b*o+y*u+E*p+w*_,b=r[12],y=r[13],E=r[14],w=r[15],e[12]=b*i+y*a+E*h+w*m,e[13]=b*n+y*l+E*d+w*g,e[14]=b*s+y*c+E*f+w*v,e[15]=b*o+y*u+E*p+w*_,e}function g(e,t,r){var i,n,s,o,a,l,c,u,h,d,f,p,m=r[0],g=r[1],v=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*v+t[12],e[13]=t[1]*m+t[5]*g+t[9]*v+t[13],e[14]=t[2]*m+t[6]*g+t[10]*v+t[14],e[15]=t[3]*m+t[7]*g+t[11]*v+t[15]):(i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],l=t[5],c=t[6],u=t[7],h=t[8],d=t[9],f=t[10],p=t[11],e[0]=i,e[1]=n,e[2]=s,e[3]=o,e[4]=a,e[5]=l,e[6]=c,e[7]=u,e[8]=h,e[9]=d,e[10]=f,e[11]=p,e[12]=i*m+a*g+h*v+t[12],e[13]=n*m+l*g+d*v+t[13],e[14]=s*m+c*g+f*v+t[14],e[15]=o*m+u*g+p*v+t[15]),e}function v(e,t,r){var i=r[0],n=r[1],s=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function _(e,t,r,n){var s,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E,w,x,A,T,S,M,C,R=n[0],I=n[1],O=n[2],P=Math.hypot(R,I,O);return P<i.EPSILON?null:(R*=P=1/P,I*=P,O*=P,s=Math.sin(r),a=1-(o=Math.cos(r)),l=t[0],c=t[1],u=t[2],h=t[3],d=t[4],f=t[5],p=t[6],m=t[7],g=t[8],v=t[9],_=t[10],b=t[11],y=R*R*a+o,E=I*R*a+O*s,w=O*R*a-I*s,x=R*I*a-O*s,A=I*I*a+o,T=O*I*a+R*s,S=R*O*a+I*s,M=I*O*a-R*s,C=O*O*a+o,e[0]=l*y+d*E+g*w,e[1]=c*y+f*E+v*w,e[2]=u*y+p*E+_*w,e[3]=h*y+m*E+b*w,e[4]=l*x+d*A+g*T,e[5]=c*x+f*A+v*T,e[6]=u*x+p*A+_*T,e[7]=h*x+m*A+b*T,e[8]=l*S+d*M+g*C,e[9]=c*S+f*M+v*C,e[10]=u*S+p*M+_*C,e[11]=h*S+m*M+b*C,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function b(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*n+c*i,e[5]=o*n+u*i,e[6]=a*n+h*i,e[7]=l*n+d*i,e[8]=c*n-s*i,e[9]=u*n-o*i,e[10]=h*n-a*i,e[11]=d*n-l*i,e}function y(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],o=t[1],a=t[2],l=t[3],c=t[8],u=t[9],h=t[10],d=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n-c*i,e[1]=o*n-u*i,e[2]=a*n-h*i,e[3]=l*n-d*i,e[8]=s*i+c*n,e[9]=o*i+u*n,e[10]=a*i+h*n,e[11]=l*i+d*n,e}function E(e,t,r){var i=Math.sin(r),n=Math.cos(r),s=t[0],o=t[1],a=t[2],l=t[3],c=t[4],u=t[5],h=t[6],d=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n+c*i,e[1]=o*n+u*i,e[2]=a*n+h*i,e[3]=l*n+d*i,e[4]=c*n-s*i,e[5]=u*n-o*i,e[6]=h*n-a*i,e[7]=d*n-l*i,e}function w(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function x(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function A(e,t,r){var n,s,o,a=r[0],l=r[1],c=r[2],u=Math.hypot(a,l,c);return u<i.EPSILON?null:(a*=u=1/u,l*=u,c*=u,n=Math.sin(t),o=1-(s=Math.cos(t)),e[0]=a*a*o+s,e[1]=l*a*o+c*n,e[2]=c*a*o-l*n,e[3]=0,e[4]=a*l*o-c*n,e[5]=l*l*o+s,e[6]=c*l*o+a*n,e[7]=0,e[8]=a*c*o+l*n,e[9]=l*c*o-a*n,e[10]=c*c*o+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function T(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function S(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function M(e,t){var r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function C(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3],a=i+i,l=n+n,c=s+s,u=i*a,h=i*l,d=i*c,f=n*l,p=n*c,m=s*c,g=o*a,v=o*l,_=o*c;return e[0]=1-(f+m),e[1]=h+_,e[2]=d-v,e[3]=0,e[4]=h-_,e[5]=1-(u+m),e[6]=p+g,e[7]=0,e[8]=d+v,e[9]=p-g,e[10]=1-(u+f),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function R(e,t){var r=new i.ARRAY_TYPE(3),n=-t[0],s=-t[1],o=-t[2],a=t[3],l=t[4],c=t[5],u=t[6],h=t[7],d=n*n+s*s+o*o+a*a;return d>0?(r[0]=2*(l*a+h*n+c*o-u*s)/d,r[1]=2*(c*a+h*s+u*n-l*o)/d,r[2]=2*(u*a+h*o+l*s-c*n)/d):(r[0]=2*(l*a+h*n+c*o-u*s),r[1]=2*(c*a+h*s+u*n-l*o),r[2]=2*(u*a+h*o+l*s-c*n)),C(e,t,r),e}function I(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function O(e,t){var r=t[0],i=t[1],n=t[2],s=t[4],o=t[5],a=t[6],l=t[8],c=t[9],u=t[10];return e[0]=Math.hypot(r,i,n),e[1]=Math.hypot(s,o,a),e[2]=Math.hypot(l,c,u),e}function P(e,t){var r=new i.ARRAY_TYPE(3);O(r,t);var n=1/r[0],s=1/r[1],o=1/r[2],a=t[0]*n,l=t[1]*s,c=t[2]*o,u=t[4]*n,h=t[5]*s,d=t[6]*o,f=t[8]*n,p=t[9]*s,m=t[10]*o,g=a+h+m,v=0;return g>0?(v=2*Math.sqrt(g+1),e[3]=.25*v,e[0]=(d-p)/v,e[1]=(f-c)/v,e[2]=(l-u)/v):a>h&&a>m?(v=2*Math.sqrt(1+a-h-m),e[3]=(d-p)/v,e[0]=.25*v,e[1]=(l+u)/v,e[2]=(f+c)/v):h>m?(v=2*Math.sqrt(1+h-a-m),e[3]=(f-c)/v,e[0]=(l+u)/v,e[1]=.25*v,e[2]=(d+p)/v):(v=2*Math.sqrt(1+m-a-h),e[3]=(l-u)/v,e[0]=(f+c)/v,e[1]=(d+p)/v,e[2]=.25*v),e}function k(e,t,r,i){var n=t[0],s=t[1],o=t[2],a=t[3],l=n+n,c=s+s,u=o+o,h=n*l,d=n*c,f=n*u,p=s*c,m=s*u,g=o*u,v=a*l,_=a*c,b=a*u,y=i[0],E=i[1],w=i[2];return e[0]=(1-(p+g))*y,e[1]=(d+b)*y,e[2]=(f-_)*y,e[3]=0,e[4]=(d-b)*E,e[5]=(1-(h+g))*E,e[6]=(m+v)*E,e[7]=0,e[8]=(f+_)*w,e[9]=(m-v)*w,e[10]=(1-(h+p))*w,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function L(e,t,r,i,n){var s=t[0],o=t[1],a=t[2],l=t[3],c=s+s,u=o+o,h=a+a,d=s*c,f=s*u,p=s*h,m=o*u,g=o*h,v=a*h,_=l*c,b=l*u,y=l*h,E=i[0],w=i[1],x=i[2],A=n[0],T=n[1],S=n[2],M=(1-(m+v))*E,C=(f+y)*E,R=(p-b)*E,I=(f-y)*w,O=(1-(d+v))*w,P=(g+_)*w,k=(p+b)*x,L=(g-_)*x,N=(1-(d+m))*x;return e[0]=M,e[1]=C,e[2]=R,e[3]=0,e[4]=I,e[5]=O,e[6]=P,e[7]=0,e[8]=k,e[9]=L,e[10]=N,e[11]=0,e[12]=r[0]+A-(M*A+I*T+k*S),e[13]=r[1]+T-(C*A+O*T+L*S),e[14]=r[2]+S-(R*A+P*T+N*S),e[15]=1,e}function N(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=r+r,a=i+i,l=n+n,c=r*o,u=i*o,h=i*a,d=n*o,f=n*a,p=n*l,m=s*o,g=s*a,v=s*l;return e[0]=1-h-p,e[1]=u+v,e[2]=d-g,e[3]=0,e[4]=u-v,e[5]=1-c-p,e[6]=f+m,e[7]=0,e[8]=d+g,e[9]=f-m,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function G(e,t,r,i,n,s,o){var a=1/(r-t),l=1/(n-i),c=1/(s-o);return e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*l,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(n+i)*l,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0,e}function D(e,t,r,i,n){var s,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=n&&n!==1/0?(s=1/(i-n),e[10]=(n+i)*s,e[14]=2*n*i*s):(e[10]=-1,e[14]=-2*i),e}function U(e,t,r,i){var n=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),l=2/(o+a),c=2/(n+s);return e[0]=l,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(o-a)*l*.5,e[9]=(n-s)*c*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function V(e,t,r,i,n,s,o){var a=1/(t-r),l=1/(i-n),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*a,e[13]=(n+i)*l,e[14]=(o+s)*c,e[15]=1,e}function B(e,t,r,n){var s,o,a,l,c,h,d,f,p,m,g=t[0],v=t[1],_=t[2],b=n[0],y=n[1],E=n[2],w=r[0],x=r[1],A=r[2];return Math.abs(g-w)<i.EPSILON&&Math.abs(v-x)<i.EPSILON&&Math.abs(_-A)<i.EPSILON?u(e):(d=g-w,f=v-x,p=_-A,s=y*(p*=m=1/Math.hypot(d,f,p))-E*(f*=m),o=E*(d*=m)-b*p,a=b*f-y*d,(m=Math.hypot(s,o,a))?(s*=m=1/m,o*=m,a*=m):(s=0,o=0,a=0),l=f*a-p*o,c=p*s-d*a,h=d*o-f*s,(m=Math.hypot(l,c,h))?(l*=m=1/m,c*=m,h*=m):(l=0,c=0,h=0),e[0]=s,e[1]=l,e[2]=d,e[3]=0,e[4]=o,e[5]=c,e[6]=f,e[7]=0,e[8]=a,e[9]=h,e[10]=p,e[11]=0,e[12]=-(s*g+o*v+a*_),e[13]=-(l*g+c*v+h*_),e[14]=-(d*g+f*v+p*_),e[15]=1,e)}function F(e,t,r,i){var n=t[0],s=t[1],o=t[2],a=i[0],l=i[1],c=i[2],u=n-r[0],h=s-r[1],d=o-r[2],f=u*u+h*h+d*d;f>0&&(u*=f=1/Math.sqrt(f),h*=f,d*=f);var p=l*d-c*h,m=c*u-a*d,g=a*h-l*u;return(f=p*p+m*m+g*g)>0&&(p*=f=1/Math.sqrt(f),m*=f,g*=f),e[0]=p,e[1]=m,e[2]=g,e[3]=0,e[4]=h*g-d*m,e[5]=d*p-u*g,e[6]=u*m-h*p,e[7]=0,e[8]=u,e[9]=h,e[10]=d,e[11]=0,e[12]=n,e[13]=s,e[14]=o,e[15]=1,e}function j(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function z(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function W(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function H(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function $(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function Y(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function q(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function X(e,t){var r=e[0],n=e[1],s=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],m=e[12],g=e[13],v=e[14],_=e[15],b=t[0],y=t[1],E=t[2],w=t[3],x=t[4],A=t[5],T=t[6],S=t[7],M=t[8],C=t[9],R=t[10],I=t[11],O=t[12],P=t[13],k=t[14],L=t[15];return Math.abs(r-b)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-y)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(s-E)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(o-w)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(a-x)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(l-A)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(A))&&Math.abs(c-T)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(u-S)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(h-M)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(d-C)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(C))&&Math.abs(f-R)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(p-I)<=i.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(m-O)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(O))&&Math.abs(g-P)<=i.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(v-k)<=i.EPSILON*Math.max(1,Math.abs(v),Math.abs(k))&&Math.abs(_-L)<=i.EPSILON*Math.max(1,Math.abs(_),Math.abs(L))}var Z=m,J=H})),s.register("k1dpP",(function(e,r){t(e.exports,"create",(()=>l)),t(e.exports,"identity",(()=>c)),t(e.exports,"setAxisAngle",(()=>u)),t(e.exports,"getAxisAngle",(()=>h)),t(e.exports,"getAngle",(()=>d)),t(e.exports,"dot",(()=>F)),t(e.exports,"multiply",(()=>f)),t(e.exports,"rotateX",(()=>p)),t(e.exports,"rotateY",(()=>m)),t(e.exports,"rotateZ",(()=>g)),t(e.exports,"calculateW",(()=>v)),t(e.exports,"exp",(()=>_)),t(e.exports,"ln",(()=>b)),t(e.exports,"pow",(()=>y)),t(e.exports,"scale",(()=>B)),t(e.exports,"slerp",(()=>E)),t(e.exports,"random",(()=>w)),t(e.exports,"invert",(()=>x)),t(e.exports,"conjugate",(()=>A)),t(e.exports,"fromMat3",(()=>T)),t(e.exports,"fromEuler",(()=>S)),t(e.exports,"str",(()=>M)),t(e.exports,"clone",(()=>L)),t(e.exports,"fromValues",(()=>N)),t(e.exports,"copy",(()=>G)),t(e.exports,"set",(()=>D)),t(e.exports,"add",(()=>U)),t(e.exports,"mul",(()=>V)),t(e.exports,"lerp",(()=>j)),t(e.exports,"length",(()=>z)),t(e.exports,"len",(()=>W)),t(e.exports,"squaredLength",(()=>H)),t(e.exports,"sqrLen",(()=>$)),t(e.exports,"normalize",(()=>Y)),t(e.exports,"exactEquals",(()=>q)),t(e.exports,"equals",(()=>X)),t(e.exports,"rotationTo",(()=>Z)),t(e.exports,"sqlerp",(()=>J)),t(e.exports,"setAxes",(()=>K));var i=s("amnUE"),n=s("bDSmI"),o=s("eIStk"),a=s("jxhwV");function l(){var e=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function c(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function u(e,t,r){r*=.5;var i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function h(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return n>i.EPSILON?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function d(e,t){var r=F(e,t);return Math.acos(2*r*r-1)}function f(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3],a=r[0],l=r[1],c=r[2],u=r[3];return e[0]=i*u+o*a+n*c-s*l,e[1]=n*u+o*l+s*a-i*c,e[2]=s*u+o*c+i*l-n*a,e[3]=o*u-i*a-n*l-s*c,e}function p(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],o=t[3],a=Math.sin(r),l=Math.cos(r);return e[0]=i*l+o*a,e[1]=n*l+s*a,e[2]=s*l-n*a,e[3]=o*l-i*a,e}function m(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],o=t[3],a=Math.sin(r),l=Math.cos(r);return e[0]=i*l-s*a,e[1]=n*l+o*a,e[2]=s*l+i*a,e[3]=o*l-n*a,e}function g(e,t,r){r*=.5;var i=t[0],n=t[1],s=t[2],o=t[3],a=Math.sin(r),l=Math.cos(r);return e[0]=i*l+n*a,e[1]=n*l-i*a,e[2]=s*l+o*a,e[3]=o*l-s*a,e}function v(e,t){var r=t[0],i=t[1],n=t[2];return e[0]=r,e[1]=i,e[2]=n,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),e}function _(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=Math.sqrt(r*r+i*i+n*n),a=Math.exp(s),l=o>0?a*Math.sin(o)/o:0;return e[0]=r*l,e[1]=i*l,e[2]=n*l,e[3]=a*Math.cos(o),e}function b(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=Math.sqrt(r*r+i*i+n*n),a=o>0?Math.atan2(o,s)/o:0;return e[0]=r*a,e[1]=i*a,e[2]=n*a,e[3]=.5*Math.log(r*r+i*i+n*n+s*s),e}function y(e,t,r){return b(e,t),B(e,e,r),_(e,e),e}function E(e,t,r,n){var s,o,a,l,c,u=t[0],h=t[1],d=t[2],f=t[3],p=r[0],m=r[1],g=r[2],v=r[3];return(o=u*p+h*m+d*g+f*v)<0&&(o=-o,p=-p,m=-m,g=-g,v=-v),1-o>i.EPSILON?(s=Math.acos(o),a=Math.sin(s),l=Math.sin((1-n)*s)/a,c=Math.sin(n*s)/a):(l=1-n,c=n),e[0]=l*u+c*p,e[1]=l*h+c*m,e[2]=l*d+c*g,e[3]=l*f+c*v,e}function w(e){var t=i.RANDOM(),r=i.RANDOM(),n=i.RANDOM(),s=Math.sqrt(1-t),o=Math.sqrt(t);return e[0]=s*Math.sin(2*Math.PI*r),e[1]=s*Math.cos(2*Math.PI*r),e[2]=o*Math.sin(2*Math.PI*n),e[3]=o*Math.cos(2*Math.PI*n),e}function x(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=r*r+i*i+n*n+s*s,a=o?1/o:0;return e[0]=-r*a,e[1]=-i*a,e[2]=-n*a,e[3]=s*a,e}function A(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function T(e,t){var r,i=t[0]+t[4]+t[8];if(i>0)r=Math.sqrt(i+1),e[3]=.5*r,r=.5/r,e[0]=(t[5]-t[7])*r,e[1]=(t[6]-t[2])*r,e[2]=(t[1]-t[3])*r;else{var n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);var s=(n+1)%3,o=(n+2)%3;r=Math.sqrt(t[3*n+n]-t[3*s+s]-t[3*o+o]+1),e[n]=.5*r,r=.5/r,e[3]=(t[3*s+o]-t[3*o+s])*r,e[s]=(t[3*s+n]+t[3*n+s])*r,e[o]=(t[3*o+n]+t[3*n+o])*r}return e}function S(e,t,r,i){var n=.5*Math.PI/180;t*=n,r*=n,i*=n;var s=Math.sin(t),o=Math.cos(t),a=Math.sin(r),l=Math.cos(r),c=Math.sin(i),u=Math.cos(i);return e[0]=s*l*u-o*a*c,e[1]=o*a*u+s*l*c,e[2]=o*l*c-s*a*u,e[3]=o*l*u+s*a*c,e}function M(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}var C,R,I,O,P,k,L=a.clone,N=a.fromValues,G=a.copy,D=a.set,U=a.add,V=f,B=a.scale,F=a.dot,j=a.lerp,z=a.length,W=z,H=a.squaredLength,$=H,Y=a.normalize,q=a.exactEquals,X=a.equals,Z=(C=o.create(),R=o.fromValues(1,0,0),I=o.fromValues(0,1,0),function(e,t,r){var i=o.dot(t,r);return i<-.999999?(o.cross(C,R,t),o.len(C)<1e-6&&o.cross(C,I,t),o.normalize(C,C),u(e,C,Math.PI),e):i>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(o.cross(C,t,r),e[0]=C[0],e[1]=C[1],e[2]=C[2],e[3]=1+i,Y(e,e))}),J=(O=l(),P=l(),function(e,t,r,i,n,s){return E(O,t,n,s),E(P,r,i,s),E(e,O,P,2*s*(1-s)),e}),K=(k=n.create(),function(e,t,r,i){return k[0]=r[0],k[3]=r[1],k[6]=r[2],k[1]=i[0],k[4]=i[1],k[7]=i[2],k[2]=-t[0],k[5]=-t[1],k[8]=-t[2],Y(e,T(e,k))})})),s.register("eIStk",(function(e,r){t(e.exports,"create",(()=>n)),t(e.exports,"clone",(()=>o)),t(e.exports,"length",(()=>a)),t(e.exports,"fromValues",(()=>l)),t(e.exports,"copy",(()=>c)),t(e.exports,"set",(()=>u)),t(e.exports,"add",(()=>h)),t(e.exports,"subtract",(()=>d)),t(e.exports,"multiply",(()=>f)),t(e.exports,"divide",(()=>p)),t(e.exports,"ceil",(()=>m)),t(e.exports,"floor",(()=>g)),t(e.exports,"min",(()=>v)),t(e.exports,"max",(()=>_)),t(e.exports,"round",(()=>b)),t(e.exports,"scale",(()=>y)),t(e.exports,"scaleAndAdd",(()=>E)),t(e.exports,"distance",(()=>w)),t(e.exports,"squaredDistance",(()=>x)),t(e.exports,"squaredLength",(()=>A)),t(e.exports,"negate",(()=>T)),t(e.exports,"inverse",(()=>S)),t(e.exports,"normalize",(()=>M)),t(e.exports,"len",(()=>J)),t(e.exports,"dot",(()=>C)),t(e.exports,"cross",(()=>R)),t(e.exports,"lerp",(()=>I)),t(e.exports,"hermite",(()=>O)),t(e.exports,"bezier",(()=>P)),t(e.exports,"random",(()=>k)),t(e.exports,"transformMat4",(()=>L)),t(e.exports,"transformMat3",(()=>N)),t(e.exports,"transformQuat",(()=>G)),t(e.exports,"rotateX",(()=>D)),t(e.exports,"rotateY",(()=>U)),t(e.exports,"rotateZ",(()=>V)),t(e.exports,"angle",(()=>B)),t(e.exports,"zero",(()=>F)),t(e.exports,"str",(()=>j)),t(e.exports,"exactEquals",(()=>z)),t(e.exports,"equals",(()=>W)),t(e.exports,"sub",(()=>$)),t(e.exports,"mul",(()=>Y)),t(e.exports,"div",(()=>q)),t(e.exports,"dist",(()=>X)),t(e.exports,"sqrDist",(()=>Z)),t(e.exports,"sqrLen",(()=>K)),t(e.exports,"forEach",(()=>Q));var i=s("amnUE");function n(){var e=new i.ARRAY_TYPE(3);return i.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function o(e){var t=new i.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function a(e){var t=e[0],r=e[1],i=e[2];return Math.hypot(t,r,i)}function l(e,t,r){var n=new i.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function c(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function u(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function h(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function d(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function f(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function p(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function m(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function g(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function v(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function _(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function b(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function y(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function E(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e}function w(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.hypot(r,i,n)}function x(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n}function A(e){var t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function S(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function M(e,t){var r=t[0],i=t[1],n=t[2],s=r*r+i*i+n*n;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e}function C(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function R(e,t,r){var i=t[0],n=t[1],s=t[2],o=r[0],a=r[1],l=r[2];return e[0]=n*l-s*a,e[1]=s*o-i*l,e[2]=i*a-n*o,e}function I(e,t,r,i){var n=t[0],s=t[1],o=t[2];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=o+i*(r[2]-o),e}function O(e,t,r,i,n,s){var o=s*s,a=o*(2*s-3)+1,l=o*(s-2)+s,c=o*(s-1),u=o*(3-2*s);return e[0]=t[0]*a+r[0]*l+i[0]*c+n[0]*u,e[1]=t[1]*a+r[1]*l+i[1]*c+n[1]*u,e[2]=t[2]*a+r[2]*l+i[2]*c+n[2]*u,e}function P(e,t,r,i,n,s){var o=1-s,a=o*o,l=s*s,c=a*o,u=3*s*a,h=3*l*o,d=l*s;return e[0]=t[0]*c+r[0]*u+i[0]*h+n[0]*d,e[1]=t[1]*c+r[1]*u+i[1]*h+n[1]*d,e[2]=t[2]*c+r[2]*u+i[2]*h+n[2]*d,e}function k(e,t){t=t||1;var r=2*i.RANDOM()*Math.PI,n=2*i.RANDOM()-1,s=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*s,e[1]=Math.sin(r)*s,e[2]=n*t,e}function L(e,t,r){var i=t[0],n=t[1],s=t[2],o=r[3]*i+r[7]*n+r[11]*s+r[15];return o=o||1,e[0]=(r[0]*i+r[4]*n+r[8]*s+r[12])/o,e[1]=(r[1]*i+r[5]*n+r[9]*s+r[13])/o,e[2]=(r[2]*i+r[6]*n+r[10]*s+r[14])/o,e}function N(e,t,r){var i=t[0],n=t[1],s=t[2];return e[0]=i*r[0]+n*r[3]+s*r[6],e[1]=i*r[1]+n*r[4]+s*r[7],e[2]=i*r[2]+n*r[5]+s*r[8],e}function G(e,t,r){var i=r[0],n=r[1],s=r[2],o=r[3],a=t[0],l=t[1],c=t[2],u=n*c-s*l,h=s*a-i*c,d=i*l-n*a,f=n*d-s*h,p=s*u-i*d,m=i*h-n*u,g=2*o;return u*=g,h*=g,d*=g,f*=2,p*=2,m*=2,e[0]=a+u+f,e[1]=l+h+p,e[2]=c+d+m,e}function D(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0],s[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),s[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function U(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),s[1]=n[1],s[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function V(e,t,r,i){var n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),s[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),s[2]=n[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function B(e,t){var r=e[0],i=e[1],n=e[2],s=t[0],o=t[1],a=t[2],l=Math.sqrt(r*r+i*i+n*n)*Math.sqrt(s*s+o*o+a*a),c=l&&C(e,t)/l;return Math.acos(Math.min(Math.max(c,-1),1))}function F(e){return e[0]=0,e[1]=0,e[2]=0,e}function j(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function z(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function W(e,t){var r=e[0],n=e[1],s=e[2],o=t[0],a=t[1],l=t[2];return Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(s-l)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))}var H,$=d,Y=f,q=p,X=w,Z=x,J=a,K=A,Q=(H=n(),function(e,t,r,i,n,s){var o,a;for(t||(t=3),r||(r=0),a=i?Math.min(i*t+r,e.length):e.length,o=r;o<a;o+=t)H[0]=e[o],H[1]=e[o+1],H[2]=e[o+2],n(H,H,s),e[o]=H[0],e[o+1]=H[1],e[o+2]=H[2];return e})})),s.register("jxhwV",(function(e,r){t(e.exports,"create",(()=>n)),t(e.exports,"clone",(()=>o)),t(e.exports,"fromValues",(()=>a)),t(e.exports,"copy",(()=>l)),t(e.exports,"set",(()=>c)),t(e.exports,"add",(()=>u)),t(e.exports,"subtract",(()=>h)),t(e.exports,"multiply",(()=>d)),t(e.exports,"divide",(()=>f)),t(e.exports,"ceil",(()=>p)),t(e.exports,"floor",(()=>m)),t(e.exports,"min",(()=>g)),t(e.exports,"max",(()=>v)),t(e.exports,"round",(()=>_)),t(e.exports,"scale",(()=>b)),t(e.exports,"scaleAndAdd",(()=>y)),t(e.exports,"distance",(()=>E)),t(e.exports,"squaredDistance",(()=>w)),t(e.exports,"length",(()=>x)),t(e.exports,"squaredLength",(()=>A)),t(e.exports,"negate",(()=>T)),t(e.exports,"inverse",(()=>S)),t(e.exports,"normalize",(()=>M)),t(e.exports,"len",(()=>W)),t(e.exports,"dot",(()=>C)),t(e.exports,"cross",(()=>R)),t(e.exports,"lerp",(()=>I)),t(e.exports,"random",(()=>O)),t(e.exports,"transformMat4",(()=>P)),t(e.exports,"transformQuat",(()=>k)),t(e.exports,"zero",(()=>L)),t(e.exports,"str",(()=>N)),t(e.exports,"exactEquals",(()=>G)),t(e.exports,"equals",(()=>D)),t(e.exports,"sub",(()=>V)),t(e.exports,"mul",(()=>B)),t(e.exports,"div",(()=>F)),t(e.exports,"dist",(()=>j)),t(e.exports,"sqrDist",(()=>z)),t(e.exports,"sqrLen",(()=>H)),t(e.exports,"forEach",(()=>$));var i=s("amnUE");function n(){var e=new i.ARRAY_TYPE(4);return i.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function o(e){var t=new i.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,r,n){var s=new i.ARRAY_TYPE(4);return s[0]=e,s[1]=t,s[2]=r,s[3]=n,s}function l(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function c(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function u(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function h(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function d(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function f(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function p(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function m(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function g(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function v(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function _(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function b(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function y(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function E(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return Math.hypot(r,i,n,s)}function w(e,t){var r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return r*r+i*i+n*n+s*s}function x(e){var t=e[0],r=e[1],i=e[2],n=e[3];return Math.hypot(t,r,i,n)}function A(e){var t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function S(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function M(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],o=r*r+i*i+n*n+s*s;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=s*o,e}function C(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function R(e,t,r,i){var n=r[0]*i[1]-r[1]*i[0],s=r[0]*i[2]-r[2]*i[0],o=r[0]*i[3]-r[3]*i[0],a=r[1]*i[2]-r[2]*i[1],l=r[1]*i[3]-r[3]*i[1],c=r[2]*i[3]-r[3]*i[2],u=t[0],h=t[1],d=t[2],f=t[3];return e[0]=h*c-d*l+f*a,e[1]=-u*c+d*o-f*s,e[2]=u*l-h*o+f*n,e[3]=-u*a+h*s-d*n,e}function I(e,t,r,i){var n=t[0],s=t[1],o=t[2],a=t[3];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=o+i*(r[2]-o),e[3]=a+i*(r[3]-a),e}function O(e,t){var r,n,s,o,a,l;t=t||1;do{a=(r=2*i.RANDOM()-1)*r+(n=2*i.RANDOM()-1)*n}while(a>=1);do{l=(s=2*i.RANDOM()-1)*s+(o=2*i.RANDOM()-1)*o}while(l>=1);var c=Math.sqrt((1-a)/l);return e[0]=t*r,e[1]=t*n,e[2]=t*s*c,e[3]=t*o*c,e}function P(e,t,r){var i=t[0],n=t[1],s=t[2],o=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*s+r[12]*o,e[1]=r[1]*i+r[5]*n+r[9]*s+r[13]*o,e[2]=r[2]*i+r[6]*n+r[10]*s+r[14]*o,e[3]=r[3]*i+r[7]*n+r[11]*s+r[15]*o,e}function k(e,t,r){var i=t[0],n=t[1],s=t[2],o=r[0],a=r[1],l=r[2],c=r[3],u=c*i+a*s-l*n,h=c*n+l*i-o*s,d=c*s+o*n-a*i,f=-o*i-a*n-l*s;return e[0]=u*c+f*-o+h*-l-d*-a,e[1]=h*c+f*-a+d*-o-u*-l,e[2]=d*c+f*-l+u*-a-h*-o,e[3]=t[3],e}function L(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function N(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function G(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function D(e,t){var r=e[0],n=e[1],s=e[2],o=e[3],a=t[0],l=t[1],c=t[2],u=t[3];return Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-l)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-c)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(o-u)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(u))}var U,V=h,B=d,F=f,j=E,z=w,W=x,H=A,$=(U=n(),function(e,t,r,i,n,s){var o,a;for(t||(t=4),r||(r=0),a=i?Math.min(i*t+r,e.length):e.length,o=r;o<a;o+=t)U[0]=e[o],U[1]=e[o+1],U[2]=e[o+2],U[3]=e[o+3],n(U,U,s),e[o]=U[0],e[o+1]=U[1],e[o+2]=U[2],e[o+3]=U[3];return e})})),s.register("6BoVD",(function(e,r){t(e.exports,"create",(()=>n)),t(e.exports,"clone",(()=>o)),t(e.exports,"fromValues",(()=>a)),t(e.exports,"copy",(()=>l)),t(e.exports,"set",(()=>c)),t(e.exports,"add",(()=>u)),t(e.exports,"subtract",(()=>h)),t(e.exports,"multiply",(()=>d)),t(e.exports,"divide",(()=>f)),t(e.exports,"ceil",(()=>p)),t(e.exports,"floor",(()=>m)),t(e.exports,"min",(()=>g)),t(e.exports,"max",(()=>v)),t(e.exports,"round",(()=>_)),t(e.exports,"scale",(()=>b)),t(e.exports,"scaleAndAdd",(()=>y)),t(e.exports,"distance",(()=>E)),t(e.exports,"squaredDistance",(()=>w)),t(e.exports,"length",(()=>x)),t(e.exports,"squaredLength",(()=>A)),t(e.exports,"negate",(()=>T)),t(e.exports,"inverse",(()=>S)),t(e.exports,"normalize",(()=>M)),t(e.exports,"len",(()=>z)),t(e.exports,"dot",(()=>C)),t(e.exports,"cross",(()=>R)),t(e.exports,"lerp",(()=>I)),t(e.exports,"random",(()=>O)),t(e.exports,"transformMat2",(()=>P)),t(e.exports,"transformMat2d",(()=>k)),t(e.exports,"transformMat3",(()=>L)),t(e.exports,"transformMat4",(()=>N)),t(e.exports,"rotate",(()=>G)),t(e.exports,"angle",(()=>D)),t(e.exports,"zero",(()=>U)),t(e.exports,"str",(()=>V)),t(e.exports,"exactEquals",(()=>B)),t(e.exports,"equals",(()=>F)),t(e.exports,"sub",(()=>W)),t(e.exports,"mul",(()=>H)),t(e.exports,"div",(()=>$)),t(e.exports,"dist",(()=>Y)),t(e.exports,"sqrDist",(()=>q)),t(e.exports,"sqrLen",(()=>X)),t(e.exports,"forEach",(()=>Z));var i=s("amnUE");function n(){var e=new i.ARRAY_TYPE(2);return i.ARRAY_TYPE!=Float32Array&&(e[0]=0,e[1]=0),e}function o(e){var t=new i.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t}function a(e,t){var r=new i.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r}function l(e,t){return e[0]=t[0],e[1]=t[1],e}function c(e,t,r){return e[0]=t,e[1]=r,e}function u(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function h(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function d(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function f(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function p(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function m(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function g(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function v(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function _(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function b(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function y(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function E(e,t){var r=t[0]-e[0],i=t[1]-e[1];return Math.hypot(r,i)}function w(e,t){var r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function x(e){var t=e[0],r=e[1];return Math.hypot(t,r)}function A(e){var t=e[0],r=e[1];return t*t+r*r}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e}function S(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function M(e,t){var r=t[0],i=t[1],n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e}function C(e,t){return e[0]*t[0]+e[1]*t[1]}function R(e,t,r){var i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function I(e,t,r,i){var n=t[0],s=t[1];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e}function O(e,t){t=t||1;var r=2*i.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function P(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e}function k(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e}function L(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e}function N(e,t,r){var i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e}function G(e,t,r,i){var n=t[0]-r[0],s=t[1]-r[1],o=Math.sin(i),a=Math.cos(i);return e[0]=n*a-s*o+r[0],e[1]=n*o+s*a+r[1],e}function D(e,t){var r=e[0],i=e[1],n=t[0],s=t[1],o=Math.sqrt(r*r+i*i)*Math.sqrt(n*n+s*s),a=o&&(r*n+i*s)/o;return Math.acos(Math.min(Math.max(a,-1),1))}function U(e){return e[0]=0,e[1]=0,e}function V(e){return"vec2("+e[0]+", "+e[1]+")"}function B(e,t){return e[0]===t[0]&&e[1]===t[1]}function F(e,t){var r=e[0],n=e[1],s=t[0],o=t[1];return Math.abs(r-s)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))}var j,z=x,W=h,H=d,$=f,Y=E,q=w,X=A,Z=(j=n(),function(e,t,r,i,n,s){var o,a;for(t||(t=2),r||(r=0),a=i?Math.min(i*t+r,e.length):e.length,o=r;o<a;o+=t)j[0]=e[o],j[1]=e[o+1],n(j,j,s),e[o]=j[0],e[o+1]=j[1];return e})})),s.register("cTTbu",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MimeTypeUtils=e.exports.PerformanceEvaluator=e.exports.ShapeDiverBackendError=e.exports.ShapeDiverViewerValidationError=e.exports.ShapeDiverViewerCameraError=e.exports.ShapeDiverViewerLightError=e.exports.ShapeDiverViewerArError=e.exports.ShapeDiverViewerUnknownError=e.exports.ShapeDiverViewerGeneralError=e.exports.ShapeDiverViewerSessionError=e.exports.ShapeDiverViewerSettingsError=e.exports.ShapeDiverViewerWebGLError=e.exports.ShapeDiverViewerEnvironmentMapError=e.exports.ShapeDiverViewerDataProcessingError=e.exports.ShapeDiverViewerError=e.exports.LOGGINGTOPIC=e.exports.LOGGINGLEVEL=e.exports.Logger=e.exports.InputValidator=e.exports.TypeChecker=e.exports.Converter=e.exports.UuidGenerator=e.exports.HttpClient=e.exports.DomEventEngine=e.exports.SystemInfo=e.exports.StatePromise=e.exports.StateEngine=e.exports.SettingsEngine=e.exports.EVENTTYPE=e.exports.EventEngine=void 0;var r=s("1Huic");Object.defineProperty(e.exports,"EventEngine",{enumerable:!0,get:function(){return r.EventEngine}});var i=s("72sSa");Object.defineProperty(e.exports,"EVENTTYPE",{enumerable:!0,get:function(){return i.EVENTTYPE}});var n=s("cFn9h");Object.defineProperty(e.exports,"SettingsEngine",{enumerable:!0,get:function(){return n.SettingsEngine}});var o=s("420xc");Object.defineProperty(e.exports,"StateEngine",{enumerable:!0,get:function(){return o.StateEngine}});var a=s("79hWK");Object.defineProperty(e.exports,"SystemInfo",{enumerable:!0,get:function(){return a.SystemInfo}});var l=s("9TywJ");Object.defineProperty(e.exports,"DomEventEngine",{enumerable:!0,get:function(){return l.DomEventEngine}});var c=s("VR2ga");Object.defineProperty(e.exports,"Converter",{enumerable:!0,get:function(){return c.Converter}});var u=s("6UED5");Object.defineProperty(e.exports,"HttpClient",{enumerable:!0,get:function(){return u.HttpClient}});var h=s("htXxy");Object.defineProperty(e.exports,"InputValidator",{enumerable:!0,get:function(){return h.InputValidator}});var d=s("jjvja");Object.defineProperty(e.exports,"TypeChecker",{enumerable:!0,get:function(){return d.TypeChecker}});var f=s("7jcCO");Object.defineProperty(e.exports,"UuidGenerator",{enumerable:!0,get:function(){return f.UuidGenerator}});var p=s("59pJX");Object.defineProperty(e.exports,"PerformanceEvaluator",{enumerable:!0,get:function(){return p.PerformanceEvaluator}});var m=s("iKVTL");Object.defineProperty(e.exports,"Logger",{enumerable:!0,get:function(){return m.Logger}}),Object.defineProperty(e.exports,"LOGGINGLEVEL",{enumerable:!0,get:function(){return m.LOGGINGLEVEL}}),Object.defineProperty(e.exports,"LOGGINGTOPIC",{enumerable:!0,get:function(){return m.LOGGINGTOPIC}});var g=s("cwKgx");Object.defineProperty(e.exports,"MimeTypeUtils",{enumerable:!0,get:function(){return g.MimeTypeUtils}});var v=s("6Vz59");Object.defineProperty(e.exports,"StatePromise",{enumerable:!0,get:function(){return v.StatePromise}});var _=s("1Gbku");Object.defineProperty(e.exports,"ShapeDiverViewerArError",{enumerable:!0,get:function(){return _.ShapeDiverViewerArError}}),Object.defineProperty(e.exports,"ShapeDiverViewerCameraError",{enumerable:!0,get:function(){return _.ShapeDiverViewerCameraError}}),Object.defineProperty(e.exports,"ShapeDiverViewerDataProcessingError",{enumerable:!0,get:function(){return _.ShapeDiverViewerDataProcessingError}}),Object.defineProperty(e.exports,"ShapeDiverViewerEnvironmentMapError",{enumerable:!0,get:function(){return _.ShapeDiverViewerEnvironmentMapError}}),Object.defineProperty(e.exports,"ShapeDiverViewerLightError",{enumerable:!0,get:function(){return _.ShapeDiverViewerLightError}}),Object.defineProperty(e.exports,"ShapeDiverViewerSessionError",{enumerable:!0,get:function(){return _.ShapeDiverViewerSessionError}}),Object.defineProperty(e.exports,"ShapeDiverViewerSettingsError",{enumerable:!0,get:function(){return _.ShapeDiverViewerSettingsError}}),Object.defineProperty(e.exports,"ShapeDiverViewerUnknownError",{enumerable:!0,get:function(){return _.ShapeDiverViewerUnknownError}}),Object.defineProperty(e.exports,"ShapeDiverViewerValidationError",{enumerable:!0,get:function(){return _.ShapeDiverViewerValidationError}}),Object.defineProperty(e.exports,"ShapeDiverViewerGeneralError",{enumerable:!0,get:function(){return _.ShapeDiverViewerGeneralError}}),Object.defineProperty(e.exports,"ShapeDiverViewerWebGLError",{enumerable:!0,get:function(){return _.ShapeDiverViewerWebGLError}});var b=s("l1HmL");Object.defineProperty(e.exports,"ShapeDiverBackendError",{enumerable:!0,get:function(){return b.ShapeDiverError}});var y=s("f03YU");Object.defineProperty(e.exports,"ShapeDiverViewerError",{enumerable:!0,get:function(){return y.ShapeDiverViewerError}})})),s.register("1Huic",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.EventEngine=void 0,s("yoicn");var n=s("bJEmL"),o=s("crO5Z"),a=s("72sSa"),l=s("7jcCO"),c=s("iKVTL");let u=class{constructor(){this._uuidGenerator=n.instance.resolve(l.UuidGenerator),this._logger=n.instance.resolve(c.Logger),this._eventListeners={};for(const e in a.EVENTTYPE){const t=a.EVENTTYPE[e];this._eventListeners[e.toLowerCase()]=[];for(const e in t)this._eventListeners[t[e]]=[]}}convertTypeToString(e){let t="";"string"==typeof e&&(t=e);for(const r in a.EVENTTYPE)e===a.EVENTTYPE[r]&&(t=r.toLowerCase());return t&&this._eventListeners[t]?t:(this._logger.warn(c.LOGGINGTOPIC.GENERAL,"EventEngine.convertTypeToString: No valid type provided."),"")}addListener(e,t){var r;const i=this.convertTypeToString(e);if(!i)return"";const n=this._uuidGenerator.create();return null===(r=this._eventListeners[i])||void 0===r||r.push({token:n,cb:t}),n}emitEvent(e,t){const r=this.convertTypeToString(e);if(this._eventListeners[r]&&0!==this._eventListeners[r].length)for(let e=0;e<this._eventListeners[r].length;e++)this._eventListeners[r][e].cb(t);r.includes(".")&&this.emitEvent(r.substr(0,r.indexOf(".")),t)}removeListener(e){for(const t in a.EVENTTYPE){const r=a.EVENTTYPE[t],i=t.toLowerCase();for(let t=0;t<this._eventListeners[i].length;t++)if(this._eventListeners[i][t].token===e)return this._eventListeners[i].splice(t,1),!0;for(const t in r)for(let i=0;i<this._eventListeners[r[t]].length;i++)if(this._eventListeners[r[t]][i].token===e)return this._eventListeners[r[t]].splice(i,1),!0}return!1}};u=r([o.default(),i("design:paramtypes",[])],u),e.exports.EventEngine=u})),s.register("yoicn",(function(e,r){t(e.exports,"container",(()=>s("bJEmL").instance)),t(e.exports,"singleton",(()=>s("crO5Z").default)),t(e.exports,"injectable",(()=>s("1VbNx").default)),s("kuwep");s("8n7Rh");s("7jxEA"),s("j9aG9"),s("jj3Ep");s("7ztlq"),s("bJEmL");if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.")})),s.register("kuwep",(function(e,t){s("8n7Rh")})),s.register("8n7Rh",(function(e,r){var i,n;t(e.exports,"default",(()=>s)),(n=i||(i={}))[n.Transient=0]="Transient",n[n.Singleton=1]="Singleton",n[n.ResolutionScoped=2]="ResolutionScoped",n[n.ContainerScoped=3]="ContainerScoped";var s=i})),s.register("7jxEA",(function(e,r){t(e.exports,"injectable",(()=>s("1VbNx").default)),t(e.exports,"singleton",(()=>s("crO5Z").default));s("9dd8h"),s("14Vc6"),s("1VbNx"),s("a98us"),s("crO5Z"),s("klx2N"),s("ekUbk"),s("9tj8t"),s("537Ry")})),s.register("9dd8h",(function(e,t){s("7WQrb"),s("VZfAk"),s("bJEmL"),s("hyoCn"),s("cEJd1")})),s.register("7WQrb",(function(e,r){t(e.exports,"__extends",(()=>n)),t(e.exports,"__assign",(()=>s)),t(e.exports,"__rest",(()=>o)),t(e.exports,"__values",(()=>a)),t(e.exports,"__read",(()=>l)),t(e.exports,"__spread",(()=>c));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function n(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)};function o(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]])}return r}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(l(arguments[t]));return e}})),s.register("VZfAk",(function(e,r){t(e.exports,"getParamInfo",(()=>n)),t(e.exports,"defineInjectionTokenMetadata",(()=>s));var i="injectionTokens";function n(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata(i,e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}function s(e,t){return function(r,n,s){var o=Reflect.getOwnMetadata(i,r)||{};o[s]=t?{token:e,transform:t.transformToken,transformArgs:t.args||[]}:e,Reflect.defineMetadata(i,o,r)}}})),s.register("bJEmL",(function(e,r){t(e.exports,"typeInfo",(()=>v)),t(e.exports,"instance",(()=>b));var i=s("7WQrb");s("jj3Ep");var n=s("9ICJi"),o=s("93kIe"),a=s("hzoOf"),l=s("hyoCn"),c=s("9PJzK"),u=s("21YBw"),h=(l=s("hyoCn"),s("e06mi")),d=s("8n7Rh"),f=s("6HvHx"),p=s("cEJd1"),m=s("7ztlq"),g=s("fxojo"),v=new Map,_=function(){function e(e){this.parent=e,this._registry=new h.default,this.interceptors=new g.default}return e.prototype.register=function(e,t,r){var s;if(void 0===r&&(r={lifecycle:d.default.Transient}),s=u.isProvider(t)?t:{useClass:t},n.isTokenProvider(s))for(var l=[e],c=s;null!=c;){var h=c.useToken;if(l.includes(h))throw new Error("Token registration cycle detected! "+i.__spread(l,[h]).join(" -> "));l.push(h);var f=this._registry.get(h);c=f&&n.isTokenProvider(f.provider)?f.provider:null}if((r.lifecycle===d.default.Singleton||r.lifecycle==d.default.ContainerScoped||r.lifecycle==d.default.ResolutionScoped)&&(o.isValueProvider(s)||a.isFactoryProvider(s)))throw new Error('Cannot use lifecycle "'+d.default[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:s,options:r}),this},e.prototype.registerType=function(e,t){return l.isNormalToken(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(l.isNormalToken(e)){if(l.isNormalToken(t))return this.register(e,{useToken:t},{lifecycle:d.default.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:d.default.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!l.isNormalToken(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:d.default.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new f.default);var r=this.getRegistration(e);if(!r&&l.isNormalToken(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),r){var i=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}if(l.isConstructorToken(e)){i=this.construct(e,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,n;if(this.interceptors.preResolution.has(e)){var s=[];try{for(var o=i.__values(this.interceptors.preResolution.getAll(e)),a=o.next();!a.done;a=o.next()){var l=a.value;"Once"!=l.options.frequency&&s.push(l),l.callback(e,t)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,s)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var n,s;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var a=i.__values(this.interceptors.postResolution.getAll(e)),l=a.next();!l.done;l=a.next()){var c=l.value;"Once"!=c.options.frequency&&o.push(c),c.callback(e,t,r)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(s=a.return)&&s.call(a)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(e.options.lifecycle===d.default.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,i=e.options.lifecycle===d.default.Singleton,s=e.options.lifecycle===d.default.ContainerScoped,l=i||s;return r=o.isValueProvider(e.provider)?e.provider.useValue:n.isTokenProvider(e.provider)?l?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):c.isClassProvider(e.provider)?l?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):a.isFactoryProvider(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===d.default.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t){var r=this;void 0===t&&(t=new f.default);var i=this.getAllRegistrations(e);if(!i&&l.isNormalToken(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),i){var n=i.map((function(e){return r.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,n,"All"),n}var s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;try{for(var r=i.__values(this._registry.entries()),n=r.next();!n.done;n=r.next()){var s=i.__read(n.value,2),a=s[0],l=s[1];this._registry.setAll(a,l.filter((function(e){return!o.isValueProvider(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r,n=new e(this);try{for(var s=i.__values(this._registry.entries()),o=s.next();!o.done;o=s.next()){var a=i.__read(o.value,2),l=a[0],c=a[1];c.some((function(e){return e.options.lifecycle===d.default.ContainerScoped}))&&n._registry.setAll(l,c.map((function(e){return e.options.lifecycle===d.default.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof m.DelayedConstructor)return e.createProxy((function(e){return r.resolve(e,t)}));var n=v.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var s=n.map(this.resolveParams(t,e));return new(e.bind.apply(e,i.__spread([void 0],s)))},e.prototype.resolveParams=function(e,t){var r=this;return function(n,s){var o,a,c;try{return l.isTokenDescriptor(n)?l.isTransformDescriptor(n)?n.multiple?(o=r.resolve(n.transform)).transform.apply(o,i.__spread([r.resolveAll(n.token)],n.transformArgs)):(a=r.resolve(n.transform)).transform.apply(a,i.__spread([r.resolve(n.token,e)],n.transformArgs)):n.multiple?r.resolveAll(n.token):r.resolve(n.token,e):l.isTransformDescriptor(n)?(c=r.resolve(n.transform,e)).transform.apply(c,i.__spread([r.resolve(n.token,e)],n.transformArgs)):r.resolve(n,e)}catch(e){throw new Error(p.formatErrorCtor(t,s,e))}}},e}(),b=new _})),s.register("jj3Ep",(function(e,r){t(e.exports,"isClassProvider",(()=>s("9PJzK").isClassProvider)),t(e.exports,"isFactoryProvider",(()=>s("hzoOf").isFactoryProvider)),t(e.exports,"isNormalToken",(()=>s("hyoCn").isNormalToken)),t(e.exports,"isTokenProvider",(()=>s("9ICJi").isTokenProvider)),t(e.exports,"isValueProvider",(()=>s("93kIe").isValueProvider));s("9PJzK"),s("hzoOf"),s("hyoCn"),s("9ICJi"),s("93kIe")})),s.register("9PJzK",(function(e,r){function i(e){return!!e.useClass}t(e.exports,"isClassProvider",(()=>i))})),s.register("hzoOf",(function(e,r){function i(e){return!!e.useFactory}t(e.exports,"isFactoryProvider",(()=>i))})),s.register("hyoCn",(function(e,r){t(e.exports,"isNormalToken",(()=>n)),t(e.exports,"isTokenDescriptor",(()=>o)),t(e.exports,"isTransformDescriptor",(()=>a)),t(e.exports,"isConstructorToken",(()=>l));var i=s("7ztlq");function n(e){return"string"==typeof e||"symbol"==typeof e}function o(e){return"object"==typeof e&&"token"in e&&"multiple"in e}function a(e){return"object"==typeof e&&"token"in e&&"transform"in e}function l(e){return"function"==typeof e||e instanceof i.DelayedConstructor}})),s.register("7ztlq",(function(e,r){t(e.exports,"DelayedConstructor",(()=>n));var i=s("7WQrb"),n=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,i=!1;return new Proxy({},this.createHandler((function(){return i||(t=e(r.wrap()),i=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t[0]=e();var s=Reflect[r];return s.apply(void 0,i.__spread(t))}})),t},e}()})),s.register("9ICJi",(function(e,r){function i(e){return!!e.useToken}t(e.exports,"isTokenProvider",(()=>i))})),s.register("93kIe",(function(e,r){function i(e){return null!=e.useValue}t(e.exports,"isValueProvider",(()=>i))})),s.register("21YBw",(function(e,r){t(e.exports,"isProvider",(()=>l));var i=s("9PJzK"),n=s("93kIe"),o=s("9ICJi"),a=s("hzoOf");function l(e){return i.isClassProvider(e)||n.isValueProvider(e)||o.isTokenProvider(e)||a.isFactoryProvider(e)}})),s.register("e06mi",(function(e,r){t(e.exports,"default",(()=>o));var i=s("7WQrb"),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(s("8KXEt").default),o=n})),s.register("8KXEt",(function(e,r){t(e.exports,"default",(()=>i));var i=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}()})),s.register("6HvHx",(function(e,r){t(e.exports,"default",(()=>i));var i=function(){this.scopedResolutions=new Map}})),s.register("cEJd1",(function(e,r){t(e.exports,"formatErrorCtor",(()=>n));var i=s("7WQrb");function n(e,t,r){var n,s,o,a=i.__read(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],l=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===a?null:a,t);return n="Cannot inject the dependency "+l+' of "'+e.name+'" constructor. Reason:',s=r,void 0===o&&(o="    "),i.__spread([n],s.message.split("\n").map((function(e){return o+e}))).join("\n")}})),s.register("fxojo",(function(e,r){t(e.exports,"default",(()=>l));var i=s("7WQrb"),n=s("8KXEt"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(n.default),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(n.default),l=function(){this.preResolution=new o,this.postResolution=new a}})),s.register("14Vc6",(function(e,t){s("VZfAk")})),s.register("1VbNx",(function(e,r){t(e.exports,"default",(()=>o));var i=s("VZfAk"),n=s("bJEmL");var o=function(){return function(e){n.typeInfo.set(e,i.getParamInfo(e))}}})),s.register("a98us",(function(e,t){s("7WQrb"),s("bJEmL")})),s.register("crO5Z",(function(e,r){t(e.exports,"default",(()=>o));var i=s("1VbNx"),n=s("bJEmL");var o=function(){return function(e){i.default()(e),n.instance.registerSingleton(e)}}})),s.register("klx2N",(function(e,t){s("VZfAk")})),s.register("ekUbk",(function(e,t){s("VZfAk")})),s.register("9tj8t",(function(e,t){s("VZfAk")})),s.register("537Ry",(function(e,t){s("1VbNx"),s("bJEmL")})),s.register("j9aG9",(function(e,t){s("9ebuN"),s("1WZ71"),s("e0QtD")})),s.register("9ebuN",(function(e,t){})),s.register("1WZ71",(function(e,t){})),s.register("e0QtD",(function(e,t){})),s.register("72sSa",(function(e,t){var r,i,n,s,o,a,l,c,u,h,d,f,p;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.EVENTTYPE=e.exports.INTERACTION=e.exports.TASK=e.exports.SETTINGS=e.exports.SESSION=e.exports.VIEWER=e.exports.SCENE=e.exports.RENDERING=e.exports.CAMERA=void 0,(i=r=e.exports.CAMERA||(e.exports.CAMERA={})).CAMERA_START="camera.start",i.CAMERA_MOVE="camera.move",i.CAMERA_END="camera.end",(n=e.exports.RENDERING||(e.exports.RENDERING={})).BEAUTY_RENDERING_FINISHED="rendering.beautyRenderingFinished",(s=e.exports.SCENE||(e.exports.SCENE={})).SCENE_BOUNDING_BOX_CHANGE="scene.boundingBoxChange",(a=o=e.exports.VIEWER||(e.exports.VIEWER={})).VIEWER_CREATED="viewer.created",a.VIEWER_UPDATED="viewer.updated",a.VIEWER_CLOSED="viewer.closed",(c=l=e.exports.SESSION||(e.exports.SESSION={})).SESSION_CREATED="session.created",c.SESSION_CUSTOMIZED="session.customized",c.SESSION_CLOSED="session.closed",c.SESSION_INITIAL_OUTPUTS_LOADED="session.initialOutputsLoaded",(u=e.exports.SETTINGS||(e.exports.SETTINGS={})).SETTINGS_UPDATE="settings.update",(d=h=e.exports.TASK||(e.exports.TASK={})).TASK_START="task.start",d.TASK_PROCESS="task.process",d.TASK_END="task.end",d.TASK_CANCEL="task.cancel",(p=f=e.exports.INTERACTION||(e.exports.INTERACTION={})).DRAG_START="interaction.drag.start",p.DRAG_MOVE="interaction.drag.move",p.DRAG_END="interaction.drag.end",p.HOVER_ON="interaction.hover.on",p.HOVER_OFF="interaction.hover.off",p.SELECT_ON="interaction.select.on",p.SELECT_OFF="interaction.select.off",e.exports.EVENTTYPE={CAMERA:r,RENDERING:n,SCENE:s,SESSION:l,SETTINGS:u,VIEWER:o,INTERACTION:f,TASK:h}})),s.register("7jcCO",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.UuidGenerator=void 0,s("yoicn");var i=s("crO5Z"),n=s("5sKyw"),o=s("64ZUg"),a=s("fHCYh"),l=s("2uohp");let c=class{create(){return n.default()}validate(e){return o.default(e)}parse(e){return a.default(e)}stringify(e){return l.default(e)}};c=r([i.default()],c),e.exports.UuidGenerator=c})),s.register("5sKyw",(function(e,r){t(e.exports,"default",(()=>o));var i=s("7qKRb"),n=s("2uohp");var o=function(e,t,r){var s=(e=e||{}).random||(e.rng||i.default)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(var o=0;o<16;++o)t[r+o]=s[o];return t}return n.default(s)}})),s.register("7qKRb",(function(e,r){var i;t(e.exports,"default",(()=>s));var n=new Uint8Array(16);function s(){if(!i&&!(i="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(n)}})),s.register("2uohp",(function(e,r){t(e.exports,"default",(()=>a));for(var i=s("64ZUg"),n=[],o=0;o<256;++o)n.push((o+256).toString(16).substr(1));var a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+"-"+n[e[t+4]]+n[e[t+5]]+"-"+n[e[t+6]]+n[e[t+7]]+"-"+n[e[t+8]]+n[e[t+9]]+"-"+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase();if(!i.default(r))throw TypeError("Stringified UUID is invalid");return r}})),s.register("64ZUg",(function(e,r){t(e.exports,"default",(()=>n));var i=s("4meF0");var n=function(e){return"string"==typeof e&&i.default.test(e)}})),s.register("4meF0",(function(e,r){t(e.exports,"default",(()=>i));var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i})),s.register("fHCYh",(function(e,r){t(e.exports,"default",(()=>n));var i=s("64ZUg");var n=function(e){if(!i.default(e))throw TypeError("Invalid UUID");var t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}})),s.register("iKVTL",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},o=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Logger=e.exports.LOGGINGTOPIC=e.exports.LOGGINGLEVEL=void 0;const l=o(s("aDaS8"));s("yoicn");var c,u,h,d=s("bJEmL"),f=s("crO5Z"),p=s("imozB"),m=s("eXqCS"),g=s("7jcCO"),v=s("1Gbku"),_=s("l1HmL"),b=s("f03YU");(u=c=e.exports.LOGGINGLEVEL||(e.exports.LOGGINGLEVEL={})).NONE="none",u.ERROR="error",u.FATAL="fatal",u.WARN="warn",u.INFO="info",u.DEBUG="debug",u.DEBUG_HIGH="debug_high",u.DEBUG_MEDIUM="debug_medium",u.DEBUG_LOW="debug_low",(h=e.exports.LOGGINGTOPIC||(e.exports.LOGGINGTOPIC={})).AR="ar",h.GENERAL="general",h.EXPORT="export",h.PARAMETER="parameter",h.OUTPUT="output",h.SESSION="session",h.VIEWER="viewer",h.CAMERA="camera",h.LIGHT="light",h.CAMERA_CONTROL="camera_control",h.DATA_PROCESSING="data_processing",h.SDTF="sdtf",h.THREE="three",h.SETTINGS="settings";let y=class{constructor(){this._loggingLevel=c.WARN,this._showMessages=!0,this._breadCrumbs=[],this._breadCrumbCounter=0,this._uuidGenerator=d.instance.resolve(g.UuidGenerator),this._userId=this._uuidGenerator.create();const e=new(s("gWrK2").BrowserClient)({dsn:"https://0510990697b04b9da3ad07868e94e378@o363881.ingest.sentry.io/5828729",environment:"local",release:p.build_data.build_version,maxBreadcrumbs:100,beforeBreadcrumb:(e,t)=>(this._breadCrumbCounter++,e),beforeSend:(e,t)=>(e.level===l.Severity.Debug&&(e.fingerprint?e.fingerprint.push(this._userId+""):e.fingerprint=[this._userId+""]),e),tracesSampleRate:1});this._sentryHub=new(s("8x56E").Hub)(e),this._sentryHub.setUser({id:this._userId})}get loggingLevel(){return this._loggingLevel}set loggingLevel(e){this._loggingLevel=e}get showMessages(){return this._showMessages}set showMessages(e){this._showMessages=e}canLog(e){switch(this.loggingLevel){case c.ERROR:if(e===c.FATAL)return!1;if(e===c.WARN)return!1;if(e===c.INFO)return!1;if(e===c.DEBUG)return!1;if(e===c.DEBUG_HIGH)return!1;if(e===c.DEBUG_MEDIUM)return!1;if(e===c.DEBUG_LOW)return!1;case c.FATAL:if(e===c.WARN)return!1;if(e===c.INFO)return!1;if(e===c.DEBUG)return!1;if(e===c.DEBUG_HIGH)return!1;if(e===c.DEBUG_MEDIUM)return!1;if(e===c.DEBUG_LOW)return!1;case c.WARN:if(e===c.INFO)return!1;if(e===c.DEBUG)return!1;if(e===c.DEBUG_HIGH)return!1;if(e===c.DEBUG_MEDIUM)return!1;if(e===c.DEBUG_LOW)return!1;case c.INFO:if(e===c.DEBUG)return!1;if(e===c.DEBUG_HIGH)return!1;if(e===c.DEBUG_MEDIUM)return!1;if(e===c.DEBUG_LOW)return!1;case c.DEBUG_HIGH:if(e===c.DEBUG_MEDIUM)return!1;if(e===c.DEBUG_LOW)return!1;case c.DEBUG_MEDIUM:if(e===c.DEBUG_LOW)return!1;case c.DEBUG_LOW:case c.DEBUG:default:return!0}}handleError(e,t,r,i=!0){if(this.canLog(c.ERROR)&&!0===this.showMessages&&console.error("(ERROR) ",r),r instanceof _.ShapeDiverRequestError){const n=r&&r.message?r.message:`An unknown issue occurred in ${t}.`;throw i&&this.sentryError(e,r,n),r}if(r instanceof _.ShapeDiverResponseError&&r.error===_.ShapeDiverResponseErrorType.UNKNOWN){const n=r&&r.message?r.message:`An unknown issue occurred in ${t}.`;throw i&&this.sentryError(e,r,n),r}if(r instanceof _.ShapeDiverResponseError)throw r;if(r instanceof b.ShapeDiverViewerError){const n=r&&r.message?r.message:`An unknown issue occurred in ${t}.`;throw i&&this.sentryError(e,r,n),r}if(r){const n=r.message?r.message:`An unknown issue occurred in ${t}.`,s=new v.ShapeDiverViewerUnknownError(n,r);throw i&&this.sentryError(e,s,n),s}}sentryError(e,t,r){var i;this.sentryBreadcrumb(e,r||t.message,l.Severity.Error);const n=this._breadCrumbCounter>100?100:this._breadCrumbCounter;for(let t=n;t<this._breadCrumbs.length+n;t++)t%100==0&&0!==t&&(this._sentryHub.setTag("topic",e),this._sentryHub.setUser({id:this._userId}),this._sentryHub.captureMessage("Breadcrumb Issue "+(t/100-1)+" ("+this._userId+")",l.Severity.Debug),null===(i=this._sentryHub.getScope())||void 0===i||i.clear()),this._sentryHub.addBreadcrumb(this._breadCrumbs[t-n]);this._sentryHub.setTag("topic",e),this._sentryHub.setUser({id:this._userId}),t instanceof m.ShapeDiverError||t instanceof b.ShapeDiverViewerError?this._sentryHub.captureMessage(t.message,l.Severity.Error):this._sentryHub.captureException(t)}sentryBreadcrumb(e,t,r){this._breadCrumbs.push({category:e,message:t,level:l.Severity.Debug,timestamp:Math.floor((new Date).getTime()/1e3)})}debug(e,t){this.canLog(c.DEBUG)&&!0===this.showMessages&&console.debug("(DEBUG) "+this.messageConstruction(t))}debugHigh(e,t){this.canLog(c.DEBUG_HIGH)&&!0===this.showMessages&&console.debug("(DEBUG_HIGH) "+this.messageConstruction(t))}debugLow(e,t){this.canLog(c.DEBUG_LOW)&&!0===this.showMessages&&console.debug("(DEBUG_LOW) "+this.messageConstruction(t))}debugMedium(e,t){this.canLog(c.DEBUG_MEDIUM)&&!0===this.showMessages&&console.debug("(DEBUG_MEDIUM) "+this.messageConstruction(t))}error(e,t,r,i=!1,n=!0){if(this.sentryBreadcrumb(e,r||t.message,l.Severity.Error),n&&this.sentryError(e,t,r),this.canLog(c.ERROR)&&!0===this.showMessages&&console.error("(ERROR) "+this.messageConstruction(r||t.message)),i)throw t}fatal(e,t,r,i=!1){if(this.sentryBreadcrumb(e,t,l.Severity.Fatal),this.sentryError(e,r,t),this.canLog(c.FATAL)&&!0===this.showMessages&&console.error("(FATAL) "+this.messageConstruction(t)),i)throw r}info(e,t){this.sentryBreadcrumb(e,t,l.Severity.Info),this.canLog(c.INFO)&&!0===this.showMessages&&console.info("(INFO) "+this.messageConstruction(t))}warn(e,t){this.sentryBreadcrumb(e,t,l.Severity.Warning),this.canLog(c.WARN)&&!0===this.showMessages&&console.warn("(WARN) "+this.messageConstruction(t))}messageConstruction(e){return(new Date).toISOString()+": "+e}};y=n([f.default(),a("design:paramtypes",[])],y),e.exports.Logger=y})),s.register("aDaS8",(function(e,i){t(e.exports,"Integrations",(()=>d)),t(e.exports,"Transports",(()=>s("1IBJy")));var n=s("7WQrb"),o=s("icP6J");s("lD3gc");var a=s("42ap3"),l=s("a05ws"),c=(s("1IBJy"),s("4QUMh")),u={},h=a.getGlobalObject();h.Sentry&&h.Sentry.Integrations&&(u=h.Sentry.Integrations);var d=n.__assign(n.__assign(n.__assign({},u),o),l);r(e.exports,c)})),s.register("icP6J",(function(e,r){t(e.exports,"FunctionToString",(()=>s("hKg1m").FunctionToString)),t(e.exports,"InboundFilters",(()=>s("6jMsx").InboundFilters));s("hKg1m"),s("6jMsx")})),s.register("hKg1m",(function(e,r){t(e.exports,"FunctionToString",(()=>o)),s("lD3gc");var i,n=s("jL8lq"),o=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){i=Function.prototype.toString,Function.prototype.toString=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=n.getOriginalFunction(this)||this;return i.apply(r,e)}},e.id="FunctionToString",e}()})),s.register("lD3gc",(function(e,i){t(e.exports,"forget",(()=>s("5Jod9").forget)),t(e.exports,"getLocationHref",(()=>s("ibKgU").getLocationHref)),t(e.exports,"htmlTreeAsString",(()=>s("ibKgU").htmlTreeAsString)),t(e.exports,"dsnToString",(()=>s("ldaPw").dsnToString)),t(e.exports,"makeDsn",(()=>s("ldaPw").makeDsn)),t(e.exports,"SentryError",(()=>s("bLvfM").SentryError)),t(e.exports,"getGlobalObject",(()=>s("42ap3").getGlobalObject)),t(e.exports,"getGlobalSingleton",(()=>s("42ap3").getGlobalSingleton)),t(e.exports,"addInstrumentationHandler",(()=>s("js14m").addInstrumentationHandler)),t(e.exports,"isEvent",(()=>s("2zW56").isEvent)),t(e.exports,"isErrorEvent",(()=>s("2zW56").isErrorEvent)),t(e.exports,"isDOMError",(()=>s("2zW56").isDOMError)),t(e.exports,"isDOMException",(()=>s("2zW56").isDOMException)),t(e.exports,"isError",(()=>s("2zW56").isError)),t(e.exports,"isPlainObject",(()=>s("2zW56").isPlainObject)),t(e.exports,"isInstanceOf",(()=>s("2zW56").isInstanceOf)),t(e.exports,"isString",(()=>s("2zW56").isString)),t(e.exports,"isPrimitive",(()=>s("2zW56").isPrimitive)),t(e.exports,"isThenable",(()=>s("2zW56").isThenable)),t(e.exports,"logger",(()=>s("4g0Ct").logger)),t(e.exports,"consoleSandbox",(()=>s("4g0Ct").consoleSandbox)),t(e.exports,"addExceptionTypeValue",(()=>s("b1E2c").addExceptionTypeValue)),t(e.exports,"addExceptionMechanism",(()=>s("b1E2c").addExceptionMechanism)),t(e.exports,"getEventDescription",(()=>s("b1E2c").getEventDescription)),t(e.exports,"parseUrl",(()=>s("b1E2c").parseUrl)),t(e.exports,"checkOrSetAlreadyCaught",(()=>s("b1E2c").checkOrSetAlreadyCaught)),t(e.exports,"uuid4",(()=>s("b1E2c").uuid4)),t(e.exports,"normalizeToSize",(()=>s("drMc1").normalizeToSize)),t(e.exports,"normalize",(()=>s("drMc1").normalize)),t(e.exports,"getOriginalFunction",(()=>s("jL8lq").getOriginalFunction)),t(e.exports,"markFunctionWrapped",(()=>s("jL8lq").markFunctionWrapped)),t(e.exports,"addNonEnumerableProperty",(()=>s("jL8lq").addNonEnumerableProperty)),t(e.exports,"extractExceptionKeysForMessage",(()=>s("jL8lq").extractExceptionKeysForMessage)),t(e.exports,"fill",(()=>s("jL8lq").fill)),t(e.exports,"urlEncode",(()=>s("jL8lq").urlEncode)),t(e.exports,"dropUndefinedKeys",(()=>s("jL8lq").dropUndefinedKeys)),t(e.exports,"makePromiseBuffer",(()=>s("jpxdy").makePromiseBuffer)),t(e.exports,"severityFromString",(()=>s("aU92a").severityFromString)),t(e.exports,"createStackParser",(()=>s("16dZf").createStackParser)),t(e.exports,"getFunctionName",(()=>s("16dZf").getFunctionName)),t(e.exports,"eventStatusFromHttpCode",(()=>s("isOOR").eventStatusFromHttpCode)),t(e.exports,"safeJoin",(()=>s("91U3U").safeJoin)),t(e.exports,"truncate",(()=>s("91U3U").truncate)),t(e.exports,"isMatchingPattern",(()=>s("91U3U").isMatchingPattern)),t(e.exports,"supportsReferrerPolicy",(()=>s("esO9h").supportsReferrerPolicy)),t(e.exports,"supportsFetch",(()=>s("esO9h").supportsFetch)),t(e.exports,"isNativeFetch",(()=>s("esO9h").isNativeFetch)),t(e.exports,"resolvedSyncPromise",(()=>s("j3a3y").resolvedSyncPromise)),t(e.exports,"SyncPromise",(()=>s("j3a3y").SyncPromise)),t(e.exports,"rejectedSyncPromise",(()=>s("j3a3y").rejectedSyncPromise)),t(e.exports,"serializeEnvelope",(()=>s("3PPTH").serializeEnvelope)),t(e.exports,"createEnvelope",(()=>s("3PPTH").createEnvelope)),t(e.exports,"getEnvelopeType",(()=>s("3PPTH").getEnvelopeType)),t(e.exports,"createClientReportEnvelope",(()=>s("iDlgA").createClientReportEnvelope)),t(e.exports,"updateRateLimits",(()=>s("jf8Z1").updateRateLimits)),t(e.exports,"disabledUntil",(()=>s("jf8Z1").disabledUntil)),t(e.exports,"isRateLimited",(()=>s("jf8Z1").isRateLimited)),s("5Jod9"),s("ibKgU"),s("ldaPw"),s("bLvfM"),s("42ap3"),s("js14m"),s("2zW56"),s("4g0Ct"),s("b1E2c");var n=s("289ZW");s("drMc1"),s("jL8lq"),s("jpxdy"),s("aU92a"),s("16dZf"),s("isOOR"),s("91U3U"),s("esO9h"),s("j3a3y");var o=s("cvSY8");s("3PPTH"),s("iDlgA"),s("jf8Z1"),r(e.exports,n),r(e.exports,o)})),s.register("5Jod9",(function(e,r){function i(e){e.then(null,(function(e){console.error(e)}))}t(e.exports,"forget",(()=>i))})),s.register("ibKgU",(function(e,r){t(e.exports,"htmlTreeAsString",(()=>o)),t(e.exports,"getLocationHref",(()=>l));var i=s("42ap3"),n=s("2zW56");function o(e,t){try{for(var r=e,i=[],n=0,s=0,o=" > ".length,l=void 0;r&&n++<5&&!("html"===(l=a(r,t))||n>1&&s+i.length*o+l.length>=80);)i.push(l),s+=l.length,r=r.parentNode;return i.reverse().join(" > ")}catch(e){return"<unknown>"}}function a(e,t){var r,i,s,o,a,l=e,c=[];if(!l||!l.tagName)return"";c.push(l.tagName.toLowerCase());var u=t&&t.length?t.filter((function(e){return l.getAttribute(e)})).map((function(e){return[e,l.getAttribute(e)]})):null;if(u&&u.length)u.forEach((function(e){c.push("["+e[0]+'="'+e[1]+'"]')}));else if(l.id&&c.push("#"+l.id),(r=l.className)&&n.isString(r))for(i=r.split(/\s+/),a=0;a<i.length;a++)c.push("."+i[a]);var h=["type","name","title","alt"];for(a=0;a<h.length;a++)s=h[a],(o=l.getAttribute(s))&&c.push("["+s+'="'+o+'"]');return c.join("")}function l(){var e=i.getGlobalObject();try{return e.document.location.href}catch(e){return""}}})),s.register("42ap3",(function(r,i){t(r.exports,"getGlobalObject",(()=>a)),t(r.exports,"getGlobalSingleton",(()=>l));var n=s("289ZW"),o={};function a(){return n.isNodeEnv()?e:"undefined"!=typeof window?window:"undefined"!=typeof self?self:o}function l(e,t,r){var i=r||a(),n=i.__SENTRY__=i.__SENTRY__||{};return n[e]||(n[e]=t())}})),s.register("289ZW",(function(e,r){t(e.exports,"isNodeEnv",(()=>o),(e=>o=e)),t(e.exports,"dynamicRequire",(()=>a),(e=>a=e));var i=s("Wgg6o"),n=s("hPtJY");function o(){return!i.isBrowserBundle()&&"[object process]"===Object.prototype.toString.call(void 0!==n?n:0)}function a(e,t){return e.require(t)}})),s.register("Wgg6o",(function(e,r){function i(){return"undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}t(e.exports,"isBrowserBundle",(()=>i))})),s.register("2zW56",(function(e,r){t(e.exports,"isError",(()=>n)),t(e.exports,"isInstanceOf",(()=>_)),t(e.exports,"isErrorEvent",(()=>o)),t(e.exports,"isDOMError",(()=>a)),t(e.exports,"isDOMException",(()=>l)),t(e.exports,"isString",(()=>c)),t(e.exports,"isPrimitive",(()=>u)),t(e.exports,"isPlainObject",(()=>h)),t(e.exports,"isEvent",(()=>d)),t(e.exports,"isElement",(()=>f)),t(e.exports,"isRegExp",(()=>p)),t(e.exports,"isThenable",(()=>m)),t(e.exports,"isSyntheticEvent",(()=>g)),t(e.exports,"isNaN",(()=>v));var i=Object.prototype.toString;function n(e){switch(i.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return _(e,Error)}}function s(e,t){return i.call(e)==="[object "+t+"]"}function o(e){return s(e,"ErrorEvent")}function a(e){return s(e,"DOMError")}function l(e){return s(e,"DOMException")}function c(e){return s(e,"String")}function u(e){return null===e||"object"!=typeof e&&"function"!=typeof e}function h(e){return s(e,"Object")}function d(e){return"undefined"!=typeof Event&&_(e,Event)}function f(e){return"undefined"!=typeof Element&&_(e,Element)}function p(e){return s(e,"RegExp")}function m(e){return Boolean(e&&e.then&&"function"==typeof e.then)}function g(e){return h(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function v(e){return"number"==typeof e&&e!=e}function _(e,t){try{return e instanceof t}catch(e){return!1}}})),s.register("ldaPw",(function(e,r){t(e.exports,"dsnToString",(()=>l)),t(e.exports,"makeDsn",(()=>u));var i=s("7WQrb"),n=s("bLvfM"),o=s("eSt2C"),a=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+))?@)([\w.-]+)(?::(\d+))?\/(.+)/;function l(e,t){void 0===t&&(t=!1);var r=e.host,i=e.path,n=e.pass,s=e.port,o=e.projectId;return e.protocol+"://"+e.publicKey+(t&&n?":"+n:"")+"@"+r+(s?":"+s:"")+"/"+(i?i+"/":i)+o}function c(e){return"user"in e&&!("publicKey"in e)&&(e.publicKey=e.user),{user:e.publicKey||"",protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function u(e){var t="string"==typeof e?function(e){var t=a.exec(e);if(!t)throw new n.SentryError("Invalid Sentry Dsn: "+e);var r=i.__read(t.slice(1),6),s=r[0],o=r[1],l=r[2],u=void 0===l?"":l,h=r[3],d=r[4],f=void 0===d?"":d,p="",m=r[5],g=m.split("/");if(g.length>1&&(p=g.slice(0,-1).join("/"),m=g.pop()),m){var v=m.match(/^\d+/);v&&(m=v[0])}return c({host:h,pass:u,path:p,projectId:m,port:f,protocol:s,publicKey:o})}(e):c(e);return function(e){if(o.IS_DEBUG_BUILD){var t=e.port,r=e.projectId,i=e.protocol;if(["protocol","publicKey","host","projectId"].forEach((function(t){if(!e[t])throw new n.SentryError("Invalid Sentry Dsn: "+t+" missing")})),!r.match(/^\d+$/))throw new n.SentryError("Invalid Sentry Dsn: Invalid projectId "+r);if(!function(e){return"http"===e||"https"===e}(i))throw new n.SentryError("Invalid Sentry Dsn: Invalid protocol "+i);if(t&&isNaN(parseInt(t,10)))throw new n.SentryError("Invalid Sentry Dsn: Invalid port "+t)}}(t),t}})),s.register("bLvfM",(function(e,r){t(e.exports,"SentryError",(()=>o));var i=s("7WQrb"),n=s("iL9qS"),o=function(e){function t(t){var r=this.constructor,i=e.call(this,t)||this;return i.message=t,i.name=r.prototype.constructor.name,n.setPrototypeOf(i,r.prototype),i}return i.__extends(t,e),t}(Error)})),s.register("iL9qS",(function(e,r){t(e.exports,"setPrototypeOf",(()=>i));var i=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){return e.__proto__=t,e}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(e,r)||(e[r]=t[r]);return e})})),s.register("eSt2C",(function(e,r){t(e.exports,"IS_DEBUG_BUILD",(()=>i));var i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__})),s.register("js14m",(function(e,r){t(e.exports,"addInstrumentationHandler",(()=>v));var i,n=s("7WQrb"),o=s("eSt2C"),a=s("42ap3"),l=s("2zW56"),c=s("4g0Ct"),u=s("jL8lq"),h=s("16dZf"),d=s("esO9h"),f=a.getGlobalObject(),p={},m={};function g(e){if(!m[e])switch(m[e]=!0,e){case"console":!function(){if(!("console"in f))return;c.CONSOLE_LEVELS.forEach((function(e){e in f.console&&u.fill(f.console,e,(function(t){return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];_("console",{args:r,level:e}),t&&t.apply(f.console,r)}}))}))}();break;case"dom":!function(){if(!("document"in f))return;var e=_.bind(null,"dom"),t=x(e,!0);f.document.addEventListener("click",t,!1),f.document.addEventListener("keypress",t,!1),["EventTarget","Node"].forEach((function(t){var r=f[t]&&f[t].prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(u.fill(r,"addEventListener",(function(t){return function(r,i,n){if("click"===r||"keypress"==r)try{var s=this,o=s.__sentry_instrumentation_handlers__=s.__sentry_instrumentation_handlers__||{},a=o[r]=o[r]||{refCount:0};if(!a.handler){var l=x(e);a.handler=l,t.call(this,r,l,n)}a.refCount+=1}catch(e){}return t.call(this,r,i,n)}})),u.fill(r,"removeEventListener",(function(e){return function(t,r,i){if("click"===t||"keypress"==t)try{var n=this,s=n.__sentry_instrumentation_handlers__||{},o=s[t];o&&(o.refCount-=1,o.refCount<=0&&(e.call(this,t,o.handler,i),o.handler=void 0,delete s[t]),0===Object.keys(s).length&&delete n.__sentry_instrumentation_handlers__)}catch(e){}return e.call(this,t,r,i)}})))}))}();break;case"xhr":!function(){if(!("XMLHttpRequest"in f))return;var e=XMLHttpRequest.prototype;u.fill(e,"open",(function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=this,n=t[1],s=i.__sentry_xhr__={method:l.isString(t[0])?t[0].toUpperCase():t[0],url:t[1]};l.isString(n)&&"POST"===s.method&&n.match(/sentry_key/)&&(i.__sentry_own_request__=!0);var o=function(){if(4===i.readyState){try{s.status_code=i.status}catch(e){}_("xhr",{args:t,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:i})}};return"onreadystatechange"in i&&"function"==typeof i.onreadystatechange?u.fill(i,"onreadystatechange",(function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return o(),e.apply(i,t)}})):i.addEventListener("readystatechange",o),e.apply(i,t)}})),u.fill(e,"send",(function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return this.__sentry_xhr__&&void 0!==t[0]&&(this.__sentry_xhr__.body=t[0]),_("xhr",{args:t,startTimestamp:Date.now(),xhr:this}),e.apply(this,t)}}))}();break;case"fetch":!function(){if(!d.supportsNativeFetch())return;u.fill(f,"fetch",(function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i={args:t,fetchData:{method:b(t),url:y(t)},startTimestamp:Date.now()};return _("fetch",n.__assign({},i)),e.apply(f,t).then((function(e){return _("fetch",n.__assign(n.__assign({},i),{endTimestamp:Date.now(),response:e})),e}),(function(e){throw _("fetch",n.__assign(n.__assign({},i),{endTimestamp:Date.now(),error:e})),e}))}}))}();break;case"history":!function(){if(!d.supportsHistory())return;var e=f.onpopstate;function t(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t.length>2?t[2]:void 0;if(n){var s=i,o=String(n);i=o,_("history",{from:s,to:o})}return e.apply(this,t)}}f.onpopstate=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=f.location.href,s=i;if(i=n,_("history",{from:s,to:n}),e)try{return e.apply(this,t)}catch(e){}},u.fill(f.history,"pushState",t),u.fill(f.history,"replaceState",t)}();break;case"error":A=f.onerror,f.onerror=function(e,t,r,i,n){return _("error",{column:i,error:n,line:r,msg:e,url:t}),!!A&&A.apply(this,arguments)};break;case"unhandledrejection":T=f.onunhandledrejection,f.onunhandledrejection=function(e){return _("unhandledrejection",e),!T||T.apply(this,arguments)};break;default:return void(o.IS_DEBUG_BUILD&&c.logger.warn("unknown instrumentation type:",e))}}function v(e,t){p[e]=p[e]||[],p[e].push(t),g(e)}function _(e,t){var r,i;if(e&&p[e])try{for(var s=n.__values(p[e]||[]),a=s.next();!a.done;a=s.next()){var l=a.value;try{l(t)}catch(t){o.IS_DEBUG_BUILD&&c.logger.error("Error while triggering instrumentation handler.\nType: "+e+"\nName: "+h.getFunctionName(l)+"\nError:",t)}}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}function b(e){return void 0===e&&(e=[]),"Request"in f&&l.isInstanceOf(e[0],Request)&&e[0].method?String(e[0].method).toUpperCase():e[1]&&e[1].method?String(e[1].method).toUpperCase():"GET"}function y(e){return void 0===e&&(e=[]),"string"==typeof e[0]?e[0]:"Request"in f&&l.isInstanceOf(e[0],Request)?e[0].url:String(e[0])}var E,w;function x(e,t){return void 0===t&&(t=!1),function(r){if(r&&w!==r&&!function(e){if("keypress"!==e.type)return!1;try{var t=e.target;if(!t||!t.tagName)return!0;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return!1}catch(e){}return!0}(r)){var i="keypress"===r.type?"input":r.type;(void 0===E||function(e,t){if(!e)return!0;if(e.type!==t.type)return!0;try{if(e.target!==t.target)return!0}catch(e){}return!1}(w,r))&&(e({event:r,name:i,global:t}),w=r),clearTimeout(E),E=f.setTimeout((function(){E=void 0}),1e3)}}}var A=null;var T=null})),s.register("4g0Ct",(function(e,r){t(e.exports,"CONSOLE_LEVELS",(()=>c)),t(e.exports,"consoleSandbox",(()=>u)),t(e.exports,"logger",(()=>i));var i,n=s("7WQrb"),o=s("eSt2C"),a=s("42ap3"),l=a.getGlobalObject(),c=["debug","info","warn","error","log","assert"];function u(e){var t=a.getGlobalObject();if(!("console"in t))return e();var r=t.console,i={};c.forEach((function(e){var n=r[e]&&r[e].__sentry_original__;e in t.console&&n&&(i[e]=r[e],r[e]=n)}));try{return e()}finally{Object.keys(i).forEach((function(e){r[e]=i[e]}))}}function h(){var e=!1,t={enable:function(){e=!0},disable:function(){e=!1}};return o.IS_DEBUG_BUILD?c.forEach((function(r){t[r]=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e&&u((function(){var e;(e=l.console)[r].apply(e,n.__spread(["Sentry Logger ["+r+"]:"],t))}))}})):c.forEach((function(e){t[e]=function(){}})),t}i=o.IS_DEBUG_BUILD?a.getGlobalSingleton("logger",h):h()})),s.register("jL8lq",(function(e,r){t(e.exports,"fill",(()=>l)),t(e.exports,"markFunctionWrapped",(()=>u)),t(e.exports,"addNonEnumerableProperty",(()=>c)),t(e.exports,"getOriginalFunction",(()=>h)),t(e.exports,"urlEncode",(()=>d)),t(e.exports,"convertToPlainObject",(()=>f)),t(e.exports,"extractExceptionKeysForMessage",(()=>g)),t(e.exports,"dropUndefinedKeys",(()=>v));var i=s("7WQrb"),n=s("ibKgU"),o=s("2zW56"),a=s("91U3U");function l(e,t,r){if(t in e){var i=e[t],n=r(i);if("function"==typeof n)try{u(n,i)}catch(e){}e[t]=n}}function c(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,configurable:!0})}function u(e,t){var r=t.prototype||{};e.prototype=t.prototype=r,c(e,"__sentry_original__",t)}function h(e){return e.__sentry_original__}function d(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}function f(e){var t=e;if(o.isError(e))t=i.__assign({message:e.message,name:e.name,stack:e.stack},m(e));else if(o.isEvent(e)){var r=e;t=i.__assign({type:r.type,target:p(r.target),currentTarget:p(r.currentTarget)},m(r)),"undefined"!=typeof CustomEvent&&o.isInstanceOf(e,CustomEvent)&&(t.detail=r.detail)}return t}function p(e){try{return o.isElement(e)?n.htmlTreeAsString(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}}function m(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function g(e,t){void 0===t&&(t=40);var r=Object.keys(f(e));if(r.sort(),!r.length)return"[object has no keys]";if(r[0].length>=t)return a.truncate(r[0],t);for(var i=r.length;i>0;i--){var n=r.slice(0,i).join(", ");if(!(n.length>t))return i===r.length?n:a.truncate(n,t)}return""}function v(e){var t,r;if(o.isPlainObject(e)){var n={};try{for(var s=i.__values(Object.keys(e)),a=s.next();!a.done;a=s.next()){var l=a.value;void 0!==e[l]&&(n[l]=v(e[l]))}}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return n}return Array.isArray(e)?e.map(v):e}})),s.register("91U3U",(function(e,r){t(e.exports,"truncate",(()=>n)),t(e.exports,"snipLine",(()=>o)),t(e.exports,"safeJoin",(()=>a)),t(e.exports,"isMatchingPattern",(()=>l));var i=s("2zW56");function n(e,t){return void 0===t&&(t=0),"string"!=typeof e||0===t||e.length<=t?e:e.substr(0,t)+"..."}function o(e,t){var r=e,i=r.length;if(i<=150)return r;t>i&&(t=i);var n=Math.max(t-60,0);n<5&&(n=0);var s=Math.min(n+140,i);return s>i-5&&(s=i),s===i&&(n=Math.max(s-140,0)),r=r.slice(n,s),n>0&&(r="'{snip} "+r),s<i&&(r+=" {snip}"),r}function a(e,t){if(!Array.isArray(e))return"";for(var r=[],i=0;i<e.length;i++){var n=e[i];try{r.push(String(n))}catch(e){r.push("[value cannot be serialized]")}}return r.join(t)}function l(e,t){return!!i.isString(e)&&(i.isRegExp(t)?t.test(e):"string"==typeof t&&-1!==e.indexOf(t))}})),s.register("16dZf",(function(e,r){t(e.exports,"createStackParser",(()=>n)),t(e.exports,"getFunctionName",(()=>l));var i=s("7WQrb");function n(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.sort((function(e,t){return e[0]-t[0]})).map((function(e){return e[1]}));return function(e,t){var n,s,a,l;void 0===t&&(t=0);var c=[];try{for(var u=i.__values(e.split("\n").slice(t)),h=u.next();!h.done;h=u.next()){var d=h.value;try{for(var f=(a=void 0,i.__values(r)),p=f.next();!p.done;p=f.next()){var m=(0,p.value)(d);if(m){c.push(m);break}}}catch(e){a={error:e}}finally{try{p&&!p.done&&(l=f.return)&&l.call(f)}finally{if(a)throw a.error}}}}catch(e){n={error:e}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(n)throw n.error}}return o(c)}}function o(e){if(!e.length)return[];var t=e,r=t[0].function||"",n=t[t.length-1].function||"";return-1===r.indexOf("captureMessage")&&-1===r.indexOf("captureException")||(t=t.slice(1)),-1!==n.indexOf("sentryWrapped")&&(t=t.slice(0,-1)),t.slice(0,50).map((function(e){return i.__assign(i.__assign({},e),{filename:e.filename||t[0].filename,function:e.function||"?"})})).reverse()}var a="<anonymous>";function l(e){try{return e&&"function"==typeof e&&e.name||a}catch(e){return a}}})),s.register("esO9h",(function(e,r){t(e.exports,"supportsFetch",(()=>a)),t(e.exports,"isNativeFetch",(()=>l)),t(e.exports,"supportsNativeFetch",(()=>c)),t(e.exports,"supportsReferrerPolicy",(()=>u)),t(e.exports,"supportsHistory",(()=>h));var i=s("eSt2C"),n=s("42ap3"),o=s("4g0Ct");function a(){if(!("fetch"in n.getGlobalObject()))return!1;try{return new Headers,new Request(""),new Response,!0}catch(e){return!1}}function l(e){return e&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(e.toString())}function c(){if(!a())return!1;var e=n.getGlobalObject();if(l(e.fetch))return!0;var t=!1,r=e.document;if(r&&"function"==typeof r.createElement)try{var s=r.createElement("iframe");s.hidden=!0,r.head.appendChild(s),s.contentWindow&&s.contentWindow.fetch&&(t=l(s.contentWindow.fetch)),r.head.removeChild(s)}catch(e){i.IS_DEBUG_BUILD&&o.logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return t}function u(){if(!a())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(e){return!1}}function h(){var e=n.getGlobalObject(),t=e.chrome,r=t&&t.app&&t.app.runtime,i="history"in e&&!!e.history.pushState&&!!e.history.replaceState;return!r&&i}})),s.register("b1E2c",(function(e,r){t(e.exports,"uuid4",(()=>a)),t(e.exports,"parseUrl",(()=>l)),t(e.exports,"getEventDescription",(()=>u)),t(e.exports,"addExceptionTypeValue",(()=>h)),t(e.exports,"addExceptionMechanism",(()=>d)),t(e.exports,"checkOrSetAlreadyCaught",(()=>f));var i=s("7WQrb"),n=s("42ap3"),o=s("jL8lq");s("91U3U");function a(){var e=n.getGlobalObject(),t=e.crypto||e.msCrypto;if(void 0!==t&&t.getRandomValues){var r=new Uint16Array(8);t.getRandomValues(r),r[3]=4095&r[3]|16384,r[4]=16383&r[4]|32768;var i=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return i(r[0])+i(r[1])+i(r[2])+i(r[3])+i(r[4])+i(r[5])+i(r[6])+i(r[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))}function l(e){if(!e)return{};var t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var r=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],relative:t[5]+r+i}}function c(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function u(e){var t=e.message,r=e.event_id;if(t)return t;var i=c(e);return i?i.type&&i.value?i.type+": "+i.value:i.type||i.value||r||"<unknown>":r||"<unknown>"}function h(e,t,r){var i=e.exception=e.exception||{},n=i.values=i.values||[],s=n[0]=n[0]||{};s.value||(s.value=t||""),s.type||(s.type=r||"Error")}function d(e,t){var r=c(e);if(r){var n=r.mechanism;if(r.mechanism=i.__assign(i.__assign(i.__assign({},{type:"generic",handled:!0}),n),t),t&&"data"in t){var s=i.__assign(i.__assign({},n&&n.data),t.data);r.mechanism.data=s}}}function f(e){if(e&&e.__sentry_captured__)return!0;try{o.addNonEnumerableProperty(e,"__sentry_captured__",!0)}catch(e){}return!1}})),s.register("drMc1",(function(r,i){t(r.exports,"normalize",(()=>u)),t(r.exports,"normalizeToSize",(()=>h));var n=s("7WQrb"),o=s("2zW56"),a=s("3BHn6"),l=s("jL8lq"),c=s("16dZf");function u(e,t,r){void 0===t&&(t=1/0),void 0===r&&(r=1/0);try{return d("",e,t,r)}catch(e){return{ERROR:"**non-serializable** ("+e+")"}}}function h(e,t,r){void 0===t&&(t=3),void 0===r&&(r=102400);var i,n=u(e,t);return i=n,function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(i))>r?h(e,t-1,r):n}function d(t,r,i,s,u){void 0===i&&(i=1/0),void 0===s&&(s=1/0),void 0===u&&(u=a.memoBuilder());var h=n.__read(u,2),f=h[0],p=h[1],m=r;if(m&&"function"==typeof m.toJSON)try{return m.toJSON()}catch(e){}if(null===r||["number","boolean","string"].includes(typeof r)&&!o.isNaN(r))return r;var g=function(t,r){try{return"domain"===t&&r&&"object"==typeof r&&r._events?"[Domain]":"domainEmitter"===t?"[DomainEmitter]":void 0!==e&&r===e?"[Global]":"undefined"!=typeof window&&r===window?"[Window]":"undefined"!=typeof document&&r===document?"[Document]":o.isSyntheticEvent(r)?"[SyntheticEvent]":"number"==typeof r&&r!=r?"[NaN]":void 0===r?"[undefined]":"function"==typeof r?"[Function: "+c.getFunctionName(r)+"]":"symbol"==typeof r?"["+String(r)+"]":"bigint"==typeof r?"[BigInt: "+String(r)+"]":"[object "+Object.getPrototypeOf(r).constructor.name+"]"}catch(e){return"**non-serializable** ("+e+")"}}(t,r);if(!g.startsWith("[object "))return g;if(0===i)return g.replace("object ","");if(f(r))return"[Circular ~]";var v=Array.isArray(r)?[]:{},_=0,b=o.isError(r)||o.isEvent(r)?l.convertToPlainObject(r):r;for(var y in b)if(Object.prototype.hasOwnProperty.call(b,y)){if(_>=s){v[y]="[MaxProperties ~]";break}var E=b[y];v[y]=d(y,E,i-1,s,u),_+=1}return p(r),v}})),s.register("3BHn6",(function(e,r){function i(){var e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(r){if(e)return!!t.has(r)||(t.add(r),!1);for(var i=0;i<t.length;i++){if(t[i]===r)return!0}return t.push(r),!1},function(r){if(e)t.delete(r);else for(var i=0;i<t.length;i++)if(t[i]===r){t.splice(i,1);break}}]}t(e.exports,"memoBuilder",(()=>i))})),s.register("jpxdy",(function(e,r){t(e.exports,"makePromiseBuffer",(()=>o));var i=s("bLvfM"),n=s("j3a3y");function o(e){var t=[];function r(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(s){if(!(void 0===e||t.length<e))return n.rejectedSyncPromise(new i.SentryError("Not adding Promise due to buffer limit reached."));var o=s();return-1===t.indexOf(o)&&t.push(o),o.then((function(){return r(o)})).then(null,(function(){return r(o).then(null,(function(){}))})),o},drain:function(e){return new n.SyncPromise((function(r,i){var s=t.length;if(!s)return r(!0);var o=setTimeout((function(){e&&e>0&&r(!1)}),e);t.forEach((function(e){n.resolvedSyncPromise(e).then((function(){--s||(clearTimeout(o),r(!0))}),i)}))}))}}}})),s.register("j3a3y",(function(e,r){t(e.exports,"resolvedSyncPromise",(()=>n)),t(e.exports,"SyncPromise",(()=>a)),t(e.exports,"rejectedSyncPromise",(()=>o));var i=s("2zW56");function n(e){return new a((function(t){t(e)}))}function o(e){return new a((function(t,r){r(e)}))}var a=function(){function e(e){var t=this;this._state=0,this._handlers=[],this._resolve=function(e){t._setResult(1,e)},this._reject=function(e){t._setResult(2,e)},this._setResult=function(e,r){0===t._state&&(i.isThenable(r)?r.then(t._resolve,t._reject):(t._state=e,t._value=r,t._executeHandlers()))},this._executeHandlers=function(){if(0!==t._state){var e=t._handlers.slice();t._handlers=[],e.forEach((function(e){e[0]||(1===t._state&&e[1](t._value),2===t._state&&e[2](t._value),e[0]=!0)}))}};try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}return e.prototype.then=function(t,r){var i=this;return new e((function(e,n){i._handlers.push([!1,function(r){if(t)try{e(t(r))}catch(e){n(e)}else e(r)},function(t){if(r)try{e(r(t))}catch(e){n(e)}else n(t)}]),i._executeHandlers()}))},e.prototype.catch=function(e){return this.then((function(e){return e}),e)},e.prototype.finally=function(t){var r=this;return new e((function(e,i){var n,s;return r.then((function(e){s=!1,n=e,t&&t()}),(function(e){s=!0,n=e,t&&t()})).then((function(){s?i(n):e(n)}))}))},e}()})),s.register("aU92a",(function(e,r){t(e.exports,"severityFromString",(()=>o));var i=s("31CCO"),n=s("j48Qc");function o(e){return"warn"===e?i.Severity.Warning:function(e){return-1!==n.SeverityLevels.indexOf(e)}(e)?e:i.Severity.Log}})),s.register("31CCO",(function(e,r){var i;t(e.exports,"Severity",(()=>i)),function(e){e.Fatal="fatal",e.Error="error",e.Warning="warning",e.Log="log",e.Info="info",e.Debug="debug",e.Critical="critical"}(i||(i={}))})),s.register("j48Qc",(function(e,r){t(e.exports,"SeverityLevels",(()=>i));var i=["fatal","error","warning","log","info","debug","critical"]})),s.register("isOOR",(function(e,r){function i(e){return e>=200&&e<300?"success":429===e?"rate_limit":e>=400&&e<500?"invalid":e>=500?"failed":"unknown"}t(e.exports,"eventStatusFromHttpCode",(()=>i))})),s.register("cvSY8",(function(e,r){t(e.exports,"dateTimestampInSeconds",(()=>c),(e=>c=e)),t(e.exports,"timestampInSeconds",(()=>u),(e=>u=e));var i=s("42ap3"),n=s("289ZW"),o={nowSeconds:function(){return Date.now()/1e3}};var a=n.isNodeEnv()?function(){try{return n.dynamicRequire(e,"perf_hooks").performance}catch(e){return}}():function(){var e=i.getGlobalObject().performance;if(e&&e.now)return{now:function(){return e.now()},timeOrigin:Date.now()-e.now()}}(),l=void 0===a?o:{nowSeconds:function(){return(a.timeOrigin+a.now())/1e3}},c=o.nowSeconds.bind(o),u=l.nowSeconds.bind(l);!function(){var e=i.getGlobalObject().performance;if(e&&e.now){var t=36e5,r=e.now(),n=Date.now(),s=e.timeOrigin?Math.abs(e.timeOrigin+r-n):t,o=s<t,a=e.timing&&e.timing.navigationStart,l="number"==typeof a?Math.abs(a+r-n):t;return o||l<t?s<=l?("timeOrigin",e.timeOrigin):("navigationStart",a):("dateNow",n)}"none"}()})),s.register("3PPTH",(function(e,r){t(e.exports,"createEnvelope",(()=>o)),t(e.exports,"getEnvelopeType",(()=>a)),t(e.exports,"serializeEnvelope",(()=>l));var i=s("7WQrb"),n=s("2zW56");function o(e,t){return void 0===t&&(t=[]),[e,t]}function a(e){var t=i.__read(e,2),r=i.__read(t[1],1);return i.__read(r[0],1)[0].type}function l(e){var t=i.__read(e,2),r=t[0],s=t[1],o=JSON.stringify(r);return s.reduce((function(e,t){var r=i.__read(t,2),s=r[0],o=r[1],a=n.isPrimitive(o)?String(o):JSON.stringify(o);return e+"\n"+JSON.stringify(s)+"\n"+a}),o)}})),s.register("iDlgA",(function(e,r){t(e.exports,"createClientReportEnvelope",(()=>o));var i=s("3PPTH"),n=s("cvSY8");function o(e,t,r){var s=[{type:"client_report"},{timestamp:r||n.dateTimestampInSeconds(),discarded_events:e}];return i.createEnvelope(t?{dsn:t}:{},[s])}})),s.register("jf8Z1",(function(e,r){t(e.exports,"disabledUntil",(()=>n)),t(e.exports,"isRateLimited",(()=>o)),t(e.exports,"updateRateLimits",(()=>a));var i=s("7WQrb");function n(e,t){return e[t]||e.all||0}function o(e,t,r){return void 0===r&&(r=Date.now()),n(e,t)>r}function a(e,t,r){var n,s,o,a;void 0===r&&(r=Date.now());var l=i.__assign({},e),c=t["x-sentry-rate-limits"],u=t["retry-after"];if(c)try{for(var h=i.__values(c.trim().split(",")),d=h.next();!d.done;d=h.next()){var f=d.value.split(":",2),p=parseInt(f[0],10),m=1e3*(isNaN(p)?60:p);if(f[1])try{for(var g=(o=void 0,i.__values(f[1].split(";"))),v=g.next();!v.done;v=g.next()){l[v.value]=r+m}}catch(e){o={error:e}}finally{try{v&&!v.done&&(a=g.return)&&a.call(g)}finally{if(o)throw o.error}}else l.all=r+m}}catch(e){n={error:e}}finally{try{d&&!d.done&&(s=h.return)&&s.call(h)}finally{if(n)throw n.error}}else u&&(l.all=r+function(e,t){void 0===t&&(t=Date.now());var r=parseInt(""+e,10);if(!isNaN(r))return 1e3*r;var i=Date.parse(""+e);return isNaN(i)?6e4:i-t}(u,r));return l}})),s.register("6jMsx",(function(e,r){t(e.exports,"InboundFilters",(()=>u));var i=s("7WQrb");s("lD3gc");var n=s("4g0Ct"),o=s("b1E2c"),a=s("91U3U"),l=s("kKPd7"),c=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],u=function(){function e(t){void 0===t&&(t={}),this._options=t,this.name=e.id}return e.prototype.setupOnce=function(t,r){t((function(t){var s=r();if(s){var u=s.getIntegration(e);if(u){var h=s.getClient(),f=h?h.getOptions():{},p=function(e,t){void 0===e&&(e={});void 0===t&&(t={});return{allowUrls:i.__spread(e.whitelistUrls||[],e.allowUrls||[],t.whitelistUrls||[],t.allowUrls||[]),denyUrls:i.__spread(e.blacklistUrls||[],e.denyUrls||[],t.blacklistUrls||[],t.denyUrls||[]),ignoreErrors:i.__spread(e.ignoreErrors||[],t.ignoreErrors||[],c),ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(u._options,f);return function(e,t){if(t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e))return l.IS_DEBUG_BUILD&&n.logger.warn("Event dropped due to being internal Sentry Error.\nEvent: "+o.getEventDescription(e)),!0;if(function(e,t){return!(!t||!t.length)&&function(e){if(e.message)return[e.message];if(e.exception)try{var t=e.exception.values&&e.exception.values[0]||{},r=t.type,i=void 0===r?"":r,s=t.value,a=void 0===s?"":s;return[""+a,i+": "+a]}catch(t){return l.IS_DEBUG_BUILD&&n.logger.error("Cannot extract message for event "+o.getEventDescription(e)),[]}return[]}(e).some((function(e){return t.some((function(t){return a.isMatchingPattern(e,t)}))}))}(e,t.ignoreErrors))return l.IS_DEBUG_BUILD&&n.logger.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: "+o.getEventDescription(e)),!0;if(function(e,t){if(!t||!t.length)return!1;var r=d(e);return!!r&&t.some((function(e){return a.isMatchingPattern(r,e)}))}(e,t.denyUrls))return l.IS_DEBUG_BUILD&&n.logger.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: "+o.getEventDescription(e)+".\nUrl: "+d(e)),!0;if(!function(e,t){if(!t||!t.length)return!0;var r=d(e);return!r||t.some((function(e){return a.isMatchingPattern(r,e)}))}(e,t.allowUrls))return l.IS_DEBUG_BUILD&&n.logger.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: "+o.getEventDescription(e)+".\nUrl: "+d(e)),!0;return!1}(t,p)?null:t}}return t}))},e.id="InboundFilters",e}();function h(e){void 0===e&&(e=[]);for(var t=e.length-1;t>=0;t--){var r=e[t];if(r&&"<anonymous>"!==r.filename&&"[native code]"!==r.filename)return r.filename||null}return null}function d(e){try{if(e.stacktrace)return h(e.stacktrace.frames);var t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?h(t):null}catch(t){return l.IS_DEBUG_BUILD&&n.logger.error("Cannot extract url for event "+o.getEventDescription(e)),null}}})),s.register("kKPd7",(function(e,r){t(e.exports,"IS_DEBUG_BUILD",(()=>i));var i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__})),s.register("iPofb",(function(e,r){t(e.exports,"captureException",(()=>a)),t(e.exports,"captureMessage",(()=>l)),t(e.exports,"captureEvent",(()=>c)),t(e.exports,"configureScope",(()=>u)),t(e.exports,"addBreadcrumb",(()=>h)),t(e.exports,"setContext",(()=>d)),t(e.exports,"setExtras",(()=>f)),t(e.exports,"setTags",(()=>p)),t(e.exports,"setExtra",(()=>m)),t(e.exports,"setTag",(()=>g)),t(e.exports,"setUser",(()=>v)),t(e.exports,"withScope",(()=>_)),t(e.exports,"startTransaction",(()=>b));var i=s("7WQrb"),n=s("8x56E");function o(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var s=n.getCurrentHub();if(s&&s[e])return s[e].apply(s,i.__spread(t));throw new Error("No hub defined or "+e+" was not found on the hub, please open a bug report.")}function a(e,t){return o("captureException",e,{captureContext:t,originalException:e,syntheticException:new Error("Sentry syntheticException")})}function l(e,t){var r=new Error(e),n="string"!=typeof t?{captureContext:t}:void 0;return o("captureMessage",e,"string"==typeof t?t:void 0,i.__assign({originalException:e,syntheticException:r},n))}function c(e){return o("captureEvent",e)}function u(e){o("configureScope",e)}function h(e){o("addBreadcrumb",e)}function d(e,t){o("setContext",e,t)}function f(e){o("setExtras",e)}function p(e){o("setTags",e)}function m(e,t){o("setExtra",e,t)}function g(e,t){o("setTag",e,t)}function v(e){o("setUser",e)}function _(e){o("withScope",e)}function b(e,t){return o("startTransaction",i.__assign({},e),t)}})),s.register("NU9Qs",(function(e,r){t(e.exports,"Scope",(()=>c)),t(e.exports,"addGlobalEventProcessor",(()=>h));var i=s("7WQrb");s("lD3gc");var n=s("2zW56"),o=s("cvSY8"),a=s("j3a3y"),l=s("42ap3"),c=function(){function e(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={}}return e.clone=function(t){var r=new e;return t&&(r._breadcrumbs=i.__spread(t._breadcrumbs),r._tags=i.__assign({},t._tags),r._extra=i.__assign({},t._extra),r._contexts=i.__assign({},t._contexts),r._user=t._user,r._level=t._level,r._span=t._span,r._session=t._session,r._transactionName=t._transactionName,r._fingerprint=t._fingerprint,r._eventProcessors=i.__spread(t._eventProcessors),r._requestSession=t._requestSession),r},e.prototype.addScopeListener=function(e){this._scopeListeners.push(e)},e.prototype.addEventProcessor=function(e){return this._eventProcessors.push(e),this},e.prototype.setUser=function(e){return this._user=e||{},this._session&&this._session.update({user:e}),this._notifyScopeListeners(),this},e.prototype.getUser=function(){return this._user},e.prototype.getRequestSession=function(){return this._requestSession},e.prototype.setRequestSession=function(e){return this._requestSession=e,this},e.prototype.setTags=function(e){return this._tags=i.__assign(i.__assign({},this._tags),e),this._notifyScopeListeners(),this},e.prototype.setTag=function(e,t){var r;return this._tags=i.__assign(i.__assign({},this._tags),((r={})[e]=t,r)),this._notifyScopeListeners(),this},e.prototype.setExtras=function(e){return this._extra=i.__assign(i.__assign({},this._extra),e),this._notifyScopeListeners(),this},e.prototype.setExtra=function(e,t){var r;return this._extra=i.__assign(i.__assign({},this._extra),((r={})[e]=t,r)),this._notifyScopeListeners(),this},e.prototype.setFingerprint=function(e){return this._fingerprint=e,this._notifyScopeListeners(),this},e.prototype.setLevel=function(e){return this._level=e,this._notifyScopeListeners(),this},e.prototype.setTransactionName=function(e){return this._transactionName=e,this._notifyScopeListeners(),this},e.prototype.setTransaction=function(e){return this.setTransactionName(e)},e.prototype.setContext=function(e,t){var r;return null===t?delete this._contexts[e]:this._contexts=i.__assign(i.__assign({},this._contexts),((r={})[e]=t,r)),this._notifyScopeListeners(),this},e.prototype.setSpan=function(e){return this._span=e,this._notifyScopeListeners(),this},e.prototype.getSpan=function(){return this._span},e.prototype.getTransaction=function(){var e=this.getSpan();return e&&e.transaction},e.prototype.setSession=function(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this},e.prototype.getSession=function(){return this._session},e.prototype.update=function(t){if(!t)return this;if("function"==typeof t){var r=t(this);return r instanceof e?r:this}return t instanceof e?(this._tags=i.__assign(i.__assign({},this._tags),t._tags),this._extra=i.__assign(i.__assign({},this._extra),t._extra),this._contexts=i.__assign(i.__assign({},this._contexts),t._contexts),t._user&&Object.keys(t._user).length&&(this._user=t._user),t._level&&(this._level=t._level),t._fingerprint&&(this._fingerprint=t._fingerprint),t._requestSession&&(this._requestSession=t._requestSession)):n.isPlainObject(t)&&(this._tags=i.__assign(i.__assign({},this._tags),t.tags),this._extra=i.__assign(i.__assign({},this._extra),t.extra),this._contexts=i.__assign(i.__assign({},this._contexts),t.contexts),t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession)),this},e.prototype.clear=function(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this},e.prototype.addBreadcrumb=function(e,t){var r="number"==typeof t?Math.min(t,100):100;if(r<=0)return this;var n=i.__assign({timestamp:o.dateTimestampInSeconds()},e);return this._breadcrumbs=i.__spread(this._breadcrumbs,[n]).slice(-r),this._notifyScopeListeners(),this},e.prototype.clearBreadcrumbs=function(){return this._breadcrumbs=[],this._notifyScopeListeners(),this},e.prototype.applyToEvent=function(e,t){if(this._extra&&Object.keys(this._extra).length&&(e.extra=i.__assign(i.__assign({},this._extra),e.extra)),this._tags&&Object.keys(this._tags).length&&(e.tags=i.__assign(i.__assign({},this._tags),e.tags)),this._user&&Object.keys(this._user).length&&(e.user=i.__assign(i.__assign({},this._user),e.user)),this._contexts&&Object.keys(this._contexts).length&&(e.contexts=i.__assign(i.__assign({},this._contexts),e.contexts)),this._level&&(e.level=this._level),this._transactionName&&(e.transaction=this._transactionName),this._span){e.contexts=i.__assign({trace:this._span.getTraceContext()},e.contexts);var r=this._span.transaction&&this._span.transaction.name;r&&(e.tags=i.__assign({transaction:r},e.tags))}return this._applyFingerprint(e),e.breadcrumbs=i.__spread(e.breadcrumbs||[],this._breadcrumbs),e.breadcrumbs=e.breadcrumbs.length>0?e.breadcrumbs:void 0,e.sdkProcessingMetadata=this._sdkProcessingMetadata,this._notifyEventProcessors(i.__spread(u(),this._eventProcessors),e,t)},e.prototype.setSDKProcessingMetadata=function(e){return this._sdkProcessingMetadata=i.__assign(i.__assign({},this._sdkProcessingMetadata),e),this},e.prototype._notifyEventProcessors=function(e,t,r,s){var o=this;return void 0===s&&(s=0),new a.SyncPromise((function(a,l){var c=e[s];if(null===t||"function"!=typeof c)a(t);else{var u=c(i.__assign({},t),r);n.isThenable(u)?u.then((function(t){return o._notifyEventProcessors(e,t,r,s+1).then(a)})).then(null,l):o._notifyEventProcessors(e,u,r,s+1).then(a).then(null,l)}}))},e.prototype._notifyScopeListeners=function(){var e=this;this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach((function(t){t(e)})),this._notifyingListeners=!1)},e.prototype._applyFingerprint=function(e){e.fingerprint=e.fingerprint?Array.isArray(e.fingerprint)?e.fingerprint:[e.fingerprint]:[],this._fingerprint&&(e.fingerprint=e.fingerprint.concat(this._fingerprint)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint},e}();function u(){return l.getGlobalSingleton("globalEventProcessors",(function(){return[]}))}function h(e){u().push(e)}})),s.register("lvhwF",(function(e,r){t(e.exports,"Session",(()=>a)),s("lD3gc");var i=s("b1E2c"),n=s("cvSY8"),o=s("jL8lq"),a=function(){function e(e){this.errors=0,this.sid=i.uuid4(),this.duration=0,this.status="ok",this.init=!0,this.ignoreDuration=!1;var t=n.timestampInSeconds();this.timestamp=t,this.started=t,e&&this.update(e)}return e.prototype.update=function(e){if(void 0===e&&(e={}),e.user&&(!this.ipAddress&&e.user.ip_address&&(this.ipAddress=e.user.ip_address),this.did||e.did||(this.did=e.user.id||e.user.email||e.user.username)),this.timestamp=e.timestamp||n.timestampInSeconds(),e.ignoreDuration&&(this.ignoreDuration=e.ignoreDuration),e.sid&&(this.sid=32===e.sid.length?e.sid:i.uuid4()),void 0!==e.init&&(this.init=e.init),!this.did&&e.did&&(this.did=""+e.did),"number"==typeof e.started&&(this.started=e.started),this.ignoreDuration)this.duration=void 0;else if("number"==typeof e.duration)this.duration=e.duration;else{var t=this.timestamp-this.started;this.duration=t>=0?t:0}e.release&&(this.release=e.release),e.environment&&(this.environment=e.environment),!this.ipAddress&&e.ipAddress&&(this.ipAddress=e.ipAddress),!this.userAgent&&e.userAgent&&(this.userAgent=e.userAgent),"number"==typeof e.errors&&(this.errors=e.errors),e.status&&(this.status=e.status)},e.prototype.close=function(e){e?this.update({status:e}):"ok"===this.status?this.update({status:"exited"}):this.update()},e.prototype.toJSON=function(){return o.dropUndefinedKeys({sid:""+this.sid,init:this.init,started:new Date(1e3*this.started).toISOString(),timestamp:new Date(1e3*this.timestamp).toISOString(),status:this.status,errors:this.errors,did:"number"==typeof this.did||"string"==typeof this.did?""+this.did:void 0,duration:this.duration,attrs:{release:this.release,environment:this.environment,ip_address:this.ipAddress,user_agent:this.userAgent}})},e}()})),s.register("8x56E",(function(e,r){t(e.exports,"Hub",(()=>f)),t(e.exports,"makeMain",(()=>m)),t(e.exports,"getHubFromCarrier",(()=>_)),t(e.exports,"getCurrentHub",(()=>g));var i=s("7WQrb");s("lD3gc");var n=s("b1E2c"),o=s("cvSY8"),a=s("4g0Ct"),l=s("42ap3"),c=s("289ZW"),u=s("2fpvF"),h=s("NU9Qs"),d=s("lvhwF"),f=function(){function e(e,t,r){void 0===t&&(t=new h.Scope),void 0===r&&(r=4),this._version=r,this._stack=[{}],this.getStackTop().scope=t,e&&this.bindClient(e)}return e.prototype.isOlderThan=function(e){return this._version<e},e.prototype.bindClient=function(e){this.getStackTop().client=e,e&&e.setupIntegrations&&e.setupIntegrations()},e.prototype.pushScope=function(){var e=h.Scope.clone(this.getScope());return this.getStack().push({client:this.getClient(),scope:e}),e},e.prototype.popScope=function(){return!(this.getStack().length<=1)&&!!this.getStack().pop()},e.prototype.withScope=function(e){var t=this.pushScope();try{e(t)}finally{this.popScope()}},e.prototype.getClient=function(){return this.getStackTop().client},e.prototype.getScope=function(){return this.getStackTop().scope},e.prototype.getStack=function(){return this._stack},e.prototype.getStackTop=function(){return this._stack[this._stack.length-1]},e.prototype.captureException=function(e,t){var r=this._lastEventId=t&&t.event_id?t.event_id:n.uuid4(),s=t;if(!t){var o=void 0;try{throw new Error("Sentry syntheticException")}catch(e){o=e}s={originalException:e,syntheticException:o}}return this._invokeClient("captureException",e,i.__assign(i.__assign({},s),{event_id:r})),r},e.prototype.captureMessage=function(e,t,r){var s=this._lastEventId=r&&r.event_id?r.event_id:n.uuid4(),o=r;if(!r){var a=void 0;try{throw new Error(e)}catch(e){a=e}o={originalException:e,syntheticException:a}}return this._invokeClient("captureMessage",e,t,i.__assign(i.__assign({},o),{event_id:s})),s},e.prototype.captureEvent=function(e,t){var r=t&&t.event_id?t.event_id:n.uuid4();return"transaction"!==e.type&&(this._lastEventId=r),this._invokeClient("captureEvent",e,i.__assign(i.__assign({},t),{event_id:r})),r},e.prototype.lastEventId=function(){return this._lastEventId},e.prototype.addBreadcrumb=function(e,t){var r=this.getStackTop(),n=r.scope,s=r.client;if(n&&s){var l=s.getOptions&&s.getOptions()||{},c=l.beforeBreadcrumb,u=void 0===c?null:c,h=l.maxBreadcrumbs,d=void 0===h?100:h;if(!(d<=0)){var f=o.dateTimestampInSeconds(),p=i.__assign({timestamp:f},e),m=u?a.consoleSandbox((function(){return u(p,t)})):p;null!==m&&n.addBreadcrumb(m,d)}}},e.prototype.setUser=function(e){var t=this.getScope();t&&t.setUser(e)},e.prototype.setTags=function(e){var t=this.getScope();t&&t.setTags(e)},e.prototype.setExtras=function(e){var t=this.getScope();t&&t.setExtras(e)},e.prototype.setTag=function(e,t){var r=this.getScope();r&&r.setTag(e,t)},e.prototype.setExtra=function(e,t){var r=this.getScope();r&&r.setExtra(e,t)},e.prototype.setContext=function(e,t){var r=this.getScope();r&&r.setContext(e,t)},e.prototype.configureScope=function(e){var t=this.getStackTop(),r=t.scope,i=t.client;r&&i&&e(r)},e.prototype.run=function(e){var t=m(this);try{e(this)}finally{m(t)}},e.prototype.getIntegration=function(e){var t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return u.IS_DEBUG_BUILD&&a.logger.warn("Cannot retrieve integration "+e.id+" from the current Hub"),null}},e.prototype.startSpan=function(e){return this._callExtensionMethod("startSpan",e)},e.prototype.startTransaction=function(e,t){return this._callExtensionMethod("startTransaction",e,t)},e.prototype.traceHeaders=function(){return this._callExtensionMethod("traceHeaders")},e.prototype.captureSession=function(e){if(void 0===e&&(e=!1),e)return this.endSession();this._sendSessionUpdate()},e.prototype.endSession=function(){var e=this.getStackTop(),t=e&&e.scope,r=t&&t.getSession();r&&r.close(),this._sendSessionUpdate(),t&&t.setSession()},e.prototype.startSession=function(e){var t=this.getStackTop(),r=t.scope,n=t.client,s=n&&n.getOptions()||{},o=s.release,a=s.environment,c=(l.getGlobalObject().navigator||{}).userAgent,u=new d.Session(i.__assign(i.__assign(i.__assign({release:o,environment:a},r&&{user:r.getUser()}),c&&{userAgent:c}),e));if(r){var h=r.getSession&&r.getSession();h&&"ok"===h.status&&h.update({status:"exited"}),this.endSession(),r.setSession(u)}return u},e.prototype._sendSessionUpdate=function(){var e=this.getStackTop(),t=e.scope,r=e.client;if(t){var i=t.getSession&&t.getSession();i&&r&&r.captureSession&&r.captureSession(i)}},e.prototype._invokeClient=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var s=this.getStackTop(),o=s.scope,a=s.client;a&&a[e]&&(t=a)[e].apply(t,i.__spread(r,[o]))},e.prototype._callExtensionMethod=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var i=p(),n=i.__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);u.IS_DEBUG_BUILD&&a.logger.warn("Extension method "+e+" couldn't be found, doing nothing.")},e}();function p(){var e=l.getGlobalObject();return e.__SENTRY__=e.__SENTRY__||{extensions:{},hub:void 0},e}function m(e){var t=p(),r=_(t);return b(t,e),r}function g(){var e=p();return v(e)&&!_(e).isOlderThan(4)||b(e,new f),c.isNodeEnv()?function(e){try{var t=p().__SENTRY__,r=t&&t.extensions&&t.extensions.domain&&t.extensions.domain.active;if(!r)return _(e);if(!v(r)||_(r).isOlderThan(4)){var i=_(e).getStackTop();b(r,new f(i.client,h.Scope.clone(i.scope)))}return _(r)}catch(t){return _(e)}}(e):_(e)}function v(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function _(e){return l.getGlobalSingleton("hub",(function(){return new f}),e)}function b(e,t){return!!e&&((e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0)}})),s.register("2fpvF",(function(e,r){t(e.exports,"IS_DEBUG_BUILD",(()=>i));var i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__})),s.register("iDxMj",(function(e,r){t(e.exports,"getStoreEndpointWithUrlEncodedAuth",(()=>h)),t(e.exports,"getEnvelopeEndpointWithUrlEncodedAuth",(()=>d)),t(e.exports,"initAPIDetails",(()=>o)),t(e.exports,"getReportDialogEndpoint",(()=>f)),s("lD3gc");var i=s("ldaPw"),n=s("jL8lq");!function(){function e(e,t,r){void 0===t&&(t={}),this.dsn=e,this._dsnObject=i.makeDsn(e),this.metadata=t,this._tunnel=r}e.prototype.getDsn=function(){return this._dsnObject},e.prototype.forceEnvelope=function(){return!!this._tunnel},e.prototype.getBaseApiEndpoint=function(){return a(this._dsnObject)},e.prototype.getStoreEndpoint=function(){return u(this._dsnObject)},e.prototype.getStoreEndpointWithUrlEncodedAuth=function(){return h(this._dsnObject)},e.prototype.getEnvelopeEndpointWithUrlEncodedAuth=function(){return d(this._dsnObject,this._tunnel)}}();function o(e,t,r){return{initDsn:e,metadata:t||{},dsn:i.makeDsn(e),tunnel:r}}function a(e){var t=e.protocol?e.protocol+":":"",r=e.port?":"+e.port:"";return t+"//"+e.host+r+(e.path?"/"+e.path:"")+"/api/"}function l(e,t){return""+a(e)+e.projectId+"/"+t+"/"}function c(e){return n.urlEncode({sentry_key:e.publicKey,sentry_version:"7"})}function u(e){return l(e,"store")}function h(e){return u(e)+"?"+c(e)}function d(e,t){return t||function(e){return l(e,"envelope")}(e)+"?"+c(e)}function f(e,t){var r=i.makeDsn(e),n=a(r)+"embed/error-page/",s="dsn="+i.dsnToString(r);for(var o in t)if("dsn"!==o)if("user"===o){if(!t.user)continue;t.user.name&&(s+="&name="+encodeURIComponent(t.user.name)),t.user.email&&(s+="&email="+encodeURIComponent(t.user.email))}else s+="&"+encodeURIComponent(o)+"="+encodeURIComponent(t[o]);return n+"?"+s}})),s.register("80A9Z",(function(e,r){t(e.exports,"BaseClient",(()=>_));var i=s("7WQrb"),n=s("NU9Qs");s("lD3gc");var o=s("ldaPw"),a=s("b1E2c"),l=s("4g0Ct"),c=s("2zW56"),u=s("j3a3y"),h=s("cvSY8"),d=s("drMc1"),f=s("91U3U"),p=s("bLvfM"),m=s("kKPd7"),g=s("71tRZ"),v="Not capturing exception because it's already been captured.",_=function(){function e(e,t){this._integrations={},this._numProcessing=0,this._backend=new e(t),this._options=t,t.dsn&&(this._dsn=o.makeDsn(t.dsn))}return e.prototype.captureException=function(e,t,r){var i=this;if(!a.checkOrSetAlreadyCaught(e)){var n=t&&t.event_id;return this._process(this._getBackend().eventFromException(e,t).then((function(e){return i._captureEvent(e,t,r)})).then((function(e){n=e}))),n}m.IS_DEBUG_BUILD&&l.logger.log(v)},e.prototype.captureMessage=function(e,t,r,i){var n=this,s=r&&r.event_id,o=c.isPrimitive(e)?this._getBackend().eventFromMessage(String(e),t,r):this._getBackend().eventFromException(e,r);return this._process(o.then((function(e){return n._captureEvent(e,r,i)})).then((function(e){s=e}))),s},e.prototype.captureEvent=function(e,t,r){if(!(t&&t.originalException&&a.checkOrSetAlreadyCaught(t.originalException))){var i=t&&t.event_id;return this._process(this._captureEvent(e,t,r).then((function(e){i=e}))),i}m.IS_DEBUG_BUILD&&l.logger.log(v)},e.prototype.captureSession=function(e){this._isEnabled()?"string"!=typeof e.release?m.IS_DEBUG_BUILD&&l.logger.warn("Discarded session because of missing or non-string release"):(this._sendSession(e),e.update({init:!1})):m.IS_DEBUG_BUILD&&l.logger.warn("SDK not enabled, will not capture session.")},e.prototype.getDsn=function(){return this._dsn},e.prototype.getOptions=function(){return this._options},e.prototype.getTransport=function(){return this._getBackend().getTransport()},e.prototype.flush=function(e){var t=this;return this._isClientDoneProcessing(e).then((function(r){return t.getTransport().close(e).then((function(e){return r&&e}))}))},e.prototype.close=function(e){var t=this;return this.flush(e).then((function(e){return t.getOptions().enabled=!1,e}))},e.prototype.setupIntegrations=function(){this._isEnabled()&&!this._integrations.initialized&&(this._integrations=g.setupIntegrations(this._options))},e.prototype.getIntegration=function(e){try{return this._integrations[e.id]||null}catch(t){return m.IS_DEBUG_BUILD&&l.logger.warn("Cannot retrieve integration "+e.id+" from the current Client"),null}},e.prototype._updateSessionFromEvent=function(e,t){var r,n,s=!1,o=!1,a=t.exception&&t.exception.values;if(a){o=!0;try{for(var l=i.__values(a),c=l.next();!c.done;c=l.next()){var u=c.value.mechanism;if(u&&!1===u.handled){s=!0;break}}}catch(e){r={error:e}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}var h="ok"===e.status;(h&&0===e.errors||h&&s)&&(e.update(i.__assign(i.__assign({},s&&{status:"crashed"}),{errors:e.errors||Number(o||s)})),this.captureSession(e))},e.prototype._sendSession=function(e){this._getBackend().sendSession(e)},e.prototype._isClientDoneProcessing=function(e){var t=this;return new u.SyncPromise((function(r){var i=0,n=setInterval((function(){0==t._numProcessing?(clearInterval(n),r(!0)):(i+=1,e&&i>=e&&(clearInterval(n),r(!1)))}),1)}))},e.prototype._getBackend=function(){return this._backend},e.prototype._isEnabled=function(){return!1!==this.getOptions().enabled&&void 0!==this._dsn},e.prototype._prepareEvent=function(e,t,r){var s=this,o=this.getOptions(),l=o.normalizeDepth,c=void 0===l?3:l,f=o.normalizeMaxBreadth,p=void 0===f?1e3:f,m=i.__assign(i.__assign({},e),{event_id:e.event_id||(r&&r.event_id?r.event_id:a.uuid4()),timestamp:e.timestamp||h.dateTimestampInSeconds()});this._applyClientOptions(m),this._applyIntegrationsMetadata(m);var g=t;r&&r.captureContext&&(g=n.Scope.clone(g).update(r.captureContext));var v=u.resolvedSyncPromise(m);return g&&(v=g.applyToEvent(m,r)),v.then((function(e){return e&&(e.sdkProcessingMetadata=i.__assign(i.__assign({},e.sdkProcessingMetadata),{normalizeDepth:d.normalize(c)+" ("+typeof c+")"})),"number"==typeof c&&c>0?s._normalizeEvent(e,c,p):e}))},e.prototype._normalizeEvent=function(e,t,r){if(!e)return null;var n=i.__assign(i.__assign(i.__assign(i.__assign(i.__assign({},e),e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map((function(e){return i.__assign(i.__assign({},e),e.data&&{data:d.normalize(e.data,t,r)})}))}),e.user&&{user:d.normalize(e.user,t,r)}),e.contexts&&{contexts:d.normalize(e.contexts,t,r)}),e.extra&&{extra:d.normalize(e.extra,t,r)});return e.contexts&&e.contexts.trace&&(n.contexts.trace=e.contexts.trace),n.sdkProcessingMetadata=i.__assign(i.__assign({},n.sdkProcessingMetadata),{baseClientNormalized:!0}),n},e.prototype._applyClientOptions=function(e){var t=this.getOptions(),r=t.environment,i=t.release,n=t.dist,s=t.maxValueLength,o=void 0===s?250:s;"environment"in e||(e.environment="environment"in t?r:"production"),void 0===e.release&&void 0!==i&&(e.release=i),void 0===e.dist&&void 0!==n&&(e.dist=n),e.message&&(e.message=f.truncate(e.message,o));var a=e.exception&&e.exception.values&&e.exception.values[0];a&&a.value&&(a.value=f.truncate(a.value,o));var l=e.request;l&&l.url&&(l.url=f.truncate(l.url,o))},e.prototype._applyIntegrationsMetadata=function(e){var t=Object.keys(this._integrations);t.length>0&&(e.sdk=e.sdk||{},e.sdk.integrations=i.__spread(e.sdk.integrations||[],t))},e.prototype._sendEvent=function(e){this._getBackend().sendEvent(e)},e.prototype._captureEvent=function(e,t,r){return this._processEvent(e,t,r).then((function(e){return e.event_id}),(function(e){m.IS_DEBUG_BUILD&&l.logger.error(e)}))},e.prototype._processEvent=function(e,t,r){var i=this,n=this.getOptions(),s=n.beforeSend,o=n.sampleRate,a=this.getTransport();function l(e,t){a.recordLostEvent&&a.recordLostEvent(e,t)}if(!this._isEnabled())return u.rejectedSyncPromise(new p.SentryError("SDK not enabled, will not capture event."));var h="transaction"===e.type;return!h&&"number"==typeof o&&Math.random()>o?(l("sample_rate","event"),u.rejectedSyncPromise(new p.SentryError("Discarding event because it's not included in the random sample (sampling rate = "+o+")"))):this._prepareEvent(e,r,t).then((function(r){if(null===r)throw l("event_processor",e.type||"event"),new p.SentryError("An event processor returned null, will not send event.");return t&&t.data&&!0===t.data.__sentry__||h||!s?r:function(e){var t="`beforeSend` method has to return `null` or a valid event.";if(c.isThenable(e))return e.then((function(e){if(!c.isPlainObject(e)&&null!==e)throw new p.SentryError(t);return e}),(function(e){throw new p.SentryError("beforeSend rejected with "+e)}));if(!c.isPlainObject(e)&&null!==e)throw new p.SentryError(t);return e}(s(r,t))})).then((function(t){if(null===t)throw l("before_send",e.type||"event"),new p.SentryError("`beforeSend` returned `null`, will not send event.");var n=r&&r.getSession&&r.getSession();return!h&&n&&i._updateSessionFromEvent(n,t),i._sendEvent(t),t})).then(null,(function(e){if(e instanceof p.SentryError)throw e;throw i.captureException(e,{data:{__sentry__:!0},originalException:e}),new p.SentryError("Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: "+e)}))},e.prototype._process=function(e){var t=this;this._numProcessing+=1,e.then((function(e){return t._numProcessing-=1,e}),(function(e){return t._numProcessing-=1,e}))},e}()})),s.register("71tRZ",(function(e,r){t(e.exports,"setupIntegrations",(()=>d));var i=s("7WQrb"),n=s("NU9Qs"),o=s("8x56E");s("lD3gc");var a=s("4g0Ct"),l=s("jL8lq"),c=s("kKPd7"),u=[];function h(e){return e.reduce((function(e,t){return e.every((function(e){return t.name!==e.name}))&&e.push(t),e}),[])}function d(e){var t={};return function(e){var t=e.defaultIntegrations&&i.__spread(e.defaultIntegrations)||[],r=e.integrations,n=i.__spread(h(t));Array.isArray(r)?n=i.__spread(n.filter((function(e){return r.every((function(t){return t.name!==e.name}))})),h(r)):"function"==typeof r&&(n=r(n),n=Array.isArray(n)?n:[n]);var s=n.map((function(e){return e.name})),o="Debug";return-1!==s.indexOf(o)&&n.push.apply(n,i.__spread(n.splice(s.indexOf(o),1))),n}(e).forEach((function(e){t[e.name]=e,function(e){-1===u.indexOf(e.name)&&(e.setupOnce(n.addGlobalEventProcessor,o.getCurrentHub),u.push(e.name),c.IS_DEBUG_BUILD&&a.logger.log("Integration installed: "+e.name))}(e)})),l.addNonEnumerableProperty(t,"initialized",!0),t}})),s.register("8sMFq",(function(e,r){t(e.exports,"BaseBackend",(()=>h));var i=s("7WQrb");s("lD3gc");var n=s("4g0Ct"),o=s("bLvfM"),a=s("iDxMj"),l=s("kKPd7"),c=s("k2nY8"),u=s("jvHOZ"),h=function(){function e(e){this._options=e,this._options.dsn||l.IS_DEBUG_BUILD&&n.logger.warn("No DSN provided, backend will not do anything."),this._transport=this._setupTransport()}return e.prototype.eventFromException=function(e,t){throw new o.SentryError("Backend has to implement `eventFromException` method")},e.prototype.eventFromMessage=function(e,t,r){throw new o.SentryError("Backend has to implement `eventFromMessage` method")},e.prototype.sendEvent=function(e){if(this._newTransport&&this._options.dsn&&this._options._experiments&&this._options._experiments.newTransport){var t=a.initAPIDetails(this._options.dsn,this._options._metadata,this._options.tunnel),r=c.createEventEnvelope(e,t);this._newTransport.send(r).then(null,(function(e){l.IS_DEBUG_BUILD&&n.logger.error("Error while sending event:",e)}))}else this._transport.sendEvent(e).then(null,(function(e){l.IS_DEBUG_BUILD&&n.logger.error("Error while sending event:",e)}))},e.prototype.sendSession=function(e){if(this._transport.sendSession)if(this._newTransport&&this._options.dsn&&this._options._experiments&&this._options._experiments.newTransport){var t=a.initAPIDetails(this._options.dsn,this._options._metadata,this._options.tunnel),r=i.__read(c.createSessionEnvelope(e,t),1)[0];this._newTransport.send(r).then(null,(function(e){l.IS_DEBUG_BUILD&&n.logger.error("Error while sending session:",e)}))}else this._transport.sendSession(e).then(null,(function(e){l.IS_DEBUG_BUILD&&n.logger.error("Error while sending session:",e)}));else l.IS_DEBUG_BUILD&&n.logger.warn("Dropping session because custom transport doesn't implement sendSession")},e.prototype.getTransport=function(){return this._transport},e.prototype._setupTransport=function(){return new u.NoopTransport},e}()})),s.register("k2nY8",(function(e,r){t(e.exports,"createSessionEnvelope",(()=>h)),t(e.exports,"sessionToSentryRequest",(()=>d)),t(e.exports,"createEventEnvelope",(()=>f)),t(e.exports,"eventToSentryRequest",(()=>p));var i=s("7WQrb");s("lD3gc");var n=s("ldaPw"),o=s("3PPTH"),a=s("drMc1"),l=s("iDxMj");function c(e){if(e.metadata&&e.metadata.sdk){var t=e.metadata.sdk;return{name:t.name,version:t.version}}}function u(e,t){return t?(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||t.name,e.sdk.version=e.sdk.version||t.version,e.sdk.integrations=i.__spread(e.sdk.integrations||[],t.integrations||[]),e.sdk.packages=i.__spread(e.sdk.packages||[],t.packages||[]),e):e}function h(e,t){var r=c(t),s=i.__assign(i.__assign({sent_at:(new Date).toISOString()},r&&{sdk:r}),!!t.tunnel&&{dsn:n.dsnToString(t.dsn)}),a="aggregates"in e?"sessions":"session",l=[{type:a},e];return[o.createEnvelope(s,[l]),a]}function d(e,t){var r=i.__read(h(e,t),2),n=r[0],s=r[1];return{body:o.serializeEnvelope(n),type:s,url:l.getEnvelopeEndpointWithUrlEncodedAuth(t.dsn,t.tunnel)}}function f(e,t){var r=c(t),s=e.type||"event",a=(e.sdkProcessingMetadata||{}).transactionSampling||{},l=a.method,h=a.rate;u(e,t.metadata.sdk),e.tags=e.tags||{},e.extra=e.extra||{},e.sdkProcessingMetadata&&e.sdkProcessingMetadata.baseClientNormalized||(e.tags.skippedNormalization=!0,e.extra.normalizeDepth=e.sdkProcessingMetadata?e.sdkProcessingMetadata.normalizeDepth:"unset"),delete e.sdkProcessingMetadata;var d=i.__assign(i.__assign({event_id:e.event_id,sent_at:(new Date).toISOString()},r&&{sdk:r}),!!t.tunnel&&{dsn:n.dsnToString(t.dsn)}),f=[{type:s,sample_rates:[{id:l,rate:h}]},e];return o.createEnvelope(d,[f])}function p(e,t){var r,s=c(t),h=e.type||"event",d="transaction"===h||!!t.tunnel,f=(e.sdkProcessingMetadata||{}).transactionSampling||{},p=f.method,m=f.rate;u(e,t.metadata.sdk),e.tags=e.tags||{},e.extra=e.extra||{},e.sdkProcessingMetadata&&e.sdkProcessingMetadata.baseClientNormalized||(e.tags.skippedNormalization=!0,e.extra.normalizeDepth=e.sdkProcessingMetadata?e.sdkProcessingMetadata.normalizeDepth:"unset"),delete e.sdkProcessingMetadata;try{r=JSON.stringify(e)}catch(t){e.tags.JSONStringifyError=!0,e.extra.JSONStringifyError=t;try{r=JSON.stringify(a.normalize(e))}catch(e){var g=e;r=JSON.stringify({message:"JSON.stringify error after renormalization",extra:{message:g.message,stack:g.stack}})}}var v={body:r,type:h,url:d?l.getEnvelopeEndpointWithUrlEncodedAuth(t.dsn,t.tunnel):l.getStoreEndpointWithUrlEncodedAuth(t.dsn)};if(d){var _=i.__assign(i.__assign({event_id:e.event_id,sent_at:(new Date).toISOString()},s&&{sdk:s}),!!t.tunnel&&{dsn:n.dsnToString(t.dsn)}),b=[{type:h,sample_rates:[{id:p,rate:m}]},v.body],y=o.createEnvelope(_,[b]);v.body=o.serializeEnvelope(y)}return v}})),s.register("jvHOZ",(function(e,r){t(e.exports,"NoopTransport",(()=>n)),s("lD3gc");var i=s("j3a3y"),n=function(){function e(){}return e.prototype.sendEvent=function(e){return i.resolvedSyncPromise({reason:"NoopTransport: Event has been skipped because no Dsn is configured.",status:"skipped"})},e.prototype.close=function(e){return i.resolvedSyncPromise(!0)},e}()})),s.register("cCtO1",(function(e,r){t(e.exports,"initAndBind",(()=>a));var i=s("8x56E");s("lD3gc");var n=s("4g0Ct"),o=s("kKPd7");function a(e,t){!0===t.debug&&(o.IS_DEBUG_BUILD?n.logger.enable():console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle."));var r=i.getCurrentHub(),s=r.getScope();s&&s.update(t.initialScope);var a=new e(t);r.bindClient(a)}})),s.register("7j791",(function(e,r){t(e.exports,"createTransport",(()=>c)),s("lD3gc");var i=s("jpxdy"),n=s("3PPTH"),o=s("jf8Z1"),a=s("j3a3y"),l=s("isOOR");function c(e,t,r){void 0===r&&(r=i.makePromiseBuffer(e.bufferSize||30));var s={};return{send:function(e){var i=n.getEnvelopeType(e),c="event"===i?"error":i,h={category:c,body:n.serializeEnvelope(e)};return o.isRateLimited(s,c)?a.rejectedSyncPromise({status:"rate_limit",reason:u(s,c)}):r.add((function(){return t(h).then((function(e){var t=e.body,r=e.headers,i=e.reason,n=e.statusCode,h=l.eventStatusFromHttpCode(n);return r&&(s=o.updateRateLimits(s,r)),"success"===h?a.resolvedSyncPromise({status:h,reason:i}):a.rejectedSyncPromise({status:h,reason:i||t||("rate_limit"===h?u(s,c):"Unknown transport error")})}))}))},flush:function(e){return r.drain(e)}}}function u(e,t){return"Too many "+t+" requests, backing off until: "+new Date(o.disabledUntil(e,t)).toISOString()}})),s.register("9OAWn",(function(e,r){t(e.exports,"SDK_VERSION",(()=>i));var i="6.19.6"})),s.register("a05ws",(function(e,r){t(e.exports,"GlobalHandlers",(()=>s("dw5F0").GlobalHandlers)),t(e.exports,"TryCatch",(()=>s("llG7W").TryCatch)),t(e.exports,"Breadcrumbs",(()=>s("fxK4w").Breadcrumbs)),t(e.exports,"LinkedErrors",(()=>s("9SQUp").LinkedErrors)),t(e.exports,"UserAgent",(()=>s("50nXt").UserAgent)),t(e.exports,"Dedupe",(()=>s("bMyDX").Dedupe));s("dw5F0"),s("llG7W"),s("fxK4w"),s("9SQUp"),s("50nXt"),s("bMyDX")})),s.register("dw5F0",(function(e,r){t(e.exports,"GlobalHandlers",(()=>m));var i=s("7WQrb"),n=s("8x56E"),o=s("31CCO");s("lD3gc");var a=s("js14m"),l=s("2zW56"),c=s("ibKgU"),u=s("4g0Ct"),h=s("b1E2c"),d=s("30niQ"),f=s("9Pq0V"),p=s("6JSNk"),m=function(){function e(t){this.name=e.id,this._installFunc={onerror:g,onunhandledrejection:v},this._options=i.__assign({onerror:!0,onunhandledrejection:!0},t)}return e.prototype.setupOnce=function(){Error.stackTraceLimit=50;var e,t=this._options;for(var r in t){var i=this._installFunc[r];i&&t[r]&&(e=r,f.IS_DEBUG_BUILD&&u.logger.log("Global Handler attached: "+e),i(),this._installFunc[r]=void 0)}},e.id="GlobalHandlers",e}();function g(){a.addInstrumentationHandler("error",(function(e){var t=i.__read(y(),2),r=t[0],n=t[1];if(r.getIntegration(m)){var s=e.msg,a=e.url,c=e.line,u=e.column,h=e.error;if(!(p.shouldIgnoreOnError()||h&&h.__sentry_own_request__)){var f=void 0===h&&l.isString(s)?function(e,t,r,i){var n=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i,s=l.isErrorEvent(e)?e.message:e,o="Error",a=s.match(n);a&&(o=a[1],s=a[2]);return _({exception:{values:[{type:o,value:s}]}},t,r,i)}(s,a,c,u):_(d.eventFromUnknownInput(h||s,void 0,n,!1),a,c,u);f.level=o.Severity.Error,b(r,h,f,"onerror")}}}))}function v(){a.addInstrumentationHandler("unhandledrejection",(function(e){var t=i.__read(y(),2),r=t[0],n=t[1];if(r.getIntegration(m)){var s=e;try{"reason"in e?s=e.reason:"detail"in e&&"reason"in e.detail&&(s=e.detail.reason)}catch(e){}if(p.shouldIgnoreOnError()||s&&s.__sentry_own_request__)return!0;var a=l.isPrimitive(s)?{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+String(s)}]}}:d.eventFromUnknownInput(s,void 0,n,!0);a.level=o.Severity.Error,b(r,s,a,"onunhandledrejection")}}))}function _(e,t,r,i){var n=e.exception=e.exception||{},s=n.values=n.values||[],o=s[0]=s[0]||{},a=o.stacktrace=o.stacktrace||{},u=a.frames=a.frames||[],h=isNaN(parseInt(i,10))?void 0:i,d=isNaN(parseInt(r,10))?void 0:r,f=l.isString(t)&&t.length>0?t:c.getLocationHref();return 0===u.length&&u.push({colno:h,filename:f,function:"?",in_app:!0,lineno:d}),e}function b(e,t,r,i){h.addExceptionMechanism(r,{handled:!1,type:i}),e.captureEvent(r,{originalException:t})}function y(){var e=n.getCurrentHub(),t=e.getClient();return[e,t&&t.getOptions().attachStacktrace]}})),s.register("30niQ",(function(e,r){t(e.exports,"exceptionFromError",(()=>f)),t(e.exports,"eventFromException",(()=>_)),t(e.exports,"eventFromUnknownInput",(()=>y)),t(e.exports,"eventFromMessage",(()=>b));var i=s("7WQrb"),n=s("31CCO");s("lD3gc");var o=s("2zW56"),a=s("jL8lq"),l=s("drMc1"),c=s("16dZf"),u=s("b1E2c"),h=s("j3a3y"),d=s("9AlIt");function f(e){var t=m(e),r={type:e&&e.name,value:v(e)};return t.length&&(r.stacktrace={frames:t}),void 0===r.type&&""===r.value&&(r.value="Unrecoverable error caught"),r}function p(e){return{exception:{values:[f(e)]}}}function m(e){var t=e.stacktrace||e.stack||"",r=function(e){if(e){if("number"==typeof e.framesToPop)return e.framesToPop;if(g.test(e.message))return 1}return 0}(e);try{return c.createStackParser(d.opera10StackParser,d.opera11StackParser,d.chromeStackParser,d.winjsStackParser,d.geckoStackParser)(t,r)}catch(e){}return[]}var g=/Minified React error #\d+;/i;function v(e){var t=e&&e.message;return t?t.error&&"string"==typeof t.error.message?t.error.message:t:"No error message"}function _(e,t,r){var i=y(e,t&&t.syntheticException||void 0,r);return u.addExceptionMechanism(i),i.level=n.Severity.Error,t&&t.event_id&&(i.event_id=t.event_id),h.resolvedSyncPromise(i)}function b(e,t,r,i){void 0===t&&(t=n.Severity.Info);var s=E(e,r&&r.syntheticException||void 0,i);return s.level=t,r&&r.event_id&&(s.event_id=r.event_id),h.resolvedSyncPromise(s)}function y(e,t,r,n){var s;if(o.isErrorEvent(e)&&e.error)return p(e.error);if(o.isDOMError(e)||o.isDOMException(e)){var c=e;if("stack"in e)s=p(e);else{var h=c.name||(o.isDOMError(c)?"DOMError":"DOMException"),d=c.message?h+": "+c.message:h;s=E(d,t,r),u.addExceptionTypeValue(s,d)}return"code"in c&&(s.tags=i.__assign(i.__assign({},s.tags),{"DOMException.code":""+c.code})),s}return o.isError(e)?p(e):o.isPlainObject(e)||o.isEvent(e)?(s=function(e,t,r){var i={exception:{values:[{type:o.isEvent(e)?e.constructor.name:r?"UnhandledRejection":"Error",value:"Non-Error "+(r?"promise rejection":"exception")+" captured with keys: "+a.extractExceptionKeysForMessage(e)}]},extra:{__serialized__:l.normalizeToSize(e)}};if(t){var n=m(t);n.length&&(i.stacktrace={frames:n})}return i}(e,t,n),u.addExceptionMechanism(s,{synthetic:!0}),s):(s=E(e,t,r),u.addExceptionTypeValue(s,""+e,void 0),u.addExceptionMechanism(s,{synthetic:!0}),s)}function E(e,t,r){var i={message:e};if(r&&t){var n=m(t);n.length&&(i.stacktrace={frames:n})}return i}})),s.register("9AlIt",(function(e,r){t(e.exports,"chromeStackParser",(()=>c)),t(e.exports,"geckoStackParser",(()=>d)),t(e.exports,"winjsStackParser",(()=>p)),t(e.exports,"opera10StackParser",(()=>g)),t(e.exports,"opera11StackParser",(()=>_));var i=s("7WQrb"),n="?";function o(e,t,r,i){var n={filename:e,function:t,in_app:!0};return void 0!==r&&(n.lineno=r),void 0!==i&&(n.colno=i),n}var a=/^\s*at (?:(.*?) ?\((?:address at )?)?((?:file|https?|blob|chrome-extension|address|native|eval|webpack|<anonymous>|[-a-z]+:|.*bundle|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,l=/\((\S*)(?::(\d+))(?::(\d+))\)/,c=[30,function(e){var t=a.exec(e);if(t){if(t[2]&&0===t[2].indexOf("eval")){var r=l.exec(t[2]);r&&(t[2]=r[1],t[3]=r[2],t[4]=r[3])}var s=i.__read(b(t[1]||n,t[2]),2),c=s[0];return o(s[1],c,t[3]?+t[3]:void 0,t[4]?+t[4]:void 0)}}],u=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:file|https?|blob|chrome|webpack|resource|moz-extension|capacitor).*?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,h=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,d=[50,function(e){var t,r=u.exec(e);if(r){if(r[3]&&r[3].indexOf(" > eval")>-1){var s=h.exec(r[3]);s&&(r[1]=r[1]||"eval",r[3]=s[1],r[4]=s[2],r[5]="")}var a=r[3],l=r[1]||n;return l=(t=i.__read(b(l,a),2))[0],o(a=t[1],l,r[4]?+r[4]:void 0,r[5]?+r[5]:void 0)}}],f=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,p=[40,function(e){var t=f.exec(e);return t?o(t[2],t[1]||n,+t[3],t[4]?+t[4]:void 0):void 0}],m=/ line (\d+).*script (?:in )?(\S+)(?:: in function (\S+))?$/i,g=[10,function(e){var t=m.exec(e);return t?o(t[2],t[3]||n,+t[1]):void 0}],v=/ line (\d+), column (\d+)\s*(?:in (?:<anonymous function: ([^>]+)>|([^)]+))\(.*\))? in (.*):\s*$/i,_=[20,function(e){var t=v.exec(e);return t?o(t[5],t[3]||t[4]||n,+t[1],+t[2]):void 0}],b=function(e,t){var r=-1!==e.indexOf("safari-extension"),i=-1!==e.indexOf("safari-web-extension");return r||i?[-1!==e.indexOf("@")?e.split("@")[0]:n,r?"safari-extension:"+t:"safari-web-extension:"+t]:[e,t]}})),s.register("9Pq0V",(function(e,r){t(e.exports,"IS_DEBUG_BUILD",(()=>i));var i="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__})),s.register("6JSNk",(function(e,r){t(e.exports,"shouldIgnoreOnError",(()=>p)),t(e.exports,"wrap",(()=>g)),t(e.exports,"injectReportDialog",(()=>v));var i=s("7WQrb"),n=s("iPofb"),o=s("iDxMj");s("lD3gc");var a=s("42ap3"),l=s("jL8lq"),c=s("b1E2c"),u=s("4g0Ct"),h=s("9Pq0V"),d=a.getGlobalObject(),f=0;function p(){return f>0}function m(){f+=1,setTimeout((function(){f-=1}))}function g(e,t,r){if(void 0===t&&(t={}),"function"!=typeof e)return e;try{var s=e.__sentry_wrapped__;if(s)return s;if(l.getOriginalFunction(e))return e}catch(t){return e}var o=function(){var s=Array.prototype.slice.call(arguments);try{r&&"function"==typeof r&&r.apply(this,arguments);var o=s.map((function(e){return g(e,t)}));return e.apply(this,o)}catch(e){throw m(),n.withScope((function(r){r.addEventProcessor((function(e){return t.mechanism&&(c.addExceptionTypeValue(e,void 0,void 0),c.addExceptionMechanism(e,t.mechanism)),e.extra=i.__assign(i.__assign({},e.extra),{arguments:s}),e})),n.captureException(e)})),e}};try{for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(o[a]=e[a])}catch(e){}l.markFunctionWrapped(o,e),l.addNonEnumerableProperty(e,"__sentry_wrapped__",o);try{Object.getOwnPropertyDescriptor(o,"name").configurable&&Object.defineProperty(o,"name",{get:function(){return e.name}})}catch(e){}return o}function v(e){if(void 0===e&&(e={}),d.document)if(e.eventId)if(e.dsn){var t=d.document.createElement("script");t.async=!0,t.src=o.getReportDialogEndpoint(e.dsn,e),e.onLoad&&(t.onload=e.onLoad);var r=d.document.head||d.document.body;r&&r.appendChild(t)}else h.IS_DEBUG_BUILD&&u.logger.error("Missing dsn option in showReportDialog call");else h.IS_DEBUG_BUILD&&u.logger.error("Missing eventId option in showReportDialog call")}})),s.register("llG7W",(function(e,r){t(e.exports,"TryCatch",(()=>u));var i=s("7WQrb");s("lD3gc");var n=s("42ap3"),o=s("jL8lq"),a=s("16dZf"),l=s("6JSNk"),c=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],u=function(){function e(t){this.name=e.id,this._options=i.__assign({XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0},t)}return e.prototype.setupOnce=function(){var e=n.getGlobalObject();this._options.setTimeout&&o.fill(e,"setTimeout",h),this._options.setInterval&&o.fill(e,"setInterval",h),this._options.requestAnimationFrame&&o.fill(e,"requestAnimationFrame",d),this._options.XMLHttpRequest&&"XMLHttpRequest"in e&&o.fill(XMLHttpRequest.prototype,"send",f);var t=this._options.eventTarget;t&&(Array.isArray(t)?t:c).forEach(p)},e.id="TryCatch",e}();function h(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=t[0];return t[0]=l.wrap(i,{mechanism:{data:{function:a.getFunctionName(e)},handled:!0,type:"instrument"}}),e.apply(this,t)}}function d(e){return function(t){return e.apply(this,[l.wrap(t,{mechanism:{data:{function:"requestAnimationFrame",handler:a.getFunctionName(e)},handled:!0,type:"instrument"}})])}}function f(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var i=this,n=["onload","onerror","onprogress","onreadystatechange"];return n.forEach((function(e){e in i&&"function"==typeof i[e]&&o.fill(i,e,(function(t){var r={mechanism:{data:{function:e,handler:a.getFunctionName(t)},handled:!0,type:"instrument"}},i=o.getOriginalFunction(t);return i&&(r.mechanism.data.handler=a.getFunctionName(i)),l.wrap(t,r)}))})),e.apply(this,t)}}function p(e){var t=n.getGlobalObject(),r=t[e]&&t[e].prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(o.fill(r,"addEventListener",(function(t){return function(r,i,n){try{"function"==typeof i.handleEvent&&(i.handleEvent=l.wrap(i.handleEvent.bind(i),{mechanism:{data:{function:"handleEvent",handler:a.getFunctionName(i),target:e},handled:!0,type:"instrument"}}))}catch(e){}return t.apply(this,[r,l.wrap(i,{mechanism:{data:{function:"addEventListener",handler:a.getFunctionName(i),target:e},handled:!0,type:"instrument"}}),n])}})),o.fill(r,"removeEventListener",(function(e){return function(t,r,i){var n=r;try{var s=n&&n.__sentry_wrapped__;s&&e.call(this,t,s,i)}catch(e){}return e.call(this,t,n,i)}})))}})),s.register("fxK4w",(function(e,r){t(e.exports,"Breadcrumbs",(()=>f));var i=s("7WQrb"),n=s("8x56E"),o=s("31CCO");s("lD3gc");var a=s("b1E2c"),l=s("js14m"),c=s("ibKgU"),u=s("aU92a"),h=s("91U3U"),d=s("42ap3"),f=function(){function e(t){this.name=e.id,this._options=i.__assign({console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0},t)}return e.prototype.addSentryBreadcrumb=function(e){this._options.sentry&&n.getCurrentHub().addBreadcrumb({category:"sentry."+("transaction"===e.type?"transaction":"event"),event_id:e.event_id,level:e.level,message:a.getEventDescription(e)},{event:e})},e.prototype.setupOnce=function(){this._options.console&&l.addInstrumentationHandler("console",p),this._options.dom&&l.addInstrumentationHandler("dom",function(e){function t(t){var r,i="object"==typeof e?e.serializeAttribute:void 0;"string"==typeof i&&(i=[i]);try{r=t.event.target?c.htmlTreeAsString(t.event.target,i):c.htmlTreeAsString(t.event,i)}catch(e){r="<unknown>"}0!==r.length&&n.getCurrentHub().addBreadcrumb({category:"ui."+t.name,message:r},{event:t.event,name:t.name,global:t.global})}return t}(this._options.dom)),this._options.xhr&&l.addInstrumentationHandler("xhr",m),this._options.fetch&&l.addInstrumentationHandler("fetch",g),this._options.history&&l.addInstrumentationHandler("history",v)},e.id="Breadcrumbs",e}();function p(e){var t={category:"console",data:{arguments:e.args,logger:"console"},level:u.severityFromString(e.level),message:h.safeJoin(e.args," ")};if("assert"===e.level){if(!1!==e.args[0])return;t.message="Assertion failed: "+(h.safeJoin(e.args.slice(1)," ")||"console.assert"),t.data.arguments=e.args.slice(1)}n.getCurrentHub().addBreadcrumb(t,{input:e.args,level:e.level})}function m(e){if(e.endTimestamp){if(e.xhr.__sentry_own_request__)return;var t=e.xhr.__sentry_xhr__||{},r=t.method,i=t.url,s=t.status_code,o=t.body;n.getCurrentHub().addBreadcrumb({category:"xhr",data:{method:r,url:i,status_code:s},type:"http"},{xhr:e.xhr,input:o})}else;}function g(e){e.endTimestamp&&(e.fetchData.url.match(/sentry_key/)&&"POST"===e.fetchData.method||(e.error?n.getCurrentHub().addBreadcrumb({category:"fetch",data:e.fetchData,level:o.Severity.Error,type:"http"},{data:e.error,input:e.args}):n.getCurrentHub().addBreadcrumb({category:"fetch",data:i.__assign(i.__assign({},e.fetchData),{status_code:e.response.status}),type:"http"},{input:e.args,response:e.response})))}function v(e){var t=d.getGlobalObject(),r=e.from,i=e.to,s=a.parseUrl(t.location.href),o=a.parseUrl(r),l=a.parseUrl(i);o.path||(o=s),s.protocol===l.protocol&&s.host===l.host&&(i=l.relative),s.protocol===o.protocol&&s.host===o.host&&(r=o.relative),n.getCurrentHub().addBreadcrumb({category:"navigation",data:{from:r,to:i}})}})),s.register("9SQUp",(function(e,r){t(e.exports,"LinkedErrors",(()=>c));var i=s("7WQrb"),n=s("NU9Qs"),o=s("8x56E");s("lD3gc");var a=s("2zW56"),l=s("30niQ"),c=function(){function e(t){void 0===t&&(t={}),this.name=e.id,this._key=t.key||"cause",this._limit=t.limit||5}return e.prototype.setupOnce=function(){n.addGlobalEventProcessor((function(t,r){var n=o.getCurrentHub().getIntegration(e);return n?function(e,t,r,n){if(!(r.exception&&r.exception.values&&n&&a.isInstanceOf(n.originalException,Error)))return r;var s=u(t,n.originalException,e);return r.exception.values=i.__spread(s,r.exception.values),r}(n._key,n._limit,t,r):t}))},e.id="LinkedErrors",e}();function u(e,t,r,n){if(void 0===n&&(n=[]),!a.isInstanceOf(t[r],Error)||n.length+1>=e)return n;var s=l.exceptionFromError(t[r]);return u(e,t[r],r,i.__spread([s],n))}})),s.register("50nXt",(function(e,r){t(e.exports,"UserAgent",(()=>l));var i=s("7WQrb"),n=s("NU9Qs"),o=s("8x56E");s("lD3gc");var a=s("42ap3").getGlobalObject(),l=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(){n.addGlobalEventProcessor((function(t){if(o.getCurrentHub().getIntegration(e)){if(!a.navigator&&!a.location&&!a.document)return t;var r=t.request&&t.request.url||a.location&&a.location.href,n=(a.document||{}).referrer,s=(a.navigator||{}).userAgent,l=i.__assign(i.__assign(i.__assign({},t.request&&t.request.headers),n&&{Referer:n}),s&&{"User-Agent":s}),c=i.__assign(i.__assign({},r&&{url:r}),{headers:l});return i.__assign(i.__assign({},t),{request:c})}return t}))},e.id="UserAgent",e}()})),s.register("bMyDX",(function(e,r){t(e.exports,"Dedupe",(()=>o)),s("lD3gc");var i=s("4g0Ct"),n=s("9Pq0V"),o=function(){function e(){this.name=e.id}return e.prototype.setupOnce=function(t,r){t((function(t){var s=r().getIntegration(e);if(s){try{if(function(e,t){return!!t&&(!!function(e,t){var r=e.message,i=t.message;return!(!r&&!i)&&(!(r&&!i||!r&&i)&&(r===i&&(!!l(e,t)&&!!a(e,t))))}(e,t)||!!function(e,t){var r=c(t),i=c(e);return!(!r||!i)&&(r.type===i.type&&r.value===i.value&&(!!l(e,t)&&!!a(e,t)))}(e,t))}(t,s._previousEvent))return n.IS_DEBUG_BUILD&&i.logger.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(e){return s._previousEvent=t}return s._previousEvent=t}return t}))},e.id="Dedupe",e}();function a(e,t){var r=u(e),i=u(t);if(!r&&!i)return!0;if(r&&!i||!r&&i)return!1;if(i.length!==r.length)return!1;for(var n=0;n<i.length;n++){var s=i[n],o=r[n];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function l(e,t){var r=e.fingerprint,i=t.fingerprint;if(!r&&!i)return!0;if(r&&!i||!r&&i)return!1;try{return!(r.join("")!==i.join(""))}catch(e){return!1}}function c(e){return e.exception&&e.exception.values&&e.exception.values[0]}function u(e){var t=e.exception;if(t)try{return t.values[0].stacktrace.frames}catch(e){return}else if(e.stacktrace)return e.stacktrace.frames}})),s.register("1IBJy",(function(e,r){t(e.exports,"BaseTransport",(()=>s("1yTmS").BaseTransport)),t(e.exports,"FetchTransport",(()=>s("cyjuS").FetchTransport)),t(e.exports,"XHRTransport",(()=>s("c0B2u").XHRTransport)),t(e.exports,"makeNewFetchTransport",(()=>s("bF6MV").makeNewFetchTransport)),t(e.exports,"makeNewXHRTransport",(()=>s("gCJJr").makeNewXHRTransport));s("1yTmS"),s("cyjuS"),s("c0B2u"),s("bF6MV"),s("gCJJr")})),s.register("1yTmS",(function(e,r){t(e.exports,"BaseTransport",(()=>b));var i=s("7WQrb"),n=s("iDxMj"),o=s("k2nY8");s("lD3gc");var a=s("42ap3"),l=s("jpxdy"),c=s("4g0Ct"),u=s("iDlgA"),h=s("ldaPw"),d=s("3PPTH"),f=s("isOOR"),p=s("jf8Z1"),m=s("9Pq0V"),g=s("aK927");function v(e){return"event"===e?"error":e}var _=a.getGlobalObject(),b=function(){function e(e){var t=this;this.options=e,this._buffer=l.makePromiseBuffer(30),this._rateLimits={},this._outcomes={},this._api=n.initAPIDetails(e.dsn,e._metadata,e.tunnel),this.url=n.getStoreEndpointWithUrlEncodedAuth(this._api.dsn),this.options.sendClientReports&&_.document&&_.document.addEventListener("visibilitychange",(function(){"hidden"===_.document.visibilityState&&t._flushOutcomes()}))}return e.prototype.sendEvent=function(e){return this._sendRequest(o.eventToSentryRequest(e,this._api),e)},e.prototype.sendSession=function(e){return this._sendRequest(o.sessionToSentryRequest(e,this._api),e)},e.prototype.close=function(e){return this._buffer.drain(e)},e.prototype.recordLostEvent=function(e,t){var r;if(this.options.sendClientReports){var i=v(t)+":"+e;m.IS_DEBUG_BUILD&&c.logger.log("Adding outcome: "+i),this._outcomes[i]=(null!=(r=this._outcomes[i])?r:0)+1}},e.prototype._flushOutcomes=function(){if(this.options.sendClientReports){var e=this._outcomes;if(this._outcomes={},Object.keys(e).length){m.IS_DEBUG_BUILD&&c.logger.log("Flushing outcomes:\n"+JSON.stringify(e,null,2));var t=n.getEnvelopeEndpointWithUrlEncodedAuth(this._api.dsn,this._api.tunnel),r=Object.keys(e).map((function(t){var r=i.__read(t.split(":"),2),n=r[0];return{reason:r[1],category:n,quantity:e[t]}})),s=u.createClientReportEnvelope(r,this._api.tunnel&&h.dsnToString(this._api.dsn));try{g.sendReport(t,d.serializeEnvelope(s))}catch(e){m.IS_DEBUG_BUILD&&c.logger.error(e)}}else m.IS_DEBUG_BUILD&&c.logger.log("No outcomes to flush")}},e.prototype._handleResponse=function(e){var t=e.requestType,r=e.response,i=e.headers,n=e.resolve,s=e.reject,o=f.eventStatusFromHttpCode(r.status);this._rateLimits=p.updateRateLimits(this._rateLimits,i),this._isRateLimited(t)&&m.IS_DEBUG_BUILD&&c.logger.warn("Too many "+t+" requests, backing off until: "+this._disabledUntil(t)),"success"!==o?s(r):n({status:o})},e.prototype._disabledUntil=function(e){var t=v(e);return new Date(p.disabledUntil(this._rateLimits,t))},e.prototype._isRateLimited=function(e){var t=v(e);return p.isRateLimited(this._rateLimits,t)},e}()})),s.register("aK927",(function(e,r){t(e.exports,"getNativeFetchImplementation",(()=>h)),t(e.exports,"sendReport",(()=>d)),s("lD3gc");var i,n=s("42ap3"),o=s("esO9h"),a=s("4g0Ct"),l=s("5Jod9"),c=s("9Pq0V"),u=n.getGlobalObject();function h(){if(i)return i;if(o.isNativeFetch(u.fetch))return i=u.fetch.bind(u);var e=u.document,t=u.fetch;if(e&&"function"==typeof e.createElement)try{var r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r);var n=r.contentWindow;n&&n.fetch&&(t=n.fetch),e.head.removeChild(r)}catch(e){c.IS_DEBUG_BUILD&&a.logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",e)}return i=t.bind(u)}function d(e,t){if("[object Navigator]"===Object.prototype.toString.call(u&&u.navigator)&&"function"==typeof u.navigator.sendBeacon)return u.navigator.sendBeacon.bind(u.navigator)(e,t);if(o.supportsFetch()){var r=h();return l.forget(r(e,{body:t,method:"POST",credentials:"omit",keepalive:!0}))}}})),s.register("cyjuS",(function(e,r){t(e.exports,"FetchTransport",(()=>u));var i=s("7WQrb");s("lD3gc");var n=s("esO9h"),o=s("j3a3y"),a=s("bLvfM"),l=s("1yTmS"),c=s("aK927"),u=function(e){function t(t,r){void 0===r&&(r=c.getNativeFetchImplementation());var i=e.call(this,t)||this;return i._fetch=r,i}return i.__extends(t,e),t.prototype._sendRequest=function(e,t){var r=this;if(this._isRateLimited(e.type))return this.recordLostEvent("ratelimit_backoff",e.type),Promise.reject({event:t,type:e.type,reason:"Transport for "+e.type+" requests locked till "+this._disabledUntil(e.type)+" due to too many requests.",status:429});var i={body:e.body,method:"POST",referrerPolicy:n.supportsReferrerPolicy()?"origin":""};return void 0!==this.options.fetchParameters&&Object.assign(i,this.options.fetchParameters),void 0!==this.options.headers&&(i.headers=this.options.headers),this._buffer.add((function(){return new o.SyncPromise((function(t,n){r._fetch(e.url,i).then((function(i){var s={"x-sentry-rate-limits":i.headers.get("X-Sentry-Rate-Limits"),"retry-after":i.headers.get("Retry-After")};r._handleResponse({requestType:e.type,response:i,headers:s,resolve:t,reject:n})})).catch(n)}))})).then(void 0,(function(t){throw t instanceof a.SentryError?r.recordLostEvent("queue_overflow",e.type):r.recordLostEvent("network_error",e.type),t}))},t}(l.BaseTransport)})),s.register("c0B2u",(function(e,r){t(e.exports,"XHRTransport",(()=>a));var i=s("7WQrb");s("lD3gc");var n=s("j3a3y"),o=s("bLvfM"),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype._sendRequest=function(e,t){var r=this;return this._isRateLimited(e.type)?(this.recordLostEvent("ratelimit_backoff",e.type),Promise.reject({event:t,type:e.type,reason:"Transport for "+e.type+" requests locked till "+this._disabledUntil(e.type)+" due to too many requests.",status:429})):this._buffer.add((function(){return new n.SyncPromise((function(t,i){var n=new XMLHttpRequest;for(var s in n.onreadystatechange=function(){if(4===n.readyState){var s={"x-sentry-rate-limits":n.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":n.getResponseHeader("Retry-After")};r._handleResponse({requestType:e.type,response:n,headers:s,resolve:t,reject:i})}},n.open("POST",e.url),r.options.headers)Object.prototype.hasOwnProperty.call(r.options.headers,s)&&n.setRequestHeader(s,r.options.headers[s]);n.send(e.body)}))})).then(void 0,(function(t){throw t instanceof o.SentryError?r.recordLostEvent("queue_overflow",e.type):r.recordLostEvent("network_error",e.type),t}))},t}(s("1yTmS").BaseTransport)})),s.register("bF6MV",(function(e,r){t(e.exports,"makeNewFetchTransport",(()=>a));var i=s("7WQrb"),n=s("7j791"),o=s("aK927");function a(e,t){return void 0===t&&(t=o.getNativeFetchImplementation()),n.createTransport({bufferSize:e.bufferSize},(function(r){var n=i.__assign({body:r.body,method:"POST",referrerPolicy:"origin"},e.requestOptions);return t(e.url,n).then((function(e){return e.text().then((function(t){return{body:t,headers:{"x-sentry-rate-limits":e.headers.get("X-Sentry-Rate-Limits"),"retry-after":e.headers.get("Retry-After")},reason:e.statusText,statusCode:e.status}}))}))}))}})),s.register("gCJJr",(function(e,r){t(e.exports,"makeNewXHRTransport",(()=>o));var i=s("7j791");s("lD3gc");var n=s("j3a3y");function o(e){return i.createTransport({bufferSize:e.bufferSize},(function(t){return new n.SyncPromise((function(r,i){var n=new XMLHttpRequest;for(var s in n.onreadystatechange=function(){if(4===n.readyState){var e={body:n.response,headers:{"x-sentry-rate-limits":n.getResponseHeader("X-Sentry-Rate-Limits"),"retry-after":n.getResponseHeader("Retry-After")},reason:n.statusText,statusCode:n.status};r(e)}},n.open("POST",e.url),e.headers)Object.prototype.hasOwnProperty.call(e.headers,s)&&n.setRequestHeader(s,e.headers[s]);n.send(t.body)}))}))}})),s.register("4QUMh",(function(e,r){t(e.exports,"Severity",(()=>s("31CCO").Severity)),t(e.exports,"addGlobalEventProcessor",(()=>s("NU9Qs").addGlobalEventProcessor)),t(e.exports,"addBreadcrumb",(()=>s("iPofb").addBreadcrumb)),t(e.exports,"captureException",(()=>s("iPofb").captureException)),t(e.exports,"captureEvent",(()=>s("iPofb").captureEvent)),t(e.exports,"captureMessage",(()=>s("iPofb").captureMessage)),t(e.exports,"configureScope",(()=>s("iPofb").configureScope)),t(e.exports,"getHubFromCarrier",(()=>s("8x56E").getHubFromCarrier)),t(e.exports,"getCurrentHub",(()=>s("8x56E").getCurrentHub)),t(e.exports,"Hub",(()=>s("8x56E").Hub)),t(e.exports,"makeMain",(()=>s("8x56E").makeMain)),t(e.exports,"Scope",(()=>s("NU9Qs").Scope)),t(e.exports,"Session",(()=>s("lvhwF").Session)),t(e.exports,"startTransaction",(()=>s("iPofb").startTransaction)),t(e.exports,"SDK_VERSION",(()=>s("9OAWn").SDK_VERSION)),t(e.exports,"setContext",(()=>s("iPofb").setContext)),t(e.exports,"setExtra",(()=>s("iPofb").setExtra)),t(e.exports,"setExtras",(()=>s("iPofb").setExtras)),t(e.exports,"setTag",(()=>s("iPofb").setTag)),t(e.exports,"setTags",(()=>s("iPofb").setTags)),t(e.exports,"setUser",(()=>s("iPofb").setUser)),t(e.exports,"withScope",(()=>s("iPofb").withScope)),t(e.exports,"BrowserClient",(()=>s("gWrK2").BrowserClient)),t(e.exports,"injectReportDialog",(()=>s("6JSNk").injectReportDialog)),t(e.exports,"eventFromException",(()=>s("30niQ").eventFromException)),t(e.exports,"eventFromMessage",(()=>s("30niQ").eventFromMessage)),t(e.exports,"defaultIntegrations",(()=>s("6zmxU").defaultIntegrations)),t(e.exports,"forceLoad",(()=>s("6zmxU").forceLoad)),t(e.exports,"init",(()=>s("6zmxU").init)),t(e.exports,"lastEventId",(()=>s("6zmxU").lastEventId)),t(e.exports,"onLoad",(()=>s("6zmxU").onLoad)),t(e.exports,"showReportDialog",(()=>s("6zmxU").showReportDialog)),t(e.exports,"flush",(()=>s("6zmxU").flush)),t(e.exports,"close",(()=>s("6zmxU").close)),t(e.exports,"wrap",(()=>s("6zmxU").wrap)),t(e.exports,"SDK_NAME",(()=>s("dB0fQ").SDK_NAME));s("31CCO"),s("NU9Qs"),s("iPofb"),s("8x56E"),s("lvhwF"),s("9OAWn"),s("gWrK2"),s("6JSNk"),s("30niQ"),s("6zmxU"),s("dB0fQ")})),s.register("gWrK2",(function(e,r){t(e.exports,"BrowserClient",(()=>f));var i=s("7WQrb"),n=s("9OAWn"),o=s("80A9Z");s("lD3gc");var a=s("42ap3"),l=s("4g0Ct"),c=s("dsaYW"),u=s("9Pq0V"),h=s("6JSNk");s("a05ws");var d=s("fxK4w"),f=function(e){function t(t){void 0===t&&(t={});return t._metadata=t._metadata||{},t._metadata.sdk=t._metadata.sdk||{name:"sentry.javascript.browser",packages:[{name:"npm:@sentry/browser",version:n.SDK_VERSION}],version:n.SDK_VERSION},e.call(this,c.BrowserBackend,t)||this}return i.__extends(t,e),t.prototype.showReportDialog=function(e){void 0===e&&(e={}),a.getGlobalObject().document&&(this._isEnabled()?h.injectReportDialog(i.__assign(i.__assign({},e),{dsn:e.dsn||this.getDsn()})):u.IS_DEBUG_BUILD&&l.logger.error("Trying to call showReportDialog with Sentry Client disabled"))},t.prototype._prepareEvent=function(t,r,i){return t.platform=t.platform||"javascript",e.prototype._prepareEvent.call(this,t,r,i)},t.prototype._sendEvent=function(t){var r=this.getIntegration(d.Breadcrumbs);r&&r.addSentryBreadcrumb(t),e.prototype._sendEvent.call(this,t)},t}(o.BaseClient)})),s.register("dsaYW",(function(e,r){t(e.exports,"BrowserBackend",(()=>p));var i=s("7WQrb"),n=s("iDxMj"),o=s("8sMFq"),a=s("31CCO");s("lD3gc");var l=s("esO9h"),c=s("30niQ");s("1IBJy");var u=s("bF6MV"),h=s("cyjuS"),d=s("gCJJr"),f=s("c0B2u"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.eventFromException=function(e,t){return c.eventFromException(e,t,this._options.attachStacktrace)},t.prototype.eventFromMessage=function(e,t,r){return void 0===t&&(t=a.Severity.Info),c.eventFromMessage(e,t,r,this._options.attachStacktrace)},t.prototype._setupTransport=function(){if(!this._options.dsn)return e.prototype._setupTransport.call(this);var t=i.__assign(i.__assign({},this._options.transportOptions),{dsn:this._options.dsn,tunnel:this._options.tunnel,sendClientReports:this._options.sendClientReports,_metadata:this._options._metadata}),r=n.initAPIDetails(t.dsn,t._metadata,t.tunnel),s=n.getEnvelopeEndpointWithUrlEncodedAuth(r.dsn,r.tunnel);if(this._options.transport)return new this._options.transport(t);if(l.supportsFetch()){var o=i.__assign({},t.fetchParameters);return this._newTransport=u.makeNewFetchTransport({requestOptions:o,url:s}),new h.FetchTransport(t)}return this._newTransport=d.makeNewXHRTransport({url:s,headers:t.headers}),new f.XHRTransport(t)},t}(o.BaseBackend)})),s.register("6zmxU",(function(e,r){t(e.exports,"defaultIntegrations",(()=>E)),t(e.exports,"init",(()=>w)),t(e.exports,"showReportDialog",(()=>x)),t(e.exports,"lastEventId",(()=>A)),t(e.exports,"forceLoad",(()=>T)),t(e.exports,"onLoad",(()=>S)),t(e.exports,"flush",(()=>M)),t(e.exports,"close",(()=>C)),t(e.exports,"wrap",(()=>R));var i=s("7WQrb"),n=s("icP6J"),o=s("cCtO1"),a=s("8x56E");s("lD3gc");var l=s("42ap3"),c=s("4g0Ct"),u=s("j3a3y"),h=s("js14m"),d=s("gWrK2"),f=s("9Pq0V"),p=s("6JSNk");s("a05ws");var m=s("llG7W"),g=s("fxK4w"),v=s("dw5F0"),_=s("9SQUp"),b=s("bMyDX"),y=s("50nXt"),E=[new n.InboundFilters,new n.FunctionToString,new m.TryCatch,new g.Breadcrumbs,new v.GlobalHandlers,new _.LinkedErrors,new b.Dedupe,new y.UserAgent];function w(e){if(void 0===e&&(e={}),void 0===e.defaultIntegrations&&(e.defaultIntegrations=E),void 0===e.release){var t=l.getGlobalObject();t.SENTRY_RELEASE&&t.SENTRY_RELEASE.id&&(e.release=t.SENTRY_RELEASE.id)}void 0===e.autoSessionTracking&&(e.autoSessionTracking=!0),void 0===e.sendClientReports&&(e.sendClientReports=!0),o.initAndBind(d.BrowserClient,e),e.autoSessionTracking&&function(){if(void 0===l.getGlobalObject().document)return void(f.IS_DEBUG_BUILD&&c.logger.warn("Session tracking in non-browser environment with @sentry/browser is not supported."));var e=a.getCurrentHub();if(!e.captureSession)return;I(e),h.addInstrumentationHandler("history",(function(e){var t=e.from,r=e.to;void 0!==t&&t!==r&&I(a.getCurrentHub())}))}()}function x(e){void 0===e&&(e={});var t=a.getCurrentHub(),r=t.getScope();r&&(e.user=i.__assign(i.__assign({},r.getUser()),e.user)),e.eventId||(e.eventId=t.lastEventId());var n=t.getClient();n&&n.showReportDialog(e)}function A(){return a.getCurrentHub().lastEventId()}function T(){}function S(e){e()}function M(e){var t=a.getCurrentHub().getClient();return t?t.flush(e):(f.IS_DEBUG_BUILD&&c.logger.warn("Cannot flush events. No client defined."),u.resolvedSyncPromise(!1))}function C(e){var t=a.getCurrentHub().getClient();return t?t.close(e):(f.IS_DEBUG_BUILD&&c.logger.warn("Cannot flush events and disable SDK. No client defined."),u.resolvedSyncPromise(!1))}function R(e){return p.wrap(e)()}function I(e){e.startSession({ignoreDuration:!0}),e.captureSession()}})),s.register("dB0fQ",(function(e,r){t(e.exports,"SDK_NAME",(()=>i));var i="sentry.javascript.browser"})),s.register("imozB",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.build_data=void 0;var r=s("gF26D");Object.defineProperty(e.exports,"build_data",{enumerable:!0,get:function(){return r.build_data}})})),s.register("gF26D",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.build_data=void 0,e.exports.build_data={build_version:"3.1.14.0",build_date:"2022-04-12T18:18:40.526Z",build_branch:"development",build_commit:"034fb947e52fab5765d6a11d0ebac89e44d0fc6b"}})),s.register("eXqCS",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverSdkConfigType=e.exports.ShapeDiverSdkApiResponseType=e.exports.ShapeDiverSdkApi=e.exports.ShapeDiverResponseError=e.exports.ShapeDiverRequestError=e.exports.ShapeDiverError=e.exports.BaseShapeDiverSdk=e.exports.BaseResourceApi=void 0;var r=s("5dzyt");Object.defineProperty(e.exports,"ShapeDiverSdkApi",{enumerable:!0,get:function(){return r.ShapeDiverSdkApi}}),Object.defineProperty(e.exports,"ShapeDiverSdkApiResponseType",{enumerable:!0,get:function(){return r.ShapeDiverSdkApiResponseType}});var i=s("3rFH2");Object.defineProperty(e.exports,"BaseShapeDiverSdk",{enumerable:!0,get:function(){return i.BaseShapeDiverSdk}});var n=s("4r9gW");Object.defineProperty(e.exports,"ShapeDiverSdkConfigType",{enumerable:!0,get:function(){return n.ShapeDiverSdkConfigType}});var o=s("5YeQ1");Object.defineProperty(e.exports,"BaseResourceApi",{enumerable:!0,get:function(){return o.BaseResourceApi}});var a=s("gdqZ6");Object.defineProperty(e.exports,"ShapeDiverError",{enumerable:!0,get:function(){return a.ShapeDiverError}}),Object.defineProperty(e.exports,"ShapeDiverRequestError",{enumerable:!0,get:function(){return a.ShapeDiverRequestError}}),Object.defineProperty(e.exports,"ShapeDiverResponseError",{enumerable:!0,get:function(){return a.ShapeDiverResponseError}})})),s.register("5dzyt",(function(e,t){var r=s("6ZWSX").Buffer,i=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},n=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverSdkApi=e.exports.ShapeDiverSdkApiResponseType=void 0;const o=n(s("fmRoT"));var a,l,c,u,h=s("gdqZ6");(l=a||(a={})).DELETE="DELETE",l.GET="GET",l.PATCH="PATCH",l.POST="POST",l.PUT="PUT",(u=c=e.exports.ShapeDiverSdkApiResponseType||(e.exports.ShapeDiverSdkApiResponseType={})).JSON="json",u.DATA="arraybuffer",u.TEXT="text";class d{constructor(e){this.config=e}buildRequestConfig(e,t,r){const i={method:e,headers:{},responseType:t.responseType,data:void 0};return t.disableCustomHeaders||(i.headers=Object.assign({},this.config.headers)),i.headers["Content-Type"]=t.contentType,t.disableAuthorization?(delete i.headers.Authorization,delete i.headers.authorization):this.config.jwt&&(i.headers.Authorization="Bearer "+this.config.jwt),"application/json"===t.contentType&&r?i.data=JSON.stringify(r):i.data=r,i}buildUrl(e){if("string"!=typeof e)throw new h.ShapeDiverError("No URL or URI was specified");return e.startsWith("http")?e:e.startsWith("/")?`${this.config.baseUrl}/${e.substring(1)}`:`${this.config.baseUrl}/${e}`}static processError(e,t){var r,n,s;return i(this,void 0,void 0,(function*(){if(e.response){const i=e.response;let o;throw o=t===c.DATA?this.convertErrorResponseData(i.data):i.data,new h.ShapeDiverResponseError(o.message||(null!==(r=o.desc)&&void 0!==r?r:""),i.status,null!==(n=o.error)&&void 0!==n?n:"",null!==(s=o.desc)&&void 0!==s?s:"",i.headers)}throw e.request?new h.ShapeDiverRequestError("Could not send request.","The request was made but no response was received"):new h.ShapeDiverError(e.message)}))}static convertErrorResponseData(e){let t;if("undefined"==typeof window)t=r.from(e).toString();else{if(!window.TextDecoder)throw new h.ShapeDiverError("Received an unknown error object");t=new TextDecoder("utf-8").decode(new Uint8Array(e))}try{return JSON.parse(t)}catch(e){return{message:t}}}get(e,t={contentType:"application/json",responseType:c.JSON}){return i(this,void 0,void 0,(function*(){const r=this.buildRequestConfig(a.GET,t,void 0);try{return(yield(0,o.default)(this.buildUrl(e),r)).data}catch(e){return yield d.processError(e,t.responseType)}}))}post(e,t={},r={contentType:"application/json",responseType:c.JSON}){return i(this,void 0,void 0,(function*(){const i=this.buildRequestConfig(a.POST,r,t);try{return(yield(0,o.default)(this.buildUrl(e),i)).data}catch(e){return yield d.processError(e,r.responseType)}}))}put(e,t={},r={contentType:"application/json",responseType:c.JSON}){return i(this,void 0,void 0,(function*(){const i=this.buildRequestConfig(a.PUT,r,t);try{return(yield(0,o.default)(this.buildUrl(e),i)).data}catch(e){return yield d.processError(e,r.responseType)}}))}patch(e,t={},r={contentType:"application/json",responseType:c.JSON}){return i(this,void 0,void 0,(function*(){const i=this.buildRequestConfig(a.PATCH,r,t);try{return(yield(0,o.default)(this.buildUrl(e),i)).data}catch(e){return yield d.processError(e,r.responseType)}}))}delete(e,t={contentType:"application/json",responseType:c.JSON}){return i(this,void 0,void 0,(function*(){const r=this.buildRequestConfig(a.DELETE,t,{});try{return(yield(0,o.default)(this.buildUrl(e),r)).data}catch(e){return yield d.processError(e,t.responseType)}}))}}e.exports.ShapeDiverSdkApi=d})),s.register("6ZWSX",(function(e,r){var i,n;t(e.exports,"Buffer",(()=>i),(e=>i=e)),t(e.exports,"INSPECT_MAX_BYTES",(()=>n),(e=>n=e));var o=s("kuxul"),a=s("9NvM5");const l="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;i=h,n=50;const c=2147483647;function u(e){if(e>c)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,h.prototype),t}function h(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return p(e)}return d(e,t,r)}function d(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!h.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|_(e,t);let i=u(r);const n=i.write(e,t);n!==r&&(i=i.slice(0,n));return i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(K(e,Uint8Array)){const t=new Uint8Array(e);return g(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(K(e,ArrayBuffer)||e&&K(e.buffer,ArrayBuffer))return g(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(K(e,SharedArrayBuffer)||e&&K(e.buffer,SharedArrayBuffer)))return g(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return h.from(i,t,r);const n=function(e){if(h.isBuffer(e)){const t=0|v(e.length),r=u(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||Q(e.length)?u(0):m(e);if("Buffer"===e.type&&Array.isArray(e.data))return m(e.data)}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return h.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function p(e){return f(e),u(e<0?0:0|v(e))}function m(e){const t=e.length<0?0:0|v(e.length),r=u(t);for(let i=0;i<t;i+=1)r[i]=255&e[i];return r}function g(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let i;return i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(i,h.prototype),i}function v(e){if(e>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return 0|e}function _(e,t){if(h.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||K(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return X(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Z(e).length;default:if(n)return i?-1:X(e).length;t=(""+t).toLowerCase(),n=!0}}function b(e,t,r){let i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,r);case"utf8":case"utf-8":return R(this,t,r);case"ascii":return O(this,t,r);case"latin1":case"binary":return P(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,r){const i=e[t];e[t]=e[r],e[r]=i}function E(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),Q(r=+r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=h.from(t,i)),h.isBuffer(t))return 0===t.length?-1:w(e,t,r,i,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):w(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function w(e,t,r,i,n){let s,o=1,a=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(n){let i=-1;for(s=r;s<a;s++)if(c(e,s)===c(t,-1===i?0:s-i)){if(-1===i&&(i=s),s-i+1===l)return i*o}else-1!==i&&(s-=s-i),i=-1}else for(r+l>a&&(r=a-l),s=r;s>=0;s--){let r=!0;for(let i=0;i<l;i++)if(c(e,s+i)!==c(t,i)){r=!1;break}if(r)return s}return-1}function x(e,t,r,i){r=Number(r)||0;const n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;const s=t.length;let o;for(i>s/2&&(i=s/2),o=0;o<i;++o){const i=parseInt(t.substr(2*o,2),16);if(Q(i))return o;e[r+o]=i}return o}function A(e,t,r,i){return J(X(t,e.length-r),e,r,i)}function T(e,t,r,i){return J(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function S(e,t,r,i){return J(Z(t),e,r,i)}function M(e,t,r,i){return J(function(e,t){let r,i,n;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i);return s}(t,e.length-r),e,r,i)}function C(e,t,r){return 0===t&&r===e.length?o.fromByteArray(e):o.fromByteArray(e.slice(t,r))}function R(e,t,r){r=Math.min(e.length,r);const i=[];let n=t;for(;n<r;){const t=e[n];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(n+o<=r){let r,i,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[n+1],128==(192&r)&&(l=(31&t)<<6|63&r,l>127&&(s=l));break;case 3:r=e[n+1],i=e[n+2],128==(192&r)&&128==(192&i)&&(l=(15&t)<<12|(63&r)<<6|63&i,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:r=e[n+1],i=e[n+2],a=e[n+3],128==(192&r)&&128==(192&i)&&128==(192&a)&&(l=(15&t)<<18|(63&r)<<12|(63&i)<<6|63&a,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|1023&s),i.push(s),n+=o}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let r="",i=0;for(;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=I));return r}(i)}h.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),h.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=function(e,t,r){return d(e,t,r)},Object.setPrototypeOf(h.prototype,Uint8Array.prototype),Object.setPrototypeOf(h,Uint8Array),h.alloc=function(e,t,r){return function(e,t,r){return f(e),e<=0?u(e):void 0!==t?"string"==typeof r?u(e).fill(t,r):u(e).fill(t):u(e)}(e,t,r)},h.allocUnsafe=function(e){return p(e)},h.allocUnsafeSlow=function(e){return p(e)},h.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==h.prototype},h.compare=function(e,t){if(K(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),K(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(e)||!h.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,i=t.length;for(let n=0,s=Math.min(r,i);n<s;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},h.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return h.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const i=h.allocUnsafe(t);let n=0;for(r=0;r<e.length;++r){let t=e[r];if(K(t,Uint8Array))n+t.length>i.length?(h.isBuffer(t)||(t=h.from(t)),t.copy(i,n)):Uint8Array.prototype.set.call(i,t,n);else{if(!h.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(i,n)}n+=t.length}return i},h.byteLength=_,h.prototype._isBuffer=!0,h.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},h.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},h.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},h.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?R(this,0,e):b.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(e){if(!h.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===h.compare(this,e)},h.prototype.inspect=function(){let e="";const t=n;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},l&&(h.prototype[l]=h.prototype.inspect),h.prototype.compare=function(e,t,r,i,n){if(K(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(n>>>=0)-(i>>>=0),o=(r>>>=0)-(t>>>=0);const a=Math.min(s,o),l=this.slice(i,n),c=e.slice(t,r);for(let e=0;e<a;++e)if(l[e]!==c[e]){s=l[e],o=c[e];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},h.prototype.indexOf=function(e,t,r){return E(this,e,t,r,!0)},h.prototype.lastIndexOf=function(e,t,r){return E(this,e,t,r,!1)},h.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}const n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return x(this,e,t,r);case"utf8":case"utf-8":return A(this,e,t,r);case"ascii":case"latin1":case"binary":return T(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function O(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function P(e,t,r){let i="";r=Math.min(e.length,r);for(let n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function k(e,t,r){const i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);let n="";for(let i=t;i<r;++i)n+=ee[e[i]];return n}function L(e,t,r){const i=e.slice(t,r);let n="";for(let e=0;e<i.length-1;e+=2)n+=String.fromCharCode(i[e]+256*i[e+1]);return n}function N(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function G(e,t,r,i,n,s){if(!h.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<s)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function D(e,t,r,i,n){H(t,i,n,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function U(e,t,r,i,n){H(t,i,n,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function V(e,t,r,i,n,s){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,i,n){return t=+t,r>>>=0,n||V(e,0,r,4),a.write(e,t,r,i,23,4),r+4}function F(e,t,r,i,n){return t=+t,r>>>=0,n||V(e,0,r,8),a.write(e,t,r,i,52,8),r+8}h.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const i=this.subarray(e,t);return Object.setPrototypeOf(i,h.prototype),i},h.prototype.readUintLE=h.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return i},h.prototype.readUintBE=h.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let i=this[e+--t],n=1;for(;t>0&&(n*=256);)i+=this[e+--t]*n;return i},h.prototype.readUint8=h.prototype.readUInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),this[e]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]|this[e+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]<<8|this[e+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},h.prototype.readBigUInt64LE=te((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);const i=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,n=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(i)+(BigInt(n)<<BigInt(32))})),h.prototype.readBigUInt64BE=te((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);const i=t*2**24+65536*this[++e]+256*this[++e]+this[++e],n=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(i)<<BigInt(32))+BigInt(n)})),h.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let i=this[e],n=1,s=0;for(;++s<t&&(n*=256);)i+=this[e+s]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*t)),i},h.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);let i=t,n=1,s=this[e+--i];for(;i>0&&(n*=256);)s+=this[e+--i]*n;return n*=128,s>=n&&(s-=Math.pow(2,8*t)),s},h.prototype.readInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},h.prototype.readInt16LE=function(e,t){e>>>=0,t||N(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(e,t){e>>>=0,t||N(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},h.prototype.readInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},h.prototype.readBigInt64LE=te((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);const i=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),h.prototype.readBigInt64BE=te((function(e){$(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);const i=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),h.prototype.readFloatLE=function(e,t){return e>>>=0,t||N(e,4,this.length),a.read(this,e,!0,23,4)},h.prototype.readFloatBE=function(e,t){return e>>>=0,t||N(e,4,this.length),a.read(this,e,!1,23,4)},h.prototype.readDoubleLE=function(e,t){return e>>>=0,t||N(e,8,this.length),a.read(this,e,!0,52,8)},h.prototype.readDoubleBE=function(e,t){return e>>>=0,t||N(e,8,this.length),a.read(this,e,!1,52,8)},h.prototype.writeUintLE=h.prototype.writeUIntLE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){G(this,e,t,r,Math.pow(2,8*r)-1,0)}let n=1,s=0;for(this[t]=255&e;++s<r&&(n*=256);)this[t+s]=e/n&255;return t+r},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(e,t,r,i){if(e=+e,t>>>=0,r>>>=0,!i){G(this,e,t,r,Math.pow(2,8*r)-1,0)}let n=r-1,s=1;for(this[t+n]=255&e;--n>=0&&(s*=256);)this[t+n]=e/s&255;return t+r},h.prototype.writeUint8=h.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,1,255,0),this[t]=255&e,t+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeBigUInt64LE=te((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeBigUInt64BE=te((function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),h.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*r-1);G(this,e,t,r,i-1,-i)}let n=0,s=1,o=0;for(this[t]=255&e;++n<r&&(s*=256);)e<0&&0===o&&0!==this[t+n-1]&&(o=1),this[t+n]=(e/s>>0)-o&255;return t+r},h.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){const i=Math.pow(2,8*r-1);G(this,e,t,r,i-1,-i)}let n=r-1,s=1,o=0;for(this[t+n]=255&e;--n>=0&&(s*=256);)e<0&&0===o&&0!==this[t+n+1]&&(o=1),this[t+n]=(e/s>>0)-o&255;return t+r},h.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},h.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},h.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},h.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},h.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||G(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},h.prototype.writeBigInt64LE=te((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeBigInt64BE=te((function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),h.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},h.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},h.prototype.writeDoubleLE=function(e,t,r){return F(this,e,t,!0,r)},h.prototype.writeDoubleBE=function(e,t,r){return F(this,e,t,!1,r)},h.prototype.copy=function(e,t,r,i){if(!h.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);const n=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),n},h.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){const t=e.charCodeAt(0);("utf8"===i&&t<128||"latin1"===i)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let n;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{const s=h.isBuffer(e)?e:h.from(e,i),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(n=0;n<r-t;++n)this[n+t]=s[n%o]}return this};const j={};function z(e,t,r){j[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function W(e){let t="",r=e.length;const i="-"===e[0]?1:0;for(;r>=i+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function H(e,t,r,i,n,s){if(e>r||e<t){const i="bigint"==typeof t?"n":"";let n;throw n=s>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${8*(s+1)}${i}`:`>= -(2${i} ** ${8*(s+1)-1}${i}) and < 2 ** ${8*(s+1)-1}${i}`:`>= ${t}${i} and <= ${r}${i}`,new j.ERR_OUT_OF_RANGE("value",n,e)}!function(e,t,r){$(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||Y(t,e.length-(r+1))}(i,n,s)}function $(e,t){if("number"!=typeof e)throw new j.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,r){if(Math.floor(e)!==e)throw $(e,r),new j.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new j.ERR_BUFFER_OUT_OF_BOUNDS;throw new j.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}z("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),z("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),z("ERR_OUT_OF_RANGE",(function(e,t,r){let i=`The value of "${e}" is out of range.`,n=r;return Number.isInteger(r)&&Math.abs(r)>2**32?n=W(String(r)):"bigint"==typeof r&&(n=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(n=W(n)),n+="n"),i+=` It must be ${t}. Received ${n}`,i}),RangeError);const q=/[^+/0-9A-Za-z-_]/g;function X(e,t){let r;t=t||1/0;const i=e.length;let n=null;const s=[];for(let o=0;o<i;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function Z(e){return o.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(q,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function J(e,t,r,i){let n;for(n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function K(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Q(e){return e!=e}const ee=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const i=16*r;for(let n=0;n<16;++n)t[i+n]=e[r]+e[n]}return t}();function te(e){return"undefined"==typeof BigInt?re:e}function re(){throw new Error("BigInt not supported")}})),s.register("kuxul",(function(e,r){var i,n;t(e.exports,"toByteArray",(()=>i),(e=>i=e)),t(e.exports,"fromByteArray",(()=>n),(e=>n=e)),i=function(e){var t,r,i=h(e),n=i[0],s=i[1],l=new a(function(e,t,r){return 3*(t+r)/4-r}(0,n,s)),c=0,u=s>0?n-4:n;for(r=0;r<u;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;2===s&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,l[c++]=255&t);1===s&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t);return l},n=function(e){for(var t,r=e.length,i=r%3,n=[],o=16383,a=0,l=r-i;a<l;a+=o)n.push(d(e,a,a+o>l?l:a+o));1===i?(t=e[r-1],n.push(s[t>>2]+s[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],n.push(s[t>>10]+s[t>>4&63]+s[t<<2&63]+"="));return n.join("")};for(var s=[],o=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=l.length;c<u;++c)s[c]=l[c],o[l.charCodeAt(c)]=c;function h(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function d(e,t,r){for(var i,n,o=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(s[(n=i)>>18&63]+s[n>>12&63]+s[n>>6&63]+s[63&n]);return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63})),s.register("9NvM5",(function(e,r){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var i,n;t(e.exports,"read",(()=>i),(e=>i=e)),t(e.exports,"write",(()=>n),(e=>n=e)),i=function(e,t,r,i,n){var s,o,a=8*n-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=r?n-1:0,d=r?-1:1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),s-=c}return(f?-1:1)*o*Math.pow(2,s-i)},n=function(e,t,r,i,n,s){var o,a,l,c=8*s-n-1,u=(1<<c)-1,h=u>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,p=i?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*l-1)*Math.pow(2,n),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;e[r+f]=255&a,f+=p,a/=256,n-=8);for(o=o<<n|a,c+=n;c>0;e[r+f]=255&o,f+=p,o/=256,c-=8);e[r+f-p]|=128*m}})),s.register("fmRoT",(function(e,t){e.exports=s("7we3r")})),s.register("7we3r",(function(e,t){var r=s("gKvUL"),i=s("jJbMR"),n=s("ewFRw"),o=s("lk5EI");var a=function e(t){var s=new n(t),a=i(n.prototype.request,s);return r.extend(a,n.prototype,s),r.extend(a,s),a.create=function(r){return e(o(t,r))},a}(s("blSvA"));a.Axios=n,a.Cancel=s("4Tkeq"),a.CancelToken=s("lAKPy"),a.isCancel=s("7L4QX"),a.VERSION=s("35BUy").version,a.all=function(e){return Promise.all(e)},a.spread=s("JEeti"),a.isAxiosError=s("dxy9O"),e.exports=a,e.exports.default=a})),s.register("gKvUL",(function(e,t){var r=s("jJbMR"),i=Object.prototype.toString;function n(e){return Array.isArray(e)}function o(e){return void 0===e}function a(e){return"[object ArrayBuffer]"===i.call(e)}function l(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===i.call(e)}function h(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),n(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:n,isArrayBuffer:a,isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===i.call(e)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&a(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:l,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return l(e)&&u(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===i.call(e)},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:h,merge:function e(){var t={};function r(r,i){c(t[i])&&c(r)?t[i]=e(t[i],r):c(r)?t[i]=e({},r):n(r)?t[i]=r.slice():t[i]=r}for(var i=0,s=arguments.length;i<s;i++)h(arguments[i],r);return t},extend:function(e,t,i){return h(t,(function(t,n){e[n]=i&&"function"==typeof t?r(t,i):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}})),s.register("jJbMR",(function(e,t){e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}}})),s.register("ewFRw",(function(e,t){var r=s("gKvUL"),i=s("cbIsf"),n=s("83RYu"),o=s("dlZEJ"),a=s("lk5EI"),l=s("bv3QM"),c=l.validators;function u(e){this.defaults=e,this.interceptors={request:new n,response:new n}}u.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=a(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&l.assertOptions(r,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var i=[],n=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(n=n&&e.synchronous,i.unshift(e.fulfilled,e.rejected))}));var s,u=[];if(this.interceptors.response.forEach((function(e){u.push(e.fulfilled,e.rejected)})),!n){var h=[o,void 0];for(Array.prototype.unshift.apply(h,i),h=h.concat(u),s=Promise.resolve(t);h.length;)s=s.then(h.shift(),h.shift());return s}for(var d=t;i.length;){var f=i.shift(),p=i.shift();try{d=f(d)}catch(e){p(e);break}}try{s=o(d)}catch(e){return Promise.reject(e)}for(;u.length;)s=s.then(u.shift(),u.shift());return s},u.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,i){return this.request(a(i||{},{method:e,url:t,data:r}))}})),e.exports=u})),s.register("cbIsf",(function(e,t){var r=s("gKvUL");function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var o=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),o.push(i(t)+"="+i(e))})))})),s=o.join("&")}if(s){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}})),s.register("83RYu",(function(e,t){var r=s("gKvUL");function i(){this.handlers=[]}i.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i})),s.register("dlZEJ",(function(e,t){var r=s("gKvUL"),i=s("7YJ0v"),n=s("7L4QX"),o=s("blSvA"),a=s("4Tkeq");function l(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new a("canceled")}e.exports=function(e){return l(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return l(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return n(t)||(l(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}})),s.register("7YJ0v",(function(e,t){var r=s("gKvUL"),i=s("blSvA");e.exports=function(e,t,n){var s=this||i;return r.forEach(n,(function(r){e=r.call(s,e,t)})),e}})),s.register("blSvA",(function(e,t){var r=s("hPtJY"),i=s("gKvUL"),n=s("kiL6T"),o=s("8v8A7"),a=s("6YCMk"),l={"Content-Type":"application/x-www-form-urlencoded"};function c(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var u,h={transitional:a,adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==r&&"[object process]"===Object.prototype.toString.call(r))&&(u=s("at5cb")),u),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(c(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(c(t,"application/json"),function(e,t,r){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||h.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,s=!r&&"json"===this.responseType;if(s||n&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){h.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){h.headers[e]=i.merge(l)})),e.exports=h})),s.register("kiL6T",(function(e,t){var r=s("gKvUL");e.exports=function(e,t){r.forEach(e,(function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])}))}})),s.register("8v8A7",(function(e,t){e.exports=function(e,t,r,i,n){return e.config=t,r&&(e.code=r),e.request=i,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}})),s.register("6YCMk",(function(e,t){e.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}})),s.register("at5cb",(function(e,t){var r=s("gKvUL"),i=s("kk0E9"),n=s("8JRzs"),o=s("cbIsf"),a=s("7GD7a"),l=s("lDriZ"),c=s("889er"),u=s("kjF3e"),h=s("6YCMk"),d=s("4Tkeq");e.exports=function(e){return new Promise((function(t,s){var f,p=e.data,m=e.headers,g=e.responseType;function v(){e.cancelToken&&e.cancelToken.unsubscribe(f),e.signal&&e.signal.removeEventListener("abort",f)}r.isFormData(p)&&delete m["Content-Type"];var _=new XMLHttpRequest;if(e.auth){var b=e.auth.username||"",y=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(b+":"+y)}var E=a(e.baseURL,e.url);function w(){if(_){var r="getAllResponseHeaders"in _?l(_.getAllResponseHeaders()):null,n={data:g&&"text"!==g&&"json"!==g?_.response:_.responseText,status:_.status,statusText:_.statusText,headers:r,config:e,request:_};i((function(e){t(e),v()}),(function(e){s(e),v()}),n),_=null}}if(_.open(e.method.toUpperCase(),o(E,e.params,e.paramsSerializer),!0),_.timeout=e.timeout,"onloadend"in _?_.onloadend=w:_.onreadystatechange=function(){_&&4===_.readyState&&(0!==_.status||_.responseURL&&0===_.responseURL.indexOf("file:"))&&setTimeout(w)},_.onabort=function(){_&&(s(u("Request aborted",e,"ECONNABORTED",_)),_=null)},_.onerror=function(){s(u("Network Error",e,null,_)),_=null},_.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||h;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),s(u(t,e,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",_)),_=null},r.isStandardBrowserEnv()){var x=(e.withCredentials||c(E))&&e.xsrfCookieName?n.read(e.xsrfCookieName):void 0;x&&(m[e.xsrfHeaderName]=x)}"setRequestHeader"in _&&r.forEach(m,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete m[t]:_.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(_.withCredentials=!!e.withCredentials),g&&"json"!==g&&(_.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&_.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&_.upload&&_.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(f=function(e){_&&(s(!e||e&&e.type?new d("canceled"):e),_.abort(),_=null)},e.cancelToken&&e.cancelToken.subscribe(f),e.signal&&(e.signal.aborted?f():e.signal.addEventListener("abort",f))),p||(p=null),_.send(p)}))}})),s.register("kk0E9",(function(e,t){var r=s("kjF3e");e.exports=function(e,t,i){var n=i.config.validateStatus;i.status&&n&&!n(i.status)?t(r("Request failed with status code "+i.status,i.config,null,i.request,i)):e(i)}})),s.register("kjF3e",(function(e,t){var r=s("8v8A7");e.exports=function(e,t,i,n,s){var o=new Error(e);return r(o,t,i,n,s)}})),s.register("8JRzs",(function(e,t){var r=s("gKvUL");e.exports=r.isStandardBrowserEnv()?{write:function(e,t,i,n,s,o){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),r.isString(n)&&a.push("path="+n),r.isString(s)&&a.push("domain="+s),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}})),s.register("7GD7a",(function(e,t){var r=s("ckHwb"),i=s("fE4ul");e.exports=function(e,t){return e&&!r(t)?i(e,t):t}})),s.register("ckHwb",(function(e,t){e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}})),s.register("fE4ul",(function(e,t){e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}})),s.register("lDriZ",(function(e,t){var r=s("gKvUL"),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,o={};return e?(r.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(o[t]&&i.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}})),s.register("889er",(function(e,t){var r=s("gKvUL");e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function n(e){var r=e;return t&&(i.setAttribute("href",r),r=i.href),i.setAttribute("href",r),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return e=n(window.location.href),function(t){var i=r.isString(t)?n(t):t;return i.protocol===e.protocol&&i.host===e.host}}():function(){return!0}})),s.register("4Tkeq",(function(e,t){function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r})),s.register("7L4QX",(function(e,t){e.exports=function(e){return!(!e||!e.__CANCEL__)}})),s.register("lk5EI",(function(e,t){var r=s("gKvUL");e.exports=function(e,t){t=t||{};var i={};function n(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function s(i){return r.isUndefined(t[i])?r.isUndefined(e[i])?void 0:n(void 0,e[i]):n(e[i],t[i])}function o(e){if(!r.isUndefined(t[e]))return n(void 0,t[e])}function a(i){return r.isUndefined(t[i])?r.isUndefined(e[i])?void 0:n(void 0,e[i]):n(void 0,t[i])}function l(r){return r in t?n(e[r],t[r]):r in e?n(void 0,e[r]):void 0}var c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l};return r.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||s,n=t(e);r.isUndefined(n)&&t!==l||(i[e]=n)})),i}})),s.register("bv3QM",(function(e,t){var r=s("35BUy").version,i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var n={};i.transitional=function(e,t,i){function s(e,t){return"[Axios v"+r+"] Transitional option '"+e+"'"+t+(i?". "+i:"")}return function(r,i,o){if(!1===e)throw new Error(s(i," has been removed"+(t?" in "+t:"")));return t&&!n[i]&&(n[i]=!0,console.warn(s(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,i,o)}},e.exports={assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),n=i.length;n-- >0;){var s=i[n],o=t[s];if(o){var a=e[s],l=void 0===a||o(a,s,e);if(!0!==l)throw new TypeError("option "+s+" must be "+l)}else if(!0!==r)throw Error("Unknown option "+s)}},validators:i}})),s.register("35BUy",(function(e,t){e.exports={version:"0.26.1"}})),s.register("lAKPy",(function(e,t){var r=s("4Tkeq");function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var i=this;this.promise.then((function(e){if(i._listeners){var t,r=i._listeners.length;for(t=0;t<r;t++)i._listeners[t](e);i._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){i.subscribe(e),t=e})).then(e);return r.cancel=function(){i.unsubscribe(t)},r},e((function(e){i.reason||(i.reason=new r(e),t(i.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i})),s.register("JEeti",(function(e,t){e.exports=function(e){return function(t){return e.apply(null,t)}}})),s.register("dxy9O",(function(e,t){var r=s("gKvUL");e.exports=function(e){return r.isObject(e)&&!0===e.isAxiosError}})),s.register("gdqZ6",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverResponseError=e.exports.ShapeDiverRequestError=e.exports.ShapeDiverError=void 0;class r extends Error{constructor(e){super(e)}}e.exports.ShapeDiverError=r;e.exports.ShapeDiverRequestError=class extends r{constructor(e,t){super(t),this.desc=e}};e.exports.ShapeDiverResponseError=class extends r{constructor(e,t,r,i,n){super(e),this.status=t,this.error=r,this.desc=i,this.headers=n}}})),s.register("3rFH2",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BaseShapeDiverSdk=void 0;var r=s("5dzyt"),i=s("4r9gW");e.exports.BaseShapeDiverSdk=class{constructor(e){this.sdkConfig=new i.SdkConfigInternal(e),this.sdkApi=new r.ShapeDiverSdkApi(this.sdkConfig)}setConfigurationValue(e,t){this.sdkConfig.setConfigValue(e,t)}get configuration(){return this.sdkConfig.toConfig()}}})),s.register("4r9gW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SdkConfigInternal=e.exports.ShapeDiverSdkConfigType=void 0;var r,i,n=s("gdqZ6");(i=r=e.exports.ShapeDiverSdkConfigType||(e.exports.ShapeDiverSdkConfigType={})).BASE_URL="BASE_URL",i.JWT_TOKEN="JWT_TOKEN",i.REQUEST_HEADERS="REQUEST_HEADERS";class o{constructor(e){this._baseUrl=e,this._headers={},this._jwt=""}get baseUrl(){return this._baseUrl}get headers(){return this._headers}get jwt(){return this._jwt}toConfig(){return{baseUrl:this._baseUrl,headers:this._headers,jwt:this._jwt}}setConfigValue(e,t){switch(e){case r.BASE_URL:this._baseUrl=o.validateValue(e,t,"string");break;case r.JWT_TOKEN:this._jwt=o.validateValue(e,t,"string");break;case r.REQUEST_HEADERS:this._headers=o.validateValue(e,t,"string_map");break;default:throw new n.ShapeDiverError(`Invalid config-type ${e}`)}}static validateValue(e,t,r){switch(r){case"string":if("string"!=typeof t)throw new n.ShapeDiverError(`Invalid value for config-type '${e}': Value must be a string`);break;case"string_map":if("object"!=typeof t||!Object.values(t).every((e=>"string"==typeof e)))throw new n.ShapeDiverError(`Invalid value for config-type '${e}': Value must be a string-map`)}return t}}e.exports.SdkConfigInternal=o})),s.register("5YeQ1",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BaseResourceApi=void 0;e.exports.BaseResourceApi=class{constructor(e){this.commonPath="/api/v2",this.api=e}buildAnalyticsUri(){return`${this.commonPath}/analytics`}buildAuthGroupUri(){return`${this.commonPath}/auth_group`}buildTicketUri(e){return`${this.commonPath}/ticket/${e}`}buildSessionUri(e){return`${this.commonPath}/session/${e}`}buildModelUri(e){return`${this.commonPath}/model/${e}`}buildSystemUri(){return`${this.commonPath}/system`}}})),s.register("1Gbku",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverViewerValidationError=e.exports.ShapeDiverViewerArError=e.exports.ShapeDiverViewerGeneralError=e.exports.ShapeDiverViewerCameraError=e.exports.ShapeDiverViewerLightError=e.exports.ShapeDiverViewerSessionError=e.exports.ShapeDiverViewerSettingsError=e.exports.ShapeDiverViewerWebGLError=e.exports.ShapeDiverViewerEnvironmentMapError=e.exports.ShapeDiverViewerDataProcessingError=e.exports.ShapeDiverViewerUnknownError=void 0;var r=s("f03YU");class i extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.UNKNOWN,"An unknown error occurred.",e),this.message=e,this.errorObject=t,Error.captureStackTrace(this,i)}}e.exports.ShapeDiverViewerUnknownError=i;class n extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.DATA_PROCESSING_ERROR,"An error occurred while processing data.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerDataProcessingError=n;class o extends r.ShapeDiverViewerError{constructor(e,t,i){super(r.ShapeDiverViewerErrorType.ENVIRONMENT_MAP_ERROR,"An error occurred while loading the environment map.",e),this.message=e,this.url=t,this.errorObject=i}}e.exports.ShapeDiverViewerEnvironmentMapError=o;class a extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.WEBGL_ERROR,"An error occurred regarding to the WebGL context.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerWebGLError=a;class l extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.SETTINGS_ERROR,"An error occurred while loading the settings.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerSettingsError=l;class c extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.SESSION_ERROR,"An error occurred while working with the session.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerSessionError=c;class u extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.LIGHT_ERROR,"An error occurred while working with the lights.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerLightError=u;class h extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.CAMERA_ERROR,"An error occurred while working with the cameras.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerCameraError=h;class d extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.GENERAL_VIEWER_ERROR,"An error occurred while working with the viewer.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerGeneralError=d;class f extends r.ShapeDiverViewerError{constructor(e,t){super(r.ShapeDiverViewerErrorType.AR_ERROR,"An error occurred while working with AR.",e),this.message=e,this.errorObject=t}}e.exports.ShapeDiverViewerArError=f;class p extends r.ShapeDiverViewerError{constructor(e,t,i,n){super(r.ShapeDiverViewerErrorType.VALIDATION_ERROR,"An error occurred while validating the value.",e),this.message=e,this.value=t,this.requestedType=i,this.errorObject=n}}e.exports.ShapeDiverViewerValidationError=p})),s.register("f03YU",(function(e,t){var r,i;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverViewerError=e.exports.ShapeDiverError=e.exports.ShapeDiverViewerErrorType=void 0,(i=r=e.exports.ShapeDiverViewerErrorType||(e.exports.ShapeDiverViewerErrorType={})).AR_ERROR="SdARError",i.CAMERA_ERROR="SdCameraError",i.DATA_PROCESSING_ERROR="SdDataProcessingError",i.ENVIRONMENT_MAP_ERROR="SdEnvironmentMapError",i.GENERAL_VIEWER_ERROR="SdGeneralViewerError",i.LIGHT_ERROR="SdLightError",i.SESSION_ERROR="SdSessionError",i.SETTINGS_ERROR="SdSettingsError",i.VALIDATION_ERROR="SdValidationError",i.WEBGL_ERROR="SdWebGLError",i.UNKNOWN="";class n extends Error{constructor(e){super(e)}}e.exports.ShapeDiverError=n;e.exports.ShapeDiverViewerError=class extends n{constructor(e,t,i){super(i),this.error=e,this.desc=t,this.error=Object.values(r).includes(e)?e:r.UNKNOWN}}})),s.register("l1HmL",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverSdk=e.exports.create=e.exports.ShapeDiverResponseError=e.exports.ShapeDiverSdkConfigType=e.exports.ShapeDiverSdkApiResponseType=e.exports.ShapeDiverRequestError=e.exports.ShapeDiverError=void 0,i(s("kK13B"),e.exports);var n=s("eXqCS");Object.defineProperty(e.exports,"ShapeDiverError",{enumerable:!0,get:function(){return n.ShapeDiverError}}),Object.defineProperty(e.exports,"ShapeDiverRequestError",{enumerable:!0,get:function(){return n.ShapeDiverRequestError}}),Object.defineProperty(e.exports,"ShapeDiverSdkApiResponseType",{enumerable:!0,get:function(){return n.ShapeDiverSdkApiResponseType}}),Object.defineProperty(e.exports,"ShapeDiverSdkConfigType",{enumerable:!0,get:function(){return n.ShapeDiverSdkConfigType}});var o=s("6yAgv");Object.defineProperty(e.exports,"ShapeDiverResponseError",{enumerable:!0,get:function(){return o.ShapeDiverResponseError}});var a=s("d9Fcq");Object.defineProperty(e.exports,"create",{enumerable:!0,get:function(){return a.create}}),Object.defineProperty(e.exports,"ShapeDiverSdk",{enumerable:!0,get:function(){return a.ShapeDiverSdk}})})),s.register("kK13B",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&!("get"in n?!t.__esModule:n.writable||n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,i,n)}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||r(t,e,i)};Object.defineProperty(e.exports,"__esModule",{value:!0}),i(s("l8XGl"),e.exports),i(s("hCs2Z"),e.exports),i(s("gnLuw"),e.exports),i(s("9kXG8"),e.exports),i(s("pFL9q"),e.exports),i(s("f7BHI"),e.exports),i(s("9Qfs9"),e.exports),i(s("9MV9r"),e.exports),i(s("7BO09"),e.exports),i(s("jc7FF"),e.exports),i(s("fSuc5"),e.exports),i(s("4PogW"),e.exports),i(s("Nglul"),e.exports),i(s("D9wtf"),e.exports),i(s("4U8D7"),e.exports),i(s("jJSRH"),e.exports)})),s.register("l8XGl",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverCommonsTicketType=void 0,(r=e.exports.ShapeDiverCommonsTicketType||(e.exports.ShapeDiverCommonsTicketType={})).BACKEND="backend",r.NONE=""})),s.register("hCs2Z",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverRequestModelComputationQueryType=e.exports.ShapeDiverRequestModelComputationQueryStatus=e.exports.ShapeDiverRequestModelComputationQueryOrder=e.exports.ShapeDiverRequestGltfUploadQueryConversion=e.exports.ShapeDiverRequestLogMessageLevel=e.exports.ShapeDiverRequestTicketType=void 0;var r,i,n,o,a,l=s("l8XGl");e.exports.ShapeDiverRequestTicketType=Object.assign({},l.ShapeDiverCommonsTicketType),(r=e.exports.ShapeDiverRequestLogMessageLevel||(e.exports.ShapeDiverRequestLogMessageLevel={}))[r.INFO=0]="INFO",r[r.WARNING=1]="WARNING",r[r.ERROR=2]="ERROR",(i=e.exports.ShapeDiverRequestGltfUploadQueryConversion||(e.exports.ShapeDiverRequestGltfUploadQueryConversion={})).NONE="none",i.USDZ="usdz",(n=e.exports.ShapeDiverRequestModelComputationQueryOrder||(e.exports.ShapeDiverRequestModelComputationQueryOrder={})).ASC="asc",n.DESC="desc",(o=e.exports.ShapeDiverRequestModelComputationQueryStatus||(e.exports.ShapeDiverRequestModelComputationQueryStatus={})).SUCCESS="success",o.TIMEOUT="timeout",o.OTHER="other",o.ALL="*",(a=e.exports.ShapeDiverRequestModelComputationQueryType||(e.exports.ShapeDiverRequestModelComputationQueryType={})).COMPUTATION="computation",a.EXPORT="export",a.ALL="*"})),s.register("gnLuw",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("9kXG8",(function(e,t){var r,i;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverRequestModelTrustlevel=e.exports.ShapeDiverRequestModelFiletype=void 0,(r=e.exports.ShapeDiverRequestModelFiletype||(e.exports.ShapeDiverRequestModelFiletype={})).UNKNOWN="unknown",r.GRASSHOPPER_BINARY="gh",r.GRASSHOPPER_XML="ghx",(i=e.exports.ShapeDiverRequestModelTrustlevel||(e.exports.ShapeDiverRequestModelTrustlevel={})).UNDEFINED="",i.NONE="none",i.FULL="full"})),s.register("pFL9q",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverRequestSdtfUploadPartType=void 0,(e.exports.ShapeDiverRequestSdtfUploadPartType||(e.exports.ShapeDiverRequestSdtfUploadPartType={})).MODEL_SDTF="model/vnd.sdtf"})),s.register("f7BHI",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("9Qfs9",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("9MV9r",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("7BO09",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverResponseErrorType=void 0,(r=e.exports.ShapeDiverResponseErrorType||(e.exports.ShapeDiverResponseErrorType={})).ASSERTION_ERROR="SdAssertionError",r.CACHE_ERROR_GENERIC="SdCacheErrorGeneric",r.CONNECTOR_ERROR="SdConnectorError",r.DATABASE_ERROR_FILTER_INVALID="SdDatabaseErrorFilterInvalid",r.DATABASE_ERROR_GENERIC="SdDatabaseErrorGeneric",r.DATABASE_ERROR_SELECTOR_INVALID="SdDatabaseErrorSelectorInvalid",r.DATABASE_ERROR_SELECTOR_NOT_UNIQUE="SdDatabaseErrorSelectorNotUnique",r.EMAILING_ERROR="SdEmailingError",r.ERROR_ENTITY_NOT_FOUND="SdErrorEntityNotFound",r.ERROR_FORBIDDEN="SdErrorForbidden",r.ERROR_GENERIC_CLIENT="SdErrorGenericClient",r.ERROR_GENERIC_INTERNAL="SdErrorGenericInternal",r.ERROR_UNAUTHORIZED="SdErrorUnauthorized",r.ILLEGAL_ARGUMENT_ERROR="SdIllegalArgumentError",r.JWT_VALIDATION_ERROR="SdJwtValidationError",r.MODEL_VALIDATION_ERROR="SdModelValidationError",r.NOT_FOUND_ERROR="SdNotFoundError",r.PARAMETER_VALIDATION_ERROR="SdParameterValidationError",r.RATE_LIMIT_ERROR_GENERIC="SdRateLimitErrorGeneric",r.REQUEST_TIMEOUT="SdRequestTimeout",r.REQUEST_VALIDATION_ERROR="SdRequestValidationError",r.RESOURCE_GONE_ERROR="SdResourceGoneError",r.SESSION_GONE_ERROR="SdSessionGoneError",r.SESSION_VALIDATION_ERROR="SdSessionValidationError",r.STORAGE_ERROR_GENERIC="SdStorageErrorGeneric",r.TEXTURE_URL_ERROR="SdTextureUrlError",r.TICKET_VALIDATION_ERROR="SdTicketValidationError",r.TOKEN_MISSING_ERROR="SdTokenMissingError",r.TRANSFORM_CONTENT_ARRAY_ERROR="SdTransformContentArrayError",r.UNCONFIRMED_MODEL_ERROR="SdUnconfirmedModelError",r.UNKNOWN=""})),s.register("jc7FF",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverResponseExportDefinitionType=void 0,(r=e.exports.ShapeDiverResponseExportDefinitionType||(e.exports.ShapeDiverResponseExportDefinitionType={})).UNKNOWN="unknown",r.DOWNLOAD="download",r.EMAIL="email",r.SHAPEWAYS="shapeways"})),s.register("fSuc5",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("4PogW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverResponseModelCleanupProcessType=e.exports.ShapeDiverResponseTicketType=e.exports.ShapeDiverResponseParameterStructure=void 0;var r,i,n=s("l8XGl");(r=e.exports.ShapeDiverResponseParameterStructure||(e.exports.ShapeDiverResponseParameterStructure={})).ITEM="item",r.LIST="list",r.TREE="tree",e.exports.ShapeDiverResponseTicketType=Object.assign({},n.ShapeDiverCommonsTicketType),(i=e.exports.ShapeDiverResponseModelCleanupProcessType||(e.exports.ShapeDiverResponseModelCleanupProcessType={})).DELETE_EXPORT_VERSION="delete_export_version",i.DELETE_MODEL_TEXTURE="delete_model_texture",i.DELETE_OUTPUT_VERSION="delete_output_version"})),s.register("Nglul",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverResponseModelComputationStatus=void 0,(r=e.exports.ShapeDiverResponseModelComputationStatus||(e.exports.ShapeDiverResponseModelComputationStatus={})).SUCCESS="success",r.TIMEOUT="timeout",r.CHECK_CONFIRMED="checkconfirmed",r.CHECK_DENIED="checkdenied",r.CHECK_PENDING="checkpending",r.MAX_COMBINED_ASSET_SIZE_EXCEEDED="maxcombinedassetsizeexceeded",r.MAX_DB_SIZE_PER_OUTPUT_EXCEEDED="maxdbsizeperoutputexceeded",r.MAX_PARTS_PER_OUTPUT_EXCEEDED="maxpartsperoutputexceeded",r.MAX_ASSET_PARTS_PER_OUTPUT_EXCEEDED="maxassetpartsperoutputexceeded",r.MAX_TRANSFORMATIONS_PER_OUTPUT_EXCEEDED="maxtransformationsperoutputexceeded",r.MAX_PARTS_EXCEEDED="maxpartsexceeded",r.MAX_ASSET_PARTS_EXCEEDED="maxassetpartsexceeded",r.RECOVERABLE_ERROR="recoverableerror",r.UNRECOVERABLE_ERROR="unrecoverableerror",r.NO_OUTPUT_DATA_FOR_DEFAULT_PARAMETER_VALUES="nooutputdatafordefaultparametervalues",r.MODEL_WITHOUT_GEOMETRY_OUTPUT="modelwithoutgeometryoutput",r.UNKNOWN="unknown"})),s.register("D9wtf",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("4U8D7",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("jJSRH",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),s.register("6yAgv",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverResponseError=void 0;var r=s("kK13B"),i=s("eXqCS");class n extends i.ShapeDiverError{constructor(e){super(e.message),this.status=e.status,this.desc=e.desc,this.error=Object.values(r.ShapeDiverResponseErrorType).includes(e.error)?e.error:r.ShapeDiverResponseErrorType.UNKNOWN}}e.exports.ShapeDiverResponseError=n})),s.register("d9Fcq",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverSdk=e.exports.create=void 0;var r=s("eXqCS"),i=s("cwGtz"),n=s("7sYZy"),o=s("fp18M"),a=s("ewkBx"),l=s("kQzpE"),c=s("gluXg"),u=s("dpSD8"),h=s("8si7Y"),d=s("6Dowl"),f=s("Cq3Ih"),p=s("hTmdI");e.exports.create=function(e,t){return new m(e,t)};class m extends r.BaseShapeDiverSdk{constructor(e,t){super(e),t&&this.setConfigurationValue(r.ShapeDiverSdkConfigType.JWT_TOKEN,t),this._analytics=new i.ShapeDiverAnalyticsApi(this.sdkApi),this._asset=new n.ShapeDiverAssetApi(this.sdkApi),this._export=new o.ShapeDiverExportApi(this.sdkApi),this._file=new a.ShapeDiverFileApi(this.sdkApi),this._gltf=new l.ShapeDiverGltfApi(this.sdkApi),this._model=new c.ShapeDiverModelApi(this.sdkApi),this._output=new u.ShapeDiverOutputApi(this.sdkApi),this._sdtf=new h.ShapeDiverSdtfApi(this.sdkApi),this._session=new d.ShapeDiverSessionApi(this.sdkApi),this._system=new f.ShapeDiverSystemApi(this.sdkApi),this._utils=new p.ShapeDiverUtilsApi(this.sdkApi)}get analytics(){return this._analytics}get asset(){return this._asset}get export(){return this._export}get file(){return this._file}get gltf(){return this._gltf}get model(){return this._model}get output(){return this._output}get sdtf(){return this._sdtf}get session(){return this._session}get system(){return this._system}get utils(){return this._utils}}e.exports.ShapeDiverSdk=m})),s.register("cwGtz",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverAnalyticsApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}modelSessionStatistics(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.put(this.buildAnalyticsUri()+"/session/model",e)}))))}))}}e.exports.ShapeDiverAnalyticsApi=o})),s.register("9RKGz",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.sleep=e.exports.sendRequest=void 0;var i=s("eXqCS"),n=s("6yAgv");function o(e){return new Promise((t=>setTimeout(t,e)))}e.exports.sendRequest=function(e){var t;return r(this,void 0,void 0,(function*(){let r=0;for(;r<5;)try{return yield e()}catch(e){if(r++,e instanceof i.ShapeDiverResponseError){if(429===e.status){const r=null!==(t=e.headers["retry-after"])&&void 0!==t?t:60;yield o(1e3*Number(r));continue}if(502===e.status){yield o(1e3);continue}throw new n.ShapeDiverResponseError(e)}throw e}throw new i.ShapeDiverError("Could not send request: Retry-limit reached")}))},e.exports.sleep=o})),s.register("7sYZy",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverAssetApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}getExport(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/export/${t}`,{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}getOutput(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/output/${t}`,{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}getTexture(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/texture/${t}`,{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}getGltf(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/gltf/${t}`,{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}getUsdz(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/usdz/${t}`,{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}}e.exports.ShapeDiverAssetApi=o})),s.register("fp18M",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverExportApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}compute(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.put(this.buildSessionUri(e)+"/export",t)}))))}))}getCache(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.put(this.buildSessionUri(e)+"/export/cache",t)}))))}))}updateDefinitions(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.patch(this.buildModelUri(e)+"/export",t)}))))}))}}e.exports.ShapeDiverExportApi=o})),s.register("ewkBx",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverFileApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}list(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/file/${t}/list`)}))))}))}get(e,t,s){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/file/${t}/${s}`,{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}delete(e,t,i){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.delete(`${this.buildSessionUri(e)}/file/${t}/${i}`)}))))}))}requestUpload(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildSessionUri(e)+"/file/upload",t)}))))}))}}e.exports.ShapeDiverFileApi=o})),s.register("kQzpE",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverGltfApi=void 0;var i=s("kK13B"),n=s("eXqCS"),o=s("9RKGz");class a extends n.BaseResourceApi{constructor(e){super(e)}upload(e,t,s,a=i.ShapeDiverRequestGltfUploadQueryConversion.NONE){return r(this,void 0,void 0,(function*(){return yield(0,o.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(`${this.buildSessionUri(e)}/gltf?conversion=${a}`,t,{contentType:s,responseType:n.ShapeDiverSdkApiResponseType.JSON})}))))}))}}e.exports.ShapeDiverGltfApi=a})),s.register("gluXg",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverModelApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}get(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(this.buildModelUri(e))}))))}))}create(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.commonPath,e)}))))}))}update(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.put(this.buildModelUri(e),t)}))))}))}delete(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.delete(this.buildModelUri(e))}))))}))}getConfig(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(this.buildModelUri(e)+"/config")}))))}))}createConfig(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildModelUri(e)+"/config",t)}))))}))}updateConfig(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.patch(this.buildModelUri(e)+"/config",t)}))))}))}getFile(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(this.buildModelUri(e)+"/file/download",{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}setDefaultParams(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.patch(this.buildModelUri(e)+"/parameter/defval",t)}))))}))}updateParameterDefinitions(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.patch(this.buildModelUri(e)+"/parameter",t)}))))}))}queryComputations(e,t,i,s,o,a,l,c,u){return r(this,void 0,void 0,(function*(){const h=[];return void 0!==t&&h.push("timestamp_from="+t),void 0!==i&&h.push("timestamp_to="+i),void 0!==s&&h.push("limit="+s),void 0!==o&&h.push("strict_limit="+o),void 0!==a&&h.push("order="+a),void 0!==l&&h.push("status="+l),void 0!==c&&h.push("type="+c),void 0!==u&&h.push("offset="+u),yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(this.buildModelUri(e)+"/computations?"+h.join("&"))}))))}))}enqueueCleanup(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildModelUri(e)+"/cleanup?untilLastSeen="+t)}))))}))}getCleanupStatus(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(this.buildModelUri(e)+"/cleanup/status")}))))}))}}e.exports.ShapeDiverModelApi=o})),s.register("dpSD8",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverOutputApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}customize(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.put(this.buildSessionUri(e)+"/output",t)}))))}))}getCache(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.put(this.buildSessionUri(e)+"/output/cache",t)}))))}))}updateDefinitions(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.patch(this.buildModelUri(e)+"/output",t)}))))}))}}e.exports.ShapeDiverOutputApi=o})),s.register("8si7Y",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverSdtfApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}list(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/sdtf/${t}/list`)}))))}))}get(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(`${this.buildSessionUri(e)}/sdtf/${t}`,{contentType:"application/json",responseType:i.ShapeDiverSdkApiResponseType.DATA})}))))}))}delete(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.delete(`${this.buildSessionUri(e)}/sdtf/${t}`)}))))}))}requestUpload(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildSessionUri(e)+"/sdtf/upload",t)}))))}))}}e.exports.ShapeDiverSdtfApi=o})),s.register("6Dowl",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverSessionApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}ticket(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildModelUri(e)+"/ticket",t)}))))}))}init(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildTicketUri(e),t)}))))}))}default(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(this.buildSessionUri(e)+"/default")}))))}))}close(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildSessionUri(e)+"/close")}))))}))}}e.exports.ShapeDiverSessionApi=o})),s.register("Cq3Ih",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverSystemApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}log(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildSessionUri(e)+"/log/message",t)}))))}))}pruneModel(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.delete(`${this.buildSystemUri()}/model/${e}`)}))))}))}decryptTicket(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(this.buildTicketUri(e))}))))}))}authGroup(e){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.post(this.buildAuthGroupUri(),e)}))))}))}getMinionInfo(){return r(this,void 0,void 0,(function*(){return yield this.api.get(`${this.buildSystemUri()}/minions/info`)}))}}e.exports.ShapeDiverSystemApi=o})),s.register("hTmdI",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShapeDiverUtilsApi=void 0;var i=s("eXqCS"),n=s("9RKGz");class o extends i.BaseResourceApi{constructor(e){super(e)}upload(e,t,s){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.put(e,t,{contentType:s,responseType:i.ShapeDiverSdkApiResponseType.JSON,disableAuthorization:!0,disableCustomHeaders:!0})}))))}))}download(e,t){return r(this,void 0,void 0,(function*(){return yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return this.api.get(e,{contentType:"application/json",responseType:t,disableAuthorization:!0,disableCustomHeaders:!0})}))))}))}submitAndWaitForCustomization(e,t,i,s=-1){return r(this,void 0,void 0,(function*(){const a=Date.now(),l=yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return e.output.customize(t,i)})))),c=Date.now()-a;return s=s<0?s:Math.max(0,s-c),o.waitForCustomizationResult(e,t,l,s)}))}submitAndWaitForExport(e,t,i,s=-1){return r(this,void 0,void 0,(function*(){const a=Date.now(),l=yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return e.export.compute(t,i)})))),c=Date.now()-a;return s=s<0?s:Math.max(0,s-c),o.waitForExportResult(e,t,l,i.exports.id,s)}))}static waitForCustomizationResult(e,t,s,a=-1){return r(this,void 0,void 0,(function*(){if(!s.outputs)throw new i.ShapeDiverError("The given DTO does not contain any outputs");const l={};Object.keys(s.outputs).forEach((e=>l[e]=s.outputs[e].version));let c=o.getMaxOutputDelay(s);const u=Date.now();for(;c>0;){if(a>=0){const e=Date.now()-u;if(e>=a)throw new i.ShapeDiverError(`Maximum wait time of ${a} ms reached`);e+c>a&&(c=a-e)}yield(0,n.sleep)(c),s=yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return e.output.getCache(t,l)})))),c=o.getMaxOutputDelay(s)}return s}))}static waitForExportResult(e,t,s,a,l=-1){return r(this,void 0,void 0,(function*(){if(!s.exports)throw new i.ShapeDiverError("The given DTO does not contain any exports");const c={[a]:s.exports[a].version};if(!s.exports)throw new i.ShapeDiverError(`Could not find any export with the id '${a}'`);let u=o.getExportDelay(s,a);const h=Date.now();for(;u>0;){if(l>=0){const e=Date.now()-h;if(e>=l)throw new i.ShapeDiverError(`Maximum wait time of ${l} ms reached`);e+u>l&&(u=l-e)}yield(0,n.sleep)(u),s=yield(0,n.sendRequest)((()=>r(this,void 0,void 0,(function*(){return e.export.getCache(t,c)})))),u=o.getExportDelay(s,a)}return s}))}static getMaxOutputDelay(e){return Math.max(...Object.values(e.outputs).map((e=>e)).map((e=>{var t;return null!==(t=e.delay)&&void 0!==t?t:-1})))}static getExportDelay(e,t){var r;return null!==(r=e.exports[t].delay)&&void 0!==r?r:-1}}e.exports.ShapeDiverUtilsApi=o})),s.register("cFn9h",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SettingsEngine=void 0;var i=s("jUi4u");s("yoicn");var n=s("bJEmL"),o=s("crO5Z"),a=s("1Huic"),l=s("iKVTL"),c=s("1Gbku");let u=class{constructor(){this._eventEngine=n.instance.resolve(a.EventEngine),this._logger=n.instance.resolve(l.Logger),this._settings=i.DefaultsV3_1(),this._settings_version="3.1"}get ar(){return this._settings.ar}get camera(){return this._settings.camera}get environment(){return this._settings.environment}get environmentGeometry(){return this._settings.environmentGeometry}get general(){return this._settings.general}get light(){return this._settings.light}get rendering(){return this._settings.rendering}get session(){return this._settings.session}set session(e){this._settings.session=e}get settings(){return this._settings}convertToTargetVersion(){return i.convert(this._settings,this._settings_version)}flatten(){const e=t=>{const r={};for(let n in t)if(t.hasOwnProperty(n))if("object"==typeof t[n]){const s=e(t[n]);for(var i in s)s.hasOwnProperty(i)&&(r[n+"."+i]=s[i])}else r[n]=t[n];return r};return e(this.settings)}loadSettings(e,t,r=!1){if(JSON.stringify(e)===JSON.stringify({}))return this._settings_version="3.1",void(this._settings=i.DefaultsV3_1());try{return i.validate(e,"1.0"),this._settings_version="1.0",this._settings=i.convert(e,"3.1"),void this.cleanSettings(this._settings)}catch(e){}try{return i.validate(e,"2.0"),this._settings_version="2.0",this._settings=i.convert(e,"3.1"),void this.cleanSettings(this._settings)}catch(e){}try{return i.validate(e,"3.0"),this._settings_version="3.0",this._settings=i.convert(e,"3.1"),void this.cleanSettings(this._settings)}catch(e){}try{return i.validate(e,"3.1"),this._settings_version="3.1",this._settings=i.convert(e,"3.1"),void this.cleanSettings(this._settings)}catch(e){const t=new c.ShapeDiverViewerSettingsError("SettingsEngine.loadSettings: Settings could not be validated.",e);throw this._logger.handleError(l.LOGGINGTOPIC.SETTINGS,"SettingsEngine.loadSettings",t)}}reset(){this._settings_version="3.1",this._settings=i.DefaultsV3_1()}cleanSettings(e){for(let t in e.camera.cameras){const r=e.camera.cameras[t];if("perspective"===r.type){const e=r.controls.restrictions;null===e.position.cube.min.x&&(e.position.cube.min.x=-1/0),null===e.position.cube.min.y&&(e.position.cube.min.y=-1/0),null===e.position.cube.min.z&&(e.position.cube.min.z=-1/0),null===e.position.cube.max.x&&(e.position.cube.max.x=1/0),null===e.position.cube.max.y&&(e.position.cube.max.y=1/0),null===e.position.cube.max.z&&(e.position.cube.max.z=1/0),null===e.position.sphere.radius&&(e.position.sphere.radius=1/0),null===e.target.cube.min.x&&(e.target.cube.min.x=-1/0),null===e.target.cube.min.y&&(e.target.cube.min.y=-1/0),null===e.target.cube.min.z&&(e.target.cube.min.z=-1/0),null===e.target.cube.max.x&&(e.target.cube.max.x=1/0),null===e.target.cube.max.y&&(e.target.cube.max.y=1/0),null===e.target.cube.max.z&&(e.target.cube.max.z=1/0),null===e.target.sphere.radius&&(e.target.sphere.radius=1/0),null===e.rotation.minAzimuthAngle&&(e.rotation.minAzimuthAngle=-1/0),null===e.rotation.maxAzimuthAngle&&(e.rotation.maxAzimuthAngle=1/0),null===e.zoom.maxDistance&&(e.zoom.maxDistance=1/0)}}}};u=r([o.default()],u),e.exports.SettingsEngine=u})),s.register("jUi4u",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.evaluateSettingsVersion=e.exports.validate=e.exports.convert=e.exports.DefaultsV3_1=e.exports.DefaultsV3=e.exports.DefaultsV2=e.exports.DefaultsV1=void 0;var r=s("dCZSW");Object.defineProperty(e.exports,"DefaultsV1",{enumerable:!0,get:function(){return r.Defaults}});var i=s("1f8Vw"),n=s("kFbIr");Object.defineProperty(e.exports,"DefaultsV2",{enumerable:!0,get:function(){return n.Defaults}});var o=s("3QMlD"),a=s("czmsD"),l=s("jah3h");Object.defineProperty(e.exports,"DefaultsV3",{enumerable:!0,get:function(){return l.Defaults}});var c=s("jLFc9"),u=s("h0tL7"),h=s("7Moja");Object.defineProperty(e.exports,"DefaultsV3_1",{enumerable:!0,get:function(){return h.Defaults}});var d=s("kmiJL"),f=s("jZeEa");let p=[];p.push({version:"1.0",defaults:r.Defaults,convertToPrevious:e=>e,convertFromPrevious:e=>e,validate:i.validate}),p.push({version:"2.0",defaults:n.Defaults,convertToPrevious:a.convertToPrevious,convertFromPrevious:a.convertFromPrevious,validate:o.validate}),p.push({version:"3.0",defaults:l.Defaults,convertToPrevious:u.convertToPrevious,convertFromPrevious:u.convertFromPrevious,validate:c.validate}),p.push({version:"3.1",defaults:h.Defaults,convertToPrevious:f.convertToPrevious,convertFromPrevious:f.convertFromPrevious,validate:d.validate});e.exports.convert=(e,t)=>{const r=e.settings_version||"1.0";if(r===t)return e;const i=p.findIndex((e=>e.version===t)),n=p.findIndex((e=>e.version===r));if(-1===i)throw new Error("ViewerSettings.convert: Target version not available");if(-1===n)throw new Error("ViewerSettings.convert: Settings version not available");let s=e;if(i<n)for(let e=n;i<e;e--)s=p[e].convertToPrevious(s,r);else for(let e=n+1;e<=i;e++)s=p[e].convertFromPrevious(s,r);return s};e.exports.validate=(e,t)=>{const r=e.settings_version||"1.0";if(void 0!==t){const i=p.findIndex((e=>e.version===t));if(-1===i)throw new Error("ViewerSettings.validate: Target version was not found.");if(void 0!==r&&r!==t)throw new Error("ViewerSettings.validate: The settings do have a different version than the target version.");p[i].validate(e)}else{if(!r)throw new Error("ViewerSettings.validate: Settings do not have a version specified.");const t=p.findIndex((e=>e.version===r));p[t].validate(e)}};e.exports.evaluateSettingsVersion=e=>{if(!e||e.startsWith("1"))return"1.0";if(e.startsWith("2")){return+e.split(".")[1]>=18?"2.0":"1.0"}if(e.startsWith("3")){const t=e.split(".");return 1==+t[1]&&+t[2]>=12||+t[1]>1?"3.1":"3.0"}return"1.0"}})),s.register("dCZSW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Defaults=void 0;e.exports.Defaults=()=>({build_date:"",build_version:"",settings_version:"1.0",ambientOcclusion:!0,autoRotateSpeed:0,backgroundColor:"#ffffff",bumpAmplitude:1,camera:{position:{x:0,y:0,z:0},target:{x:0,y:0,z:0}},cameraAutoAdjust:!1,cameraMovementDuration:0,cameraOrtho:{position:{x:0,y:0,z:0},target:{x:0,y:0,z:0}},cameraRevertAtMouseUp:!1,clearAlpha:1,clearColor:"#ffffff",commitParameters:!1,controlDamping:.1,controlNames:{},controlOrder:[],defaultMaterialColor:"#d3d3d3",disablePan:!1,disableZoom:!1,enableAutoRotation:!1,enableRotation:!0,environmentMap:"none",environmentMapResolution:"1024",fov:45,lightScene:"default",lightScenes:null,panSpeed:.5,parametersHidden:[],pointSize:1,revertAtMouseUpDuration:800,rotateSpeed:.25,showEnvironmentMap:!1,showGrid:!1,showGroundPlane:!1,showShadows:!0,topView:!1,zoomExtentFactor:1,zoomSpeed:1})})),s.register("1f8Vw",(function(e,t){var r=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.validate=void 0;const i=r(s("kmsNQ")),n=i.default.object({id:i.default.string().optional(),name:i.default.string().optional(),type:i.default.string().optional(),properties:{color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]).optional(),direction:i.default.object({x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}).optional(),position:i.default.object({x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}).optional(),target:i.default.object({x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}).optional(),castShadow:i.default.boolean().optional(),skyColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()]).optional(),groundColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()]).optional(),intensity:i.default.number().unsafe().optional(),distance:i.default.number().unsafe().optional(),angle:i.default.number().unsafe().optional(),penumbra:i.default.number().unsafe().optional(),decay:i.default.number().unsafe().optional(),shadowMapResolution:i.default.number().unsafe().optional(),shadowMapBias:i.default.number().unsafe().optional()}}).optional(),o=i.default.object().pattern(/^/,[i.default.object({id:i.default.string(),name:i.default.string().optional(),lights:i.default.object().pattern(/^/,[n])})]),a=i.default.object({build_date:i.default.string().allow("").optional(),build_version:i.default.string().allow("").optional(),settings_version:i.default.string().optional(),ambientOcclusion:i.default.boolean().optional(),autoRotateSpeed:i.default.number().unsafe().min(0).optional(),backgroundColor:i.default.string().optional(),bumpAmplitude:i.default.number().unsafe().min(0).optional(),camera:i.default.object({position:i.default.object({x:i.default.number().unsafe().optional(),y:i.default.number().unsafe().optional(),z:i.default.number().unsafe().optional()}).optional(),target:i.default.object({x:i.default.number().unsafe().optional(),y:i.default.number().unsafe().optional(),z:i.default.number().unsafe().optional()}).optional()}).optional(),cameraAutoAdjust:i.default.boolean().optional(),cameraMovementDuration:i.default.number().unsafe().min(0).optional(),cameraOrtho:i.default.object({position:i.default.object({x:i.default.number().unsafe().optional(),y:i.default.number().unsafe().optional(),z:i.default.number().unsafe().optional()}).optional(),target:i.default.object({x:i.default.number().unsafe().optional(),y:i.default.number().unsafe().optional(),z:i.default.number().unsafe().optional()}).optional()}).optional(),cameraRevertAtMouseUp:i.default.boolean().optional(),clearAlpha:i.default.number().unsafe().min(0).max(1).optional(),clearColor:i.default.string().optional(),commitParameters:i.default.boolean().optional(),controlDamping:i.default.number().unsafe().min(0).optional(),controlNames:i.default.object().pattern(/.*/,[i.default.string()]).optional(),controlOrder:i.default.array().items(i.default.string()).optional(),defaultMaterialColor:i.default.alternatives([i.default.string(),i.default.array().items(i.default.number().unsafe())]).optional(),disablePan:i.default.boolean().optional(),disableZoom:i.default.boolean().optional(),enableAutoRotation:i.default.boolean().optional(),enableRotation:i.default.boolean().optional(),environmentMap:i.default.alternatives([i.default.string(),i.default.array().items(i.default.string())]).optional(),environmentMapResolution:i.default.string().optional(),fov:i.default.number().unsafe().positive().max(180).optional(),lightScene:i.default.string().optional(),lightScenes:o.allow(null).optional(),panSpeed:i.default.number().unsafe().min(0).optional(),parametersHidden:i.default.array().items(i.default.string()).optional(),pointSize:i.default.number().unsafe().min(0).optional(),revertAtMouseUpDuration:i.default.number().unsafe().min(0).optional(),rotateSpeed:i.default.number().unsafe().min(0).optional(),showEnvironmentMap:i.default.boolean().optional(),showGrid:i.default.boolean().optional(),showGroundPlane:i.default.boolean().optional(),showShadows:i.default.boolean().optional(),topView:i.default.boolean().optional(),zoomExtentFactor:i.default.number().unsafe().min(0).optional(),zoomSpeed:i.default.number().unsafe().min(0).optional()}).options({allowUnknown:!0});e.exports.validate=e=>{e=i.default.attempt(e,a).value}})),s.register("kmsNQ",(function(e,t){var r,i;self,e.exports=(r={1238:e=>{e.exports={version:"17.6.0"}},7629:(e,t,r)=>{const i=r(375),n=r(8571),s=r(9474),o=r(1687),a=r(8652),l=r(8160),c=r(3292),u=r(6354),h=r(8901),d=r(9708),f=r(6914),p=r(2294),m=r(6133),g=r(1152),v=r(8863),_=r(2036),b={Base:class{constructor(e){this.type=e,this.$_root=null,this._definition={},this._reset()}_reset(){this._ids=new p.Ids,this._preferences=null,this._refs=new m.Manager,this._cache=null,this._valids=null,this._invalids=null,this._flags={},this._rules=[],this._singleRules=new Map,this.$_terms={},this.$_temp={ruleset:null,whens:{}}}describe(){return i("function"==typeof d.describe,"Manifest functionality disabled"),d.describe(this)}allow(...e){return l.verifyFlat(e,"allow"),this._values(e,"_valids")}alter(e){i(e&&"object"==typeof e&&!Array.isArray(e),"Invalid targets argument"),i(!this._inRuleset(),"Cannot set alterations inside a ruleset");const t=this.clone();t.$_terms.alterations=t.$_terms.alterations||[];for(const r in e){const n=e[r];i("function"==typeof n,"Alteration adjuster for",r,"must be a function"),t.$_terms.alterations.push({target:r,adjuster:n})}return t.$_temp.ruleset=!1,t}artifact(e){return i(void 0!==e,"Artifact cannot be undefined"),i(!this._cache,"Cannot set an artifact with a rule cache"),this.$_setFlag("artifact",e)}cast(e){return i(!1===e||"string"==typeof e,"Invalid to value"),i(!1===e||this._definition.cast[e],"Type",this.type,"does not support casting to",e),this.$_setFlag("cast",!1===e?void 0:e)}default(e,t){return this._default("default",e,t)}description(e){return i(e&&"string"==typeof e,"Description must be a non-empty string"),this.$_setFlag("description",e)}empty(e){const t=this.clone();return void 0!==e&&(e=t.$_compile(e,{override:!1})),t.$_setFlag("empty",e,{clone:!1})}error(e){return i(e,"Missing error"),i(e instanceof Error||"function"==typeof e,"Must provide a valid Error object or a function"),this.$_setFlag("error",e)}example(e,t={}){return i(void 0!==e,"Missing example"),l.assertOptions(t,["override"]),this._inner("examples",e,{single:!0,override:t.override})}external(e,t){return"object"==typeof e&&(i(!t,"Cannot combine options with description"),t=e.description,e=e.method),i("function"==typeof e,"Method must be a function"),i(void 0===t||t&&"string"==typeof t,"Description must be a non-empty string"),this._inner("externals",{method:e,description:t},{single:!0})}failover(e,t){return this._default("failover",e,t)}forbidden(){return this.presence("forbidden")}id(e){return e?(i("string"==typeof e,"id must be a non-empty string"),i(/^[^\.]+$/.test(e),"id cannot contain period character"),this.$_setFlag("id",e)):this.$_setFlag("id",void 0)}invalid(...e){return this._values(e,"_invalids")}label(e){return i(e&&"string"==typeof e,"Label name must be a non-empty string"),this.$_setFlag("label",e)}meta(e){return i(void 0!==e,"Meta cannot be undefined"),this._inner("metas",e,{single:!0})}note(...e){i(e.length,"Missing notes");for(const t of e)i(t&&"string"==typeof t,"Notes must be non-empty strings");return this._inner("notes",e)}only(e=!0){return i("boolean"==typeof e,"Invalid mode:",e),this.$_setFlag("only",e)}optional(){return this.presence("optional")}prefs(e){i(e,"Missing preferences"),i(void 0===e.context,"Cannot override context"),i(void 0===e.externals,"Cannot override externals"),i(void 0===e.warnings,"Cannot override warnings"),i(void 0===e.debug,"Cannot override debug"),l.checkPreferences(e);const t=this.clone();return t._preferences=l.preferences(t._preferences,e),t}presence(e){return i(["optional","required","forbidden"].includes(e),"Unknown presence mode",e),this.$_setFlag("presence",e)}raw(e=!0){return this.$_setFlag("result",e?"raw":void 0)}result(e){return i(["raw","strip"].includes(e),"Unknown result mode",e),this.$_setFlag("result",e)}required(){return this.presence("required")}strict(e){const t=this.clone(),r=void 0!==e&&!e;return t._preferences=l.preferences(t._preferences,{convert:r}),t}strip(e=!0){return this.$_setFlag("result",e?"strip":void 0)}tag(...e){i(e.length,"Missing tags");for(const t of e)i(t&&"string"==typeof t,"Tags must be non-empty strings");return this._inner("tags",e)}unit(e){return i(e&&"string"==typeof e,"Unit name must be a non-empty string"),this.$_setFlag("unit",e)}valid(...e){l.verifyFlat(e,"valid");const t=this.allow(...e);return t.$_setFlag("only",!!t._valids,{clone:!1}),t}when(e,t){const r=this.clone();r.$_terms.whens||(r.$_terms.whens=[]);const n=c.when(r,e,t);if(!["any","link"].includes(r.type)){const e=n.is?[n]:n.switch;for(const t of e)i(!t.then||"any"===t.then.type||t.then.type===r.type,"Cannot combine",r.type,"with",t.then&&t.then.type),i(!t.otherwise||"any"===t.otherwise.type||t.otherwise.type===r.type,"Cannot combine",r.type,"with",t.otherwise&&t.otherwise.type)}return r.$_terms.whens.push(n),r.$_mutateRebuild()}cache(e){i(!this._inRuleset(),"Cannot set caching inside a ruleset"),i(!this._cache,"Cannot override schema cache"),i(void 0===this._flags.artifact,"Cannot cache a rule with an artifact");const t=this.clone();return t._cache=e||a.provider.provision(),t.$_temp.ruleset=!1,t}clone(){const e=Object.create(Object.getPrototypeOf(this));return this._assign(e)}concat(e){i(l.isSchema(e),"Invalid schema object"),i("any"===this.type||"any"===e.type||e.type===this.type,"Cannot merge type",this.type,"with another type:",e.type),i(!this._inRuleset(),"Cannot concatenate onto a schema with open ruleset"),i(!e._inRuleset(),"Cannot concatenate a schema with open ruleset");let t=this.clone();if("any"===this.type&&"any"!==e.type){const r=e.clone();for(const e of Object.keys(t))"type"!==e&&(r[e]=t[e]);t=r}t._ids.concat(e._ids),t._refs.register(e,m.toSibling),t._preferences=t._preferences?l.preferences(t._preferences,e._preferences):e._preferences,t._valids=_.merge(t._valids,e._valids,e._invalids),t._invalids=_.merge(t._invalids,e._invalids,e._valids);for(const r of e._singleRules.keys())t._singleRules.has(r)&&(t._rules=t._rules.filter((e=>e.keep||e.name!==r)),t._singleRules.delete(r));for(const r of e._rules)e._definition.rules[r.method].multi||t._singleRules.set(r.name,r),t._rules.push(r);if(t._flags.empty&&e._flags.empty){t._flags.empty=t._flags.empty.concat(e._flags.empty);const r=Object.assign({},e._flags);delete r.empty,o(t._flags,r)}else if(e._flags.empty){t._flags.empty=e._flags.empty;const r=Object.assign({},e._flags);delete r.empty,o(t._flags,r)}else o(t._flags,e._flags);for(const r in e.$_terms){const i=e.$_terms[r];i?t.$_terms[r]?t.$_terms[r]=t.$_terms[r].concat(i):t.$_terms[r]=i.slice():t.$_terms[r]||(t.$_terms[r]=i)}return this.$_root._tracer&&this.$_root._tracer._combine(t,[this,e]),t.$_mutateRebuild()}extend(e){return i(!e.base,"Cannot extend type with another base"),h.type(this,e)}extract(e){return e=Array.isArray(e)?e:e.split("."),this._ids.reach(e)}fork(e,t){i(!this._inRuleset(),"Cannot fork inside a ruleset");let r=this;for(let i of[].concat(e))i=Array.isArray(i)?i:i.split("."),r=r._ids.fork(i,t,r);return r.$_temp.ruleset=!1,r}rule(e){const t=this._definition;l.assertOptions(e,Object.keys(t.modifiers)),i(!1!==this.$_temp.ruleset,"Cannot apply rules to empty ruleset or the last rule added does not support rule properties");const r=null===this.$_temp.ruleset?this._rules.length-1:this.$_temp.ruleset;i(r>=0&&r<this._rules.length,"Cannot apply rules to empty ruleset");const s=this.clone();for(let o=r;o<s._rules.length;++o){const r=s._rules[o],a=n(r);for(const n in e)t.modifiers[n](a,e[n]),i(a.name===r.name,"Cannot change rule name");s._rules[o]=a,s._singleRules.get(a.name)===r&&s._singleRules.set(a.name,a)}return s.$_temp.ruleset=!1,s.$_mutateRebuild()}get ruleset(){i(!this._inRuleset(),"Cannot start a new ruleset without closing the previous one");const e=this.clone();return e.$_temp.ruleset=e._rules.length,e}get $(){return this.ruleset}tailor(e){e=[].concat(e),i(!this._inRuleset(),"Cannot tailor inside a ruleset");let t=this;if(this.$_terms.alterations)for(const{target:r,adjuster:n}of this.$_terms.alterations)e.includes(r)&&(t=n(t),i(l.isSchema(t),"Alteration adjuster for",r,"failed to return a schema object"));return t=t.$_modify({each:t=>t.tailor(e),ref:!1}),t.$_temp.ruleset=!1,t.$_mutateRebuild()}tracer(){return g.location?g.location(this):this}validate(e,t){return v.entry(e,this,t)}validateAsync(e,t){return v.entryAsync(e,this,t)}$_addRule(e){"string"==typeof e&&(e={name:e}),i(e&&"object"==typeof e,"Invalid options"),i(e.name&&"string"==typeof e.name,"Invalid rule name");for(const t in e)i("_"!==t[0],"Cannot set private rule properties");const t=Object.assign({},e);t._resolve=[],t.method=t.method||t.name;const r=this._definition.rules[t.method],n=t.args;i(r,"Unknown rule",t.method);const s=this.clone();if(n){i(1===Object.keys(n).length||Object.keys(n).length===this._definition.rules[t.name].args.length,"Invalid rule definition for",this.type,t.name);for(const e in n){let o=n[e];if(void 0!==o){if(r.argsByName){const a=r.argsByName.get(e);if(a.ref&&l.isResolvable(o))t._resolve.push(e),s.$_mutateRegister(o);else if(a.normalize&&(o=a.normalize(o),n[e]=o),a.assert){const t=l.validateArg(o,e,a);i(!t,t,"or reference")}}n[e]=o}else delete n[e]}}return r.multi||(s._ruleRemove(t.name,{clone:!1}),s._singleRules.set(t.name,t)),!1===s.$_temp.ruleset&&(s.$_temp.ruleset=null),r.priority?s._rules.unshift(t):s._rules.push(t),s}$_compile(e,t){return c.schema(this.$_root,e,t)}$_createError(e,t,r,i,n,s={}){const o=!1!==s.flags?this._flags:{},a=s.messages?f.merge(this._definition.messages,s.messages):this._definition.messages;return new u.Report(e,t,r,o,a,i,n)}$_getFlag(e){return this._flags[e]}$_getRule(e){return this._singleRules.get(e)}$_mapLabels(e){return e=Array.isArray(e)?e:e.split("."),this._ids.labels(e)}$_match(e,t,r,i){(r=Object.assign({},r)).abortEarly=!0,r._externals=!1,t.snapshot();const n=!v.validate(e,this,t,r,i).errors;return t.restore(),n}$_modify(e){return l.assertOptions(e,["each","once","ref","schema"]),p.schema(this,e)||this}$_mutateRebuild(){return i(!this._inRuleset(),"Cannot add this rule inside a ruleset"),this._refs.reset(),this._ids.reset(),this.$_modify({each:(e,{source:t,name:r,path:i,key:n})=>{const s=this._definition[t][r]&&this._definition[t][r].register;!1!==s&&this.$_mutateRegister(e,{family:s,key:n})}}),this._definition.rebuild&&this._definition.rebuild(this),this.$_temp.ruleset=!1,this}$_mutateRegister(e,{family:t,key:r}={}){this._refs.register(e,t),this._ids.register(e,{key:r})}$_property(e){return this._definition.properties[e]}$_reach(e){return this._ids.reach(e)}$_rootReferences(){return this._refs.roots()}$_setFlag(e,t,r={}){i("_"===e[0]||!this._inRuleset(),"Cannot set flag inside a ruleset");const n=this._definition.flags[e]||{};if(s(t,n.default)&&(t=void 0),s(t,this._flags[e]))return this;const o=!1!==r.clone?this.clone():this;return void 0!==t?(o._flags[e]=t,o.$_mutateRegister(t)):delete o._flags[e],"_"!==e[0]&&(o.$_temp.ruleset=!1),o}$_parent(e,...t){return this[e][l.symbols.parent].call(this,...t)}$_validate(e,t,r){return v.validate(e,this,t,r)}_assign(e){e.type=this.type,e.$_root=this.$_root,e.$_temp=Object.assign({},this.$_temp),e.$_temp.whens={},e._ids=this._ids.clone(),e._preferences=this._preferences,e._valids=this._valids&&this._valids.clone(),e._invalids=this._invalids&&this._invalids.clone(),e._rules=this._rules.slice(),e._singleRules=n(this._singleRules,{shallow:!0}),e._refs=this._refs.clone(),e._flags=Object.assign({},this._flags),e._cache=null,e.$_terms={};for(const t in this.$_terms)e.$_terms[t]=this.$_terms[t]?this.$_terms[t].slice():null;e.$_super={};for(const t in this.$_super)e.$_super[t]=this._super[t].bind(e);return e}_bare(){const e=this.clone();e._reset();const t=e._definition.terms;for(const r in t){const i=t[r];e.$_terms[r]=i.init}return e.$_mutateRebuild()}_default(e,t,r={}){return l.assertOptions(r,"literal"),i(void 0!==t,"Missing",e,"value"),i("function"==typeof t||!r.literal,"Only function value supports literal option"),"function"==typeof t&&r.literal&&(t={[l.symbols.literal]:!0,literal:t}),this.$_setFlag(e,t)}_generate(e,t,r){if(!this.$_terms.whens)return{schema:this};const i=[],n=[];for(let s=0;s<this.$_terms.whens.length;++s){const o=this.$_terms.whens[s];if(o.concat){i.push(o.concat),n.push("".concat(s,".concat"));continue}const a=o.ref?o.ref.resolve(e,t,r):e,l=o.is?[o]:o.switch,c=n.length;for(let c=0;c<l.length;++c){const{is:u,then:h,otherwise:d}=l[c],f="".concat(s).concat(o.switch?"."+c:"");if(u.$_match(a,t.nest(u,"".concat(f,".is")),r)){if(h){const s=t.localize([...t.path,"".concat(f,".then")],t.ancestors,t.schemas),{schema:o,id:a}=h._generate(e,s,r);i.push(o),n.push("".concat(f,".then").concat(a?"(".concat(a,")"):""));break}}else if(d){const s=t.localize([...t.path,"".concat(f,".otherwise")],t.ancestors,t.schemas),{schema:o,id:a}=d._generate(e,s,r);i.push(o),n.push("".concat(f,".otherwise").concat(a?"(".concat(a,")"):""));break}}if(o.break&&n.length>c)break}const s=n.join(", ");if(t.mainstay.tracer.debug(t,"rule","when",s),!s)return{schema:this};if(!t.mainstay.tracer.active&&this.$_temp.whens[s])return{schema:this.$_temp.whens[s],id:s};let o=this;this._definition.generate&&(o=this._definition.generate(this,e,t,r));for(const e of i)o=o.concat(e);return this.$_root._tracer&&this.$_root._tracer._combine(o,[this,...i]),this.$_temp.whens[s]=o,{schema:o,id:s}}_inner(e,t,r={}){i(!this._inRuleset(),"Cannot set ".concat(e," inside a ruleset"));const n=this.clone();return n.$_terms[e]&&!r.override||(n.$_terms[e]=[]),r.single?n.$_terms[e].push(t):n.$_terms[e].push(...t),n.$_temp.ruleset=!1,n}_inRuleset(){return null!==this.$_temp.ruleset&&!1!==this.$_temp.ruleset}_ruleRemove(e,t={}){if(!this._singleRules.has(e))return this;const r=!1!==t.clone?this.clone():this;r._singleRules.delete(e);const i=[];for(let t=0;t<r._rules.length;++t){const n=r._rules[t];n.name!==e||n.keep?i.push(n):r._inRuleset()&&t<r.$_temp.ruleset&&--r.$_temp.ruleset}return r._rules=i,r}_values(e,t){l.verifyFlat(e,t.slice(1,-1));const r=this.clone(),n=e[0]===l.symbols.override;if(n&&(e=e.slice(1)),!r[t]&&e.length?r[t]=new _:n&&(r[t]=e.length?new _:null,r.$_mutateRebuild()),!r[t])return r;n&&r[t].override();for(const n of e){i(void 0!==n,"Cannot call allow/valid/invalid with undefined"),i(n!==l.symbols.override,"Override must be the first value");const e="_invalids"===t?"_valids":"_invalids";r[e]&&(r[e].remove(n),r[e].length||(i("_valids"===t||!r._flags.only,"Setting invalid value",n,"leaves schema rejecting all values due to previous valid rule"),r[e]=null)),r[t].add(n,r._refs)}return r}}};b.Base.prototype[l.symbols.any]={version:l.version,compile:c.compile,root:"$_root"},b.Base.prototype.isImmutable=!0,b.Base.prototype.deny=b.Base.prototype.invalid,b.Base.prototype.disallow=b.Base.prototype.invalid,b.Base.prototype.equal=b.Base.prototype.valid,b.Base.prototype.exist=b.Base.prototype.required,b.Base.prototype.not=b.Base.prototype.invalid,b.Base.prototype.options=b.Base.prototype.prefs,b.Base.prototype.preferences=b.Base.prototype.prefs,e.exports=new b.Base},8652:(e,t,r)=>{const i=r(375),n=r(8571),s=r(8160),o={max:1e3,supported:new Set(["undefined","boolean","number","string"])};t.provider={provision:e=>new o.Cache(e)},o.Cache=class{constructor(e={}){s.assertOptions(e,["max"]),i(void 0===e.max||e.max&&e.max>0&&isFinite(e.max),"Invalid max cache size"),this._max=e.max||o.max,this._map=new Map,this._list=new o.List}get length(){return this._map.size}set(e,t){if(null!==e&&!o.supported.has(typeof e))return;let r=this._map.get(e);if(r)return r.value=t,void this._list.first(r);r=this._list.unshift({key:e,value:t}),this._map.set(e,r),this._compact()}get(e){const t=this._map.get(e);if(t)return this._list.first(t),n(t.value)}_compact(){if(this._map.size>this._max){const e=this._list.pop();this._map.delete(e.key)}}},o.List=class{constructor(){this.tail=null,this.head=null}unshift(e){return e.next=null,e.prev=this.head,this.head&&(this.head.next=e),this.head=e,this.tail||(this.tail=e),e}first(e){e!==this.head&&(this._remove(e),this.unshift(e))}pop(){return this._remove(this.tail)}_remove(e){const{next:t,prev:r}=e;return t.prev=r,r&&(r.next=t),e===this.tail&&(this.tail=t),e.prev=null,e.next=null,e}}},8160:(e,t,r)=>{const i=r(375),n=r(7916),s=r(1238);let o,a;const l={isoDate:/^(?:[-+]\d{2})?(?:\d{4}(?!\d{2}\b))(?:(-?)(?:(?:0[1-9]|1[0-2])(?:\1(?:[12]\d|0[1-9]|3[01]))?|W(?:[0-4]\d|5[0-2])(?:-?[1-7])?|(?:00[1-9]|0[1-9]\d|[12]\d{2}|3(?:[0-5]\d|6[1-6])))(?![T]$|[T][\d]+Z$)(?:[T\s](?:(?:(?:[01]\d|2[0-3])(?:(:?)[0-5]\d)?|24\:?00)(?:[.,]\d+(?!:))?)(?:\2[0-5]\d(?:[.,]\d+)?)?(?:[Z]|(?:[+-])(?:[01]\d|2[0-3])(?::?[0-5]\d)?)?)?)?$/};t.version=s.version,t.defaults={abortEarly:!0,allowUnknown:!1,artifacts:!1,cache:!0,context:null,convert:!0,dateFormat:"iso",errors:{escapeHtml:!1,label:"path",language:null,render:!0,stack:!1,wrap:{label:'"',array:"[]"}},externals:!0,messages:{},nonEnumerables:!1,noDefaults:!1,presence:"optional",skipFunctions:!1,stripUnknown:!1,warnings:!1},t.symbols={any:Symbol.for("@hapi/joi/schema"),arraySingle:Symbol("arraySingle"),deepDefault:Symbol("deepDefault"),errors:Symbol("errors"),literal:Symbol("literal"),override:Symbol("override"),parent:Symbol("parent"),prefs:Symbol("prefs"),ref:Symbol("ref"),template:Symbol("template"),values:Symbol("values")},t.assertOptions=function(e,t,r="Options"){i(e&&"object"==typeof e&&!Array.isArray(e),"Options must be of type object");const n=Object.keys(e).filter((e=>!t.includes(e)));i(0===n.length,"".concat(r," contain unknown keys: ").concat(n))},t.checkPreferences=function(e){a=a||r(3378);const t=a.preferences.validate(e);if(t.error)throw new n([t.error.details[0].message])},t.compare=function(e,t,r){switch(r){case"=":return e===t;case">":return e>t;case"<":return e<t;case">=":return e>=t;case"<=":return e<=t}},t.default=function(e,t){return void 0===e?t:e},t.isIsoDate=function(e){return l.isoDate.test(e)},t.isNumber=function(e){return"number"==typeof e&&!isNaN(e)},t.isResolvable=function(e){return!!e&&(e[t.symbols.ref]||e[t.symbols.template])},t.isSchema=function(e,r={}){const n=e&&e[t.symbols.any];return!!n&&(i(r.legacy||n.version===t.version,"Cannot mix different versions of joi schemas"),!0)},t.isValues=function(e){return e[t.symbols.values]},t.limit=function(e){return Number.isSafeInteger(e)&&e>=0},t.preferences=function(e,i){o=o||r(6914),e=e||{},i=i||{};const n=Object.assign({},e,i);return i.errors&&e.errors&&(n.errors=Object.assign({},e.errors,i.errors),n.errors.wrap=Object.assign({},e.errors.wrap,i.errors.wrap)),i.messages&&(n.messages=o.compile(i.messages,e.messages)),delete n[t.symbols.prefs],n},t.tryWithPath=function(e,t,r={}){try{return e()}catch(e){throw void 0!==e.path?e.path=t+"."+e.path:e.path=t,r.append&&(e.message="".concat(e.message," (").concat(e.path,")")),e}},t.validateArg=function(e,r,{assert:i,message:n}){if(t.isSchema(i)){const t=i.validate(e);if(!t.error)return;return t.error.message}if(!i(e))return r?"".concat(r," ").concat(n):n},t.verifyFlat=function(e,t){for(const r of e)i(!Array.isArray(r),"Method no longer accepts array arguments:",t)}},3292:(e,t,r)=>{const i=r(375),n=r(8160),s=r(6133),o={};t.schema=function(e,t,r={}){n.assertOptions(r,["appendPath","override"]);try{return o.schema(e,t,r)}catch(e){throw r.appendPath&&void 0!==e.path&&(e.message="".concat(e.message," (").concat(e.path,")")),e}},o.schema=function(e,t,r){i(void 0!==t,"Invalid undefined schema"),Array.isArray(t)&&(i(t.length,"Invalid empty array schema"),1===t.length&&(t=t[0]));const s=(t,...i)=>!1!==r.override?t.valid(e.override,...i):t.valid(...i);if(o.simple(t))return s(e,t);if("function"==typeof t)return e.custom(t);if(i("object"==typeof t,"Invalid schema content:",typeof t),n.isResolvable(t))return s(e,t);if(n.isSchema(t))return t;if(Array.isArray(t)){for(const r of t)if(!o.simple(r))return e.alternatives().try(...t);return s(e,...t)}return t instanceof RegExp?e.string().regex(t):t instanceof Date?s(e.date(),t):(i(Object.getPrototypeOf(t)===Object.getPrototypeOf({}),"Schema can only contain plain objects"),e.object().keys(t))},t.ref=function(e,t){return s.isRef(e)?e:s.create(e,t)},t.compile=function(e,r,s={}){n.assertOptions(s,["legacy"]);const a=r&&r[n.symbols.any];if(a)return i(s.legacy||a.version===n.version,"Cannot mix different versions of joi schemas:",a.version,n.version),r;if("object"!=typeof r||!s.legacy)return t.schema(e,r,{appendPath:!0});const l=o.walk(r);return l?l.compile(l.root,r):t.schema(e,r,{appendPath:!0})},o.walk=function(e){if("object"!=typeof e)return null;if(Array.isArray(e)){for(const t of e){const e=o.walk(t);if(e)return e}return null}const t=e[n.symbols.any];if(t)return{root:e[t.root],compile:t.compile};i(Object.getPrototypeOf(e)===Object.getPrototypeOf({}),"Schema can only contain plain objects");for(const t in e){const r=o.walk(e[t]);if(r)return r}return null},o.simple=function(e){return null===e||["boolean","string","number"].includes(typeof e)},t.when=function(e,r,a){if(void 0===a&&(i(r&&"object"==typeof r,"Missing options"),a=r,r=s.create(".")),Array.isArray(a)&&(a={switch:a}),n.assertOptions(a,["is","not","then","otherwise","switch","break"]),n.isSchema(r))return i(void 0===a.is,'"is" can not be used with a schema condition'),i(void 0===a.not,'"not" can not be used with a schema condition'),i(void 0===a.switch,'"switch" can not be used with a schema condition'),o.condition(e,{is:r,then:a.then,otherwise:a.otherwise,break:a.break});if(i(s.isRef(r)||"string"==typeof r,"Invalid condition:",r),i(void 0===a.not||void 0===a.is,'Cannot combine "is" with "not"'),void 0===a.switch){let l=a;void 0!==a.not&&(l={is:a.not,then:a.otherwise,otherwise:a.then,break:a.break});let c=void 0!==l.is?e.$_compile(l.is):e.$_root.invalid(null,!1,0,"").required();return i(void 0!==l.then||void 0!==l.otherwise,'options must have at least one of "then", "otherwise", or "switch"'),i(void 0===l.break||void 0===l.then||void 0===l.otherwise,"Cannot specify then, otherwise, and break all together"),void 0===a.is||s.isRef(a.is)||n.isSchema(a.is)||(c=c.required()),o.condition(e,{ref:t.ref(r),is:c,then:l.then,otherwise:l.otherwise,break:l.break})}i(Array.isArray(a.switch),'"switch" must be an array'),i(void 0===a.is,'Cannot combine "switch" with "is"'),i(void 0===a.not,'Cannot combine "switch" with "not"'),i(void 0===a.then,'Cannot combine "switch" with "then"');const l={ref:t.ref(r),switch:[],break:a.break};for(let t=0;t<a.switch.length;++t){const r=a.switch[t],o=t===a.switch.length-1;n.assertOptions(r,o?["is","then","otherwise"]:["is","then"]),i(void 0!==r.is,'Switch statement missing "is"'),i(void 0!==r.then,'Switch statement missing "then"');const c={is:e.$_compile(r.is),then:e.$_compile(r.then)};if(s.isRef(r.is)||n.isSchema(r.is)||(c.is=c.is.required()),o){i(void 0===a.otherwise||void 0===r.otherwise,'Cannot specify "otherwise" inside and outside a "switch"');const t=void 0!==a.otherwise?a.otherwise:r.otherwise;void 0!==t&&(i(void 0===l.break,"Cannot specify both otherwise and break"),c.otherwise=e.$_compile(t))}l.switch.push(c)}return l},o.condition=function(e,t){for(const r of["then","otherwise"])void 0===t[r]?delete t[r]:t[r]=e.$_compile(t[r]);return t}},6354:(e,t,r)=>{const i=r(5688),n=r(8160),s=r(3328);t.Report=class{constructor(e,r,i,n,s,o,a){if(this.code=e,this.flags=n,this.messages=s,this.path=o.path,this.prefs=a,this.state=o,this.value=r,this.message=null,this.template=null,this.local=i||{},this.local.label=t.label(this.flags,this.state,this.prefs,this.messages),void 0===this.value||this.local.hasOwnProperty("value")||(this.local.value=this.value),this.path.length){const e=this.path[this.path.length-1];"object"!=typeof e&&(this.local.key=e)}}_setTemplate(e){if(this.template=e,!this.flags.label&&0===this.path.length){const e=this._template(this.template,"root");e&&(this.local.label=e)}}toString(){if(this.message)return this.message;const e=this.code;if(!this.prefs.errors.render)return this.code;const t=this._template(this.template)||this._template(this.prefs.messages)||this._template(this.messages);return void 0===t?'Error code "'.concat(e,'" is not defined, your custom type is missing the correct messages definition'):(this.message=t.render(this.value,this.state,this.prefs,this.local,{errors:this.prefs.errors,messages:[this.prefs.messages,this.messages]}),this.prefs.errors.label||(this.message=this.message.replace(/^"" /,"").trim()),this.message)}_template(e,r){return t.template(this.value,e,r||this.code,this.state,this.prefs)}},t.path=function(e){let t="";for(const r of e)"object"!=typeof r&&("string"==typeof r?(t&&(t+="."),t+=r):t+="[".concat(r,"]"));return t},t.template=function(e,t,r,i,o){if(!t)return;if(s.isTemplate(t))return"root"!==r?t:null;let a=o.errors.language;if(n.isResolvable(a)&&(a=a.resolve(e,i,o)),a&&t[a]){if(void 0!==t[a][r])return t[a][r];if(void 0!==t[a]["*"])return t[a]["*"]}return t[r]?t[r]:t["*"]},t.label=function(e,r,i,n){if(e.label)return e.label;if(!i.errors.label)return"";let s=r.path;return"key"===i.errors.label&&r.path.length>1&&(s=r.path.slice(-1)),t.path(s)||t.template(null,i.messages,"root",r,i)||n&&t.template(null,n,"root",r,i)||"value"},t.process=function(e,r,i){if(!e)return null;const{override:n,message:s,details:o}=t.details(e);if(n)return n;if(i.errors.stack)return new t.ValidationError(s,o,r);const a=Error.stackTraceLimit;Error.stackTraceLimit=0;const l=new t.ValidationError(s,o,r);return Error.stackTraceLimit=a,l},t.details=function(e,t={}){let r=[];const i=[];for(const n of e){if(n instanceof Error){if(!1!==t.override)return{override:n};const e=n.toString();r.push(e),i.push({message:e,type:"override",context:{error:n}});continue}const e=n.toString();r.push(e),i.push({message:e,path:n.path.filter((e=>"object"!=typeof e)),type:n.code,context:n.local})}return r.length>1&&(r=[...new Set(r)]),{message:r.join(". "),details:i}},t.ValidationError=class extends Error{constructor(e,t,r){super(e),this._original=r,this.details=t}static isError(e){return e instanceof t.ValidationError}},t.ValidationError.prototype.isJoi=!0,t.ValidationError.prototype.name="ValidationError",t.ValidationError.prototype.annotate=i.error},8901:(e,t,r)=>{const i=r(375),n=r(8571),s=r(8160),o=r(6914),a={};t.type=function(e,t){const r=Object.getPrototypeOf(e),l=n(r),c=e._assign(Object.create(l)),u=Object.assign({},t);delete u.base,l._definition=u;const h=r._definition||{};u.messages=o.merge(h.messages,u.messages),u.properties=Object.assign({},h.properties,u.properties),c.type=u.type,u.flags=Object.assign({},h.flags,u.flags);const d=Object.assign({},h.terms);if(u.terms)for(const e in u.terms){const t=u.terms[e];i(void 0===c.$_terms[e],"Invalid term override for",u.type,e),c.$_terms[e]=t.init,d[e]=t}u.terms=d,u.args||(u.args=h.args),u.prepare=a.prepare(u.prepare,h.prepare),u.coerce&&("function"==typeof u.coerce&&(u.coerce={method:u.coerce}),u.coerce.from&&!Array.isArray(u.coerce.from)&&(u.coerce={method:u.coerce.method,from:[].concat(u.coerce.from)})),u.coerce=a.coerce(u.coerce,h.coerce),u.validate=a.validate(u.validate,h.validate);const f=Object.assign({},h.rules);if(u.rules)for(const e in u.rules){const t=u.rules[e];i("object"==typeof t,"Invalid rule definition for",u.type,e);let r=t.method;if(void 0===r&&(r=function(){return this.$_addRule(e)}),r&&(i(!l[e],"Rule conflict in",u.type,e),l[e]=r),i(!f[e],"Rule conflict in",u.type,e),f[e]=t,t.alias){const e=[].concat(t.alias);for(const r of e)l[r]=t.method}t.args&&(t.argsByName=new Map,t.args=t.args.map((e=>("string"==typeof e&&(e={name:e}),i(!t.argsByName.has(e.name),"Duplicated argument name",e.name),s.isSchema(e.assert)&&(e.assert=e.assert.strict().label(e.name)),t.argsByName.set(e.name,e),e))))}u.rules=f;const p=Object.assign({},h.modifiers);if(u.modifiers)for(const e in u.modifiers){i(!l[e],"Rule conflict in",u.type,e);const t=u.modifiers[e];i("function"==typeof t,"Invalid modifier definition for",u.type,e);const r=function(t){return this.rule({[e]:t})};l[e]=r,p[e]=t}if(u.modifiers=p,u.overrides){l._super=r,c.$_super={};for(const e in u.overrides)i(r[e],"Cannot override missing",e),u.overrides[e][s.symbols.parent]=r[e],c.$_super[e]=r[e].bind(c);Object.assign(l,u.overrides)}u.cast=Object.assign({},h.cast,u.cast);const m=Object.assign({},h.manifest,u.manifest);return m.build=a.build(u.manifest&&u.manifest.build,h.manifest&&h.manifest.build),u.manifest=m,u.rebuild=a.rebuild(u.rebuild,h.rebuild),c},a.build=function(e,t){return e&&t?function(r,i){return t(e(r,i),i)}:e||t},a.coerce=function(e,t){return e&&t?{from:e.from&&t.from?[...new Set([...e.from,...t.from])]:null,method(r,i){let n;if((!t.from||t.from.includes(typeof r))&&(n=t.method(r,i),n)){if(n.errors||void 0===n.value)return n;r=n.value}if(!e.from||e.from.includes(typeof r)){const t=e.method(r,i);if(t)return t}return n}}:e||t},a.prepare=function(e,t){return e&&t?function(r,i){const n=e(r,i);if(n){if(n.errors||void 0===n.value)return n;r=n.value}return t(r,i)||n}:e||t},a.rebuild=function(e,t){return e&&t?function(r){t(r),e(r)}:e||t},a.validate=function(e,t){return e&&t?function(r,i){const n=t(r,i);if(n){if(n.errors&&(!Array.isArray(n.errors)||n.errors.length))return n;r=n.value}return e(r,i)||n}:e||t}},5107:(e,t,r)=>{const i=r(375),n=r(8571),s=r(8652),o=r(8160),a=r(3292),l=r(6354),c=r(8901),u=r(9708),h=r(6133),d=r(3328),f=r(1152);let p;const m={types:{alternatives:r(4946),any:r(8068),array:r(546),boolean:r(4937),date:r(7500),function:r(390),link:r(8785),number:r(3832),object:r(8966),string:r(7417),symbol:r(8826)},aliases:{alt:"alternatives",bool:"boolean",func:"function"},root:function(){const e={_types:new Set(Object.keys(m.types))};for(const t of e._types)e[t]=function(...e){return i(!e.length||["alternatives","link","object"].includes(t),"The",t,"type does not allow arguments"),m.generate(this,m.types[t],e)};for(const t of["allow","custom","disallow","equal","exist","forbidden","invalid","not","only","optional","options","prefs","preferences","required","strip","valid","when"])e[t]=function(...e){return this.any()[t](...e)};Object.assign(e,m.methods);for(const t in m.aliases){const r=m.aliases[t];e[t]=e[r]}return e.x=e.expression,f.setup&&f.setup(e),e}};m.methods={ValidationError:l.ValidationError,version:o.version,cache:s.provider,assert(e,t,...r){m.assert(e,t,!0,r)},attempt:(e,t,...r)=>m.assert(e,t,!1,r),build(e){return i("function"==typeof u.build,"Manifest functionality disabled"),u.build(this,e)},checkPreferences(e){o.checkPreferences(e)},compile(e,t){return a.compile(this,e,t)},defaults(e){i("function"==typeof e,"modifier must be a function");const t=Object.assign({},this);for(const r of t._types){const n=e(t[r]());i(o.isSchema(n),"modifier must return a valid schema object"),t[r]=function(...e){return m.generate(this,n,e)}}return t},expression:(...e)=>new d(...e),extend(...e){o.verifyFlat(e,"extend"),p=p||r(3378),i(e.length,"You need to provide at least one extension"),this.assert(e,p.extensions);const t=Object.assign({},this);t._types=new Set(t._types);for(let r of e){"function"==typeof r&&(r=r(t)),this.assert(r,p.extension);const e=m.expandExtension(r,t);for(const r of e){i(void 0===t[r.type]||t._types.has(r.type),"Cannot override name",r.type);const e=r.base||this.any(),n=c.type(e,r);t._types.add(r.type),t[r.type]=function(...e){return m.generate(this,n,e)}}}return t},isError:l.ValidationError.isError,isExpression:d.isTemplate,isRef:h.isRef,isSchema:o.isSchema,in:(...e)=>h.in(...e),override:o.symbols.override,ref:(...e)=>h.create(...e),types(){const e={};for(const t of this._types)e[t]=this[t]();for(const t in m.aliases)e[t]=this[t]();return e}},m.assert=function(e,t,r,i){const s=i[0]instanceof Error||"string"==typeof i[0]?i[0]:null,a=s?i[1]:i[0],c=t.validate(e,o.preferences({errors:{stack:!0}},a||{}));let u=c.error;if(!u)return c.value;if(s instanceof Error)throw s;const h=r&&"function"==typeof u.annotate?u.annotate():u.message;throw u instanceof l.ValidationError==0&&(u=n(u)),u.message=s?"".concat(s," ").concat(h):h,u},m.generate=function(e,t,r){return i(e,"Must be invoked on a Joi instance."),t.$_root=e,t._definition.args&&r.length?t._definition.args(t,...r):t},m.expandExtension=function(e,t){if("string"==typeof e.type)return[e];const r=[];for(const i of t._types)if(e.type.test(i)){const n=Object.assign({},e);n.type=i,n.base=t[i](),r.push(n)}return r},e.exports=m.root()},6914:(e,t,r)=>{const i=r(375),n=r(8571),s=r(3328);t.compile=function(e,t){if("string"==typeof e)return i(!t,"Cannot set single message string"),new s(e);if(s.isTemplate(e))return i(!t,"Cannot set single message template"),e;i("object"==typeof e&&!Array.isArray(e),"Invalid message options"),t=t?n(t):{};for(let r in e){const n=e[r];if("root"===r||s.isTemplate(n)){t[r]=n;continue}if("string"==typeof n){t[r]=new s(n);continue}i("object"==typeof n&&!Array.isArray(n),"Invalid message for",r);const o=r;for(r in t[o]=t[o]||{},n){const e=n[r];"root"===r||s.isTemplate(e)?t[o][r]=e:(i("string"==typeof e,"Invalid message for",r,"in",o),t[o][r]=new s(e))}}return t},t.decompile=function(e){const t={};for(let r in e){const i=e[r];if("root"===r){t.root=i;continue}if(s.isTemplate(i)){t[r]=i.describe({compact:!0});continue}const n=r;for(r in t[n]={},i){const e=i[r];"root"!==r?t[n][r]=e.describe({compact:!0}):t[n].root=e}}return t},t.merge=function(e,r){if(!e)return t.compile(r);if(!r)return e;if("string"==typeof r)return new s(r);if(s.isTemplate(r))return r;const o=n(e);for(let e in r){const t=r[e];if("root"===e||s.isTemplate(t)){o[e]=t;continue}if("string"==typeof t){o[e]=new s(t);continue}i("object"==typeof t&&!Array.isArray(t),"Invalid message for",e);const n=e;for(e in o[n]=o[n]||{},t){const r=t[e];"root"===e||s.isTemplate(r)?o[n][e]=r:(i("string"==typeof r,"Invalid message for",e,"in",n),o[n][e]=new s(r))}}return o}},2294:(e,t,r)=>{function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=r(375),a=r(8160),l=r(6133),c={};t.Ids=c.Ids=class{constructor(){this._byId=new Map,this._byKey=new Map,this._schemaChain=!1}clone(){const e=new c.Ids;return e._byId=new Map(this._byId),e._byKey=new Map(this._byKey),e._schemaChain=this._schemaChain,e}concat(e){e._schemaChain&&(this._schemaChain=!0);for(const[t,r]of e._byId.entries())o(!this._byKey.has(t),"Schema id conflicts with existing key:",t),this._byId.set(t,r);for(const[t,r]of e._byKey.entries())o(!this._byId.has(t),"Schema key conflicts with existing id:",t),this._byKey.set(t,r)}fork(e,t,r){const i=this._collect(e);i.push({schema:r});const n=i.shift();let s={id:n.id,schema:t(n.schema)};o(a.isSchema(s.schema),"adjuster function failed to return a joi schema type");for(const e of i)s={id:e.id,schema:c.fork(e.schema,s.id,s.schema)};return s.schema}labels(e,t=[]){const r=e[0],i=this._get(r);if(!i)return[...t,...e].join(".");const n=e.slice(1);return t=[...t,i.schema._flags.label||r],n.length?i.schema._ids.labels(n,t):t.join(".")}reach(e,t=[]){const r=e[0],i=this._get(r);o(i,"Schema does not contain path",[...t,...e].join("."));const n=e.slice(1);return n.length?i.schema._ids.reach(n,[...t,r]):i.schema}register(e,{key:t}={}){if(!e||!a.isSchema(e))return;(e.$_property("schemaChain")||e._ids._schemaChain)&&(this._schemaChain=!0);const r=e._flags.id;if(r){const t=this._byId.get(r);o(!t||t.schema===e,"Cannot add different schemas with the same id:",r),o(!this._byKey.has(r),"Schema id conflicts with existing key:",r),this._byId.set(r,{schema:e,id:r})}t&&(o(!this._byKey.has(t),"Schema already contains key:",t),o(!this._byId.has(t),"Schema key conflicts with existing id:",t),this._byKey.set(t,{schema:e,id:t}))}reset(){this._byId=new Map,this._byKey=new Map,this._schemaChain=!1}_collect(e,t=[],r=[]){const i=e[0],n=this._get(i);o(n,"Schema does not contain path",[...t,...e].join(".")),r=[n,...r];const s=e.slice(1);return s.length?n.schema._ids._collect(s,[...t,i],r):r}_get(e){return this._byId.get(e)||this._byKey.get(e)}},c.fork=function(e,r,i){const n=t.schema(e,{each:(e,{key:t})=>{if(r===(e._flags.id||t))return i},ref:!1});return n?n.$_mutateRebuild():e},t.schema=function(e,t){let r;for(const i in e._flags){if("_"===i[0])continue;const n=c.scan(e._flags[i],{source:"flags",name:i},t);void 0!==n&&(r=r||e.clone(),r._flags[i]=n)}for(let i=0;i<e._rules.length;++i){const n=e._rules[i],s=c.scan(n.args,{source:"rules",name:n.name},t);if(void 0!==s){r=r||e.clone();const t=Object.assign({},n);t.args=s,r._rules[i]=t,r._singleRules.get(n.name)===n&&r._singleRules.set(n.name,t)}}for(const i in e.$_terms){if("_"===i[0])continue;const n=c.scan(e.$_terms[i],{source:"terms",name:i},t);void 0!==n&&(r=r||e.clone(),r.$_terms[i]=n)}return r},c.scan=function(e,t,r,i,s){const o=i||[];if(null===e||"object"!=typeof e)return;let u;if(Array.isArray(e)){for(let i=0;i<e.length;++i){const n="terms"===t.source&&"keys"===t.name&&e[i].key,s=c.scan(e[i],t,r,[i,...o],n);void 0!==s&&(u=u||e.slice(),u[i]=s)}return u}if(!1!==r.schema&&a.isSchema(e)||!1!==r.ref&&l.isRef(e)){const i=r.each(e,n(n({},t),{},{path:o,key:s}));if(i===e)return;return i}for(const i in e){if("_"===i[0])continue;const n=c.scan(e[i],t,r,[i,...o],s);void 0!==n&&(u=u||Object.assign({},e),u[i]=n)}return u}},6133:(e,t,r)=>{function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=r(375),a=r(8571),l=r(9621),c=r(8160);let u;const h={symbol:Symbol("ref"),defaults:{adjust:null,in:!1,iterables:null,map:null,separator:".",type:"value"}};t.create=function(e,t={}){o("string"==typeof e,"Invalid reference key:",e),c.assertOptions(t,["adjust","ancestor","in","iterables","map","prefix","render","separator"]),o(!t.prefix||"object"==typeof t.prefix,"options.prefix must be of type object");const r=Object.assign({},h.defaults,t);delete r.prefix;const i=r.separator,n=h.context(e,i,t.prefix);if(r.type=n.type,e=n.key,"value"===r.type)if(n.root&&(o(!i||e[0]!==i,"Cannot specify relative path with root prefix"),r.ancestor="root",e||(e=null)),i&&i===e)e=null,r.ancestor=0;else if(void 0!==r.ancestor)o(!i||!e||e[0]!==i,"Cannot combine prefix with ancestor option");else{const[t,n]=h.ancestor(e,i);n&&""===(e=e.slice(n))&&(e=null),r.ancestor=t}return r.path=i?null===e?[]:e.split(i):[e],new h.Ref(r)},t.in=function(e,r={}){return t.create(e,n(n({},r),{},{in:!0}))},t.isRef=function(e){return!!e&&!!e[c.symbols.ref]},h.Ref=class{constructor(e){o("object"==typeof e,"Invalid reference construction"),c.assertOptions(e,["adjust","ancestor","in","iterables","map","path","render","separator","type","depth","key","root","display"]),o([!1,void 0].includes(e.separator)||"string"==typeof e.separator&&1===e.separator.length,"Invalid separator"),o(!e.adjust||"function"==typeof e.adjust,"options.adjust must be a function"),o(!e.map||Array.isArray(e.map),"options.map must be an array"),o(!e.map||!e.adjust,"Cannot set both map and adjust options"),Object.assign(this,h.defaults,e),o("value"===this.type||void 0===this.ancestor,"Non-value references cannot reference ancestors"),Array.isArray(this.map)&&(this.map=new Map(this.map)),this.depth=this.path.length,this.key=this.path.length?this.path.join(this.separator):null,this.root=this.path[0],this.updateDisplay()}resolve(e,t,r,i,n={}){return o(!this.in||n.in,"Invalid in() reference usage"),"global"===this.type?this._resolve(r.context,t,n):"local"===this.type?this._resolve(i,t,n):this.ancestor?"root"===this.ancestor?this._resolve(t.ancestors[t.ancestors.length-1],t,n):(o(this.ancestor<=t.ancestors.length,"Invalid reference exceeds the schema root:",this.display),this._resolve(t.ancestors[this.ancestor-1],t,n)):this._resolve(e,t,n)}_resolve(e,t,r){let i;if("value"===this.type&&t.mainstay.shadow&&!1!==r.shadow&&(i=t.mainstay.shadow.get(this.absolute(t))),void 0===i&&(i=l(e,this.path,{iterables:this.iterables,functions:!0})),this.adjust&&(i=this.adjust(i)),this.map){const e=this.map.get(i);void 0!==e&&(i=e)}return t.mainstay&&t.mainstay.tracer.resolve(t,this,i),i}toString(){return this.display}absolute(e){return[...e.path.slice(0,-this.ancestor),...this.path]}clone(){return new h.Ref(this)}describe(){const e={path:this.path};"value"!==this.type&&(e.type=this.type),"."!==this.separator&&(e.separator=this.separator),"value"===this.type&&1!==this.ancestor&&(e.ancestor=this.ancestor),this.map&&(e.map=[...this.map]);for(const t of["adjust","iterables","render"])null!==this[t]&&void 0!==this[t]&&(e[t]=this[t]);return!1!==this.in&&(e.in=!0),{ref:e}}updateDisplay(){const e=null!==this.key?this.key:"";if("value"!==this.type)return void(this.display="ref:".concat(this.type,":").concat(e));if(!this.separator)return void(this.display="ref:".concat(e));if(!this.ancestor)return void(this.display="ref:".concat(this.separator).concat(e));if("root"===this.ancestor)return void(this.display="ref:root:".concat(e));if(1===this.ancestor)return void(this.display="ref:".concat(e||".."));const t=new Array(this.ancestor+1).fill(this.separator).join("");this.display="ref:".concat(t).concat(e||"")}},h.Ref.prototype[c.symbols.ref]=!0,t.build=function(e){return"value"===(e=Object.assign({},h.defaults,e)).type&&void 0===e.ancestor&&(e.ancestor=1),new h.Ref(e)},h.context=function(e,t,r={}){if(e=e.trim(),r){const i=void 0===r.global?"$":r.global;if(i!==t&&e.startsWith(i))return{key:e.slice(i.length),type:"global"};const n=void 0===r.local?"#":r.local;if(n!==t&&e.startsWith(n))return{key:e.slice(n.length),type:"local"};const s=void 0===r.root?"/":r.root;if(s!==t&&e.startsWith(s))return{key:e.slice(s.length),type:"value",root:!0}}return{key:e,type:"value"}},h.ancestor=function(e,t){if(!t)return[1,0];if(e[0]!==t)return[1,0];if(e[1]!==t)return[0,1];let r=2;for(;e[r]===t;)++r;return[r-1,r]},t.toSibling=0,t.toParent=1,t.Manager=class{constructor(){this.refs=[]}register(e,i){if(e)if(i=void 0===i?t.toParent:i,Array.isArray(e))for(const t of e)this.register(t,i);else if(c.isSchema(e))for(const t of e._refs.refs)t.ancestor-i>=0&&this.refs.push({ancestor:t.ancestor-i,root:t.root});else t.isRef(e)&&"value"===e.type&&e.ancestor-i>=0&&this.refs.push({ancestor:e.ancestor-i,root:e.root}),u=u||r(3328),u.isTemplate(e)&&this.register(e.refs(),i)}get length(){return this.refs.length}clone(){const e=new t.Manager;return e.refs=a(this.refs),e}reset(){this.refs=[]}roots(){return this.refs.filter((e=>!e.ancestor)).map((e=>e.root))}}},3378:(e,t,r)=>{const i=r(5107),n={};n.wrap=i.string().min(1).max(2).allow(!1),t.preferences=i.object({allowUnknown:i.boolean(),abortEarly:i.boolean(),artifacts:i.boolean(),cache:i.boolean(),context:i.object(),convert:i.boolean(),dateFormat:i.valid("date","iso","string","time","utc"),debug:i.boolean(),errors:{escapeHtml:i.boolean(),label:i.valid("path","key",!1),language:[i.string(),i.object().ref()],render:i.boolean(),stack:i.boolean(),wrap:{label:n.wrap,array:n.wrap,string:n.wrap}},externals:i.boolean(),messages:i.object(),noDefaults:i.boolean(),nonEnumerables:i.boolean(),presence:i.valid("required","optional","forbidden"),skipFunctions:i.boolean(),stripUnknown:i.object({arrays:i.boolean(),objects:i.boolean()}).or("arrays","objects").allow(!0,!1),warnings:i.boolean()}).strict(),n.nameRx=/^[a-zA-Z0-9]\w*$/,n.rule=i.object({alias:i.array().items(i.string().pattern(n.nameRx)).single(),args:i.array().items(i.string(),i.object({name:i.string().pattern(n.nameRx).required(),ref:i.boolean(),assert:i.alternatives([i.function(),i.object().schema()]).conditional("ref",{is:!0,then:i.required()}),normalize:i.function(),message:i.string().when("assert",{is:i.function(),then:i.required()})})),convert:i.boolean(),manifest:i.boolean(),method:i.function().allow(!1),multi:i.boolean(),validate:i.function()}),t.extension=i.object({type:i.alternatives([i.string(),i.object().regex()]).required(),args:i.function(),cast:i.object().pattern(n.nameRx,i.object({from:i.function().maxArity(1).required(),to:i.function().minArity(1).maxArity(2).required()})),base:i.object().schema().when("type",{is:i.object().regex(),then:i.forbidden()}),coerce:[i.function().maxArity(3),i.object({method:i.function().maxArity(3).required(),from:i.array().items(i.string()).single()})],flags:i.object().pattern(n.nameRx,i.object({setter:i.string(),default:i.any()})),manifest:{build:i.function().arity(2)},messages:[i.object(),i.string()],modifiers:i.object().pattern(n.nameRx,i.function().minArity(1).maxArity(2)),overrides:i.object().pattern(n.nameRx,i.function()),prepare:i.function().maxArity(3),rebuild:i.function().arity(1),rules:i.object().pattern(n.nameRx,n.rule),terms:i.object().pattern(n.nameRx,i.object({init:i.array().allow(null).required(),manifest:i.object().pattern(/.+/,[i.valid("schema","single"),i.object({mapped:i.object({from:i.string().required(),to:i.string().required()}).required()})])})),validate:i.function().maxArity(3)}).strict(),t.extensions=i.array().items(i.object(),i.function().arity(1)).strict(),n.desc={buffer:i.object({buffer:i.string()}),func:i.object({function:i.function().required(),options:{literal:!0}}),override:i.object({override:!0}),ref:i.object({ref:i.object({type:i.valid("value","global","local"),path:i.array().required(),separator:i.string().length(1).allow(!1),ancestor:i.number().min(0).integer().allow("root"),map:i.array().items(i.array().length(2)).min(1),adjust:i.function(),iterables:i.boolean(),in:i.boolean(),render:i.boolean()}).required()}),regex:i.object({regex:i.string().min(3)}),special:i.object({special:i.valid("deep").required()}),template:i.object({template:i.string().required(),options:i.object()}),value:i.object({value:i.alternatives([i.object(),i.array()]).required()})},n.desc.entity=i.alternatives([i.array().items(i.link("...")),i.boolean(),i.function(),i.number(),i.string(),n.desc.buffer,n.desc.func,n.desc.ref,n.desc.regex,n.desc.special,n.desc.template,n.desc.value,i.link("/")]),n.desc.values=i.array().items(null,i.boolean(),i.function(),i.number().allow(1/0,-1/0),i.string().allow(""),i.symbol(),n.desc.buffer,n.desc.func,n.desc.override,n.desc.ref,n.desc.regex,n.desc.template,n.desc.value),n.desc.messages=i.object().pattern(/.+/,[i.string(),n.desc.template,i.object().pattern(/.+/,[i.string(),n.desc.template])]),t.description=i.object({type:i.string().required(),flags:i.object({cast:i.string(),default:i.any(),description:i.string(),empty:i.link("/"),failover:n.desc.entity,id:i.string(),label:i.string(),only:!0,presence:["optional","required","forbidden"],result:["raw","strip"],strip:i.boolean(),unit:i.string()}).unknown(),preferences:{allowUnknown:i.boolean(),abortEarly:i.boolean(),artifacts:i.boolean(),cache:i.boolean(),convert:i.boolean(),dateFormat:["date","iso","string","time","utc"],errors:{escapeHtml:i.boolean(),label:["path","key"],language:[i.string(),n.desc.ref],wrap:{label:n.wrap,array:n.wrap}},externals:i.boolean(),messages:n.desc.messages,noDefaults:i.boolean(),nonEnumerables:i.boolean(),presence:["required","optional","forbidden"],skipFunctions:i.boolean(),stripUnknown:i.object({arrays:i.boolean(),objects:i.boolean()}).or("arrays","objects").allow(!0,!1),warnings:i.boolean()},allow:n.desc.values,invalid:n.desc.values,rules:i.array().min(1).items({name:i.string().required(),args:i.object().min(1),keep:i.boolean(),message:[i.string(),n.desc.messages],warn:i.boolean()}),keys:i.object().pattern(/.*/,i.link("/")),link:n.desc.ref}).pattern(/^[a-z]\w*$/,i.any())},493:(e,t,r)=>{const i=r(8571),n=r(9621),s=r(8160),o={value:Symbol("value")};e.exports=o.State=class{constructor(e,t,r){this.path=e,this.ancestors=t,this.mainstay=r.mainstay,this.schemas=r.schemas,this.debug=null}localize(e,t=null,r=null){const i=new o.State(e,t,this);return r&&i.schemas&&(i.schemas=[o.schemas(r),...i.schemas]),i}nest(e,t){const r=new o.State(this.path,this.ancestors,this);return r.schemas=r.schemas&&[o.schemas(e),...r.schemas],r.debug=t,r}shadow(e,t){this.mainstay.shadow=this.mainstay.shadow||new o.Shadow,this.mainstay.shadow.set(this.path,e,t)}snapshot(){this.mainstay.shadow&&(this._snapshot=i(this.mainstay.shadow.node(this.path)))}restore(){this.mainstay.shadow&&(this.mainstay.shadow.override(this.path,this._snapshot),this._snapshot=void 0)}},o.schemas=function(e){return s.isSchema(e)?{schema:e}:e},o.Shadow=class{constructor(){this._values=null}set(e,t,r){if(!e.length)return;if("strip"===r&&"number"==typeof e[e.length-1])return;this._values=this._values||new Map;let i=this._values;for(let t=0;t<e.length;++t){const r=e[t];let n=i.get(r);n||(n=new Map,i.set(r,n)),i=n}i[o.value]=t}get(e){const t=this.node(e);if(t)return t[o.value]}node(e){if(this._values)return n(this._values,e,{iterables:!0})}override(e,t){if(!this._values)return;const r=e.slice(0,-1),i=e[e.length-1],s=n(this._values,r,{iterables:!0});t?s.set(i,t):s&&s.delete(i)}}},3328:(e,t,r)=>{function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=r(375),a=r(8571),l=r(5277),c=r(1447),u=r(8160),h=r(6354),d=r(6133),f={symbol:Symbol("template"),opens:new Array(1e3).join("\0"),closes:new Array(1e3).join(""),dateFormat:{date:Date.prototype.toDateString,iso:Date.prototype.toISOString,string:Date.prototype.toString,time:Date.prototype.toTimeString,utc:Date.prototype.toUTCString}};e.exports=f.Template=class{constructor(e,t){o("string"==typeof e,"Template source must be a string"),o(!e.includes("\0")&&!e.includes(""),"Template source cannot contain reserved control characters"),this.source=e,this.rendered=e,this._template=null,this._settings=a(t),this._parse()}_parse(){if(!this.source.includes("{"))return;const e=f.encode(this.source),t=f.split(e);let r=!1;const i=[],n=t.shift();n&&i.push(n);for(const e of t){const t="{"!==e[0],n=t?"}":"}}",s=e.indexOf(n);if(-1===s||"{"===e[1]){i.push("{".concat(f.decode(e)));continue}let o=e.slice(t?0:1,s);const a=":"===o[0];a&&(o=o.slice(1));const l=this._ref(f.decode(o),{raw:t,wrapped:a});i.push(l),"string"!=typeof l&&(r=!0);const c=e.slice(s+n.length);c&&i.push(f.decode(c))}r?this._template=i:this.rendered=i.join("")}static date(e,t){return f.dateFormat[t.dateFormat].call(e)}describe(e={}){if(!this._settings&&e.compact)return this.source;const t={template:this.source};return this._settings&&(t.options=this._settings),t}static build(e){return new f.Template(e.template,e.options)}isDynamic(){return!!this._template}static isTemplate(e){return!!e&&!!e[u.symbols.template]}refs(){if(!this._template)return;const e=[];for(const t of this._template)"string"!=typeof t&&e.push(...t.refs);return e}resolve(e,t,r,i){return this._template&&1===this._template.length?this._part(this._template[0],e,t,r,i,{}):this.render(e,t,r,i)}_part(e,...t){return e.ref?e.ref.resolve(...t):e.formula.evaluate(t)}render(e,t,r,i,n={}){if(!this.isDynamic())return this.rendered;const s=[];for(const o of this._template)if("string"==typeof o)s.push(o);else{const a=this._part(o,e,t,r,i,n),c=f.stringify(a,e,t,r,i,n);if(void 0!==c){const e=o.raw||!1===(n.errors&&n.errors.escapeHtml)?c:l(c);s.push(f.wrap(e,o.wrapped&&r.errors.wrap.label))}}return s.join("")}_ref(e,{raw:t,wrapped:r}){const i=[],n=e=>{const t=d.create(e,this._settings);return i.push(t),e=>t.resolve(...e)};try{var s=new c.Parser(e,{reference:n,functions:f.functions,constants:f.constants})}catch(t){throw t.message='Invalid template variable "'.concat(e,'" fails due to: ').concat(t.message),t}if(s.single){if("reference"===s.single.type){const e=i[0];return{ref:e,raw:t,refs:i,wrapped:r||"local"===e.type&&"label"===e.key}}return f.stringify(s.single.value)}return{formula:s,raw:t,refs:i}}toString(){return this.source}},f.Template.prototype[u.symbols.template]=!0,f.Template.prototype.isImmutable=!0,f.encode=function(e){return e.replace(/\\(\{+)/g,((e,t)=>f.opens.slice(0,t.length))).replace(/\\(\}+)/g,((e,t)=>f.closes.slice(0,t.length)))},f.decode=function(e){return e.replace(/\u0000/g,"{").replace(/\u0001/g,"}")},f.split=function(e){const t=[];let r="";for(let i=0;i<e.length;++i){const n=e[i];if("{"===n){let n="";for(;i+1<e.length&&"{"===e[i+1];)n+="{",++i;t.push(r),r=n}else r+=n}return t.push(r),t},f.wrap=function(e,t){return t?1===t.length?"".concat(t).concat(e).concat(t):"".concat(t[0]).concat(e).concat(t[1]):e},f.stringify=function(e,t,r,i,s,o={}){const a=typeof e,l=i&&i.errors&&i.errors.wrap||{};let c=!1;if(d.isRef(e)&&e.render&&(c=e.in,e=e.resolve(t,r,i,s,n({in:e.in},o))),null===e)return"null";if("string"===a)return f.wrap(e,o.arrayItems&&l.string);if("number"===a||"function"===a||"symbol"===a)return e.toString();if("object"!==a)return JSON.stringify(e);if(e instanceof Date)return f.Template.date(e,i);if(e instanceof Map){const t=[];for(const[r,i]of e.entries())t.push("".concat(r.toString()," -> ").concat(i.toString()));e=t}if(!Array.isArray(e))return e.toString();const u=[];for(const a of e)u.push(f.stringify(a,t,r,i,s,n({arrayItems:!0},o)));return f.wrap(u.join(", "),!c&&l.array)},f.constants={true:!0,false:!1,null:null,second:1e3,minute:6e4,hour:36e5,day:864e5},f.functions={if:(e,t,r)=>e?t:r,length:e=>"string"==typeof e?e.length:e&&"object"==typeof e?Array.isArray(e)?e.length:Object.keys(e).length:null,msg(e){const[t,r,i,n,s]=this,o=s.messages;if(!o)return"";const a=h.template(t,o[0],e,r,i)||h.template(t,o[1],e,r,i);return a?a.render(t,r,i,n,s):""},number:e=>"number"==typeof e?e:"string"==typeof e?parseFloat(e):"boolean"==typeof e?e?1:0:e instanceof Date?e.getTime():null}},4946:(e,t,r)=>{const i=r(375),n=r(1687),s=r(8068),o=r(8160),a=r(3292),l=r(6354),c=r(6133),u={};e.exports=s.extend({type:"alternatives",flags:{match:{default:"any"}},terms:{matches:{init:[],register:c.toSibling}},args:(e,...t)=>1===t.length&&Array.isArray(t[0])?e.try(...t[0]):e.try(...t),validate(e,t){const{schema:r,error:i,state:s,prefs:o}=t;if(r._flags.match){const t=[],a=[];for(let i=0;i<r.$_terms.matches.length;++i){const n=r.$_terms.matches[i],l=s.nest(n.schema,"match.".concat(i));l.snapshot();const c=n.schema.$_validate(e,l,o);c.errors?(a.push(c.errors),l.restore()):t.push(c.value)}if(0===t.length)return{errors:i("alternatives.any",{details:a.map((e=>l.details(e,{override:!1})))})};if("one"===r._flags.match)return 1===t.length?{value:t[0]}:{errors:i("alternatives.one")};if(t.length!==r.$_terms.matches.length)return{errors:i("alternatives.all",{details:a.map((e=>l.details(e,{override:!1})))})};const c=e=>e.$_terms.matches.some((e=>"object"===e.schema.type||"alternatives"===e.schema.type&&c(e.schema)));return c(r)?{value:t.reduce(((e,t)=>n(e,t,{mergeArrays:!1})))}:{value:t[t.length-1]}}const a=[];for(let t=0;t<r.$_terms.matches.length;++t){const i=r.$_terms.matches[t];if(i.schema){const r=s.nest(i.schema,"match.".concat(t));r.snapshot();const n=i.schema.$_validate(e,r,o);if(!n.errors)return n;r.restore(),a.push({schema:i.schema,reports:n.errors});continue}const n=i.ref?i.ref.resolve(e,s,o):e,l=i.is?[i]:i.switch;for(let r=0;r<l.length;++r){const a=l[r],{is:c,then:u,otherwise:h}=a,d="match.".concat(t).concat(i.switch?"."+r:"");if(c.$_match(n,s.nest(c,"".concat(d,".is")),o)){if(u)return u.$_validate(e,s.nest(u,"".concat(d,".then")),o)}else if(h)return h.$_validate(e,s.nest(h,"".concat(d,".otherwise")),o)}}return u.errors(a,t)},rules:{conditional:{method(e,t){i(!this._flags._endedSwitch,"Unreachable condition"),i(!this._flags.match,"Cannot combine match mode",this._flags.match,"with conditional rule"),i(void 0===t.break,"Cannot use break option with alternatives conditional");const r=this.clone(),n=a.when(r,e,t),s=n.is?[n]:n.switch;for(const e of s)if(e.then&&e.otherwise){r.$_setFlag("_endedSwitch",!0,{clone:!1});break}return r.$_terms.matches.push(n),r.$_mutateRebuild()}},match:{method(e){if(i(["any","one","all"].includes(e),"Invalid alternatives match mode",e),"any"!==e)for(const t of this.$_terms.matches)i(t.schema,"Cannot combine match mode",e,"with conditional rules");return this.$_setFlag("match",e)}},try:{method(...e){i(e.length,"Missing alternative schemas"),o.verifyFlat(e,"try"),i(!this._flags._endedSwitch,"Unreachable condition");const t=this.clone();for(const r of e)t.$_terms.matches.push({schema:t.$_compile(r)});return t.$_mutateRebuild()}}},overrides:{label(e){return this.$_parent("label",e).$_modify({each:(t,r)=>"is"!==r.path[0]?t.label(e):void 0,ref:!1})}},rebuild(e){e.$_modify({each:t=>{o.isSchema(t)&&"array"===t.type&&e.$_setFlag("_arrayItems",!0,{clone:!1})}})},manifest:{build(e,t){if(t.matches)for(const r of t.matches){const{schema:t,ref:i,is:n,not:s,then:o,otherwise:a}=r;e=t?e.try(t):i?e.conditional(i,{is:n,then:o,not:s,otherwise:a,switch:r.switch}):e.conditional(n,{then:o,otherwise:a})}return e}},messages:{"alternatives.all":"{{#label}} does not match all of the required types","alternatives.any":"{{#label}} does not match any of the allowed types","alternatives.match":"{{#label}} does not match any of the allowed types","alternatives.one":"{{#label}} matches more than one allowed type","alternatives.types":"{{#label}} must be one of {{#types}}"}}),u.errors=function(e,{error:t,state:r}){if(!e.length)return{errors:t("alternatives.any")};if(1===e.length)return{errors:e[0].reports};const i=new Set,n=[];for(const{reports:s,schema:o}of e){if(s.length>1)return u.unmatched(e,t);const a=s[0];if(a instanceof l.Report==0)return u.unmatched(e,t);if(a.state.path.length!==r.path.length){n.push({type:o.type,report:a});continue}if("any.only"===a.code){for(const e of a.local.valids)i.add(e);continue}const[c,h]=a.code.split(".");"base"===h?i.add(c):n.push({type:o.type,report:a})}return n.length?1===n.length?{errors:n[0].report}:u.unmatched(e,t):{errors:t("alternatives.types",{types:[...i]})}},u.unmatched=function(e,t){const r=[];for(const t of e)r.push(...t.reports);return{errors:t("alternatives.match",l.details(r,{override:!1}))}}},8068:(e,t,r)=>{const i=r(375),n=r(7629),s=r(8160),o=r(6914);e.exports=n.extend({type:"any",flags:{only:{default:!1}},terms:{alterations:{init:null},examples:{init:null},externals:{init:null},metas:{init:[]},notes:{init:[]},shared:{init:null},tags:{init:[]},whens:{init:null}},rules:{custom:{method(e,t){return i("function"==typeof e,"Method must be a function"),i(void 0===t||t&&"string"==typeof t,"Description must be a non-empty string"),this.$_addRule({name:"custom",args:{method:e,description:t}})},validate(e,t,{method:r}){try{return r(e,t)}catch(e){return t.error("any.custom",{error:e})}},args:["method","description"],multi:!0},messages:{method(e){return this.prefs({messages:e})}},shared:{method(e){i(s.isSchema(e)&&e._flags.id,"Schema must be a schema with an id");const t=this.clone();return t.$_terms.shared=t.$_terms.shared||[],t.$_terms.shared.push(e),t.$_mutateRegister(e),t}},warning:{method(e,t){return i(e&&"string"==typeof e,"Invalid warning code"),this.$_addRule({name:"warning",args:{code:e,local:t},warn:!0})},validate:(e,t,{code:r,local:i})=>t.error(r,i),args:["code","local"],multi:!0}},modifiers:{keep(e,t=!0){e.keep=t},message(e,t){e.message=o.compile(t)},warn(e,t=!0){e.warn=t}},manifest:{build(e,t){for(const r in t){const i=t[r];if(["examples","externals","metas","notes","tags"].includes(r))for(const t of i)e=e[r.slice(0,-1)](t);else if("alterations"!==r)if("whens"!==r){if("shared"===r)for(const t of i)e=e.shared(t)}else for(const t of i){const{ref:r,is:i,not:n,then:s,otherwise:o,concat:a}=t;e=a?e.concat(a):r?e.when(r,{is:i,not:n,then:s,otherwise:o,switch:t.switch,break:t.break}):e.when(i,{then:s,otherwise:o,break:t.break})}else{const t={};for(const{target:e,adjuster:r}of i)t[e]=r;e=e.alter(t)}}return e}},messages:{"any.custom":"{{#label}} failed custom validation because {{#error.message}}","any.default":"{{#label}} threw an error when running default method","any.failover":"{{#label}} threw an error when running failover method","any.invalid":"{{#label}} contains an invalid value","any.only":'{{#label}} must be {if(#valids.length == 1, "", "one of ")}{{#valids}}',"any.ref":"{{#label}} {{#arg}} references {{:#ref}} which {{#reason}}","any.required":"{{#label}} is required","any.unknown":"{{#label}} is not allowed"}})},546:(e,t,r)=>{const i=r(375),n=r(9474),s=r(9621),o=r(8068),a=r(8160),l=r(3292),c={};e.exports=o.extend({type:"array",flags:{single:{default:!1},sparse:{default:!1}},terms:{items:{init:[],manifest:"schema"},ordered:{init:[],manifest:"schema"},_exclusions:{init:[]},_inclusions:{init:[]},_requireds:{init:[]}},coerce:{from:"object",method(e,{schema:t,state:r,prefs:i}){if(!Array.isArray(e))return;const n=t.$_getRule("sort");return n?c.sort(t,e,n.args.options,r,i):void 0}},validate(e,{schema:t,error:r}){if(!Array.isArray(e)){if(t._flags.single){const t=[e];return t[a.symbols.arraySingle]=!0,{value:t}}return{errors:r("array.base")}}if(t.$_getRule("items")||t.$_terms.externals)return{value:e.slice()}},rules:{has:{method(e){e=this.$_compile(e,{appendPath:!0});const t=this.$_addRule({name:"has",args:{schema:e}});return t.$_mutateRegister(e),t},validate(e,{state:t,prefs:r,error:i},{schema:n}){const s=[e,...t.ancestors];for(let i=0;i<e.length;++i){const o=t.localize([...t.path,i],s,n);if(n.$_match(e[i],o,r))return e}const o=n._flags.label;return o?i("array.hasKnown",{patternLabel:o}):i("array.hasUnknown",null)},multi:!0},items:{method(...e){a.verifyFlat(e,"items");const t=this.$_addRule("items");for(let r=0;r<e.length;++r){const i=a.tryWithPath((()=>this.$_compile(e[r])),r,{append:!0});t.$_terms.items.push(i)}return t.$_mutateRebuild()},validate(e,{schema:t,error:r,state:i,prefs:n,errorsArray:s}){const o=t.$_terms._requireds.slice(),l=t.$_terms.ordered.slice(),u=[...t.$_terms._inclusions,...o],h=!e[a.symbols.arraySingle];delete e[a.symbols.arraySingle];const d=s();let f=e.length;for(let s=0;s<f;++s){const a=e[s];let p=!1,m=!1;const g=h?s:new Number(s),v=[...i.path,g];if(!t._flags.sparse&&void 0===a){if(d.push(r("array.sparse",{key:g,path:v,pos:s,value:void 0},i.localize(v))),n.abortEarly)return d;l.shift();continue}const _=[e,...i.ancestors];for(const e of t.$_terms._exclusions)if(e.$_match(a,i.localize(v,_,e),n,{presence:"ignore"})){if(d.push(r("array.excludes",{pos:s,value:a},i.localize(v))),n.abortEarly)return d;p=!0,l.shift();break}if(p)continue;if(t.$_terms.ordered.length){if(l.length){const o=l.shift(),u=o.$_validate(a,i.localize(v,_,o),n);if(u.errors){if(d.push(...u.errors),n.abortEarly)return d}else if("strip"===o._flags.result)c.fastSplice(e,s),--s,--f;else{if(!t._flags.sparse&&void 0===u.value){if(d.push(r("array.sparse",{key:g,path:v,pos:s,value:void 0},i.localize(v))),n.abortEarly)return d;continue}e[s]=u.value}continue}if(!t.$_terms.items.length){if(d.push(r("array.orderedLength",{pos:s,limit:t.$_terms.ordered.length})),n.abortEarly)return d;break}}const b=[];let y=o.length;for(let l=0;l<y;++l){const u=i.localize(v,_,o[l]);u.snapshot();const h=o[l].$_validate(a,u,n);if(b[l]=h,!h.errors){if(e[s]=h.value,m=!0,c.fastSplice(o,l),--l,--y,!t._flags.sparse&&void 0===h.value&&(d.push(r("array.sparse",{key:g,path:v,pos:s,value:void 0},i.localize(v))),n.abortEarly))return d;break}u.restore()}if(m)continue;const E=n.stripUnknown&&!!n.stripUnknown.arrays||!1;y=u.length;for(const l of u){let u;const h=o.indexOf(l);if(-1!==h)u=b[h];else{const o=i.localize(v,_,l);if(o.snapshot(),u=l.$_validate(a,o,n),!u.errors){"strip"===l._flags.result?(c.fastSplice(e,s),--s,--f):t._flags.sparse||void 0!==u.value?e[s]=u.value:(d.push(r("array.sparse",{key:g,path:v,pos:s,value:void 0},i.localize(v))),p=!0),m=!0;break}o.restore()}if(1===y){if(E){c.fastSplice(e,s),--s,--f,m=!0;break}if(d.push(...u.errors),n.abortEarly)return d;p=!0;break}}if(!p&&(t.$_terms._inclusions.length||t.$_terms._requireds.length)&&!m){if(E){c.fastSplice(e,s),--s,--f;continue}if(d.push(r("array.includes",{pos:s,value:a},i.localize(v))),n.abortEarly)return d}}return o.length&&c.fillMissedErrors(t,d,o,e,i,n),l.length&&(c.fillOrderedErrors(t,d,l,e,i,n),d.length||c.fillDefault(l,e,i,n)),d.length?d:e},priority:!0,manifest:!1},length:{method(e){return this.$_addRule({name:"length",args:{limit:e},operator:"="})},validate:(e,t,{limit:r},{name:i,operator:n,args:s})=>a.compare(e.length,r,n)?e:t.error("array."+i,{limit:s.limit,value:e}),args:[{name:"limit",ref:!0,assert:a.limit,message:"must be a positive integer"}]},max:{method(e){return this.$_addRule({name:"max",method:"length",args:{limit:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"length",args:{limit:e},operator:">="})}},ordered:{method(...e){a.verifyFlat(e,"ordered");const t=this.$_addRule("items");for(let r=0;r<e.length;++r){const i=a.tryWithPath((()=>this.$_compile(e[r])),r,{append:!0});c.validateSingle(i,t),t.$_mutateRegister(i),t.$_terms.ordered.push(i)}return t.$_mutateRebuild()}},single:{method(e){const t=void 0===e||!!e;return i(!t||!this._flags._arrayItems,"Cannot specify single rule when array has array items"),this.$_setFlag("single",t)}},sort:{method(e={}){a.assertOptions(e,["by","order"]);const t={order:e.order||"ascending"};return e.by&&(t.by=l.ref(e.by,{ancestor:0}),i(!t.by.ancestor,"Cannot sort by ancestor")),this.$_addRule({name:"sort",args:{options:t}})},validate(e,{error:t,state:r,prefs:i,schema:n},{options:s}){const{value:o,errors:a}=c.sort(n,e,s,r,i);if(a)return a;for(let r=0;r<e.length;++r)if(e[r]!==o[r])return t("array.sort",{order:s.order,by:s.by?s.by.key:"value"});return e},convert:!0},sparse:{method(e){const t=void 0===e||!!e;return this._flags.sparse===t?this:(t?this.clone():this.$_addRule("items")).$_setFlag("sparse",t,{clone:!1})}},unique:{method(e,t={}){i(!e||"function"==typeof e||"string"==typeof e,"comparator must be a function or a string"),a.assertOptions(t,["ignoreUndefined","separator"]);const r={name:"unique",args:{options:t,comparator:e}};if(e)if("string"==typeof e){const i=a.default(t.separator,".");r.path=i?e.split(i):[e]}else r.comparator=e;return this.$_addRule(r)},validate(e,{state:t,error:r,schema:o},{comparator:a,options:l},{comparator:c,path:u}){const h={string:Object.create(null),number:Object.create(null),undefined:Object.create(null),boolean:Object.create(null),object:new Map,function:new Map,custom:new Map},d=c||n,f=l.ignoreUndefined;for(let n=0;n<e.length;++n){const o=u?s(e[n],u):e[n],l=c?h.custom:h[typeof o];if(i(l,"Failed to find unique map container for type",typeof o),l instanceof Map){const i=l.entries();let s;for(;!(s=i.next()).done;)if(d(s.value[0],o)){const i=t.localize([...t.path,n],[e,...t.ancestors]),o={pos:n,value:e[n],dupePos:s.value[1],dupeValue:e[s.value[1]]};return u&&(o.path=a),r("array.unique",o,i)}l.set(o,n)}else{if((!f||void 0!==o)&&void 0!==l[o]){const i={pos:n,value:e[n],dupePos:l[o],dupeValue:e[l[o]]};return u&&(i.path=a),r("array.unique",i,t.localize([...t.path,n],[e,...t.ancestors]))}l[o]=n}}return e},args:["comparator","options"],multi:!0}},cast:{set:{from:Array.isArray,to:(e,t)=>new Set(e)}},rebuild(e){e.$_terms._inclusions=[],e.$_terms._exclusions=[],e.$_terms._requireds=[];for(const t of e.$_terms.items)c.validateSingle(t,e),"required"===t._flags.presence?e.$_terms._requireds.push(t):"forbidden"===t._flags.presence?e.$_terms._exclusions.push(t):e.$_terms._inclusions.push(t);for(const t of e.$_terms.ordered)c.validateSingle(t,e)},manifest:{build:(e,t)=>(t.items&&(e=e.items(...t.items)),t.ordered&&(e=e.ordered(...t.ordered)),e)},messages:{"array.base":"{{#label}} must be an array","array.excludes":"{{#label}} contains an excluded value","array.hasKnown":"{{#label}} does not contain at least one required match for type {:#patternLabel}","array.hasUnknown":"{{#label}} does not contain at least one required match","array.includes":"{{#label}} does not match any of the allowed types","array.includesRequiredBoth":"{{#label}} does not contain {{#knownMisses}} and {{#unknownMisses}} other required value(s)","array.includesRequiredKnowns":"{{#label}} does not contain {{#knownMisses}}","array.includesRequiredUnknowns":"{{#label}} does not contain {{#unknownMisses}} required value(s)","array.length":"{{#label}} must contain {{#limit}} items","array.max":"{{#label}} must contain less than or equal to {{#limit}} items","array.min":"{{#label}} must contain at least {{#limit}} items","array.orderedLength":"{{#label}} must contain at most {{#limit}} items","array.sort":"{{#label}} must be sorted in {#order} order by {{#by}}","array.sort.mismatching":"{{#label}} cannot be sorted due to mismatching types","array.sort.unsupported":"{{#label}} cannot be sorted due to unsupported type {#type}","array.sparse":"{{#label}} must not be a sparse array item","array.unique":"{{#label}} contains a duplicate value"}}),c.fillMissedErrors=function(e,t,r,i,n,s){const o=[];let a=0;for(const e of r){const t=e._flags.label;t?o.push(t):++a}o.length?a?t.push(e.$_createError("array.includesRequiredBoth",i,{knownMisses:o,unknownMisses:a},n,s)):t.push(e.$_createError("array.includesRequiredKnowns",i,{knownMisses:o},n,s)):t.push(e.$_createError("array.includesRequiredUnknowns",i,{unknownMisses:a},n,s))},c.fillOrderedErrors=function(e,t,r,i,n,s){const o=[];for(const e of r)"required"===e._flags.presence&&o.push(e);o.length&&c.fillMissedErrors(e,t,o,i,n,s)},c.fillDefault=function(e,t,r,i){const n=[];let s=!0;for(let o=e.length-1;o>=0;--o){const a=e[o],l=[t,...r.ancestors],c=a.$_validate(void 0,r.localize(r.path,l,a),i).value;if(s){if(void 0===c)continue;s=!1}n.unshift(c)}n.length&&t.push(...n)},c.fastSplice=function(e,t){let r=t;for(;r<e.length;)e[r++]=e[r];--e.length},c.validateSingle=function(e,t){("array"===e.type||e._flags._arrayItems)&&(i(!t._flags.single,"Cannot specify array item with single rule enabled"),t.$_setFlag("_arrayItems",!0,{clone:!1}))},c.sort=function(e,t,r,i,n){const s="ascending"===r.order?1:-1,o=-1*s,a=s,l=(l,u)=>{let h=c.compare(l,u,o,a);if(null!==h)return h;if(r.by&&(l=r.by.resolve(l,i,n),u=r.by.resolve(u,i,n)),h=c.compare(l,u,o,a),null!==h)return h;const d=typeof l;if(d!==typeof u)throw e.$_createError("array.sort.mismatching",t,null,i,n);if("number"!==d&&"string"!==d)throw e.$_createError("array.sort.unsupported",t,{type:d},i,n);return"number"===d?(l-u)*s:l<u?o:a};try{return{value:t.slice().sort(l)}}catch(e){return{errors:e}}},c.compare=function(e,t,r,i){return e===t?0:void 0===e?1:void 0===t?-1:null===e?i:null===t?r:null}},4937:(e,t,r)=>{const i=r(375),n=r(8068),s=r(8160),o=r(2036),a={isBool:function(e){return"boolean"==typeof e}};e.exports=n.extend({type:"boolean",flags:{sensitive:{default:!1}},terms:{falsy:{init:null,manifest:"values"},truthy:{init:null,manifest:"values"}},coerce(e,{schema:t}){if("boolean"!=typeof e){if("string"==typeof e){const r=t._flags.sensitive?e:e.toLowerCase();e="true"===r||"false"!==r&&e}return"boolean"!=typeof e&&(e=t.$_terms.truthy&&t.$_terms.truthy.has(e,null,null,!t._flags.sensitive)||(!t.$_terms.falsy||!t.$_terms.falsy.has(e,null,null,!t._flags.sensitive))&&e),{value:e}}},validate(e,{error:t}){if("boolean"!=typeof e)return{value:e,errors:t("boolean.base")}},rules:{truthy:{method(...e){s.verifyFlat(e,"truthy");const t=this.clone();t.$_terms.truthy=t.$_terms.truthy||new o;for(let r=0;r<e.length;++r){const n=e[r];i(void 0!==n,"Cannot call truthy with undefined"),t.$_terms.truthy.add(n)}return t}},falsy:{method(...e){s.verifyFlat(e,"falsy");const t=this.clone();t.$_terms.falsy=t.$_terms.falsy||new o;for(let r=0;r<e.length;++r){const n=e[r];i(void 0!==n,"Cannot call falsy with undefined"),t.$_terms.falsy.add(n)}return t}},sensitive:{method(e=!0){return this.$_setFlag("sensitive",e)}}},cast:{number:{from:a.isBool,to:(e,t)=>e?1:0},string:{from:a.isBool,to:(e,t)=>e?"true":"false"}},manifest:{build:(e,t)=>(t.truthy&&(e=e.truthy(...t.truthy)),t.falsy&&(e=e.falsy(...t.falsy)),e)},messages:{"boolean.base":"{{#label}} must be a boolean"}})},7500:(e,t,r)=>{const i=r(375),n=r(8068),s=r(8160),o=r(3328),a={isDate:function(e){return e instanceof Date}};e.exports=n.extend({type:"date",coerce:{from:["number","string"],method:(e,{schema:t})=>({value:a.parse(e,t._flags.format)||e})},validate(e,{schema:t,error:r,prefs:i}){if(e instanceof Date&&!isNaN(e.getTime()))return;const n=t._flags.format;return i.convert&&n&&"string"==typeof e?{value:e,errors:r("date.format",{format:n})}:{value:e,errors:r("date.base")}},rules:{compare:{method:!1,validate(e,t,{date:r},{name:i,operator:n,args:o}){const a="now"===r?Date.now():r.getTime();return s.compare(e.getTime(),a,n)?e:t.error("date."+i,{limit:o.date,value:e})},args:[{name:"date",ref:!0,normalize:e=>"now"===e?e:a.parse(e),assert:e=>null!==e,message:"must have a valid date format"}]},format:{method(e){return i(["iso","javascript","unix"].includes(e),"Unknown date format",e),this.$_setFlag("format",e)}},greater:{method(e){return this.$_addRule({name:"greater",method:"compare",args:{date:e},operator:">"})}},iso:{method(){return this.format("iso")}},less:{method(e){return this.$_addRule({name:"less",method:"compare",args:{date:e},operator:"<"})}},max:{method(e){return this.$_addRule({name:"max",method:"compare",args:{date:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"compare",args:{date:e},operator:">="})}},timestamp:{method(e="javascript"){return i(["javascript","unix"].includes(e),'"type" must be one of "javascript, unix"'),this.format(e)}}},cast:{number:{from:a.isDate,to:(e,t)=>e.getTime()},string:{from:a.isDate,to:(e,{prefs:t})=>o.date(e,t)}},messages:{"date.base":"{{#label}} must be a valid date","date.format":'{{#label}} must be in {msg("date.format." + #format) || #format} format',"date.greater":"{{#label}} must be greater than {{:#limit}}","date.less":"{{#label}} must be less than {{:#limit}}","date.max":"{{#label}} must be less than or equal to {{:#limit}}","date.min":"{{#label}} must be greater than or equal to {{:#limit}}","date.format.iso":"ISO 8601 date","date.format.javascript":"timestamp or number of milliseconds","date.format.unix":"timestamp or number of seconds"}}),a.parse=function(e,t){if(e instanceof Date)return e;if("string"!=typeof e&&(isNaN(e)||!isFinite(e)))return null;if(/^\s*$/.test(e))return null;if("iso"===t)return s.isIsoDate(e)?a.date(e.toString()):null;const r=e;if("string"==typeof e&&/^[+-]?\d+(\.\d+)?$/.test(e)&&(e=parseFloat(e)),t){if("javascript"===t)return a.date(1*e);if("unix"===t)return a.date(1e3*e);if("string"==typeof r)return null}return a.date(e)},a.date=function(e){const t=new Date(e);return isNaN(t.getTime())?null:t}},390:(e,t,r)=>{const i=r(375),n=r(7824);e.exports=n.extend({type:"function",properties:{typeof:"function"},rules:{arity:{method(e){return i(Number.isSafeInteger(e)&&e>=0,"n must be a positive integer"),this.$_addRule({name:"arity",args:{n:e}})},validate:(e,t,{n:r})=>e.length===r?e:t.error("function.arity",{n:r})},class:{method(){return this.$_addRule("class")},validate:(e,t)=>/^\s*class\s/.test(e.toString())?e:t.error("function.class",{value:e})},minArity:{method(e){return i(Number.isSafeInteger(e)&&e>0,"n must be a strict positive integer"),this.$_addRule({name:"minArity",args:{n:e}})},validate:(e,t,{n:r})=>e.length>=r?e:t.error("function.minArity",{n:r})},maxArity:{method(e){return i(Number.isSafeInteger(e)&&e>=0,"n must be a positive integer"),this.$_addRule({name:"maxArity",args:{n:e}})},validate:(e,t,{n:r})=>e.length<=r?e:t.error("function.maxArity",{n:r})}},messages:{"function.arity":"{{#label}} must have an arity of {{#n}}","function.class":"{{#label}} must be a class","function.maxArity":"{{#label}} must have an arity lesser or equal to {{#n}}","function.minArity":"{{#label}} must have an arity greater or equal to {{#n}}"}})},7824:(e,t,r)=>{const i=r(978),n=r(375),s=r(8571),o=r(3652),a=r(8068),l=r(8160),c=r(3292),u=r(6354),h=r(6133),d=r(3328),f={renameDefaults:{alias:!1,multiple:!1,override:!1}};e.exports=a.extend({type:"_keys",properties:{typeof:"object"},flags:{unknown:{default:!1}},terms:{dependencies:{init:null},keys:{init:null,manifest:{mapped:{from:"schema",to:"key"}}},patterns:{init:null},renames:{init:null}},args:(e,t)=>e.keys(t),validate(e,{schema:t,error:r,state:i,prefs:n}){if(!e||typeof e!==t.$_property("typeof")||Array.isArray(e))return{value:e,errors:r("object.base",{type:t.$_property("typeof")})};if(!(t.$_terms.renames||t.$_terms.dependencies||t.$_terms.keys||t.$_terms.patterns||t.$_terms.externals))return;e=f.clone(e,n);const s=[];if(t.$_terms.renames&&!f.rename(t,e,i,n,s))return{value:e,errors:s};if(!t.$_terms.keys&&!t.$_terms.patterns&&!t.$_terms.dependencies)return{value:e,errors:s};const o=new Set(Object.keys(e));if(t.$_terms.keys){const r=[e,...i.ancestors];for(const a of t.$_terms.keys){const t=a.key,l=e[t];o.delete(t);const c=i.localize([...i.path,t],r,a),u=a.schema.$_validate(l,c,n);if(u.errors){if(n.abortEarly)return{value:e,errors:u.errors};void 0!==u.value&&(e[t]=u.value),s.push(...u.errors)}else"strip"===a.schema._flags.result||void 0===u.value&&void 0!==l?delete e[t]:void 0!==u.value&&(e[t]=u.value)}}if(o.size||t._flags._hasPatternMatch){const r=f.unknown(t,e,o,s,i,n);if(r)return r}if(t.$_terms.dependencies)for(const r of t.$_terms.dependencies){if(r.key&&void 0===r.key.resolve(e,i,n,null,{shadow:!1}))continue;const o=f.dependencies[r.rel](t,r,e,i,n);if(o){const r=t.$_createError(o.code,e,o.context,i,n);if(n.abortEarly)return{value:e,errors:r};s.push(r)}}return{value:e,errors:s}},rules:{and:{method(...e){return l.verifyFlat(e,"and"),f.dependency(this,"and",null,e)}},append:{method(e){return null==e||0===Object.keys(e).length?this:this.keys(e)}},assert:{method(e,t,r){d.isTemplate(e)||(e=c.ref(e)),n(void 0===r||"string"==typeof r,"Message must be a string"),t=this.$_compile(t,{appendPath:!0});const i=this.$_addRule({name:"assert",args:{subject:e,schema:t,message:r}});return i.$_mutateRegister(e),i.$_mutateRegister(t),i},validate(e,{error:t,prefs:r,state:i},{subject:n,schema:s,message:o}){const a=n.resolve(e,i,r),l=h.isRef(n)?n.absolute(i):[];return s.$_match(a,i.localize(l,[e,...i.ancestors],s),r)?e:t("object.assert",{subject:n,message:o})},args:["subject","schema","message"],multi:!0},instance:{method(e,t){return n("function"==typeof e,"constructor must be a function"),t=t||e.name,this.$_addRule({name:"instance",args:{constructor:e,name:t}})},validate:(e,t,{constructor:r,name:i})=>e instanceof r?e:t.error("object.instance",{type:i,value:e}),args:["constructor","name"]},keys:{method(e){n(void 0===e||"object"==typeof e,"Object schema must be a valid object"),n(!l.isSchema(e),"Object schema cannot be a joi schema");const t=this.clone();if(e)if(Object.keys(e).length){t.$_terms.keys=t.$_terms.keys?t.$_terms.keys.filter((t=>!e.hasOwnProperty(t.key))):new f.Keys;for(const r in e)l.tryWithPath((()=>t.$_terms.keys.push({key:r,schema:this.$_compile(e[r])})),r)}else t.$_terms.keys=new f.Keys;else t.$_terms.keys=null;return t.$_mutateRebuild()}},length:{method(e){return this.$_addRule({name:"length",args:{limit:e},operator:"="})},validate:(e,t,{limit:r},{name:i,operator:n,args:s})=>l.compare(Object.keys(e).length,r,n)?e:t.error("object."+i,{limit:s.limit,value:e}),args:[{name:"limit",ref:!0,assert:l.limit,message:"must be a positive integer"}]},max:{method(e){return this.$_addRule({name:"max",method:"length",args:{limit:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"length",args:{limit:e},operator:">="})}},nand:{method(...e){return l.verifyFlat(e,"nand"),f.dependency(this,"nand",null,e)}},or:{method(...e){return l.verifyFlat(e,"or"),f.dependency(this,"or",null,e)}},oxor:{method(...e){return f.dependency(this,"oxor",null,e)}},pattern:{method(e,t,r={}){const i=e instanceof RegExp;i||(e=this.$_compile(e,{appendPath:!0})),n(void 0!==t,"Invalid rule"),l.assertOptions(r,["fallthrough","matches"]),i&&n(!e.flags.includes("g")&&!e.flags.includes("y"),"pattern should not use global or sticky mode"),t=this.$_compile(t,{appendPath:!0});const s=this.clone();s.$_terms.patterns=s.$_terms.patterns||[];const o={[i?"regex":"schema"]:e,rule:t};return r.matches&&(o.matches=this.$_compile(r.matches),"array"!==o.matches.type&&(o.matches=o.matches.$_root.array().items(o.matches)),s.$_mutateRegister(o.matches),s.$_setFlag("_hasPatternMatch",!0,{clone:!1})),r.fallthrough&&(o.fallthrough=!0),s.$_terms.patterns.push(o),s.$_mutateRegister(t),s}},ref:{method(){return this.$_addRule("ref")},validate:(e,t)=>h.isRef(e)?e:t.error("object.refType",{value:e})},regex:{method(){return this.$_addRule("regex")},validate:(e,t)=>e instanceof RegExp?e:t.error("object.regex",{value:e})},rename:{method(e,t,r={}){n("string"==typeof e||e instanceof RegExp,"Rename missing the from argument"),n("string"==typeof t||t instanceof d,"Invalid rename to argument"),n(t!==e,"Cannot rename key to same name:",e),l.assertOptions(r,["alias","ignoreUndefined","override","multiple"]);const s=this.clone();s.$_terms.renames=s.$_terms.renames||[];for(const t of s.$_terms.renames)n(t.from!==e,"Cannot rename the same key multiple times");return t instanceof d&&s.$_mutateRegister(t),s.$_terms.renames.push({from:e,to:t,options:i(f.renameDefaults,r)}),s}},schema:{method(e="any"){return this.$_addRule({name:"schema",args:{type:e}})},validate:(e,t,{type:r})=>!l.isSchema(e)||"any"!==r&&e.type!==r?t.error("object.schema",{type:r}):e},unknown:{method(e){return this.$_setFlag("unknown",!1!==e)}},with:{method(e,t,r={}){return f.dependency(this,"with",e,t,r)}},without:{method(e,t,r={}){return f.dependency(this,"without",e,t,r)}},xor:{method(...e){return l.verifyFlat(e,"xor"),f.dependency(this,"xor",null,e)}}},overrides:{default(e,t){return void 0===e&&(e=l.symbols.deepDefault),this.$_parent("default",e,t)}},rebuild(e){if(e.$_terms.keys){const t=new o.Sorter;for(const r of e.$_terms.keys)l.tryWithPath((()=>t.add(r,{after:r.schema.$_rootReferences(),group:r.key})),r.key);e.$_terms.keys=new f.Keys(...t.nodes)}},manifest:{build(e,t){if(t.keys&&(e=e.keys(t.keys)),t.dependencies)for(const{rel:r,key:i=null,peers:n,options:s}of t.dependencies)e=f.dependency(e,r,i,n,s);if(t.patterns)for(const{regex:r,schema:i,rule:n,fallthrough:s,matches:o}of t.patterns)e=e.pattern(r||i,n,{fallthrough:s,matches:o});if(t.renames)for(const{from:r,to:i,options:n}of t.renames)e=e.rename(r,i,n);return e}},messages:{"object.and":"{{#label}} contains {{#presentWithLabels}} without its required peers {{#missingWithLabels}}","object.assert":'{{#label}} is invalid because {if(#subject.key, `"` + #subject.key + `" failed to ` + (#message || "pass the assertion test"), #message || "the assertion failed")}',"object.base":"{{#label}} must be of type {{#type}}","object.instance":"{{#label}} must be an instance of {{:#type}}","object.length":'{{#label}} must have {{#limit}} key{if(#limit == 1, "", "s")}',"object.max":'{{#label}} must have less than or equal to {{#limit}} key{if(#limit == 1, "", "s")}',"object.min":'{{#label}} must have at least {{#limit}} key{if(#limit == 1, "", "s")}',"object.missing":"{{#label}} must contain at least one of {{#peersWithLabels}}","object.nand":"{{:#mainWithLabel}} must not exist simultaneously with {{#peersWithLabels}}","object.oxor":"{{#label}} contains a conflict between optional exclusive peers {{#peersWithLabels}}","object.pattern.match":"{{#label}} keys failed to match pattern requirements","object.refType":"{{#label}} must be a Joi reference","object.regex":"{{#label}} must be a RegExp object","object.rename.multiple":"{{#label}} cannot rename {{:#from}} because multiple renames are disabled and another key was already renamed to {{:#to}}","object.rename.override":"{{#label}} cannot rename {{:#from}} because override is disabled and target {{:#to}} exists","object.schema":"{{#label}} must be a Joi schema of {{#type}} type","object.unknown":"{{#label}} is not allowed","object.with":"{{:#mainWithLabel}} missing required peer {{:#peerWithLabel}}","object.without":"{{:#mainWithLabel}} conflict with forbidden peer {{:#peerWithLabel}}","object.xor":"{{#label}} contains a conflict between exclusive peers {{#peersWithLabels}}"}}),f.clone=function(e,t){if("object"==typeof e){if(t.nonEnumerables)return s(e,{shallow:!0});const r=Object.create(Object.getPrototypeOf(e));return Object.assign(r,e),r}const r=function(...t){return e.apply(this,t)};return r.prototype=s(e.prototype),Object.defineProperty(r,"name",{value:e.name,writable:!1}),Object.defineProperty(r,"length",{value:e.length,writable:!1}),Object.assign(r,e),r},f.dependency=function(e,t,r,i,s){n(null===r||"string"==typeof r,t,"key must be a strings"),s||(s=i.length>1&&"object"==typeof i[i.length-1]?i.pop():{}),l.assertOptions(s,["separator"]),i=[].concat(i);const o=l.default(s.separator,"."),a=[];for(const e of i)n("string"==typeof e,t,"peers must be strings"),a.push(c.ref(e,{separator:o,ancestor:0,prefix:!1}));null!==r&&(r=c.ref(r,{separator:o,ancestor:0,prefix:!1}));const u=e.clone();return u.$_terms.dependencies=u.$_terms.dependencies||[],u.$_terms.dependencies.push(new f.Dependency(t,r,a,i)),u},f.dependencies={and(e,t,r,i,n){const s=[],o=[],a=t.peers.length;for(const e of t.peers)void 0===e.resolve(r,i,n,null,{shadow:!1})?s.push(e.key):o.push(e.key);if(s.length!==a&&o.length!==a)return{code:"object.and",context:{present:o,presentWithLabels:f.keysToLabels(e,o),missing:s,missingWithLabels:f.keysToLabels(e,s)}}},nand(e,t,r,i,n){const s=[];for(const e of t.peers)void 0!==e.resolve(r,i,n,null,{shadow:!1})&&s.push(e.key);if(s.length!==t.peers.length)return;const o=t.paths[0],a=t.paths.slice(1);return{code:"object.nand",context:{main:o,mainWithLabel:f.keysToLabels(e,o),peers:a,peersWithLabels:f.keysToLabels(e,a)}}},or(e,t,r,i,n){for(const e of t.peers)if(void 0!==e.resolve(r,i,n,null,{shadow:!1}))return;return{code:"object.missing",context:{peers:t.paths,peersWithLabels:f.keysToLabels(e,t.paths)}}},oxor(e,t,r,i,n){const s=[];for(const e of t.peers)void 0!==e.resolve(r,i,n,null,{shadow:!1})&&s.push(e.key);if(!s.length||1===s.length)return;const o={peers:t.paths,peersWithLabels:f.keysToLabels(e,t.paths)};return o.present=s,o.presentWithLabels=f.keysToLabels(e,s),{code:"object.oxor",context:o}},with(e,t,r,i,n){for(const s of t.peers)if(void 0===s.resolve(r,i,n,null,{shadow:!1}))return{code:"object.with",context:{main:t.key.key,mainWithLabel:f.keysToLabels(e,t.key.key),peer:s.key,peerWithLabel:f.keysToLabels(e,s.key)}}},without(e,t,r,i,n){for(const s of t.peers)if(void 0!==s.resolve(r,i,n,null,{shadow:!1}))return{code:"object.without",context:{main:t.key.key,mainWithLabel:f.keysToLabels(e,t.key.key),peer:s.key,peerWithLabel:f.keysToLabels(e,s.key)}}},xor(e,t,r,i,n){const s=[];for(const e of t.peers)void 0!==e.resolve(r,i,n,null,{shadow:!1})&&s.push(e.key);if(1===s.length)return;const o={peers:t.paths,peersWithLabels:f.keysToLabels(e,t.paths)};return 0===s.length?{code:"object.missing",context:o}:(o.present=s,o.presentWithLabels=f.keysToLabels(e,s),{code:"object.xor",context:o})}},f.keysToLabels=function(e,t){return Array.isArray(t)?t.map((t=>e.$_mapLabels(t))):e.$_mapLabels(t)},f.rename=function(e,t,r,i,n){const s={};for(const o of e.$_terms.renames){const a=[],l="string"!=typeof o.from;if(l)for(const e in t){if(void 0===t[e]&&o.options.ignoreUndefined)continue;if(e===o.to)continue;const r=o.from.exec(e);r&&a.push({from:e,to:o.to,match:r})}else!Object.prototype.hasOwnProperty.call(t,o.from)||void 0===t[o.from]&&o.options.ignoreUndefined||a.push(o);for(const c of a){const a=c.from;let u=c.to;if(u instanceof d&&(u=u.render(t,r,i,c.match)),a!==u){if(!o.options.multiple&&s[u]&&(n.push(e.$_createError("object.rename.multiple",t,{from:a,to:u,pattern:l},r,i)),i.abortEarly))return!1;if(Object.prototype.hasOwnProperty.call(t,u)&&!o.options.override&&!s[u]&&(n.push(e.$_createError("object.rename.override",t,{from:a,to:u,pattern:l},r,i)),i.abortEarly))return!1;void 0===t[a]?delete t[u]:t[u]=t[a],s[u]=!0,o.options.alias||delete t[a]}}}return!0},f.unknown=function(e,t,r,i,n,s){if(e.$_terms.patterns){let o=!1;const a=e.$_terms.patterns.map((e=>{if(e.matches)return o=!0,[]})),l=[t,...n.ancestors];for(const o of r){const c=t[o],u=[...n.path,o];for(let h=0;h<e.$_terms.patterns.length;++h){const d=e.$_terms.patterns[h];if(d.regex){const e=d.regex.test(o);if(n.mainstay.tracer.debug(n,"rule","pattern.".concat(h),e?"pass":"error"),!e)continue}else if(!d.schema.$_match(o,n.nest(d.schema,"pattern.".concat(h)),s))continue;r.delete(o);const f=n.localize(u,l,{schema:d.rule,key:o}),p=d.rule.$_validate(c,f,s);if(p.errors){if(s.abortEarly)return{value:t,errors:p.errors};i.push(...p.errors)}if(d.matches&&a[h].push(o),t[o]=p.value,!d.fallthrough)break}}if(o)for(let r=0;r<a.length;++r){const o=a[r];if(!o)continue;const c=e.$_terms.patterns[r].matches,h=n.localize(n.path,l,c),d=c.$_validate(o,h,s);if(d.errors){const r=u.details(d.errors,{override:!1});r.matches=o;const a=e.$_createError("object.pattern.match",t,r,n,s);if(s.abortEarly)return{value:t,errors:a};i.push(a)}}}if(r.size&&(e.$_terms.keys||e.$_terms.patterns)){if(s.stripUnknown&&!e._flags.unknown||s.skipFunctions){const e=!(!s.stripUnknown||!0!==s.stripUnknown&&!s.stripUnknown.objects);for(const i of r)e?(delete t[i],r.delete(i)):"function"==typeof t[i]&&r.delete(i)}if(!l.default(e._flags.unknown,s.allowUnknown))for(const o of r){const r=n.localize([...n.path,o],[]),a=e.$_createError("object.unknown",t[o],{child:o},r,s,{flags:!1});if(s.abortEarly)return{value:t,errors:a};i.push(a)}}},f.Dependency=class{constructor(e,t,r,i){this.rel=e,this.key=t,this.peers=r,this.paths=i}describe(){const e={rel:this.rel,peers:this.paths};return null!==this.key&&(e.key=this.key.key),"."!==this.peers[0].separator&&(e.options={separator:this.peers[0].separator}),e}},f.Keys=class extends Array{concat(e){const t=this.slice(),r=new Map;for(let e=0;e<t.length;++e)r.set(t[e].key,e);for(const i of e){const e=i.key,n=r.get(e);void 0!==n?t[n]={key:e,schema:t[n].schema.concat(i.schema)}:t.push(i)}return t}}},8785:(e,t,r)=>{const i=r(375),n=r(8068),s=r(8160),o=r(3292),a=r(6354),l={};e.exports=n.extend({type:"link",properties:{schemaChain:!0},terms:{link:{init:null,manifest:"single",register:!1}},args:(e,t)=>e.ref(t),validate(e,{schema:t,state:r,prefs:n}){i(t.$_terms.link,"Uninitialized link schema");const s=l.generate(t,e,r,n),o=t.$_terms.link[0].ref;return s.$_validate(e,r.nest(s,"link:".concat(o.display,":").concat(s.type)),n)},generate:(e,t,r,i)=>l.generate(e,t,r,i),rules:{ref:{method(e){i(!this.$_terms.link,"Cannot reinitialize schema"),e=o.ref(e),i("value"===e.type||"local"===e.type,"Invalid reference type:",e.type),i("local"===e.type||"root"===e.ancestor||e.ancestor>0,"Link cannot reference itself");const t=this.clone();return t.$_terms.link=[{ref:e}],t}},relative:{method(e=!0){return this.$_setFlag("relative",e)}}},overrides:{concat(e){i(this.$_terms.link,"Uninitialized link schema"),i(s.isSchema(e),"Invalid schema object"),i("link"!==e.type,"Cannot merge type link with another link");const t=this.clone();return t.$_terms.whens||(t.$_terms.whens=[]),t.$_terms.whens.push({concat:e}),t.$_mutateRebuild()}},manifest:{build:(e,t)=>(i(t.link,"Invalid link description missing link"),e.ref(t.link))}}),l.generate=function(e,t,r,i){let n=r.mainstay.links.get(e);if(n)return n._generate(t,r,i).schema;const s=e.$_terms.link[0].ref,{perspective:o,path:a}=l.perspective(s,r);l.assert(o,"which is outside of schema boundaries",s,e,r,i);try{n=a.length?o.$_reach(a):o}catch(t){l.assert(!1,"to non-existing schema",s,e,r,i)}return l.assert("link"!==n.type,"which is another link",s,e,r,i),e._flags.relative||r.mainstay.links.set(e,n),n._generate(t,r,i).schema},l.perspective=function(e,t){if("local"===e.type){for(const{schema:r,key:i}of t.schemas){if((r._flags.id||i)===e.path[0])return{perspective:r,path:e.path.slice(1)};if(r.$_terms.shared)for(const t of r.$_terms.shared)if(t._flags.id===e.path[0])return{perspective:t,path:e.path.slice(1)}}return{perspective:null,path:null}}return"root"===e.ancestor?{perspective:t.schemas[t.schemas.length-1].schema,path:e.path}:{perspective:t.schemas[e.ancestor]&&t.schemas[e.ancestor].schema,path:e.path}},l.assert=function(e,t,r,n,s,o){e||i(!1,'"'.concat(a.label(n._flags,s,o),'" contains link reference "').concat(r.display,'" ').concat(t))}},3832:(e,t,r)=>{const i=r(375),n=r(8068),s=r(8160),o={numberRx:/^\s*[+-]?(?:(?:\d+(?:\.\d*)?)|(?:\.\d+))(?:e([+-]?\d+))?\s*$/i,precisionRx:/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/};e.exports=n.extend({type:"number",flags:{unsafe:{default:!1}},coerce:{from:"string",method(e,{schema:t,error:r}){const i=e.match(o.numberRx);if(!i)return;e=e.trim();const n={value:parseFloat(e)};if(0===n.value&&(n.value=0),!t._flags.unsafe)if(e.match(/e/i)){if(o.normalizeExponent("".concat(n.value/Math.pow(10,i[1]),"e").concat(i[1]))!==o.normalizeExponent(e))return n.errors=r("number.unsafe"),n}else{const t=n.value.toString();if(t.match(/e/i))return n;if(t!==o.normalizeDecimal(e))return n.errors=r("number.unsafe"),n}return n}},validate(e,{schema:t,error:r,prefs:i}){if(e===1/0||e===-1/0)return{value:e,errors:r("number.infinity")};if(!s.isNumber(e))return{value:e,errors:r("number.base")};const n={value:e};if(i.convert){const e=t.$_getRule("precision");if(e){const t=Math.pow(10,e.args.limit);n.value=Math.round(n.value*t)/t}}return 0===n.value&&(n.value=0),!t._flags.unsafe&&(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)&&(n.errors=r("number.unsafe")),n},rules:{compare:{method:!1,validate:(e,t,{limit:r},{name:i,operator:n,args:o})=>s.compare(e,r,n)?e:t.error("number."+i,{limit:o.limit,value:e}),args:[{name:"limit",ref:!0,assert:s.isNumber,message:"must be a number"}]},greater:{method(e){return this.$_addRule({name:"greater",method:"compare",args:{limit:e},operator:">"})}},integer:{method(){return this.$_addRule("integer")},validate:(e,t)=>Math.trunc(e)-e==0?e:t.error("number.integer")},less:{method(e){return this.$_addRule({name:"less",method:"compare",args:{limit:e},operator:"<"})}},max:{method(e){return this.$_addRule({name:"max",method:"compare",args:{limit:e},operator:"<="})}},min:{method(e){return this.$_addRule({name:"min",method:"compare",args:{limit:e},operator:">="})}},multiple:{method(e){return this.$_addRule({name:"multiple",args:{base:e}})},validate:(e,t,{base:r},i)=>e*(1/r)%1==0?e:t.error("number.multiple",{multiple:i.args.base,value:e}),args:[{name:"base",ref:!0,assert:e=>"number"==typeof e&&isFinite(e)&&e>0,message:"must be a positive number"}],multi:!0},negative:{method(){return this.sign("negative")}},port:{method(){return this.$_addRule("port")},validate:(e,t)=>Number.isSafeInteger(e)&&e>=0&&e<=65535?e:t.error("number.port")},positive:{method(){return this.sign("positive")}},precision:{method(e){return i(Number.isSafeInteger(e),"limit must be an integer"),this.$_addRule({name:"precision",args:{limit:e}})},validate(e,t,{limit:r}){const i=e.toString().match(o.precisionRx);return Math.max((i[1]?i[1].length:0)-(i[2]?parseInt(i[2],10):0),0)<=r?e:t.error("number.precision",{limit:r,value:e})},convert:!0},sign:{method(e){return i(["negative","positive"].includes(e),"Invalid sign",e),this.$_addRule({name:"sign",args:{sign:e}})},validate:(e,t,{sign:r})=>"negative"===r&&e<0||"positive"===r&&e>0?e:t.error("number.".concat(r))},unsafe:{method(e=!0){return i("boolean"==typeof e,"enabled must be a boolean"),this.$_setFlag("unsafe",e)}}},cast:{string:{from:e=>"number"==typeof e,to:(e,t)=>e.toString()}},messages:{"number.base":"{{#label}} must be a number","number.greater":"{{#label}} must be greater than {{#limit}}","number.infinity":"{{#label}} cannot be infinity","number.integer":"{{#label}} must be an integer","number.less":"{{#label}} must be less than {{#limit}}","number.max":"{{#label}} must be less than or equal to {{#limit}}","number.min":"{{#label}} must be greater than or equal to {{#limit}}","number.multiple":"{{#label}} must be a multiple of {{#multiple}}","number.negative":"{{#label}} must be a negative number","number.port":"{{#label}} must be a valid port","number.positive":"{{#label}} must be a positive number","number.precision":"{{#label}} must have no more than {{#limit}} decimal places","number.unsafe":"{{#label}} must be a safe number"}}),o.normalizeExponent=function(e){return e.replace(/E/,"e").replace(/\.(\d*[1-9])?0+e/,".$1e").replace(/\.e/,"e").replace(/e\+/,"e").replace(/^\+/,"").replace(/^(-?)0+([1-9])/,"$1$2")},o.normalizeDecimal=function(e){return(e=e.replace(/^\+/,"").replace(/\.0*$/,"").replace(/^(-?)\.([^\.]*)$/,"$10.$2").replace(/^(-?)0+([0-9])/,"$1$2")).includes(".")&&e.endsWith("0")&&(e=e.replace(/0+$/,"")),"-0"===e?"0":e}},8966:(e,t,r)=>{const i=r(7824);e.exports=i.extend({type:"object",cast:{map:{from:e=>e&&"object"==typeof e,to:(e,t)=>new Map(Object.entries(e))}}})},7417:(e,t,r)=>{function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const o=r(375),a=r(5380),l=r(1745),c=r(9959),u=r(6064),h=r(9926),d=r(5752),f=r(8068),p=r(8160),m={tlds:h instanceof Set&&{tlds:{allow:h,deny:null}},base64Regex:{true:{true:/^(?:[\w\-]{2}[\w\-]{2})*(?:[\w\-]{2}==|[\w\-]{3}=)?$/,false:/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/},false:{true:/^(?:[\w\-]{2}[\w\-]{2})*(?:[\w\-]{2}(==)?|[\w\-]{3}=?)?$/,false:/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}(==)?|[A-Za-z0-9+\/]{3}=?)?$/}},dataUriRegex:/^data:[\w+.-]+\/[\w+.-]+;((charset=[\w-]+|base64),)?(.*)$/,hexRegex:/^[a-f0-9]+$/i,ipRegex:c.regex({cidr:"forbidden"}).regex,isoDurationRegex:/^P(?!$)(\d+Y)?(\d+M)?(\d+W)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?$/,guidBrackets:{"{":"}","[":"]","(":")","":""},guidVersions:{uuidv1:"1",uuidv2:"2",uuidv3:"3",uuidv4:"4",uuidv5:"5"},guidSeparators:new Set([void 0,!0,!1,"-",":"]),normalizationForms:["NFC","NFD","NFKC","NFKD"]};e.exports=f.extend({type:"string",flags:{insensitive:{default:!1},truncate:{default:!1}},terms:{replacements:{init:null}},coerce:{from:"string",method(e,{schema:t,state:r,prefs:i}){const n=t.$_getRule("normalize");n&&(e=e.normalize(n.args.form));const s=t.$_getRule("case");s&&(e="upper"===s.args.direction?e.toLocaleUpperCase():e.toLocaleLowerCase());const o=t.$_getRule("trim");if(o&&o.args.enabled&&(e=e.trim()),t.$_terms.replacements)for(const r of t.$_terms.replacements)e=e.replace(r.pattern,r.replacement);const a=t.$_getRule("hex");if(a&&a.args.options.byteAligned&&e.length%2!=0&&(e="0".concat(e)),t.$_getRule("isoDate")){const t=m.isoDate(e);t&&(e=t)}if(t._flags.truncate){const n=t.$_getRule("max");if(n){let s=n.args.limit;if(p.isResolvable(s)&&(s=s.resolve(e,r,i),!p.limit(s)))return{value:e,errors:t.$_createError("any.ref",s,{ref:n.args.limit,arg:"limit",reason:"must be a positive integer"},r,i)};e=e.slice(0,s)}}return{value:e}}},validate(e,{schema:t,error:r}){if("string"!=typeof e)return{value:e,errors:r("string.base")};if(""===e){const i=t.$_getRule("min");if(i&&0===i.args.limit)return;return{value:e,errors:r("string.empty")}}},rules:{alphanum:{method(){return this.$_addRule("alphanum")},validate:(e,t)=>/^[a-zA-Z0-9]+$/.test(e)?e:t.error("string.alphanum")},base64:{method(e={}){return p.assertOptions(e,["paddingRequired","urlSafe"]),e=n({urlSafe:!1,paddingRequired:!0},e),o("boolean"==typeof e.paddingRequired,"paddingRequired must be boolean"),o("boolean"==typeof e.urlSafe,"urlSafe must be boolean"),this.$_addRule({name:"base64",args:{options:e}})},validate:(e,t,{options:r})=>m.base64Regex[r.paddingRequired][r.urlSafe].test(e)?e:t.error("string.base64")},case:{method(e){return o(["lower","upper"].includes(e),"Invalid case:",e),this.$_addRule({name:"case",args:{direction:e}})},validate:(e,t,{direction:r})=>"lower"===r&&e===e.toLocaleLowerCase()||"upper"===r&&e===e.toLocaleUpperCase()?e:t.error("string.".concat(r,"case")),convert:!0},creditCard:{method(){return this.$_addRule("creditCard")},validate(e,t){let r=e.length,i=0,n=1;for(;r--;){const t=e.charAt(r)*n;i+=t-9*(t>9),n^=3}return i>0&&i%10==0?e:t.error("string.creditCard")}},dataUri:{method(e={}){return p.assertOptions(e,["paddingRequired"]),e=n({paddingRequired:!0},e),o("boolean"==typeof e.paddingRequired,"paddingRequired must be boolean"),this.$_addRule({name:"dataUri",args:{options:e}})},validate(e,t,{options:r}){const i=e.match(m.dataUriRegex);if(i){if(!i[2])return e;if("base64"!==i[2])return e;if(m.base64Regex[r.paddingRequired].false.test(i[3]))return e}return t.error("string.dataUri")}},domain:{method(e){e&&p.assertOptions(e,["allowFullyQualified","allowUnicode","maxDomainSegments","minDomainSegments","tlds"]);const t=m.addressOptions(e);return this.$_addRule({name:"domain",args:{options:e},address:t})},validate:(e,t,r,{address:i})=>a.isValid(e,i)?e:t.error("string.domain")},email:{method(e={}){p.assertOptions(e,["allowFullyQualified","allowUnicode","ignoreLength","maxDomainSegments","minDomainSegments","multiple","separator","tlds"]),o(void 0===e.multiple||"boolean"==typeof e.multiple,"multiple option must be an boolean");const t=m.addressOptions(e),r=new RegExp("\\s*[".concat(e.separator?u(e.separator):",","]\\s*"));return this.$_addRule({name:"email",args:{options:e},regex:r,address:t})},validate(e,t,{options:r},{regex:i,address:n}){const s=r.multiple?e.split(i):[e],o=[];for(const e of s)l.isValid(e,n)||o.push(e);return o.length?t.error("string.email",{value:e,invalids:o}):e}},guid:{alias:"uuid",method(e={}){p.assertOptions(e,["version","separator"]);let t="";if(e.version){const r=[].concat(e.version);o(r.length>=1,"version must have at least 1 valid version specified");const i=new Set;for(let e=0;e<r.length;++e){const n=r[e];o("string"==typeof n,"version at position "+e+" must be a string");const s=m.guidVersions[n.toLowerCase()];o(s,"version at position "+e+" must be one of "+Object.keys(m.guidVersions).join(", ")),o(!i.has(s),"version at position "+e+" must not be a duplicate"),t+=s,i.add(s)}}o(m.guidSeparators.has(e.separator),'separator must be one of true, false, "-", or ":"');const r=void 0===e.separator?"[:-]?":!0===e.separator?"[:-]":!1===e.separator?"[]?":"\\".concat(e.separator),i=new RegExp("^([\\[{\\(]?)[0-9A-F]{8}(".concat(r,")[0-9A-F]{4}\\2?[").concat(t||"0-9A-F","][0-9A-F]{3}\\2?[").concat(t?"89AB":"0-9A-F","][0-9A-F]{3}\\2?[0-9A-F]{12}([\\]}\\)]?)$"),"i");return this.$_addRule({name:"guid",args:{options:e},regex:i})},validate(e,t,r,{regex:i}){const n=i.exec(e);return n?m.guidBrackets[n[1]]!==n[n.length-1]?t.error("string.guid"):e:t.error("string.guid")}},hex:{method(e={}){return p.assertOptions(e,["byteAligned"]),e=n({byteAligned:!1},e),o("boolean"==typeof e.byteAligned,"byteAligned must be boolean"),this.$_addRule({name:"hex",args:{options:e}})},validate:(e,t,{options:r})=>m.hexRegex.test(e)?r.byteAligned&&e.length%2!=0?t.error("string.hexAlign"):e:t.error("string.hex")},hostname:{method(){return this.$_addRule("hostname")},validate:(e,t)=>a.isValid(e,{minDomainSegments:1})||m.ipRegex.test(e)?e:t.error("string.hostname")},insensitive:{method(){return this.$_setFlag("insensitive",!0)}},ip:{method(e={}){p.assertOptions(e,["cidr","version"]);const{cidr:t,versions:r,regex:i}=c.regex(e),n=e.version?r:void 0;return this.$_addRule({name:"ip",args:{options:{cidr:t,version:n}},regex:i})},validate:(e,t,{options:r},{regex:i})=>i.test(e)?e:r.version?t.error("string.ipVersion",{value:e,cidr:r.cidr,version:r.version}):t.error("string.ip",{value:e,cidr:r.cidr})},isoDate:{method(){return this.$_addRule("isoDate")},validate:(e,{error:t})=>m.isoDate(e)?e:t("string.isoDate")},isoDuration:{method(){return this.$_addRule("isoDuration")},validate:(e,t)=>m.isoDurationRegex.test(e)?e:t.error("string.isoDuration")},length:{method(e,t){return m.length(this,"length",e,"=",t)},validate(e,t,{limit:r,encoding:i},{name:n,operator:s,args:o}){const a=!i&&e.length;return p.compare(a,r,s)?e:t.error("string."+n,{limit:o.limit,value:e,encoding:i})},args:[{name:"limit",ref:!0,assert:p.limit,message:"must be a positive integer"},"encoding"]},lowercase:{method(){return this.case("lower")}},max:{method(e,t){return m.length(this,"max",e,"<=",t)},args:["limit","encoding"]},min:{method(e,t){return m.length(this,"min",e,">=",t)},args:["limit","encoding"]},normalize:{method(e="NFC"){return o(m.normalizationForms.includes(e),"normalization form must be one of "+m.normalizationForms.join(", ")),this.$_addRule({name:"normalize",args:{form:e}})},validate:(e,{error:t},{form:r})=>e===e.normalize(r)?e:t("string.normalize",{value:e,form:r}),convert:!0},pattern:{alias:"regex",method(e,t={}){o(e instanceof RegExp,"regex must be a RegExp"),o(!e.flags.includes("g")&&!e.flags.includes("y"),"regex should not use global or sticky mode"),"string"==typeof t&&(t={name:t}),p.assertOptions(t,["invert","name"]);const r=["string.pattern",t.invert?".invert":"",t.name?".name":".base"].join("");return this.$_addRule({name:"pattern",args:{regex:e,options:t},errorCode:r})},validate:(e,t,{regex:r,options:i},{errorCode:n})=>r.test(e)^i.invert?e:t.error(n,{name:i.name,regex:r,value:e}),args:["regex","options"],multi:!0},replace:{method(e,t){"string"==typeof e&&(e=new RegExp(u(e),"g")),o(e instanceof RegExp,"pattern must be a RegExp"),o("string"==typeof t,"replacement must be a String");const r=this.clone();return r.$_terms.replacements||(r.$_terms.replacements=[]),r.$_terms.replacements.push({pattern:e,replacement:t}),r}},token:{method(){return this.$_addRule("token")},validate:(e,t)=>/^\w+$/.test(e)?e:t.error("string.token")},trim:{method(e=!0){return o("boolean"==typeof e,"enabled must be a boolean"),this.$_addRule({name:"trim",args:{enabled:e}})},validate:(e,t,{enabled:r})=>r&&e!==e.trim()?t.error("string.trim"):e,convert:!0},truncate:{method(e=!0){return o("boolean"==typeof e,"enabled must be a boolean"),this.$_setFlag("truncate",e)}},uppercase:{method(){return this.case("upper")}},uri:{method(e={}){p.assertOptions(e,["allowRelative","allowQuerySquareBrackets","domain","relativeOnly","scheme"]),e.domain&&p.assertOptions(e.domain,["allowFullyQualified","allowUnicode","maxDomainSegments","minDomainSegments","tlds"]);const{regex:t,scheme:r}=d.regex(e),i=e.domain?m.addressOptions(e.domain):null;return this.$_addRule({name:"uri",args:{options:e},regex:t,domain:i,scheme:r})},validate(e,t,{options:r},{regex:i,domain:n,scheme:s}){if(["http:/","https:/"].includes(e))return t.error("string.uri");const o=i.exec(e);if(o){const i=o[1]||o[2];return!n||r.allowRelative&&!i||a.isValid(i,n)?e:t.error("string.domain",{value:i})}return r.relativeOnly?t.error("string.uriRelativeOnly"):r.scheme?t.error("string.uriCustomScheme",{scheme:s,value:e}):t.error("string.uri")}}},manifest:{build(e,t){if(t.replacements)for(const{pattern:r,replacement:i}of t.replacements)e=e.replace(r,i);return e}},messages:{"string.alphanum":"{{#label}} must only contain alpha-numeric characters","string.base":"{{#label}} must be a string","string.base64":"{{#label}} must be a valid base64 string","string.creditCard":"{{#label}} must be a credit card","string.dataUri":"{{#label}} must be a valid dataUri string","string.domain":"{{#label}} must contain a valid domain name","string.email":"{{#label}} must be a valid email","string.empty":"{{#label}} is not allowed to be empty","string.guid":"{{#label}} must be a valid GUID","string.hex":"{{#label}} must only contain hexadecimal characters","string.hexAlign":"{{#label}} hex decoded representation must be byte aligned","string.hostname":"{{#label}} must be a valid hostname","string.ip":"{{#label}} must be a valid ip address with a {{#cidr}} CIDR","string.ipVersion":"{{#label}} must be a valid ip address of one of the following versions {{#version}} with a {{#cidr}} CIDR","string.isoDate":"{{#label}} must be in iso format","string.isoDuration":"{{#label}} must be a valid ISO 8601 duration","string.length":"{{#label}} length must be {{#limit}} characters long","string.lowercase":"{{#label}} must only contain lowercase characters","string.max":"{{#label}} length must be less than or equal to {{#limit}} characters long","string.min":"{{#label}} length must be at least {{#limit}} characters long","string.normalize":"{{#label}} must be unicode normalized in the {{#form}} form","string.token":"{{#label}} must only contain alpha-numeric and underscore characters","string.pattern.base":"{{#label}} with value {:[.]} fails to match the required pattern: {{#regex}}","string.pattern.name":"{{#label}} with value {:[.]} fails to match the {{#name}} pattern","string.pattern.invert.base":"{{#label}} with value {:[.]} matches the inverted pattern: {{#regex}}","string.pattern.invert.name":"{{#label}} with value {:[.]} matches the inverted {{#name}} pattern","string.trim":"{{#label}} must not have leading or trailing whitespace","string.uri":"{{#label}} must be a valid uri","string.uriCustomScheme":"{{#label}} must be a valid uri with a scheme matching the {{#scheme}} pattern","string.uriRelativeOnly":"{{#label}} must be a valid relative uri","string.uppercase":"{{#label}} must only contain uppercase characters"}}),m.addressOptions=function(e){if(!e)return e;if(o(void 0===e.minDomainSegments||Number.isSafeInteger(e.minDomainSegments)&&e.minDomainSegments>0,"minDomainSegments must be a positive integer"),o(void 0===e.maxDomainSegments||Number.isSafeInteger(e.maxDomainSegments)&&e.maxDomainSegments>0,"maxDomainSegments must be a positive integer"),!1===e.tlds)return e;if(!0===e.tlds||void 0===e.tlds)return o(m.tlds,"Built-in TLD list disabled"),Object.assign({},e,m.tlds);o("object"==typeof e.tlds,"tlds must be true, false, or an object");const t=e.tlds.deny;if(t)return Array.isArray(t)&&(e=Object.assign({},e,{tlds:{deny:new Set(t)}})),o(e.tlds.deny instanceof Set,"tlds.deny must be an array, Set, or boolean"),o(!e.tlds.allow,"Cannot specify both tlds.allow and tlds.deny lists"),m.validateTlds(e.tlds.deny,"tlds.deny"),e;const r=e.tlds.allow;return r?!0===r?(o(m.tlds,"Built-in TLD list disabled"),Object.assign({},e,m.tlds)):(Array.isArray(r)&&(e=Object.assign({},e,{tlds:{allow:new Set(r)}})),o(e.tlds.allow instanceof Set,"tlds.allow must be an array, Set, or boolean"),m.validateTlds(e.tlds.allow,"tlds.allow"),e):e},m.validateTlds=function(e,t){for(const r of e)o(a.isValid(r,{minDomainSegments:1,maxDomainSegments:1}),"".concat(t," must contain valid top level domain names"))},m.isoDate=function(e){if(!p.isIsoDate(e))return null;/.*T.*[+-]\d\d$/.test(e)&&(e+="00");const t=new Date(e);return isNaN(t.getTime())?null:t.toISOString()},m.length=function(e,t,r,i,n){return o(!n||!1,"Invalid encoding:",n),e.$_addRule({name:t,method:"length",args:{limit:r,encoding:n},operator:i})}},8826:(e,t,r)=>{const i=r(375),n=r(8068),s={};s.Map=class extends Map{slice(){return new s.Map(this)}},e.exports=n.extend({type:"symbol",terms:{map:{init:new s.Map}},coerce:{method(e,{schema:t,error:r}){const i=t.$_terms.map.get(e);return i&&(e=i),t._flags.only&&"symbol"!=typeof e?{value:e,errors:r("symbol.map",{map:t.$_terms.map})}:{value:e}}},validate(e,{error:t}){if("symbol"!=typeof e)return{value:e,errors:t("symbol.base")}},rules:{map:{method(e){e&&!e[Symbol.iterator]&&"object"==typeof e&&(e=Object.entries(e)),i(e&&e[Symbol.iterator],"Iterable must be an iterable or object");const t=this.clone(),r=[];for(const n of e){i(n&&n[Symbol.iterator],"Entry must be an iterable");const[e,s]=n;i("object"!=typeof e&&"function"!=typeof e&&"symbol"!=typeof e,"Key must not be of type object, function, or Symbol"),i("symbol"==typeof s,"Value must be a Symbol"),t.$_terms.map.set(e,s),r.push(s)}return t.valid(...r)}}},manifest:{build:(e,t)=>(t.map&&(e=e.map(t.map)),e)},messages:{"symbol.base":"{{#label}} must be a symbol","symbol.map":"{{#label}} must be one of {{#map}}"}})},8863:(e,t,r)=>{const i=r(375),n=r(8571),s=r(738),o=r(9621),a=r(8160),l=r(6354),c=r(493),u={result:Symbol("result")};t.entry=function(e,t,r){let n=a.defaults;r&&(i(void 0===r.warnings,"Cannot override warnings preference in synchronous validation"),i(void 0===r.artifacts,"Cannot override artifacts preference in synchronous validation"),n=a.preferences(a.defaults,r));const s=u.entry(e,t,n);i(!s.mainstay.externals.length,"Schema with external rules must use validateAsync()");const o={value:s.value};return s.error&&(o.error=s.error),s.mainstay.warnings.length&&(o.warning=l.details(s.mainstay.warnings)),s.mainstay.debug&&(o.debug=s.mainstay.debug),s.mainstay.artifacts&&(o.artifacts=s.mainstay.artifacts),o},t.entryAsync=async function(e,t,r){let i=a.defaults;r&&(i=a.preferences(a.defaults,r));const n=u.entry(e,t,i),s=n.mainstay;if(n.error)throw s.debug&&(n.error.debug=s.debug),n.error;if(s.externals.length){let t=n.value;for(const{method:n,path:a,label:l}of s.externals){let s,c,u=t;a.length&&(s=a[a.length-1],c=o(t,a.slice(0,-1)),u=c[s]);try{const e=await n(u,{prefs:r});if(void 0===e||e===u)continue;c?c[s]=e:t=e}catch(e){throw i.errors.label&&(e.message+=" (".concat(l,")")),e}}n.value=t}if(!i.warnings&&!i.debug&&!i.artifacts)return n.value;const c={value:n.value};return s.warnings.length&&(c.warning=l.details(s.warnings)),s.debug&&(c.debug=s.debug),s.artifacts&&(c.artifacts=s.artifacts),c},u.entry=function(e,r,i){const{tracer:n,cleanup:s}=u.tracer(r,i),o={externals:[],warnings:[],tracer:n,debug:i.debug?[]:null,links:r._ids._schemaChain?new Map:null},a=r._ids._schemaChain?[{schema:r}]:null,h=new c([],[],{mainstay:o,schemas:a}),d=t.validate(e,r,h,i);s&&r.$_root.untrace();const f=l.process(d.errors,e,i);return{value:d.value,error:f,mainstay:o}},u.tracer=function(e,t){return e.$_root._tracer?{tracer:e.$_root._tracer._register(e)}:t.debug?(i(e.$_root.trace,"Debug mode not supported"),{tracer:e.$_root.trace()._register(e),cleanup:!0}):{tracer:u.ignore}},t.validate=function(e,t,r,i,n={}){if(t.$_terms.whens&&(t=t._generate(e,r,i).schema),t._preferences&&(i=u.prefs(t,i)),t._cache&&i.cache){const i=t._cache.get(e);if(r.mainstay.tracer.debug(r,"validate","cached",!!i),i)return i}const s=(n,s,o)=>t.$_createError(n,e,s,o||r,i),o={original:e,prefs:i,schema:t,state:r,error:s,errorsArray:u.errorsArray,warn:(e,t,i)=>r.mainstay.warnings.push(s(e,t,i)),message:(n,s)=>t.$_createError("custom",e,s,r,i,{messages:n})};r.mainstay.tracer.entry(t,r);const l=t._definition;if(l.prepare&&void 0!==e&&i.convert){const t=l.prepare(e,o);if(t){if(r.mainstay.tracer.value(r,"prepare",e,t.value),t.errors)return u.finalize(t.value,[].concat(t.errors),o);e=t.value}}if(l.coerce&&void 0!==e&&i.convert&&(!l.coerce.from||l.coerce.from.includes(typeof e))){const t=l.coerce.method(e,o);if(t){if(r.mainstay.tracer.value(r,"coerced",e,t.value),t.errors)return u.finalize(t.value,[].concat(t.errors),o);e=t.value}}const c=t._flags.empty;c&&c.$_match(u.trim(e,t),r.nest(c),a.defaults)&&(r.mainstay.tracer.value(r,"empty",e,void 0),e=void 0);const h=n.presence||t._flags.presence||(t._flags._endedSwitch?null:i.presence);if(void 0===e){if("forbidden"===h)return u.finalize(e,null,o);if("required"===h)return u.finalize(e,[t.$_createError("any.required",e,null,r,i)],o);if("optional"===h){if(t._flags.default!==a.symbols.deepDefault)return u.finalize(e,null,o);r.mainstay.tracer.value(r,"default",e,{}),e={}}}else if("forbidden"===h)return u.finalize(e,[t.$_createError("any.unknown",e,null,r,i)],o);const d=[];if(t._valids){const n=t._valids.get(e,r,i,t._flags.insensitive);if(n)return i.convert&&(r.mainstay.tracer.value(r,"valids",e,n.value),e=n.value),r.mainstay.tracer.filter(t,r,"valid",n),u.finalize(e,null,o);if(t._flags.only){const n=t.$_createError("any.only",e,{valids:t._valids.values({display:!0})},r,i);if(i.abortEarly)return u.finalize(e,[n],o);d.push(n)}}if(t._invalids){const n=t._invalids.get(e,r,i,t._flags.insensitive);if(n){r.mainstay.tracer.filter(t,r,"invalid",n);const s=t.$_createError("any.invalid",e,{invalids:t._invalids.values({display:!0})},r,i);if(i.abortEarly)return u.finalize(e,[s],o);d.push(s)}}if(l.validate){const t=l.validate(e,o);if(t&&(r.mainstay.tracer.value(r,"base",e,t.value),e=t.value,t.errors)){if(!Array.isArray(t.errors))return d.push(t.errors),u.finalize(e,d,o);if(t.errors.length)return d.push(...t.errors),u.finalize(e,d,o)}}return t._rules.length?u.rules(e,d,o):u.finalize(e,d,o)},u.rules=function(e,t,r){const{schema:i,state:n,prefs:s}=r;for(const o of i._rules){const l=i._definition.rules[o.method];if(l.convert&&s.convert){n.mainstay.tracer.log(i,n,"rule",o.name,"full");continue}let c,h=o.args;if(o._resolve.length){h=Object.assign({},h);for(const t of o._resolve){const r=l.argsByName.get(t),o=h[t].resolve(e,n,s),u=r.normalize?r.normalize(o):o,d=a.validateArg(u,null,r);if(d){c=i.$_createError("any.ref",o,{arg:t,ref:h[t],reason:d},n,s);break}h[t]=u}}c=c||l.validate(e,r,h,o);const d=u.rule(c,o);if(d.errors){if(n.mainstay.tracer.log(i,n,"rule",o.name,"error"),o.warn){n.mainstay.warnings.push(...d.errors);continue}if(s.abortEarly)return u.finalize(e,d.errors,r);t.push(...d.errors)}else n.mainstay.tracer.log(i,n,"rule",o.name,"pass"),n.mainstay.tracer.value(n,"rule",e,d.value,o.name),e=d.value}return u.finalize(e,t,r)},u.rule=function(e,t){return e instanceof l.Report?(u.error(e,t),{errors:[e],value:null}):Array.isArray(e)&&e[a.symbols.errors]?(e.forEach((e=>u.error(e,t))),{errors:e,value:null}):{errors:null,value:e}},u.error=function(e,t){return t.message&&e._setTemplate(t.message),e},u.finalize=function(e,t,r){t=t||[];const{schema:n,state:s,prefs:o}=r;if(t.length){const i=u.default("failover",void 0,t,r);void 0!==i&&(s.mainstay.tracer.value(s,"failover",e,i),e=i,t=[])}if(t.length&&n._flags.error)if("function"==typeof n._flags.error){t=n._flags.error(t),Array.isArray(t)||(t=[t]);for(const e of t)i(e instanceof Error||e instanceof l.Report,"error() must return an Error object")}else t=[n._flags.error];if(void 0===e){const i=u.default("default",e,t,r);s.mainstay.tracer.value(s,"default",e,i),e=i}if(n._flags.cast&&void 0!==e){const t=n._definition.cast[n._flags.cast];if(t.from(e)){const i=t.to(e,r);s.mainstay.tracer.value(s,"cast",e,i,n._flags.cast),e=i}}if(n.$_terms.externals&&o.externals&&!1!==o._externals)for(const{method:e}of n.$_terms.externals)s.mainstay.externals.push({method:e,path:s.path,label:l.label(n._flags,s,o)});const a={value:e,errors:t.length?t:null};return n._flags.result&&(a.value="strip"===n._flags.result?void 0:r.original,s.mainstay.tracer.value(s,n._flags.result,e,a.value),s.shadow(e,n._flags.result)),n._cache&&!1!==o.cache&&!n._refs.length&&n._cache.set(r.original,a),void 0===e||a.errors||void 0===n._flags.artifact||(s.mainstay.artifacts=s.mainstay.artifacts||new Map,s.mainstay.artifacts.has(n._flags.artifact)||s.mainstay.artifacts.set(n._flags.artifact,[]),s.mainstay.artifacts.get(n._flags.artifact).push(s.path)),a},u.prefs=function(e,t){const r=t===a.defaults;return r&&e._preferences[a.symbols.prefs]?e._preferences[a.symbols.prefs]:(t=a.preferences(t,e._preferences),r&&(e._preferences[a.symbols.prefs]=t),t)},u.default=function(e,t,r,i){const{schema:s,state:o,prefs:l}=i,c=s._flags[e];if(l.noDefaults||void 0===c)return t;if(o.mainstay.tracer.log(s,o,"rule",e,"full"),!c)return c;if("function"==typeof c){const t=c.length?[n(o.ancestors[0]),i]:[];try{return c(...t)}catch(t){return void r.push(s.$_createError("any.".concat(e),null,{error:t},o,l))}}return"object"!=typeof c?c:c[a.symbols.literal]?c.literal:a.isResolvable(c)?c.resolve(t,o,l):n(c)},u.trim=function(e,t){if("string"!=typeof e)return e;const r=t.$_getRule("trim");return r&&r.args.enabled?e.trim():e},u.ignore={active:!1,debug:s,entry:s,filter:s,log:s,resolve:s,value:s},u.errorsArray=function(){const e=[];return e[a.symbols.errors]=!0,e}},2036:(e,t,r)=>{const i=r(375),n=r(9474),s=r(8160),o={};e.exports=o.Values=class{constructor(e,t){this._values=new Set(e),this._refs=new Set(t),this._lowercase=o.lowercases(e),this._override=!1}get length(){return this._values.size+this._refs.size}add(e,t){s.isResolvable(e)?this._refs.has(e)||(this._refs.add(e),t&&t.register(e)):this.has(e,null,null,!1)||(this._values.add(e),"string"==typeof e&&this._lowercase.set(e.toLowerCase(),e))}static merge(e,t,r){if(e=e||new o.Values,t){if(t._override)return t.clone();for(const r of[...t._values,...t._refs])e.add(r)}if(r)for(const t of[...r._values,...r._refs])e.remove(t);return e.length?e:null}remove(e){s.isResolvable(e)?this._refs.delete(e):(this._values.delete(e),"string"==typeof e&&this._lowercase.delete(e.toLowerCase()))}has(e,t,r,i){return!!this.get(e,t,r,i)}get(e,t,r,i){if(!this.length)return!1;if(this._values.has(e))return{value:e};if("string"==typeof e&&e&&i){const t=this._lowercase.get(e.toLowerCase());if(t)return{value:t}}if(!this._refs.size&&"object"!=typeof e)return!1;if("object"==typeof e)for(const t of this._values)if(n(t,e))return{value:t};if(t)for(const s of this._refs){const o=s.resolve(e,t,r,null,{in:!0});if(void 0===o)continue;const a=s.in&&"object"==typeof o?Array.isArray(o)?o:Object.keys(o):[o];for(const t of a)if(typeof t==typeof e)if(i&&e&&"string"==typeof e){if(t.toLowerCase()===e.toLowerCase())return{value:t,ref:s}}else if(n(t,e))return{value:t,ref:s}}return!1}override(){this._override=!0}values(e){if(e&&e.display){const e=[];for(const t of[...this._values,...this._refs])void 0!==t&&e.push(t);return e}return Array.from([...this._values,...this._refs])}clone(){const e=new o.Values(this._values,this._refs);return e._override=this._override,e}concat(e){i(!e._override,"Cannot concat override set of values");const t=new o.Values([...this._values,...e._values],[...this._refs,...e._refs]);return t._override=this._override,t}describe(){const e=[];this._override&&e.push({override:!0});for(const t of this._values.values())e.push(t&&"object"==typeof t?{value:t}:t);for(const t of this._refs.values())e.push(t.describe());return e}},o.Values.prototype[s.symbols.values]=!0,o.Values.prototype.slice=o.Values.prototype.clone,o.lowercases=function(e){const t=new Map;if(e)for(const r of e)"string"==typeof r&&t.set(r.toLowerCase(),r);return t}},978:(e,t,r)=>{const i=r(375),n=r(8571),s=r(1687),o=r(9621),a={};e.exports=function(e,t,r={}){if(i(e&&"object"==typeof e,"Invalid defaults value: must be an object"),i(!t||!0===t||"object"==typeof t,"Invalid source value: must be true, falsy or an object"),i("object"==typeof r,"Invalid options: must be an object"),!t)return null;if(r.shallow)return a.applyToDefaultsWithShallow(e,t,r);const o=n(e);if(!0===t)return o;const l=void 0!==r.nullOverride&&r.nullOverride;return s(o,t,{nullOverride:l,mergeArrays:!1})},a.applyToDefaultsWithShallow=function(e,t,r){const l=r.shallow;i(Array.isArray(l),"Invalid keys");const c=new Map,u=!0===t?null:new Set;for(let r of l){r=Array.isArray(r)?r:r.split(".");const i=o(e,r);i&&"object"==typeof i?c.set(i,u&&o(t,r)||i):u&&u.add(r)}const h=n(e,{},c);if(!u)return h;for(const e of u)a.reachCopy(h,t,e);const d=void 0!==r.nullOverride&&r.nullOverride;return s(h,t,{nullOverride:d,mergeArrays:!1})},a.reachCopy=function(e,t,r){for(const e of r){if(!(e in t))return;const r=t[e];if("object"!=typeof r||null===r)return;t=r}const i=t;let n=e;for(let e=0;e<r.length-1;++e){const t=r[e];"object"!=typeof n[t]&&(n[t]={}),n=n[t]}n[r[r.length-1]]=i}},375:(e,t,r)=>{const i=r(7916);e.exports=function(e,...t){if(!e){if(1===t.length&&t[0]instanceof Error)throw t[0];throw new i(t)}}},8571:(e,t,r)=>{const i=r(9621),n=r(4277),s=r(7043),o={needsProtoHack:new Set([n.set,n.map,n.weakSet,n.weakMap])};e.exports=o.clone=function(e,t={},r=null){if("object"!=typeof e||null===e)return e;let i=o.clone,a=r;if(t.shallow){if(!0!==t.shallow)return o.cloneWithShallow(e,t);i=e=>e}else if(a){const t=a.get(e);if(t)return t}else a=new Map;const l=n.getInternalProto(e);if(l===n.buffer)return!1;if(l===n.date)return new Date(e.getTime());if(l===n.regex)return new RegExp(e);const c=o.base(e,l,t);if(c===e)return e;if(a&&a.set(e,c),l===n.set)for(const r of e)c.add(i(r,t,a));else if(l===n.map)for(const[r,n]of e)c.set(r,i(n,t,a));const u=s.keys(e,t);for(const r of u){if("__proto__"===r)continue;if(l===n.array&&"length"===r){c.length=e.length;continue}const s=Object.getOwnPropertyDescriptor(e,r);s?s.get||s.set?Object.defineProperty(c,r,s):s.enumerable?c[r]=i(e[r],t,a):Object.defineProperty(c,r,{enumerable:!1,writable:!0,configurable:!0,value:i(e[r],t,a)}):Object.defineProperty(c,r,{enumerable:!0,writable:!0,configurable:!0,value:i(e[r],t,a)})}return c},o.cloneWithShallow=function(e,t){const r=t.shallow;(t=Object.assign({},t)).shallow=!1;const n=new Map;for(const t of r){const r=i(e,t);"object"!=typeof r&&"function"!=typeof r||n.set(r,r)}return o.clone(e,t,n)},o.base=function(e,t,r){if(!1===r.prototype)return o.needsProtoHack.has(t)?new t.constructor:t===n.array?[]:{};const i=Object.getPrototypeOf(e);if(i&&i.isImmutable)return e;if(t===n.array){const e=[];return i!==t&&Object.setPrototypeOf(e,i),e}if(o.needsProtoHack.has(t)){const e=new i.constructor;return i!==t&&Object.setPrototypeOf(e,i),e}return Object.create(i)}},9474:(e,t,r)=>{const i=r(4277),n={mismatched:null};e.exports=function(e,t,r){return r=Object.assign({prototype:!0},r),!!n.isDeepEqual(e,t,r,[])},n.isDeepEqual=function(e,t,r,s){if(e===t)return 0!==e||1/e==1/t;const o=typeof e;if(o!==typeof t)return!1;if(null===e||null===t)return!1;if("function"===o){if(!r.deepFunction||e.toString()!==t.toString())return!1}else if("object"!==o)return e!=e&&t!=t;const a=n.getSharedType(e,t,!!r.prototype);switch(a){case i.buffer:return!1;case i.promise:return e===t;case i.regex:return e.toString()===t.toString();case n.mismatched:return!1}for(let r=s.length-1;r>=0;--r)if(s[r].isSame(e,t))return!0;s.push(new n.SeenEntry(e,t));try{return!!n.isDeepEqualObj(a,e,t,r,s)}finally{s.pop()}},n.getSharedType=function(e,t,r){if(r)return Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?n.mismatched:i.getInternalProto(e);const s=i.getInternalProto(e);return s!==i.getInternalProto(t)?n.mismatched:s},n.valueOf=function(e){const t=e.valueOf;if(void 0===t)return e;try{return t.call(e)}catch(e){return e}},n.hasOwnEnumerableProperty=function(e,t){return Object.prototype.propertyIsEnumerable.call(e,t)},n.isSetSimpleEqual=function(e,t){for(const r of Set.prototype.values.call(e))if(!Set.prototype.has.call(t,r))return!1;return!0},n.isDeepEqualObj=function(e,t,r,s,o){const{isDeepEqual:a,valueOf:l,hasOwnEnumerableProperty:c}=n,{keys:u,getOwnPropertySymbols:h}=Object;if(e===i.array){if(!s.part){if(t.length!==r.length)return!1;for(let e=0;e<t.length;++e)if(!a(t[e],r[e],s,o))return!1;return!0}for(const e of t)for(const t of r)if(a(e,t,s,o))return!0}else if(e===i.set){if(t.size!==r.size)return!1;if(!n.isSetSimpleEqual(t,r)){const e=new Set(Set.prototype.values.call(r));for(const r of Set.prototype.values.call(t)){if(e.delete(r))continue;let t=!1;for(const i of e)if(a(r,i,s,o)){e.delete(i),t=!0;break}if(!t)return!1}}}else if(e===i.map){if(t.size!==r.size)return!1;for(const[e,i]of Map.prototype.entries.call(t)){if(void 0===i&&!Map.prototype.has.call(r,e))return!1;if(!a(i,Map.prototype.get.call(r,e),s,o))return!1}}else if(e===i.error&&(t.name!==r.name||t.message!==r.message))return!1;const d=l(t),f=l(r);if((t!==d||r!==f)&&!a(d,f,s,o))return!1;const p=u(t);if(!s.part&&p.length!==u(r).length&&!s.skip)return!1;let m=0;for(const e of p)if(s.skip&&s.skip.includes(e))void 0===r[e]&&++m;else{if(!c(r,e))return!1;if(!a(t[e],r[e],s,o))return!1}if(!s.part&&p.length-m!==u(r).length)return!1;if(!1!==s.symbols){const e=h(t),i=new Set(h(r));for(const n of e){if(!s.skip||!s.skip.includes(n))if(c(t,n)){if(!c(r,n))return!1;if(!a(t[n],r[n],s,o))return!1}else if(c(r,n))return!1;i.delete(n)}for(const e of i)if(c(r,e))return!1}return!0},n.SeenEntry=class{constructor(e,t){this.obj=e,this.ref=t}isSame(e,t){return this.obj===e&&this.ref===t}}},7916:(e,t,r)=>{const i=r(8761);e.exports=class extends Error{constructor(e){super(e.filter((e=>""!==e)).map((e=>"string"==typeof e?e:e instanceof Error?e.message:i(e))).join(" ")||"Unknown error"),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t.assert)}}},5277:e=>{const t={};e.exports=function(e){if(!e)return"";let r="";for(let i=0;i<e.length;++i){const n=e.charCodeAt(i);t.isSafe(n)?r+=e[i]:r+=t.escapeHtmlChar(n)}return r},t.escapeHtmlChar=function(e){const r=t.namedHtml[e];if(void 0!==r)return r;if(e>=256)return"&#"+e+";";const i=e.toString(16).padStart(2,"0");return"&#x".concat(i,";")},t.isSafe=function(e){return void 0!==t.safeCharCodes[e]},t.namedHtml={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",160:"&nbsp;",162:"&cent;",163:"&pound;",164:"&curren;",169:"&copy;",174:"&reg;"},t.safeCharCodes=function(){const e={};for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&(e[t]=null);return e}()},6064:e=>{e.exports=function(e){return e.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")}},738:e=>{e.exports=function(){}},1687:(e,t,r)=>{const i=r(375),n=r(8571),s=r(7043),o={};e.exports=o.merge=function(e,t,r){if(i(e&&"object"==typeof e,"Invalid target value: must be an object"),i(null==t||"object"==typeof t,"Invalid source value: must be null, undefined, or an object"),!t)return e;if(r=Object.assign({nullOverride:!0,mergeArrays:!0},r),Array.isArray(t)){i(Array.isArray(e),"Cannot merge array onto an object"),r.mergeArrays||(e.length=0);for(let i=0;i<t.length;++i)e.push(n(t[i],{symbols:r.symbols}));return e}const a=s.keys(t,r);for(let i=0;i<a.length;++i){const s=a[i];if("__proto__"===s||!Object.prototype.propertyIsEnumerable.call(t,s))continue;const l=t[s];if(l&&"object"==typeof l){if(e[s]===l)continue;!e[s]||"object"!=typeof e[s]||Array.isArray(e[s])!==Array.isArray(l)||l instanceof Date||l instanceof RegExp?e[s]=n(l,{symbols:r.symbols}):o.merge(e[s],l,r)}else(null!=l||r.nullOverride)&&(e[s]=l)}return e}},9621:(e,t,r)=>{const i=r(375),n={};e.exports=function(e,t,r){if(!1===t||null==t)return e;"string"==typeof(r=r||{})&&(r={separator:r});const s=Array.isArray(t);i(!s||!r.separator,"Separator option no valid for array-based chain");const o=s?t:t.split(r.separator||".");let a=e;for(let e=0;e<o.length;++e){let s=o[e];const l=r.iterables&&n.iterables(a);if(Array.isArray(a)||"set"===l){const e=Number(s);Number.isInteger(e)&&(s=e<0?a.length+e:e)}if(!a||"function"==typeof a&&!1===r.functions||!l&&void 0===a[s]){i(!r.strict||e+1===o.length,"Missing segment",s,"in reach path ",t),i("object"==typeof a||!0===r.functions||"function"!=typeof a,"Invalid segment",s,"in reach path ",t),a=r.default;break}a=l?"set"===l?[...a][s]:a.get(s):a[s]}return a},n.iterables=function(e){return e instanceof Set?"set":e instanceof Map?"map":void 0}},8761:e=>{e.exports=function(...e){try{return JSON.stringify.apply(null,e)}catch(e){return"[Cannot display object: "+e.message+"]"}}},4277:(e,t)=>{const r={};t=e.exports={array:Array.prototype,buffer:!1,date:Date.prototype,error:Error.prototype,generic:Object.prototype,map:Map.prototype,promise:Promise.prototype,regex:RegExp.prototype,set:Set.prototype,weakMap:WeakMap.prototype,weakSet:WeakSet.prototype},r.typeMap=new Map([["[object Error]",t.error],["[object Map]",t.map],["[object Promise]",t.promise],["[object Set]",t.set],["[object WeakMap]",t.weakMap],["[object WeakSet]",t.weakSet]]),t.getInternalProto=function(e){if(Array.isArray(e))return t.array;if(e instanceof Date)return t.date;if(e instanceof RegExp)return t.regex;if(e instanceof Error)return t.error;const i=Object.prototype.toString.call(e);return r.typeMap.get(i)||t.generic}},7043:(e,t)=>{t.keys=function(e,t={}){return!1!==t.symbols?Reflect.ownKeys(e):Object.getOwnPropertyNames(e)}},3652:(e,t,r)=>{const i=r(375),n={};t.Sorter=class{constructor(){this._items=[],this.nodes=[]}add(e,t){const r=[].concat((t=t||{}).before||[]),n=[].concat(t.after||[]),s=t.group||"?",o=t.sort||0;i(!r.includes(s),"Item cannot come before itself: ".concat(s)),i(!r.includes("?"),"Item cannot come before unassociated items"),i(!n.includes(s),"Item cannot come after itself: ".concat(s)),i(!n.includes("?"),"Item cannot come after unassociated items"),Array.isArray(e)||(e=[e]);for(const t of e){const e={seq:this._items.length,sort:o,before:r,after:n,group:s,node:t};this._items.push(e)}if(!t.manual){const e=this._sort();i(e,"item","?"!==s?"added into group ".concat(s):"","created a dependencies error")}return this.nodes}merge(e){Array.isArray(e)||(e=[e]);for(const t of e)if(t)for(const e of t._items)this._items.push(Object.assign({},e));this._items.sort(n.mergeSort);for(let e=0;e<this._items.length;++e)this._items[e].seq=e;const t=this._sort();return i(t,"merge created a dependencies error"),this.nodes}sort(){const e=this._sort();return i(e,"sort created a dependencies error"),this.nodes}_sort(){const e={},t=Object.create(null),r=Object.create(null);for(const i of this._items){const n=i.seq,s=i.group;r[s]=r[s]||[],r[s].push(n),e[n]=i.before;for(const e of i.after)t[e]=t[e]||[],t[e].push(n)}for(const t in e){const i=[];for(const n in e[t]){const s=e[t][n];r[s]=r[s]||[],i.push(...r[s])}e[t]=i}for(const i in t)if(r[i])for(const n of r[i])e[n].push(...t[i]);const i={};for(const t in e){const r=e[t];for(const e of r)i[e]=i[e]||[],i[e].push(t)}const n={},s=[];for(let e=0;e<this._items.length;++e){let t=e;if(i[e]){t=null;for(let e=0;e<this._items.length;++e){if(!0===n[e])continue;i[e]||(i[e]=[]);const r=i[e].length;let s=0;for(let t=0;t<r;++t)n[i[e][t]]&&++s;if(s===r){t=e;break}}}null!==t&&(n[t]=!0,s.push(t))}if(s.length!==this._items.length)return!1;const o={};for(const e of this._items)o[e.seq]=e;this._items=[],this.nodes=[];for(const e of s){const t=o[e];this.nodes.push(t.node),this._items.push(t)}return!0}},n.mergeSort=(e,t)=>e.sort===t.sort?0:e.sort<t.sort?-1:1},5380:(e,t,r)=>{const i=r(443),n=r(2178),s={minDomainSegments:2,nonAsciiRx:/[^\x00-\x7f]/,domainControlRx:/[\x00-\x20@\:\/\\#!\$&\'\(\)\*\+,;=\?]/,tldSegmentRx:/^[a-zA-Z](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?$/,domainSegmentRx:/^[a-zA-Z0-9](?:[a-zA-Z0-9\-]*[a-zA-Z0-9])?$/,URL:i.URL||URL};t.analyze=function(e,t={}){if(!e)return n.code("DOMAIN_NON_EMPTY_STRING");if("string"!=typeof e)throw new Error("Invalid input: domain must be a string");if(e.length>256)return n.code("DOMAIN_TOO_LONG");if(s.nonAsciiRx.test(e)){if(!1===t.allowUnicode)return n.code("DOMAIN_INVALID_UNICODE_CHARS");e=e.normalize("NFC")}if(s.domainControlRx.test(e))return n.code("DOMAIN_INVALID_CHARS");e=s.punycode(e),t.allowFullyQualified&&"."===e[e.length-1]&&(e=e.slice(0,-1));const r=t.minDomainSegments||s.minDomainSegments,i=e.split(".");if(i.length<r)return n.code("DOMAIN_SEGMENTS_COUNT");if(t.maxDomainSegments&&i.length>t.maxDomainSegments)return n.code("DOMAIN_SEGMENTS_COUNT_MAX");const o=t.tlds;if(o){const e=i[i.length-1].toLowerCase();if(o.deny&&o.deny.has(e)||o.allow&&!o.allow.has(e))return n.code("DOMAIN_FORBIDDEN_TLDS")}for(let e=0;e<i.length;++e){const t=i[e];if(!t.length)return n.code("DOMAIN_EMPTY_SEGMENT");if(t.length>63)return n.code("DOMAIN_LONG_SEGMENT");if(e<i.length-1){if(!s.domainSegmentRx.test(t))return n.code("DOMAIN_INVALID_CHARS")}else if(!s.tldSegmentRx.test(t))return n.code("DOMAIN_INVALID_TLDS_CHARS")}return null},t.isValid=function(e,r){return!t.analyze(e,r)},s.punycode=function(e){e.includes("%")&&(e=e.replace(/%/g,"%25"));try{return new s.URL("http://".concat(e)).host}catch(t){return e}}},1745:(e,t,r)=>{const i=r(9848),n=r(5380),s=r(2178),o={nonAsciiRx:/[^\x00-\x7f]/,encoder:new(i.TextEncoder||TextEncoder)};t.analyze=function(e,t){return o.email(e,t)},t.isValid=function(e,t){return!o.email(e,t)},o.email=function(e,t={}){if("string"!=typeof e)throw new Error("Invalid input: email must be a string");if(!e)return s.code("EMPTY_STRING");const r=!o.nonAsciiRx.test(e);if(!r){if(!1===t.allowUnicode)return s.code("FORBIDDEN_UNICODE");e=e.normalize("NFC")}const i=e.split("@");if(2!==i.length)return i.length>2?s.code("MULTIPLE_AT_CHAR"):s.code("MISSING_AT_CHAR");const[a,l]=i;if(!a)return s.code("EMPTY_LOCAL");if(!t.ignoreLength){if(e.length>254)return s.code("ADDRESS_TOO_LONG");if(o.encoder.encode(a).length>64)return s.code("LOCAL_TOO_LONG")}return o.local(a,r)||n.analyze(l,t)},o.local=function(e,t){const r=e.split(".");for(const e of r){if(!e.length)return s.code("EMPTY_LOCAL_SEGMENT");if(t){if(!o.atextRx.test(e))return s.code("INVALID_LOCAL_CHARS")}else for(const t of e){if(o.atextRx.test(t))continue;const e=o.binary(t);if(!o.atomRx.test(e))return s.code("INVALID_LOCAL_CHARS")}}},o.binary=function(e){return Array.from(o.encoder.encode(e)).map((e=>String.fromCharCode(e))).join("")},o.atextRx=/^[\w!#\$%&'\*\+\-/=\?\^`\{\|\}~]+$/,o.atomRx=new RegExp(["(?:[\\xc2-\\xdf][\\x80-\\xbf])","(?:\\xe0[\\xa0-\\xbf][\\x80-\\xbf])|(?:[\\xe1-\\xec][\\x80-\\xbf]{2})|(?:\\xed[\\x80-\\x9f][\\x80-\\xbf])|(?:[\\xee-\\xef][\\x80-\\xbf]{2})","(?:\\xf0[\\x90-\\xbf][\\x80-\\xbf]{2})|(?:[\\xf1-\\xf3][\\x80-\\xbf]{3})|(?:\\xf4[\\x80-\\x8f][\\x80-\\xbf]{2})"].join("|"))},2178:(e,t)=>{t.codes={EMPTY_STRING:"Address must be a non-empty string",FORBIDDEN_UNICODE:"Address contains forbidden Unicode characters",MULTIPLE_AT_CHAR:"Address cannot contain more than one @ character",MISSING_AT_CHAR:"Address must contain one @ character",EMPTY_LOCAL:"Address local part cannot be empty",ADDRESS_TOO_LONG:"Address too long",LOCAL_TOO_LONG:"Address local part too long",EMPTY_LOCAL_SEGMENT:"Address local part contains empty dot-separated segment",INVALID_LOCAL_CHARS:"Address local part contains invalid character",DOMAIN_NON_EMPTY_STRING:"Domain must be a non-empty string",DOMAIN_TOO_LONG:"Domain too long",DOMAIN_INVALID_UNICODE_CHARS:"Domain contains forbidden Unicode characters",DOMAIN_INVALID_CHARS:"Domain contains invalid character",DOMAIN_INVALID_TLDS_CHARS:"Domain contains invalid tld character",DOMAIN_SEGMENTS_COUNT:"Domain lacks the minimum required number of segments",DOMAIN_SEGMENTS_COUNT_MAX:"Domain contains too many segments",DOMAIN_FORBIDDEN_TLDS:"Domain uses forbidden TLD",DOMAIN_EMPTY_SEGMENT:"Domain contains empty dot-separated segment",DOMAIN_LONG_SEGMENT:"Domain contains dot-separated segment that is too long"},t.code=function(e){return{code:e,error:t.codes[e]}}},9959:(e,t,r)=>{const i=r(375),n=r(5752);t.regex=function(e={}){i(void 0===e.cidr||"string"==typeof e.cidr,"options.cidr must be a string");const t=e.cidr?e.cidr.toLowerCase():"optional";i(["required","optional","forbidden"].includes(t),"options.cidr must be one of required, optional, forbidden"),i(void 0===e.version||"string"==typeof e.version||Array.isArray(e.version),"options.version must be a string or an array of string");let r=e.version||["ipv4","ipv6","ipvfuture"];Array.isArray(r)||(r=[r]),i(r.length>=1,"options.version must have at least 1 version specified");for(let e=0;e<r.length;++e)i("string"==typeof r[e],"options.version must only contain strings"),r[e]=r[e].toLowerCase(),i(["ipv4","ipv6","ipvfuture"].includes(r[e]),"options.version contains unknown version "+r[e]+" - must be one of ipv4, ipv6, ipvfuture");r=Array.from(new Set(r));const s=r.map((e=>{if("forbidden"===t)return n.ip[e];const r="\\/".concat("ipv4"===e?n.ip.v4Cidr:n.ip.v6Cidr);return"required"===t?"".concat(n.ip[e]).concat(r):"".concat(n.ip[e],"(?:").concat(r,")?")})),o="(?:".concat(s.join("|"),")"),a=new RegExp("^".concat(o,"$"));return{cidr:t,versions:r,regex:a,raw:o}}},5752:(e,t,r)=>{const i=r(375),n=r(6064),s={generate:function(){const e={},t="!\\$&'\\(\\)\\*\\+,;=",r="\\w-\\.~%\\dA-Fa-f"+t+":@",i="["+r+"]",n="(?:0{0,2}\\d|0?[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";e.ipv4address="(?:"+n+"\\.){3}"+n;const s="[\\dA-Fa-f]{1,4}",o="(?:"+s+":"+s+"|"+e.ipv4address+")",a="(?:"+s+":){6}"+o,l="::(?:"+s+":){5}"+o,c="(?:"+s+")?::(?:"+s+":){4}"+o,u="(?:(?:"+s+":){0,1}"+s+")?::(?:"+s+":){3}"+o,h="(?:(?:"+s+":){0,2}"+s+")?::(?:"+s+":){2}"+o,d="(?:(?:"+s+":){0,3}"+s+")?::"+s+":"+o,f="(?:(?:"+s+":){0,4}"+s+")?::"+o;e.ipv4Cidr="(?:\\d|[1-2]\\d|3[0-2])",e.ipv6Cidr="(?:0{0,2}\\d|0?[1-9]\\d|1[01]\\d|12[0-8])",e.ipv6address="(?:"+a+"|"+l+"|"+c+"|"+u+"|"+h+"|"+d+"|"+f+"|(?:(?:[\\dA-Fa-f]{1,4}:){0,5}[\\dA-Fa-f]{1,4})?::[\\dA-Fa-f]{1,4}|(?:(?:[\\dA-Fa-f]{1,4}:){0,6}[\\dA-Fa-f]{1,4})?::)",e.ipvFuture="v[\\dA-Fa-f]+\\.[\\w-\\.~"+t+":]+",e.scheme="[a-zA-Z][a-zA-Z\\d+-\\.]*",e.schemeRegex=new RegExp(e.scheme);const p="[\\w-\\.~%\\dA-Fa-f"+t+":]*",m="(?:\\[(?:"+e.ipv6address+"|"+e.ipvFuture+")\\]|"+e.ipv4address+"|[\\w-\\.~%\\dA-Fa-f!\\$&'\\(\\)\\*\\+,;=]{1,255})",g="(?:"+p+"@)?"+m+"(?::\\d*)?",v="(?:"+p+"@)?("+m+")(?::\\d*)?",_=i+"+",b="(?:\\/[\\w-\\.~%\\dA-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]*)*",y="\\/(?:"+_+b+")?",E=_+b,w="[\\w-\\.~%\\dA-Fa-f!\\$&'\\(\\)\\*\\+,;=@]+"+b;return e.hierPart="(?:(?:\\/\\/"+g+b+")|"+y+"|"+E+"|(?:\\/\\/\\/[\\w-\\.~%\\dA-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]*(?:\\/[\\w-\\.~%\\dA-Fa-f!\\$&'\\(\\)\\*\\+,;=:@]*)*))",e.hierPartCapture="(?:(?:\\/\\/"+v+b+")|"+y+"|"+E+")",e.relativeRef="(?:(?:\\/\\/"+g+b+")|"+y+"|"+w+"|)",e.relativeRefCapture="(?:(?:\\/\\/"+v+b+")|"+y+"|"+w+"|)",e.query="["+r+"\\/\\?]*(?=#|$)",e.queryWithSquareBrackets="["+r+"\\[\\]\\/\\?]*(?=#|$)",e.fragment="["+r+"\\/\\?]*",e}};s.rfc3986=s.generate(),t.ip={v4Cidr:s.rfc3986.ipv4Cidr,v6Cidr:s.rfc3986.ipv6Cidr,ipv4:s.rfc3986.ipv4address,ipv6:s.rfc3986.ipv6address,ipvfuture:s.rfc3986.ipvFuture},s.createRegex=function(e){const t=s.rfc3986,r="(?:\\?"+(e.allowQuerySquareBrackets?t.queryWithSquareBrackets:t.query)+")?(?:#"+t.fragment+")?",o=e.domain?t.relativeRefCapture:t.relativeRef;if(e.relativeOnly)return s.wrap(o+r);let a="";if(e.scheme){i(e.scheme instanceof RegExp||"string"==typeof e.scheme||Array.isArray(e.scheme),"scheme must be a RegExp, String, or Array");const r=[].concat(e.scheme);i(r.length>=1,"scheme must have at least 1 scheme specified");const s=[];for(let e=0;e<r.length;++e){const o=r[e];i(o instanceof RegExp||"string"==typeof o,"scheme at position "+e+" must be a RegExp or String"),o instanceof RegExp?s.push(o.source.toString()):(i(t.schemeRegex.test(o),"scheme at position "+e+" must be a valid scheme"),s.push(n(o)))}a=s.join("|")}const l="(?:"+(a?"(?:"+a+")":t.scheme)+":"+(e.domain?t.hierPartCapture:t.hierPart)+")",c=e.allowRelative?"(?:"+l+"|"+o+")":l;return s.wrap(c+r,a)},s.wrap=function(e,t){return{raw:e="(?=.)(?!https?:/(?:$|[^/]))(?!https?:///)(?!https?:[^/])".concat(e),regex:new RegExp("^".concat(e,"$")),scheme:t}},s.uriRegex=s.createRegex({}),t.regex=function(e={}){return e.scheme||e.allowRelative||e.relativeOnly||e.allowQuerySquareBrackets||e.domain?s.createRegex(e):s.uriRegex}},1447:(e,t)=>{const r={operators:["!","^","*","/","%","+","-","<","<=",">",">=","==","!=","&&","||","??"],operatorCharacters:["!","^","*","/","%","+","-","<","=",">","&","|","?"],operatorsOrder:[["^"],["*","/","%"],["+","-"],["<","<=",">",">="],["==","!="],["&&"],["||","??"]],operatorsPrefix:["!","n"],literals:{'"':'"',"`":"`","'":"'","[":"]"},numberRx:/^(?:[0-9]*\.?[0-9]*){1}$/,tokenRx:/^[\w\$\#\.\@\:\{\}]+$/,symbol:Symbol("formula"),settings:Symbol("settings")};t.Parser=class{constructor(e,t={}){if(!t[r.settings]&&t.constants)for(const e in t.constants){const r=t.constants[e];if(null!==r&&!["boolean","number","string"].includes(typeof r))throw new Error("Formula constant ".concat(e," contains invalid ").concat(typeof r," value type"))}this.settings=t[r.settings]?t:Object.assign({[r.settings]:!0,constants:{},functions:{}},t),this.single=null,this._parts=null,this._parse(e)}_parse(e){let i=[],n="",s=0,o=!1;const a=e=>{if(s)throw new Error("Formula missing closing parenthesis");const a=i.length?i[i.length-1]:null;if(o||n||e){if(a&&"reference"===a.type&&")"===e)return a.type="function",a.value=this._subFormula(n,a.value),void(n="");if(")"===e){const e=new t.Parser(n,this.settings);i.push({type:"segment",value:e})}else if(o){if("]"===o)return i.push({type:"reference",value:n}),void(n="");i.push({type:"literal",value:n})}else if(r.operatorCharacters.includes(n))a&&"operator"===a.type&&r.operators.includes(a.value+n)?a.value+=n:i.push({type:"operator",value:n});else if(n.match(r.numberRx))i.push({type:"constant",value:parseFloat(n)});else if(void 0!==this.settings.constants[n])i.push({type:"constant",value:this.settings.constants[n]});else{if(!n.match(r.tokenRx))throw new Error("Formula contains invalid token: ".concat(n));i.push({type:"reference",value:n})}n=""}};for(const t of e)o?t===o?(a(),o=!1):n+=t:s?"("===t?(n+=t,++s):")"===t?(--s,s?n+=t:a(t)):n+=t:t in r.literals?o=r.literals[t]:"("===t?(a(),++s):r.operatorCharacters.includes(t)?(a(),n=t,a()):" "!==t?n+=t:a();a(),i=i.map(((e,t)=>"operator"!==e.type||"-"!==e.value||t&&"operator"!==i[t-1].type?e:{type:"operator",value:"n"}));let l=!1;for(const e of i){if("operator"===e.type){if(r.operatorsPrefix.includes(e.value))continue;if(!l)throw new Error("Formula contains an operator in invalid position");if(!r.operators.includes(e.value))throw new Error("Formula contains an unknown operator ".concat(e.value))}else if(l)throw new Error("Formula missing expected operator");l=!l}if(!l)throw new Error("Formula contains invalid trailing operator");1===i.length&&["reference","literal","constant"].includes(i[0].type)&&(this.single={type:"reference"===i[0].type?"reference":"value",value:i[0].value}),this._parts=i.map((e=>{if("operator"===e.type)return r.operatorsPrefix.includes(e.value)?e:e.value;if("reference"!==e.type)return e.value;if(this.settings.tokenRx&&!this.settings.tokenRx.test(e.value))throw new Error("Formula contains invalid reference ".concat(e.value));return this.settings.reference?this.settings.reference(e.value):r.reference(e.value)}))}_subFormula(e,i){const n=this.settings.functions[i];if("function"!=typeof n)throw new Error("Formula contains unknown function ".concat(i));let s=[];if(e){let t="",n=0,o=!1;const a=()=>{if(!t)throw new Error("Formula contains function ".concat(i," with invalid arguments ").concat(e));s.push(t),t=""};for(let i=0;i<e.length;++i){const s=e[i];o?(t+=s,s===o&&(o=!1)):s in r.literals&&!n?(t+=s,o=r.literals[s]):","!==s||n?(t+=s,"("===s?++n:")"===s&&--n):a()}a()}return s=s.map((e=>new t.Parser(e,this.settings))),function(e){const t=[];for(const r of s)t.push(r.evaluate(e));return n.call(e,...t)}}evaluate(e){const t=this._parts.slice();for(let i=t.length-2;i>=0;--i){const n=t[i];if(n&&"operator"===n.type){const s=t[i+1];t.splice(i+1,1);const o=r.evaluate(s,e);t[i]=r.single(n.value,o)}}return r.operatorsOrder.forEach((i=>{for(let n=1;n<t.length-1;)if(i.includes(t[n])){const i=t[n],s=r.evaluate(t[n-1],e),o=r.evaluate(t[n+1],e);t.splice(n,2);const a=r.calculate(i,s,o);t[n-1]=0===a?0:a}else n+=2})),r.evaluate(t[0],e)}},t.Parser.prototype[r.symbol]=!0,r.reference=function(e){return function(t){return t&&void 0!==t[e]?t[e]:null}},r.evaluate=function(e,t){return null===e?null:"function"==typeof e?e(t):e[r.symbol]?e.evaluate(t):e},r.single=function(e,t){if("!"===e)return!t;const r=-t;return 0===r?0:r},r.calculate=function(e,t,i){if("??"===e)return r.exists(t)?t:i;if("string"==typeof t||"string"==typeof i){if("+"===e)return(t=r.exists(t)?t:"")+(r.exists(i)?i:"")}else switch(e){case"^":return Math.pow(t,i);case"*":return t*i;case"/":return t/i;case"%":return t%i;case"+":return t+i;case"-":return t-i}switch(e){case"<":return t<i;case"<=":return t<=i;case">":return t>i;case">=":return t>=i;case"==":return t===i;case"!=":return t!==i;case"&&":return t&&i;case"||":return t||i}return null},r.exists=function(e){return null!=e}},9926:()=>{},5688:()=>{},9708:()=>{},1152:()=>{},443:()=>{},9848:()=>{}},i={},function e(t){var n=i[t];if(void 0!==n)return n.exports;var s=i[t]={exports:{}};return r[t](s,s.exports,e),s.exports}(5107))})),s.register("kFbIr",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Defaults=void 0;e.exports.Defaults=()=>({build_date:"",build_version:"",settings_version:"2.0",ar:{enableCameraSync:!1,enableCameraSyncInitial:!1,enableLightingEstimation:!0,enableTouchControls:!0,enableTouchControlRotation:!0,enableAutomaticPlacement:!0,defaultHitTestType:"existingPlaneUsingGeometry"},defaultMaterial:{bumpAmplitude:1,color:"#d3d3d3",metalness:0,roughness:1},parameters:{controlOrder:[],controlNames:{},parametersHidden:[]},viewer:{blurSceneWhenBusy:!0,ignoreSuperseded:!0,loggingLevel:-1,messageLoggingLevel:-1,showMessages:!0,hasRestoredSettings:!1,useModelSettings:!1,commitParameters:!1,commitSettings:!1,viewerRuntimeId:"",scene:{show:!1,showSceneTransition:"1s",camera:{autoAdjust:!1,cameraMovementDuration:800,cameraTypes:{perspective:{default:{position:{x:0,y:0,z:0},target:{x:0,y:0,z:0}},fov:45,controls:0},orthographic:{default:{position:{x:0,y:0,z:0},target:{x:0,y:0,z:0}}},active:0},controls:{orbit:{autoRotationSpeed:0,damping:.1,enableAutoRotation:!1,enableKeyPan:!1,enablePan:!0,enableRotation:!0,enableZoom:!0,input:{keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:1,zoom:2,pan:3}},keyPanSpeed:.5,movementSmoothness:.5,restrictions:{position:{cube:{min:{x:-1/0,y:-1/0,z:-1/0},max:{x:1/0,y:1/0,z:1/0}},sphere:{center:{x:0,y:0,z:0},radius:1/0}},target:{cube:{min:{x:-1/0,y:-1/0,z:-1/0},max:{x:1/0,y:1/0,z:1/0}},sphere:{center:{x:0,y:0,z:0},radius:1/0}},rotation:{minPolarAngle:0,maxPolarAngle:180,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0},zoom:{minDistance:0,maxDistance:1/0}},rotationSpeed:.5,panSpeed:.5,zoomSpeed:.5},fps:{},orthographic:{damping:.1,enableKeyPan:!1,enablePan:!0,enableZoom:!0,input:{keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:1,zoom:2,pan:3}},keyPanSpeed:.5,movementSmoothness:.5,panSpeed:.5,zoomSpeed:.5}},enableCameraControls:!0,revertAtMouseUp:!1,revertAtMouseUpDuration:800,zoomExtentsFactor:1},duration:0,fullscreen:!1,gridVisibility:!0,groundPlaneReflectionThreshold:.01,groundPlaneReflectionVisibility:!1,groundPlaneVisibility:!0,lights:{helper:!1,lightScene:"default",lightScenes:{}},material:{environmentMap:"none",environmentMapAsBackground:!1,environmentMapResolution:"1024"},render:{ambientOcclusion:!0,beautyRenderDelay:50,beautyRenderBlendingDuration:1500,clearColor:"#ffffff",clearAlpha:1,pointSize:1,shadows:!0,sao:{samples:8,intensity:.1,kernelRadius:8,standardDev:25}}}}})})),s.register("3QMlD",(function(e,t){var r=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.validate=void 0;const i=r(s("kmsNQ")),n=i.default.object({id:i.default.string(),name:i.default.string().optional(),type:i.default.string(),order:i.default.number().unsafe().optional(),properties:{color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]).optional(),direction:i.default.object({x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}).optional(),position:i.default.object({x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}).optional(),target:i.default.object({x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}).optional(),castShadow:i.default.boolean().optional(),skyColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()]).optional(),groundColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()]).optional(),intensity:i.default.number().unsafe().optional(),distance:i.default.number().unsafe().optional(),angle:i.default.number().unsafe().optional(),penumbra:i.default.number().unsafe().optional(),decay:i.default.number().unsafe().optional(),shadowMapResolution:i.default.number().unsafe().optional(),shadowMapBias:i.default.number().unsafe().optional()}}),o=i.default.object().pattern(/^/,[i.default.object({id:i.default.string(),name:i.default.string().optional(),lights:i.default.object().pattern(/^/,[n])})]),a=i.default.object({build_date:i.default.string().allow("").optional(),build_version:i.default.string().allow("").optional(),settings_version:i.default.string(),ar:i.default.object({enableCameraSync:i.default.boolean().optional(),enableCameraSyncInitial:i.default.boolean().optional(),enableLightingEstimation:i.default.boolean().optional(),enableTouchControls:i.default.boolean().optional(),enableTouchControlRotation:i.default.boolean().optional(),enableAutomaticPlacement:i.default.boolean().optional(),defaultHitTestType:i.default.string().optional()}).optional(),defaultMaterial:{bumpAmplitude:i.default.number().unsafe().optional(),color:i.default.alternatives([i.default.string(),i.default.array().items(i.default.number().unsafe())]).optional(),metalness:i.default.number().unsafe().optional(),roughness:i.default.number().unsafe().optional()},parameters:i.default.object({controlOrder:i.default.array().items(i.default.string()).optional(),controlNames:i.default.object().pattern(/.*/,[i.default.string()]).optional(),parametersHidden:i.default.array().items(i.default.string()).optional()}).optional(),viewer:{blurSceneWhenBusy:i.default.boolean(),ignoreSuperseded:i.default.boolean().optional(),loggingLevel:i.default.number().unsafe().optional(),messageLoggingLevel:i.default.number().unsafe().optional(),viewerRuntimeId:i.default.string().allow("").optional(),hasRestoredSettings:i.default.boolean().optional(),useModelSettings:i.default.boolean().optional(),showMessages:i.default.boolean().optional(),commitSettings:i.default.boolean(),commitParameters:i.default.boolean(),scene:{show:i.default.boolean().optional(),showSceneTransition:i.default.string().optional(),duration:i.default.number().unsafe().optional(),fullscreen:i.default.boolean().optional(),gridVisibility:i.default.boolean(),groundPlaneReflectionThreshold:i.default.number().unsafe().optional(),groundPlaneReflectionVisibility:i.default.boolean().optional(),groundPlaneVisibility:i.default.boolean(),camera:{autoAdjust:i.default.boolean(),cameraMovementDuration:i.default.number().unsafe().min(0),cameraTypes:{perspective:{default:{position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}},fov:i.default.number().unsafe().min(0).max(180),controls:i.default.number().unsafe().optional()},orthographic:{default:{position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}}},active:i.default.number().unsafe().min(0).max(6)},controls:{orbit:{autoRotationSpeed:i.default.number().unsafe(),damping:i.default.number().unsafe().min(0),enableAutoRotation:i.default.boolean(),enableKeyPan:i.default.boolean(),enablePan:i.default.boolean(),enableRotation:i.default.boolean(),enableZoom:i.default.boolean(),input:{keys:{up:i.default.number().unsafe(),down:i.default.number().unsafe(),left:i.default.number().unsafe(),right:i.default.number().unsafe()},mouse:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()},touch:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()}},keyPanSpeed:i.default.number().unsafe().min(0).max(1),movementSmoothness:i.default.number().unsafe().min(0).max(1),restrictions:{position:i.default.object({cube:i.default.object({min:{x:i.default.number().unsafe().allow(-1/0).allow(null),y:i.default.number().unsafe().allow(-1/0).allow(null),z:i.default.number().unsafe().allow(-1/0).allow(null)},max:{x:i.default.number().unsafe().allow(1/0).allow(null),y:i.default.number().unsafe().allow(1/0).allow(null),z:i.default.number().unsafe().allow(1/0).allow(null)}}).optional(),sphere:i.default.object({center:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},radius:i.default.number().unsafe().allow(1/0).allow(null)}).optional()}).optional(),target:i.default.object({cube:i.default.object({min:{x:i.default.number().unsafe().allow(-1/0).allow(null),y:i.default.number().unsafe().allow(-1/0).allow(null),z:i.default.number().unsafe().allow(-1/0).allow(null)},max:{x:i.default.number().unsafe().allow(1/0).allow(null),y:i.default.number().unsafe().allow(1/0).allow(null),z:i.default.number().unsafe().allow(1/0).allow(null)}}).optional(),sphere:i.default.object({center:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},radius:i.default.number().unsafe().allow(1/0).allow(null)}).optional()}).optional(),rotation:i.default.object({minPolarAngle:i.default.number().unsafe(),maxPolarAngle:i.default.number().unsafe(),minAzimuthAngle:i.default.number().unsafe().allow(-1/0).allow(null),maxAzimuthAngle:i.default.number().unsafe().allow(1/0).allow(null)}).optional(),zoom:i.default.object({minDistance:i.default.number().unsafe(),maxDistance:i.default.number().unsafe().allow(1/0).allow(null)}).optional()},rotationSpeed:i.default.number().unsafe().min(0).max(1),panSpeed:i.default.number().unsafe().min(0).max(1),zoomSpeed:i.default.number().unsafe().min(0).max(1)},fps:{},orthographic:{damping:i.default.number().unsafe().min(0).max(1),enableKeyPan:i.default.boolean(),enablePan:i.default.boolean(),enableZoom:i.default.boolean(),input:{keys:{up:i.default.number().unsafe(),down:i.default.number().unsafe(),left:i.default.number().unsafe(),right:i.default.number().unsafe()},mouse:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()},touch:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()}},keyPanSpeed:i.default.number().unsafe().min(0).max(1),movementSmoothness:i.default.number().unsafe().min(0).max(1),panSpeed:i.default.number().unsafe().min(0).max(1),zoomSpeed:i.default.number().unsafe().min(0).max(1)}},enableCameraControls:i.default.boolean(),revertAtMouseUp:i.default.boolean(),revertAtMouseUpDuration:i.default.number().unsafe().min(0),zoomExtentsFactor:i.default.number().unsafe().positive()},lights:{helper:i.default.boolean().optional(),lightScene:i.default.string().allow(""),lightScenes:o.allow(null)},material:{environmentMap:i.default.alternatives([i.default.string().allow(""),i.default.array().items(i.default.string())]),environmentMapAsBackground:i.default.boolean(),environmentMapResolution:i.default.string().valid("256","512","1024","2048")},render:{ambientOcclusion:i.default.boolean(),beautyRenderDelay:i.default.number().unsafe().min(0),beautyRenderBlendingDuration:i.default.number().unsafe().min(0).optional(),clearAlpha:i.default.number().unsafe().min(0).max(1),clearColor:i.default.string(),pointSize:i.default.number().unsafe().min(0),shadows:i.default.boolean(),sao:{samples:i.default.number().unsafe().positive().optional(),kernelRadius:i.default.number().unsafe().positive().optional(),intensity:i.default.number().unsafe().positive().optional(),standardDev:i.default.number().unsafe().min(0).optional()}}}}}).options({presence:"required"});e.exports.validate=e=>{e=i.default.attempt(e,a).value}})),s.register("czmsD",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.convertToPrevious=e.exports.convertFromPrevious=void 0;var r=s("dCZSW"),i=s("kFbIr");e.exports.convertFromPrevious=(e,t)=>{const r=i.Defaults(),n=e;return void 0!==n.clearAlpha&&(r.viewer.scene.render.clearAlpha=n.clearAlpha),void 0!==n.clearColor&&(r.viewer.scene.render.clearColor=n.clearColor),void 0===n.clearAlpha&&void 0===n.clearColor&&void 0!==n.backgroundColor&&(r.viewer.scene.render.clearColor=n.backgroundColor),void 0!==n.defaultMaterialColor&&(r.defaultMaterial.color=n.defaultMaterialColor),r.build_date=n.build_date,r.build_version=n.build_version,void 0!==n.camera&&void 0!==n.camera.position&&void 0!==n.camera.target&&void 0!==n.camera.position.x&&void 0!==n.camera.position.y&&void 0!==n.camera.position.z&&void 0!==n.camera.target.x&&void 0!==n.camera.target.y&&void 0!==n.camera.target.z&&(5===n.camera.position.x&&5===n.camera.position.y&&5===n.camera.position.z&&0===n.camera.target.x&&0===n.camera.target.y&&0===n.camera.target.z||0===n.camera.position.x&&0===n.camera.position.y&&0===n.camera.position.z&&0===n.camera.target.x&&0===n.camera.target.y&&0===n.camera.target.z||(r.viewer.scene.camera.cameraTypes.perspective.default.position=n.camera.position,r.viewer.scene.camera.cameraTypes.perspective.default.target=n.camera.target)),void 0!==n.cameraOrtho&&void 0!==n.cameraOrtho.position&&void 0!==n.cameraOrtho.target&&void 0!==n.cameraOrtho.position.x&&void 0!==n.cameraOrtho.position.y&&void 0!==n.cameraOrtho.position.z&&void 0!==n.cameraOrtho.target.x&&void 0!==n.cameraOrtho.target.y&&void 0!==n.cameraOrtho.target.z&&(5===n.cameraOrtho.position.x&&5===n.cameraOrtho.position.y&&5===n.cameraOrtho.position.z&&0===n.cameraOrtho.target.x&&0===n.cameraOrtho.target.y&&0===n.cameraOrtho.target.z||0===n.cameraOrtho.position.x&&0===n.cameraOrtho.position.y&&0===n.cameraOrtho.position.z&&0===n.cameraOrtho.target.x&&0===n.cameraOrtho.target.y&&0===n.cameraOrtho.target.z?!n.topView||5===n.cameraOrtho.position.x&&5===n.cameraOrtho.position.y&&5===n.cameraOrtho.position.z&&0===n.cameraOrtho.target.x&&0===n.cameraOrtho.target.y&&0===n.cameraOrtho.target.z||0===n.cameraOrtho.position.x&&0===n.cameraOrtho.position.y&&0===n.cameraOrtho.position.z&&0===n.cameraOrtho.target.x&&0===n.cameraOrtho.target.y&&0===n.cameraOrtho.target.z||void 0!==n.camera&&void 0!==n.camera.position&&void 0!==n.camera.target&&void 0!==n.camera.position.x&&void 0!==n.camera.position.y&&void 0!==n.camera.position.z&&void 0!==n.camera.target.x&&void 0!==n.camera.target.y&&void 0!==n.camera.target.z&&(r.viewer.scene.camera.cameraTypes.orthographic.default.position=n.camera.position,r.viewer.scene.camera.cameraTypes.orthographic.default.target=n.camera.target):(r.viewer.scene.camera.cameraTypes.orthographic.default.position=n.cameraOrtho.position,r.viewer.scene.camera.cameraTypes.orthographic.default.target=n.cameraOrtho.target)),void 0!==n.ambientOcclusion&&(r.viewer.scene.render.ambientOcclusion=n.ambientOcclusion),void 0!==n.autoRotateSpeed&&(r.viewer.scene.camera.controls.orbit.autoRotationSpeed=n.autoRotateSpeed),void 0!==n.bumpAmplitude&&(r.defaultMaterial.bumpAmplitude=n.bumpAmplitude),void 0!==n.cameraAutoAdjust&&(r.viewer.scene.camera.autoAdjust=n.cameraAutoAdjust),void 0!==n.cameraMovementDuration&&(r.viewer.scene.camera.cameraMovementDuration=n.cameraMovementDuration),void 0!==n.cameraRevertAtMouseUp&&(r.viewer.scene.camera.revertAtMouseUp=n.cameraRevertAtMouseUp),void 0!==n.commitParameters&&(r.viewer.commitParameters=n.commitParameters),void 0!==n.controlDamping&&(r.viewer.scene.camera.controls.orbit.damping=n.controlDamping),void 0!==n.controlDamping&&(r.viewer.scene.camera.controls.orthographic.damping=n.controlDamping),void 0!==n.controlNames&&(r.parameters.controlNames=n.controlNames),void 0!==n.controlOrder&&(r.parameters.controlOrder=n.controlOrder),void 0!==n.disablePan&&(r.viewer.scene.camera.controls.orbit.enablePan=!n.disablePan),void 0!==n.disablePan&&(r.viewer.scene.camera.controls.orthographic.enablePan=!n.disablePan),void 0!==n.disableZoom&&(r.viewer.scene.camera.controls.orbit.enableZoom=!n.disableZoom),void 0!==n.disableZoom&&(r.viewer.scene.camera.controls.orthographic.enableZoom=!n.disableZoom),void 0!==n.enableAutoRotation&&(r.viewer.scene.camera.controls.orbit.enableAutoRotation=n.enableAutoRotation),void 0!==n.enableRotation&&(r.viewer.scene.camera.controls.orbit.enableRotation=n.enableRotation),void 0!==n.environmentMap&&(r.viewer.scene.material.environmentMap=n.environmentMap),void 0!==n.environmentMapResolution&&(r.viewer.scene.material.environmentMapResolution=n.environmentMapResolution),void 0!==n.fov&&(r.viewer.scene.camera.cameraTypes.perspective.fov=n.fov),void 0!==n.lightScene&&(r.viewer.scene.lights.lightScene=n.lightScene),void 0!==n.lightScenes&&(r.viewer.scene.lights.lightScenes=n.lightScenes),void 0!==n.panSpeed&&(r.viewer.scene.camera.controls.orbit.panSpeed=n.panSpeed),void 0!==n.parametersHidden&&(r.parameters.parametersHidden=n.parametersHidden),void 0!==n.pointSize&&(r.viewer.scene.render.pointSize=n.pointSize),void 0!==n.revertAtMouseUpDuration&&(r.viewer.scene.camera.revertAtMouseUpDuration=n.revertAtMouseUpDuration),void 0!==n.rotateSpeed&&(r.viewer.scene.camera.controls.orbit.rotationSpeed=n.rotateSpeed),void 0!==n.showEnvironmentMap&&(r.viewer.scene.material.environmentMapAsBackground=n.showEnvironmentMap),void 0!==n.showGrid&&(r.viewer.scene.gridVisibility=n.showGrid),void 0!==n.showGroundPlane&&(r.viewer.scene.groundPlaneVisibility=n.showGroundPlane),void 0!==n.showShadows&&(r.viewer.scene.render.shadows=n.showShadows),n.topView&&(r.viewer.scene.camera.cameraTypes.active=1),void 0!==n.zoomExtentFactor&&(r.viewer.scene.camera.zoomExtentsFactor=n.zoomExtentFactor),void 0!==n.zoomSpeed&&(r.viewer.scene.camera.controls.orbit.zoomSpeed=n.zoomSpeed),void 0!==n.zoomSpeed&&(r.viewer.scene.camera.controls.orthographic.zoomSpeed=n.zoomSpeed),r};e.exports.convertToPrevious=(e,t)=>{const i=r.Defaults(),n=e;return i.build_date=n.build_date,i.build_version=n.build_version,i.ambientOcclusion=n.viewer.scene.render.ambientOcclusion,i.autoRotateSpeed=n.viewer.scene.camera.controls.orbit.autoRotationSpeed,i.bumpAmplitude=n.defaultMaterial.bumpAmplitude,i.camera={position:n.viewer.scene.camera.cameraTypes.perspective.default.position,target:n.viewer.scene.camera.cameraTypes.perspective.default.target},i.cameraAutoAdjust=n.viewer.scene.camera.autoAdjust,i.cameraMovementDuration=n.viewer.scene.camera.cameraMovementDuration,i.cameraOrtho={position:n.viewer.scene.camera.cameraTypes.orthographic.default.position,target:n.viewer.scene.camera.cameraTypes.orthographic.default.target},i.cameraRevertAtMouseUp=n.viewer.scene.camera.revertAtMouseUp,i.clearAlpha=n.viewer.scene.render.clearAlpha,i.clearColor=n.viewer.scene.render.clearColor,i.commitParameters=n.viewer.commitParameters,i.controlDamping=n.viewer.scene.camera.controls.orbit.damping,n.parameters&&n.parameters.controlNames&&(i.controlNames=n.parameters.controlNames),n.parameters&&n.parameters.controlOrder&&(i.controlOrder=n.parameters.controlOrder),i.defaultMaterialColor=n.defaultMaterial.color,i.disablePan=!n.viewer.scene.camera.controls.orbit.enablePan,i.disableZoom=!n.viewer.scene.camera.controls.orbit.enableZoom,i.enableAutoRotation=n.viewer.scene.camera.controls.orbit.enableAutoRotation,i.enableRotation=n.viewer.scene.camera.controls.orbit.enableRotation,i.environmentMap=n.viewer.scene.material.environmentMap,i.environmentMapResolution=n.viewer.scene.material.environmentMapResolution,i.fov=n.viewer.scene.camera.cameraTypes.perspective.fov,i.lightScene=n.viewer.scene.lights.lightScene,i.lightScenes=n.viewer.scene.lights.lightScenes,i.panSpeed=n.viewer.scene.camera.controls.orbit.panSpeed,n.parameters&&n.parameters.parametersHidden&&(i.parametersHidden=n.parameters.parametersHidden),i.pointSize=n.viewer.scene.render.pointSize,i.revertAtMouseUpDuration=n.viewer.scene.camera.revertAtMouseUpDuration,i.rotateSpeed=n.viewer.scene.camera.controls.orbit.rotationSpeed,i.showEnvironmentMap=n.viewer.scene.material.environmentMapAsBackground,i.showGrid=n.viewer.scene.gridVisibility,i.showGroundPlane=n.viewer.scene.groundPlaneVisibility,i.showShadows=n.viewer.scene.render.shadows,i.topView=1===n.viewer.scene.camera.cameraTypes.active,i.zoomExtentFactor=n.viewer.scene.camera.zoomExtentsFactor,i.zoomSpeed=n.viewer.scene.camera.controls.orbit.zoomSpeed,i.backgroundColor=n.viewer.scene.render.clearColor,i}})),s.register("jah3h",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Defaults=void 0;e.exports.Defaults=()=>({build_date:"",build_version:"",settings_version:"3.0",ar:{enable:!0,autoScaling:!0},camera:{cameraId:"",cameras:{}},environment:{clearAlpha:1,clearColor:"#ffffff",map:"none",mapAsBackground:!1,mapResolution:"1024"},environmentGeometry:{gridVisibility:!0,groundPlaneVisibility:!0},general:{transformation:{scale:{x:1,y:1,z:1},translation:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},blurWhenBusy:!0,commitSettings:!1,commitParameters:!1,pointSize:1,showMessages:!0},light:{lightSceneId:"",lightScenes:{}},rendering:{ambientOcclusion:!0,ambientOcclusionIntensity:.1,beautyRenderDelay:50,beautyRenderBlendingDuration:1500,shadows:!0},session:{}})})),s.register("jLFc9",(function(e,t){var r=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.validate=void 0;const i=r(s("kmsNQ")),n=i.default.object({autoRotationSpeed:i.default.number().unsafe(),damping:i.default.number().unsafe().min(0),enableAutoRotation:i.default.boolean(),enableKeyPan:i.default.boolean(),enablePan:i.default.boolean(),enableRotation:i.default.boolean(),enableZoom:i.default.boolean(),input:{keys:{up:i.default.number().unsafe(),down:i.default.number().unsafe(),left:i.default.number().unsafe(),right:i.default.number().unsafe()},mouse:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()},touch:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()}},keyPanSpeed:i.default.number().unsafe().min(0).max(1),movementSmoothness:i.default.number().unsafe().min(0).max(1),restrictions:i.default.object({position:{cube:{min:{x:i.default.number().unsafe().allow(-1/0).allow(null),y:i.default.number().unsafe().allow(-1/0).allow(null),z:i.default.number().unsafe().allow(-1/0).allow(null)},max:{x:i.default.number().unsafe().allow(1/0).allow(null),y:i.default.number().unsafe().allow(1/0).allow(null),z:i.default.number().unsafe().allow(1/0).allow(null)}},sphere:{center:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},radius:i.default.number().unsafe().allow(1/0).allow(null)}},target:{cube:{min:{x:i.default.number().unsafe().allow(-1/0).allow(null),y:i.default.number().unsafe().allow(-1/0).allow(null),z:i.default.number().unsafe().allow(-1/0).allow(null)},max:{x:i.default.number().unsafe().allow(1/0).allow(null),y:i.default.number().unsafe().allow(1/0).allow(null),z:i.default.number().unsafe().allow(1/0).allow(null)}},sphere:{center:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},radius:i.default.number().unsafe().allow(1/0).allow(null)}},rotation:{minPolarAngle:i.default.number().unsafe(),maxPolarAngle:i.default.number().unsafe(),minAzimuthAngle:i.default.number().unsafe().allow(-1/0).allow(null),maxAzimuthAngle:i.default.number().unsafe().allow(1/0).allow(null)},zoom:{minDistance:i.default.number().unsafe(),maxDistance:i.default.number().unsafe().allow(1/0).allow(null)}}),rotationSpeed:i.default.number().unsafe().min(0).max(1),panSpeed:i.default.number().unsafe().min(0).max(1),zoomSpeed:i.default.number().unsafe().min(0).max(1)}),o=i.default.object({damping:i.default.number().unsafe().min(0).max(1),enableKeyPan:i.default.boolean(),enablePan:i.default.boolean(),enableZoom:i.default.boolean(),input:{keys:{up:i.default.number().unsafe(),down:i.default.number().unsafe(),left:i.default.number().unsafe(),right:i.default.number().unsafe()},mouse:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()},touch:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()}},keyPanSpeed:i.default.number().unsafe().min(0).max(1),movementSmoothness:i.default.number().unsafe().min(0).max(1),panSpeed:i.default.number().unsafe().min(0).max(1),zoomSpeed:i.default.number().unsafe().min(0).max(1)}),a=i.default.object({name:i.default.string().optional(),type:i.default.string(),autoAdjust:i.default.boolean(),cameraMovementDuration:i.default.number().unsafe().min(0),controls:o,enableCameraControls:i.default.boolean(),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},revertAtMouseUp:i.default.boolean(),revertAtMouseUpDuration:i.default.number().unsafe().min(0),target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},zoomExtentsFactor:i.default.number().unsafe().positive()}),l=i.default.object({name:i.default.string().optional(),type:i.default.string(),autoAdjust:i.default.boolean(),cameraMovementDuration:i.default.number().unsafe().min(0),controls:n,enableCameraControls:i.default.boolean(),fov:i.default.number().unsafe().positive(),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},revertAtMouseUp:i.default.boolean(),revertAtMouseUpDuration:i.default.number().unsafe().min(0),target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},zoomExtentsFactor:i.default.number().unsafe().positive()}),c=i.default.object().pattern(/^/,[l,a]),u=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0)}),h=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),direction:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},castShadow:i.default.boolean(),shadowMapResolution:i.default.number().unsafe().optional(),shadowMapBias:i.default.number().unsafe().optional()}),d=i.default.object({skyColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),groundColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()])}),f=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},distance:i.default.number().unsafe().min(0),decay:i.default.number().unsafe().min(0)}),p=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},distance:i.default.number().unsafe().min(0),decay:i.default.number().unsafe().min(0),angle:i.default.number().unsafe().min(0),penumbra:i.default.number().unsafe().min(0)}),m=i.default.object().pattern(/^/,[i.default.object({name:i.default.string().optional(),lights:i.default.object().pattern(/^/,[i.default.object({name:i.default.string().optional(),type:i.default.string(),order:i.default.number().unsafe().optional(),properties:i.default.alternatives([u,h,d,f,p])})])})]),g=i.default.object({build_date:i.default.string().allow("").optional(),build_version:i.default.string().allow("").optional(),settings_version:i.default.string(),ar:i.default.object({enable:i.default.boolean(),autoScaling:i.default.boolean()}).optional(),camera:{cameraId:i.default.string().allow(""),cameras:c},environment:{clearAlpha:i.default.number().unsafe().min(0).max(1),clearColor:i.default.string(),map:i.default.alternatives([i.default.string().allow(""),i.default.array().items(i.default.string())]),mapAsBackground:i.default.boolean(),mapResolution:i.default.string()},environmentGeometry:{gridVisibility:i.default.boolean(),groundPlaneVisibility:i.default.boolean()},general:{transformation:{scale:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},translation:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},rotation:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}},blurWhenBusy:i.default.boolean(),commitSettings:i.default.boolean(),commitParameters:i.default.boolean(),pointSize:i.default.number().unsafe().min(0),showMessages:i.default.boolean()},light:{lightSceneId:i.default.string().allow("").optional(),lightScenes:m},rendering:{ambientOcclusion:i.default.boolean(),ambientOcclusionIntensity:i.default.number().unsafe().positive().max(1),beautyRenderDelay:i.default.number().unsafe().min(0),beautyRenderBlendingDuration:i.default.number().unsafe().min(0),shadows:i.default.boolean()},session:i.default.object().pattern(/^/,[i.default.object({order:i.default.number().unsafe().optional(),displayname:i.default.string().allow("").optional(),hidden:i.default.boolean().optional()})])}).options({presence:"required"});e.exports.validate=e=>{e=i.default.attempt(e,g).value}})),s.register("h0tL7",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.convertToPrevious=e.exports.convertFromPrevious=void 0;var r=s("kFbIr"),i=s("jah3h"),n=s("5sKyw");e.exports.convertFromPrevious=(e,t)=>{const r=i.Defaults(),s=e;if(r.build_date=s.build_date,r.build_version=s.build_version,s.parameters&&s.parameters.controlNames)for(let e in s.parameters.controlNames)r.session[e]={order:0,displayname:s.parameters.controlNames[e],hidden:!1};if(s.parameters&&s.parameters.controlOrder)for(let e=0;e<s.parameters.controlOrder.length;e++){const t=s.parameters.controlOrder[e];r.session[t]?r.session[t].order=e:r.session[t]={order:e,displayname:"",hidden:!1}}if(s.parameters&&s.parameters.parametersHidden)for(let e=0;e<s.parameters.parametersHidden.length;e++){const t=s.parameters.parametersHidden[e];r.session[t]?r.session[t].hidden=!0:r.session[t]={order:0,displayname:"",hidden:!0}}r.general.blurWhenBusy=s.viewer.blurSceneWhenBusy,r.general.commitParameters=s.viewer.commitParameters,r.general.commitSettings=s.viewer.commitSettings,s.viewer.showMessages&&(r.general.showMessages=s.viewer.showMessages),r.environmentGeometry.gridVisibility=s.viewer.scene.gridVisibility,r.environmentGeometry.groundPlaneVisibility=s.viewer.scene.groundPlaneVisibility;const o=n.default();if(r.camera.cameraId=o,0===s.viewer.scene.camera.cameraTypes.active){const e=s.viewer.scene.camera.controls.orbit.restrictions,t=e.position&&e.position.cube?{min:{x:e.position.cube.min.x,y:e.position.cube.min.y,z:e.position.cube.min.z},max:{x:e.position.cube.max.x,y:e.position.cube.max.y,z:e.position.cube.max.z}}:{min:{x:-1/0,y:-1/0,z:-1/0},max:{x:1/0,y:1/0,z:1/0}},i=e.target&&e.target.cube?{min:{x:e.target.cube.min.x,y:e.target.cube.min.y,z:e.target.cube.min.z},max:{x:e.target.cube.max.x,y:e.target.cube.max.y,z:e.target.cube.max.z}}:{min:{x:-1/0,y:-1/0,z:-1/0},max:{x:1/0,y:1/0,z:1/0}},n={position:{cube:t,sphere:e.position&&e.position.sphere?{center:{x:e.position.sphere.center.x,y:e.position.sphere.center.y,z:e.position.sphere.center.z},radius:e.position.sphere.radius}:{center:{x:0,y:0,z:0},radius:1/0}},target:{cube:i,sphere:e.target&&e.target.sphere?{center:{x:e.target.sphere.center.x,y:e.target.sphere.center.y,z:e.target.sphere.center.z},radius:e.target.sphere.radius}:{center:{x:0,y:0,z:0},radius:1/0}},rotation:e.rotation?{minPolarAngle:e.rotation.minPolarAngle,maxPolarAngle:e.rotation.maxPolarAngle,minAzimuthAngle:e.rotation.minAzimuthAngle,maxAzimuthAngle:e.rotation.maxAzimuthAngle}:{minPolarAngle:0,maxPolarAngle:180,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0},zoom:e.zoom?{minDistance:e.zoom.minDistance,maxDistance:e.zoom.maxDistance}:{minDistance:0,maxDistance:1/0}};r.camera.cameras={[o]:{type:"perspective",autoAdjust:s.viewer.scene.camera.autoAdjust,cameraMovementDuration:s.viewer.scene.camera.cameraMovementDuration,controls:{autoRotationSpeed:s.viewer.scene.camera.controls.orbit.autoRotationSpeed,damping:s.viewer.scene.camera.controls.orbit.damping,enableAutoRotation:s.viewer.scene.camera.controls.orbit.enableAutoRotation,enableKeyPan:s.viewer.scene.camera.controls.orbit.enableKeyPan,enablePan:s.viewer.scene.camera.controls.orbit.enablePan,enableRotation:s.viewer.scene.camera.controls.orbit.enableRotation,enableZoom:s.viewer.scene.camera.controls.orbit.enableZoom,input:{keys:{up:s.viewer.scene.camera.controls.orbit.input.keys.up,down:s.viewer.scene.camera.controls.orbit.input.keys.down,left:s.viewer.scene.camera.controls.orbit.input.keys.left,right:s.viewer.scene.camera.controls.orbit.input.keys.right},mouse:{rotate:s.viewer.scene.camera.controls.orbit.input.mouse.rotate,zoom:s.viewer.scene.camera.controls.orbit.input.mouse.zoom,pan:s.viewer.scene.camera.controls.orbit.input.mouse.pan},touch:{rotate:s.viewer.scene.camera.controls.orbit.input.touch.rotate,zoom:s.viewer.scene.camera.controls.orbit.input.touch.zoom,pan:s.viewer.scene.camera.controls.orbit.input.touch.pan}},keyPanSpeed:s.viewer.scene.camera.controls.orbit.keyPanSpeed,movementSmoothness:s.viewer.scene.camera.controls.orbit.movementSmoothness,restrictions:n,rotationSpeed:s.viewer.scene.camera.controls.orbit.rotationSpeed,panSpeed:s.viewer.scene.camera.controls.orbit.panSpeed,zoomSpeed:s.viewer.scene.camera.controls.orbit.zoomSpeed},enableCameraControls:s.viewer.scene.camera.enableCameraControls,fov:s.viewer.scene.camera.cameraTypes.perspective.fov,position:{x:s.viewer.scene.camera.cameraTypes.perspective.default.position.x,y:s.viewer.scene.camera.cameraTypes.perspective.default.position.y,z:s.viewer.scene.camera.cameraTypes.perspective.default.position.z},revertAtMouseUp:s.viewer.scene.camera.revertAtMouseUp,revertAtMouseUpDuration:s.viewer.scene.camera.revertAtMouseUpDuration,target:{x:s.viewer.scene.camera.cameraTypes.perspective.default.target.x,y:s.viewer.scene.camera.cameraTypes.perspective.default.target.y,z:s.viewer.scene.camera.cameraTypes.perspective.default.target.z},zoomExtentsFactor:s.viewer.scene.camera.zoomExtentsFactor}}}else{let e="top";switch(s.viewer.scene.camera.cameraTypes.active){case 2:e="bottom";break;case 3:e="right";break;case 4:e="left";break;case 5:e="back";break;case 6:e="front";break;default:e="top"}r.camera.cameras={[o]:{type:e,autoAdjust:s.viewer.scene.camera.autoAdjust,cameraMovementDuration:s.viewer.scene.camera.cameraMovementDuration,controls:{damping:s.viewer.scene.camera.controls.orbit.damping,enableKeyPan:s.viewer.scene.camera.controls.orbit.enableKeyPan,enablePan:s.viewer.scene.camera.controls.orbit.enablePan,enableZoom:s.viewer.scene.camera.controls.orbit.enableZoom,input:{keys:{up:s.viewer.scene.camera.controls.orbit.input.keys.up,down:s.viewer.scene.camera.controls.orbit.input.keys.down,left:s.viewer.scene.camera.controls.orbit.input.keys.left,right:s.viewer.scene.camera.controls.orbit.input.keys.right},mouse:{rotate:s.viewer.scene.camera.controls.orbit.input.mouse.rotate,zoom:s.viewer.scene.camera.controls.orbit.input.mouse.zoom,pan:s.viewer.scene.camera.controls.orbit.input.mouse.pan},touch:{rotate:s.viewer.scene.camera.controls.orbit.input.touch.rotate,zoom:s.viewer.scene.camera.controls.orbit.input.touch.zoom,pan:s.viewer.scene.camera.controls.orbit.input.touch.pan}},keyPanSpeed:s.viewer.scene.camera.controls.orbit.keyPanSpeed,movementSmoothness:s.viewer.scene.camera.controls.orbit.movementSmoothness,panSpeed:s.viewer.scene.camera.controls.orbit.panSpeed,zoomSpeed:s.viewer.scene.camera.controls.orbit.zoomSpeed},enableCameraControls:s.viewer.scene.camera.enableCameraControls,position:{x:s.viewer.scene.camera.cameraTypes.orthographic.default.position.x,y:s.viewer.scene.camera.cameraTypes.orthographic.default.position.y,z:s.viewer.scene.camera.cameraTypes.orthographic.default.position.z},revertAtMouseUp:s.viewer.scene.camera.revertAtMouseUp,revertAtMouseUpDuration:s.viewer.scene.camera.revertAtMouseUpDuration,target:{x:s.viewer.scene.camera.cameraTypes.orthographic.default.target.x,y:s.viewer.scene.camera.cameraTypes.orthographic.default.target.y,z:s.viewer.scene.camera.cameraTypes.orthographic.default.target.z},zoomExtentsFactor:s.viewer.scene.camera.zoomExtentsFactor}}}if(r.environment.map=s.viewer.scene.material.environmentMap,r.environment.mapAsBackground=s.viewer.scene.material.environmentMapAsBackground,r.environment.mapResolution=s.viewer.scene.material.environmentMapResolution,s.viewer.scene.lights,r.light.lightSceneId=s.viewer.scene.lights.lightScene,s.viewer.scene.lights.lightScenes)for(let e in s.viewer.scene.lights.lightScenes){const t=s.viewer.scene.lights.lightScenes[e],i={};for(let r in t.lights){const t=s.viewer.scene.lights.lightScenes[e].lights[r];switch(t.type){case"ambient":i[r]={name:t.name,type:t.type,properties:{color:t.properties.color,intensity:t.properties.intensity}};break;case"directional":i[r]={name:t.name,type:t.type,properties:{direction:{x:t.properties.direction.x,y:t.properties.direction.y,z:t.properties.direction.z},color:t.properties.color,intensity:t.properties.intensity,castShadow:t.properties.castShadow,shadowMapResolution:t.properties.shadowMapResolution,shadowMapBias:t.properties.shadowMapBias}};break;case"hemisphere":i[r]={name:t.name,type:t.type,properties:{skyColor:t.properties.skyColor,intensity:t.properties.intensity,groundColor:t.properties.groundColor}};break;case"point":i[r]={name:t.name,type:t.type,properties:{color:t.properties.color,intensity:t.properties.intensity,position:{x:t.properties.position.x,y:t.properties.position.y,z:t.properties.position.z},distance:t.properties.distance,decay:t.properties.decay}};break;case"spot":i[r]={name:t.name,type:t.type,properties:{color:t.properties.color,intensity:t.properties.intensity,position:{x:t.properties.position.x,y:t.properties.position.y,z:t.properties.position.z},target:{x:t.properties.target.x,y:t.properties.target.y,z:t.properties.target.z},distance:t.properties.distance,decay:t.properties.decay,angle:t.properties.angle,penumbra:t.properties.penumbra}}}t.order&&(i[r].order=t.order)}r.light.lightScenes[e]={name:t.name,lights:i}}return r.rendering.ambientOcclusion=s.viewer.scene.render.ambientOcclusion,void 0!==s.viewer.scene.render.beautyRenderBlendingDuration&&(r.rendering.beautyRenderBlendingDuration=s.viewer.scene.render.beautyRenderBlendingDuration),r.rendering.beautyRenderDelay=s.viewer.scene.render.beautyRenderDelay,r.environment.clearAlpha=s.viewer.scene.render.clearAlpha,r.environment.clearColor=s.viewer.scene.render.clearColor,r.general.pointSize=s.viewer.scene.render.pointSize,r.rendering.shadows=s.viewer.scene.render.shadows,r};e.exports.convertToPrevious=(e,t)=>{const i=r.Defaults(),n=e;if(i.build_date=n.build_date,i.build_version=n.build_version,n.camera.cameras[n.camera.cameraId]){const e=n.camera.cameras[n.camera.cameraId];switch(e.type){case"top":i.viewer.scene.camera.cameraTypes.active=1;break;case"bottom":i.viewer.scene.camera.cameraTypes.active=2;break;case"right":i.viewer.scene.camera.cameraTypes.active=3;break;case"left":i.viewer.scene.camera.cameraTypes.active=4;break;case"back":i.viewer.scene.camera.cameraTypes.active=5;break;case"front":i.viewer.scene.camera.cameraTypes.active=6;break;default:i.viewer.scene.camera.cameraTypes.active=0}if(i.viewer.scene.camera.autoAdjust=e.autoAdjust,i.viewer.scene.camera.cameraMovementDuration=e.cameraMovementDuration,i.viewer.scene.camera.enableCameraControls=e.enableCameraControls,i.viewer.scene.camera.revertAtMouseUp=e.revertAtMouseUp,i.viewer.scene.camera.revertAtMouseUpDuration=e.revertAtMouseUpDuration,i.viewer.scene.camera.zoomExtentsFactor=e.zoomExtentsFactor,"perspective"===e.type){const t=e;i.viewer.scene.camera.cameraTypes.perspective.default.position={x:e.position.x,y:e.position.y,z:e.position.z},i.viewer.scene.camera.cameraTypes.perspective.default.target={x:e.target.x,y:e.target.y,z:e.target.z},i.viewer.scene.camera.cameraTypes.perspective.fov=t.fov,i.viewer.scene.camera.controls.orbit={autoRotationSpeed:t.controls.autoRotationSpeed,damping:t.controls.damping,enableAutoRotation:t.controls.enableAutoRotation,enableKeyPan:t.controls.enableKeyPan,enablePan:t.controls.enablePan,enableRotation:t.controls.enableRotation,enableZoom:t.controls.enableZoom,input:{keys:{up:t.controls.input.keys.up,down:t.controls.input.keys.down,left:t.controls.input.keys.left,right:t.controls.input.keys.right},mouse:{rotate:t.controls.input.mouse.rotate,zoom:t.controls.input.mouse.zoom,pan:t.controls.input.mouse.pan},touch:{rotate:t.controls.input.touch.rotate,zoom:t.controls.input.touch.zoom,pan:t.controls.input.touch.pan}},keyPanSpeed:t.controls.keyPanSpeed,movementSmoothness:t.controls.movementSmoothness,restrictions:{position:{cube:{min:{x:t.controls.restrictions.position.cube.min.x,y:t.controls.restrictions.position.cube.min.y,z:t.controls.restrictions.position.cube.min.z},max:{x:t.controls.restrictions.position.cube.max.x,y:t.controls.restrictions.position.cube.max.y,z:t.controls.restrictions.position.cube.max.z}},sphere:{center:{x:t.controls.restrictions.position.sphere.center.x,y:t.controls.restrictions.position.sphere.center.y,z:t.controls.restrictions.position.sphere.center.z},radius:t.controls.restrictions.position.sphere.radius}},target:{cube:{min:{x:t.controls.restrictions.target.cube.min.x,y:t.controls.restrictions.target.cube.min.y,z:t.controls.restrictions.target.cube.min.z},max:{x:t.controls.restrictions.target.cube.max.x,y:t.controls.restrictions.target.cube.max.y,z:t.controls.restrictions.target.cube.max.z}},sphere:{center:{x:t.controls.restrictions.target.sphere.center.x,y:t.controls.restrictions.target.sphere.center.y,z:t.controls.restrictions.target.sphere.center.z},radius:t.controls.restrictions.target.sphere.radius}},rotation:{minPolarAngle:t.controls.restrictions.rotation.minPolarAngle,maxPolarAngle:t.controls.restrictions.rotation.maxPolarAngle,minAzimuthAngle:t.controls.restrictions.rotation.minAzimuthAngle,maxAzimuthAngle:t.controls.restrictions.rotation.maxAzimuthAngle},zoom:{minDistance:t.controls.restrictions.zoom.minDistance,maxDistance:t.controls.restrictions.zoom.maxDistance}},rotationSpeed:t.controls.rotationSpeed,panSpeed:t.controls.panSpeed,zoomSpeed:t.controls.zoomSpeed}}else{const t=e;i.viewer.scene.camera.cameraTypes.orthographic.default.position={x:e.position.x,y:e.position.y,z:e.position.z},i.viewer.scene.camera.cameraTypes.orthographic.default.target={x:e.target.x,y:e.target.y,z:e.target.z},i.viewer.scene.camera.controls.orthographic={damping:t.controls.damping,enableKeyPan:t.controls.enableKeyPan,enablePan:t.controls.enablePan,enableZoom:t.controls.enableZoom,input:{keys:{up:t.controls.input.keys.up,down:t.controls.input.keys.down,left:t.controls.input.keys.left,right:t.controls.input.keys.right},mouse:{rotate:t.controls.input.mouse.rotate,zoom:t.controls.input.mouse.zoom,pan:t.controls.input.mouse.pan},touch:{rotate:t.controls.input.touch.rotate,zoom:t.controls.input.touch.zoom,pan:t.controls.input.touch.pan}},keyPanSpeed:t.controls.keyPanSpeed,movementSmoothness:t.controls.movementSmoothness,panSpeed:t.controls.panSpeed,zoomSpeed:t.controls.zoomSpeed}}}i.viewer.scene.render.clearAlpha=n.environment.clearAlpha,i.viewer.scene.render.clearColor=n.environment.clearColor,i.viewer.scene.material.environmentMap=n.environment.map,i.viewer.scene.material.environmentMapAsBackground=n.environment.mapAsBackground,i.viewer.scene.material.environmentMapResolution=n.environment.mapResolution,i.viewer.scene.gridVisibility=n.environmentGeometry.gridVisibility,i.viewer.scene.groundPlaneVisibility=n.environmentGeometry.groundPlaneVisibility,i.viewer.blurSceneWhenBusy=n.general.blurWhenBusy,i.viewer.commitParameters=n.general.commitParameters,i.viewer.commitSettings=n.general.commitSettings,i.viewer.scene.render.pointSize=n.general.pointSize,i.viewer.showMessages=n.general.showMessages,i.viewer.scene.lights.lightScene=n.light.lightSceneId||"default";for(let e in n.light.lightScenes){const t=n.light.lightScenes[e],r={};for(let e in t.lights){const i=t.lights[e];switch(i.type){case"ambient":r[e]={id:e,name:i.name,type:i.type,order:i.order,properties:{color:i.properties.color,intensity:i.properties.intensity}};break;case"directional":r[e]={id:e,name:i.name,type:i.type,order:i.order,properties:{direction:{x:i.properties.direction.x,y:i.properties.direction.y,z:i.properties.direction.z},color:i.properties.color,intensity:i.properties.intensity,castShadow:i.properties.castShadow,shadowMapResolution:i.properties.shadowMapResolution,shadowMapBias:i.properties.shadowMapBias}};break;case"hemisphere":r[e]={id:e,name:i.name,type:i.type,order:i.order,properties:{skyColor:i.properties.skyColor,intensity:i.properties.intensity,groundColor:i.properties.groundColor}};break;case"point":r[e]={id:e,name:i.name,type:i.type,order:i.order,properties:{color:i.properties.color,intensity:i.properties.intensity,position:{x:i.properties.position.x,y:i.properties.position.y,z:i.properties.position.z},distance:i.properties.distance,decay:i.properties.decay}};break;case"spot":r[e]={id:e,name:i.name,type:i.type,order:i.order,properties:{color:i.properties.color,intensity:i.properties.intensity,position:{x:i.properties.position.x,y:i.properties.position.y,z:i.properties.position.z},target:{x:i.properties.target.x,y:i.properties.target.y,z:i.properties.target.z},distance:i.properties.distance,decay:i.properties.decay,angle:i.properties.angle,penumbra:i.properties.penumbra}}}}i.viewer.scene.lights.lightScenes[e]={id:e,name:t.name,lights:r}}i.viewer.scene.render.ambientOcclusion=n.rendering.ambientOcclusion,i.viewer.scene.render.beautyRenderBlendingDuration=n.rendering.beautyRenderBlendingDuration,i.viewer.scene.render.beautyRenderDelay=n.rendering.beautyRenderDelay,i.viewer.scene.render.shadows=n.rendering.shadows;let s=[];for(let e in n.session)n.session[e].displayname&&(i.parameters.controlNames[e]=n.session[e].displayname),n.session[e].hidden&&i.parameters.parametersHidden.push(e),s.push({id:e,order:n.session[e].order||0});s.sort(((e,t)=>(e.order||1/0)-(t.order||1/0)));let o=s.filter((e=>0===e.order));return s=s.filter((e=>!o.includes(e))),s=o.concat(s),i.parameters.controlOrder=s.map((e=>e.id)),i}})),s.register("7Moja",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Defaults=void 0;e.exports.Defaults=()=>({build_date:"",build_version:"",settings_version:"3.1",ar:{enable:!0,autoScaling:!0},camera:{cameraId:"",cameras:{}},environment:{clearAlpha:1,clearColor:"#ffffff",map:"photo_studio",mapAsBackground:!1,mapResolution:"1024"},environmentGeometry:{gridColor:"#44444426",gridVisibility:!0,groundPlaneColor:"#636363ff",groundPlaneVisibility:!0},general:{transformation:{scale:{x:1,y:1,z:1},translation:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0}},blurWhenBusy:!0,commitSettings:!1,commitParameters:!1,pointSize:1,showMessages:!0},light:{lightSceneId:"",lightScenes:{}},rendering:{ambientOcclusion:!1,ambientOcclusionIntensity:.1,beautyRenderDelay:50,beautyRenderBlendingDuration:1500,outputEncoding:"srgb",physicallyCorrectLights:!0,shadows:!0,textureEncoding:"srgb",toneMapping:"none",toneMappingExposure:1},session:{}})})),s.register("kmiJL",(function(e,t){var r=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.validate=void 0;const i=r(s("kmsNQ")),n=i.default.object({autoRotationSpeed:i.default.number().unsafe(),damping:i.default.number().unsafe().min(0),enableAutoRotation:i.default.boolean(),enableKeyPan:i.default.boolean(),enablePan:i.default.boolean(),enableRotation:i.default.boolean(),enableZoom:i.default.boolean(),input:{keys:{up:i.default.number().unsafe(),down:i.default.number().unsafe(),left:i.default.number().unsafe(),right:i.default.number().unsafe()},mouse:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()},touch:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()}},keyPanSpeed:i.default.number().unsafe().min(0).max(1),movementSmoothness:i.default.number().unsafe().min(0).max(1),restrictions:i.default.object({position:{cube:{min:{x:i.default.number().unsafe().allow(-1/0).allow(null),y:i.default.number().unsafe().allow(-1/0).allow(null),z:i.default.number().unsafe().allow(-1/0).allow(null)},max:{x:i.default.number().unsafe().allow(1/0).allow(null),y:i.default.number().unsafe().allow(1/0).allow(null),z:i.default.number().unsafe().allow(1/0).allow(null)}},sphere:{center:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},radius:i.default.number().unsafe().allow(1/0).allow(null)}},target:{cube:{min:{x:i.default.number().unsafe().allow(-1/0).allow(null),y:i.default.number().unsafe().allow(-1/0).allow(null),z:i.default.number().unsafe().allow(-1/0).allow(null)},max:{x:i.default.number().unsafe().allow(1/0).allow(null),y:i.default.number().unsafe().allow(1/0).allow(null),z:i.default.number().unsafe().allow(1/0).allow(null)}},sphere:{center:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},radius:i.default.number().unsafe().allow(1/0).allow(null)}},rotation:{minPolarAngle:i.default.number().unsafe(),maxPolarAngle:i.default.number().unsafe(),minAzimuthAngle:i.default.number().unsafe().allow(-1/0).allow(null),maxAzimuthAngle:i.default.number().unsafe().allow(1/0).allow(null)},zoom:{minDistance:i.default.number().unsafe(),maxDistance:i.default.number().unsafe().allow(1/0).allow(null)}}),rotationSpeed:i.default.number().unsafe().min(0).max(1),panSpeed:i.default.number().unsafe().min(0).max(1),zoomSpeed:i.default.number().unsafe().min(0).max(1)}),o=i.default.object({damping:i.default.number().unsafe().min(0).max(1),enableKeyPan:i.default.boolean(),enablePan:i.default.boolean(),enableZoom:i.default.boolean(),input:{keys:{up:i.default.number().unsafe(),down:i.default.number().unsafe(),left:i.default.number().unsafe(),right:i.default.number().unsafe()},mouse:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()},touch:{rotate:i.default.number().unsafe(),zoom:i.default.number().unsafe(),pan:i.default.number().unsafe()}},keyPanSpeed:i.default.number().unsafe().min(0).max(1),movementSmoothness:i.default.number().unsafe().min(0).max(1),panSpeed:i.default.number().unsafe().min(0).max(1),zoomSpeed:i.default.number().unsafe().min(0).max(1)}),a=i.default.object({name:i.default.string().optional(),type:i.default.string(),autoAdjust:i.default.boolean(),cameraMovementDuration:i.default.number().unsafe().min(0),controls:o,enableCameraControls:i.default.boolean(),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},revertAtMouseUp:i.default.boolean(),revertAtMouseUpDuration:i.default.number().unsafe().min(0),target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},zoomExtentsFactor:i.default.number().unsafe().positive()}),l=i.default.object({name:i.default.string().optional(),type:i.default.string(),autoAdjust:i.default.boolean(),cameraMovementDuration:i.default.number().unsafe().min(0),controls:n,enableCameraControls:i.default.boolean(),fov:i.default.number().unsafe().positive(),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},revertAtMouseUp:i.default.boolean(),revertAtMouseUpDuration:i.default.number().unsafe().min(0),target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},zoomExtentsFactor:i.default.number().unsafe().positive()}),c=i.default.object().pattern(/^/,[l,a]),u=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0)}),h=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),direction:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},castShadow:i.default.boolean(),shadowMapResolution:i.default.number().unsafe().optional(),shadowMapBias:i.default.number().unsafe().optional()}),d=i.default.object({skyColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),groundColor:i.default.alternatives([i.default.number().unsafe(),i.default.string()])}),f=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},distance:i.default.number().unsafe().min(0),decay:i.default.number().unsafe().min(0)}),p=i.default.object({color:i.default.alternatives([i.default.number().unsafe(),i.default.string()]),intensity:i.default.number().unsafe().min(0),position:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},target:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},distance:i.default.number().unsafe().min(0),decay:i.default.number().unsafe().min(0),angle:i.default.number().unsafe().min(0),penumbra:i.default.number().unsafe().min(0)}),m=i.default.object().pattern(/^/,[i.default.object({name:i.default.string().optional(),lights:i.default.object().pattern(/^/,[i.default.object({name:i.default.string().optional(),type:i.default.string(),order:i.default.number().unsafe().optional(),properties:i.default.alternatives([u,h,d,f,p])})])})]),g=i.default.object({build_date:i.default.string().allow("").optional(),build_version:i.default.string().allow("").optional(),settings_version:i.default.string(),ar:i.default.object({enable:i.default.boolean(),autoScaling:i.default.boolean()}).optional(),camera:{cameraId:i.default.string().allow(""),cameras:c},environment:{clearAlpha:i.default.number().unsafe().min(0).max(1),clearColor:i.default.string(),map:i.default.alternatives([i.default.string().allow(""),i.default.array().items(i.default.string())]),mapAsBackground:i.default.boolean(),mapResolution:i.default.string()},environmentGeometry:{gridColor:i.default.string(),gridVisibility:i.default.boolean(),groundPlaneColor:i.default.string(),groundPlaneVisibility:i.default.boolean()},general:{transformation:{scale:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},translation:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()},rotation:{x:i.default.number().unsafe(),y:i.default.number().unsafe(),z:i.default.number().unsafe()}},blurWhenBusy:i.default.boolean(),commitSettings:i.default.boolean(),commitParameters:i.default.boolean(),pointSize:i.default.number().unsafe().min(0),showMessages:i.default.boolean()},light:{lightSceneId:i.default.string().allow("").optional(),lightScenes:m},rendering:{ambientOcclusion:i.default.boolean(),ambientOcclusionIntensity:i.default.number().unsafe().positive().max(1),beautyRenderDelay:i.default.number().unsafe().min(0),beautyRenderBlendingDuration:i.default.number().unsafe().min(0),outputEncoding:i.default.string(),physicallyCorrectLights:i.default.boolean(),shadows:i.default.boolean(),textureEncoding:i.default.string(),toneMapping:i.default.string(),toneMappingExposure:i.default.number().unsafe().min(0)},session:i.default.object().pattern(/^/,[i.default.object({order:i.default.number().unsafe().optional(),displayname:i.default.string().allow("").optional(),hidden:i.default.boolean().optional()})])}).options({presence:"required"});e.exports.validate=e=>{e=i.default.attempt(e,g).value}})),s.register("jZeEa",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.convertToPrevious=e.exports.convertFromPrevious=void 0;var r=s("jah3h"),i=s("7Moja");e.exports.convertFromPrevious=(e,t)=>{const r=i.Defaults(),n=e;return r.ar=n.ar,r.build_date=n.build_date,r.build_version=n.build_version,r.camera=n.camera,r.environment=n.environment,r.general=n.general,r.light=n.light,r.environmentGeometry.gridVisibility=n.environmentGeometry.gridVisibility,r.environmentGeometry.groundPlaneVisibility=n.environmentGeometry.groundPlaneVisibility,r.rendering.ambientOcclusion=n.rendering.ambientOcclusion,r.rendering.ambientOcclusionIntensity=n.rendering.ambientOcclusionIntensity,r.rendering.beautyRenderBlendingDuration=n.rendering.beautyRenderBlendingDuration,r.rendering.beautyRenderDelay=n.rendering.beautyRenderDelay,r.rendering.shadows=n.rendering.shadows,r.session=n.session,"3.0"===t?(r.environmentGeometry.gridColor="#ffffff",r.environmentGeometry.groundPlaneColor="#d3d3d3",r.rendering.outputEncoding="linear",r.rendering.physicallyCorrectLights=!1,r.rendering.textureEncoding="linear",r.rendering.toneMapping="none",r.rendering.toneMappingExposure=1):(r.environmentGeometry.gridColor="#ffffff",r.environmentGeometry.groundPlaneColor="#d3d3d3",r.rendering.outputEncoding="srgb",r.rendering.physicallyCorrectLights=!1,r.rendering.textureEncoding="srgb",r.rendering.toneMapping="none",r.rendering.toneMappingExposure=1),r};e.exports.convertToPrevious=(e,t)=>{const i=r.Defaults(),n=e;return i.ar=n.ar,i.build_date=n.build_date,i.build_version=n.build_version,i.camera=n.camera,i.environment=n.environment,i.environmentGeometry.gridVisibility=n.environmentGeometry.gridVisibility,i.environmentGeometry.groundPlaneVisibility=n.environmentGeometry.groundPlaneVisibility,i.general=n.general,i.light=n.light,i.rendering.ambientOcclusion=n.rendering.ambientOcclusion,i.rendering.ambientOcclusionIntensity=n.rendering.ambientOcclusionIntensity,i.rendering.beautyRenderBlendingDuration=n.rendering.beautyRenderBlendingDuration,i.rendering.beautyRenderDelay=n.rendering.beautyRenderDelay,i.rendering.shadows=n.rendering.shadows,i.session=n.session,i}})),s.register("420xc",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.StateEngine=void 0,s("yoicn");var n=s("bJEmL"),o=s("crO5Z"),a=s("cTTbu"),l=s("6Vz59");let c=class{constructor(){this._customStates={},this._eventEngine=n.instance.resolve(a.EventEngine),this._sessions={},this._viewers={},this._boundingBoxCreated=new l.StatePromise,this._fontLoaded=new l.StatePromise,this._primarySessionAvailable=new l.StatePromise}get boundingBoxCreated(){return this._boundingBoxCreated}get fontLoaded(){return this._fontLoaded}get primarySessionAvailable(){return this._primarySessionAvailable}get primarySession(){for(let e in this.sessions)if(this.sessions[e].primary)return this.sessions[e];return null}get sessions(){return this._sessions}get viewers(){return this._viewers}};c=r([o.default(),i("design:paramtypes",[])],c),e.exports.StateEngine=c})),s.register("6Vz59",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.StatePromise=void 0;e.exports.StatePromise=class{constructor(){this._resolved=!1,this._callbacks=[],this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})),this._promise.finally((()=>{this._resolved=!0}))}get resolved(){return this._resolved}get resolve(){return this._resolve}get reject(){return this._reject}then(e){return r(this,void 0,void 0,(function*(){this._callbacks.push(e),!0===this.resolved?e():this._promise.then(e)}))}reset(){this._resolved=!1,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})),this._promise.finally((()=>{this._resolved=!0}));const e=[...this._callbacks];this._callbacks=[];for(let t=0;t<e.length;t++)this.then(e[t])}}})),s.register("79hWK",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SystemInfo=void 0,s("yoicn");var o=s("crO5Z");const a=n(s("86Wyx"));let l=class{constructor(){this._parser=new a.default;const e="undefined"!=typeof window&&window.navigator&&window.navigator.userAgent.indexOf("Trident")>-1;this._isBrowser=e||"undefined"!=typeof document&&"function"==typeof document.getElementById&&window&&"function"==typeof window.Event,this._isIframe=!1,this._isBrowser?(this._isIframe=parent!==window,this._origin=this._isIframe?document.referrer:window.location.origin):this._origin="direct"}get isIOS(){return"iOS"===this._parser.getOS().name||window.navigator&&5===window.navigator.maxTouchPoints&&"MacIntel"===window.navigator.platform}get isAndroid(){return"Android"===this._parser.getOS().name}get isMobile(){const e=this._parser.getDevice().type;return"mobile"===e||"tablet"===e}get isIE(){const e=this._parser.getBrowser().name;return!(!e||!e.includes("IE"))}get isChrome(){const e=this._parser.getBrowser().name;return!(!e||!e.includes("Chrome"))}get isSafari(){const e=this._parser.getBrowser().name;return!(!e||!e.includes("Safari"))}get isFirefox(){const e=this._parser.getBrowser().name;return!(!e||!e.includes("Firefox"))}get isBrowser(){return this._isBrowser}get isIframe(){return this._isIframe}get origin(){return this._origin+""}};l=r([o.default(),i("design:paramtypes",[])],l),e.exports.SystemInfo=l})),s.register("86Wyx",(function(e,t){!function(r,i){var n="function",s="undefined",o="object",a="string",l="model",c="name",u="type",h="vendor",d="version",f="architecture",p="console",m="mobile",g="tablet",v="smarttv",_="wearable",b="embedded",y="Amazon",E="Apple",w="ASUS",x="BlackBerry",A="Firefox",T="Google",S="Huawei",M="LG",C="Microsoft",R="Motorola",I="Opera",O="Samsung",P="Sony",k="Xiaomi",L="Zebra",N="Facebook",G=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},D=function(e,t){return typeof e===a&&-1!==U(t).indexOf(U(e))},U=function(e){return e.toLowerCase()},V=function(e,t){if(typeof e===a)return e=e.replace(/^\s\s*/,"").replace(/\s\s*$/,""),typeof t===s?e:e.substring(0,255)},B=function(e,t){for(var r,s,a,l,c,u,h=0;h<t.length&&!c;){var d=t[h],f=t[h+1];for(r=s=0;r<d.length&&!c;)if(c=d[r++].exec(e))for(a=0;a<f.length;a++)u=c[++s],typeof(l=f[a])===o&&l.length>0?2===l.length?typeof l[1]==n?this[l[0]]=l[1].call(this,u):this[l[0]]=l[1]:3===l.length?typeof l[1]!==n||l[1].exec&&l[1].test?this[l[0]]=u?u.replace(l[1],l[2]):i:this[l[0]]=u?l[1].call(this,u,l[2]):i:4===l.length&&(this[l[0]]=u?l[3].call(this,u.replace(l[1],l[2])):i):this[l]=u||i;h+=2}},F=function(e,t){for(var r in t)if(typeof t[r]===o&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(D(t[r][n],e))return"?"===r?i:r}else if(D(t[r],e))return"?"===r?i:r;return e},j={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},z={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[c,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[c,d],[/opios[\/ ]+([\w\.]+)/i],[d,[c,"Opera Mini"]],[/\bopr\/([\w\.]+)/i],[d,[c,I]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,d],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[d,[c,"UCBrowser"]],[/\bqbcore\/([\w\.]+)/i],[d,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[c,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[d,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure Browser"],d],[/\bfocus\/([\w\.]+)/i],[d,[c,"Firefox Focus"]],[/\bopt\/([\w\.]+)/i],[d,[c,"Opera Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[d,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[c,"Opera Coast"]],[/miuibrowser\/([\w\.]+)/i],[d,[c,"MIUI Browser"]],[/fxios\/([-\w\.]+)/i],[d,[c,A]],[/\bqihu|(qi?ho?o?|360)browser/i],[[c,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],d],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[c,d],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[c],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[c,N],d],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[c,d],[/\bgsa\/([\w\.]+) .*safari\//i],[d,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[d,[c,"Chrome Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[c,"Chrome WebView"],d],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[d,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[c,d],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[d,[c,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[d,c],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[c,[d,F,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[c,d],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[c,"Netscape"],d],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[d,[c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[c,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,U]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[f,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/windows (ce|mobile); ppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[f,/ower/,"",U]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[f,U]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[h,O],[u,g]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[h,O],[u,m]],[/\((ip(?:hone|od)[\w ]*);/i],[l,[h,E],[u,m]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[h,E],[u,g]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[h,S],[u,g]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[l,[h,S],[u,m]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[h,k],[u,m]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[h,k],[u,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[h,"OPPO"],[u,m]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[h,"Vivo"],[u,m]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[l,[h,"Realme"],[u,m]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[h,R],[u,m]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[h,R],[u,g]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[h,M],[u,g]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[h,M],[u,m]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[h,"Lenovo"],[u,g]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[h,"Nokia"],[u,m]],[/(pixel c)\b/i],[l,[h,T],[u,g]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[h,T],[u,m]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[h,P],[u,m]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[h,P],[u,g]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[h,"OnePlus"],[u,m]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[h,y],[u,g]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[h,y],[u,m]],[/(playbook);[-\w\),; ]+(rim)/i],[l,h,[u,g]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[h,x],[u,m]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[h,w],[u,g]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[h,w],[u,m]],[/(nexus 9)/i],[l,[h,"HTC"],[u,g]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[h,[l,/_/g," "],[u,m]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[h,"Acer"],[u,g]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[h,"Meizu"],[u,m]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[h,"Sharp"],[u,m]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,l,[u,m]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,l,[u,g]],[/(surface duo)/i],[l,[h,C],[u,g]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[h,"Fairphone"],[u,m]],[/(u304aa)/i],[l,[h,"AT&T"],[u,m]],[/\bsie-(\w*)/i],[l,[h,"Siemens"],[u,m]],[/\b(rct\w+) b/i],[l,[h,"RCA"],[u,g]],[/\b(venue[\d ]{2,7}) b/i],[l,[h,"Dell"],[u,g]],[/\b(q(?:mv|ta)\w+) b/i],[l,[h,"Verizon"],[u,g]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[h,"Barnes & Noble"],[u,g]],[/\b(tm\d{3}\w+) b/i],[l,[h,"NuVision"],[u,g]],[/\b(k88) b/i],[l,[h,"ZTE"],[u,g]],[/\b(nx\d{3}j) b/i],[l,[h,"ZTE"],[u,m]],[/\b(gen\d{3}) b.+49h/i],[l,[h,"Swiss"],[u,m]],[/\b(zur\d{3}) b/i],[l,[h,"Swiss"],[u,g]],[/\b((zeki)?tb.*\b) b/i],[l,[h,"Zeki"],[u,g]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],l,[u,g]],[/\b(ns-?\w{0,9}) b/i],[l,[h,"Insignia"],[u,g]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[h,"NextBook"],[u,g]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],l,[u,m]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],l,[u,m]],[/\b(ph-1) /i],[l,[h,"Essential"],[u,m]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[h,"Envizen"],[u,g]],[/\b(trio[-\w\. ]+) b/i],[l,[h,"MachSpeed"],[u,g]],[/\btu_(1491) b/i],[l,[h,"Rotor"],[u,g]],[/(shield[\w ]+) b/i],[l,[h,"Nvidia"],[u,g]],[/(sprint) (\w+)/i],[h,l,[u,m]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[h,C],[u,m]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[h,L],[u,g]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[h,L],[u,m]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,l,[u,p]],[/droid.+; (shield) bui/i],[l,[h,"Nvidia"],[u,p]],[/(playstation [345portablevi]+)/i],[l,[h,P],[u,p]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[h,C],[u,p]],[/smart-tv.+(samsung)/i],[h,[u,v]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[h,O],[u,v]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,M],[u,v]],[/(apple) ?tv/i],[h,[l,"Apple TV"],[u,v]],[/crkey/i],[[l,"Chromecast"],[h,T],[u,v]],[/droid.+aft(\w)( bui|\))/i],[l,[h,y],[u,v]],[/\(dtv[\);].+(aquos)/i],[l,[h,"Sharp"],[u,v]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[h,V],[l,V],[u,v]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[u,v]],[/((pebble))app/i],[h,l,[u,_]],[/droid.+; (glass) \d/i],[l,[h,T],[u,_]],[/droid.+; (wt63?0{2,3})\)/i],[l,[h,L],[u,_]],[/(quest( 2)?)/i],[l,[h,N],[u,_]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[u,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[l,[u,m]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[u,g]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[u,g]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[u,m]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[d,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[c,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,c]],os:[[/microsoft (windows) (vista|xp)/i],[c,d],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[c,[d,F,j]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[c,"Windows"],[d,F,j]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[c,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[c,"Mac OS"],[d,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[d,c],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[c,d],[/\(bb(10);/i],[d,[c,x]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[d,[c,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[d,[c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[c,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[c,"Chromecast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[c,"Chromium OS"],d],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[c,d],[/(sunos) ?([\w\.\d]*)/i],[[c,"Solaris"],d],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[c,d]]},W=function(e,t){if(typeof e===o&&(t=e,e=i),!(this instanceof W))return new W(e,t).getResult();var n=e||(typeof r!==s&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),l=t?function(e,t){var r={};for(var i in e)t[i]&&t[i].length%2==0?r[i]=t[i].concat(e[i]):r[i]=e[i];return r}(z,t):z;return this.getBrowser=function(){var e,t={};return t.name=i,t.version=i,B.call(t,n,l.browser),t.major=typeof(e=t.version)===a?e.replace(/[^\d\.]/g,"").split(".")[0]:i,t},this.getCPU=function(){var e={};return e.architecture=i,B.call(e,n,l.cpu),e},this.getDevice=function(){var e={};return e.vendor=i,e.model=i,e.type=i,B.call(e,n,l.device),e},this.getEngine=function(){var e={};return e.name=i,e.version=i,B.call(e,n,l.engine),e},this.getOS=function(){var e={};return e.name=i,e.version=i,B.call(e,n,l.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===a&&e.length>255?V(e,255):e,this},this.setUA(n),this};W.VERSION="0.7.31",W.BROWSER=G([c,d,"major"]),W.CPU=G([f]),W.DEVICE=G([l,h,u,p,m,v,g,_,b]),W.ENGINE=W.OS=G([c,d]),typeof t!==s?(e.exports&&(t=e.exports=W),t.UAParser=W):typeof define===n&&define.amd?define((function(){return W})):typeof r!==s&&(r.UAParser=W);var H=typeof r!==s&&(r.jQuery||r.Zepto);if(H&&!H.ua){var $=new W;H.ua=$.getResult(),H.ua.get=function(){return $.getUA()},H.ua.set=function(e){$.setUA(e);var t=$.getResult();for(var r in t)H.ua[r]=t[r]}}}("object"==typeof window?window:this)})),s.register("9TywJ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DomEventEngine=void 0,s("yoicn");var r=s("bJEmL"),i=s("7jcCO");e.exports.DomEventEngine=class{constructor(e,t){this._viewerId=e,this._domEventListeners={},this._uuidGenerator=r.instance.resolve(i.UuidGenerator),this._allowListeners={mousewheel:!0,mousedown:!0,mousemove:!0,mouseup:!0,mouseout:!0,touchstart:!0,touchmove:!0,touchend:!0,touchcancel:!0,keydown:!0,contextmenu:!0},this._currentMousePosition={x:0,y:0},this._canvas=t,this._onMouseWheel=this.onMouseWheel.bind(this),this._onMouseDown=this.onMouseDown.bind(this),this._onMouseMove=this.onMouseMove.bind(this),this._onKeyDownMousePositionHelper=this.onKeyDownMousePositionHelper.bind(this),this._onMouseUp=this.onMouseUp.bind(this),this._onTouchStart=this.onTouchStart.bind(this),this._onTouchMove=this.onTouchMove.bind(this),this._onTouchEnd=this.onTouchEnd.bind(this),this._onKeyDown=this.onKeyDown.bind(this),this._onContextMenu=this.onContextMenu.bind(this),this.addEventListeners()}addDomEventListener(e){const t=this._uuidGenerator.create();return this._domEventListeners[t]=e,t}allowEventListeners(e){void 0!==e.mousewheel&&this._allowListeners.mousewheel!==e.mousewheel&&(e.mousewheel?(this._canvas.addEventListener("mousewheel",this._onMouseWheel,{passive:!1}),this._canvas.addEventListener("MozMousePixelScroll",this._onMouseWheel,{passive:!1})):(console.log("remove"),console.log(this._canvas.removeEventListener("mousewheel",this._onMouseWheel,!1)),this._canvas.removeEventListener("MozMousePixelScroll",this._onMouseWheel,!1)),this._allowListeners.mousewheel=e.mousewheel),void 0!==e.mousedown&&this._allowListeners.mousedown!==e.mousedown&&(e.mousedown?this._canvas.addEventListener("mousedown",this._onMouseDown,{passive:!1}):this._canvas.removeEventListener("mousedown",this._onMouseDown,!1),this._allowListeners.mousedown=e.mousedown),void 0!==e.mousemove&&this._allowListeners.mousemove!==e.mousemove&&(e.mousemove?(this._canvas.addEventListener("mousemove",this._onMouseMove,{passive:!1}),window.addEventListener("mousemove",this._onKeyDownMousePositionHelper,{passive:!1})):(this._canvas.removeEventListener("mousemove",this._onMouseMove,!1),window.removeEventListener("mousemove",this._onKeyDownMousePositionHelper,!1)),this._allowListeners.mousemove=e.mousemove),void 0!==e.mouseup&&this._allowListeners.mouseup!==e.mouseup&&(e.mouseup?this._canvas.addEventListener("mouseup",this._onMouseUp,{passive:!1}):this._canvas.removeEventListener("mouseup",this._onMouseUp,!1),this._allowListeners.mouseup=e.mouseup),void 0!==e.mouseout&&this._allowListeners.mouseout!==e.mouseout&&(e.mouseout?this._canvas.addEventListener("mouseout",this._onMouseUp,{passive:!1}):this._canvas.removeEventListener("mouseout",this._onMouseUp,!1),this._allowListeners.mouseout=e.mouseout),void 0!==e.touchstart&&this._allowListeners.touchstart!==e.touchstart&&(e.touchstart?window.addEventListener("touchstart",this._onTouchStart,{passive:!1}):window.removeEventListener("touchstart",this._onTouchStart,!1),this._allowListeners.touchstart=e.touchstart),void 0!==e.touchmove&&this._allowListeners.touchmove!==e.touchmove&&(e.touchmove?window.addEventListener("touchmove",this._onTouchMove,{passive:!1}):window.removeEventListener("touchmove",this._onTouchMove,!1),this._allowListeners.touchmove=e.touchmove),void 0!==e.touchend&&this._allowListeners.touchend!==e.touchend&&(e.touchend?window.addEventListener("touchend",this._onTouchEnd,{passive:!1}):window.removeEventListener("touchend",this._onTouchEnd,!1),this._allowListeners.touchend=e.touchend),void 0!==e.touchcancel&&this._allowListeners.touchcancel!==e.touchcancel&&(e.touchcancel?window.addEventListener("touchcancel",this._onTouchEnd,{passive:!1}):window.removeEventListener("touchcancel",this._onTouchEnd,!1),this._allowListeners.touchcancel=e.touchcancel),void 0!==e.keydown&&this._allowListeners.keydown!==e.keydown&&(e.keydown?window.addEventListener("keydown",this._onKeyDown,{passive:!1}):window.removeEventListener("keydown",this._onKeyDown,!1),this._allowListeners.keydown=e.keydown),void 0!==e.contextmenu&&this._allowListeners.contextmenu!==e.contextmenu&&(e.contextmenu?this._canvas.addEventListener("contextmenu",this._onContextMenu,{passive:!1}):this._canvas.removeEventListener("contextmenu",this._onContextMenu,!1),this._allowListeners.contextmenu=e.contextmenu)}dispose(){this.removeEventListeners()}removeAllDomEventListener(){for(let e in this._domEventListeners)delete this._domEventListeners[e]}removeDomEventListener(e){return!!this._domEventListeners[e]&&(delete this._domEventListeners[e],!0)}addEventListeners(){this._canvas.addEventListener("mousewheel",this._onMouseWheel,{passive:!1}),this._canvas.addEventListener("MozMousePixelScroll",this._onMouseWheel,{passive:!1}),this._canvas.addEventListener("mousedown",this._onMouseDown,{passive:!1}),this._canvas.addEventListener("mousemove",this._onMouseMove,{passive:!1}),this._canvas.addEventListener("mouseup",this._onMouseUp,{passive:!1}),this._canvas.addEventListener("mouseout",this._onMouseUp,{passive:!1}),window.addEventListener("touchstart",this._onTouchStart,{passive:!1}),window.addEventListener("touchmove",this._onTouchMove,{passive:!1}),window.addEventListener("touchend",this._onTouchEnd,{passive:!1}),window.addEventListener("touchcancel",this._onTouchEnd,{passive:!1}),window.addEventListener("keydown",this._onKeyDown,{passive:!1}),window.addEventListener("mousemove",this._onKeyDownMousePositionHelper,{passive:!1}),this._canvas.addEventListener("contextmenu",this._onContextMenu,{passive:!1})}onContextMenu(e){e.preventDefault()}onKeyDown(e){this._canvas===document.elementFromPoint(this._currentMousePosition.x,this._currentMousePosition.y)&&Object.values(this._domEventListeners).forEach((t=>t.onKeyDown(e)))}onKeyDownMousePositionHelper(e){this._currentMousePosition={x:e.pageX,y:e.pageY}}onMouseDown(e){e.preventDefault(),Object.values(this._domEventListeners).forEach((t=>t.onMouseDown(e)))}onMouseMove(e){e.preventDefault(),Object.values(this._domEventListeners).forEach((t=>t.onMouseMove(e)))}onMouseUp(e){e.preventDefault(),Object.values(this._domEventListeners).forEach((t=>t.onMouseUp(e)))}onMouseWheel(e){e.preventDefault(),e.stopPropagation(),Object.values(this._domEventListeners).forEach((t=>t.onMouseWheel(e)))}onTouchEnd(e){e.composedPath().includes(this._canvas)&&(e.preventDefault(),Object.values(this._domEventListeners).forEach((t=>t.onTouchEnd(e))))}onTouchMove(e){e.composedPath().includes(this._canvas)&&(e.preventDefault(),Object.values(this._domEventListeners).forEach((t=>t.onTouchMove(e))))}onTouchStart(e){e.composedPath().includes(this._canvas)&&(e.preventDefault(),Object.values(this._domEventListeners).forEach((t=>t.onTouchStart(e))))}removeEventListeners(){this._canvas.removeEventListener("mousewheel",this._onMouseWheel),this._canvas.removeEventListener("MozMousePixelScroll",this._onMouseWheel),this._canvas.removeEventListener("mousedown",this._onMouseDown,!1),this._canvas.removeEventListener("mousemove",this._onMouseMove,!1),this._canvas.removeEventListener("mouseup",this._onMouseUp,!1),this._canvas.removeEventListener("mouseout",this._onMouseUp,!1),window.removeEventListener("touchstart",this._onTouchStart,!1),window.removeEventListener("touchmove",this._onTouchMove,!1),window.removeEventListener("touchend",this._onTouchEnd,!1),window.removeEventListener("touchcancel",this._onTouchEnd,!1),window.removeEventListener("keydown",this._onKeyDown,!1),window.removeEventListener("mousemove",this._onKeyDownMousePositionHelper,!1),this._canvas.removeEventListener("contextmenu",this._onContextMenu,!1)}}})),s.register("VR2ga",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Converter=void 0;var n=s("eIStk"),o=s("9nbKF");s("yoicn");var a=s("bJEmL"),l=s("crO5Z"),c=s("6UED5");let u=class{constructor(){this._httpClient=a.instance.resolve(c.HttpClient)}tinyColorToString(e){return e.toHex8String()}toHex8Color(e,t="#00fff7"){const r=this.toColor(e,t);return new o.TinyColor(r).toHex8String().replace("#","0x")}toColorArray(e){const t=new o.TinyColor(e).toRgb();return[t.r/255,t.g/255,t.b/255]}toAlpha(e){const t=this.toColor(e);return t.length<=8?1:parseInt(t.slice(t.length-2,t.length),16)/255}toThreeJsColorInput(e){const t=this.toColor(e);return t.slice(0,t.length-2)}processSVG(e){return i(this,void 0,void 0,(function*(){let t=yield new Promise(((t,r)=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.readAsDataURL(e)}));t=t.replace("data:image/svg+xml;base64,",""),t=atob(t);let r=document.createElement("DIV");r.id="svgc",r.innerHTML=t;let n=r.getElementsByTagName("svg"),s=[],o=[];for(let e=0;e<n.length;++e){for(let t=0;t<2;++t){let r=n[e].getElementsByTagName(["image","img"][t]);for(let e=0;e<r.length;++e)"data:"!=r[e].href.baseVal.substring(0,5)&&s.push(r[e].href.baseVal)}let t=n[e].getElementsByTagName("style");for(let e=0;e<t.length;++e){let r,i=/@import\x20url\(\s*(.*?)\s*\);/g;for(;null!==(r=i.exec(t[e].innerHTML));)o.push(r[1]);o=o.filter((function(e,t,r){return r.indexOf(e)===t}))}}let a=[],l=e=>i(this,void 0,void 0,(function*(){if(e.length>0){const r=yield this._httpClient.loadData(e,{responseType:"arraybuffer"});let i=new Uint8Array(r.data),n=i.length,s=[];for(;n--;)s[n]=String.fromCharCode(i[n]);let o=window.btoa(s.join("")),a="data:"+r.headers["content-type"]+";base64,"+o;t=t.replace(e,a)}}));for(let e=0;e<s.length;++e)a.push(l(s[e]));let c=e=>i(this,void 0,void 0,(function*(){let r,n=(yield this._httpClient.get(e,{responseType:"text"})).data,s=[],o=/url\(\s*(.*?)\s*\)/g;for(;null!==(r=o.exec(n));)s.push(r[1]);let a=[],l=e=>i(this,void 0,void 0,(function*(){const t=yield this._httpClient.get(e,{responseType:"arraybuffer"});let r=new Uint8Array(t.data),i=r.length,s=[];for(;i--;)s[i]=String.fromCharCode(r[i]);let o=window.btoa(s.join("")),a="data:"+t.headers["content-type"]+";base64,"+o;e.length>0&&(n=n.replace(e,a))}));for(let e=0;e<s.length;++e)a.push(l(s[e]));yield Promise.all(a),t=t.replace("@import url("+e+");",n)}));for(let e=0;e<o.length;++e)a.push(c(o[e]));yield Promise.all(a);let u="data:image/svg+xml,"+encodeURIComponent(t),h=new Image;h.crossOrigin="Anonymous";const d=new Promise((e=>{h.onload=()=>e()}));return h.src=u,yield d,h}))}toColor(e,t="#00fff7"){if(!e||"default"===e)return t;e.constructor===Float32Array&&(e=Array.from(e));const r=new o.TinyColor(e);if(e instanceof o.TinyColor)return this.tinyColorToString(r);if("number"==typeof e){let r=e.toString(16),i=r.length;i<3?r=r.padStart(3,"0"):i<6?r=r.padStart(6,"0"):i<8&&(r=r.padEnd(8,"0"));let n=new o.TinyColor(r);return n.isValid?this.tinyColorToString(n):t}if(e.isColor&&"function"==typeof e.getHexString){let r=new o.TinyColor(e.getHexString());return r.isValid?this.tinyColorToString(r):t}if(Array.isArray(e)&&(3==e.length||4==e.length)){let r=!0;for(let t=0;t<3;++t)e[t]=parseFloat(e[t]),isNaN(e[t])&&(r=!1);if(!r)return t;let i=new o.TinyColor({r:Math.max(0,Math.min(e[0],255)),g:Math.max(0,Math.min(e[1],255)),b:Math.max(0,Math.min(e[2],255))});if(4==e.length){let t=parseFloat(e[3]);isNaN(t)||i.setAlpha(Math.max(0,Math.min(t,255))/255)}return i.isValid?this.tinyColorToString(i):t}if("string"!=typeof e){let r=new o.TinyColor(e);return r.isValid?this.tinyColorToString(r):t}let i=e.replace("0x","#");if(null!==i.match(/^#[a-f0-9]{6}$/i)){let e=new o.TinyColor(i+"ff");return e.isValid?this.tinyColorToString(e):t}if(null!==i.match(/^#[a-f0-9]{8}$/i)){let e=new o.TinyColor(i);return e.isValid?this.tinyColorToString(e):t}if(null!==i.match(/^#[a-f0-9]{7}$/i)){let e=new o.TinyColor(i.slice(0,7)+"0"+i.slice(-1));return e.isValid?this.tinyColorToString(e):t}let n=new o.TinyColor(i);return n.isValid?this.tinyColorToString(n):t}toVec3(e){return Array.isArray(e)&&e.length>=3&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]?n.fromValues(e[0],e[1],e[2]):!e.x&&0!==e.x||"number"!=typeof e.x||!e.y&&0!==e.y||"number"!=typeof e.y||!e.z&&0!==e.z||"number"!=typeof e.z?!e.X&&0!==e.X||"number"!=typeof e.X||!e.Y&&0!==e.Y||"number"!=typeof e.Y||!e.Z&&0!==e.Z||"number"!=typeof e.Z?n.create():n.fromValues(e.X,e.Y,e.Z):n.fromValues(e.x,e.y,e.z)}responseToImage(e){return i(this,void 0,void 0,(function*(){if("image/svg+xml"===e.headers["content-type"]){return yield this.processSVG(e.data)}{const t=new Image,r=new Promise((e=>{t.onload=()=>e()}));t.crossOrigin="anonymous";let i=yield new Promise(((t,r)=>{const i=new FileReader;i.onloadend=()=>t(i.result),i.readAsDataURL(e.data)}));return t.src=i,yield r,t}}))}};u=r([l.default()],u),e.exports.Converter=u})),s.register("9nbKF",(function(e,r){t(e.exports,"TinyColor",(()=>l)),t(e.exports,"tinycolor",(()=>c));var i=s("82UWo"),n=s("aErMP"),o=s("5BsRb"),a=s("bPjXA"),l=function(){function e(t,r){var n;if(void 0===t&&(t=""),void 0===r&&(r={}),t instanceof e)return t;"number"==typeof t&&(t=i.numberInputToObject(t)),this.originalInput=t;var s=o.inputToRGB(t);this.originalInput=t,this.r=s.r,this.g=s.g,this.b=s.b,this.a=s.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(n=r.format)&&void 0!==n?n:s.format,this.gradientType=r.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=s.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,r=e.g/255,i=e.b/255;return.2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=a.boundAlpha(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.toHsv=function(){var e=i.rgbToHsv(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=i.rgbToHsv(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(r,"%, ").concat(n,"%)"):"hsva(".concat(t,", ").concat(r,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=i.rgbToHsl(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=i.rgbToHsl(this.r,this.g,this.b),t=Math.round(360*e.h),r=Math.round(100*e.s),n=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(r,"%, ").concat(n,"%)"):"hsla(".concat(t,", ").concat(r,"%, ").concat(n,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),i.rgbToHex(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),i.rgbaToHex(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),r=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(r,")"):"rgba(".concat(e,", ").concat(t,", ").concat(r,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*a.bound01(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*a.bound01(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+i.rgbToHex(this.r,this.g,this.b,!1),t=0,r=Object.entries(n.names);t<r.length;t++){var s=r[t],o=s[0];if(e===s[1])return o}return!1},e.prototype.toString=function(e){var t=Boolean(e);e=null!=e?e:this.format;var r=!1,i=this.a<1&&this.a>=0;return t||!i||!e.startsWith("hex")&&"name"!==e?("rgb"===e&&(r=this.toRgbString()),"prgb"===e&&(r=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(r=this.toHexString()),"hex3"===e&&(r=this.toHexString(!0)),"hex4"===e&&(r=this.toHex8String(!0)),"hex8"===e&&(r=this.toHex8String()),"name"===e&&(r=this.toName()),"hsl"===e&&(r=this.toHslString()),"hsv"===e&&(r=this.toHsvString()),r||this.toHexString()):"name"===e&&0===this.a?this.toName():this.toRgbString()},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l+=t/100,r.l=a.clamp01(r.l),new e(r)},e.prototype.brighten=function(t){void 0===t&&(t=10);var r=this.toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(-t/100*255))),r.g=Math.max(0,Math.min(255,r.g-Math.round(-t/100*255))),r.b=Math.max(0,Math.min(255,r.b-Math.round(-t/100*255))),new e(r)},e.prototype.darken=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.l-=t/100,r.l=a.clamp01(r.l),new e(r)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s-=t/100,r.s=a.clamp01(r.s),new e(r)},e.prototype.saturate=function(t){void 0===t&&(t=10);var r=this.toHsl();return r.s+=t/100,r.s=a.clamp01(r.s),new e(r)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var r=this.toHsl(),i=(r.h+t)%360;return r.h=i<0?360+i:i,new e(r)},e.prototype.mix=function(t,r){void 0===r&&(r=50);var i=this.toRgb(),n=new e(t).toRgb(),s=r/100;return new e({r:(n.r-i.r)*s+i.r,g:(n.g-i.g)*s+i.g,b:(n.b-i.b)*s+i.b,a:(n.a-i.a)*s+i.a})},e.prototype.analogous=function(t,r){void 0===t&&(t=6),void 0===r&&(r=30);var i=this.toHsl(),n=360/r,s=[this];for(i.h=(i.h-(n*t>>1)+720)%360;--t;)i.h=(i.h+n)%360,s.push(new e(i));return s},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var r=this.toHsv(),i=r.h,n=r.s,s=r.v,o=[],a=1/t;t--;)o.push(new e({h:i,s:n,v:s})),s=(s+a)%1;return o},e.prototype.splitcomplement=function(){var t=this.toHsl(),r=t.h;return[this,new e({h:(r+72)%360,s:t.s,l:t.l}),new e({h:(r+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var r=this.toRgb(),i=new e(t).toRgb();return new e({r:i.r+(r.r-i.r)*r.a,g:i.g+(r.g-i.g)*r.a,b:i.b+(r.b-i.b)*r.a})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var r=this.toHsl(),i=r.h,n=[this],s=360/t,o=1;o<t;o++)n.push(new e({h:(i+o*s)%360,s:r.s,l:r.l}));return n},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}();function c(e,t){return void 0===e&&(e=""),void 0===t&&(t={}),new l(e,t)}})),s.register("82UWo",(function(e,r){t(e.exports,"rgbToRgb",(()=>n)),t(e.exports,"rgbToHsl",(()=>o)),t(e.exports,"hslToRgb",(()=>l)),t(e.exports,"rgbToHsv",(()=>c)),t(e.exports,"hsvToRgb",(()=>u)),t(e.exports,"rgbToHex",(()=>h)),t(e.exports,"rgbaToHex",(()=>d)),t(e.exports,"convertHexToDecimal",(()=>p)),t(e.exports,"parseIntFromHex",(()=>m)),t(e.exports,"numberInputToObject",(()=>g));var i=s("bPjXA");function n(e,t,r){return{r:255*i.bound01(e,255),g:255*i.bound01(t,255),b:255*i.bound01(r,255)}}function o(e,t,r){e=i.bound01(e,255),t=i.bound01(t,255),r=i.bound01(r,255);var n=Math.max(e,t,r),s=Math.min(e,t,r),o=0,a=0,l=(n+s)/2;if(n===s)a=0,o=0;else{var c=n-s;switch(a=l>.5?c/(2-n-s):c/(n+s),n){case e:o=(t-r)/c+(t<r?6:0);break;case t:o=(r-e)/c+2;break;case r:o=(e-t)/c+4}o/=6}return{h:o,s:a,l:l}}function a(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*r*(t-e):r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function l(e,t,r){var n,s,o;if(e=i.bound01(e,360),t=i.bound01(t,100),r=i.bound01(r,100),0===t)s=r,o=r,n=r;else{var l=r<.5?r*(1+t):r+t-r*t,c=2*r-l;n=a(c,l,e+1/3),s=a(c,l,e),o=a(c,l,e-1/3)}return{r:255*n,g:255*s,b:255*o}}function c(e,t,r){e=i.bound01(e,255),t=i.bound01(t,255),r=i.bound01(r,255);var n=Math.max(e,t,r),s=Math.min(e,t,r),o=0,a=n,l=n-s,c=0===n?0:l/n;if(n===s)o=0;else{switch(n){case e:o=(t-r)/l+(t<r?6:0);break;case t:o=(r-e)/l+2;break;case r:o=(e-t)/l+4}o/=6}return{h:o,s:c,v:a}}function u(e,t,r){e=6*i.bound01(e,360),t=i.bound01(t,100),r=i.bound01(r,100);var n=Math.floor(e),s=e-n,o=r*(1-t),a=r*(1-s*t),l=r*(1-(1-s)*t),c=n%6;return{r:255*[r,a,o,o,l,r][c],g:255*[l,r,r,a,o,o][c],b:255*[o,o,l,r,r,a][c]}}function h(e,t,r,n){var s=[i.pad2(Math.round(e).toString(16)),i.pad2(Math.round(t).toString(16)),i.pad2(Math.round(r).toString(16))];return n&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function d(e,t,r,n,s){var o=[i.pad2(Math.round(e).toString(16)),i.pad2(Math.round(t).toString(16)),i.pad2(Math.round(r).toString(16)),i.pad2(f(n))];return s&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function f(e){return Math.round(255*parseFloat(e)).toString(16)}function p(e){return m(e)/255}function m(e){return parseInt(e,16)}function g(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}})),s.register("bPjXA",(function(e,r){function i(e,t){(function(e){return"string"==typeof e&&-1!==e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var r=function(e){return"string"==typeof e&&-1!==e.indexOf("%")}(e);return e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),r&&(e=parseInt(String(e*t),10)/100),Math.abs(e-t)<1e-6?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function n(e){return Math.min(1,Math.max(0,e))}function s(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function o(e){return e<=1?"".concat(100*Number(e),"%"):e}function a(e){return 1===e.length?"0"+e:String(e)}t(e.exports,"bound01",(()=>i)),t(e.exports,"clamp01",(()=>n)),t(e.exports,"boundAlpha",(()=>s)),t(e.exports,"convertToPercentage",(()=>o)),t(e.exports,"pad2",(()=>a))})),s.register("aErMP",(function(e,r){t(e.exports,"names",(()=>i));var i={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}})),s.register("5BsRb",(function(e,r){t(e.exports,"inputToRGB",(()=>a));var i=s("82UWo"),n=s("aErMP"),o=s("bPjXA");function a(e){var t={r:0,g:0,b:0},r=1,s=null,a=null,l=null,c=!1,u=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(n.names[e])e=n.names[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var r=h.rgb.exec(e);return r?{r:r[1],g:r[2],b:r[3]}:(r=h.rgba.exec(e))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=h.hsl.exec(e))?{h:r[1],s:r[2],l:r[3]}:(r=h.hsla.exec(e))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=h.hsv.exec(e))?{h:r[1],s:r[2],v:r[3]}:(r=h.hsva.exec(e))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=h.hex8.exec(e))?{r:i.parseIntFromHex(r[1]),g:i.parseIntFromHex(r[2]),b:i.parseIntFromHex(r[3]),a:i.convertHexToDecimal(r[4]),format:t?"name":"hex8"}:(r=h.hex6.exec(e))?{r:i.parseIntFromHex(r[1]),g:i.parseIntFromHex(r[2]),b:i.parseIntFromHex(r[3]),format:t?"name":"hex"}:(r=h.hex4.exec(e))?{r:i.parseIntFromHex(r[1]+r[1]),g:i.parseIntFromHex(r[2]+r[2]),b:i.parseIntFromHex(r[3]+r[3]),a:i.convertHexToDecimal(r[4]+r[4]),format:t?"name":"hex8"}:!!(r=h.hex3.exec(e))&&{r:i.parseIntFromHex(r[1]+r[1]),g:i.parseIntFromHex(r[2]+r[2]),b:i.parseIntFromHex(r[3]+r[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(d(e.r)&&d(e.g)&&d(e.b)?(t=i.rgbToRgb(e.r,e.g,e.b),c=!0,u="%"===String(e.r).substr(-1)?"prgb":"rgb"):d(e.h)&&d(e.s)&&d(e.v)?(s=o.convertToPercentage(e.s),a=o.convertToPercentage(e.v),t=i.hsvToRgb(e.h,s,a),c=!0,u="hsv"):d(e.h)&&d(e.s)&&d(e.l)&&(s=o.convertToPercentage(e.s),l=o.convertToPercentage(e.l),t=i.hslToRgb(e.h,s,l),c=!0,u="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(r=e.a)),r=o.boundAlpha(r),{ok:c,format:e.format||u,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:r}}var l="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),c="[\\s|\\(]+(".concat(l,")[,|\\s]+(").concat(l,")[,|\\s]+(").concat(l,")\\s*\\)?"),u="[\\s|\\(]+(".concat(l,")[,|\\s]+(").concat(l,")[,|\\s]+(").concat(l,")[,|\\s]+(").concat(l,")\\s*\\)?"),h={CSS_UNIT:new RegExp(l),rgb:new RegExp("rgb"+c),rgba:new RegExp("rgba"+u),hsl:new RegExp("hsl"+c),hsla:new RegExp("hsla"+u),hsv:new RegExp("hsv"+c),hsva:new RegExp("hsva"+u),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function d(e){return Boolean(h.CSS_UNIT.exec(String(e)))}})),s.register("6UED5",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},o=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HttpClient=void 0;const a=o(s("cPZtJ"));s("yoicn");var l=s("crO5Z");let c=class{constructor(){this._dataCache={},a.default.interceptors.response.use((e=>e),(e=>{throw e}))}addDataLoading(e){this._loadData=e}get(e,t){return n(this,void 0,void 0,(function*(){return a.default(e,Object.assign({method:"get"},t))}))}loadData(e,t={responseType:"blob"}){return n(this,void 0,void 0,(function*(){const r=btoa(e);return this._dataCache[r]||(this._dataCache[r]=new Promise((r=>n(this,void 0,void 0,(function*(){if(this._loadData){const i=yield this._loadData(e,t);r(i)}else{const i=yield this.get(e,t);r(i)}}))))),yield this._dataCache[r]}))}patch(e,t){return n(this,void 0,void 0,(function*(){return a.default(e,Object.assign({method:"patch"},t))}))}post(e,t){return n(this,void 0,void 0,(function*(){return a.default(e,Object.assign({method:"post"},t))}))}put(e,t){return n(this,void 0,void 0,(function*(){return a.default(e,Object.assign({method:"put"},t))}))}removeDataLoading(){this._loadData=void 0}};c=r([l.default(),i("design:paramtypes",[])],c),e.exports.HttpClient=c})),s.register("cPZtJ",(function(e,t){e.exports=s("ayjKE")})),s.register("ayjKE",(function(e,t){var r=s("fHdbl"),i=s("lgmZZ"),n=s("9JuxL"),o=s("4cnLQ");function a(e){var t=new n(e),s=i(n.prototype.request,t);return r.extend(s,n.prototype,t),r.extend(s,t),s}var l=a(s("bLi0r"));l.Axios=n,l.create=function(e){return a(o(l.defaults,e))},l.Cancel=s("eyLPf"),l.CancelToken=s("2asZy"),l.isCancel=s("1a9Ue"),l.all=function(e){return Promise.all(e)},l.spread=s("5Qk0d"),l.isAxiosError=s("960e8"),e.exports=l,e.exports.default=l})),s.register("fHdbl",(function(e,t){var r=s("lgmZZ"),i=Object.prototype.toString;function n(e){return"[object Array]"===i.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function l(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function c(e){return"[object Function]"===i.call(e)}function u(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),n(e))for(var r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}e.exports={isArray:n,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:l,isUndefined:o,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:c,isStream:function(e){return a(e)&&c(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:u,merge:function e(){var t={};function r(r,i){l(t[i])&&l(r)?t[i]=e(t[i],r):l(r)?t[i]=e({},r):n(r)?t[i]=r.slice():t[i]=r}for(var i=0,s=arguments.length;i<s;i++)u(arguments[i],r);return t},extend:function(e,t,i){return u(t,(function(t,n){e[n]=i&&"function"==typeof t?r(t,i):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}})),s.register("lgmZZ",(function(e,t){e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return e.apply(t,r)}}})),s.register("9JuxL",(function(e,t){var r=s("fHdbl"),i=s("eTPq0"),n=s("8RJxN"),o=s("19R2Y"),a=s("4cnLQ"),l=s("dNhVt"),c=l.validators;function u(e){this.defaults=e,this.interceptors={request:new n,response:new n}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&l.assertOptions(t,{silentJSONParsing:c.transitional(c.boolean,"1.0.0"),forcedJSONParsing:c.transitional(c.boolean,"1.0.0"),clarifyTimeoutError:c.transitional(c.boolean,"1.0.0")},!1);var r=[],i=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(i=i&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var n,s=[];if(this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)})),!i){var u=[o,void 0];for(Array.prototype.unshift.apply(u,r),u=u.concat(s),n=Promise.resolve(e);u.length;)n=n.then(u.shift(),u.shift());return n}for(var h=e;r.length;){var d=r.shift(),f=r.shift();try{h=d(h)}catch(e){f(e);break}}try{n=o(h)}catch(e){return Promise.reject(e)}for(;s.length;)n=n.then(s.shift(),s.shift());return n},u.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,i){return this.request(a(i||{},{method:e,url:t,data:r}))}})),e.exports=u})),s.register("eTPq0",(function(e,t){var r=s("fHdbl");function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var o=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),o.push(i(t)+"="+i(e))})))})),s=o.join("&")}if(s){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}})),s.register("8RJxN",(function(e,t){var r=s("fHdbl");function i(){this.handlers=[]}i.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i})),s.register("19R2Y",(function(e,t){var r=s("fHdbl"),i=s("4qHbj"),n=s("1a9Ue"),o=s("bLi0r");function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return n(t)||(a(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}})),s.register("4qHbj",(function(e,t){var r=s("fHdbl"),i=s("bLi0r");e.exports=function(e,t,n){var s=this||i;return r.forEach(n,(function(r){e=r.call(s,e,t)})),e}})),s.register("bLi0r",(function(e,t){var r=s("hPtJY"),i=s("fHdbl"),n=s("i6XaP"),o=s("jHsi2"),a={"Content-Type":"application/x-www-form-urlencoded"};function l(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==r&&"[object process]"===Object.prototype.toString.call(r))&&(c=s("lUPeK")),c),transformRequest:[function(e,t){return n(t,"Accept"),n(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(l(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(l(t,"application/json"),function(e,t,r){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,s=!r&&"json"===this.responseType;if(s||n&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw o(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){u.headers[e]=i.merge(a)})),e.exports=u})),s.register("i6XaP",(function(e,t){var r=s("fHdbl");e.exports=function(e,t){r.forEach(e,(function(r,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[i])}))}})),s.register("jHsi2",(function(e,t){e.exports=function(e,t,r,i,n){return e.config=t,r&&(e.code=r),e.request=i,e.response=n,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}})),s.register("lUPeK",(function(e,t){var r=s("fHdbl"),i=s("g9jRf"),n=s("6GXSw"),o=s("eTPq0"),a=s("bbdni"),l=s("cfy1n"),c=s("9m4Se"),u=s("gOyPr");e.exports=function(e){return new Promise((function(t,s){var h=e.data,d=e.headers,f=e.responseType;r.isFormData(h)&&delete d["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";d.Authorization="Basic "+btoa(m+":"+g)}var v=a(e.baseURL,e.url);function _(){if(p){var r="getAllResponseHeaders"in p?l(p.getAllResponseHeaders()):null,n={data:f&&"text"!==f&&"json"!==f?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:e,request:p};i(t,s,n),p=null}}if(p.open(e.method.toUpperCase(),o(v,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,"onloadend"in p?p.onloadend=_:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(_)},p.onabort=function(){p&&(s(u("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){s(u("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),s(u(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",p)),p=null},r.isStandardBrowserEnv()){var b=(e.withCredentials||c(v))&&e.xsrfCookieName?n.read(e.xsrfCookieName):void 0;b&&(d[e.xsrfHeaderName]=b)}"setRequestHeader"in p&&r.forEach(d,(function(e,t){void 0===h&&"content-type"===t.toLowerCase()?delete d[t]:p.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),f&&"json"!==f&&(p.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),s(e),p=null)})),h||(h=null),p.send(h)}))}})),s.register("g9jRf",(function(e,t){var r=s("gOyPr");e.exports=function(e,t,i){var n=i.config.validateStatus;i.status&&n&&!n(i.status)?t(r("Request failed with status code "+i.status,i.config,null,i.request,i)):e(i)}})),s.register("gOyPr",(function(e,t){var r=s("jHsi2");e.exports=function(e,t,i,n,s){var o=new Error(e);return r(o,t,i,n,s)}})),s.register("6GXSw",(function(e,t){var r=s("fHdbl");e.exports=r.isStandardBrowserEnv()?{write:function(e,t,i,n,s,o){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(i)&&a.push("expires="+new Date(i).toGMTString()),r.isString(n)&&a.push("path="+n),r.isString(s)&&a.push("domain="+s),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}})),s.register("bbdni",(function(e,t){var r=s("74CWe"),i=s("kzc9t");e.exports=function(e,t){return e&&!r(t)?i(e,t):t}})),s.register("74CWe",(function(e,t){e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}})),s.register("kzc9t",(function(e,t){e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}})),s.register("cfy1n",(function(e,t){var r=s("fHdbl"),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,o={};return e?(r.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(o[t]&&i.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}})),s.register("9m4Se",(function(e,t){var r=s("fHdbl");e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),i=document.createElement("a");function n(e){var r=e;return t&&(i.setAttribute("href",r),r=i.href),i.setAttribute("href",r),{href:i.href,protocol:i.protocol?i.protocol.replace(/:$/,""):"",host:i.host,search:i.search?i.search.replace(/^\?/,""):"",hash:i.hash?i.hash.replace(/^#/,""):"",hostname:i.hostname,port:i.port,pathname:"/"===i.pathname.charAt(0)?i.pathname:"/"+i.pathname}}return e=n(window.location.href),function(t){var i=r.isString(t)?n(t):t;return i.protocol===e.protocol&&i.host===e.host}}():function(){return!0}})),s.register("1a9Ue",(function(e,t){e.exports=function(e){return!(!e||!e.__CANCEL__)}})),s.register("4cnLQ",(function(e,t){var r=s("fHdbl");e.exports=function(e,t){t=t||{};var i={},n=["url","method","data"],s=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function l(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function c(n){r.isUndefined(t[n])?r.isUndefined(e[n])||(i[n]=l(void 0,e[n])):i[n]=l(e[n],t[n])}r.forEach(n,(function(e){r.isUndefined(t[e])||(i[e]=l(void 0,t[e]))})),r.forEach(s,c),r.forEach(o,(function(n){r.isUndefined(t[n])?r.isUndefined(e[n])||(i[n]=l(void 0,e[n])):i[n]=l(void 0,t[n])})),r.forEach(a,(function(r){r in t?i[r]=l(e[r],t[r]):r in e&&(i[r]=l(void 0,e[r]))}));var u=n.concat(s).concat(o).concat(a),h=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return r.forEach(h,c),i}})),s.register("dNhVt",(function(e,t){var r=s("aIQLV"),i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var n={},o=r.version.split(".");function a(e,t){for(var r=t?t.split("."):o,i=e.split("."),n=0;n<3;n++){if(r[n]>i[n])return!0;if(r[n]<i[n])return!1}return!1}i.transitional=function(e,t,i){var s=t&&a(t);function o(e,t){return"[Axios v"+r.version+"] Transitional option '"+e+"'"+t+(i?". "+i:"")}return function(r,i,a){if(!1===e)throw new Error(o(i," has been removed in "+t));return s&&!n[i]&&(n[i]=!0,console.warn(o(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,i,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var i=Object.keys(e),n=i.length;n-- >0;){var s=i[n],o=t[s];if(o){var a=e[s],l=void 0===a||o(a,s,e);if(!0!==l)throw new TypeError("option "+s+" must be "+l)}else if(!0!==r)throw Error("Unknown option "+s)}},validators:i}})),s.register("aIQLV",(function(e,t){e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')})),s.register("eyLPf",(function(e,t){function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r})),s.register("2asZy",(function(e,t){var r=s("eyLPf");function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var i=this;e((function(e){i.reason||(i.reason=new r(e),t(i.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i})),s.register("5Qk0d",(function(e,t){e.exports=function(e){return function(t){return e.apply(null,t)}}})),s.register("960e8",(function(e,t){e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}})),s.register("htXxy",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.InputValidator=void 0,s("yoicn");var n=s("bJEmL"),o=s("crO5Z");const a=i(s("i8Fxz"));var l=s("iKVTL"),c=s("1Gbku"),u=s("jjvja");let h=class{constructor(){this._logger=n.instance.resolve(l.Logger),this._typeChecker=n.instance.resolve(u.TypeChecker)}validateAndError(e,t,r,i,n=!0,s=[]){if(this.validate(r,i,n,s))return;const o=new c.ShapeDiverViewerValidationError(`${t}: Input could not be validated. ${r} is not of type ${i}.${!1===n?" (Can also be undefined)":""}`,r,i);throw this._logger.handleError(l.LOGGINGTOPIC.GENERAL,"InputValidator.validateAndError",o,!1)}validate(e,t,r=!0,i=[]){if(!1===r&&void 0===e)return!0;switch(t){case"string":if(this._typeChecker.isTypeOf(e,"string"))return!0;break;case"boolean":if(this._typeChecker.isTypeOf(e,"boolean"))return!0;break;case"function":if(this._typeChecker.isTypeOf(e,"function"))return!0;break;case"number":if(this._typeChecker.isTypeOf(e,"number")&&!isNaN(e))return!0;break;case"factor":if(this._typeChecker.isTypeOf(e,"number")&&e>=0&&e<=1)return!0;break;case"positive":if(this._typeChecker.isTypeOf(e,"number")&&e>=0)return!0;break;case"HTMLCanvasElement":if(this._typeChecker.isHTMLCanvasElement(e))return!0;break;case"enum":if(this._typeChecker.isTypeOf(e,"string")&&i.includes(e))return!0;break;case"vec3":if(e.constructor===Float32Array&&(e=Array.from(e)),Array.isArray(e)&&this._typeChecker.isTypeOf(e[0],"number")&&this._typeChecker.isTypeOf(e[1],"number")&&this._typeChecker.isTypeOf(e[2],"number"))return!0;break;case"cubeMap":if(Array.isArray(e)&&6===e.length&&this._typeChecker.isTypeOf(e[0],"string")&&this._typeChecker.isTypeOf(e[1],"string")&&this._typeChecker.isTypeOf(e[2],"string")&&this._typeChecker.isTypeOf(e[3],"string")&&this._typeChecker.isTypeOf(e[4],"string")&&this._typeChecker.isTypeOf(e[5],"string"))return!0;if(this._typeChecker.isTypeOf(e,"string"))return!0;break;case"stringArray":if(Array.isArray(e)){let t=!0;for(let r=0;r<e.length;r++)"string"!=typeof e[r]&&(t=!1);if(!0===t)return!0}break;case"object":if(this._typeChecker.isTypeOf(e,"object"))return!0;break;case"file":if(this._typeChecker.isTypeOf(e,"string")||e instanceof File||e instanceof Blob)return!0;break;case"color":if(this._typeChecker.isTypeOf(e,"string")||Array.isArray(e)&&this._typeChecker.isTypeOf(e[0],"number")&&this._typeChecker.isTypeOf(e[1],"number")&&this._typeChecker.isTypeOf(e[2],"number")||this._typeChecker.isTypeOf(e,"number"))return!0;break;case"mat4":if(e.constructor===Float32Array&&(e=Array.from(e)),Array.isArray(e)&&this._typeChecker.isTypeOf(e[0],"number")&&this._typeChecker.isTypeOf(e[1],"number")&&this._typeChecker.isTypeOf(e[2],"number")&&this._typeChecker.isTypeOf(e[3],"number")&&this._typeChecker.isTypeOf(e[4],"number")&&this._typeChecker.isTypeOf(e[5],"number")&&this._typeChecker.isTypeOf(e[6],"number")&&this._typeChecker.isTypeOf(e[7],"number")&&this._typeChecker.isTypeOf(e[8],"number")&&this._typeChecker.isTypeOf(e[9],"number")&&this._typeChecker.isTypeOf(e[10],"number")&&this._typeChecker.isTypeOf(e[11],"number")&&this._typeChecker.isTypeOf(e[12],"number")&&this._typeChecker.isTypeOf(e[13],"number")&&this._typeChecker.isTypeOf(e[14],"number")&&this._typeChecker.isTypeOf(e[15],"number"))return!0;break;default:return!1}return!1}sanitize(e){return a.default.sanitize(e)}};h=r([o.default()],h),e.exports.InputValidator=h})),s.register("i8Fxz",(function(e,t){
/*! @license DOMPurify 2.3.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.3.6/LICENSE */e.exports,e.exports=function(){function e(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var t=Object.hasOwnProperty,r=Object.setPrototypeOf,i=Object.isFrozen,n=Object.getPrototypeOf,s=Object.getOwnPropertyDescriptor,o=Object.freeze,a=Object.seal,l=Object.create,c="undefined"!=typeof Reflect&&Reflect,u=c.apply,h=c.construct;u||(u=function(e,t,r){return e.apply(t,r)}),o||(o=function(e){return e}),a||(a=function(e){return e}),h||(h=function(t,r){return new(Function.prototype.bind.apply(t,[null].concat(e(r))))});var d=w(Array.prototype.forEach),f=w(Array.prototype.pop),p=w(Array.prototype.push),m=w(String.prototype.toLowerCase),g=w(String.prototype.match),v=w(String.prototype.replace),_=w(String.prototype.indexOf),b=w(String.prototype.trim),y=w(RegExp.prototype.test),E=x(TypeError);function w(e){return function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return u(e,t,i)}}function x(e){return function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return h(e,r)}}function A(e,t){r&&r(e,null);for(var n=t.length;n--;){var s=t[n];if("string"==typeof s){var o=m(s);o!==s&&(i(t)||(t[n]=o),s=o)}e[s]=!0}return e}function T(e){var r=l(null),i=void 0;for(i in e)u(t,e,[i])&&(r[i]=e[i]);return r}function S(e,t){for(;null!==e;){var r=s(e,t);if(r){if(r.get)return w(r.get);if("function"==typeof r.value)return w(r.value)}e=n(e)}function i(e){return console.warn("fallback value for",e),null}return i}var M=o(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),C=o(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),R=o(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),I=o(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),O=o(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),P=o(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),k=o(["#text"]),L=o(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),N=o(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),G=o(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),D=o(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),U=a(/\{\{[\s\S]*|[\s\S]*\}\}/gm),V=a(/<%[\s\S]*|[\s\S]*%>/gm),B=a(/^data-[\-\w.\u00B7-\uFFFF]/),F=a(/^aria-[\-\w]+$/),j=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),z=a(/^(?:\w+script|data):/i),W=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),H=a(/^html$/i),$="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Y(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var q=function(){return"undefined"==typeof window?null:window},X=function(e,t){if("object"!==(void 0===e?"undefined":$(e))||"function"!=typeof e.createPolicy)return null;var r=null,i="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(i)&&(r=t.currentScript.getAttribute(i));var n="dompurify"+(r?"#"+r:"");try{return e.createPolicy(n,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}};function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q(),t=function(e){return Z(e)};if(t.version="2.3.6",t.removed=[],!e||!e.document||9!==e.document.nodeType)return t.isSupported=!1,t;var r=e.document,i=e.document,n=e.DocumentFragment,s=e.HTMLTemplateElement,a=e.Node,l=e.Element,c=e.NodeFilter,u=e.NamedNodeMap,h=void 0===u?e.NamedNodeMap||e.MozNamedAttrMap:u,w=e.HTMLFormElement,x=e.DOMParser,J=e.trustedTypes,K=l.prototype,Q=S(K,"cloneNode"),ee=S(K,"nextSibling"),te=S(K,"childNodes"),re=S(K,"parentNode");if("function"==typeof s){var ie=i.createElement("template");ie.content&&ie.content.ownerDocument&&(i=ie.content.ownerDocument)}var ne=X(J,r),se=ne?ne.createHTML(""):"",oe=i,ae=oe.implementation,le=oe.createNodeIterator,ce=oe.createDocumentFragment,ue=oe.getElementsByTagName,he=r.importNode,de={};try{de=T(i).documentMode?i.documentMode:{}}catch(e){}var fe={};t.isSupported="function"==typeof re&&ae&&void 0!==ae.createHTMLDocument&&9!==de;var pe=U,me=V,ge=B,ve=F,_e=z,be=W,ye=j,Ee=null,we=A({},[].concat(Y(M),Y(C),Y(R),Y(O),Y(k))),xe=null,Ae=A({},[].concat(Y(L),Y(N),Y(G),Y(D))),Te=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Se=null,Me=null,Ce=!0,Re=!0,Ie=!1,Oe=!1,Pe=!1,ke=!1,Le=!1,Ne=!1,Ge=!1,De=!1,Ue=!0,Ve=!0,Be=!1,Fe={},je=null,ze=A({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),We=null,He=A({},["audio","video","img","source","image","track"]),$e=null,Ye=A({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),qe="http://www.w3.org/1998/Math/MathML",Xe="http://www.w3.org/2000/svg",Ze="http://www.w3.org/1999/xhtml",Je=Ze,Ke=!1,Qe=void 0,et=["application/xhtml+xml","text/html"],tt="text/html",rt=void 0,it=null,nt=i.createElement("form"),st=function(e){return e instanceof RegExp||e instanceof Function},ot=function(e){it&&it===e||(e&&"object"===(void 0===e?"undefined":$(e))||(e={}),e=T(e),Ee="ALLOWED_TAGS"in e?A({},e.ALLOWED_TAGS):we,xe="ALLOWED_ATTR"in e?A({},e.ALLOWED_ATTR):Ae,$e="ADD_URI_SAFE_ATTR"in e?A(T(Ye),e.ADD_URI_SAFE_ATTR):Ye,We="ADD_DATA_URI_TAGS"in e?A(T(He),e.ADD_DATA_URI_TAGS):He,je="FORBID_CONTENTS"in e?A({},e.FORBID_CONTENTS):ze,Se="FORBID_TAGS"in e?A({},e.FORBID_TAGS):{},Me="FORBID_ATTR"in e?A({},e.FORBID_ATTR):{},Fe="USE_PROFILES"in e&&e.USE_PROFILES,Ce=!1!==e.ALLOW_ARIA_ATTR,Re=!1!==e.ALLOW_DATA_ATTR,Ie=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Oe=e.SAFE_FOR_TEMPLATES||!1,Pe=e.WHOLE_DOCUMENT||!1,Ne=e.RETURN_DOM||!1,Ge=e.RETURN_DOM_FRAGMENT||!1,De=e.RETURN_TRUSTED_TYPE||!1,Le=e.FORCE_BODY||!1,Ue=!1!==e.SANITIZE_DOM,Ve=!1!==e.KEEP_CONTENT,Be=e.IN_PLACE||!1,ye=e.ALLOWED_URI_REGEXP||ye,Je=e.NAMESPACE||Ze,e.CUSTOM_ELEMENT_HANDLING&&st(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Te.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&st(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Te.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Te.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Qe=Qe=-1===et.indexOf(e.PARSER_MEDIA_TYPE)?tt:e.PARSER_MEDIA_TYPE,rt="application/xhtml+xml"===Qe?function(e){return e}:m,Oe&&(Re=!1),Ge&&(Ne=!0),Fe&&(Ee=A({},[].concat(Y(k))),xe=[],!0===Fe.html&&(A(Ee,M),A(xe,L)),!0===Fe.svg&&(A(Ee,C),A(xe,N),A(xe,D)),!0===Fe.svgFilters&&(A(Ee,R),A(xe,N),A(xe,D)),!0===Fe.mathMl&&(A(Ee,O),A(xe,G),A(xe,D))),e.ADD_TAGS&&(Ee===we&&(Ee=T(Ee)),A(Ee,e.ADD_TAGS)),e.ADD_ATTR&&(xe===Ae&&(xe=T(xe)),A(xe,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&A($e,e.ADD_URI_SAFE_ATTR),e.FORBID_CONTENTS&&(je===ze&&(je=T(je)),A(je,e.FORBID_CONTENTS)),Ve&&(Ee["#text"]=!0),Pe&&A(Ee,["html","head","body"]),Ee.table&&(A(Ee,["tbody"]),delete Se.tbody),o&&o(e),it=e)},at=A({},["mi","mo","mn","ms","mtext"]),lt=A({},["foreignobject","desc","title","annotation-xml"]),ct=A({},C);A(ct,R),A(ct,I);var ut=A({},O);A(ut,P);var ht=function(e){var t=re(e);t&&t.tagName||(t={namespaceURI:Ze,tagName:"template"});var r=m(e.tagName),i=m(t.tagName);if(e.namespaceURI===Xe)return t.namespaceURI===Ze?"svg"===r:t.namespaceURI===qe?"svg"===r&&("annotation-xml"===i||at[i]):Boolean(ct[r]);if(e.namespaceURI===qe)return t.namespaceURI===Ze?"math"===r:t.namespaceURI===Xe?"math"===r&&lt[i]:Boolean(ut[r]);if(e.namespaceURI===Ze){if(t.namespaceURI===Xe&&!lt[i])return!1;if(t.namespaceURI===qe&&!at[i])return!1;var n=A({},["title","style","font","a","script"]);return!ut[r]&&(n[r]||!ct[r])}return!1},dt=function(e){p(t.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=se}catch(t){e.remove()}}},ft=function(e,r){try{p(t.removed,{attribute:r.getAttributeNode(e),from:r})}catch(e){p(t.removed,{attribute:null,from:r})}if(r.removeAttribute(e),"is"===e&&!xe[e])if(Ne||Ge)try{dt(r)}catch(e){}else try{r.setAttribute(e,"")}catch(e){}},pt=function(e){var t=void 0,r=void 0;if(Le)e="<remove></remove>"+e;else{var n=g(e,/^[\r\n\t ]+/);r=n&&n[0]}"application/xhtml+xml"===Qe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var s=ne?ne.createHTML(e):e;if(Je===Ze)try{t=(new x).parseFromString(s,Qe)}catch(e){}if(!t||!t.documentElement){t=ae.createDocument(Je,"template",null);try{t.documentElement.innerHTML=Ke?"":s}catch(e){}}var o=t.body||t.documentElement;return e&&r&&o.insertBefore(i.createTextNode(r),o.childNodes[0]||null),Je===Ze?ue.call(t,Pe?"html":"body")[0]:Pe?t.documentElement:o},mt=function(e){return le.call(e.ownerDocument||e,e,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT,null,!1)},gt=function(e){return e instanceof w&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof h)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore)},vt=function(e){return"object"===(void 0===a?"undefined":$(a))?e instanceof a:e&&"object"===(void 0===e?"undefined":$(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},_t=function(e,r,i){fe[e]&&d(fe[e],(function(e){e.call(t,r,i,it)}))},bt=function(e){var r=void 0;if(_t("beforeSanitizeElements",e,null),gt(e))return dt(e),!0;if(g(e.nodeName,/[\u0080-\uFFFF]/))return dt(e),!0;var i=rt(e.nodeName);if(_t("uponSanitizeElement",e,{tagName:i,allowedTags:Ee}),!vt(e.firstElementChild)&&(!vt(e.content)||!vt(e.content.firstElementChild))&&y(/<[/\w]/g,e.innerHTML)&&y(/<[/\w]/g,e.textContent))return dt(e),!0;if("select"===i&&y(/<template/i,e.innerHTML))return dt(e),!0;if(!Ee[i]||Se[i]){if(!Se[i]&&Et(i)){if(Te.tagNameCheck instanceof RegExp&&y(Te.tagNameCheck,i))return!1;if(Te.tagNameCheck instanceof Function&&Te.tagNameCheck(i))return!1}if(Ve&&!je[i]){var n=re(e)||e.parentNode,s=te(e)||e.childNodes;if(s&&n)for(var o=s.length-1;o>=0;--o)n.insertBefore(Q(s[o],!0),ee(e))}return dt(e),!0}return e instanceof l&&!ht(e)?(dt(e),!0):"noscript"!==i&&"noembed"!==i||!y(/<\/no(script|embed)/i,e.innerHTML)?(Oe&&3===e.nodeType&&(r=e.textContent,r=v(r,pe," "),r=v(r,me," "),e.textContent!==r&&(p(t.removed,{element:e.cloneNode()}),e.textContent=r)),_t("afterSanitizeElements",e,null),!1):(dt(e),!0)},yt=function(e,t,r){if(Ue&&("id"===t||"name"===t)&&(r in i||r in nt))return!1;if(Re&&!Me[t]&&y(ge,t));else if(Ce&&y(ve,t));else if(!xe[t]||Me[t]){if(!(Et(e)&&(Te.tagNameCheck instanceof RegExp&&y(Te.tagNameCheck,e)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(e))&&(Te.attributeNameCheck instanceof RegExp&&y(Te.attributeNameCheck,t)||Te.attributeNameCheck instanceof Function&&Te.attributeNameCheck(t))||"is"===t&&Te.allowCustomizedBuiltInElements&&(Te.tagNameCheck instanceof RegExp&&y(Te.tagNameCheck,r)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(r))))return!1}else if($e[t]);else if(y(ye,v(r,be,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==_(r,"data:")||!We[e])if(Ie&&!y(_e,v(r,be,"")));else if(r)return!1;return!0},Et=function(e){return e.indexOf("-")>0},wt=function(e){var r=void 0,i=void 0,n=void 0,s=void 0;_t("beforeSanitizeAttributes",e,null);var o=e.attributes;if(o){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(s=o.length;s--;){var l=r=o[s],c=l.name,u=l.namespaceURI;if(i=b(r.value),n=rt(c),a.attrName=n,a.attrValue=i,a.keepAttr=!0,a.forceKeepAttr=void 0,_t("uponSanitizeAttribute",e,a),i=a.attrValue,!a.forceKeepAttr&&(ft(c,e),a.keepAttr))if(y(/\/>/i,i))ft(c,e);else{Oe&&(i=v(i,pe," "),i=v(i,me," "));var h=rt(e.nodeName);if(yt(h,n,i))try{u?e.setAttributeNS(u,c,i):e.setAttribute(c,i),f(t.removed)}catch(e){}}}_t("afterSanitizeAttributes",e,null)}},xt=function e(t){var r=void 0,i=mt(t);for(_t("beforeSanitizeShadowDOM",t,null);r=i.nextNode();)_t("uponSanitizeShadowNode",r,null),bt(r)||(r.content instanceof n&&e(r.content),wt(r));_t("afterSanitizeShadowDOM",t,null)};return t.sanitize=function(i,s){var o=void 0,l=void 0,c=void 0,u=void 0,h=void 0;if((Ke=!i)&&(i="\x3c!--\x3e"),"string"!=typeof i&&!vt(i)){if("function"!=typeof i.toString)throw E("toString is not a function");if("string"!=typeof(i=i.toString()))throw E("dirty is not a string, aborting")}if(!t.isSupported){if("object"===$(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof i)return e.toStaticHTML(i);if(vt(i))return e.toStaticHTML(i.outerHTML)}return i}if(ke||ot(s),t.removed=[],"string"==typeof i&&(Be=!1),Be){if(i.nodeName){var d=rt(i.nodeName);if(!Ee[d]||Se[d])throw E("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof a)1===(l=(o=pt("\x3c!----\x3e")).ownerDocument.importNode(i,!0)).nodeType&&"BODY"===l.nodeName||"HTML"===l.nodeName?o=l:o.appendChild(l);else{if(!Ne&&!Oe&&!Pe&&-1===i.indexOf("<"))return ne&&De?ne.createHTML(i):i;if(!(o=pt(i)))return Ne?null:De?se:""}o&&Le&&dt(o.firstChild);for(var f=mt(Be?i:o);c=f.nextNode();)3===c.nodeType&&c===u||bt(c)||(c.content instanceof n&&xt(c.content),wt(c),u=c);if(u=null,Be)return i;if(Ne){if(Ge)for(h=ce.call(o.ownerDocument);o.firstChild;)h.appendChild(o.firstChild);else h=o;return xe.shadowroot&&(h=he.call(r,h,!0)),h}var p=Pe?o.outerHTML:o.innerHTML;return Pe&&Ee["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&y(H,o.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+p),Oe&&(p=v(p,pe," "),p=v(p,me," ")),ne&&De?ne.createHTML(p):p},t.setConfig=function(e){ot(e),ke=!0},t.clearConfig=function(){it=null,ke=!1},t.isValidAttribute=function(e,t,r){it||ot({});var i=rt(e),n=rt(t);return yt(i,n,r)},t.addHook=function(e,t){"function"==typeof t&&(fe[e]=fe[e]||[],p(fe[e],t))},t.removeHook=function(e){fe[e]&&f(fe[e])},t.removeHooks=function(e){fe[e]&&(fe[e]=[])},t.removeAllHooks=function(){fe={}},t}return Z()}()})),s.register("jjvja",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TypeChecker=void 0,s("yoicn");var i=s("crO5Z");let n=class{isTypeOf(e,t){return typeof e===t}isHTMLCanvasElement(e){return e instanceof HTMLCanvasElement}};n=r([i.default()],n),e.exports.TypeChecker=n})),s.register("59pJX",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PerformanceEvaluator=void 0,s("yoicn");var i=s("crO5Z");let n=class{start(e){this._eval={start:e||performance.now(),section:{}}}startSection(e,t){this._eval&&(this._eval.end||(this._eval.section[e]={start:t||performance.now()}))}endSection(e){this._eval&&(this._eval.end||this._eval.section[e]&&(this._eval.section[e].end||(this._eval.section[e].end=performance.now(),this._eval.section[e].duration=this._eval.section[e].end-this._eval.section[e].start)))}end(){this._eval&&(this._eval.end||(this._eval.end=performance.now(),this._eval.duration=this._eval.end-this._eval.start))}getEvaluation(){return this._eval}getEvaluationToString(){return`Performance Evaluation: ${this._eval.duration}ms\n`}};n=r([i.default()],n),e.exports.PerformanceEvaluator=n})),s.register("cwKgx",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MimeTypeUtils=void 0,s("yoicn");var i=s("crO5Z");const n={svg:["image/svg+xml"],svgz:["image/svg+xml"],jpg:["image/jpeg"],jpeg:["image/jpeg"],png:["image/png"],gif:["image/gif"],bmp:["image/bmp"],tif:["image/tif"],tiff:["image/tiff"],gltf:["gltf+json","model/gltf-binary"],glb:["application/octet-stream","model/gltf-binary"],bin:["application/octet-stream","application/gltf-buffer"],"3dm":["model/vnd.3dm","application/3dm","x-world/x-3dmf"],"3ds":["application/x-3ds","image/x-3ds","application/3ds"],fbx:["application/fbx"],dxf:["application/dxf","application/x-autocad","application/x-dxf","drawing/x-dxf","image/vnd.dxf","image/x-autocad","image/x-dxf","zz-application/zz-winassoc-dxf"],dwg:["application/dwg"],pdf:["application/pdf"],"3mf":["model/3mf"],stl:["model/stl","application/sla"],amf:["application/amf"],ai:["application/ai"],dgn:["application/dgn"],ply:["application/ply"],ps:["application/postscript"],eps:["application/postscript"],skp:["application/skp"],slc:["application/slc"],sldprt:["application/sldprt"],sldasm:["application/sldasm"],stp:["application/step"],step:["application/step"],vda:["application/vda"],gdf:["application/gdf"],vrml:["model/vrml","model/x3d-vrml"],wrl:["model/vrml","model/x3d-vrml"],vi:["model/vrml","model/x3d-vrml"],igs:["model/iges","application/iges"],iges:["model/iges","application/iges"],obj:["model/obj","application/wavefront-obj"],off:["application/off"],txt:["text/plain"],mtl:["text/plain"],g:["text/plain"],gcode:["text/plain"],glsl:["text/plain"],csv:["text/csv","application/vnd.ms-excel"],xls:["application/vnd.ms-excel"],xlsx:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],xml:["application/xml","text/xml"],json:["application/json"],ifc:["application/x-step"],ifcxml:["application/xml"],ifczip:["application/zip"],sdtf:["model/vnd.sdtf"],sddtf:["model/vnd.sdtf"]};let o=class{guessMimeTypeFromFilename(e){const t=e.split(".");if(!(t.length>0))return[];const r=t[t.length-1];return Object.keys(n).includes(r)?n[r]:[]}mapMimeTypeToFileEndings(e){const t=[];for(let r=0;r<e.length;r++){const i=Object.keys(n).find((t=>n[t].includes(e[r])));i&&t.push("."+i)}return t}};o=r([i.default()],o),e.exports.MimeTypeUtils=o})),s.register("6UMiq",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Triangle=e.exports.Plane=e.exports.Spherical=e.exports.Sphere=e.exports.Box=void 0;var r=s("cSlIA");Object.defineProperty(e.exports,"Box",{enumerable:!0,get:function(){return r.Box}});var i=s("iiWS0");Object.defineProperty(e.exports,"Plane",{enumerable:!0,get:function(){return i.Plane}});var n=s("nr1Qu");Object.defineProperty(e.exports,"Sphere",{enumerable:!0,get:function(){return n.Sphere}});var o=s("9NXOA");Object.defineProperty(e.exports,"Spherical",{enumerable:!0,get:function(){return o.Spherical}});var a=s("kTc9d");Object.defineProperty(e.exports,"Triangle",{enumerable:!0,get:function(){return a.Triangle}})})),s.register("cSlIA",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Box=void 0;var r=s("eIStk"),i=s("nr1Qu");class n{constructor(e=r.fromValues(1/0,1/0,1/0),t=r.fromValues(-1/0,-1/0,-1/0)){this._min=e,this._max=t,this._boundingSphere=new i.Sphere,this._boundingSphereState={min:r.create(),max:r.create()}}intersect(e,t){let r,i,n,s,o,a,l,c;const u=1/t[0],h=1/t[1],d=1/t[2];return n=u>=0?(this.min[0]-e[0])*u:(this.max[0]-e[0])*u,s=u>=0?(this.max[0]-e[0])*u:(this.min[0]-e[0])*u,r=n,i=s,o=h>=0?(this.min[1]-e[1])*h:(this.max[1]-e[1])*h,a=h>=0?(this.max[1]-e[1])*h:(this.min[1]-e[1])*h,r>a||o>i?null:((o>r||r!=r)&&(r=o),(a<i||i!=i)&&(i=a),l=d>=0?(this.min[2]-e[2])*d:(this.max[2]-e[2])*d,c=d>=0?(this.max[2]-e[2])*d:(this.min[2]-e[2])*d,r>c||l>i?null:((l>r||r!=r)&&(r=l),(c<i||i!=i)&&(i=c),i<0?null:r>=0?r:i))}get boundingSphere(){return this._boundingSphereState.min[0]===this.min[0]&&this._boundingSphereState.min[1]===this.min[1]&&this._boundingSphereState.min[2]===this.min[2]&&this._boundingSphereState.max[0]===this.max[0]&&this._boundingSphereState.max[1]===this.max[1]&&this._boundingSphereState.max[2]===this.max[2]||(this._boundingSphere.setFromBox(this),this._boundingSphereState={min:r.clone(this.min),max:r.clone(this.max)}),this._boundingSphere}get max(){return this._max}set max(e){this._max=e}get min(){return this._min}set min(e){this._min=e}applyMatrix(e){const t=[];t.push(r.transformMat4(r.create(),r.fromValues(this.min[0],this.min[1],this.min[2]),e)),t.push(r.transformMat4(r.create(),r.fromValues(this.min[0],this.min[1],this.max[2]),e)),t.push(r.transformMat4(r.create(),r.fromValues(this.min[0],this.max[1],this.min[2]),e)),t.push(r.transformMat4(r.create(),r.fromValues(this.min[0],this.max[1],this.max[2]),e)),t.push(r.transformMat4(r.create(),r.fromValues(this.max[0],this.min[1],this.min[2]),e)),t.push(r.transformMat4(r.create(),r.fromValues(this.max[0],this.min[1],this.max[2]),e)),t.push(r.transformMat4(r.create(),r.fromValues(this.max[0],this.max[1],this.min[2]),e)),t.push(r.transformMat4(r.create(),r.fromValues(this.max[0],this.max[1],this.max[2]),e)),this.min=r.fromValues(1/0,1/0,1/0),this.max=r.fromValues(-1/0,-1/0,-1/0);for(let e=0,i=t.length;e<i;e++)this.min=r.fromValues(Math.min(this.min[0],t[e][0]),Math.min(this.min[1],t[e][1]),Math.min(this.min[2],t[e][2])),this.max=r.fromValues(Math.max(this.max[0],t[e][0]),Math.max(this.max[1],t[e][1]),Math.max(this.max[2],t[e][2]));return this}clone(){return new n(r.clone(this.min),r.clone(this.max))}containsPoint(e){return!(e[0]<this.min[0]||e[0]>this.max[0]||e[1]<this.min[1]||e[1]>this.max[1]||e[2]<this.min[2]||e[2]>this.max[2])}clampPoint(e){return e[0]=Math.max(this.min[0],Math.min(this.max[0],e[0])),e[1]=Math.max(this.min[1],Math.min(this.max[1],e[1])),e[2]=Math.max(this.min[2],Math.min(this.max[2],e[2])),e}setFromAttributeArray(e){let t=1/0,i=1/0,n=1/0,s=-1/0,o=-1/0,a=-1/0;for(let r=0;r<e.length;r+=3){const l=e[r],c=e[r+1],u=e[r+2];l<t&&(t=l),c<i&&(i=c),u<n&&(n=u),l>s&&(s=l),c>o&&(o=c),u>a&&(a=u)}return this.min=r.fromValues(t,i,n),this.max=r.fromValues(s,o,a),this}union(e){return e.min[0]<this.min[0]&&(this.min[0]=e.min[0]),e.min[1]<this.min[1]&&(this.min[1]=e.min[1]),e.min[2]<this.min[2]&&(this.min[2]=e.min[2]),e.max[0]>this.max[0]&&(this.max[0]=e.max[0]),e.max[1]>this.max[1]&&(this.max[1]=e.max[1]),e.max[2]>this.max[2]&&(this.max[2]=e.max[2]),this}isEmpty(){return this.min[0]===1/0&&this.min[1]===1/0&&this.min[2]===1/0&&this.max[0]===-1/0&&this.max[1]===-1/0&&this.max[2]===-1/0}}e.exports.Box=n})),s.register("nr1Qu",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Sphere=void 0;var r=s("eIStk");class i{constructor(e=r.create(),t=0){this._center=e,this._radius=t}get center(){return this._center}set center(e){this._center=e}get radius(){return this._radius}set radius(e){this._radius=e}applyMatrix(e){this._center=r.transformMat4(r.create(),this._center,e);const t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10],s=Math.sqrt(Math.max(t,i,n));return this.radius=this.radius*s,this}clone(){return new i(r.clone(this._center),this._radius)}containsPoint(e){return r.squaredDistance(e,this.center)<=this.radius*this.radius}clampPoint(e){return e}setFromBox(e){return r.add(this.center,e.min,e.max),r.scale(this.center,this.center,.5),this.radius=.5*r.dist(e.min,e.max),this}}e.exports.Sphere=i})),s.register("iiWS0",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Plane=void 0;var r=s("eIStk"),i=s("bDSmI");class n{constructor(e=r.fromValues(1,0,0),t=0){this._normal=e,this._constant=t}get constant(){return this._constant}set constant(e){this._constant=e}get normal(){return this._normal}set normal(e){this._normal=e}applyMatrix(e){const t=i.transpose(i.create(),i.invert(i.create(),i.fromMat4(i.create(),e))),n=r.transformMat4(r.create(),r.multiply(r.create(),r.clone(this.normal),r.fromValues(this._constant,this._constant,this._constant)),e);return this._normal=r.normalize(r.create(),r.transformMat3(r.create(),this._normal,t)),this.constant=-r.dot(n,this._normal),this}clampPoint(e){const t=-this.distanceToPoint(e);return r.add(r.create(),r.multiply(r.create(),this.normal,r.fromValues(t,t,t)),e)}clone(){return new n(this._normal,this._constant)}containsPoint(e){return 0===this.distanceToPoint(e)}distanceToPoint(e){return r.dot(this.normal,e)+this.constant}intersect(e,t){const i=r.dot(this.normal,t);if(0===i)return 0===this.distanceToPoint(e)?0:null;const n=-(r.dot(e,this.normal)+this.constant)/i;return n<0?null:n}setFromNormalAndCoplanarPoint(e,t){return r.copy(this.normal,e),this.constant=-r.dot(t,this.normal),this}}e.exports.Plane=n})),s.register("9NXOA",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Spherical=void 0;var r=s("eIStk");e.exports.Spherical=class{constructor(e=1,t=0,r=0){this._radius=e,this._phi=t,this._theta=r}get radius(){return this._radius}set radius(e){this._radius=e}get phi(){return this._phi}set phi(e){this._phi=e}get theta(){return this._theta}set theta(e){this._theta=e}makeSafe(){const e=1e-6;this.phi=Math.max(e,Math.min(Math.PI-e,this.phi))}fromVec3(e){return this.radius=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e[0],e[2]),this.phi=Math.acos(Math.max(-1,Math.min(1,e[1]/this.radius)))),this}toVec3(){const e=Math.sin(this.phi)*this.radius;return r.fromValues(e*Math.sin(this.theta),Math.cos(this.phi)*this.radius,e*Math.cos(this.theta))}}})),s.register("kTc9d",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Triangle=void 0;var r=s("eIStk");class i{constructor(e=r.create(),t=r.create(),i=r.create()){this._v0=e,this._v1=t,this._v2=i}applyMatrix(e){return r.transformMat4(this._v0,this._v0,e),r.transformMat4(this._v1,this._v1,e),r.transformMat4(this._v2,this._v2,e),this}clone(){return new i(r.clone(this._v0),r.clone(this._v1),r.clone(this._v2))}intersect(e,t){const i=1e-7,n=r.sub(r.create(),this._v1,this._v0),s=r.sub(r.create(),this._v2,this._v0),o=r.cross(r.create(),t,s),a=r.dot(n,o);if(a>-1e-7&&a<i)return null;const l=1/a,c=r.sub(r.create(),e,this._v0),u=l*r.dot(c,o);if(u<0||u>1)return null;const h=r.cross(r.create(),c,n),d=l*r.dot(t,h);if(d<0||u+d>1)return null;const f=l*r.dot(s,h);return f>i?r.add(r.create(),r.multiply(r.create(),t,r.fromValues(f,f,f)),e):null}}e.exports.Triangle=i})),s.register("eYU63",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractTreeNodeData=e.exports.TreeNode=e.exports.Tree=void 0;var r=s("iWQI0");Object.defineProperty(e.exports,"Tree",{enumerable:!0,get:function(){return r.Tree}});var i=s("Qk2mM");Object.defineProperty(e.exports,"TreeNode",{enumerable:!0,get:function(){return i.TreeNode}});var n=s("lQCTK");Object.defineProperty(e.exports,"AbstractTreeNodeData",{enumerable:!0,get:function(){return n.AbstractTreeNodeData}})})),s.register("iWQI0",(function(e,t){var r,i=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},n=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},o=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Tree=void 0,s("yoicn");var a=s("crO5Z"),l=s("Qk2mM");let c=class{constructor(){r.set(this,new l.TreeNode("root"))}get root(){return o(this,r,"f")}addNode(e,t=o(this,r,"f"),i=o(this,r,"f")){if(i===t)return i.addChild(e),!0;for(let r=0;r<i.children.length;r++){const n=i.children[r];if(n&&this.addNode(e,t,n))return!0}return!1}addNodeAtPath(e,t=this.root.getPath(),i=o(this,r,"f")){if(i.name===t)return i.addChild(e),!0;const n=t.substr(0,t.indexOf("."));if(i.name===n){const r=t.substr(n.length+1,t.length);for(let t=0;t<i.children.length;t++){const n=i.children[t];if(n&&this.addNodeAtPath(e,r,n))return!0}}return!1}removeNode(e,t=o(this,r,"f")){if(t.hasChild(e))return t.removeChild(e),!0;for(let r=0;r<t.children.length;r++){const i=t.children[r];if(i&&this.removeNode(e,i))return!0}return!1}removeNodeAtPath(e,t=o(this,r,"f")){var i;if(t.name===e)return null===(i=t.parent)||void 0===i||i.removeChild(t),!0;const n=e.substr(0,e.indexOf("."));if(t.name===n){const r=e.substr(n.length+1,e.length);for(let e=0;e<t.children.length;e++){const i=t.children[e];if(i&&this.removeNodeAtPath(r,i))return!0}}return!1}getNodeAtPath(e=this.root.getPath(),t=o(this,r,"f")){if(t.name===e)return t;const i=e.substr(0,e.indexOf("."));if(t.name===i){const r=e.substr(i.length+1,e.length);for(let e=0;e<t.children.length;e++){const i=t.children[e],n=this.getNodeAtPath(r,i);if(n)return n}}return null}};r=new WeakMap,c=i([a.default(),n("design:paramtypes",[])],c),e.exports.Tree=c})),s.register("Qk2mM",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},_=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TreeNode=void 0;var b=s("3iqbd");s("yoicn");var y=s("bJEmL"),E=s("cTTbu"),w=s("6UMiq");class x{constructor(e="node",t=null,s=[],b=[]){var x;r.set(this,[]),i.set(this,[]),n.set(this,y.instance.resolve(E.EventEngine)),o.set(this,""),a.set(this,y.instance.resolve(E.UuidGenerator)),l.set(this,new w.Box),c.set(this,void 0),u.set(this,null),h.set(this,[]),d.set(this,{}),f.set(this,[]),p.set(this,void 0),m.set(this,!0),g.set(this,!1),v(this,o,e.replace(/\./g,"_"),"f"),v(this,u,t,"f"),v(this,i,s,"f"),v(this,h,b,"f"),v(this,c,_(this,a,"f").create(),"f"),v(this,p,_(this,a,"f").create(),"f"),null===(x=_(this,u,"f"))||void 0===x||x.addChild(this)}get bone(){return _(this,g,"f")}set bone(e){v(this,g,e,"f")}get boundingBox(){return _(this,l,"f")}set boundingBox(e){v(this,l,e,"f")}get children(){return _(this,r,"f")}get data(){return _(this,i,"f")}get excludeViewers(){return _(this,f,"f")}set excludeViewers(e){v(this,f,e,"f")}get id(){return _(this,c,"f")}set id(e){v(this,c,e,"f")}get name(){return _(this,o,"f")}get nodeMatrix(){const e=b.create();for(let t of _(this,h,"f"))"sdtf"!==t.id&&b.multiply(e,e,t.matrix);return e}get nodeMatrixSDTF(){const e=b.create();for(let t of _(this,h,"f"))b.multiply(e,e,t.matrix);return e}get parent(){return _(this,u,"f")}set parent(e){null===e&&null!==_(this,u,"f")&&_(this,u,"f").removeChild(this),null!==e&&e.addChild(this),v(this,u,e,"f")}get transformations(){return _(this,h,"f")}set transformations(e){v(this,h,e,"f"),this.updateVersion()}get transformedNodes(){return _(this,d,"f")}set transformedNodes(e){v(this,d,e,"f")}get version(){return _(this,p,"f")}get visible(){return _(this,m,"f")}set visible(e){v(this,m,e,"f"),this.updateVersion()}get worldMatrix(){const e=b.create();for(let t of _(this,h,"f"))b.multiply(e,e,t.matrix);let t=this;for(;t.parent;)b.multiply(e,e,t.parent.nodeMatrix),t=t.parent;return e}addChild(e){return!this.hasChild(e)&&(_(this,r,"f").push(e),null!==e.parent&&e.parent.removeChild(e),e.parent=this,!0)}clone(){const e=new x(this.name);e.visible=this.visible;for(let t of _(this,r,"f"))e.addChild(t.clone());for(let t of _(this,i,"f"))e.data.push(t.clone());for(let t of _(this,h,"f"))e.transformations.push({id:t.id,matrix:b.clone(t.matrix)});return e}cloneInstance(){const e=new x(this.name);e.visible=this.visible;for(let t of _(this,r,"f"))e.addChild(t.cloneInstance());for(let t of _(this,i,"f"))e.data.push(t);for(let t of _(this,h,"f"))e.transformations.push({id:t.id,matrix:b.clone(t.matrix)});return e}getChild(e){for(let t=0;t<_(this,r,"f").length;t++)if(_(this,r,"f")[t].id===e)return _(this,r,"f")[t];return null}getPath(){let e=this.name,t=this.parent;for(;t;)e=t.name+"."+e,t=t.parent;return e}hasChild(e){return _(this,r,"f").includes(e)}removeChild(e){const t=_(this,r,"f").indexOf(e);return-1!==t&&(_(this,r,"f").splice(t,1),e.parent=null,!0)}updateVersion(){let e=this;for(;null!==e.parent;)e=e.parent,e.updateVersionAtomic();for(let e=0;e<_(this,r,"f").length;e++)_(this,r,"f")[e].updateVersion();v(this,p,_(this,a,"f").create(),"f")}updateVersionAtomic(){v(this,p,_(this,a,"f").create(),"f")}}e.exports.TreeNode=x,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap})),s.register("lQCTK",(function(e,t){var r,i,n,o,a=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractTreeNodeData=void 0,s("yoicn");var c=s("bJEmL"),u=s("cTTbu");e.exports.AbstractTreeNodeData=class{constructor(e){r.set(this,void 0),i.set(this,void 0),n.set(this,c.instance.resolve(u.UuidGenerator)),o.set(this,c.instance.resolve(u.EventEngine)),l(this,i,e||a(this,n,"f").create(),"f"),l(this,r,a(this,n,"f").create(),"f")}get id(){return a(this,i,"f")}get version(){return a(this,r,"f")}updateVersion(){l(this,r,a(this,n,"f").create(),"f")}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap})),s.register("k481s",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraEngine=void 0;var r=s("cTTbu");s("yoicn");var i=s("bJEmL"),n=s("6UMiq"),o=s("eIStk"),a=s("eYU63"),l=s("c6GJS"),c=s("kEkrb"),u=s("adtYh"),h=s("cNNnA");e.exports.CameraEngine=class{constructor(e,t,s){this._viewerId=e,this._canvas=t,this._domEventEngine=s,this._cameras={},this._camerasDomEventListenerToken={},this._eventEngine=i.instance.resolve(r.EventEngine),this._logger=i.instance.resolve(r.Logger),this._settingsEngine=i.instance.resolve(r.SettingsEngine),this._stateEngine=i.instance.resolve(r.StateEngine),this._tree=i.instance.resolve(a.Tree),this._uuidGenerator=i.instance.resolve(r.UuidGenerator),this._camera=null,this._settingsApplied=!1,this._boundingBox=new n.Box,this._eventEngine.addListener(r.EVENTTYPE.SCENE.SCENE_BOUNDING_BOX_CHANGE,(e=>{const t=e;if(t.viewerId===this._viewerId){this._boundingBox=new n.Box(t.boundingBox.min,t.boundingBox.max);const e=this.cameras;for(let t in e)e[t].boundingBox=this._boundingBox.clone()}})),this._eventEngine.addListener(r.EVENTTYPE.VIEWER.VIEWER_UPDATED,(e=>{e.viewerId===this._viewerId&&this.searchForNewCameras()}))}get camera(){return this._camera}get cameras(){return this.searchForNewCameras(),this._cameras}activateCameraEvents(){const e=this.cameras;for(let t in e)e[t].controls.cameraControlsEventDistribution.activateCameraEvents()}applySettings(){const e=this.cameras;for(let t in e)this.removeCamera(t);for(let e in this._settingsEngine.settings.camera.cameras){const t=this._settingsEngine.settings.camera.cameras[e];if("perspective"===t.type)this.createCamera(l.CAMERATYPE.PERSPECTIVE,e);else{this.createCamera(l.CAMERATYPE.ORTHOGRAPHIC,e).direction=t.type}}if(!this._settingsApplied)for(let t in e)e[t].applySettings();const t=Object.keys(this._settingsEngine.settings.camera.cameras);if(t.length>0)this._settingsEngine.settings.camera.cameraId?this.assignCamera(this._settingsEngine.settings.camera.cameraId):this.assignCamera(t[0]);else{const e=this.createCamera(l.CAMERATYPE.PERSPECTIVE,"standard");this.assignCamera(e.id),e.applySettings()}this._settingsApplied=!0}assignCamera(e){const t=this.cameras[e];t&&(this._camera=t)}createCamera(e,t){const i=this.cameras,n=t||this._uuidGenerator.create();if(i[n]){const t=new r.ShapeDiverViewerCameraError(`CameraEngine.createCamera: Camera (${e}) with this id (${n}) already exists.`);throw this._logger.handleError(r.LOGGINGTOPIC.CAMERA,"CameraEngine.createCamera",t)}const s=l.CAMERATYPE.PERSPECTIVE===e?new u.PerspectiveCamera(n):new h.OrthographicCamera(n);return s.assignViewer(this._viewerId),i[n]=s,this._settingsApplied?s.applySettings():s.zoomTo(void 0,{duration:0}),s}deactivateCameraEvents(){const e=this.cameras;for(let t in e)e[t].controls.cameraControlsEventDistribution.deactivateCameraEvents()}removeCamera(e){const t=this.cameras;return!!t[e]&&(this._domEventEngine.removeDomEventListener(this._camerasDomEventListenerToken[e]),this._camera&&this._camera.id===e&&(this._camera=null),delete t[e],delete this._camerasDomEventListenerToken[e],!0)}saveSettings(){if(this._settingsEngine.settings.camera.cameraId=this._camera?this._camera.id:"standard",this._settingsEngine.settings.camera.cameras={},!this._camera)return;const e=this._camera;if(e.type===l.CAMERATYPE.PERSPECTIVE){const t=e.controls;this._settingsEngine.camera.cameras[e.id]={autoAdjust:e.autoAdjust,cameraMovementDuration:e.cameraMovementDuration,enableCameraControls:e.enableCameraControls,revertAtMouseUp:e.revertAtMouseUp,revertAtMouseUpDuration:e.revertAtMouseUpDuration,zoomExtentsFactor:e.zoomExtentsFactor,position:{x:e.defaultPosition[0],y:e.defaultPosition[1],z:e.defaultPosition[2]},target:{x:e.defaultTarget[0],y:e.defaultTarget[1],z:e.defaultTarget[2]},type:e.type,fov:e.fov,controls:{autoRotationSpeed:t.autoRotationSpeed,damping:t.damping,enableAutoRotation:t.enableAutoRotation,enableKeyPan:t.enableKeyPan,enablePan:t.enablePan,enableRotation:t.enableRotation,enableZoom:t.enableZoom,input:t.input,keyPanSpeed:t.keyPanSpeed,movementSmoothness:t.movementSmoothness,rotationSpeed:t.rotationSpeed,panSpeed:t.panSpeed,zoomSpeed:t.zoomSpeed,restrictions:{position:{cube:{min:{x:t.cubePositionRestriction.min[0],y:t.cubePositionRestriction.min[1],z:t.cubePositionRestriction.min[2]},max:{x:t.cubePositionRestriction.max[0],y:t.cubePositionRestriction.max[1],z:t.cubePositionRestriction.max[2]}},sphere:{center:{x:t.spherePositionRestriction.center[0],y:t.spherePositionRestriction.center[1],z:t.spherePositionRestriction.center[2]},radius:t.spherePositionRestriction.radius}},target:{cube:{min:{x:t.cubeTargetRestriction.min[0],y:t.cubeTargetRestriction.min[1],z:t.cubeTargetRestriction.min[2]},max:{x:t.cubeTargetRestriction.max[0],y:t.cubeTargetRestriction.max[1],z:t.cubeTargetRestriction.max[2]}},sphere:{center:{x:t.sphereTargetRestriction.center[0],y:t.sphereTargetRestriction.center[1],z:t.sphereTargetRestriction.center[2]},radius:t.sphereTargetRestriction.radius}},rotation:t.rotationRestriction,zoom:t.zoomRestriction}}}}else{if(this._settingsEngine.camera.cameras[e.id]){this._settingsEngine.camera.cameras[e.id].type!==e.type&&this._settingsEngine.camera.cameras[e.id].position.x===e.defaultPosition[0]&&this._settingsEngine.camera.cameras[e.id].position.y===e.defaultPosition[1]&&this._settingsEngine.camera.cameras[e.id].position.z===e.defaultPosition[2]&&this._settingsEngine.camera.cameras[e.id].target.x===e.defaultTarget[0]&&this._settingsEngine.camera.cameras[e.id].target.y===e.defaultTarget[1]&&this._settingsEngine.camera.cameras[e.id].target.z===e.defaultTarget[2]&&(e.defaultPosition=o.clone(e.position),e.defaultTarget=o.clone(e.target))}const t=e.controls;this._settingsEngine.camera.cameras[e.id]={autoAdjust:e.autoAdjust,cameraMovementDuration:e.cameraMovementDuration,enableCameraControls:e.enableCameraControls,revertAtMouseUp:e.revertAtMouseUp,revertAtMouseUpDuration:e.revertAtMouseUpDuration,zoomExtentsFactor:e.zoomExtentsFactor,position:{x:e.defaultPosition[0],y:e.defaultPosition[1],z:e.defaultPosition[2]},target:{x:e.defaultTarget[0],y:e.defaultTarget[1],z:e.defaultTarget[2]},type:e.direction,controls:{damping:t.damping,enableKeyPan:t.enableKeyPan,enablePan:t.enablePan,enableZoom:t.enableZoom,input:t.input,keyPanSpeed:t.keyPanSpeed,movementSmoothness:t.movementSmoothness,panSpeed:t.panSpeed,zoomSpeed:t.zoomSpeed}}}}searchForNewCameras(){const e=t=>{for(let e=0;e<t.data.length;e++)if(t.data[e]instanceof c.AbstractCamera&&!this._cameras[t.data[e].id]){const r=t.data[e];r.viewerId===this._viewerId&&(this._cameras[r.id]=r)}for(let r=0;r<t.children.length;r++)e(t.children[r])};e(this._tree.root)}}})),s.register("c6GJS",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CAMERATYPE=void 0,(r=e.exports.CAMERATYPE||(e.exports.CAMERATYPE={})).PERSPECTIVE="perspective",r.ORTHOGRAPHIC="orthographic"})),s.register("adtYh",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PerspectiveCamera=void 0;var i=s("cTTbu");s("yoicn");var n=s("bJEmL"),o=s("eIStk"),a=s("k1dpP"),l=s("3iqbd"),c=s("6BoVD"),u=s("6UMiq"),h=s("eYU63"),d=s("c6GJS"),f=s("kEkrb"),p=s("4K6tN");class m extends f.AbstractCamera{constructor(e){super(e,d.CAMERATYPE.PERSPECTIVE),this._converter=n.instance.resolve(i.Converter),this._logger=n.instance.resolve(i.Logger),this._tree=n.instance.resolve(h.Tree),this._fov=60,this._controls=new p.PerspectiveCameraControls(this,!0)}get aspect(){return this._aspect}set aspect(e){this._aspect=e}get fov(){return this._fov}set fov(e){this._fov=e}applySettings(){const e=this._settingsEngine.camera.cameras[this.id];if(e){this.autoAdjust=e.autoAdjust,this.cameraMovementDuration=e.cameraMovementDuration,this.enableCameraControls=e.enableCameraControls,this.revertAtMouseUp=e.revertAtMouseUp,this.revertAtMouseUpDuration=e.revertAtMouseUpDuration,this.zoomExtentsFactor=e.zoomExtentsFactor;let t=this._converter.toVec3(e.position),r=this._converter.toVec3(e.target);this.defaultPosition=o.clone(t),this.defaultTarget=o.clone(r),this.position=t,this.target=r,this.fov=e.fov}this.position[0]===this.target[0]&&this.position[1]===this.target[1]&&this.position[2]===this.target[2]&&this._stateEngine.boundingBoxCreated.then((()=>r(this,void 0,void 0,(function*(){yield this.zoomTo(void 0,{duration:0}),this.defaultPosition=o.clone(this._controls.position),this.defaultTarget=o.clone(this._controls.target)})))),this._controls.applySettings()}assignViewer(e){let t=n.instance.resolveAll("renderingEngine").find((t=>t.id===e));if(!t){const t=new i.ShapeDiverViewerCameraError(`OrthographicCamera(${this.id}).assignViewer: Viewer with ID ${e} not found.`);throw this._logger.handleError(i.LOGGINGTOPIC.CAMERA,`OrthographicCamera(${this.id}).assignViewer`,t)}this.assignViewerInternal(e,t.canvas),this._controls.assignViewer(e,t.canvas),this._domEventListenerToken&&this._domEventEngine&&this._domEventEngine.removeDomEventListener(this._domEventListenerToken),this._domEventEngine=t.domEventEngine,this._domEventListenerToken=this._domEventEngine.addDomEventListener(this._controls.cameraControlsEventDistribution),this.boundingBox=this._tree.root.boundingBox.clone()}clone(){return new m(this.id)}getZoomPositionAndTarget(e){let t;if(t=e?e.clone():this._boundingBox.clone(),t.isEmpty())return{position:o.create(),target:o.create()};const r=this.position[0]===this.target[0]&&this.position[1]===this.target[1]&&this.position[2]===this.target[2];let i=o.fromValues((t.max[0]+t.min[0])/2,(t.max[1]+t.min[1])/2,(t.max[2]+t.min[2])/2);this.position[0]===this.target[0]&&this.position[1]===this.target[1]&&this.position[2]===this.target[2]&&(this.position=o.fromValues(i[0],i[1]-7.5,i[2]+5));const n=o.subtract(o.create(),t.max,i);o.multiply(n,n,r?o.fromValues(2,2,2):o.fromValues(this.zoomExtentsFactor,this.zoomExtentsFactor,this.zoomExtentsFactor)),t=new u.Box(o.subtract(o.create(),i,n),o.add(o.create(),i,n));const s=o.normalize(o.create(),o.subtract(o.create(),i,this.position));let l=o.normalize(o.create(),o.cross(o.create(),o.fromValues(0,0,1),s)),c=o.normalize(o.create(),o.cross(o.create(),l,s)),h=o.add(o.create(),i,o.multiply(o.create(),s,o.fromValues(-1e-8,-1e-8,-1e-8))),d=[];d.push(o.fromValues(t.min[0],t.min[1],t.min[2])),d.push(o.fromValues(t.min[0],t.min[1],t.max[2])),d.push(o.fromValues(t.min[0],t.max[1],t.min[2])),d.push(o.fromValues(t.min[0],t.max[1],t.max[2])),d.push(o.fromValues(t.max[0],t.min[1],t.min[2])),d.push(o.fromValues(t.max[0],t.min[1],t.max[2])),d.push(o.fromValues(t.max[0],t.max[1],t.min[2])),d.push(o.fromValues(t.max[0],t.max[1],t.max[2]));let f=o.normalize(o.create(),o.transformQuat(o.create(),s,a.setAxisAngle(a.create(),l,this.fov/2*(Math.PI/180)))),p=o.normalize(o.create(),o.transformQuat(o.create(),s,a.setAxisAngle(a.create(),l,-this.fov/2*(Math.PI/180))));const m=r?1.5:this.aspect||1.5;let g=2*Math.atan(Math.tan(this.fov*Math.PI/180/2)*m),v=o.normalize(o.create(),o.transformQuat(o.create(),s,a.setAxisAngle(a.create(),c,g/2))),_=o.normalize(o.create(),o.transformQuat(o.create(),s,a.setAxisAngle(a.create(),c,-g/2))),b=new u.Plane(o.clone(l),0);b.setFromNormalAndCoplanarPoint(o.clone(l),o.clone(i));let y=new u.Plane(o.fromValues(0,0,1),0);y.setFromNormalAndCoplanarPoint(o.clone(c),o.clone(i));let E=0;for(let e=0;e<d.length;e++){let t=b.clampPoint(d[e]),r=o.normalize(o.create(),o.subtract(o.create(),t,h));if(o.dot(s,f)>o.dot(s,r)){const e=o.multiply(o.create(),o.dot(f,r)>o.dot(p,r)?f:p,o.fromValues(-1,-1,-1)),n=y.intersect(t,e);if(n){const r=o.add(o.create(),o.multiply(o.create(),e,o.fromValues(n,n,n)),t);E=Math.max(E,o.distance(i,r))}}if(t=y.clampPoint(d[e]),r=o.normalize(o.create(),o.subtract(o.create(),t,h)),o.dot(s,v)>o.dot(s,r)){const e=o.multiply(o.create(),o.dot(v,r)>o.dot(_,r)?v:_,o.fromValues(-1,-1,-1)),n=b.intersect(t,e);if(n){const r=o.add(o.create(),o.multiply(o.create(),e,o.fromValues(n,n,n)),t);E=Math.max(E,o.distance(i,r))}}}return h=o.add(o.create(),i,o.multiply(o.create(),s,o.fromValues(-E,-E,-E))),{position:h,target:i}}project(e,t=this.position,r=this.target){const i=l.targetTo(l.create(),t,r,o.fromValues(0,0,1)),n=this.aspect||1.5,s=l.perspective(l.create(),this.fov/(180/Math.PI),n,this.near,this.far);return o.transformMat4(e,e,l.invert(i,i)),o.transformMat4(e,e,s),c.fromValues(e[0],e[1])}unproject(e,t=this.position,r=this.target){const i=l.targetTo(l.create(),t,r,o.fromValues(0,0,1)),n=this.aspect||1.5,s=l.perspective(l.create(),this.fov/(180/Math.PI),n,this.near,this.far);return o.transformMat4(e,e,l.invert(s,s)),o.transformMat4(e,e,i),o.clone(e)}}e.exports.PerspectiveCamera=m})),s.register("4K6tN",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PerspectiveCameraControls=void 0;var r=s("cTTbu"),i=s("eIStk");s("yoicn");var n=s("bJEmL"),o=s("dk8Lz"),a=s("gVCee"),l=s("iay1J"),c=s("lnMFl");class u extends a.AbstractCameraControls{constructor(e,t){super(e,t,o.CAMERATYPE.PERSPECTIVE),this._autoRotationSpeed=0,this._cubePositionRestriction={min:i.fromValues(-1/0,-1/0,-1/0),max:i.fromValues(1/0,1/0,1/0)},this._cubeTargetRestriction={min:i.fromValues(-1/0,-1/0,-1/0),max:i.fromValues(1/0,1/0,1/0)},this._damping=.1,this._enableAutoRotation=!1,this._enableKeyPan=!1,this._enablePan=!0,this._enableRotation=!0,this._enableZoom=!0,this._input={keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:1,zoom:2,pan:3}},this._keyPanSpeed=.5,this._movementSmoothness=.5,this._panSpeed=.5,this._rotationRestriction={minPolarAngle:0,maxPolarAngle:180,minAzimuthAngle:-1/0,maxAzimuthAngle:1/0},this._rotationSpeed=.5,this._spherePositionRestriction={center:i.create(),radius:1/0},this._sphereTargetRestriction={center:i.create(),radius:1/0},this._zoomRestriction={minDistance:0,maxDistance:1/0},this._zoomSpeed=.5,this._converter=n.instance.resolve(r.Converter),this._settingsEngine=n.instance.resolve(r.SettingsEngine),this._stateEngine=n.instance.resolve(r.StateEngine),this._cameraLogic=new c.CameraControlsLogic(this),this._cameraControlsEventDistribution=new l.CameraControlsEventDistribution(this,this._cameraLogic)}applySettings(){const e=this._settingsEngine.camera.cameras[this.camera.id];if(!e)return;this.reset();const t=e.controls;this.autoRotationSpeed=t.autoRotationSpeed,this.damping=t.damping,this.enableAutoRotation=t.enableAutoRotation,this.enableKeyPan=t.enableKeyPan,this.enablePan=t.enablePan,this.enableRotation=t.enableRotation,this.enableZoom=t.enableZoom,this.input=t.input,this.keyPanSpeed=t.keyPanSpeed,this.movementSmoothness=t.movementSmoothness,this.rotationSpeed=t.rotationSpeed,this.panSpeed=t.panSpeed,this.zoomSpeed=t.zoomSpeed,null===t.restrictions.position.cube.min.x&&(t.restrictions.position.cube.min.x=-1/0),null===t.restrictions.position.cube.min.y&&(t.restrictions.position.cube.min.y=-1/0),null===t.restrictions.position.cube.min.z&&(t.restrictions.position.cube.min.z=-1/0),null===t.restrictions.position.cube.max.x&&(t.restrictions.position.cube.max.x=1/0),null===t.restrictions.position.cube.max.y&&(t.restrictions.position.cube.max.y=1/0),null===t.restrictions.position.cube.max.z&&(t.restrictions.position.cube.max.z=1/0),null===t.restrictions.position.sphere.radius&&(t.restrictions.position.sphere.radius=1/0),null===t.restrictions.target.cube.min.x&&(t.restrictions.target.cube.min.x=-1/0),null===t.restrictions.target.cube.min.y&&(t.restrictions.target.cube.min.y=-1/0),null===t.restrictions.target.cube.min.z&&(t.restrictions.target.cube.min.z=-1/0),null===t.restrictions.target.cube.max.x&&(t.restrictions.target.cube.max.x=1/0),null===t.restrictions.target.cube.max.y&&(t.restrictions.target.cube.max.y=1/0),null===t.restrictions.target.cube.max.z&&(t.restrictions.target.cube.max.z=1/0),null===t.restrictions.target.sphere.radius&&(t.restrictions.target.sphere.radius=1/0),null===t.restrictions.rotation.minAzimuthAngle&&(t.restrictions.rotation.minAzimuthAngle=-1/0),null===t.restrictions.rotation.maxAzimuthAngle&&(t.restrictions.rotation.maxAzimuthAngle=1/0),null===t.restrictions.zoom.maxDistance&&(t.restrictions.zoom.maxDistance=1/0),this.cubePositionRestriction={min:this._converter.toVec3(t.restrictions.position.cube.min),max:this._converter.toVec3(t.restrictions.position.cube.max)},this.spherePositionRestriction={center:this._converter.toVec3(t.restrictions.position.sphere.center),radius:t.restrictions.position.sphere.radius},this.cubeTargetRestriction={min:this._converter.toVec3(t.restrictions.target.cube.min),max:this._converter.toVec3(t.restrictions.target.cube.max)},this.sphereTargetRestriction={center:this._converter.toVec3(t.restrictions.target.sphere.center),radius:t.restrictions.target.sphere.radius},this.rotationRestriction=t.restrictions.rotation,this.zoomRestriction=t.restrictions.zoom}get autoRotationSpeed(){return this._autoRotationSpeed}set autoRotationSpeed(e){this._autoRotationSpeed=e}get cubePositionRestriction(){return this._cubePositionRestriction}set cubePositionRestriction(e){this._cubePositionRestriction=e}get cubeTargetRestriction(){return this._cubeTargetRestriction}set cubeTargetRestriction(e){this._cubeTargetRestriction=e}get damping(){return this._damping}set damping(e){this._damping=e}get enableAutoRotation(){return this._enableAutoRotation}set enableAutoRotation(e){this._enableAutoRotation=e}get enableKeyPan(){return this._enableKeyPan}set enableKeyPan(e){this._enableKeyPan=e}get enablePan(){return this._enablePan}set enablePan(e){this._enablePan=e}get enableRotation(){return this._enableRotation}set enableRotation(e){this._enableRotation=e}get enableZoom(){return this._enableZoom}set enableZoom(e){this._enableZoom=e}get input(){return this._input}set input(e){this._input=e}get keyPanSpeed(){return this._keyPanSpeed}set keyPanSpeed(e){this._keyPanSpeed=e}get movementSmoothness(){return this._movementSmoothness}set movementSmoothness(e){this._movementSmoothness=e}get panSpeed(){return this._panSpeed}set panSpeed(e){this._panSpeed=e}get rotationRestriction(){return this._rotationRestriction}set rotationRestriction(e){this._rotationRestriction=e}get rotationSpeed(){return this._rotationSpeed}set rotationSpeed(e){this._rotationSpeed=e}get spherePositionRestriction(){return this._spherePositionRestriction}set spherePositionRestriction(e){this._spherePositionRestriction=e}get sphereTargetRestriction(){return this._sphereTargetRestriction}set sphereTargetRestriction(e){this._sphereTargetRestriction=e}get zoomRestriction(){return this._zoomRestriction}set zoomRestriction(e){this._zoomRestriction=e}get zoomSpeed(){return this._zoomSpeed}set zoomSpeed(e){this._zoomSpeed=e}}e.exports.PerspectiveCameraControls=u})),s.register("gVCee",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractCameraControls=void 0;var r=s("eIStk"),i=s("cTTbu");s("yoicn");var n=s("bJEmL"),o=s("53g1n");e.exports.AbstractCameraControls=class{constructor(e,t,s){this._camera=e,this._enabled=t,this._eventEngine=n.instance.resolve(i.EventEngine),this._manualInteraction=!1,this._moving=!1,this._movingDuration=0,this._nonmanualInteraction=!1,this._position=r.create(),this._target=r.create(),this._cameraInterpolationManager=new o.CameraInterpolationManager(this._camera,this),this._manualInteractionTransformations={position:[],target:[]},this._nonmanualInteractionTransformations={position:[],target:[]}}assignViewer(e,t){this._canvas=t,this._viewerId=e}get cameraControlsEventDistribution(){return this._cameraControlsEventDistribution}get canvas(){return this._canvas}set canvas(e){this._canvas=e}get enabled(){return this._enabled}set enabled(e){e||(this._manualInteraction=!1,this._manualInteractionTransformations={position:[],target:[]},this._nonmanualInteraction=!1,this._nonmanualInteractionTransformations={position:[],target:[]},this._cameraControlsEventDistribution.reset(),this._cameraLogic.reset()),this._enabled=e}get camera(){return this._camera}set camera(e){this._camera=e}get position(){return this._position}set position(e){this._position=e}get target(){return this._target}set target(e){this._target=e}animate(e,t){return t&&0===t.duration?(this._position=e[e.length-1].position,this._target=e[e.length-1].target,new Promise((e=>e(!0)))):(this._manualInteraction=!1,this._manualInteractionTransformations={position:[],target:[]},this._cameraInterpolationManager.interpolate(e,t))}applyPositionVector(e,t){this._manualInteraction||t?(this._manualInteraction=!0,this._manualInteractionTransformations.position.push({vector:e})):(this._nonmanualInteraction=!0,this._nonmanualInteractionTransformations.position.push({vector:e}))}applyTargetVector(e,t){this._manualInteraction||t?(this._manualInteraction=!0,this._manualInteractionTransformations.target.push({vector:e})):(this._nonmanualInteraction=!0,this._nonmanualInteractionTransformations.target.push({vector:e}))}applyPositionMatrix(e,t){this._manualInteraction||t?(this._manualInteraction=!0,this._manualInteractionTransformations.position.push({matrix:e})):(this._nonmanualInteraction=!0,this._nonmanualInteractionTransformations.position.push({matrix:e}))}applyTargetMatrix(e,t){this._manualInteraction||t?(this._manualInteraction=!0,this._manualInteractionTransformations.target.push({matrix:e})):(this._nonmanualInteraction=!0,this._nonmanualInteractionTransformations.target.push({matrix:e}))}applyUpMatrix(e,t){throw new Error("Method not implemented.")}getPositionWithManualUpdates(){let e=r.clone(this._position);if(this._manualInteraction)for(let t=this._manualInteractionTransformations.position.length-1;t>=0;t--)e=this._manualInteractionTransformations.position[t].matrix?r.transformMat4(e,e,this._manualInteractionTransformations.position[t].matrix):r.add(e,e,this._manualInteractionTransformations.position[t].vector);return e}getTargetWithManualUpdates(){let e=r.clone(this._target);if(this._manualInteraction)for(let t=this._manualInteractionTransformations.target.length-1;t>=0;t--)e=this._manualInteractionTransformations.target[t].matrix?r.transformMat4(e,e,this._manualInteractionTransformations.target[t].matrix):r.add(e,e,this._manualInteractionTransformations.target[t].vector);return e}getPositionWithUpdates(){return this.getPosition()}getTargetWithUpdates(){return this.getTarget()}isMoving(){return this._manualInteraction||this._nonmanualInteraction}isWithinRestrictions(e,t){return this._cameraLogic.isWithinRestrictions(e,t)}reset(){this._cameraControlsEventDistribution.reset(),this._cameraLogic.reset()}update(e){if(!this._enabled)return{position:r.clone(this._position),target:r.clone(this._target)};!0===this._manualInteraction&&this._cameraInterpolationManager.active()&&this._cameraInterpolationManager.stop();let{position:t,target:n}=this._cameraLogic.restrict(this.getPosition(),this.getTarget());this._position=r.clone(t),this._target=r.clone(n),this._manualInteraction=!1,this._manualInteractionTransformations={position:[],target:[]},this._nonmanualInteraction=this._cameraInterpolationManager.active(),this._nonmanualInteractionTransformations={position:[],target:[]},this._cameraLogic.update(e,this._nonmanualInteraction);const s=this._moving,o={position:r.clone(this._position),target:r.clone(this._target)};switch(this._movingDuration+=e,this._moving=this._manualInteraction||this._nonmanualInteraction,!0){case s!==this._moving&&!0===this._moving:this._eventEngine.emitEvent(i.EVENTTYPE.CAMERA.CAMERA_START,{viewerId:this._viewerId,cameraId:this.camera.id});break;case s!==this._moving&&!1===this._moving:this._eventEngine.emitEvent(i.EVENTTYPE.CAMERA.CAMERA_END,{viewerId:this._viewerId,cameraId:this.camera.id});break;default:this._eventEngine.emitEvent(i.EVENTTYPE.CAMERA.CAMERA_MOVE,{viewerId:this._viewerId,cameraId:this.camera.id})}return this._moving||(this._movingDuration=0),o}getPosition(){let e=r.clone(this._position);if(this._manualInteraction)for(let t=this._manualInteractionTransformations.position.length-1;t>=0;t--)e=this._manualInteractionTransformations.position[t].matrix?r.transformMat4(e,e,this._manualInteractionTransformations.position[t].matrix):r.add(e,e,this._manualInteractionTransformations.position[t].vector);else if(this._nonmanualInteraction)for(let t=this._nonmanualInteractionTransformations.position.length-1;t>=0;t--)e=this._nonmanualInteractionTransformations.position[t].matrix?r.transformMat4(e,e,this._nonmanualInteractionTransformations.position[t].matrix):r.add(e,e,this._nonmanualInteractionTransformations.position[t].vector);return e}getTarget(){let e=r.clone(this._target);if(this._manualInteraction)for(let t=this._manualInteractionTransformations.target.length-1;t>=0;t--)e=this._manualInteractionTransformations.target[t].matrix?r.transformMat4(e,e,this._manualInteractionTransformations.target[t].matrix):r.add(e,e,this._manualInteractionTransformations.target[t].vector);else if(this._nonmanualInteraction)for(let t=this._nonmanualInteractionTransformations.target.length-1;t>=0;t--)e=this._nonmanualInteractionTransformations.target[t].matrix?r.transformMat4(e,e,this._nonmanualInteractionTransformations.target[t].matrix):r.add(e,e,this._nonmanualInteractionTransformations.target[t].vector);return e}}})),s.register("53g1n",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraInterpolationManager=void 0;const o=n(s("8PNKb"));var a=s("7adMy"),l=s("awpxy"),c=s("2Krcx"),u=s("aaJhl");e.exports.CameraInterpolationManager=class{constructor(e,t){this._camera=e,this._cameraControls=t,this.TweenWrapper=class{constructor(e,t,r){this._properties={delta:0},this._tween=new o.Tween(this._properties),this._tween.easing(e.easing),this._tween.to({delta:1},e.duration),this._tween.onUpdate((e=>{t.onUpdate(e)})),this._tween.onStop((e=>{t.onStop&&t.onStop(e),this._resolve(!0)})),this._tween.onComplete((e=>{t.onComplete&&t.onComplete(e),r(),this._resolve(!0)}))}start(){return new Promise((e=>{this._resolve=e,this._tween.start()}))}stop(){this._tween.stop()}}}active(){return!!this._tween}interpolate(e,t={}){const r=[];for(let t=0;t<e.length;t++)r.push({position:e[t].position,target:e[t].target});this._tween&&(this._tween.stop(),this._tween=null);let i=this.optionsParser(t);return this._tween=new this.TweenWrapper(i,2===r.length?this.getCameraInterpolation(r[0],r[1],i.coordinates):new a.CameraMultipleInterpolation(this._camera,this._cameraControls,r,i.interpolation),(()=>{this._tween=null})),this._tween.start()}stop(){this._tween&&this._tween.stop(),this._tween=null}getCameraInterpolation(e,t,r){switch(r){case"linear":return new c.CameraLinearInterpolation(this._camera,this._cameraControls,e,t);case"spherical":return new l.CameraSphericalInterpolation(this._camera,this._cameraControls,e,t);case"cylindrical":return new u.CameraCylindricalInterpolation(this._camera,this._cameraControls,e,t);default:return new a.CameraMultipleInterpolation(this._camera,this._cameraControls,[e,t],o.Interpolation.CatmullRom)}}optionsParser(e){let t=o.Easing.Quartic.InOut;if("string"==typeof e.easing){const r=e.easing.split("."),i=o.Easing[r[0]];if(i){const e=i[r[1]];e&&(t=e)}}else"function"==typeof e.easing&&(t=e.easing);let r=o.Interpolation.CatmullRom;if("string"==typeof e.interpolation){const t=o.Interpolation[e.interpolation];t&&t!==o.Interpolation.Utils&&(r=t)}else"function"==typeof e.interpolation&&(r=e.interpolation);return{default:e.default||!1,duration:e.duration&&e.duration>=0?e.duration:0,easing:t,coordinates:"spherical"!==e.coordinates&&"linear"!==e.coordinates&&"cylindrical"!==e.coordinates?"cylindrical":e.coordinates,interpolation:r}}}})),s.register("8PNKb",(function(e,r){var i;i=e.exports,Object.defineProperty(i,"__esModule",{value:!0,configurable:!0}),t(e.exports,"Easing",(()=>o)),t(e.exports,"now",(()=>a)),t(e.exports,"Group",(()=>l)),t(e.exports,"Interpolation",(()=>c)),t(e.exports,"Sequence",(()=>u)),t(e.exports,"Tween",(()=>d)),t(e.exports,"VERSION",(()=>f)),t(e.exports,"nextId",(()=>p)),t(e.exports,"getAll",(()=>g)),t(e.exports,"removeAll",(()=>v)),t(e.exports,"add",(()=>_)),t(e.exports,"remove",(()=>b)),t(e.exports,"update",(()=>y)),t(e.exports,"default",(()=>E));var n=s("hPtJY"),o={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-o.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*o.Bounce.In(2*e):.5*o.Bounce.Out(2*e-1)+.5}}},a="undefined"==typeof self&&void 0!==n&&n.hrtime?function(){var e=n.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},l=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=a()),void 0===t&&(t=!1);var r=Object.keys(this._tweens);if(0===r.length)return!1;for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<r.length;i++){var n=this._tweens[r[i]],s=!t;n&&!1===n.update(e,s)&&!t&&delete this._tweens[r[i]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),c={Linear:function(e,t){var r=e.length-1,i=r*t,n=Math.floor(i),s=c.Utils.Linear;return t<0?s(e[0],e[1],i):t>1?s(e[r],e[r-1],r-i):s(e[n],e[n+1>r?r:n+1],i-n)},Bezier:function(e,t){for(var r=0,i=e.length-1,n=Math.pow,s=c.Utils.Bernstein,o=0;o<=i;o++)r+=n(1-t,i-o)*n(t,o)*e[o]*s(i,o);return r},CatmullRom:function(e,t){var r=e.length-1,i=r*t,n=Math.floor(i),s=c.Utils.CatmullRom;return e[0]===e[r]?(t<0&&(n=Math.floor(i=r*(1+t))),s(e[(n-1+r)%r],e[n],e[(n+1)%r],e[(n+2)%r],i-n)):t<0?e[0]-(s(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[r]-(s(e[r],e[r],e[r-1],e[r-1],i-r)-e[r]):s(e[n?n-1:0],e[n],e[r<n+1?r:n+1],e[r<n+2?r:n+2],i-n)},Utils:{Linear:function(e,t,r){return(t-e)*r+e},Bernstein:function(e,t){var r=c.Utils.Factorial;return r(e)/r(t)/r(e-t)},Factorial:function(){var e=[1];return function(t){var r=1;if(e[t])return e[t];for(var i=t;i>1;i--)r*=i;return e[t]=r,r}}(),CatmullRom:function(e,t,r,i,n){var s=.5*(r-e),o=.5*(i-t),a=n*n;return(2*t-2*r+s+o)*(n*a)+(-3*t+3*r-2*s-o)*a+s*n+t}}},u=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),h=new l,d=function(){function e(e,t){void 0===t&&(t=h),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=o.Linear.None,this._interpolationFunction=c.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=u.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},e.prototype.duration=function(e){return this._duration=e,this},e.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"==typeof e?a()+parseFloat(e):e:a(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},e.prototype._setupProperties=function(e,t,r,i){for(var n in r){var s=e[n],o=Array.isArray(s),a=o?"array":typeof s,l=!o&&Array.isArray(r[n]);if("undefined"!==a&&"function"!==a){if(l){var c=r[n];if(0===c.length)continue;c=c.map(this._handleRelativeValue.bind(this,s)),r[n]=[s].concat(c)}if("object"!==a&&!o||!s||l)void 0===t[n]&&(t[n]=s),o||(t[n]*=1),i[n]=l?r[n].slice().reverse():t[n]||0;else{for(var u in t[n]=o?[]:{},s)t[n][u]=s[u];i[n]=o?[]:{},this._setupProperties(s,t[n],r[n],i[n])}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=a()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=a()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return this._group=e,this},e.prototype.delay=function(e){return this._delayTime=e,this},e.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return this._yoyo=e,this},e.prototype.easing=function(e){return this._easingFunction=e,this},e.prototype.interpolation=function(e){return this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=a()),void 0===t&&(t=!0),this._isPaused)return!0;var r,i,n=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>n)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(e-this._startTime)/this._duration,i=0===this._duration||i>1?1:i;var s=this._easingFunction(i);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,s),this._onUpdateCallback&&this._onUpdateCallback(this._object,i),1===i){if(this._repeat>0){for(r in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[r]||(this._valuesStartRepeat[r]=this._valuesStartRepeat[r]+parseFloat(this._valuesEnd[r])),this._yoyo&&this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,l=this._chainedTweens.length;o<l;o++)this._chainedTweens[o].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,r,i){for(var n in r)if(void 0!==t[n]){var s=t[n]||0,o=r[n],a=Array.isArray(e[n]),l=Array.isArray(o);!a&&l?e[n]=this._interpolationFunction(o,i):"object"==typeof o&&o?this._updateProperties(e[n],s,o,i):"number"==typeof(o=this._handleRelativeValue(s,o))&&(e[n]=s+(o-s)*i)}},e.prototype._handleRelativeValue=function(e,t){return"string"!=typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],r=this._valuesEnd[e];this._valuesStartRepeat[e]="string"==typeof r?this._valuesStartRepeat[e]+parseFloat(r):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),f="18.6.4",p=u.nextId,m=h,g=m.getAll.bind(m),v=m.removeAll.bind(m),_=m.add.bind(m),b=m.remove.bind(m),y=m.update.bind(m),E={Easing:o,Group:l,Interpolation:c,now:a,Sequence:u,nextId:p,Tween:d,VERSION:f,getAll:g,removeAll:v,add:_,remove:b,update:y}})),s.register("7adMy",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraMultipleInterpolation=void 0;var r=s("eIStk");e.exports.CameraMultipleInterpolation=class{constructor(e,t,r,i){this._camera=e,this._cameraControls=t,this._path=r,this._interpolationFunction=i,this.end={position:{x:[],y:[],z:[]},target:{x:[],y:[],z:[]}};for(let e=0;e<this._path.length;e++)this.end.position.x.push(this._path[e].position[0]),this.end.position.y.push(this._path[e].position[1]),this.end.position.z.push(this._path[e].position[2]),this.end.target.x.push(this._path[e].target[0]),this.end.target.y.push(this._path[e].target[1]),this.end.target.z.push(this._path[e].target[2])}onComplete(e){let t=r.subtract(r.create(),r.fromValues(this._path[this._path.length-1].position[0],this._path[this._path.length-1].position[1],this._path[this._path.length-1].position[2]),this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(t);let i=r.subtract(r.create(),r.fromValues(this._path[this._path.length-1].target[0],this._path[this._path.length-1].target[1],this._path[this._path.length-1].target[2]),this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(i)}onStop(e){}onUpdate(e){let t=r.fromValues(this._interpolationFunction(this.end.position.x,e.delta),this._interpolationFunction(this.end.position.y,e.delta),this._interpolationFunction(this.end.position.z,e.delta)),i=r.subtract(r.create(),t,this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(i);let n=r.fromValues(this._interpolationFunction(this.end.target.x,e.delta),this._interpolationFunction(this.end.target.y,e.delta),this._interpolationFunction(this.end.target.z,e.delta)),s=r.subtract(r.create(),n,this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(s)}}})),s.register("awpxy",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraSphericalInterpolation=void 0;var r=s("eIStk"),i=s("k1dpP");e.exports.CameraSphericalInterpolation=class{constructor(e,t,i,n){this._camera=e,this._cameraControls=t,this._from=i,this._to=n,this._radius_from=r.distance(this._from.position,this._from.target),this._direction_from=r.normalize(r.create(),r.subtract(r.create(),this._from.position,this._from.target)),this._radius_to=r.distance(this._to.position,this._to.target),this._direction_to=r.normalize(r.create(),r.subtract(r.create(),this._to.position,this._to.target)),this._axis=r.normalize(r.create(),r.cross(r.create(),this._direction_to,this._direction_from)),this._c_angle=-Math.acos(Math.min(1,Math.max(-1,r.dot(this._direction_to,this._direction_from))))}onComplete(e){let t=r.subtract(r.create(),r.fromValues(this._to.position[0],this._to.position[1],this._to.position[2]),this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(t);let i=r.subtract(r.create(),r.fromValues(this._to.target[0],this._to.target[1],this._to.target[2]),this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(i)}onStop(e){}onUpdate(e){let t=r.add(r.create(),r.multiply(r.create(),this._from.target,r.fromValues(1-e.delta,1-e.delta,1-e.delta)),r.multiply(r.create(),this._to.target,r.fromValues(e.delta,e.delta,e.delta))),n=r.subtract(r.create(),t,this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(n);let s=this._c_angle*e.delta,o=r.normalize(r.create(),r.transformQuat(r.create(),this._direction_from,i.setAxisAngle(i.create(),this._axis,s))),a=this._radius_from*(1-e.delta)+this._radius_to*e.delta,l=r.add(r.create(),t,r.multiply(r.create(),o,r.fromValues(a,a,a))),c=r.subtract(r.create(),l,this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(c)}}})),s.register("2Krcx",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraLinearInterpolation=void 0;var r=s("eIStk");e.exports.CameraLinearInterpolation=class{constructor(e,t,r,i){this._camera=e,this._cameraControls=t,this._from=r,this._to=i}onComplete(e){let t=r.subtract(r.create(),this._to.position,this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(t);let i=r.subtract(r.create(),this._to.target,this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(i)}onStop(e){}onUpdate(e){let t=r.add(r.create(),r.multiply(r.create(),this._from.position,r.fromValues(1-e.delta,1-e.delta,1-e.delta)),r.multiply(r.create(),this._to.position,r.fromValues(e.delta,e.delta,e.delta))),i=r.subtract(r.create(),t,this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(i);let n=r.add(r.create(),r.multiply(r.create(),this._from.target,r.fromValues(1-e.delta,1-e.delta,1-e.delta)),r.multiply(r.create(),this._to.target,r.fromValues(e.delta,e.delta,e.delta))),s=r.subtract(r.create(),n,this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(s)}}})),s.register("aaJhl",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraCylindricalInterpolation=void 0;var r=s("eIStk"),i=s("k1dpP");e.exports.CameraCylindricalInterpolation=class{constructor(e,t,i,n){this._camera=e,this._cameraControls=t,this._from=i,this._to=n,this._h_from=this._from.position[2]-this._from.target[2],this._from_position_heightAdjusted=r.fromValues(this._from.position[0],this._from.position[1],this._from.target[2]),this._r_from=r.distance(this._from_position_heightAdjusted,this._from.target),this._dir_from=r.normalize(r.create(),r.subtract(r.create(),this._from_position_heightAdjusted,this._from.target)),this._h_to=this._to.position[2]-this._to.target[2],this._to_position_heightAdjusted=r.fromValues(this._to.position[0],this._to.position[1],this._to.target[2]),this._r_to=r.distance(this._to_position_heightAdjusted,this._to.target),this._dir_to=r.normalize(r.create(),r.subtract(r.create(),this._to_position_heightAdjusted,this._to.target)),0===this._dir_from[0]&&0===this._dir_from[1]&&0===this._dir_from[2]&&(this._dir_from=r.fromValues(1,0,0)),0===this._dir_to[0]&&0===this._dir_to[1]&&0===this._dir_to[2]&&(this._dir_to=r.fromValues(1,0,0)),this._lorr=r.cross(r.create(),this._dir_to,this._dir_from);let s=Math.min(1,Math.max(-1,r.dot(this._dir_to,this._dir_from))),o=Math.min(1,Math.max(-1,r.dot(this._lorr,r.fromValues(0,0,1))));this._shortest_angle=o>0?-Math.acos(s):Math.acos(s)}onComplete(e){let t=r.subtract(r.create(),r.fromValues(this._to.position[0],this._to.position[1],this._to.position[2]),this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(t);let i=r.subtract(r.create(),r.fromValues(this._to.target[0],this._to.target[1],this._to.target[2]),this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(i)}onStop(e){}onUpdate(e){let t=r.add(r.create(),r.multiply(r.create(),this._from.target,r.fromValues(1-e.delta,1-e.delta,1-e.delta)),r.multiply(r.create(),this._to.target,r.fromValues(e.delta,e.delta,e.delta))),n=r.subtract(r.create(),t,this._cameraControls.getTargetWithUpdates());this._cameraControls.applyTargetVector(n);let s=this._shortest_angle*e.delta,o=r.transformQuat(r.create(),this._dir_from,i.setAxisAngle(i.create(),r.fromValues(0,0,1),s)),a=this._r_from*(1-e.delta)+this._r_to*e.delta,l=r.add(r.create(),t,r.multiply(r.create(),o,r.fromValues(a,a,a)));r.add(l,l,r.fromValues(0,0,this._h_from*(1-e.delta)+this._h_to*e.delta));let c=r.subtract(r.create(),l,this._cameraControls.getPositionWithUpdates());this._cameraControls.applyPositionVector(c)}}})),s.register("iay1J",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraControlsEventDistribution=void 0;e.exports.CameraControlsEventDistribution=class{constructor(e,t){this._controls=e,this._cameraLogic=t,this._active={rotation:!1,zoom:!1,pan:!1},this._activeEvents=!0}activateCameraEvents(){this._activeEvents=!0}deactivateCameraEvents(){this._activeEvents=!1,this.reset()}onDown(e){let{x:t,y:r}=this.convertInput(e),i=window.TouchEvent&&e instanceof TouchEvent?e.touches.length:e.button,n=window.TouchEvent&&e instanceof TouchEvent?this._controls.input.touch:this._controls.input.mouse;if(i===n.rotate&&this._controls.enableRotation&&(this._cameraLogic.rotate(t,r,this._active.rotation,window.TouchEvent&&e instanceof TouchEvent),this._active.rotation=!0,this._active.pan=!1,this._active.zoom=!1),i===n.pan&&this._controls.enablePan&&(this._cameraLogic.pan(t,r,this._active.pan,window.TouchEvent&&e instanceof TouchEvent),this._active.rotation=!1,this._active.pan=!0,this._active.zoom=!1),i===n.zoom&&this._controls.enableZoom){let i=t,n=r;window.TouchEvent&&e instanceof TouchEvent&&2===this._controls.input.touch.zoom&&(i=(e.touches[0].pageX-e.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),n=(e.touches[0].pageY-e.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(i,n,this._active.zoom,window.TouchEvent&&e instanceof TouchEvent),this._active.rotation=!1,this._active.pan=!1,this._active.zoom=!0}}onKey(e){if(this._controls.enableKeyPan)switch(e.keyCode){case this._controls.input.keys.up:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(0,.05*this._controls.keyPanSpeed,!0,!1),e.preventDefault(),e.stopPropagation();break;case this._controls.input.keys.down:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(0,.05*-this._controls.keyPanSpeed,!0,!1),e.preventDefault(),e.stopPropagation();break;case this._controls.input.keys.left:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(.05*this._controls.keyPanSpeed,0,!0,!1),e.preventDefault(),e.stopPropagation();break;case this._controls.input.keys.right:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(.05*-this._controls.keyPanSpeed,0,!0,!1),e.preventDefault(),e.stopPropagation()}}onKeyDown(e){this._activeEvents&&this.onKey(e)}onMouseDown(e){this._activeEvents&&this.onDown(e)}onMouseMove(e){this._activeEvents&&this.onMove(e)}onMouseUp(e){this._activeEvents&&this.onUp(e)}onMouseWheel(e){this._activeEvents&&this.onWheel(e)}onMove(e){let{x:t,y:r}=this.convertInput(e);if(this._controls.enableRotation&&this._active.rotation&&this._cameraLogic.rotate(t,r,this._active.rotation,window.TouchEvent&&e instanceof TouchEvent),this._controls.enablePan&&this._active.pan&&this._cameraLogic.pan(t,r,this._active.pan,window.TouchEvent&&e instanceof TouchEvent),this._controls.enableZoom&&this._active.zoom){let i=t,n=r;window.TouchEvent&&e instanceof TouchEvent&&2===this._controls.input.touch.zoom&&(i=(e.touches[0].pageX-e.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),n=(e.touches[0].pageY-e.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(i,n,this._active.zoom,window.TouchEvent&&e instanceof TouchEvent)}}onTouchEnd(e){this._activeEvents&&this.onUp(e)}onTouchMove(e){this._activeEvents&&this.onMove(e)}onTouchStart(e){this._activeEvents&&this.onDown(e)}onUp(e){this._active.rotation=!1,this._active.zoom=!1,this._active.pan=!1}onWheel(e){if(!this._activeEvents)return;if(!this._controls.enableZoom)return;let t=0;void 0!==e.deltaY?t=-e.deltaY:void 0!==e.detail&&(t=-e.detail),Math.sign(t)>0?(this._cameraLogic.zoom(0,0,!1,!1),this._cameraLogic.zoom(1,0,!0,!1)):(this._cameraLogic.zoom(1,0,!1,!1),this._cameraLogic.zoom(0,0,!0,!1))}reset(){this._active={rotation:!1,zoom:!1,pan:!1}}convertInput(e){let t=window.innerWidth/window.innerHeight;return e instanceof MouseEvent?{x:e.clientX/window.innerWidth*t,y:e.clientY/window.innerHeight}:{x:e.touches[0].pageX/window.innerWidth*t,y:e.touches[0].pageY/window.innerHeight}}}})),s.register("lnMFl",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraControlsLogic=void 0;var r=s("eIStk"),i=s("6BoVD"),n=s("k1dpP"),o=s("3iqbd"),a=s("6UMiq");e.exports.CameraControlsLogic=class{constructor(e){this._controls=e,this._adjustedSettings={autoRotationSpeed:()=>this._controls.autoRotationSpeed*this._settingsAdjustments.autoRotationSpeed,damping:()=>this._controls.damping*this._settingsAdjustments.damping,movementSmoothness:()=>this._controls.movementSmoothness*this._settingsAdjustments.movementSmoothness,panSpeed:()=>this._controls.panSpeed*this._settingsAdjustments.panSpeed,rotationSpeed:()=>this._controls.rotationSpeed*this._settingsAdjustments.rotationSpeed,zoomSpeed:()=>this._controls.zoomSpeed*this._settingsAdjustments.zoomSpeed},this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:r.create()}},this._dollyDelta=0,this._dollyEnd=0,this._dollyStart=0,this._panDelta=i.create(),this._panEnd=i.create(),this._panStart=i.create(),this._rotateDelta=i.create(),this._rotateEnd=i.create(),this._rotateStart=i.create(),this._settingsAdjustments={autoRotationSpeed:2*Math.PI/60/60,damping:1,movementSmoothness:1,panSpeed:2,rotationSpeed:Math.PI,zoomSpeed:.025},this._touchAdjustments={autoRotationSpeed:1,damping:1,movementSmoothness:1,panSpeed:1.5,rotationSpeed:2,zoomSpeed:100},this._quat=n.fromValues(-Math.sin(Math.PI/4),0,0,Math.sin(Math.PI/4)),this._quatInverse=n.fromValues(Math.sin(Math.PI/4),0,0,Math.sin(Math.PI/4))}isWithinRestrictions(e,t){let i=new a.Box(this._controls.cubePositionRestriction.min,this._controls.cubePositionRestriction.max),n=new a.Sphere(this._controls.spherePositionRestriction.center,this._controls.spherePositionRestriction.radius),s=new a.Box(this._controls.cubeTargetRestriction.min,this._controls.cubeTargetRestriction.max),o=new a.Sphere(this._controls.sphereTargetRestriction.center,this._controls.sphereTargetRestriction.radius);if(!i.containsPoint(e)||!n.containsPoint(e))return!1;if(!s.containsPoint(t)||!o.containsPoint(t))return!1;let l=r.distance(e,t);if(l>this._controls.zoomRestriction.maxDistance||l<this._controls.zoomRestriction.minDistance)return!1;let c=this._controls.rotationRestriction.minPolarAngle*(Math.PI/180),u=this._controls.rotationRestriction.maxPolarAngle*(Math.PI/180),h=this._controls.rotationRestriction.minAzimuthAngle*(Math.PI/180),d=this._controls.rotationRestriction.maxAzimuthAngle*(Math.PI/180);if(h!==-1/0||d!==1/0||0!==c||180!==u){let i=r.sub(r.create(),e,t);r.transformQuat(i,i,this._quat);const n=(new a.Spherical).fromVec3(i);if(n.theta<h||n.theta>d||n.phi<c||n.phi>u)return!1}return!0}pan(e,t,n,s){if(s&&(e/=window.devicePixelRatio,t/=window.devicePixelRatio),n){if(this._panEnd=i.fromValues(e,t),i.sub(this._panDelta,this._panEnd,this._panStart),0===this._panDelta[0]&&0===this._panDelta[1])return;i.copy(this._panStart,this._panEnd);const n=this._adjustedSettings.panSpeed()*(s?this._touchAdjustments.panSpeed:1);let o=this.panDeltaToOffset(i.mul(i.create(),this._panDelta,i.fromValues(n,n)));this._damping.pan.duration>0&&(o[0]<0?o[0]=Math.min(o[0],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[0]):o[0]=Math.max(o[0],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[0]),o[1]<0?o[1]=Math.min(o[1],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[1]):o[1]=Math.max(o[1],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[1]),o[2]<0?o[2]=Math.min(o[2],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[2]):o[2]=Math.max(o[2],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[2]));let a=1-Math.max(.01,Math.min(.99,this._adjustedSettings.damping())),l=(Math.log(1/Math.abs(o[0]))-5*Math.log(10))/Math.log(a),c=(Math.log(1/Math.abs(o[1]))-5*Math.log(10))/Math.log(a),u=(Math.log(1/Math.abs(o[2]))-5*Math.log(10))/Math.log(a);this._damping.pan.time=0,this._damping.pan.duration=16.6666*Math.max(l,Math.max(c,u)),this._damping.pan.offset=r.clone(o),this._damping.rotation.duration=0,this._damping.zoom.duration=0,this._controls.applyTargetVector(o,!0),this._controls.applyPositionVector(o,!0)}else this._panStart=i.fromValues(e,t)}reset(){this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:r.create()}},this._dollyDelta=0,this._dollyEnd=0,this._dollyStart=0,this._panDelta=i.create(),this._panEnd=i.create(),this._panStart=i.create(),this._rotateDelta=i.create(),this._rotateEnd=i.create(),this._rotateStart=i.create()}restrict(e,t){let i=new a.Box(this._controls.cubePositionRestriction.min,this._controls.cubePositionRestriction.max),n=new a.Sphere(this._controls.spherePositionRestriction.center,this._controls.spherePositionRestriction.radius),s=new a.Box(this._controls.cubeTargetRestriction.min,this._controls.cubeTargetRestriction.max),o=new a.Sphere(this._controls.sphereTargetRestriction.center,this._controls.sphereTargetRestriction.radius);i.containsPoint(e)||(e=i.clampPoint(e)),n.containsPoint(e)||(e=n.clampPoint(e)),s.containsPoint(t)||(t=s.clampPoint(t)),o.containsPoint(t)||(t=o.clampPoint(t));let l=r.distance(e,t);if(l>this._controls.zoomRestriction.maxDistance||l<this._controls.zoomRestriction.minDistance){let i=r.normalize(r.create(),r.subtract(r.create(),e,t)),n=Math.max(this._controls.zoomRestriction.minDistance,Math.min(this._controls.zoomRestriction.maxDistance,l));r.add(e,r.multiply(e,i,r.fromValues(n,n,n)),t)}let c=this._controls.rotationRestriction.minPolarAngle*(Math.PI/180),u=this._controls.rotationRestriction.maxPolarAngle*(Math.PI/180),h=this._controls.rotationRestriction.minAzimuthAngle*(Math.PI/180),d=this._controls.rotationRestriction.maxAzimuthAngle*(Math.PI/180);if(h!==-1/0||d!==1/0||0!==c||180!==u){let i=r.subtract(r.create(),e,t);r.transformQuat(i,i,this._quat);const n=(new a.Spherical).fromVec3(i);(n.theta<h||n.theta>d||n.phi<c||n.phi>u)&&(n.theta=Math.max(h,Math.min(d,n.theta)),n.phi=Math.max(c,Math.min(u,n.phi)),n.makeSafe(),i=n.toVec3(),r.transformQuat(i,i,this._quatInverse),r.add(e,i,t))}return{position:e,target:t}}rotate(e,t,r,n){if(n&&(e/=window.devicePixelRatio,t/=window.devicePixelRatio),r){if(this._rotateEnd=i.fromValues(e,t),i.subtract(this._rotateDelta,this._rotateEnd,this._rotateStart),i.copy(this._rotateStart,this._rotateEnd),!this._controls.canvas)return;if(0==this._controls.canvas.clientWidth||0==this._controls.canvas.clientHeight)return;const r=new a.Spherical;let s=this._adjustedSettings.rotationSpeed()*(n?this._touchAdjustments.rotationSpeed:1);if(r.theta-=s*this._rotateDelta[0],r.phi-=s*this._rotateDelta[1],this._damping.rotation.duration>0){let e=this._damping.rotation.theta-r.theta;r.theta+=e*this._adjustedSettings.movementSmoothness();let t=this._damping.rotation.phi-r.phi;r.phi+=t*this._adjustedSettings.movementSmoothness()}let o=this.rotationSphericalToOffset(r),l=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping())),c=(Math.log(1/Math.abs(r.theta))-5*Math.log(10))/Math.log(l),u=(Math.log(1/Math.abs(r.phi))-5*Math.log(10))/Math.log(l);this._damping.rotation.time=0,this._damping.rotation.duration=16.6666*Math.max(c,u),this._damping.rotation.theta=r.theta,this._damping.rotation.phi=r.phi,this._damping.pan.duration=0,this._damping.zoom.duration=0,this._controls.applyPositionVector(o,!0)}else this._rotateStart=i.fromValues(e,t)}update(e,t){!0===t&&(this._damping.zoom.duration=0,this._damping.pan.duration=0,this._damping.rotation.duration=0);let i=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping()));if(this._damping.pan.duration>0)if(this._damping.pan.time+e>this._damping.pan.duration)this._damping.pan.time=this._damping.pan.duration,this._damping.pan.duration=0;else{this._damping.pan.time+=e;let t=this._damping.pan.time/16.6666,n=Math.pow(i,t),s=r.multiply(r.create(),this._damping.pan.offset,r.fromValues(n,n,n));this._controls.applyTargetVector(s),this._controls.applyPositionVector(s)}else this._damping.pan.time=0;if(this._damping.rotation.duration>0)if(this._damping.rotation.time+e>this._damping.rotation.duration)this._damping.rotation.time=this._damping.rotation.duration,this._damping.rotation.duration=0;else{this._damping.rotation.time+=e;let t=this._damping.rotation.time/16.6666,r=new a.Spherical;r.theta=this._damping.rotation.theta*Math.pow(i,t),r.phi=this._damping.rotation.phi*Math.pow(i,t);let n=this.rotationSphericalToOffset(r);this._controls.applyPositionVector(n)}else this._damping.rotation.time=0;if(this._damping.zoom.duration>0)if(this._damping.zoom.time+e>this._damping.zoom.duration)this._damping.zoom.time=this._damping.zoom.duration,this._damping.zoom.duration=0;else{this._damping.zoom.time+=e;let t=this._damping.zoom.time/16.6666,r=this._damping.zoom.delta*Math.pow(i,t),n=this.zoomDistanceToOffset(r);this._controls.applyPositionVector(n)}else this._damping.zoom.time=0;if(this._controls.enableAutoRotation){let e=new a.Spherical(1,0,-this._adjustedSettings.autoRotationSpeed()),t=this.rotationSphericalToOffset(e);this._controls.applyPositionVector(t)}}zoom(e,t,r,i){var n=Math.sqrt(e*e+t*t);if(i&&(n/=window.devicePixelRatio),r){this._dollyEnd=n,this._dollyDelta=this._dollyEnd-this._dollyStart,this._dollyStart=this._dollyEnd,this._damping.zoom.duration>0&&(this._dollyDelta<0?this._dollyDelta=Math.min(this._dollyDelta,this._adjustedSettings.movementSmoothness()*this._damping.zoom.delta):this._dollyDelta=Math.max(this._dollyDelta,this._adjustedSettings.movementSmoothness()*this._damping.zoom.delta));let e=-this._dollyDelta*this._adjustedSettings.zoomSpeed()*(i?this._touchAdjustments.zoomSpeed:1),t=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping())),r=(Math.log(1/Math.abs(this._dollyDelta))-5*Math.log(10))/Math.log(t);this._damping.zoom.time=0,this._damping.zoom.duration=16.6666*r,this._damping.zoom.delta=e,this._damping.rotation.duration=0,this._damping.pan.duration=0;let s=this.zoomDistanceToOffset(e);this._controls.applyPositionVector(s,!0)}else this._dollyStart=n}panDeltaToOffset(e){let t=r.create(),i=r.create();r.subtract(t,this._controls.getPositionWithManualUpdates(),this._controls.getTargetWithManualUpdates());var n=r.length(t);n*=Math.tan(this._controls.camera.fov/2*Math.PI/180);const s=o.targetTo(o.create(),this._controls.camera.position,this._controls.camera.target,r.fromValues(0,0,1)),a=r.fromValues(s[0],s[1],s[2]),l=-2*e[0]*n;r.multiply(a,a,r.fromValues(l,l,l)),r.add(i,i,a);const c=r.fromValues(s[4],s[5],s[6]),u=2*e[1]*n;return r.multiply(c,c,r.fromValues(u,u,u)),r.add(i,i,c),r.clone(i)}rotationSphericalToOffset(e){let t=r.create();r.subtract(t,this._controls.getPositionWithManualUpdates(),this._controls.getTargetWithManualUpdates()),r.transformQuat(t,t,this._quat);let i=(new a.Spherical).fromVec3(t);i.theta+=e.theta,i.phi+=e.phi;let n=this._controls.rotationRestriction.minAzimuthAngle*(Math.PI/180),s=this._controls.rotationRestriction.maxAzimuthAngle*(Math.PI/180);return i.theta>Math.PI?(i.theta-=2*Math.PI,n>i.theta&&(i.theta+=2*Math.PI)):i.theta<-Math.PI&&(i.theta+=2*Math.PI,s<i.theta&&(i.theta-=2*Math.PI)),i.makeSafe(),t=i.toVec3(),t=r.transformQuat(r.create(),t,this._quatInverse),t=r.add(r.create(),t,this._controls.getTargetWithManualUpdates()),t=r.subtract(r.create(),t,this._controls.getPositionWithManualUpdates()),r.clone(t)}zoomDistanceToOffset(e){let t=r.create();return r.subtract(t,this._controls.getPositionWithManualUpdates(),this._controls.getTargetWithManualUpdates()),r.multiply(r.create(),t,r.fromValues(e,e,e))}}})),s.register("cNNnA",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OrthographicCamera=void 0;var i=s("cTTbu");s("yoicn");var n=s("bJEmL"),o=s("eIStk"),a=s("3iqbd"),l=s("6BoVD"),c=s("eYU63"),u=s("c6GJS"),h=s("kEkrb"),d=s("7fzug"),f=s("f8rvL");class p extends h.AbstractCamera{constructor(e){super(e,u.CAMERATYPE.ORTHOGRAPHIC),this._converter=n.instance.resolve(i.Converter),this._logger=n.instance.resolve(i.Logger),this._tree=n.instance.resolve(c.Tree),this._bottom=100,this._direction=f.ORTHOGRAPHIC_CAMERA_DIRECTION.TOP,this._left=100,this._right=100,this._top=100,this._up=o.fromValues(0,1,0),this._controls=new d.OrthographicCameraControls(this,!0)}get bottom(){return this._bottom}set bottom(e){this._bottom=e}get direction(){return this._direction}set direction(e){const t=this._direction!==e;switch(this._direction=e,this._direction){case f.ORTHOGRAPHIC_CAMERA_DIRECTION.TOP:case f.ORTHOGRAPHIC_CAMERA_DIRECTION.BOTTOM:this.up=o.fromValues(0,1,0);break;case f.ORTHOGRAPHIC_CAMERA_DIRECTION.RIGHT:case f.ORTHOGRAPHIC_CAMERA_DIRECTION.LEFT:case f.ORTHOGRAPHIC_CAMERA_DIRECTION.BACK:case f.ORTHOGRAPHIC_CAMERA_DIRECTION.FRONT:this.up=o.fromValues(0,0,1);break;default:this.up=o.fromValues(0,-1,0)}if(t){const{position:e,target:t}=this.getZoomPositionAndTarget(void 0);this.defaultPosition=o.clone(e),this.defaultTarget=o.clone(t)}}get left(){return this._left}set left(e){this._left=e}get right(){return this._right}set right(e){this._right=e}get top(){return this._top}set top(e){this._top=e}get up(){return this._up}set up(e){this._up=e}applySettings(){const e=this._settingsEngine.camera.cameras[this.id];if(e){this.autoAdjust=e.autoAdjust,this.cameraMovementDuration=e.cameraMovementDuration,this.enableCameraControls=e.enableCameraControls,this.revertAtMouseUp=e.revertAtMouseUp,this.revertAtMouseUpDuration=e.revertAtMouseUpDuration,this.zoomExtentsFactor=e.zoomExtentsFactor;let t=this._converter.toVec3(e.position),r=this._converter.toVec3(e.target);this.defaultPosition=o.clone(t),this.defaultTarget=o.clone(r),this.position=t,this.target=r}this.position[0]===this.target[0]&&this.position[1]===this.target[1]&&this.position[2]===this.target[2]&&this._stateEngine.boundingBoxCreated.then((()=>r(this,void 0,void 0,(function*(){yield this.zoomTo(void 0,{duration:0}),this.defaultPosition=o.clone(this._controls.position),this.defaultTarget=o.clone(this._controls.target)})))),this._controls.applySettings()}assignViewer(e){let t=n.instance.resolveAll("renderingEngine").find((t=>t.id===e));if(!t){const t=new i.ShapeDiverViewerCameraError(`OrthographicCamera(${this.id}).assignViewer: Viewer with ID ${e} not found.`);throw this._logger.handleError(i.LOGGINGTOPIC.CAMERA,`OrthographicCamera(${this.id}).assignViewer`,t)}this.assignViewerInternal(e,t.canvas),this._controls.assignViewer(e,t.canvas),this._domEventListenerToken&&this._domEventEngine&&this._domEventEngine.removeDomEventListener(this._domEventListenerToken),this._domEventEngine=t.domEventEngine,this._domEventListenerToken=this._domEventEngine.addDomEventListener(this._controls.cameraControlsEventDistribution),this.boundingBox=this._tree.root.boundingBox.clone()}clone(){return new p(this.id)}getZoomPositionAndTarget(e){let t;t=e?e.clone():this._boundingBox.clone();const r=2*t.boundingSphere.radius*this.zoomExtentsFactor,i=o.clone(t.boundingSphere.center);switch(this._direction){case f.ORTHOGRAPHIC_CAMERA_DIRECTION.TOP:return{position:o.fromValues(i[0],i[1],i[2]+r),target:o.clone(i)};case f.ORTHOGRAPHIC_CAMERA_DIRECTION.BOTTOM:return{position:o.fromValues(i[0],i[1],i[2]-r),target:o.clone(i)};case f.ORTHOGRAPHIC_CAMERA_DIRECTION.RIGHT:return{position:o.fromValues(i[0]+r,i[1],i[2]),target:o.clone(i)};case f.ORTHOGRAPHIC_CAMERA_DIRECTION.LEFT:return{position:o.fromValues(i[0]-r,i[1],i[2]),target:o.clone(i)};case f.ORTHOGRAPHIC_CAMERA_DIRECTION.BACK:return{position:o.fromValues(i[0],i[1]+r,i[2]),target:o.clone(i)};case f.ORTHOGRAPHIC_CAMERA_DIRECTION.FRONT:return{position:o.fromValues(i[0],i[1]-r,i[2]),target:o.clone(i)};default:return{position:o.fromValues(i[0],i[1],i[2]+r),target:o.clone(i)}}}project(e){const t=a.targetTo(a.create(),this.position,this.target,this.up),r=a.ortho(a.create(),this.left,this.right,this.bottom,this.top,this.near,this.far);return o.transformMat4(e,e,a.invert(t,t)),o.transformMat4(e,e,r),l.fromValues(e[0],e[1])}unproject(e,t=this.position,r=this.target){const i=a.targetTo(a.create(),this.position,this.target,this.up),n=a.ortho(a.create(),this.left,this.right,this.bottom,this.top,this.near,this.far);return o.transformMat4(e,e,a.invert(n,n)),o.transformMat4(e,e,i),o.clone(e)}}e.exports.OrthographicCamera=p})),s.register("7fzug",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OrthographicCameraControls=void 0;var r=s("cTTbu");s("yoicn");var i=s("bJEmL"),n=s("dk8Lz"),o=s("gVCee"),a=s("12N37"),l=s("eL2oW");class c extends o.AbstractCameraControls{constructor(e,t){super(e,t,n.CAMERATYPE.ORTHOGRAPHIC),this._damping=.1,this._enableKeyPan=!1,this._enablePan=!0,this._enableZoom=!0,this._input={keys:{up:38,down:40,left:37,right:39},mouse:{rotate:0,zoom:1,pan:2},touch:{rotate:1,zoom:2,pan:3}},this._keyPanSpeed=.5,this._movementSmoothness=.5,this._panSpeed=.5,this._zoomSpeed=.5,this._settingsEngine=i.instance.resolve(r.SettingsEngine),this._stateEngine=i.instance.resolve(r.StateEngine),this._cameraLogic=new l.CameraControlsLogic(this),this._cameraControlsEventDistribution=new a.CameraControlsEventDistribution(this,this._cameraLogic)}applySettings(){const e=this._settingsEngine.camera.cameras[this.camera.id];if(!e)return;this.reset();const t=e.controls;this.damping=t.damping,this.enableKeyPan=t.enableKeyPan,this.enablePan=t.enablePan,this.enableZoom=t.enableZoom,this.input=t.input,this.keyPanSpeed=t.keyPanSpeed,this.movementSmoothness=t.movementSmoothness,this.panSpeed=t.panSpeed,this.zoomSpeed=t.zoomSpeed}get damping(){return this._damping}set damping(e){this._damping=e}get enableKeyPan(){return this._enableKeyPan}set enableKeyPan(e){this._enableKeyPan=e}get enablePan(){return this._enablePan}set enablePan(e){this._enablePan=e}get enableZoom(){return this._enableZoom}set enableZoom(e){this._enableZoom=e}get input(){return this._input}set input(e){this._input=e}get keyPanSpeed(){return this._keyPanSpeed}set keyPanSpeed(e){this._keyPanSpeed=e}get movementSmoothness(){return this._movementSmoothness}set movementSmoothness(e){this._movementSmoothness=e}get panSpeed(){return this._panSpeed}set panSpeed(e){this._panSpeed=e}get zoomSpeed(){return this._zoomSpeed}set zoomSpeed(e){this._zoomSpeed=e}}e.exports.OrthographicCameraControls=c})),s.register("12N37",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraControlsEventDistribution=void 0;e.exports.CameraControlsEventDistribution=class{constructor(e,t){this._controls=e,this._cameraLogic=t,this._active={zoom:!1,pan:!1},this._activeEvents=!0}activateCameraEvents(){this._activeEvents=!0}deactivateCameraEvents(){this._activeEvents=!1}onDown(e){let{x:t,y:r}=this.convertInput(e),i=window.TouchEvent&&e instanceof TouchEvent?e.touches.length:e.button,n=window.TouchEvent&&e instanceof TouchEvent?this._controls.input.touch:this._controls.input.mouse;if(i===n.pan&&this._controls.enablePan&&(this._cameraLogic.pan(t,r,this._active.pan,window.TouchEvent&&e instanceof TouchEvent),this._active.pan=!0,this._active.zoom=!1),i===n.zoom&&this._controls.enableZoom){let i=t,n=r;window.TouchEvent&&e instanceof TouchEvent&&2===this._controls.input.touch.zoom&&(i=(e.touches[0].pageX-e.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),n=(e.touches[0].pageY-e.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(i,n,this._active.zoom,window.TouchEvent&&e instanceof TouchEvent),this._active.pan=!1,this._active.zoom=!0}}onKey(e){if(this._controls.enableKeyPan)switch(e.keyCode){case this._controls.input.keys.up:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(0,.05*this._controls.keyPanSpeed,!0,!1),e.preventDefault(),e.stopPropagation();break;case this._controls.input.keys.down:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(0,.05*-this._controls.keyPanSpeed,!0,!1),e.preventDefault(),e.stopPropagation();break;case this._controls.input.keys.left:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(.05*this._controls.keyPanSpeed,0,!0,!1),e.preventDefault(),e.stopPropagation();break;case this._controls.input.keys.right:this._cameraLogic.pan(0,0,!1,!1),this._cameraLogic.pan(.05*-this._controls.keyPanSpeed,0,!0,!1),e.preventDefault(),e.stopPropagation()}}onKeyDown(e){this._activeEvents&&this.onKey(e)}onMouseDown(e){this._activeEvents&&this.onDown(e)}onMouseMove(e){this._activeEvents&&this.onMove(e)}onMouseUp(e){this._activeEvents&&this.onUp(e)}onMouseWheel(e){this._activeEvents&&this.onWheel(e)}onMove(e){let{x:t,y:r}=this.convertInput(e);if(this._controls.enablePan&&this._active.pan&&this._cameraLogic.pan(t,r,this._active.pan,window.TouchEvent&&e instanceof TouchEvent),this._controls.enableZoom&&this._active.zoom){let i=t,n=r;window.TouchEvent&&e instanceof TouchEvent&&2===this._controls.input.touch.zoom&&(i=(e.touches[0].pageX-e.touches[1].pageX)/window.innerWidth*(window.innerWidth/window.innerHeight),n=(e.touches[0].pageY-e.touches[1].pageY)/window.innerHeight),this._cameraLogic.zoom(i,n,this._active.zoom,window.TouchEvent&&e instanceof TouchEvent)}}onTouchEnd(e){this._activeEvents&&this.onUp(e)}onTouchMove(e){this._activeEvents&&this.onMove(e)}onTouchStart(e){this._activeEvents&&this.onDown(e)}onUp(e){this._active.zoom=!1,this._active.pan=!1}onWheel(e){if(!this._controls.enableZoom)return;let t=0;void 0!==e.deltaY?t=-e.deltaY:void 0!==e.detail&&(t=-e.detail),Math.sign(t)>0?(this._cameraLogic.zoom(0,0,!1,!1),this._cameraLogic.zoom(1,0,!0,!1)):(this._cameraLogic.zoom(1,0,!1,!1),this._cameraLogic.zoom(0,0,!0,!1))}reset(){this._active={zoom:!1,pan:!1}}convertInput(e){let t=window.innerWidth/window.innerHeight;return e instanceof MouseEvent?{x:e.clientX/window.innerWidth*t,y:e.clientY/window.innerHeight}:{x:e.touches[0].pageX/window.innerWidth*t,y:e.touches[0].pageY/window.innerHeight}}}})),s.register("eL2oW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraControlsLogic=void 0;var r=s("eIStk"),i=s("6BoVD"),n=s("3iqbd");e.exports.CameraControlsLogic=class{constructor(e){this._controls=e,this._adjustedSettings={damping:()=>this._controls.damping*this._settingsAdjustments.damping,movementSmoothness:()=>this._controls.movementSmoothness*this._settingsAdjustments.movementSmoothness,panSpeed:()=>this._controls.panSpeed*this._settingsAdjustments.panSpeed,zoomSpeed:()=>this._controls.zoomSpeed*this._settingsAdjustments.zoomSpeed},this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:r.create()}},this._dollyDelta=0,this._dollyEnd=0,this._dollyStart=0,this._panDelta=i.create(),this._panEnd=i.create(),this._panStart=i.create(),this._settingsAdjustments={damping:1,movementSmoothness:1,panSpeed:2,zoomSpeed:.025},this._touchAdjustments={damping:1,movementSmoothness:1,panSpeed:2,zoomSpeed:50}}isWithinRestrictions(e,t){return!0}pan(e,t,n,s){if(s&&(e/=window.devicePixelRatio,t/=window.devicePixelRatio),n){if(this._panEnd=i.fromValues(e,t),i.sub(this._panDelta,this._panEnd,this._panStart),0===this._panDelta[0]&&0===this._panDelta[1])return;i.copy(this._panStart,this._panEnd);const n=this._adjustedSettings.panSpeed()*(s?this._touchAdjustments.panSpeed:1);let o=this.panDeltaToOffset(i.mul(i.create(),this._panDelta,i.fromValues(n,n)));this._damping.pan.duration>0&&(o[0]<0?o[0]=Math.min(o[0],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[0]):o[0]=Math.max(o[0],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[0]),o[1]<0?o[1]=Math.min(o[1],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[1]):o[1]=Math.max(o[1],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[1]),o[2]<0?o[2]=Math.min(o[2],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[2]):o[2]=Math.max(o[2],this._adjustedSettings.movementSmoothness()*this._damping.pan.offset[2]));let a=1-Math.max(.01,Math.min(.99,this._adjustedSettings.damping())),l=(Math.log(1/Math.abs(o[0]))-5*Math.log(10))/Math.log(a),c=(Math.log(1/Math.abs(o[1]))-5*Math.log(10))/Math.log(a),u=(Math.log(1/Math.abs(o[2]))-5*Math.log(10))/Math.log(a);this._damping.pan.time=0,this._damping.pan.duration=16.6666*Math.max(l,Math.max(c,u)),this._damping.pan.offset=r.clone(o),this._damping.rotation.duration=0,this._damping.zoom.duration=0,this._controls.applyTargetVector(o,!0),this._controls.applyPositionVector(o,!0)}else this._panStart=i.fromValues(e,t)}reset(){this._damping={rotation:{time:0,duration:0,theta:0,phi:0},zoom:{time:0,duration:0,delta:0},pan:{time:0,duration:0,offset:r.create()}},this._dollyDelta=0,this._dollyEnd=0,this._dollyStart=0,this._panDelta=i.create(),this._panEnd=i.create(),this._panStart=i.create()}restrict(e,t){return{position:e,target:t}}update(e,t){!0===t&&(this._damping.zoom.duration=0,this._damping.pan.duration=0);let i=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping()));if(this._damping.pan.duration>0)if(this._damping.pan.time+e>this._damping.pan.duration)this._damping.pan.time=this._damping.pan.duration,this._damping.pan.duration=0;else{this._damping.pan.time+=e;let t=this._damping.pan.time/16.6666,n=Math.pow(i,t),s=r.multiply(r.create(),this._damping.pan.offset,r.fromValues(n,n,n));this._controls.applyTargetVector(s),this._controls.applyPositionVector(s)}else this._damping.pan.time=0;if(this._damping.zoom.duration>0)if(this._damping.zoom.time+e>this._damping.zoom.duration)this._damping.zoom.time=this._damping.zoom.duration,this._damping.zoom.duration=0;else{this._damping.zoom.time+=e;let t=this._damping.zoom.time/16.6666,n=this._damping.zoom.delta*Math.pow(i,t),s=r.distance(this._controls.getTargetWithManualUpdates(),this._controls.getPositionWithManualUpdates())*(1-n),o=r.create(),a=r.create();r.normalize(o,r.subtract(o,this._controls.getTargetWithManualUpdates(),this._controls.getPositionWithManualUpdates())),r.add(a,this._controls.getPositionWithManualUpdates(),r.multiply(a,o,r.fromValues(s,s,s))),r.subtract(a,a,this._controls.getTargetWithManualUpdates()),this._controls.applyTargetVector(a,!0)}else this._damping.zoom.time=0}zoom(e,t,i,n){var s=Math.sqrt(e*e+t*t);if(n&&(s/=window.devicePixelRatio),i){this._dollyEnd=s,this._dollyDelta=this._dollyEnd-this._dollyStart,this._dollyStart=this._dollyEnd,this._damping.zoom.duration>0&&(this._dollyDelta<0?this._dollyDelta=Math.min(this._dollyDelta,this._adjustedSettings.movementSmoothness()*this._damping.zoom.delta):this._dollyDelta=Math.max(this._dollyDelta,this._adjustedSettings.movementSmoothness()*this._damping.zoom.delta));let e=this._dollyDelta*this._adjustedSettings.zoomSpeed()*(n?this._touchAdjustments.zoomSpeed:1),t=1-Math.max(.01,Math.min(1,this._adjustedSettings.damping())),i=(Math.log(1/Math.abs(this._dollyDelta))-5*Math.log(10))/Math.log(t);this._damping.zoom.time=0,this._damping.zoom.duration=16.6666*i,this._damping.zoom.delta=e,this._damping.pan.duration=0;let o=r.distance(this._controls.getTargetWithManualUpdates(),this._controls.getPositionWithManualUpdates())*(1-e),a=r.create(),l=r.create();r.normalize(a,r.subtract(a,this._controls.getTargetWithManualUpdates(),this._controls.getPositionWithManualUpdates())),r.add(l,this._controls.getPositionWithManualUpdates(),r.multiply(l,a,r.fromValues(o,o,o))),r.subtract(l,l,this._controls.getTargetWithManualUpdates()),this._controls.applyTargetVector(l,!0)}else this._dollyStart=s}panDeltaToOffset(e){let t=r.create(),i=r.create();r.subtract(t,this._controls.getPositionWithManualUpdates(),this._controls.getTargetWithManualUpdates());const s=this._controls.camera,o=n.targetTo(n.create(),s.position,s.target,s.up),a=r.fromValues(o[0],o[1],o[2]),l=-e[0]*(s.right-s.left)*.5/1;r.multiply(a,a,r.fromValues(l,l,l)),r.add(i,i,a);const c=r.fromValues(o[4],o[5],o[6]),u=e[1]*(s.right-s.left)*.5/1;return r.multiply(c,c,r.fromValues(u,u,u)),r.add(i,i,c),r.clone(i)}}})),s.register("f8rvL",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ORTHOGRAPHIC_CAMERA_DIRECTION=void 0,(r=e.exports.ORTHOGRAPHIC_CAMERA_DIRECTION||(e.exports.ORTHOGRAPHIC_CAMERA_DIRECTION={})).TOP="top",r.BOTTOM="bottom",r.LEFT="left",r.RIGHT="right",r.FRONT="front",r.BACK="back"})),s.register("eAhLl",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SpotLight=e.exports.PointLight=e.exports.HemisphereLight=e.exports.DirectionalLight=e.exports.AmbientLight=e.exports.AbstractLight=e.exports.LightScene=e.exports.LIGHTTYPE=e.exports.LightEngine=void 0;var r=s("1Zb4M");Object.defineProperty(e.exports,"AbstractLight",{enumerable:!0,get:function(){return r.AbstractLight}});var i=s("fK79F");Object.defineProperty(e.exports,"LightEngine",{enumerable:!0,get:function(){return i.LightEngine}});var n=s("3is2f");Object.defineProperty(e.exports,"LightScene",{enumerable:!0,get:function(){return n.LightScene}});var o=s("fOEkl");Object.defineProperty(e.exports,"AmbientLight",{enumerable:!0,get:function(){return o.AmbientLight}});var a=s("fJOjl");Object.defineProperty(e.exports,"DirectionalLight",{enumerable:!0,get:function(){return a.DirectionalLight}});var l=s("jHzqu");Object.defineProperty(e.exports,"HemisphereLight",{enumerable:!0,get:function(){return l.HemisphereLight}});var c=s("1PAJ5");Object.defineProperty(e.exports,"PointLight",{enumerable:!0,get:function(){return c.PointLight}});var u=s("6Qhdq");Object.defineProperty(e.exports,"SpotLight",{enumerable:!0,get:function(){return u.SpotLight}});var h=s("4F3P3");Object.defineProperty(e.exports,"LIGHTTYPE",{enumerable:!0,get:function(){return h.LIGHTTYPE}})})),s.register("1Zb4M",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractLight=void 0;var r=s("cTTbu"),i=s("eYU63");s("yoicn");var n=s("bJEmL");class o extends i.AbstractTreeNodeData{constructor(e){super(e.id),this._useNodeData=!1,this._uuidGenerator=n.instance.resolve(r.UuidGenerator),this._color=e.color,this._intensity=e.intensity,this._type=e.type,this._name=e.name,this._order=e.order}get color(){return this._color}set color(e){this._color=e,this.updateVersion()}get intensity(){return this._intensity}set intensity(e){this._intensity=e,this.updateVersion()}get name(){return this._name}set name(e){this._name=e,this.updateVersion()}get order(){return this._order}set order(e){this._order=e,this.updateVersion()}get type(){return this._type}set useNodeData(e){this._useNodeData=e}get useNodeData(){return this._useNodeData}}e.exports.AbstractLight=o})),s.register("fK79F",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.LightEngine=void 0,s("yoicn");var r=s("bJEmL"),i=s("eIStk"),n=s("cTTbu"),o=s("fOEkl"),a=s("fJOjl"),l=s("jHzqu"),c=s("1PAJ5"),u=s("6Qhdq"),h=s("3is2f"),d=s("4F3P3"),f=s("eYU63");e.exports.LightEngine=class{constructor(e){this._viewerId=e,this._converter=r.instance.resolve(n.Converter),this._lightNode=new f.TreeNode("lights"),this._settingsEngine=r.instance.resolve(n.SettingsEngine),this._tree=r.instance.resolve(f.Tree),this._uuidGenerator=r.instance.resolve(n.UuidGenerator),this._lightScenes={},this._tree.root.addChild(this._lightNode)}get lightScene(){return this._lightScene}get lightScenes(){return this._lightScenes}applySettings(){this._lightScenes={};for(let e in this._settingsEngine.light.lightScenes){const t=this._uuidGenerator.validate(e)?e:this._uuidGenerator.create(),r=this._settingsEngine.light.lightScenes[e].name?this._settingsEngine.light.lightScenes[e].name:e,i=new h.LightScene({id:t,name:r});for(let t in this._settingsEngine.light.lightScenes[e].lights){const r=this._uuidGenerator.validate(t)?t:this._uuidGenerator.create(),n=this._settingsEngine.light.lightScenes[e].lights[t];let s;switch(n.type){case d.LIGHTTYPE.DIRECTIONAL:s=new a.DirectionalLight({color:this._converter.toColor(n.properties.color),intensity:n.properties.intensity,direction:this._converter.toVec3(n.properties.direction),castShadow:n.properties.castShadow,name:n.name?n.name:t,order:n.order,id:r});break;case d.LIGHTTYPE.HEMISPHERE:s=new l.HemisphereLight({color:this._converter.toColor(n.properties.skyColor),intensity:n.properties.intensity,groundColor:this._converter.toColor(n.properties.groundColor),name:n.name?n.name:t,order:n.order,id:r});break;case d.LIGHTTYPE.POINT:s=new c.PointLight({color:this._converter.toColor(n.properties.color),intensity:n.properties.intensity,position:this._converter.toVec3(n.properties.position),distance:n.properties.distance,decay:n.properties.decay,name:n.name?n.name:t,order:n.order,id:r});break;case d.LIGHTTYPE.SPOT:s=new u.SpotLight({color:this._converter.toColor(n.properties.color),intensity:n.properties.intensity,position:this._converter.toVec3(n.properties.position),target:this._converter.toVec3(n.properties.target),distance:n.properties.distance,decay:n.properties.decay,angle:n.properties.angle,penumbra:n.properties.penumbra,name:n.name?n.name:t,order:n.order,id:r});break;case d.LIGHTTYPE.AMBIENT:default:s=new o.AmbientLight({color:this._converter.toColor(n.properties.color),intensity:n.properties.intensity,name:n.name?n.name:t,order:n.order,id:r})}i.addLight(s)}this._lightScenes[i.id]=i}if(void 0===this._settingsEngine.light.lightSceneId&&Object.values(this._settingsEngine.light.lightScenes).length>0){if(!1===this.assignLightScene(Object.keys(this._settingsEngine.light.lightScenes)[0])){const e=this.createLightScene({name:"default"===this._settingsEngine.light.lightSceneId?"default":"standard"});e.addLight(new o.AmbientLight({color:"#ffffff",intensity:.5,name:"ambient0"})),e.addLight(new a.DirectionalLight({color:"#ffffff",intensity:.75,direction:i.fromValues(.5774,-.5774,.5774),castShadow:!0,name:"directional0"})),e.addLight(new a.DirectionalLight({color:"#ffffff",intensity:.35,direction:i.fromValues(.25,-1,1),castShadow:!1,name:"directional1"})),this._lightScenes[e.id]=e}}else if(this._settingsEngine.light.lightSceneId){if(!1===this.assignLightScene(this._settingsEngine.light.lightSceneId)){const e=this.createLightScene({name:"default"===this._settingsEngine.light.lightSceneId?"default":"standard"});e.addLight(new o.AmbientLight({color:"#ffffff",intensity:.5,name:"ambient0"})),e.addLight(new a.DirectionalLight({color:"#ffffff",intensity:.75,direction:i.fromValues(.5774,-.5774,.5774),castShadow:!0,name:"directional0"})),e.addLight(new a.DirectionalLight({color:"#ffffff",intensity:.35,direction:i.fromValues(.25,-1,1),castShadow:!1,name:"directional1"})),this._lightScenes[e.id]=e}}else{const e=this.createLightScene({name:"standard",standard:!0});this._lightScenes[e.id]=e}}assignLightScene(e){if(!this._lightScenes[e]){for(let t in this._lightScenes){if((this._lightScenes[t].name||t)===e){return this.assignLightScene(t)}}return!1}for(this._lightScene=this._lightScenes[e];this._lightNode.children.length>0;)this._lightNode.removeChild(this._lightNode.children[0]);return this._lightNode.addChild(this._lightScene.node),this._lightNode.updateVersion(),!0}close(){this._tree.root.removeChild(this._lightNode)}createLightScene(e){const t=this._uuidGenerator.create(),r=new h.LightScene({id:t,name:e.name});for(!0===e.standard&&(r.addLight(new a.DirectionalLight({color:"#ffffff",intensity:2.5,direction:i.fromValues(.5774,-.5774,.5774),castShadow:!0,name:"directional0"})),r.addLight(new a.DirectionalLight({color:"#ffffff",intensity:1,direction:i.fromValues(-.5774,-.5774,.5774),castShadow:!1,name:"directional1"}))),this._lightScenes[t]=r,this._lightScene=r;this._lightNode.children.length>0;)this._lightNode.removeChild(this._lightNode.children[0]);return this._lightNode.addChild(this._lightScene.node),this._lightNode.updateVersion(),r}removeLightScene(e){if(!this._lightScenes[e]){for(let t in this._lightScenes){if((this._lightScenes[t].name||t)===e){return this.removeLightScene(t)}}return!1}for(this._lightScene&&this._lightScene.id===e&&(this._lightScene=void 0),delete this._lightScenes[e];this._lightNode.children.length>0;)this._lightNode.removeChild(this._lightNode.children[0]);return this._lightNode.updateVersion(),!0}saveSettings(){this._settingsEngine.light.lightSceneId=this.lightScene?this.lightScene.id:"standard";const e={};for(let t in this._lightScenes){const r=this._lightScenes[t],i=r.name||t;e[t]={name:i,lights:{}};for(let i in r.lights){const n=r.lights[i];let s;switch(n.type){case d.LIGHTTYPE.DIRECTIONAL:s={color:n.color,intensity:n.intensity,direction:{x:n.direction[0],y:n.direction[1],z:n.direction[2]},castShadow:n.castShadow,shadowMapResolution:n.shadowMapResolution,shadowMapBias:n.shadowMapBias};break;case d.LIGHTTYPE.HEMISPHERE:s={skyColor:n.color,intensity:n.intensity,groundColor:n.groundColor};break;case d.LIGHTTYPE.POINT:s={color:n.color,intensity:n.intensity,position:{x:n.position[0],y:n.position[1],z:n.position[2]},distance:n.distance,decay:n.decay};break;case d.LIGHTTYPE.SPOT:s={color:n.color,intensity:n.intensity,position:{x:n.position[0],y:n.position[1],z:n.position[2]},target:{x:n.target[0],y:n.target[1],z:n.target[2]},distance:n.distance,decay:n.decay,angle:n.angle,penumbra:n.penumbra};break;case d.LIGHTTYPE.AMBIENT:default:s={color:n.color,intensity:n.intensity}}e[t].lights[i]={name:n.name,type:n.type,properties:s},void 0!==n.order&&(e[t].lights[i].order=n.order)}}this._settingsEngine.light.lightScenes=e}}})),s.register("fOEkl",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AmbientLight=void 0;var r=s("4F3P3"),i=s("1Zb4M");class n extends i.AbstractLight{constructor(e){super({color:e.color||"#ffffff",intensity:void 0!==e.intensity?e.intensity:.5,type:r.LIGHTTYPE.AMBIENT,name:e.name,order:e.order,id:e.id})}clone(){return new n({color:this.color||"#ffffff",intensity:this.intensity||.5,name:this.name,order:this.order})}}e.exports.AmbientLight=n})),s.register("4F3P3",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.LIGHTTYPE=void 0,(r=e.exports.LIGHTTYPE||(e.exports.LIGHTTYPE={})).AMBIENT="ambient",r.DIRECTIONAL="directional",r.HEMISPHERE="hemisphere",r.POINT="point",r.RECTANGLE="rectangle",r.SPOT="spot"})),s.register("fJOjl",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DirectionalLight=void 0;var r=s("eIStk"),i=s("4F3P3"),n=s("1Zb4M");class o extends n.AbstractLight{constructor(e){super({color:e.color||"#ffffff",intensity:void 0!==e.intensity?e.intensity:.5,type:i.LIGHTTYPE.DIRECTIONAL,name:e.name,order:e.order,id:e.id}),this._castShadow=!1,this._direction=r.fromValues(-1,0,1),this._shadowMapBias=-.003,this._shadowMapResolution=1024,e.direction&&(this._direction=e.direction),e.castShadow&&(this._castShadow=e.castShadow),e.shadowMapResolution&&(this._shadowMapResolution=e.shadowMapResolution),e.shadowMapBias&&(this._shadowMapBias=e.shadowMapBias)}get castShadow(){return this._castShadow}set castShadow(e){this._castShadow=e,this.updateVersion()}get direction(){return this._direction}set direction(e){this._direction=e,this.updateVersion()}get shadowMapBias(){return this._shadowMapBias}set shadowMapBias(e){this._shadowMapBias=e,this.updateVersion()}get shadowMapResolution(){return this._shadowMapResolution}set shadowMapResolution(e){this._shadowMapResolution=e,this.updateVersion()}clone(){return new o({color:this.color,intensity:this.intensity,direction:this.direction,castShadow:this.castShadow,shadowMapResolution:this.shadowMapResolution,shadowMapBias:this.shadowMapBias,name:this.name,order:this.order})}}e.exports.DirectionalLight=o})),s.register("jHzqu",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HemisphereLight=void 0;var r=s("4F3P3"),i=s("1Zb4M");class n extends i.AbstractLight{constructor(e){super({color:e.color||"#ffffff",intensity:void 0!==e.intensity?e.intensity:.5,type:r.LIGHTTYPE.HEMISPHERE,name:e.name,order:e.order,id:e.id}),this._groundColor="#ffffff",e.groundColor&&(this._groundColor=e.groundColor)}get groundColor(){return this._groundColor}set groundColor(e){this._groundColor=e,this.updateVersion()}clone(){return new n({color:this.color,groundColor:this.groundColor,intensity:this.intensity,name:this.name,order:this.order})}}e.exports.HemisphereLight=n})),s.register("1PAJ5",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PointLight=void 0;var r=s("eIStk"),i=s("4F3P3"),n=s("1Zb4M");class o extends n.AbstractLight{constructor(e){super({color:e.color||"#ffffff",intensity:void 0!==e.intensity?e.intensity:.5,type:i.LIGHTTYPE.POINT,name:e.name,order:e.order,id:e.id}),this._decay=2,this._distance=0,this._position=r.fromValues(0,0,0),e.position&&(this._position=e.position),e.distance&&(this._distance=e.distance),e.decay&&(this._decay=e.decay)}get decay(){return this._decay}set decay(e){this._decay=e,this.updateVersion()}get distance(){return this._distance}set distance(e){this._distance=e,this.updateVersion()}get position(){return this._position}set position(e){this._position=e,this.updateVersion()}clone(){return new o({color:this.color,position:this.position,distance:this.distance,decay:this.decay,intensity:this.intensity,name:this.name,order:this.order})}}e.exports.PointLight=o})),s.register("6Qhdq",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SpotLight=void 0;var r=s("eIStk"),i=s("4F3P3"),n=s("1Zb4M");class o extends n.AbstractLight{constructor(e){super({color:e.color||"#ffffff",intensity:void 0!==e.intensity?e.intensity:.5,type:i.LIGHTTYPE.SPOT,name:e.name,order:e.order,id:e.id}),this._angle=Math.PI/4,this._decay=1,this._distance=0,this._penumbra=.5,this._position=r.fromValues(-1,0,1),this._target=r.fromValues(0,0,0),e.position&&(this._position=e.position),e.target&&(this._target=e.target),e.distance&&(this._distance=e.distance),e.decay&&(this._decay=e.decay),e.angle&&(this._angle=e.angle),e.penumbra&&(this._penumbra=e.penumbra)}get angle(){return this._angle}set angle(e){this._angle=e,this.updateVersion()}get decay(){return this._decay}set decay(e){this._decay=e,this.updateVersion()}get distance(){return this._distance}set distance(e){this._distance=e,this.updateVersion()}get penumbra(){return this._penumbra}set penumbra(e){this._penumbra=e,this.updateVersion()}get position(){return this._position}set position(e){this._position=e,this.updateVersion()}get target(){return this._target}set target(e){this._target=e,this.updateVersion()}clone(){return new o({color:this.color,position:this.position,target:this.target,distance:this.distance,decay:this.decay,angle:this.angle,penumbra:this.penumbra,intensity:this.intensity,name:this.name,order:this.order})}}e.exports.SpotLight=o})),s.register("3is2f",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.LightScene=void 0;var r=s("eYU63"),i=s("fOEkl"),n=s("fJOjl"),o=s("jHzqu"),a=s("1PAJ5"),l=s("6Qhdq");e.exports.LightScene=class{constructor(e){this._lights={},this._id=e.id,this._name=e.name,this._node=new r.TreeNode(e.name||e.id)}get id(){return this._id}get lights(){return this._lights}get name(){return this._name}set name(e){this._name=e}get node(){return this._node}addAmbientLight(e){const t=new i.AmbientLight(e);return this.addLight(t),t}addDirectionalLight(e){const t=new n.DirectionalLight(e);return this.addLight(t),t}addHemisphereLight(e){const t=new o.HemisphereLight(e);return this.addLight(t),t}addLight(e){const t=new r.TreeNode(e.id);t.data.push(e),this._node.addChild(t),this._lights[e.id]=e,this._node.updateVersion()}addPointLight(e){const t=new a.PointLight(e);return this.addLight(t),t}addSpotLight(e){const t=new l.SpotLight(e);return this.addLight(t),t}removeLight(e){if(!this._lights[e])return!1;for(let t=0;t<this._node.children.length;t++){const r=this._node.children[t];if(r&&r.name===e){this._node.removeChild(r);break}}return delete this._lights[e],this._node.updateVersion(),!0}}})),s.register("iBhyF",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TONE_MAPPING=e.exports.TEXTURE_ENCODING=e.exports.VISIBILITYMODE=e.exports.RENDERERTYPE=void 0;var r=s("a54op");Object.defineProperty(e.exports,"RENDERERTYPE",{enumerable:!0,get:function(){return r.RENDERERTYPE}}),Object.defineProperty(e.exports,"TEXTURE_ENCODING",{enumerable:!0,get:function(){return r.TEXTURE_ENCODING}}),Object.defineProperty(e.exports,"TONE_MAPPING",{enumerable:!0,get:function(){return r.TONE_MAPPING}}),Object.defineProperty(e.exports,"VISIBILITYMODE",{enumerable:!0,get:function(){return r.VISIBILITYMODE}})})),s.register("a54op",(function(e,t){var r,i,n,s;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TONE_MAPPING=e.exports.TEXTURE_ENCODING=e.exports.VISIBILITYMODE=e.exports.RENDERERTYPE=void 0,(r=e.exports.RENDERERTYPE||(e.exports.RENDERERTYPE={})).STANDARD="standard",r.ATTRIBUTES="attributes",(i=e.exports.VISIBILITYMODE||(e.exports.VISIBILITYMODE={})).INSTANT="instant",i.SESSION="session",i.MANUAL="manual",(n=e.exports.TEXTURE_ENCODING||(e.exports.TEXTURE_ENCODING={})).LINEAR="linear",n.SRGB="srgb",n.RGBE="rgbe",n.RGBM7="rgbm7",n.RGBM16="rgbm16",n.RGBD="rgbd",n.GAMMA="gamma",(s=e.exports.TONE_MAPPING||(e.exports.TONE_MAPPING={})).NONE="none",s.LINEAR="linear",s.REINHARD="reinhard",s.CINEON="cineon",s.ACES_FILMIC="aces_filmic"})),s.register("iqwE1",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ENVIRONMENT_MAP_CUBE=e.exports.ENVIRONMENT_MAP=e.exports.SDThreejsObject=e.exports.ThreejsData=e.exports.RenderingEngine=void 0;var r=s("aidvb");Object.defineProperty(e.exports,"RenderingEngine",{enumerable:!0,get:function(){return r.RenderingEngine}});var i=s("cUjyw");Object.defineProperty(e.exports,"ThreejsData",{enumerable:!0,get:function(){return i.ThreejsData}});var n=s("hrRY8");Object.defineProperty(e.exports,"SDThreejsObject",{enumerable:!0,get:function(){return n.SDNode}});var o=s("gsATb");Object.defineProperty(e.exports,"ENVIRONMENT_MAP",{enumerable:!0,get:function(){return o.ENVIRONMENT_MAP}}),Object.defineProperty(e.exports,"ENVIRONMENT_MAP_CUBE",{enumerable:!0,get:function(){return o.ENVIRONMENT_MAP_CUBE}})})),s.register("aidvb",(function(e,t){var r,i=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),n=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&i(t,e,r);return n(t,e),t},a=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},l=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},c=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RenderingEngine=void 0;const u=o(s("ilwiq"));s("yoicn");var h=s("bJEmL"),d=s("dk8Lz"),f=s("ldVf1"),p=s("eYU63"),m=s("eAhLl"),g=s("iBhyF"),v=s("cTTbu"),_=s("12eGO"),b=s("4Lh4G"),y=s("cr4ix"),E=s("gEWC5"),w=s("gsATb"),x=s("cZIX4"),A=s("iaDwp"),T=s("4g3Ng"),S=s("dU1UM"),M=s("1qIf2"),C=s("aMxoQ"),R=s("3Bg06"),I=s("8nFhy");e.exports.RenderingEngine=class{constructor(e){this._canvasEngine=h.instance.resolve(f.CanvasEngine),this._converter=h.instance.resolve(v.Converter),this._eventEngine=h.instance.resolve(v.EventEngine),this._logger=h.instance.resolve(v.Logger),this._settingsEngine=h.instance.resolve(v.SettingsEngine),this._stateEngine=h.instance.resolve(v.StateEngine),this._tree=h.instance.resolve(p.Tree),this._ambientOcclusion=!0,this._ambientOcclusionIntensity=.1,this._automaticResizing=!0,this._beautyRenderBlendingDuration=1500,this._beautyRenderDelay=50,this._blur=!1,this._blurSceneWhenBusy=!0,this._busy=!1,this._clearAlpha=1,this._clearColor="#ffffff",this._closed=!1,this._environmentMap="none",this._environmentMapAsBackground=!1,this._environmentMapResolution="1024",this._gridVisibility=!0,this._groundPlaneVisibility=!0,this._pointSize=1,this._shadows=!0,this._show=!1,this._showStatistics=!1,this._type=g.RENDERERTYPE.STANDARD,r.set(this,[]),u.Object3D.DefaultUp=new u.Vector3(0,0,1),this._id=e.id,this._visibility=e.visibility,this._branding=e.branding,this._canvas=this._canvasEngine.getCanvas(this._canvasEngine.createCanvasObject(e.canvas)),this._domEventEngine=new v.DomEventEngine(this._id,this._canvas.canvasElement),this._cameraEngine=new d.CameraEngine(this._id,this._canvas.canvasElement,this._domEventEngine),this._lightEngine=new m.LightEngine(this._id),this._animationManager=new I.AnimationManager(this),this._beautyRenderingManager=new S.BeautyRenderingManager(this),this._cameraManager=new R.CameraManager(this),this._environmentGeometryManager=new M.EnvironmentGeometryManager(this),this._sceneTracingManager=new C.SceneTracingManager(this),this._sceneTreeManager=new b.SceneTreeManager(this),this._renderingManager=new y.RenderingManager(this),this._environmentMapLoader=new w.EnvironmentMapLoader(this),this._materialLoader=new E.MaterialLoader(this),this._geometryLoader=new x.GeometryLoader(this),this._htmlElementAnchorLoader=new T.HTMLElementAnchorLoader(this),this._lightLoader=new A.LightLoader(this),this._renderer=this.renderingManager.createRenderer(this._canvas.canvasElement),this._logoDivElement=this.renderingManager.addLogo(this._canvas.canvasElement,this._branding),this._beautyRenderingManager.init(),this._cameraManager.init(),this._environmentGeometryManager.init(),this._sceneTracingManager.init(),this._sceneTreeManager.init(),this._renderingManager.init(),this._environmentMapLoader.init(),this._materialLoader.init(),this._geometryLoader.init(),this._htmlElementAnchorLoader.init(),this._lightLoader.init(),this._renderingManager.start(),this._visibility===g.VISIBILITYMODE.INSTANT&&(this.show=!0),this._visibility===g.VISIBILITYMODE.SESSION&&this._stateEngine.boundingBoxCreated.then((()=>{this._closed||this._stateEngine.viewers[this.id].settingsLoaded.then((()=>{this._closed||(this._environmentGeometryManager.changeSceneExtents(this._sceneTreeManager.boundingBox),this.show=!0)}))})),this.stateEngine.primarySessionAvailable.then((()=>{var e;null===(e=this.stateEngine.primarySession)||void 0===e||e.settingsRegistered.then((()=>{this._closed||this.applySettings()}))}))}get ambientOcclusion(){return this._ambientOcclusion}set ambientOcclusion(e){this._ambientOcclusion=e}get ambientOcclusionIntensity(){return this._ambientOcclusionIntensity}set ambientOcclusionIntensity(e){this._ambientOcclusionIntensity=e}get animationManager(){return this._animationManager}get animations(){return l(this,r,"f")}get automaticResizing(){return this._automaticResizing}set automaticResizing(e){this._automaticResizing=e}get beautyRenderBlendingDuration(){return this._beautyRenderBlendingDuration}set beautyRenderBlendingDuration(e){this._beautyRenderBlendingDuration=e}get beautyRenderDelay(){return this._beautyRenderDelay}set beautyRenderDelay(e){this._beautyRenderDelay=e}get beautyRenderingManager(){return this._beautyRenderingManager}get blur(){return this._blur}set blur(e){this._blur=e}get blurSceneWhenBusy(){return this._blurSceneWhenBusy}set blurSceneWhenBusy(e){this._blurSceneWhenBusy=e}get busy(){return this._busy}set busy(e){this._busy=e}get cameraEngine(){return this._cameraEngine}get cameraManager(){return this._cameraManager}get canvas(){return this._canvas.canvasElement}get canvasEngine(){return this._canvasEngine}get clearAlpha(){return this._clearAlpha}set clearAlpha(e){this._clearAlpha=e}get clearColor(){return this._clearColor}set clearColor(e){this._clearColor=e}get closed(){return this._closed}get continuousRendering(){return this._renderingManager.continuousRendering}set continuousRendering(e){this._renderingManager.continuousRendering=e}get continuousShadowMapUpdate(){return this._renderingManager.continuousShadowMapUpdate}set continuousShadowMapUpdate(e){this._renderingManager.continuousShadowMapUpdate=e}get convertSDTFItemToVisualizationData(){return this._convertSDTFItemToVisualizationData}set convertSDTFItemToVisualizationData(e){this._convertSDTFItemToVisualizationData=e}get domEventEngine(){return this._domEventEngine}get environmentMap(){return this._environmentMap}set environmentMap(e){this._environmentMap=e,this._environmentMapLoader.load(this.environmentMap)}get environmentMapAsBackground(){return this._environmentMapAsBackground}set environmentMapAsBackground(e){this._environmentMapAsBackground=e}get environmentMapLoader(){return this._environmentMapLoader}get environmentMapResolution(){return this._environmentMapResolution}set environmentMapResolution(e){this._environmentMapResolution=e,this._environmentMapLoader.load(this.environmentMap)}get eventEngine(){return this._eventEngine}get geometryLoader(){return this._geometryLoader}get gridColor(){return this._environmentGeometryManager.gridColor}set gridColor(e){this._environmentGeometryManager.gridColor=e}get gridVisibility(){return this._gridVisibility}set gridVisibility(e){this._environmentGeometryManager.grid&&(this._environmentGeometryManager.grid.visible=e),this._gridVisibility=e}get groundPlaneColor(){return this._environmentGeometryManager.groundPlaneColor}set groundPlaneColor(e){this._environmentGeometryManager.groundPlaneColor=e}get groundPlaneVisibility(){return this._groundPlaneVisibility}set groundPlaneVisibility(e){this._environmentGeometryManager.groundPlane&&(this._environmentGeometryManager.groundPlane.visible=e),this._groundPlaneVisibility=e}get htmlElementAnchorLoader(){return this._htmlElementAnchorLoader}get id(){return this._id}get lightEngine(){return this._lightEngine}get lightLoader(){return this._lightLoader}get lightScene(){return this.lightEngine.lightScene?this.lightEngine.lightScene.id:""}get lightSceneId(){return this.lightEngine.lightScene?this.lightEngine.lightScene.id:""}get logoDivElement(){return this._logoDivElement}get materialLoader(){return this._materialLoader}get minimalRendering(){return this.renderingManager.minimalRendering}get outputEncoding(){switch(this._renderer.outputEncoding){case u.sRGBEncoding:return g.TEXTURE_ENCODING.SRGB;case u.LinearEncoding:default:return g.TEXTURE_ENCODING.LINEAR}}set outputEncoding(e){switch(e){case g.TEXTURE_ENCODING.SRGB:this._renderer.outputEncoding=u.sRGBEncoding,this._beautyRenderingManager.assignOutputEncoding(u.sRGBEncoding);break;case g.TEXTURE_ENCODING.LINEAR:default:this._renderer.outputEncoding=u.LinearEncoding,this._beautyRenderingManager.assignOutputEncoding(u.LinearEncoding)}}get physicallyCorrectLights(){return this._renderer.physicallyCorrectLights}set physicallyCorrectLights(e){this._renderer.physicallyCorrectLights=e}get pointSize(){return this._pointSize}set pointSize(e){this._pointSize=e,this.materialLoader.assignPointSize(e)}get renderer(){return this._renderer}get renderingManager(){return this._renderingManager}get scene(){return this._sceneTreeManager.scene}get sceneTracingManager(){return this._sceneTracingManager}get sceneTreeManager(){return this._sceneTreeManager}get settingsEngine(){return this._settingsEngine}get shadows(){return this._shadows}set shadows(e){this._shadows=e}get show(){return this._show}set show(e){this._show=e}get showStatistics(){return this._showStatistics}set showStatistics(e){this._showStatistics=e}get stateEngine(){return this._stateEngine}get textureEncoding(){switch(this.materialLoader.textureEncoding){case u.sRGBEncoding:return g.TEXTURE_ENCODING.SRGB;case u.LinearEncoding:default:return g.TEXTURE_ENCODING.LINEAR}}set textureEncoding(e){switch(e){case g.TEXTURE_ENCODING.SRGB:this.environmentMapLoader.textureEncoding=u.sRGBEncoding,this.materialLoader.textureEncoding=u.sRGBEncoding;break;case g.TEXTURE_ENCODING.LINEAR:default:this.environmentMapLoader.textureEncoding=u.LinearEncoding,this.materialLoader.textureEncoding=u.LinearEncoding}}get toneMapping(){switch(this._renderer.toneMapping){case u.LinearToneMapping:return g.TONE_MAPPING.LINEAR;case u.ReinhardToneMapping:return g.TONE_MAPPING.REINHARD;case u.CineonToneMapping:return g.TONE_MAPPING.CINEON;case u.ACESFilmicToneMapping:return g.TONE_MAPPING.ACES_FILMIC;case u.NoToneMapping:default:return g.TONE_MAPPING.NONE}}set toneMapping(e){switch(e){case g.TONE_MAPPING.LINEAR:this._renderer.toneMapping=u.LinearToneMapping;break;case g.TONE_MAPPING.REINHARD:this._renderer.toneMapping=u.ReinhardToneMapping;break;case g.TONE_MAPPING.CINEON:this._renderer.toneMapping=u.CineonToneMapping;break;case g.TONE_MAPPING.ACES_FILMIC:this._renderer.toneMapping=u.ACESFilmicToneMapping;break;case g.TONE_MAPPING.NONE:default:this._renderer.toneMapping=u.NoToneMapping}this.materialLoader.updateMaterials()}get toneMappingExposure(){return this._renderer.toneMappingExposure}set toneMappingExposure(e){this._renderer.toneMappingExposure=e}get type(){return this._type}set type(e){this._type=e}get usingSwiftShader(){return this.renderingManager.usingSwiftShader}close(){var e,t;return a(this,void 0,void 0,(function*(){return this._closed=!0,this._lightEngine.close(),this._renderer.clear(!0,!0,!0),this._renderer.dispose(),null===(e=this._canvas.canvasElement.parentElement)||void 0===e||e.removeChild(this._logoDivElement),null===(t=this._canvas.canvasElement.parentNode)||void 0===t||t.removeChild(this._htmlElementAnchorLoader.parentDiv),this._canvas.reset(),this._domEventEngine.removeAllDomEventListener(),this._domEventEngine.dispose(),!0}))}displayErrorMessage(e){for(let e=0;e<this.logoDivElement.children.length;e++)this.logoDivElement.children[e].style.visibility="hidden";const t=document.createElement("div");t.style.position="absolute",t.style.top="50%",t.style.left="50%",t.style.transform="translateX(-50%) translateY(-50%)",t.style.textAlign="center",this.logoDivElement.appendChild(t);const r=document.createElement("p");r.textContent=e,r.style.fontFamily='"CircularXXWeb-Book",sans-serif',r.style.fontSize="x-large",r.style.color=this.logoDivElement.style.backgroundColor,r.style.filter="invert(100%)",t.appendChild(r)}gatherAnimations(e=this._tree.root){let t=[];for(let r=0,i=e.data.length;r<i;r++)e.data[r]instanceof _.AnimationData&&t.push(e.data[r]);for(let r=0,i=e.children.length;r<i;r++)t=t.concat(this.gatherAnimations(e.children[r]));return t}getEnvironmentMapImageUrl(){return this._environmentMapLoader.getEnvironmentMapImageUrl(this.environmentMap)}getScreenshot(e,t){return this._renderingManager.getScreenshot(e,t)}reset(){this._environmentGeometryManager.changeSceneExtents(this._sceneTreeManager.boundingBox),this._visibility===g.VISIBILITYMODE.SESSION&&(this.show=!1),this._stateEngine.viewers[this.id].settingsLoaded.reset()}resize(e,t){this._renderingManager.resize(e,t),this._renderingManager.render()}saveSettings(){this.lightEngine.saveSettings(),this.cameraEngine.saveSettings(),this._settingsEngine.general.blurWhenBusy=this.blurSceneWhenBusy,this._settingsEngine.environmentGeometry.gridVisibility=this.gridVisibility,this._settingsEngine.environmentGeometry.groundPlaneVisibility=this.groundPlaneVisibility,this._settingsEngine.environment.mapResolution=this.environmentMapResolution,this._settingsEngine.environment.map=Array.isArray(this.environmentMap)?JSON.stringify(this.environmentMap):this.environmentMap,this._settingsEngine.environment.mapAsBackground=this.environmentMapAsBackground,this._settingsEngine.rendering.ambientOcclusion=this.ambientOcclusion,this._settingsEngine.rendering.ambientOcclusionIntensity=this.ambientOcclusionIntensity,this._settingsEngine.environmentGeometry.gridColor=this.gridColor,this._settingsEngine.environmentGeometry.groundPlaneColor=this.groundPlaneColor,this._settingsEngine.rendering.outputEncoding=this.outputEncoding,this._settingsEngine.rendering.physicallyCorrectLights=this.physicallyCorrectLights,this._settingsEngine.rendering.textureEncoding=this.textureEncoding,this._settingsEngine.rendering.toneMapping=this.toneMapping,this._settingsEngine.rendering.toneMappingExposure=this.toneMappingExposure,this._settingsEngine.rendering.beautyRenderBlendingDuration=this.beautyRenderBlendingDuration,this._settingsEngine.rendering.beautyRenderDelay=this.beautyRenderDelay,this._settingsEngine.environment.clearAlpha=this.clearAlpha,this._settingsEngine.environment.clearColor=this.clearColor,this._settingsEngine.general.pointSize=this.pointSize,this._settingsEngine.rendering.shadows=this.shadows}update(){this._sceneTreeManager.updateSceneTree(this._tree.root,this._lightEngine),this._renderingManager.updateShadowMap(),c(this,r,this.gatherAnimations(),"f"),this._renderingManager.render()}applySettings(e={camera:!0,light:!0,scene:!0,environment:!0}){e.environment?(this._stateEngine.viewers[this.id].environmentMapLoaded.then((()=>{this.environmentMapAsBackground=this._settingsEngine.environment.mapAsBackground,this.beautyRenderBlendingDuration=this._settingsEngine.rendering.beautyRenderBlendingDuration,this.beautyRenderDelay=this._settingsEngine.rendering.beautyRenderDelay,this.blurSceneWhenBusy=this._settingsEngine.general.blurWhenBusy,this.clearAlpha=this._settingsEngine.environment.clearAlpha,this.clearColor=this._converter.toColor(this._settingsEngine.environment.clearColor),e.scene&&(this.shadows=this._settingsEngine.rendering.shadows,this.ambientOcclusion=this._settingsEngine.rendering.ambientOcclusion,this.ambientOcclusionIntensity=this._settingsEngine.rendering.ambientOcclusionIntensity,this.gridColor=this._settingsEngine.environmentGeometry.gridColor,this.groundPlaneColor=this._settingsEngine.environmentGeometry.groundPlaneColor,this.outputEncoding=this._settingsEngine.rendering.outputEncoding,this.physicallyCorrectLights=this._settingsEngine.rendering.physicallyCorrectLights,this.textureEncoding=this._settingsEngine.rendering.textureEncoding,this.toneMapping=this._settingsEngine.rendering.toneMapping,this.toneMappingExposure=this._settingsEngine.rendering.toneMappingExposure,this.gridVisibility=this._settingsEngine.environmentGeometry.gridVisibility,this.groundPlaneVisibility=this._settingsEngine.environmentGeometry.groundPlaneVisibility,this.pointSize=this._settingsEngine.general.pointSize),e.light&&this.lightEngine.applySettings(),e.camera&&this.cameraEngine.applySettings(),this._stateEngine.viewers[this.id].settingsLoaded.resolve(!0),this.update()})),this._environmentMapResolution=this._settingsEngine.environment.mapResolution,this.environmentMap=this._settingsEngine.environment.map):(this.beautyRenderBlendingDuration=this._settingsEngine.rendering.beautyRenderBlendingDuration,this.beautyRenderDelay=this._settingsEngine.rendering.beautyRenderDelay,this.blurSceneWhenBusy=this._settingsEngine.general.blurWhenBusy,e.scene&&(this.shadows=this._settingsEngine.rendering.shadows,this.ambientOcclusion=this._settingsEngine.rendering.ambientOcclusion,this.ambientOcclusionIntensity=this._settingsEngine.rendering.ambientOcclusionIntensity,this.gridColor=this._settingsEngine.environmentGeometry.gridColor,this.groundPlaneColor=this._settingsEngine.environmentGeometry.groundPlaneColor,this.outputEncoding=this._settingsEngine.rendering.outputEncoding,this.physicallyCorrectLights=this._settingsEngine.rendering.physicallyCorrectLights,this.textureEncoding=this._settingsEngine.rendering.textureEncoding,this.toneMapping=this._settingsEngine.rendering.toneMapping,this.toneMappingExposure=this._settingsEngine.rendering.toneMappingExposure,this.gridVisibility=this._settingsEngine.environmentGeometry.gridVisibility,this.groundPlaneVisibility=this._settingsEngine.environmentGeometry.groundPlaneVisibility,this.pointSize=this._settingsEngine.general.pointSize),e.light&&this.lightEngine.applySettings(),e.camera&&this.cameraEngine.applySettings(),this._stateEngine.viewers[this.id].settingsLoaded.resolve(!0),this.update())}},r=new WeakMap})),s.register("ilwiq",(function(e,r){t(e.exports,"REVISION",(()=>i)),t(e.exports,"MOUSE",(()=>n)),t(e.exports,"TOUCH",(()=>s)),t(e.exports,"CullFaceNone",(()=>o)),t(e.exports,"CullFaceBack",(()=>a)),t(e.exports,"CullFaceFront",(()=>l)),t(e.exports,"CullFaceFrontBack",(()=>c)),t(e.exports,"BasicShadowMap",(()=>u)),t(e.exports,"PCFShadowMap",(()=>h)),t(e.exports,"PCFSoftShadowMap",(()=>d)),t(e.exports,"VSMShadowMap",(()=>f)),t(e.exports,"FrontSide",(()=>p)),t(e.exports,"BackSide",(()=>m)),t(e.exports,"DoubleSide",(()=>g)),t(e.exports,"FlatShading",(()=>v)),t(e.exports,"SmoothShading",(()=>_)),t(e.exports,"NoBlending",(()=>b)),t(e.exports,"NormalBlending",(()=>y)),t(e.exports,"AdditiveBlending",(()=>E)),t(e.exports,"SubtractiveBlending",(()=>w)),t(e.exports,"MultiplyBlending",(()=>x)),t(e.exports,"CustomBlending",(()=>A)),t(e.exports,"AddEquation",(()=>T)),t(e.exports,"SubtractEquation",(()=>S)),t(e.exports,"ReverseSubtractEquation",(()=>M)),t(e.exports,"MinEquation",(()=>C)),t(e.exports,"MaxEquation",(()=>R)),t(e.exports,"ZeroFactor",(()=>I)),t(e.exports,"OneFactor",(()=>O)),t(e.exports,"SrcColorFactor",(()=>P)),t(e.exports,"OneMinusSrcColorFactor",(()=>k)),t(e.exports,"SrcAlphaFactor",(()=>L)),t(e.exports,"OneMinusSrcAlphaFactor",(()=>N)),t(e.exports,"DstAlphaFactor",(()=>G)),t(e.exports,"OneMinusDstAlphaFactor",(()=>D)),t(e.exports,"DstColorFactor",(()=>U)),t(e.exports,"OneMinusDstColorFactor",(()=>V)),t(e.exports,"SrcAlphaSaturateFactor",(()=>B)),t(e.exports,"NeverDepth",(()=>F)),t(e.exports,"AlwaysDepth",(()=>j)),t(e.exports,"LessDepth",(()=>z)),t(e.exports,"LessEqualDepth",(()=>W)),t(e.exports,"EqualDepth",(()=>H)),t(e.exports,"GreaterEqualDepth",(()=>$)),t(e.exports,"GreaterDepth",(()=>Y)),t(e.exports,"NotEqualDepth",(()=>q)),t(e.exports,"MultiplyOperation",(()=>X)),t(e.exports,"MixOperation",(()=>Z)),t(e.exports,"AddOperation",(()=>J)),t(e.exports,"NoToneMapping",(()=>K)),t(e.exports,"LinearToneMapping",(()=>Q)),t(e.exports,"ReinhardToneMapping",(()=>ee)),t(e.exports,"CineonToneMapping",(()=>te)),t(e.exports,"ACESFilmicToneMapping",(()=>re)),t(e.exports,"CustomToneMapping",(()=>ie)),t(e.exports,"UVMapping",(()=>ne)),t(e.exports,"CubeReflectionMapping",(()=>se)),t(e.exports,"CubeRefractionMapping",(()=>oe)),t(e.exports,"EquirectangularReflectionMapping",(()=>ae)),t(e.exports,"EquirectangularRefractionMapping",(()=>le)),t(e.exports,"CubeUVReflectionMapping",(()=>ce)),t(e.exports,"CubeUVRefractionMapping",(()=>ue)),t(e.exports,"RepeatWrapping",(()=>he)),t(e.exports,"ClampToEdgeWrapping",(()=>de)),t(e.exports,"MirroredRepeatWrapping",(()=>fe)),t(e.exports,"NearestFilter",(()=>pe)),t(e.exports,"NearestMipmapNearestFilter",(()=>me)),t(e.exports,"NearestMipMapNearestFilter",(()=>ge)),t(e.exports,"NearestMipmapLinearFilter",(()=>ve)),t(e.exports,"NearestMipMapLinearFilter",(()=>_e)),t(e.exports,"LinearFilter",(()=>be)),t(e.exports,"LinearMipmapNearestFilter",(()=>ye)),t(e.exports,"LinearMipMapNearestFilter",(()=>Ee)),t(e.exports,"LinearMipmapLinearFilter",(()=>we)),t(e.exports,"LinearMipMapLinearFilter",(()=>xe)),t(e.exports,"UnsignedByteType",(()=>Ae)),t(e.exports,"ByteType",(()=>Te)),t(e.exports,"ShortType",(()=>Se)),t(e.exports,"UnsignedShortType",(()=>Me)),t(e.exports,"IntType",(()=>Ce)),t(e.exports,"UnsignedIntType",(()=>Re)),t(e.exports,"FloatType",(()=>Ie)),t(e.exports,"HalfFloatType",(()=>Oe)),t(e.exports,"UnsignedShort4444Type",(()=>Pe)),t(e.exports,"UnsignedShort5551Type",(()=>ke)),t(e.exports,"UnsignedInt248Type",(()=>Le)),t(e.exports,"AlphaFormat",(()=>Ne)),t(e.exports,"RGBFormat",(()=>Ge)),t(e.exports,"RGBAFormat",(()=>De)),t(e.exports,"LuminanceFormat",(()=>Ue)),t(e.exports,"LuminanceAlphaFormat",(()=>Ve)),t(e.exports,"DepthFormat",(()=>Be)),t(e.exports,"DepthStencilFormat",(()=>Fe)),t(e.exports,"RedFormat",(()=>je)),t(e.exports,"RedIntegerFormat",(()=>ze)),t(e.exports,"RGFormat",(()=>We)),t(e.exports,"RGIntegerFormat",(()=>He)),t(e.exports,"RGBAIntegerFormat",(()=>$e)),t(e.exports,"RGB_S3TC_DXT1_Format",(()=>Ye)),t(e.exports,"RGBA_S3TC_DXT1_Format",(()=>qe)),t(e.exports,"RGBA_S3TC_DXT3_Format",(()=>Xe)),t(e.exports,"RGBA_S3TC_DXT5_Format",(()=>Ze)),t(e.exports,"RGB_PVRTC_4BPPV1_Format",(()=>Je)),t(e.exports,"RGB_PVRTC_2BPPV1_Format",(()=>Ke)),t(e.exports,"RGBA_PVRTC_4BPPV1_Format",(()=>Qe)),t(e.exports,"RGBA_PVRTC_2BPPV1_Format",(()=>et)),t(e.exports,"RGB_ETC1_Format",(()=>tt)),t(e.exports,"RGB_ETC2_Format",(()=>rt)),t(e.exports,"RGBA_ETC2_EAC_Format",(()=>it)),t(e.exports,"RGBA_ASTC_4x4_Format",(()=>nt)),t(e.exports,"RGBA_ASTC_5x4_Format",(()=>st)),t(e.exports,"RGBA_ASTC_5x5_Format",(()=>ot)),t(e.exports,"RGBA_ASTC_6x5_Format",(()=>at)),t(e.exports,"RGBA_ASTC_6x6_Format",(()=>lt)),t(e.exports,"RGBA_ASTC_8x5_Format",(()=>ct)),t(e.exports,"RGBA_ASTC_8x6_Format",(()=>ut)),t(e.exports,"RGBA_ASTC_8x8_Format",(()=>ht)),t(e.exports,"RGBA_ASTC_10x5_Format",(()=>dt)),t(e.exports,"RGBA_ASTC_10x6_Format",(()=>ft)),t(e.exports,"RGBA_ASTC_10x8_Format",(()=>pt)),t(e.exports,"RGBA_ASTC_10x10_Format",(()=>mt)),t(e.exports,"RGBA_ASTC_12x10_Format",(()=>gt)),t(e.exports,"RGBA_ASTC_12x12_Format",(()=>vt)),t(e.exports,"RGBA_BPTC_Format",(()=>_t)),t(e.exports,"LoopOnce",(()=>bt)),t(e.exports,"LoopRepeat",(()=>yt)),t(e.exports,"LoopPingPong",(()=>Et)),t(e.exports,"InterpolateDiscrete",(()=>wt)),t(e.exports,"InterpolateLinear",(()=>xt)),t(e.exports,"InterpolateSmooth",(()=>At)),t(e.exports,"ZeroCurvatureEnding",(()=>Tt)),t(e.exports,"ZeroSlopeEnding",(()=>St)),t(e.exports,"WrapAroundEnding",(()=>Mt)),t(e.exports,"NormalAnimationBlendMode",(()=>Ct)),t(e.exports,"AdditiveAnimationBlendMode",(()=>Rt)),t(e.exports,"TrianglesDrawMode",(()=>It)),t(e.exports,"TriangleStripDrawMode",(()=>Ot)),t(e.exports,"TriangleFanDrawMode",(()=>Pt)),t(e.exports,"LinearEncoding",(()=>kt)),t(e.exports,"sRGBEncoding",(()=>Lt)),t(e.exports,"BasicDepthPacking",(()=>Nt)),t(e.exports,"RGBADepthPacking",(()=>Gt)),t(e.exports,"TangentSpaceNormalMap",(()=>Dt)),t(e.exports,"ObjectSpaceNormalMap",(()=>Ut)),t(e.exports,"ZeroStencilOp",(()=>Vt)),t(e.exports,"KeepStencilOp",(()=>Bt)),t(e.exports,"ReplaceStencilOp",(()=>Ft)),t(e.exports,"IncrementStencilOp",(()=>jt)),t(e.exports,"DecrementStencilOp",(()=>zt)),t(e.exports,"IncrementWrapStencilOp",(()=>Wt)),t(e.exports,"DecrementWrapStencilOp",(()=>Ht)),t(e.exports,"InvertStencilOp",(()=>$t)),t(e.exports,"NeverStencilFunc",(()=>Yt)),t(e.exports,"LessStencilFunc",(()=>qt)),t(e.exports,"EqualStencilFunc",(()=>Xt)),t(e.exports,"LessEqualStencilFunc",(()=>Zt)),t(e.exports,"GreaterStencilFunc",(()=>Jt)),t(e.exports,"NotEqualStencilFunc",(()=>Kt)),t(e.exports,"GreaterEqualStencilFunc",(()=>Qt)),t(e.exports,"AlwaysStencilFunc",(()=>er)),t(e.exports,"StaticDrawUsage",(()=>tr)),t(e.exports,"DynamicDrawUsage",(()=>rr)),t(e.exports,"StreamDrawUsage",(()=>ir)),t(e.exports,"StaticReadUsage",(()=>nr)),t(e.exports,"DynamicReadUsage",(()=>sr)),t(e.exports,"StreamReadUsage",(()=>or)),t(e.exports,"StaticCopyUsage",(()=>ar)),t(e.exports,"DynamicCopyUsage",(()=>lr)),t(e.exports,"StreamCopyUsage",(()=>cr)),t(e.exports,"GLSL1",(()=>ur)),t(e.exports,"GLSL3",(()=>hr)),t(e.exports,"_SRGBAFormat",(()=>dr)),t(e.exports,"EventDispatcher",(()=>fr)),t(e.exports,"Math",(()=>Tr)),t(e.exports,"Vector2",(()=>Sr)),t(e.exports,"Matrix3",(()=>Mr)),t(e.exports,"Color",(()=>Ur)),t(e.exports,"ImageUtils",(()=>Br)),t(e.exports,"Texture",(()=>Wr)),t(e.exports,"Vector4",(()=>Hr)),t(e.exports,"WebGLRenderTarget",(()=>$r)),t(e.exports,"DataArrayTexture",(()=>Yr)),t(e.exports,"WebGLArrayRenderTarget",(()=>qr)),t(e.exports,"Data3DTexture",(()=>Xr)),t(e.exports,"WebGL3DRenderTarget",(()=>Zr)),t(e.exports,"WebGLMultipleRenderTargets",(()=>Jr)),t(e.exports,"Quaternion",(()=>Kr)),t(e.exports,"Vector3",(()=>Qr)),t(e.exports,"Box3",(()=>ri)),t(e.exports,"Sphere",(()=>Ei)),t(e.exports,"Ray",(()=>Ri)),t(e.exports,"Matrix4",(()=>Ii)),t(e.exports,"Euler",(()=>Bi)),t(e.exports,"Layers",(()=>Fi)),t(e.exports,"Object3D",(()=>tn)),t(e.exports,"Triangle",(()=>fn)),t(e.exports,"Material",(()=>mn)),t(e.exports,"MeshBasicMaterial",(()=>gn)),t(e.exports,"BufferAttribute",(()=>bn)),t(e.exports,"Int8BufferAttribute",(()=>yn)),t(e.exports,"Uint8BufferAttribute",(()=>En)),t(e.exports,"Uint8ClampedBufferAttribute",(()=>wn)),t(e.exports,"Int16BufferAttribute",(()=>xn)),t(e.exports,"Uint16BufferAttribute",(()=>An)),t(e.exports,"Int32BufferAttribute",(()=>Tn)),t(e.exports,"Uint32BufferAttribute",(()=>Sn)),t(e.exports,"Float16BufferAttribute",(()=>Mn)),t(e.exports,"Float32BufferAttribute",(()=>Cn)),t(e.exports,"Float64BufferAttribute",(()=>Rn)),t(e.exports,"BufferGeometry",(()=>Dn)),t(e.exports,"Mesh",(()=>ts)),t(e.exports,"BoxBufferGeometry",(()=>is)),t(e.exports,"UniformsUtils",(()=>os)),t(e.exports,"ShaderMaterial",(()=>as)),t(e.exports,"Camera",(()=>ls)),t(e.exports,"PerspectiveCamera",(()=>cs)),t(e.exports,"CubeCamera",(()=>hs)),t(e.exports,"CubeTexture",(()=>ds)),t(e.exports,"WebGLCubeRenderTarget",(()=>fs)),t(e.exports,"Plane",(()=>vs)),t(e.exports,"Frustum",(()=>ys)),t(e.exports,"PlaneBufferGeometry",(()=>xs)),t(e.exports,"ShaderChunk",(()=>As)),t(e.exports,"UniformsLib",(()=>Ts)),t(e.exports,"ShaderLib",(()=>Ss)),t(e.exports,"OrthographicCamera",(()=>ks)),t(e.exports,"PMREMGenerator",(()=>js)),t(e.exports,"MeshDepthMaterial",(()=>ja)),t(e.exports,"MeshDistanceMaterial",(()=>za)),t(e.exports,"WebGLUtils",(()=>Ya)),t(e.exports,"ArrayCamera",(()=>qa)),t(e.exports,"Group",(()=>Xa)),t(e.exports,"DepthTexture",(()=>Ka)),t(e.exports,"WebGLRenderer",(()=>tl)),t(e.exports,"WebGL1Renderer",(()=>rl)),t(e.exports,"FogExp2",(()=>il)),t(e.exports,"Fog",(()=>nl)),t(e.exports,"Scene",(()=>sl)),t(e.exports,"InterleavedBuffer",(()=>ol)),t(e.exports,"InterleavedBufferAttribute",(()=>ll)),t(e.exports,"SpriteMaterial",(()=>cl)),t(e.exports,"Sprite",(()=>xl)),t(e.exports,"LOD",(()=>Ml)),t(e.exports,"SkinnedMesh",(()=>kl)),t(e.exports,"Bone",(()=>Ll)),t(e.exports,"DataTexture",(()=>Nl)),t(e.exports,"Skeleton",(()=>Ul)),t(e.exports,"InstancedBufferAttribute",(()=>Vl)),t(e.exports,"InstancedMesh",(()=>Wl)),t(e.exports,"LineBasicMaterial",(()=>Hl)),t(e.exports,"Line",(()=>Jl)),t(e.exports,"LineSegments",(()=>ec)),t(e.exports,"LineLoop",(()=>tc)),t(e.exports,"PointsMaterial",(()=>rc)),t(e.exports,"Points",(()=>ac)),t(e.exports,"VideoTexture",(()=>cc)),t(e.exports,"FramebufferTexture",(()=>uc)),t(e.exports,"CompressedTexture",(()=>hc)),t(e.exports,"CanvasTexture",(()=>dc)),t(e.exports,"CircleBufferGeometry",(()=>fc)),t(e.exports,"CylinderBufferGeometry",(()=>pc)),t(e.exports,"ConeBufferGeometry",(()=>mc)),t(e.exports,"PolyhedronBufferGeometry",(()=>gc)),t(e.exports,"DodecahedronBufferGeometry",(()=>vc)),t(e.exports,"EdgesGeometry",(()=>wc)),t(e.exports,"Curve",(()=>xc)),t(e.exports,"EllipseCurve",(()=>Ac)),t(e.exports,"ArcCurve",(()=>Tc)),t(e.exports,"CatmullRomCurve3",(()=>Oc)),t(e.exports,"CubicBezierCurve",(()=>Nc)),t(e.exports,"CubicBezierCurve3",(()=>Gc)),t(e.exports,"LineCurve",(()=>Dc)),t(e.exports,"LineCurve3",(()=>Uc)),t(e.exports,"QuadraticBezierCurve",(()=>Vc)),t(e.exports,"QuadraticBezierCurve3",(()=>Bc)),t(e.exports,"SplineCurve",(()=>Fc)),t(e.exports,"CurvePath",(()=>zc)),t(e.exports,"Path",(()=>Wc)),t(e.exports,"Shape",(()=>Hc)),t(e.exports,"ShapeUtils",(()=>vu)),t(e.exports,"ExtrudeBufferGeometry",(()=>yu)),t(e.exports,"IcosahedronBufferGeometry",(()=>wu)),t(e.exports,"LatheBufferGeometry",(()=>xu)),t(e.exports,"OctahedronBufferGeometry",(()=>Au)),t(e.exports,"RingBufferGeometry",(()=>Tu)),t(e.exports,"ShapeBufferGeometry",(()=>Su)),t(e.exports,"SphereBufferGeometry",(()=>Mu)),t(e.exports,"TetrahedronBufferGeometry",(()=>Cu)),t(e.exports,"TorusBufferGeometry",(()=>Ru)),t(e.exports,"TorusKnotBufferGeometry",(()=>Iu)),t(e.exports,"TubeBufferGeometry",(()=>Ou)),t(e.exports,"WireframeGeometry",(()=>Pu)),t(e.exports,"ShadowMaterial",(()=>Nu)),t(e.exports,"RawShaderMaterial",(()=>Gu)),t(e.exports,"MeshStandardMaterial",(()=>Du)),t(e.exports,"MeshPhysicalMaterial",(()=>Uu)),t(e.exports,"MeshPhongMaterial",(()=>Vu)),t(e.exports,"MeshToonMaterial",(()=>Bu)),t(e.exports,"MeshNormalMaterial",(()=>Fu)),t(e.exports,"MeshLambertMaterial",(()=>ju)),t(e.exports,"MeshMatcapMaterial",(()=>zu)),t(e.exports,"LineDashedMaterial",(()=>Wu)),t(e.exports,"AnimationUtils",(()=>$u)),t(e.exports,"Interpolant",(()=>Yu)),t(e.exports,"CubicInterpolant",(()=>qu)),t(e.exports,"LinearInterpolant",(()=>Xu)),t(e.exports,"DiscreteInterpolant",(()=>Zu)),t(e.exports,"KeyframeTrack",(()=>Ju)),t(e.exports,"BooleanKeyframeTrack",(()=>Ku)),t(e.exports,"ColorKeyframeTrack",(()=>Qu)),t(e.exports,"NumberKeyframeTrack",(()=>eh)),t(e.exports,"QuaternionLinearInterpolant",(()=>th)),t(e.exports,"QuaternionKeyframeTrack",(()=>rh)),t(e.exports,"StringKeyframeTrack",(()=>ih)),t(e.exports,"VectorKeyframeTrack",(()=>nh)),t(e.exports,"AnimationClip",(()=>sh)),t(e.exports,"Cache",(()=>ah)),t(e.exports,"LoadingManager",(()=>lh)),t(e.exports,"DefaultLoadingManager",(()=>ch)),t(e.exports,"Loader",(()=>uh)),t(e.exports,"FileLoader",(()=>dh)),t(e.exports,"AnimationLoader",(()=>fh)),t(e.exports,"CompressedTextureLoader",(()=>ph)),t(e.exports,"ImageLoader",(()=>mh)),t(e.exports,"CubeTextureLoader",(()=>gh)),t(e.exports,"DataTextureLoader",(()=>vh)),t(e.exports,"TextureLoader",(()=>_h)),t(e.exports,"Light",(()=>bh)),t(e.exports,"HemisphereLight",(()=>yh)),t(e.exports,"SpotLight",(()=>Sh)),t(e.exports,"PointLight",(()=>Oh)),t(e.exports,"DirectionalLight",(()=>kh)),t(e.exports,"AmbientLight",(()=>Lh)),t(e.exports,"RectAreaLight",(()=>Nh)),t(e.exports,"SphericalHarmonics3",(()=>Gh)),t(e.exports,"LightProbe",(()=>Dh)),t(e.exports,"MaterialLoader",(()=>Uh)),t(e.exports,"LoaderUtils",(()=>Vh)),t(e.exports,"InstancedBufferGeometry",(()=>Bh)),t(e.exports,"BufferGeometryLoader",(()=>Fh)),t(e.exports,"ObjectLoader",(()=>jh)),t(e.exports,"ImageBitmapLoader",(()=>$h)),t(e.exports,"AudioContext",(()=>qh)),t(e.exports,"AudioLoader",(()=>Xh)),t(e.exports,"HemisphereLightProbe",(()=>Zh)),t(e.exports,"AmbientLightProbe",(()=>Jh)),t(e.exports,"StereoCamera",(()=>td)),t(e.exports,"Clock",(()=>rd)),t(e.exports,"AudioListener",(()=>ld)),t(e.exports,"Audio",(()=>cd)),t(e.exports,"PositionalAudio",(()=>pd)),t(e.exports,"AudioAnalyser",(()=>md)),t(e.exports,"PropertyMixer",(()=>gd)),t(e.exports,"PropertyBinding",(()=>Md)),t(e.exports,"AnimationObjectGroup",(()=>Cd)),t(e.exports,"AnimationMixer",(()=>Id)),t(e.exports,"Uniform",(()=>Od)),t(e.exports,"InstancedInterleavedBuffer",(()=>Pd)),t(e.exports,"GLBufferAttribute",(()=>kd)),t(e.exports,"Raycaster",(()=>Ld)),t(e.exports,"Spherical",(()=>Dd)),t(e.exports,"Cylindrical",(()=>Ud)),t(e.exports,"Box2",(()=>Bd)),t(e.exports,"Line3",(()=>zd)),t(e.exports,"SpotLightHelper",(()=>Hd)),t(e.exports,"SkeletonHelper",(()=>Xd)),t(e.exports,"PointLightHelper",(()=>Jd)),t(e.exports,"HemisphereLightHelper",(()=>tf)),t(e.exports,"GridHelper",(()=>rf)),t(e.exports,"PolarGridHelper",(()=>nf)),t(e.exports,"DirectionalLightHelper",(()=>lf)),t(e.exports,"CameraHelper",(()=>hf)),t(e.exports,"BoxHelper",(()=>pf)),t(e.exports,"Box3Helper",(()=>mf)),t(e.exports,"PlaneHelper",(()=>gf)),t(e.exports,"ArrowHelper",(()=>yf)),t(e.exports,"AxesHelper",(()=>Ef)),t(e.exports,"ShapePath",(()=>wf)),t(e.exports,"DataUtils",(()=>Tf)),t(e.exports,"LineStrip",(()=>Sf)),t(e.exports,"LinePieces",(()=>Mf)),t(e.exports,"NoColors",(()=>Cf)),t(e.exports,"FaceColors",(()=>Rf)),t(e.exports,"VertexColors",(()=>If)),t(e.exports,"MeshFaceMaterial",(()=>Of)),t(e.exports,"MultiMaterial",(()=>Pf)),t(e.exports,"PointCloud",(()=>kf)),t(e.exports,"Particle",(()=>Lf)),t(e.exports,"ParticleSystem",(()=>Nf)),t(e.exports,"PointCloudMaterial",(()=>Gf)),t(e.exports,"ParticleBasicMaterial",(()=>Df)),t(e.exports,"ParticleSystemMaterial",(()=>Uf)),t(e.exports,"Vertex",(()=>Vf)),t(e.exports,"DynamicBufferAttribute",(()=>Bf)),t(e.exports,"Int8Attribute",(()=>Ff)),t(e.exports,"Uint8Attribute",(()=>jf)),t(e.exports,"Uint8ClampedAttribute",(()=>zf)),t(e.exports,"Int16Attribute",(()=>Wf)),t(e.exports,"Uint16Attribute",(()=>Hf)),t(e.exports,"Int32Attribute",(()=>$f)),t(e.exports,"Uint32Attribute",(()=>Yf)),t(e.exports,"Float32Attribute",(()=>qf)),t(e.exports,"Float64Attribute",(()=>Xf)),t(e.exports,"AxisHelper",(()=>Zf)),t(e.exports,"BoundingBoxHelper",(()=>Jf)),t(e.exports,"EdgesHelper",(()=>Kf)),t(e.exports,"WireframeHelper",(()=>Qf)),t(e.exports,"XHRLoader",(()=>ep)),t(e.exports,"BinaryTextureLoader",(()=>tp)),t(e.exports,"WebGLRenderTargetCube",(()=>rp)),t(e.exports,"CanvasRenderer",(()=>ip)),t(e.exports,"JSONLoader",(()=>np)),t(e.exports,"SceneUtils",(()=>sp)),t(e.exports,"LensFlare",(()=>op)),t(e.exports,"ParametricGeometry",(()=>ap)),t(e.exports,"TextGeometry",(()=>lp)),t(e.exports,"FontLoader",(()=>cp)),t(e.exports,"Font",(()=>up)),t(e.exports,"ImmediateRenderObject",(()=>hp)),t(e.exports,"WebGLMultisampleRenderTarget",(()=>dp)),t(e.exports,"DataTexture2DArray",(()=>fp)),t(e.exports,"DataTexture3D",(()=>pp)),t(e.exports,"BoxGeometry",(()=>is)),t(e.exports,"CircleGeometry",(()=>fc)),t(e.exports,"ConeGeometry",(()=>mc)),t(e.exports,"CylinderGeometry",(()=>pc)),t(e.exports,"DodecahedronGeometry",(()=>vc)),t(e.exports,"ExtrudeGeometry",(()=>yu)),t(e.exports,"IcosahedronGeometry",(()=>wu)),t(e.exports,"LatheGeometry",(()=>xu)),t(e.exports,"MathUtils",(()=>Tr)),t(e.exports,"OctahedronGeometry",(()=>Au)),t(e.exports,"PlaneGeometry",(()=>xs)),t(e.exports,"PolyhedronGeometry",(()=>gc)),t(e.exports,"RingGeometry",(()=>Tu)),t(e.exports,"ShapeGeometry",(()=>Su)),t(e.exports,"SphereGeometry",(()=>Mu)),t(e.exports,"TetrahedronGeometry",(()=>Cu)),t(e.exports,"TorusGeometry",(()=>Ru)),t(e.exports,"TorusKnotGeometry",(()=>Iu)),t(e.exports,"TubeGeometry",(()=>Ou));
/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
const i="138",n={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},s={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},o=0,a=1,l=2,c=3,u=0,h=1,d=2,f=3,p=0,m=1,g=2,v=1,_=2,b=0,y=1,E=2,w=3,x=4,A=5,T=100,S=101,M=102,C=103,R=104,I=200,O=201,P=202,k=203,L=204,N=205,G=206,D=207,U=208,V=209,B=210,F=0,j=1,z=2,W=3,H=4,$=5,Y=6,q=7,X=0,Z=1,J=2,K=0,Q=1,ee=2,te=3,re=4,ie=5,ne=300,se=301,oe=302,ae=303,le=304,ce=306,ue=307,he=1e3,de=1001,fe=1002,pe=1003,me=1004,ge=1004,ve=1005,_e=1005,be=1006,ye=1007,Ee=1007,we=1008,xe=1008,Ae=1009,Te=1010,Se=1011,Me=1012,Ce=1013,Re=1014,Ie=1015,Oe=1016,Pe=1017,ke=1018,Le=1020,Ne=1021,Ge=1022,De=1023,Ue=1024,Ve=1025,Be=1026,Fe=1027,je=1028,ze=1029,We=1030,He=1031,$e=1033,Ye=33776,qe=33777,Xe=33778,Ze=33779,Je=35840,Ke=35841,Qe=35842,et=35843,tt=36196,rt=37492,it=37496,nt=37808,st=37809,ot=37810,at=37811,lt=37812,ct=37813,ut=37814,ht=37815,dt=37816,ft=37817,pt=37818,mt=37819,gt=37820,vt=37821,_t=36492,bt=2200,yt=2201,Et=2202,wt=2300,xt=2301,At=2302,Tt=2400,St=2401,Mt=2402,Ct=2500,Rt=2501,It=0,Ot=1,Pt=2,kt=3e3,Lt=3001,Nt=3200,Gt=3201,Dt=0,Ut=1,Vt=0,Bt=7680,Ft=7681,jt=7682,zt=7683,Wt=34055,Ht=34056,$t=5386,Yt=512,qt=513,Xt=514,Zt=515,Jt=516,Kt=517,Qt=518,er=519,tr=35044,rr=35048,ir=35040,nr=35045,sr=35049,or=35041,ar=35046,lr=35050,cr=35042,ur="100",hr="300 es",dr=1035;class fr{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(t)&&r[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const t=this._listeners[e.type];if(void 0!==t){e.target=this;const r=t.slice(0);for(let t=0,i=r.length;t<i;t++)r[t].call(this,e);e.target=null}}}const pr=[];for(let e=0;e<256;e++)pr[e]=(e<16?"0":"")+e.toString(16);let mr=1234567;const gr=Math.PI/180,vr=180/Math.PI;function _r(){const e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(pr[255&e]+pr[e>>8&255]+pr[e>>16&255]+pr[e>>24&255]+"-"+pr[255&t]+pr[t>>8&255]+"-"+pr[t>>16&15|64]+pr[t>>24&255]+"-"+pr[63&r|128]+pr[r>>8&255]+"-"+pr[r>>16&255]+pr[r>>24&255]+pr[255&i]+pr[i>>8&255]+pr[i>>16&255]+pr[i>>24&255]).toUpperCase()}function br(e,t,r){return Math.max(t,Math.min(r,e))}function yr(e,t){return(e%t+t)%t}function Er(e,t,r){return(1-r)*e+r*t}function wr(e){return 0==(e&e-1)&&0!==e}function xr(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Ar(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}var Tr=Object.freeze({__proto__:null,DEG2RAD:gr,RAD2DEG:vr,generateUUID:_r,clamp:br,euclideanModulo:yr,mapLinear:function(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)},inverseLerp:function(e,t,r){return e!==t?(r-e)/(t-e):0},lerp:Er,damp:function(e,t,r,i){return Er(e,t,1-Math.exp(-r*i))},pingpong:function(e,t=1){return t-Math.abs(yr(e,2*t)-t)},smoothstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*(3-2*e)},smootherstep:function(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(mr=e%2147483647),mr=16807*mr%2147483647,(mr-1)/2147483646},degToRad:function(e){return e*gr},radToDeg:function(e){return e*vr},isPowerOfTwo:wr,ceilPowerOfTwo:xr,floorPowerOfTwo:Ar,setQuaternionFromProperEuler:function(e,t,r,i,n){const s=Math.cos,o=Math.sin,a=s(r/2),l=o(r/2),c=s((t+i)/2),u=o((t+i)/2),h=s((t-i)/2),d=o((t-i)/2),f=s((i-t)/2),p=o((i-t)/2);switch(n){case"XYX":e.set(a*u,l*h,l*d,a*c);break;case"YZY":e.set(l*d,a*u,l*h,a*c);break;case"ZXZ":e.set(l*h,l*d,a*u,a*c);break;case"XZX":e.set(a*u,l*p,l*f,a*c);break;case"YXY":e.set(l*f,a*u,l*p,a*c);break;case"ZYZ":e.set(l*p,l*f,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}});class Sr{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*r-s*i+e.x,this.y=n*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Sr.prototype.isVector2=!0;class Mr{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,i,n,s,o,a,l){const c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=n,c[5]=a,c[6]=r,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,n=this.elements,s=r[0],o=r[3],a=r[6],l=r[1],c=r[4],u=r[7],h=r[2],d=r[5],f=r[8],p=i[0],m=i[3],g=i[6],v=i[1],_=i[4],b=i[7],y=i[2],E=i[5],w=i[8];return n[0]=s*p+o*v+a*y,n[3]=s*m+o*_+a*E,n[6]=s*g+o*b+a*w,n[1]=l*p+c*v+u*y,n[4]=l*m+c*_+u*E,n[7]=l*g+c*b+u*w,n[2]=h*p+d*v+f*y,n[5]=h*m+d*_+f*E,n[8]=h*g+d*b+f*w,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8];return t*s*c-t*o*l-r*n*c+r*o*a+i*n*l-i*s*a}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=c*s-o*l,h=o*a-c*n,d=l*n-s*a,f=t*u+r*h+i*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);const p=1/f;return e[0]=u*p,e[1]=(i*l-c*r)*p,e[2]=(o*r-i*s)*p,e[3]=h*p,e[4]=(c*t-i*a)*p,e[5]=(i*n-o*t)*p,e[6]=d*p,e[7]=(r*a-l*t)*p,e[8]=(s*t-r*n)*p,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,o){const a=Math.cos(n),l=Math.sin(n);return this.set(r*a,r*l,-r*(a*s+l*o)+s+e,-i*l,i*a,-i*(-l*s+a*o)+o+t,0,0,1),this}scale(e,t){const r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){const t=Math.cos(e),r=Math.sin(e),i=this.elements,n=i[0],s=i[3],o=i[6],a=i[1],l=i[4],c=i[7];return i[0]=t*n+r*a,i[3]=t*s+r*l,i[6]=t*o+r*c,i[1]=-r*n+t*a,i[4]=-r*s+t*l,i[7]=-r*o+t*c,this}translate(e,t){const r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<9;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function Cr(e){for(let t=e.length-1;t>=0;--t)if(e[t]>65535)return!0;return!1}Mr.prototype.isMatrix3=!0;const Rr={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Ir(e,t){return new Rr[e](t)}function Or(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}const Pr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},kr={h:0,s:0,l:0},Lr={h:0,s:0,l:0};function Nr(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+6*(t-e)*(2/3-r):e}function Gr(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Dr(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}class Ur{constructor(e,t,r){return void 0===t&&void 0===r?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,r){return this.r=e,this.g=t,this.b=r,this}setHSL(e,t,r){if(e=yr(e,1),t=br(t,0,1),r=br(r,0,1),0===t)this.r=this.g=this.b=r;else{const i=r<=.5?r*(1+t):r+t-r*t,n=2*r-i;this.r=Nr(n,i,e+1/3),this.g=Nr(n,i,e),this.b=Nr(n,i,e-1/3)}return this}setStyle(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let e;const i=r[1],n=r[2];switch(i){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return this.r=Math.min(255,parseInt(e[1],10))/255,this.g=Math.min(255,parseInt(e[2],10))/255,this.b=Math.min(255,parseInt(e[3],10))/255,t(e[4]),this;if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n))return this.r=Math.min(100,parseInt(e[1],10))/100,this.g=Math.min(100,parseInt(e[2],10))/100,this.b=Math.min(100,parseInt(e[3],10))/100,t(e[4]),this;break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(n)){const r=parseFloat(e[1])/360,i=parseInt(e[2],10)/100,n=parseInt(e[3],10)/100;return t(e[4]),this.setHSL(r,i,n)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const e=r[1],t=e.length;if(3===t)return this.r=parseInt(e.charAt(0)+e.charAt(0),16)/255,this.g=parseInt(e.charAt(1)+e.charAt(1),16)/255,this.b=parseInt(e.charAt(2)+e.charAt(2),16)/255,this;if(6===t)return this.r=parseInt(e.charAt(0)+e.charAt(1),16)/255,this.g=parseInt(e.charAt(2)+e.charAt(3),16)/255,this.b=parseInt(e.charAt(4)+e.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Pr[e.toLowerCase()];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Gr(e.r),this.g=Gr(e.g),this.b=Gr(e.b),this}copyLinearToSRGB(e){return this.r=Dr(e.r),this.g=Dr(e.g),this.b=Dr(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const t=this.r,r=this.g,i=this.b,n=Math.max(t,r,i),s=Math.min(t,r,i);let o,a;const l=(s+n)/2;if(s===n)o=0,a=0;else{const e=n-s;switch(a=l<=.5?e/(n+s):e/(2-n-s),n){case t:o=(r-i)/e+(r<i?6:0);break;case r:o=(i-t)/e+2;break;case i:o=(t-r)/e+4}o/=6}return e.h=o,e.s=a,e.l=l,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,r){return this.getHSL(kr),kr.h+=e,kr.s+=t,kr.l+=r,this.setHSL(kr.h,kr.s,kr.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(kr),e.getHSL(Lr);const r=Er(kr.h,Lr.h,t),i=Er(kr.s,Lr.s,t),n=Er(kr.l,Lr.l,t);return this.setHSL(r,i,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}let Vr;Ur.NAMES=Pr,Ur.prototype.isColor=!0,Ur.prototype.r=1,Ur.prototype.g=1,Ur.prototype.b=1;class Br{static getDataURL(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Vr&&(Vr=Or("canvas")),Vr.width=e.width,Vr.height=e.height;const r=Vr.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Vr}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=Or("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let e=0;e<n.length;e++)n[e]=255*Gr(n[e]/255);return r.putImageData(i,0,0),t}if(e.data){const t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*Gr(t[e]/255)):t[e]=Gr(t[e]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Fr{constructor(e=null){this.uuid=_r(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(null!==i){let e;if(Array.isArray(i)){e=[];for(let t=0,r=i.length;t<r;t++)i[t].isDataTexture?e.push(jr(i[t].image)):e.push(jr(i[t]))}else e=jr(i);r.url=e}return t||(e.images[this.uuid]=r),r}}function jr(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?Br.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Fr.prototype.isSource=!0;let zr=0;class Wr extends fr{constructor(e=Wr.DEFAULT_IMAGE,t=Wr.DEFAULT_MAPPING,r=de,i=de,n=be,s=we,o=De,a=Ae,l=1,c=kt){super(),Object.defineProperty(this,"id",{value:zr++}),this.uuid=_r(),this.name="",this.source=new Fr(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Sr(0,0),this.repeat=new Sr(1,1),this.center=new Sr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Mr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ne)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case he:e.x=e.x-Math.floor(e.x);break;case de:e.x=e.x<0?0:1;break;case fe:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case he:e.y=e.y-Math.floor(e.y);break;case de:e.y=e.y<0?0:1;break;case fe:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}}Wr.DEFAULT_IMAGE=null,Wr.DEFAULT_MAPPING=ne,Wr.prototype.isTexture=!0;class Hr{constructor(e=0,t=0,r=0,i=1){this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n;const s=.01,o=.1,a=e.elements,l=a[0],c=a[4],u=a[8],h=a[1],d=a[5],f=a[9],p=a[2],m=a[6],g=a[10];if(Math.abs(c-h)<s&&Math.abs(u-p)<s&&Math.abs(f-m)<s){if(Math.abs(c+h)<o&&Math.abs(u+p)<o&&Math.abs(f+m)<o&&Math.abs(l+d+g-3)<o)return this.set(1,0,0,0),this;t=Math.PI;const e=(l+1)/2,a=(d+1)/2,v=(g+1)/2,_=(c+h)/4,b=(u+p)/4,y=(f+m)/4;return e>a&&e>v?e<s?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(e),i=_/r,n=b/r):a>v?a<s?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(a),r=_/i,n=y/i):v<s?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(v),r=b/n,i=y/n),this.set(r,i,n,t),this}let v=Math.sqrt((m-f)*(m-f)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(v)<.001&&(v=1),this.x=(m-f)/v,this.y=(u-p)/v,this.z=(h-c)/v,this.w=Math.acos((l+d+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Hr.prototype.isVector4=!0;class $r extends fr{constructor(e,t,r={}){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Hr(0,0,e,t),this.scissorTest=!1,this.viewport=new Hr(0,0,e,t);const i={width:e,height:t,depth:1};this.texture=new Wr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,this.texture.internalFormat=void 0!==r.internalFormat?r.internalFormat:null,this.texture.minFilter=void 0!==r.minFilter?r.minFilter:be,this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0!==r.stencilBuffer&&r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null,this.samples=void 0!==r.samples?r.samples:0}setSize(e,t,r=1){this.width===e&&this.height===t&&this.depth===r||(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image=Object.assign({},e.texture.image),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}$r.prototype.isWebGLRenderTarget=!0;class Yr extends Wr{constructor(e=null,t=1,r=1,i=1){super(null),this.image={data:e,width:t,height:r,depth:i},this.magFilter=pe,this.minFilter=pe,this.wrapR=de,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Yr.prototype.isDataArrayTexture=!0;class qr extends $r{constructor(e,t,r){super(e,t),this.depth=r,this.texture=new Yr(null,e,t,r),this.texture.isRenderTargetTexture=!0}}qr.prototype.isWebGLArrayRenderTarget=!0;class Xr extends Wr{constructor(e=null,t=1,r=1,i=1){super(null),this.image={data:e,width:t,height:r,depth:i},this.magFilter=pe,this.minFilter=pe,this.wrapR=de,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Xr.prototype.isData3DTexture=!0;class Zr extends $r{constructor(e,t,r){super(e,t),this.depth=r,this.texture=new Xr(null,e,t,r),this.texture.isRenderTargetTexture=!0}}Zr.prototype.isWebGL3DRenderTarget=!0;class Jr extends $r{constructor(e,t,r,i={}){super(e,t,i);const n=this.texture;this.texture=[];for(let e=0;e<r;e++)this.texture[e]=n.clone(),this.texture[e].isRenderTargetTexture=!0}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,n=this.texture.length;i<n;i++)this.texture[i].image.width=e,this.texture[i].image.height=t,this.texture[i].image.depth=r;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let t=0,r=e.texture.length;t<r;t++)this.texture[t]=e.texture[t].clone();return this}}Jr.prototype.isWebGLMultipleRenderTargets=!0;class Kr{constructor(e=0,t=0,r=0,i=1){this._x=e,this._y=t,this._z=r,this._w=i}static slerp(e,t,r,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),r.slerpQuaternions(e,t,i)}static slerpFlat(e,t,r,i,n,s,o){let a=r[i+0],l=r[i+1],c=r[i+2],u=r[i+3];const h=n[s+0],d=n[s+1],f=n[s+2],p=n[s+3];if(0===o)return e[t+0]=a,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=p);if(u!==p||a!==h||l!==d||c!==f){let e=1-o;const t=a*h+l*d+c*f+u*p,r=t>=0?1:-1,i=1-t*t;if(i>Number.EPSILON){const n=Math.sqrt(i),s=Math.atan2(n,t*r);e=Math.sin(e*s)/n,o=Math.sin(o*s)/n}const n=o*r;if(a=a*e+h*n,l=l*e+d*n,c=c*e+f*n,u=u*e+p*n,e===1-o){const e=1/Math.sqrt(a*a+l*l+c*c+u*u);a*=e,l*=e,c*=e,u*=e}}e[t]=a,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,s){const o=r[i],a=r[i+1],l=r[i+2],c=r[i+3],u=n[s],h=n[s+1],d=n[s+2],f=n[s+3];return e[t]=o*f+c*u+a*d-l*h,e[t+1]=a*f+c*h+l*u-o*d,e[t+2]=l*f+c*d+o*h-a*u,e[t+3]=c*f-o*u-a*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=e._x,i=e._y,n=e._z,s=e._order,o=Math.cos,a=Math.sin,l=o(r/2),c=o(i/2),u=o(n/2),h=a(r/2),d=a(i/2),f=a(n/2);switch(s){case"XYZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"YXZ":this._x=h*c*u+l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"ZXY":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u-h*d*f;break;case"ZYX":this._x=h*c*u-l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u+h*d*f;break;case"YZX":this._x=h*c*u+l*d*f,this._y=l*d*u+h*c*f,this._z=l*c*f-h*d*u,this._w=l*c*u-h*d*f;break;case"XZY":this._x=h*c*u-l*d*f,this._y=l*d*u-h*c*f,this._z=l*c*f+h*d*u,this._w=l*c*u+h*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],o=t[5],a=t[9],l=t[2],c=t[6],u=t[10],h=r+o+u;if(h>0){const e=.5/Math.sqrt(h+1);this._w=.25/e,this._x=(c-a)*e,this._y=(n-l)*e,this._z=(s-i)*e}else if(r>o&&r>u){const e=2*Math.sqrt(1+r-o-u);this._w=(c-a)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(n+l)/e}else if(o>u){const e=2*Math.sqrt(1+o-r-u);this._w=(n-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(a+c)/e}else{const e=2*Math.sqrt(1+u-r-o);this._w=(s-i)/e,this._x=(n+l)/e,this._y=(a+c)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(br(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(0===r)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,n=e._z,s=e._w,o=t._x,a=t._y,l=t._z,c=t._w;return this._x=r*c+s*o+i*l-n*a,this._y=i*c+s*a+n*o-r*l,this._z=n*c+s*l+r*a-i*o,this._w=s*c-r*o-i*a-n*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const r=this._x,i=this._y,n=this._z,s=this._w;let o=s*e._w+r*e._x+i*e._y+n*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;const a=1-o*o;if(a<=Number.EPSILON){const e=1-t;return this._w=e*s+t*this._w,this._x=e*r+t*this._x,this._y=e*i+t*this._y,this._z=e*n+t*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(a),c=Math.atan2(l,o),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=r*u+this._x*h,this._y=i*u+this._y*h,this._z=n*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Kr.prototype.isQuaternion=!0;class Qr{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}set(e,t,r){return void 0===r&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(ti.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(ti.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,o=e.z,a=e.w,l=a*t+s*i-o*r,c=a*r+o*t-n*i,u=a*i+n*r-s*t,h=-n*t-s*r-o*i;return this.x=l*a+h*-n+c*-o-u*-s,this.y=c*a+h*-s+u*-n-l*-o,this.z=u*a+h*-o+l*-s-c*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,n=e.z,s=t.x,o=t.y,a=t.z;return this.x=i*a-n*o,this.y=n*s-r*a,this.z=r*o-i*s,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return ei.copy(this).projectOnVector(e),this.sub(ei)}reflect(e){return this.sub(ei.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(br(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Qr.prototype.isVector3=!0;const ei=new Qr,ti=new Kr;class ri{constructor(e=new Qr(1/0,1/0,1/0),t=new Qr(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=3){const l=e[a],c=e[a+1],u=e[a+2];l<t&&(t=l),c<r&&(r=c),u<i&&(i=u),l>n&&(n=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,r,i),this.max.set(n,s,o),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,o=-1/0;for(let a=0,l=e.count;a<l;a++){const l=e.getX(a),c=e.getY(a),u=e.getZ(a);l<t&&(t=l),c<r&&(r=c),u<i&&(i=u),l>n&&(n=l),c>s&&(s=c),u>o&&(o=u)}return this.min.set(t,r,i),this.max.set(n,s,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=ni.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(void 0!==r)if(t&&null!=r.attributes&&void 0!==r.attributes.position){const t=r.attributes.position;for(let r=0,i=t.count;r<i;r++)ni.fromBufferAttribute(t,r).applyMatrix4(e.matrixWorld),this.expandByPoint(ni)}else null===r.boundingBox&&r.computeBoundingBox(),si.copy(r.boundingBox),si.applyMatrix4(e.matrixWorld),this.union(si);const i=e.children;for(let e=0,r=i.length;e<r;e++)this.expandByObject(i[e],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ni),ni.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(di),fi.subVectors(this.max,di),oi.subVectors(e.a,di),ai.subVectors(e.b,di),li.subVectors(e.c,di),ci.subVectors(ai,oi),ui.subVectors(li,ai),hi.subVectors(oi,li);let t=[0,-ci.z,ci.y,0,-ui.z,ui.y,0,-hi.z,hi.y,ci.z,0,-ci.x,ui.z,0,-ui.x,hi.z,0,-hi.x,-ci.y,ci.x,0,-ui.y,ui.x,0,-hi.y,hi.x,0];return!!gi(t,oi,ai,li,fi)&&(t=[1,0,0,0,1,0,0,0,1],!!gi(t,oi,ai,li,fi)&&(pi.crossVectors(ci,ui),t=[pi.x,pi.y,pi.z],gi(t,oi,ai,li,fi)))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return ni.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(ni).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ii[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ii[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ii[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ii[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ii[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ii[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ii[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ii[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ii)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}ri.prototype.isBox3=!0;const ii=[new Qr,new Qr,new Qr,new Qr,new Qr,new Qr,new Qr,new Qr],ni=new Qr,si=new ri,oi=new Qr,ai=new Qr,li=new Qr,ci=new Qr,ui=new Qr,hi=new Qr,di=new Qr,fi=new Qr,pi=new Qr,mi=new Qr;function gi(e,t,r,i,n){for(let s=0,o=e.length-3;s<=o;s+=3){mi.fromArray(e,s);const o=n.x*Math.abs(mi.x)+n.y*Math.abs(mi.y)+n.z*Math.abs(mi.z),a=t.dot(mi),l=r.dot(mi),c=i.dot(mi);if(Math.max(-Math.max(a,l,c),Math.min(a,l,c))>o)return!1}return!0}const vi=new ri,_i=new Qr,bi=new Qr,yi=new Qr;class Ei{constructor(e=new Qr,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;void 0!==t?r.copy(t):vi.setFromPoints(e).getCenter(r);let i=0;for(let t=0,n=e.length;t<n;t++)i=Math.max(i,r.distanceToSquared(e[t]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){yi.subVectors(e,this.center);const t=yi.lengthSq();if(t>this.radius*this.radius){const e=Math.sqrt(t),r=.5*(e-this.radius);this.center.add(yi.multiplyScalar(r/e)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?bi.set(0,0,1).multiplyScalar(e.radius):bi.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(_i.copy(e.center).add(bi)),this.expandByPoint(_i.copy(e.center).sub(bi)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const wi=new Qr,xi=new Qr,Ai=new Qr,Ti=new Qr,Si=new Qr,Mi=new Qr,Ci=new Qr;class Ri{constructor(e=new Qr,t=new Qr(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,wi)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=wi.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(wi.copy(this.direction).multiplyScalar(t).add(this.origin),wi.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){xi.copy(e).add(t).multiplyScalar(.5),Ai.copy(t).sub(e).normalize(),Ti.copy(this.origin).sub(xi);const n=.5*e.distanceTo(t),s=-this.direction.dot(Ai),o=Ti.dot(this.direction),a=-Ti.dot(Ai),l=Ti.lengthSq(),c=Math.abs(1-s*s);let u,h,d,f;if(c>0)if(u=s*a-o,h=s*o-a,f=n*c,u>=0)if(h>=-f)if(h<=f){const e=1/c;u*=e,h*=e,d=u*(u+s*h+2*o)+h*(s*u+h+2*a)+l}else h=n,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h=-n,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;else h<=-f?(u=Math.max(0,-(-s*n+o)),h=u>0?-n:Math.min(Math.max(-n,-a),n),d=-u*u+h*(h+2*a)+l):h<=f?(u=0,h=Math.min(Math.max(-n,-a),n),d=h*(h+2*a)+l):(u=Math.max(0,-(s*n+o)),h=u>0?n:Math.min(Math.max(-n,-a),n),d=-u*u+h*(h+2*a)+l);else h=s>0?-n:n,u=Math.max(0,-(s*h+o)),d=-u*u+h*(h+2*a)+l;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Ai).multiplyScalar(h).add(xi),d}intersectSphere(e,t){wi.subVectors(e.center,this.origin);const r=wi.dot(this.direction),i=wi.dot(wi)-r*r,n=e.radius*e.radius;if(i>n)return null;const s=Math.sqrt(n-i),o=r-s,a=r+s;return o<0&&a<0?null:o<0?this.at(a,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return null===r?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);if(0===t)return!0;return e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,s,o,a;const l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(r=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(r=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(n=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(n=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),r>s||n>i?null:((n>r||r!=r)&&(r=n),(s<i||i!=i)&&(i=s),u>=0?(o=(e.min.z-h.z)*u,a=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,a=(e.min.z-h.z)*u),r>a||o>i?null:((o>r||r!=r)&&(r=o),(a<i||i!=i)&&(i=a),i<0?null:this.at(r>=0?r:i,t)))}intersectsBox(e){return null!==this.intersectBox(e,wi)}intersectTriangle(e,t,r,i,n){Si.subVectors(t,e),Mi.subVectors(r,e),Ci.crossVectors(Si,Mi);let s,o=this.direction.dot(Ci);if(o>0){if(i)return null;s=1}else{if(!(o<0))return null;s=-1,o=-o}Ti.subVectors(this.origin,e);const a=s*this.direction.dot(Mi.crossVectors(Ti,Mi));if(a<0)return null;const l=s*this.direction.dot(Si.cross(Ti));if(l<0)return null;if(a+l>o)return null;const c=-s*Ti.dot(Ci);return c<0?null:this.at(c/o,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ii{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,i,n,s,o,a,l,c,u,h,d,f,p,m){const g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=i,g[1]=n,g[5]=s,g[9]=o,g[13]=a,g[2]=l,g[6]=c,g[10]=u,g[14]=h,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ii).fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/Oi.setFromMatrixColumn(e,0).length(),n=1/Oi.setFromMatrixColumn(e,1).length(),s=1/Oi.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,r=e.x,i=e.y,n=e.z,s=Math.cos(r),o=Math.sin(r),a=Math.cos(i),l=Math.sin(i),c=Math.cos(n),u=Math.sin(n);if("XYZ"===e.order){const e=s*c,r=s*u,i=o*c,n=o*u;t[0]=a*c,t[4]=-a*u,t[8]=l,t[1]=r+i*l,t[5]=e-n*l,t[9]=-o*a,t[2]=n-e*l,t[6]=i+r*l,t[10]=s*a}else if("YXZ"===e.order){const e=a*c,r=a*u,i=l*c,n=l*u;t[0]=e+n*o,t[4]=i*o-r,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-o,t[2]=r*o-i,t[6]=n+e*o,t[10]=s*a}else if("ZXY"===e.order){const e=a*c,r=a*u,i=l*c,n=l*u;t[0]=e-n*o,t[4]=-s*u,t[8]=i+r*o,t[1]=r+i*o,t[5]=s*c,t[9]=n-e*o,t[2]=-s*l,t[6]=o,t[10]=s*a}else if("ZYX"===e.order){const e=s*c,r=s*u,i=o*c,n=o*u;t[0]=a*c,t[4]=i*l-r,t[8]=e*l+n,t[1]=a*u,t[5]=n*l+e,t[9]=r*l-i,t[2]=-l,t[6]=o*a,t[10]=s*a}else if("YZX"===e.order){const e=s*a,r=s*l,i=o*a,n=o*l;t[0]=a*c,t[4]=n-e*u,t[8]=i*u+r,t[1]=u,t[5]=s*c,t[9]=-o*c,t[2]=-l*c,t[6]=r*u+i,t[10]=e-n*u}else if("XZY"===e.order){const e=s*a,r=s*l,i=o*a,n=o*l;t[0]=a*c,t[4]=-u,t[8]=l*c,t[1]=e*u+n,t[5]=s*c,t[9]=r*u-i,t[2]=i*u-r,t[6]=o*c,t[10]=n*u+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(ki,e,Li)}lookAt(e,t,r){const i=this.elements;return Di.subVectors(e,t),0===Di.lengthSq()&&(Di.z=1),Di.normalize(),Ni.crossVectors(r,Di),0===Ni.lengthSq()&&(1===Math.abs(r.z)?Di.x+=1e-4:Di.z+=1e-4,Di.normalize(),Ni.crossVectors(r,Di)),Ni.normalize(),Gi.crossVectors(Di,Ni),i[0]=Ni.x,i[4]=Gi.x,i[8]=Di.x,i[1]=Ni.y,i[5]=Gi.y,i[9]=Di.y,i[2]=Ni.z,i[6]=Gi.z,i[10]=Di.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,n=this.elements,s=r[0],o=r[4],a=r[8],l=r[12],c=r[1],u=r[5],h=r[9],d=r[13],f=r[2],p=r[6],m=r[10],g=r[14],v=r[3],_=r[7],b=r[11],y=r[15],E=i[0],w=i[4],x=i[8],A=i[12],T=i[1],S=i[5],M=i[9],C=i[13],R=i[2],I=i[6],O=i[10],P=i[14],k=i[3],L=i[7],N=i[11],G=i[15];return n[0]=s*E+o*T+a*R+l*k,n[4]=s*w+o*S+a*I+l*L,n[8]=s*x+o*M+a*O+l*N,n[12]=s*A+o*C+a*P+l*G,n[1]=c*E+u*T+h*R+d*k,n[5]=c*w+u*S+h*I+d*L,n[9]=c*x+u*M+h*O+d*N,n[13]=c*A+u*C+h*P+d*G,n[2]=f*E+p*T+m*R+g*k,n[6]=f*w+p*S+m*I+g*L,n[10]=f*x+p*M+m*O+g*N,n[14]=f*A+p*C+m*P+g*G,n[3]=v*E+_*T+b*R+y*k,n[7]=v*w+_*S+b*I+y*L,n[11]=v*x+_*M+b*O+y*N,n[15]=v*A+_*C+b*P+y*G,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],s=e[1],o=e[5],a=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14];return e[3]*(+n*a*u-i*l*u-n*o*h+r*l*h+i*o*d-r*a*d)+e[7]*(+t*a*d-t*l*h+n*s*h-i*s*d+i*l*c-n*a*c)+e[11]*(+t*l*u-t*o*d-n*s*u+r*s*d+n*o*c-r*l*c)+e[15]*(-i*o*c-t*a*u+t*o*h+i*s*u-r*s*h+r*a*c)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*h*l+p*a*d-o*m*d-u*a*g+o*h*g,_=f*h*l-c*m*l-f*a*d+s*m*d+c*a*g-s*h*g,b=c*p*l-f*u*l+f*o*d-s*p*d-c*o*g+s*u*g,y=f*u*a-c*p*a-f*o*h+s*p*h+c*o*m-s*u*m,E=t*v+r*_+i*b+n*y;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const w=1/E;return e[0]=v*w,e[1]=(p*h*n-u*m*n-p*i*d+r*m*d+u*i*g-r*h*g)*w,e[2]=(o*m*n-p*a*n+p*i*l-r*m*l-o*i*g+r*a*g)*w,e[3]=(u*a*n-o*h*n-u*i*l+r*h*l+o*i*d-r*a*d)*w,e[4]=_*w,e[5]=(c*m*n-f*h*n+f*i*d-t*m*d-c*i*g+t*h*g)*w,e[6]=(f*a*n-s*m*n-f*i*l+t*m*l+s*i*g-t*a*g)*w,e[7]=(s*h*n-c*a*n+c*i*l-t*h*l-s*i*d+t*a*d)*w,e[8]=b*w,e[9]=(f*u*n-c*p*n-f*r*d+t*p*d+c*r*g-t*u*g)*w,e[10]=(s*p*n-f*o*n+f*r*l-t*p*l-s*r*g+t*o*g)*w,e[11]=(c*o*n-s*u*n-c*r*l+t*u*l+s*r*d-t*o*d)*w,e[12]=y*w,e[13]=(c*p*i-f*u*i+f*r*h-t*p*h-c*r*m+t*u*m)*w,e[14]=(f*o*i-s*p*i-f*r*a+t*p*a+s*r*m-t*o*m)*w,e[15]=(s*u*i-c*o*i+c*r*a-t*u*a-s*r*h+t*o*h)*w,this}scale(e){const t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),n=1-r,s=e.x,o=e.y,a=e.z,l=n*s,c=n*o;return this.set(l*s+r,l*o-i*a,l*a+i*o,0,l*o+i*a,c*o+r,c*a-i*s,0,l*a-i*o,c*a+i*s,n*a*a+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,s){return this.set(1,r,n,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,n=t._x,s=t._y,o=t._z,a=t._w,l=n+n,c=s+s,u=o+o,h=n*l,d=n*c,f=n*u,p=s*c,m=s*u,g=o*u,v=a*l,_=a*c,b=a*u,y=r.x,E=r.y,w=r.z;return i[0]=(1-(p+g))*y,i[1]=(d+b)*y,i[2]=(f-_)*y,i[3]=0,i[4]=(d-b)*E,i[5]=(1-(h+g))*E,i[6]=(m+v)*E,i[7]=0,i[8]=(f+_)*w,i[9]=(m-v)*w,i[10]=(1-(h+p))*w,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let n=Oi.set(i[0],i[1],i[2]).length();const s=Oi.set(i[4],i[5],i[6]).length(),o=Oi.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],Pi.copy(this);const a=1/n,l=1/s,c=1/o;return Pi.elements[0]*=a,Pi.elements[1]*=a,Pi.elements[2]*=a,Pi.elements[4]*=l,Pi.elements[5]*=l,Pi.elements[6]*=l,Pi.elements[8]*=c,Pi.elements[9]*=c,Pi.elements[10]*=c,t.setFromRotationMatrix(Pi),r.x=n,r.y=s,r.z=o,this}makePerspective(e,t,r,i,n,s){void 0===s&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*n/(t-e),l=2*n/(r-i),c=(t+e)/(t-e),u=(r+i)/(r-i),h=-(s+n)/(s-n),d=-2*s*n/(s-n);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,r,i,n,s){const o=this.elements,a=1/(t-e),l=1/(r-i),c=1/(s-n),u=(t+e)*a,h=(r+i)*l,d=(s+n)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let e=0;e<16;e++)if(t[e]!==r[e])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}Ii.prototype.isMatrix4=!0;const Oi=new Qr,Pi=new Ii,ki=new Qr(0,0,0),Li=new Qr(1,1,1),Ni=new Qr,Gi=new Qr,Di=new Qr,Ui=new Ii,Vi=new Kr;class Bi{constructor(e=0,t=0,r=0,i=Bi.DefaultOrder){this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,n=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],u=i[2],h=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(br(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-br(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(br(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,n));break;case"ZYX":this._y=Math.asin(-br(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(a,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(br(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-br(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(o,n)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return Ui.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ui,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return Vi.setFromEuler(this),this.setFromQuaternion(Vi,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Bi.prototype.isEuler=!0,Bi.DefaultOrder="XYZ",Bi.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class Fi{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let ji=0;const zi=new Qr,Wi=new Kr,Hi=new Ii,$i=new Qr,Yi=new Qr,qi=new Qr,Xi=new Kr,Zi=new Qr(1,0,0),Ji=new Qr(0,1,0),Ki=new Qr(0,0,1),Qi={type:"added"},en={type:"removed"};class tn extends fr{constructor(){super(),Object.defineProperty(this,"id",{value:ji++}),this.uuid=_r(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=tn.DefaultUp.clone();const e=new Qr,t=new Bi,r=new Kr,i=new Qr(1,1,1);t._onChange((function(){r.setFromEuler(t,!1)})),r._onChange((function(){t.setFromQuaternion(r,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Ii},normalMatrix:{value:new Mr}}),this.matrix=new Ii,this.matrixWorld=new Ii,this.matrixAutoUpdate=tn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Fi,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Wi.setFromAxisAngle(e,t),this.quaternion.multiply(Wi),this}rotateOnWorldAxis(e,t){return Wi.setFromAxisAngle(e,t),this.quaternion.premultiply(Wi),this}rotateX(e){return this.rotateOnAxis(Zi,e)}rotateY(e){return this.rotateOnAxis(Ji,e)}rotateZ(e){return this.rotateOnAxis(Ki,e)}translateOnAxis(e,t){return zi.copy(e).applyQuaternion(this.quaternion),this.position.add(zi.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(Zi,e)}translateY(e){return this.translateOnAxis(Ji,e)}translateZ(e){return this.translateOnAxis(Ki,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Hi.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?$i.copy(e):$i.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Yi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Hi.lookAt(Yi,$i,this.up):Hi.lookAt($i,Yi,this.up),this.quaternion.setFromRotationMatrix(Hi),i&&(Hi.extractRotation(i.matrixWorld),Wi.setFromRotationMatrix(Hi),this.quaternion.premultiply(Wi.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Qi)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}const t=this.children.indexOf(e);return-1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(en)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(en)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Hi.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Hi.multiply(e.parent.matrixWorld)),e.applyMatrix4(Hi),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const i=this.children[r].getObjectByProperty(e,t);if(void 0!==i)return i}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yi,e,qi),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Yi,Xi,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){const e=this.children;for(let t=0,r=e.length;t<r;t++)e[t].updateWorldMatrix(!1,!0)}}toJSON(e){const t=void 0===e||"string"==typeof e,r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function n(t,r){return void 0===t[r.uuid]&&(t[r.uuid]=r.toJSON(e)),r.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);const t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){const r=t.shapes;if(Array.isArray(r))for(let t=0,i=r.length;t<i;t++){const i=r[t];n(e.shapes,i)}else n(e.shapes,r)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const t=[];for(let r=0,i=this.material.length;r<i;r++)t.push(n(e.materials,this.material[r]));i.material=t}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let t=0;t<this.children.length;t++)i.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let t=0;t<this.animations.length;t++){const r=this.animations[t];i.animations.push(n(e.animations,r))}}if(t){const t=s(e.geometries),i=s(e.materials),n=s(e.textures),o=s(e.images),a=s(e.shapes),l=s(e.skeletons),c=s(e.animations),u=s(e.nodes);t.length>0&&(r.geometries=t),i.length>0&&(r.materials=i),n.length>0&&(r.textures=n),o.length>0&&(r.images=o),a.length>0&&(r.shapes=a),l.length>0&&(r.skeletons=l),c.length>0&&(r.animations=c),u.length>0&&(r.nodes=u)}return r.object=i,r;function s(e){const t=[];for(const r in e){const i=e[r];delete i.metadata,t.push(i)}return t}}clone(e){return(new this.constructor).copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){const r=e.children[t];this.add(r.clone())}return this}}tn.DefaultUp=new Qr(0,1,0),tn.DefaultMatrixAutoUpdate=!0,tn.prototype.isObject3D=!0;const rn=new Qr,nn=new Qr,sn=new Qr,on=new Qr,an=new Qr,ln=new Qr,cn=new Qr,un=new Qr,hn=new Qr,dn=new Qr;class fn{constructor(e=new Qr,t=new Qr,r=new Qr){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),rn.subVectors(e,t),i.cross(rn);const n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){rn.subVectors(i,t),nn.subVectors(r,t),sn.subVectors(e,t);const s=rn.dot(rn),o=rn.dot(nn),a=rn.dot(sn),l=nn.dot(nn),c=nn.dot(sn),u=s*l-o*o;if(0===u)return n.set(-2,-1,-1);const h=1/u,d=(l*a-o*c)*h,f=(s*c-o*a)*h;return n.set(1-d-f,f,d)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,on),on.x>=0&&on.y>=0&&on.x+on.y<=1}static getUV(e,t,r,i,n,s,o,a){return this.getBarycoord(e,t,r,i,on),a.set(0,0),a.addScaledVector(n,on.x),a.addScaledVector(s,on.y),a.addScaledVector(o,on.z),a}static isFrontFacing(e,t,r,i){return rn.subVectors(r,t),nn.subVectors(e,t),rn.cross(nn).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return rn.subVectors(this.c,this.b),nn.subVectors(this.a,this.b),.5*rn.cross(nn).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return fn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return fn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return fn.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return fn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return fn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,n=this.c;let s,o;an.subVectors(i,r),ln.subVectors(n,r),un.subVectors(e,r);const a=an.dot(un),l=ln.dot(un);if(a<=0&&l<=0)return t.copy(r);hn.subVectors(e,i);const c=an.dot(hn),u=ln.dot(hn);if(c>=0&&u<=c)return t.copy(i);const h=a*u-c*l;if(h<=0&&a>=0&&c<=0)return s=a/(a-c),t.copy(r).addScaledVector(an,s);dn.subVectors(e,n);const d=an.dot(dn),f=ln.dot(dn);if(f>=0&&d<=f)return t.copy(n);const p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),t.copy(r).addScaledVector(ln,o);const m=c*f-d*u;if(m<=0&&u-c>=0&&d-f>=0)return cn.subVectors(n,i),o=(u-c)/(u-c+(d-f)),t.copy(i).addScaledVector(cn,o);const g=1/(m+p+h);return s=p*g,o=h*g,t.copy(r).addScaledVector(an,s).addScaledVector(ln,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let pn=0;class mn extends fr{constructor(){super(),Object.defineProperty(this,"id",{value:pn++}),this.uuid=_r(),this.name="",this.type="Material",this.fog=!0,this.blending=y,this.side=p,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=L,this.blendDst=N,this.blendEquation=T,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=W,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=er,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Bt,this.stencilZFail=Bt,this.stencilZPass=Bt,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const r=e[t];if(void 0===r){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===v;continue}const i=this[t];void 0!==i?i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(e){const t=[];for(const r in e){const i=e[r];delete i.metadata,t.push(i)}return t}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==y&&(r.blending=this.blending),this.side!==p&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(r.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=this.flatShading),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),t){const t=i(e.textures),n=i(e.images);t.length>0&&(r.textures=t),n.length>0&&(r.images=n)}return r}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(null!==t){const e=t.length;r=new Array(e);for(let i=0;i!==e;++i)r[i]=t[i].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}mn.prototype.isMaterial=!0,mn.fromType=function(){return null};class gn extends mn{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Ur(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}gn.prototype.isMeshBasicMaterial=!0;const vn=new Qr,_n=new Sr;class bn{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===r,this.usage=tr,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let r=0;for(let i=0,n=e.length;i<n;i++){let n=e[i];void 0===n&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),n=new Ur),t[r++]=n.r,t[r++]=n.g,t[r++]=n.b}return this}copyVector2sArray(e){const t=this.array;let r=0;for(let i=0,n=e.length;i<n;i++){let n=e[i];void 0===n&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),n=new Sr),t[r++]=n.x,t[r++]=n.y}return this}copyVector3sArray(e){const t=this.array;let r=0;for(let i=0,n=e.length;i<n;i++){let n=e[i];void 0===n&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),n=new Qr),t[r++]=n.x,t[r++]=n.y,t[r++]=n.z}return this}copyVector4sArray(e){const t=this.array;let r=0;for(let i=0,n=e.length;i<n;i++){let n=e[i];void 0===n&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),n=new Hr),t[r++]=n.x,t[r++]=n.y,t[r++]=n.z,t[r++]=n.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,r=this.count;t<r;t++)_n.fromBufferAttribute(this,t),_n.applyMatrix3(e),this.setXY(t,_n.x,_n.y);else if(3===this.itemSize)for(let t=0,r=this.count;t<r;t++)vn.fromBufferAttribute(this,t),vn.applyMatrix3(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)vn.x=this.getX(t),vn.y=this.getY(t),vn.z=this.getZ(t),vn.applyMatrix4(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)vn.x=this.getX(t),vn.y=this.getY(t),vn.z=this.getZ(t),vn.applyNormalMatrix(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)vn.x=this.getX(t),vn.y=this.getY(t),vn.z=this.getZ(t),vn.transformDirection(e),this.setXYZ(t,vn.x,vn.y,vn.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==tr&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}bn.prototype.isBufferAttribute=!0;class yn extends bn{constructor(e,t,r){super(new Int8Array(e),t,r)}}class En extends bn{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class wn extends bn{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class xn extends bn{constructor(e,t,r){super(new Int16Array(e),t,r)}}class An extends bn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class Tn extends bn{constructor(e,t,r){super(new Int32Array(e),t,r)}}class Sn extends bn{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class Mn extends bn{constructor(e,t,r){super(new Uint16Array(e),t,r)}}Mn.prototype.isFloat16BufferAttribute=!0;class Cn extends bn{constructor(e,t,r){super(new Float32Array(e),t,r)}}class Rn extends bn{constructor(e,t,r){super(new Float64Array(e),t,r)}}let In=0;const On=new Ii,Pn=new tn,kn=new Qr,Ln=new ri,Nn=new ri,Gn=new Qr;class Dn extends fr{constructor(){super(),Object.defineProperty(this,"id",{value:In++}),this.uuid=_r(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Cr(e)?Sn:An)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const t=(new Mr).getNormalMatrix(e);r.applyNormalMatrix(t),r.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return On.makeRotationFromQuaternion(e),this.applyMatrix4(On),this}rotateX(e){return On.makeRotationX(e),this.applyMatrix4(On),this}rotateY(e){return On.makeRotationY(e),this.applyMatrix4(On),this}rotateZ(e){return On.makeRotationZ(e),this.applyMatrix4(On),this}translate(e,t,r){return On.makeTranslation(e,t,r),this.applyMatrix4(On),this}scale(e,t,r){return On.makeScale(e,t,r),this.applyMatrix4(On),this}lookAt(e){return Pn.lookAt(e),Pn.updateMatrix(),this.applyMatrix4(Pn.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(kn).negate(),this.translate(kn.x,kn.y,kn.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new Cn(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new ri);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Qr(-1/0,-1/0,-1/0),new Qr(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const r=t[e];Ln.setFromBufferAttribute(r),this.morphTargetsRelative?(Gn.addVectors(this.boundingBox.min,Ln.min),this.boundingBox.expandByPoint(Gn),Gn.addVectors(this.boundingBox.max,Ln.max),this.boundingBox.expandByPoint(Gn)):(this.boundingBox.expandByPoint(Ln.min),this.boundingBox.expandByPoint(Ln.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new Ei);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Qr,1/0);if(e){const r=this.boundingSphere.center;if(Ln.setFromBufferAttribute(e),t)for(let e=0,r=t.length;e<r;e++){const r=t[e];Nn.setFromBufferAttribute(r),this.morphTargetsRelative?(Gn.addVectors(Ln.min,Nn.min),Ln.expandByPoint(Gn),Gn.addVectors(Ln.max,Nn.max),Ln.expandByPoint(Gn)):(Ln.expandByPoint(Nn.min),Ln.expandByPoint(Nn.max))}Ln.getCenter(r);let i=0;for(let t=0,n=e.count;t<n;t++)Gn.fromBufferAttribute(e,t),i=Math.max(i,r.distanceToSquared(Gn));if(t)for(let n=0,s=t.length;n<s;n++){const s=t[n],o=this.morphTargetsRelative;for(let t=0,n=s.count;t<n;t++)Gn.fromBufferAttribute(s,t),o&&(kn.fromBufferAttribute(e,t),Gn.add(kn)),i=Math.max(i,r.distanceToSquared(Gn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=e.array,i=t.position.array,n=t.normal.array,s=t.uv.array,o=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new bn(new Float32Array(4*o),4));const a=this.getAttribute("tangent").array,l=[],c=[];for(let e=0;e<o;e++)l[e]=new Qr,c[e]=new Qr;const u=new Qr,h=new Qr,d=new Qr,f=new Sr,p=new Sr,m=new Sr,g=new Qr,v=new Qr;function _(e,t,r){u.fromArray(i,3*e),h.fromArray(i,3*t),d.fromArray(i,3*r),f.fromArray(s,2*e),p.fromArray(s,2*t),m.fromArray(s,2*r),h.sub(u),d.sub(u),p.sub(f),m.sub(f);const n=1/(p.x*m.y-m.x*p.y);isFinite(n)&&(g.copy(h).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(n),v.copy(d).multiplyScalar(p.x).addScaledVector(h,-m.x).multiplyScalar(n),l[e].add(g),l[t].add(g),l[r].add(g),c[e].add(v),c[t].add(v),c[r].add(v))}let b=this.groups;0===b.length&&(b=[{start:0,count:r.length}]);for(let e=0,t=b.length;e<t;++e){const t=b[e],i=t.start;for(let e=i,n=i+t.count;e<n;e+=3)_(r[e+0],r[e+1],r[e+2])}const y=new Qr,E=new Qr,w=new Qr,x=new Qr;function A(e){w.fromArray(n,3*e),x.copy(w);const t=l[e];y.copy(t),y.sub(w.multiplyScalar(w.dot(t))).normalize(),E.crossVectors(x,t);const r=E.dot(c[e])<0?-1:1;a[4*e]=y.x,a[4*e+1]=y.y,a[4*e+2]=y.z,a[4*e+3]=r}for(let e=0,t=b.length;e<t;++e){const t=b[e],i=t.start;for(let e=i,n=i+t.count;e<n;e+=3)A(r[e+0]),A(r[e+1]),A(r[e+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let r=this.getAttribute("normal");if(void 0===r)r=new bn(new Float32Array(3*t.count),3),this.setAttribute("normal",r);else for(let e=0,t=r.count;e<t;e++)r.setXYZ(e,0,0,0);const i=new Qr,n=new Qr,s=new Qr,o=new Qr,a=new Qr,l=new Qr,c=new Qr,u=new Qr;if(e)for(let h=0,d=e.count;h<d;h+=3){const d=e.getX(h+0),f=e.getX(h+1),p=e.getX(h+2);i.fromBufferAttribute(t,d),n.fromBufferAttribute(t,f),s.fromBufferAttribute(t,p),c.subVectors(s,n),u.subVectors(i,n),c.cross(u),o.fromBufferAttribute(r,d),a.fromBufferAttribute(r,f),l.fromBufferAttribute(r,p),o.add(c),a.add(c),l.add(c),r.setXYZ(d,o.x,o.y,o.z),r.setXYZ(f,a.x,a.y,a.z),r.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,o=t.count;e<o;e+=3)i.fromBufferAttribute(t,e+0),n.fromBufferAttribute(t,e+1),s.fromBufferAttribute(t,e+2),c.subVectors(s,n),u.subVectors(i,n),c.cross(u),r.setXYZ(e+0,c.x,c.y,c.z),r.setXYZ(e+1,c.x,c.y,c.z),r.setXYZ(e+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const r=this.attributes;for(const i in r){if(void 0===e.attributes[i])continue;const n=r[i].array,s=e.attributes[i],o=s.array,a=s.itemSize*t,l=Math.min(o.length,n.length-a);for(let e=0,t=a;e<l;e++,t++)n[t]=o[e]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Gn.fromBufferAttribute(e,t),Gn.normalize(),e.setXYZ(t,Gn.x,Gn.y,Gn.z)}toNonIndexed(){function e(e,t){const r=e.array,i=e.itemSize,n=e.normalized,s=new r.constructor(t.length*i);let o=0,a=0;for(let n=0,l=t.length;n<l;n++){o=e.isInterleavedBufferAttribute?t[n]*e.data.stride+e.offset:t[n]*i;for(let e=0;e<i;e++)s[a++]=r[o++]}return new bn(s,i,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Dn,r=this.index.array,i=this.attributes;for(const n in i){const s=e(i[n],r);t.setAttribute(n,s)}const n=this.morphAttributes;for(const i in n){const s=[],o=n[i];for(let t=0,i=o.length;t<i;t++){const i=e(o[t],r);s.push(i)}t.morphAttributes[i]=s}t.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let e=0,r=s.length;e<r;e++){const r=s[e];t.addGroup(r.start,r.count,r.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const t=this.parameters;for(const r in t)void 0!==t[r]&&(e[r]=t[r]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const t in r){const i=r[t];e.data.attributes[t]=i.toJSON(e.data)}const i={};let n=!1;for(const t in this.morphAttributes){const r=this.morphAttributes[t],s=[];for(let t=0,i=r.length;t<i;t++){const i=r[t];s.push(i.toJSON(e.data))}s.length>0&&(i[t]=s,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));const o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;null!==r&&this.setIndex(r.clone(t));const i=e.attributes;for(const e in i){const r=i[e];this.setAttribute(e,r.clone(t))}const n=e.morphAttributes;for(const e in n){const r=[],i=n[e];for(let e=0,n=i.length;e<n;e++)r.push(i[e].clone(t));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;const s=e.groups;for(let e=0,t=s.length;e<t;e++){const t=s[e];this.addGroup(t.start,t.count,t.materialIndex)}const o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=e.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Dn.prototype.isBufferGeometry=!0;const Un=new Ii,Vn=new Ri,Bn=new Ei,Fn=new Qr,jn=new Qr,zn=new Qr,Wn=new Qr,Hn=new Qr,$n=new Qr,Yn=new Qr,qn=new Qr,Xn=new Qr,Zn=new Sr,Jn=new Sr,Kn=new Sr,Qn=new Qr,es=new Qr;class ts extends tn{constructor(e=new Dn,t=new gn){super(),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,t){const r=this.geometry,i=this.material,n=this.matrixWorld;if(void 0===i)return;if(null===r.boundingSphere&&r.computeBoundingSphere(),Bn.copy(r.boundingSphere),Bn.applyMatrix4(n),!1===e.ray.intersectsSphere(Bn))return;if(Un.copy(n).invert(),Vn.copy(e.ray).applyMatrix4(Un),null!==r.boundingBox&&!1===Vn.intersectsBox(r.boundingBox))return;let s;if(r.isBufferGeometry){const n=r.index,o=r.attributes.position,a=r.morphAttributes.position,l=r.morphTargetsRelative,c=r.attributes.uv,u=r.attributes.uv2,h=r.groups,d=r.drawRange;if(null!==n)if(Array.isArray(i))for(let r=0,f=h.length;r<f;r++){const f=h[r],p=i[f.materialIndex];for(let r=Math.max(f.start,d.start),i=Math.min(n.count,Math.min(f.start+f.count,d.start+d.count));r<i;r+=3){const i=n.getX(r),h=n.getX(r+1),d=n.getX(r+2);s=rs(this,p,e,Vn,o,a,l,c,u,i,h,d),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{for(let r=Math.max(0,d.start),h=Math.min(n.count,d.start+d.count);r<h;r+=3){const h=n.getX(r),d=n.getX(r+1),f=n.getX(r+2);s=rs(this,i,e,Vn,o,a,l,c,u,h,d,f),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}else if(void 0!==o)if(Array.isArray(i))for(let r=0,n=h.length;r<n;r++){const n=h[r],f=i[n.materialIndex];for(let r=Math.max(n.start,d.start),i=Math.min(o.count,Math.min(n.start+n.count,d.start+d.count));r<i;r+=3){s=rs(this,f,e,Vn,o,a,l,c,u,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),s.face.materialIndex=n.materialIndex,t.push(s))}}else{for(let r=Math.max(0,d.start),n=Math.min(o.count,d.start+d.count);r<n;r+=3){s=rs(this,i,e,Vn,o,a,l,c,u,r,r+1,r+2),s&&(s.faceIndex=Math.floor(r/3),t.push(s))}}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function rs(e,t,r,i,n,s,o,a,l,c,u,h){Fn.fromBufferAttribute(n,c),jn.fromBufferAttribute(n,u),zn.fromBufferAttribute(n,h);const d=e.morphTargetInfluences;if(s&&d){Yn.set(0,0,0),qn.set(0,0,0),Xn.set(0,0,0);for(let e=0,t=s.length;e<t;e++){const t=d[e],r=s[e];0!==t&&(Wn.fromBufferAttribute(r,c),Hn.fromBufferAttribute(r,u),$n.fromBufferAttribute(r,h),o?(Yn.addScaledVector(Wn,t),qn.addScaledVector(Hn,t),Xn.addScaledVector($n,t)):(Yn.addScaledVector(Wn.sub(Fn),t),qn.addScaledVector(Hn.sub(jn),t),Xn.addScaledVector($n.sub(zn),t)))}Fn.add(Yn),jn.add(qn),zn.add(Xn)}e.isSkinnedMesh&&(e.boneTransform(c,Fn),e.boneTransform(u,jn),e.boneTransform(h,zn));const f=function(e,t,r,i,n,s,o,a){let l;if(l=t.side===m?i.intersectTriangle(o,s,n,!0,a):i.intersectTriangle(n,s,o,t.side!==g,a),null===l)return null;es.copy(a),es.applyMatrix4(e.matrixWorld);const c=r.ray.origin.distanceTo(es);return c<r.near||c>r.far?null:{distance:c,point:es.clone(),object:e}}(e,t,r,i,Fn,jn,zn,Qn);if(f){a&&(Zn.fromBufferAttribute(a,c),Jn.fromBufferAttribute(a,u),Kn.fromBufferAttribute(a,h),f.uv=fn.getUV(Qn,Fn,jn,zn,Zn,Jn,Kn,new Sr)),l&&(Zn.fromBufferAttribute(l,c),Jn.fromBufferAttribute(l,u),Kn.fromBufferAttribute(l,h),f.uv2=fn.getUV(Qn,Fn,jn,zn,Zn,Jn,Kn,new Sr));const e={a:c,b:u,c:h,normal:new Qr,materialIndex:0};fn.getNormal(Fn,jn,zn,e.normal),f.face=e}return f}ts.prototype.isMesh=!0;class is extends Dn{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};const o=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);const a=[],l=[],c=[],u=[];let h=0,d=0;function f(e,t,r,i,n,s,f,p,m,g,v){const _=s/m,b=f/g,y=s/2,E=f/2,w=p/2,x=m+1,A=g+1;let T=0,S=0;const M=new Qr;for(let s=0;s<A;s++){const o=s*b-E;for(let a=0;a<x;a++){const h=a*_-y;M[e]=h*i,M[t]=o*n,M[r]=w,l.push(M.x,M.y,M.z),M[e]=0,M[t]=0,M[r]=p>0?1:-1,c.push(M.x,M.y,M.z),u.push(a/m),u.push(1-s/g),T+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){const r=h+t+x*e,i=h+t+x*(e+1),n=h+(t+1)+x*(e+1),s=h+(t+1)+x*e;a.push(r,i,s),a.push(i,n,s),S+=6}o.addGroup(d,S,v),d+=S,h+=T}f("z","y","x",-1,-1,r,t,e,s,n,0),f("z","y","x",1,-1,r,t,-e,s,n,1),f("x","z","y",1,1,e,r,t,i,s,2),f("x","z","y",1,-1,e,r,-t,i,s,3),f("x","y","z",1,-1,e,t,r,i,n,4),f("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(a),this.setAttribute("position",new Cn(l,3)),this.setAttribute("normal",new Cn(c,3)),this.setAttribute("uv",new Cn(u,2))}static fromJSON(e){return new is(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ns(e){const t={};for(const r in e){t[r]={};for(const i in e[r]){const n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function ss(e){const t={};for(let r=0;r<e.length;r++){const i=ns(e[r]);for(const e in i)t[e]=i[e]}return t}const os={clone:ns,merge:ss};class as extends mn{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ns(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const i=this.uniforms[r].value;i&&i.isTexture?t.uniforms[r]={type:"t",value:i.toJSON(e).uuid}:i&&i.isColor?t.uniforms[r]={type:"c",value:i.getHex()}:i&&i.isVector2?t.uniforms[r]={type:"v2",value:i.toArray()}:i&&i.isVector3?t.uniforms[r]={type:"v3",value:i.toArray()}:i&&i.isVector4?t.uniforms[r]={type:"v4",value:i.toArray()}:i&&i.isMatrix3?t.uniforms[r]={type:"m3",value:i.toArray()}:i&&i.isMatrix4?t.uniforms[r]={type:"m4",value:i.toArray()}:t.uniforms[r]={value:i}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const r={};for(const e in this.extensions)!0===this.extensions[e]&&(r[e]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}as.prototype.isShaderMaterial=!0;class ls extends tn{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Ii,this.projectionMatrix=new Ii,this.projectionMatrixInverse=new Ii}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}ls.prototype.isCamera=!0;class cs extends ls{constructor(e=50,t=1,r=.1,i=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*vr*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*gr*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*vr*Math.atan(Math.tan(.5*gr*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*gr*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const e=s.fullWidth,o=s.fullHeight;n+=s.offsetX*i/e,t-=s.offsetY*r/o,i*=s.width/e,r*=s.height/o}const o=this.filmOffset;0!==o&&(n+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}cs.prototype.isPerspectiveCamera=!0;const us=90;class hs extends tn{constructor(e,t,r){if(super(),this.type="CubeCamera",!0!==r.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=r;const i=new cs(us,1,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new Qr(1,0,0)),this.add(i);const n=new cs(us,1,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new Qr(-1,0,0)),this.add(n);const s=new cs(us,1,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new Qr(0,1,0)),this.add(s);const o=new cs(us,1,e,t);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(new Qr(0,-1,0)),this.add(o);const a=new cs(us,1,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new Qr(0,0,1)),this.add(a);const l=new cs(us,1,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new Qr(0,0,-1)),this.add(l)}update(e,t){null===this.parent&&this.updateMatrixWorld();const r=this.renderTarget,[i,n,s,o,a,l]=this.children,c=e.xr.enabled,u=e.getRenderTarget();e.xr.enabled=!1;const h=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,o),e.setRenderTarget(r,4),e.render(t,a),r.texture.generateMipmaps=h,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=c,r.texture.needsPMREMUpdate=!0}}class ds extends Wr{constructor(e,t,r,i,n,s,o,a,l,c){super(e=void 0!==e?e:[],t=void 0!==t?t:se,r,i,n,s,o,a,l,c),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}ds.prototype.isCubeTexture=!0;class fs extends $r{constructor(e,t={}){super(e,e,t);const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new ds(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:be}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=De,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new is(5,5,5),n=new as({name:"CubemapFromEquirect",uniforms:ns(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:m,blending:b});n.uniforms.tEquirect.value=t;const s=new ts(i,n),o=t.minFilter;t.minFilter===we&&(t.minFilter=be);return new hs(1,10,this).update(e,s),t.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){const n=e.getRenderTarget();for(let n=0;n<6;n++)e.setRenderTarget(this,n),e.clear(t,r,i);e.setRenderTarget(n)}}fs.prototype.isWebGLCubeRenderTarget=!0;const ps=new Qr,ms=new Qr,gs=new Mr;class vs{constructor(e=new Qr(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=ps.subVectors(r,t).cross(ms.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const r=e.delta(ps),i=this.normal.dot(r);if(0===i)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||gs.getNormalMatrix(e),i=this.coplanarPoint(ps).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}vs.prototype.isPlane=!0;const _s=new Ei,bs=new Qr;class ys{constructor(e=new vs,t=new vs,r=new vs,i=new vs,n=new vs,s=new vs){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(n),o[5].copy(s),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){const t=this.planes,r=e.elements,i=r[0],n=r[1],s=r[2],o=r[3],a=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],f=r[10],p=r[11],m=r[12],g=r[13],v=r[14],_=r[15];return t[0].setComponents(o-i,u-a,p-h,_-m).normalize(),t[1].setComponents(o+i,u+a,p+h,_+m).normalize(),t[2].setComponents(o+n,u+l,p+d,_+g).normalize(),t[3].setComponents(o-n,u-l,p-d,_-g).normalize(),t[4].setComponents(o-s,u-c,p-f,_-v).normalize(),t[5].setComponents(o+s,u+c,p+f,_+v).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),_s.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(_s)}intersectsSprite(e){return _s.center.set(0,0,0),_s.radius=.7071067811865476,_s.applyMatrix4(e.matrixWorld),this.intersectsSphere(_s)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let e=0;e<6;e++){if(t[e].distanceToPoint(r)<i)return!1}return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(bs.x=i.normal.x>0?e.max.x:e.min.x,bs.y=i.normal.y>0?e.max.y:e.min.y,bs.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(bs)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Es(){let e=null,t=!1,r=null,i=null;function n(t,s){r(t,s),i=e.requestAnimationFrame(n)}return{start:function(){!0!==t&&null!==r&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(e){r=e},setContext:function(t){e=t}}}function ws(e,t){const r=t.isWebGL2,i=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),i.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);const r=i.get(t);r&&(e.deleteBuffer(r.buffer),i.delete(t))},update:function(t,n){if(t.isGLBufferAttribute){const e=i.get(t);return void((!e||e.version<t.version)&&i.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version}))}t.isInterleavedBufferAttribute&&(t=t.data);const s=i.get(t);void 0===s?i.set(t,function(t,i){const n=t.array,s=t.usage,o=e.createBuffer();let a;if(e.bindBuffer(i,o),e.bufferData(i,n,s),t.onUploadCallback(),n instanceof Float32Array)a=5126;else if(n instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!r)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=5131}else a=5123;else if(n instanceof Int16Array)a=5122;else if(n instanceof Uint32Array)a=5125;else if(n instanceof Int32Array)a=5124;else if(n instanceof Int8Array)a=5120;else if(n instanceof Uint8Array)a=5121;else{if(!(n instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+n);a=5121}return{buffer:o,type:a,bytesPerElement:n.BYTES_PER_ELEMENT,version:t.version}}(t,n)):s.version<t.version&&(!function(t,i,n){const s=i.array,o=i.updateRange;e.bindBuffer(n,t),-1===o.count?e.bufferSubData(n,0,s):(r?e.bufferSubData(n,o.offset*s.BYTES_PER_ELEMENT,s,o.offset,o.count):e.bufferSubData(n,o.offset*s.BYTES_PER_ELEMENT,s.subarray(o.offset,o.offset+o.count)),o.count=-1)}(s.buffer,t,n),s.version=t.version)}}}class xs extends Dn{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const n=e/2,s=t/2,o=Math.floor(r),a=Math.floor(i),l=o+1,c=a+1,u=e/o,h=t/a,d=[],f=[],p=[],m=[];for(let e=0;e<c;e++){const t=e*h-s;for(let r=0;r<l;r++){const i=r*u-n;f.push(i,-t,0),p.push(0,0,1),m.push(r/o),m.push(1-e/a)}}for(let e=0;e<a;e++)for(let t=0;t<o;t++){const r=t+l*e,i=t+l*(e+1),n=t+1+l*(e+1),s=t+1+l*e;d.push(r,i,s),d.push(i,n,s)}this.setIndex(d),this.setAttribute("position",new Cn(f,3)),this.setAttribute("normal",new Cn(p,3)),this.setAttribute("uv",new Cn(m,2))}static fromJSON(e){return new xs(e.width,e.height,e.widthSegments,e.heightSegments)}}const As={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ]\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform vec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tfloat texelIndex = float( vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset );\n\t\t\tfloat y = floor( texelIndex / morphTargetsTextureSize.x );\n\t\t\tfloat x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tvec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );\n\t\t\treturn texture( morphTargetsTexture, morphUV );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Ts={common:{diffuse:{value:new Ur(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Mr},uv2Transform:{value:new Mr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Sr(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ur(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ur(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Mr}},sprite:{diffuse:{value:new Ur(16777215)},opacity:{value:1},center:{value:new Sr(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Mr}}},Ss={basic:{uniforms:ss([Ts.common,Ts.specularmap,Ts.envmap,Ts.aomap,Ts.lightmap,Ts.fog]),vertexShader:As.meshbasic_vert,fragmentShader:As.meshbasic_frag},lambert:{uniforms:ss([Ts.common,Ts.specularmap,Ts.envmap,Ts.aomap,Ts.lightmap,Ts.emissivemap,Ts.fog,Ts.lights,{emissive:{value:new Ur(0)}}]),vertexShader:As.meshlambert_vert,fragmentShader:As.meshlambert_frag},phong:{uniforms:ss([Ts.common,Ts.specularmap,Ts.envmap,Ts.aomap,Ts.lightmap,Ts.emissivemap,Ts.bumpmap,Ts.normalmap,Ts.displacementmap,Ts.fog,Ts.lights,{emissive:{value:new Ur(0)},specular:{value:new Ur(1118481)},shininess:{value:30}}]),vertexShader:As.meshphong_vert,fragmentShader:As.meshphong_frag},standard:{uniforms:ss([Ts.common,Ts.envmap,Ts.aomap,Ts.lightmap,Ts.emissivemap,Ts.bumpmap,Ts.normalmap,Ts.displacementmap,Ts.roughnessmap,Ts.metalnessmap,Ts.fog,Ts.lights,{emissive:{value:new Ur(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:As.meshphysical_vert,fragmentShader:As.meshphysical_frag},toon:{uniforms:ss([Ts.common,Ts.aomap,Ts.lightmap,Ts.emissivemap,Ts.bumpmap,Ts.normalmap,Ts.displacementmap,Ts.gradientmap,Ts.fog,Ts.lights,{emissive:{value:new Ur(0)}}]),vertexShader:As.meshtoon_vert,fragmentShader:As.meshtoon_frag},matcap:{uniforms:ss([Ts.common,Ts.bumpmap,Ts.normalmap,Ts.displacementmap,Ts.fog,{matcap:{value:null}}]),vertexShader:As.meshmatcap_vert,fragmentShader:As.meshmatcap_frag},points:{uniforms:ss([Ts.points,Ts.fog]),vertexShader:As.points_vert,fragmentShader:As.points_frag},dashed:{uniforms:ss([Ts.common,Ts.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:As.linedashed_vert,fragmentShader:As.linedashed_frag},depth:{uniforms:ss([Ts.common,Ts.displacementmap]),vertexShader:As.depth_vert,fragmentShader:As.depth_frag},normal:{uniforms:ss([Ts.common,Ts.bumpmap,Ts.normalmap,Ts.displacementmap,{opacity:{value:1}}]),vertexShader:As.meshnormal_vert,fragmentShader:As.meshnormal_frag},sprite:{uniforms:ss([Ts.sprite,Ts.fog]),vertexShader:As.sprite_vert,fragmentShader:As.sprite_frag},background:{uniforms:{uvTransform:{value:new Mr},t2D:{value:null}},vertexShader:As.background_vert,fragmentShader:As.background_frag},cube:{uniforms:ss([Ts.envmap,{opacity:{value:1}}]),vertexShader:As.cube_vert,fragmentShader:As.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:As.equirect_vert,fragmentShader:As.equirect_frag},distanceRGBA:{uniforms:ss([Ts.common,Ts.displacementmap,{referencePosition:{value:new Qr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:As.distanceRGBA_vert,fragmentShader:As.distanceRGBA_frag},shadow:{uniforms:ss([Ts.lights,Ts.fog,{color:{value:new Ur(0)},opacity:{value:1}}]),vertexShader:As.shadow_vert,fragmentShader:As.shadow_frag}};function Ms(e,t,r,i,n,s){const o=new Ur(0);let a,l,c=!0===n?0:1,u=null,h=0,d=null;function f(e,t){r.buffers.color.setClear(e.r,e.g,e.b,t,s)}return{getClearColor:function(){return o},setClearColor:function(e,t=1){o.set(e),c=t,f(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(e){c=e,f(o,c)},render:function(r,n){let s=!1,g=!0===n.isScene?n.background:null;g&&g.isTexture&&(g=t.get(g));const v=e.xr,_=v.getSession&&v.getSession();_&&"additive"===_.environmentBlendMode&&(g=null),null===g?f(o,c):g&&g.isColor&&(f(g,1),s=!0),(e.autoClear||s)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||g.mapping===ce)?(void 0===l&&(l=new ts(new is(1,1,1),new as({name:"BackgroundCubeMaterial",uniforms:ns(Ss.cube.uniforms),vertexShader:Ss.cube.vertexShader,fragmentShader:Ss.cube.fragmentShader,side:m,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,r){this.matrixWorld.copyPosition(r.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,u===g&&h===g.version&&d===e.toneMapping||(l.material.needsUpdate=!0,u=g,h=g.version,d=e.toneMapping),r.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===a&&(a=new ts(new xs(2,2),new as({name:"BackgroundMaterial",uniforms:ns(Ss.background.uniforms),vertexShader:Ss.background.vertexShader,fragmentShader:Ss.background.fragmentShader,side:p,depthTest:!1,depthWrite:!1,fog:!1})),a.geometry.deleteAttribute("normal"),Object.defineProperty(a.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(a)),a.material.uniforms.t2D.value=g,!0===g.matrixAutoUpdate&&g.updateMatrix(),a.material.uniforms.uvTransform.value.copy(g.matrix),u===g&&h===g.version&&d===e.toneMapping||(a.material.needsUpdate=!0,u=g,h=g.version,d=e.toneMapping),r.unshift(a,a.geometry,a.material,0,0,null))}}}function Cs(e,t,r,i){const n=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),o=i.isWebGL2||null!==s,a={},l=d(null);let c=l;function u(t){return i.isWebGL2?e.bindVertexArray(t):s.bindVertexArrayOES(t)}function h(t){return i.isWebGL2?e.deleteVertexArray(t):s.deleteVertexArrayOES(t)}function d(e){const t=[],r=[],i=[];for(let e=0;e<n;e++)t[e]=0,r[e]=0,i[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:r,attributeDivisors:i,object:e,attributes:{},index:null}}function f(){const e=c.newAttributes;for(let t=0,r=e.length;t<r;t++)e[t]=0}function p(e){m(e,0)}function m(r,n){const s=c.newAttributes,o=c.enabledAttributes,a=c.attributeDivisors;if(s[r]=1,0===o[r]&&(e.enableVertexAttribArray(r),o[r]=1),a[r]!==n){(i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](r,n),a[r]=n}}function g(){const t=c.newAttributes,r=c.enabledAttributes;for(let i=0,n=r.length;i<n;i++)r[i]!==t[i]&&(e.disableVertexAttribArray(i),r[i]=0)}function v(t,r,n,s,o,a){!0!==i.isWebGL2||5124!==n&&5125!==n?e.vertexAttribPointer(t,r,n,s,o,a):e.vertexAttribIPointer(t,r,n,o,a)}function _(){b(),c!==l&&(c=l,u(c.object))}function b(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(n,l,h,_,b){let y=!1;if(o){const t=function(t,r,n){const o=!0===n.wireframe;let l=a[t.id];void 0===l&&(l={},a[t.id]=l);let c=l[r.id];void 0===c&&(c={},l[r.id]=c);let u=c[o];void 0===u&&(u=d(i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()),c[o]=u);return u}(_,h,l);c!==t&&(c=t,u(c.object)),y=function(e,t){const r=c.attributes,i=e.attributes;let n=0;for(const e in i){const t=r[e],s=i[e];if(void 0===t)return!0;if(t.attribute!==s)return!0;if(t.data!==s.data)return!0;n++}return c.attributesNum!==n||c.index!==t}(_,b),y&&function(e,t){const r={},i=e.attributes;let n=0;for(const e in i){const t=i[e],s={};s.attribute=t,t.data&&(s.data=t.data),r[e]=s,n++}c.attributes=r,c.attributesNum=n,c.index=t}(_,b)}else{const e=!0===l.wireframe;c.geometry===_.id&&c.program===h.id&&c.wireframe===e||(c.geometry=_.id,c.program=h.id,c.wireframe=e,y=!0)}!0===n.isInstancedMesh&&(y=!0),null!==b&&r.update(b,34963),y&&(!function(n,s,o,a){if(!1===i.isWebGL2&&(n.isInstancedMesh||a.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();const l=a.attributes,c=o.getAttributes(),u=s.defaultAttributeValues;for(const t in c){const i=c[t];if(i.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&n.instanceMatrix&&(s=n.instanceMatrix),"instanceColor"===t&&n.instanceColor&&(s=n.instanceColor)),void 0!==s){const t=s.normalized,o=s.itemSize,l=r.get(s);if(void 0===l)continue;const c=l.buffer,u=l.type,h=l.bytesPerElement;if(s.isInterleavedBufferAttribute){const r=s.data,l=r.stride,d=s.offset;if(r.isInstancedInterleavedBuffer){for(let e=0;e<i.locationSize;e++)m(i.location+e,r.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=r.meshPerAttribute*r.count)}else for(let e=0;e<i.locationSize;e++)p(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)v(i.location+e,o/i.locationSize,u,t,l*h,(d+o/i.locationSize*e)*h)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<i.locationSize;e++)m(i.location+e,s.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===a._maxInstanceCount&&(a._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<i.locationSize;e++)p(i.location+e);e.bindBuffer(34962,c);for(let e=0;e<i.locationSize;e++)v(i.location+e,o/i.locationSize,u,t,o*h,o/i.locationSize*e*h)}}else if(void 0!==u){const r=u[t];if(void 0!==r)switch(r.length){case 2:e.vertexAttrib2fv(i.location,r);break;case 3:e.vertexAttrib3fv(i.location,r);break;case 4:e.vertexAttrib4fv(i.location,r);break;default:e.vertexAttrib1fv(i.location,r)}}}}g()}(n,l,h,_),null!==b&&e.bindBuffer(34963,r.get(b).buffer))},reset:_,resetDefaultState:b,dispose:function(){_();for(const e in a){const t=a[e];for(const e in t){const r=t[e];for(const e in r)h(r[e].object),delete r[e];delete t[e]}delete a[e]}},releaseStatesOfGeometry:function(e){if(void 0===a[e.id])return;const t=a[e.id];for(const e in t){const r=t[e];for(const e in r)h(r[e].object),delete r[e];delete t[e]}delete a[e.id]},releaseStatesOfProgram:function(e){for(const t in a){const r=a[t];if(void 0===r[e.id])continue;const i=r[e.id];for(const e in i)h(i[e].object),delete i[e];delete r[e.id]}},initAttributes:f,enableAttribute:p,disableUnusedAttributes:g}}function Rs(e,t,r,i){const n=i.isWebGL2;let s;this.setMode=function(e){s=e},this.render=function(t,i){e.drawArrays(s,t,i),r.update(i,s,1)},this.renderInstances=function(i,o,a){if(0===a)return;let l,c;if(n)l=e,c="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),c="drawArraysInstancedANGLE",null===l)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](s,i,o,a),r.update(o,s,a)}}function Is(e,t,r){let i;function n(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext;let o=void 0!==r.precision?r.precision:"highp";const a=n(o);a!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",a,"instead."),o=a);const l=s||t.has("WEBGL_draw_buffers"),c=!0===r.logarithmicDepthBuffer,u=e.getParameter(34930),h=e.getParameter(35660),d=e.getParameter(3379),f=e.getParameter(34076),p=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),v=e.getParameter(36349),_=h>0,b=s||t.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===t.has("EXT_texture_filter_anisotropic")){const r=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:n,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:b,floatVertexTextures:_&&b,maxSamples:s?e.getParameter(36183):0}}function Os(e){const t=this;let r=null,i=0,n=!1,s=!1;const o=new vs,a=new Mr,l={value:null,needsUpdate:!1};function c(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(e,r,i,n){const s=null!==e?e.length:0;let c=null;if(0!==s){if(c=l.value,!0!==n||null===c){const t=i+4*s,n=r.matrixWorldInverse;a.getNormalMatrix(n),(null===c||c.length<t)&&(c=new Float32Array(t));for(let t=0,r=i;t!==s;++t,r+=4)o.copy(e[t]).applyMatrix4(n,a),o.normal.toArray(c,r),c[r+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=s,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,s){const o=0!==e.length||t||0!==i||n;return n=t,r=u(e,s,0),i=e.length,o},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,c()},this.setState=function(t,o,a){const h=t.clippingPlanes,d=t.clipIntersection,f=t.clipShadows,p=e.get(t);if(!n||null===h||0===h.length||s&&!f)s?u(null):c();else{const e=s?0:i,t=4*e;let n=p.clippingState||null;l.value=n,n=u(h,o,t,a);for(let e=0;e!==t;++e)n[e]=r[e];p.clippingState=n,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=e}}}function Ps(e){let t=new WeakMap;function r(e,t){return t===ae?e.mapping=se:t===le&&(e.mapping=oe),e}function i(e){const r=e.target;r.removeEventListener("dispose",i);const n=t.get(r);void 0!==n&&(t.delete(r),n.dispose())}return{get:function(n){if(n&&n.isTexture&&!1===n.isRenderTargetTexture){const s=n.mapping;if(s===ae||s===le){if(t.has(n)){return r(t.get(n).texture,n.mapping)}{const s=n.image;if(s&&s.height>0){const o=new fs(s.height/2);return o.fromEquirectangularTexture(e,n),t.set(n,o),n.addEventListener("dispose",i),r(o.texture,n.mapping)}return null}}}return n},dispose:function(){t=new WeakMap}}}Ss.physical={uniforms:ss([Ss.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Sr(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Ur(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Sr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ur(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ur(1,1,1)},specularColorMap:{value:null}}]),vertexShader:As.meshphysical_vert,fragmentShader:As.meshphysical_frag};class ks extends ls{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let n=r-e,s=r+e,o=i+t,a=i-t;if(null!==this.view&&this.view.enabled){const e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=e*this.view.offsetX,s=n+e*this.view.width,o-=t*this.view.offsetY,a=o-t*this.view.height}this.projectionMatrix.makeOrthographic(n,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}ks.prototype.isOrthographicCamera=!0;const Ls=[.125,.215,.35,.446,.526,.582],Ns=20,Gs=new ks,Ds=new Ur;let Us=null;const Vs=(1+Math.sqrt(5))/2,Bs=1/Vs,Fs=[new Qr(1,1,1),new Qr(-1,1,1),new Qr(1,1,-1),new Qr(-1,1,-1),new Qr(0,Vs,Bs),new Qr(0,Vs,-Bs),new Qr(Bs,0,Vs),new Qr(-Bs,0,Vs),new Qr(Vs,Bs,0),new Qr(-Vs,Bs,0)];class js{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){Us=this._renderer.getRenderTarget(),this._setSize(256);const n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=$s(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Hs(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Us),e.scissorTest=!1,Ws(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===se||e.mapping===oe?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Us=this._renderer.getRenderTarget();const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize-32,r={magFilter:be,minFilter:be,generateMipmaps:!1,type:Oe,format:De,encoding:kt,depthBuffer:!1},i=zs(e,t,r);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=zs(e,t,r);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){const t=[],r=[],i=[];let n=e;const s=e-4+1+Ls.length;for(let o=0;o<s;o++){const s=Math.pow(2,n);r.push(s);let a=1/s;o>e-4?a=Ls[o-e+4-1]:0===o&&(a=0),i.push(a);const l=1/(s-1),c=-l/2,u=1+l/2,h=[c,c,u,c,u,u,c,c,u,u,c,u],d=6,f=6,p=3,m=2,g=1,v=new Float32Array(p*f*d),_=new Float32Array(m*f*d),b=new Float32Array(g*f*d);for(let e=0;e<d;e++){const t=e%3*2/3-1,r=e>2?0:-1,i=[t,r,0,t+2/3,r,0,t+2/3,r+1,0,t,r,0,t+2/3,r+1,0,t,r+1,0];v.set(i,p*f*e),_.set(h,m*f*e);const n=[e,e,e,e,e,e];b.set(n,g*f*e)}const y=new Dn;y.setAttribute("position",new bn(v,p)),y.setAttribute("uv",new bn(_,m)),y.setAttribute("faceIndex",new bn(b,g)),t.push(y),n>4&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}(i)),this._blurMaterial=function(e,t,r){const i=new Float32Array(Ns),n=new Qr(0,1,0);return new as({name:"SphericalGaussianBlur",defines:{n:Ns,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:Ys(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:b,depthTest:!1,depthWrite:!1})}(i,e,t)}return i}_compileMaterial(e){const t=new ts(this._lodPlanes[0],e);this._renderer.compile(t,Gs)}_sceneToCubeUV(e,t,r,i){const n=new cs(90,1,t,r),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(Ds),a.toneMapping=K,a.autoClear=!1;const u=new gn({name:"PMREM.Background",side:m,depthWrite:!1,depthTest:!1}),h=new ts(new is,u);let d=!1;const f=e.background;f?f.isColor&&(u.color.copy(f),e.background=null,d=!0):(u.color.copy(Ds),d=!0);for(let t=0;t<6;t++){const r=t%3;0===r?(n.up.set(0,s[t],0),n.lookAt(o[t],0,0)):1===r?(n.up.set(0,0,s[t]),n.lookAt(0,o[t],0)):(n.up.set(0,s[t],0),n.lookAt(0,0,o[t]));const l=this._cubeSize;Ws(i,r*l,t>2?l:0,l,l),a.setRenderTarget(i),d&&a.render(h,n),a.render(e,n)}h.geometry.dispose(),h.material.dispose(),a.toneMapping=c,a.autoClear=l,e.background=f}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===se||e.mapping===oe;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=$s()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Hs());const n=i?this._cubemapMaterial:this._equirectMaterial,s=new ts(this._lodPlanes[0],n);n.uniforms.envMap.value=e;const o=this._cubeSize;Ws(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,Gs)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let t=1;t<this._lodPlanes.length;t++){const r=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),i=Fs[(t-1)%Fs.length];this._blur(e,t-1,t,r,i)}t.autoClear=r}_blur(e,t,r,i,n){const s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,s,o){const a=this._renderer,l=this._blurMaterial;"latitudinal"!==s&&"longitudinal"!==s&&console.error("blur direction must be either latitudinal or longitudinal!");const c=new ts(this._lodPlanes[i],l),u=l.uniforms,h=this._sizeLods[r]-1,d=isFinite(n)?Math.PI/(2*h):2*Math.PI/39,f=n/d,p=isFinite(n)?1+Math.floor(3*f):Ns;p>Ns&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);const m=[];let g=0;for(let e=0;e<Ns;++e){const t=e/f,r=Math.exp(-t*t/2);m.push(r),0===e?g+=r:e<p&&(g+=2*r)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;u.envMap.value=e.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===s,o&&(u.poleAxis.value=o);const{_lodMax:v}=this;u.dTheta.value=d,u.mipInt.value=v-r;const _=this._sizeLods[i];Ws(t,3*_*(i>v-4?i-v+4:0),4*(this._cubeSize-_),3*_,2*_),a.setRenderTarget(t),a.render(c,Gs)}}function zs(e,t,r){const i=new $r(e,t,r);return i.texture.mapping=ce,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Ws(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function Hs(){return new as({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Ys(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:b,depthTest:!1,depthWrite:!1})}function $s(){return new as({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Ys(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:b,depthTest:!1,depthWrite:!1})}function Ys(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function qs(e){let t=new WeakMap,r=null;function i(e){const r=e.target;r.removeEventListener("dispose",i);const n=t.get(r);void 0!==n&&(t.delete(r),n.dispose())}return{get:function(n){if(n&&n.isTexture){const s=n.mapping,o=s===ae||s===le,a=s===se||s===oe;if(o||a){if(n.isRenderTargetTexture&&!0===n.needsPMREMUpdate){n.needsPMREMUpdate=!1;let i=t.get(n);return null===r&&(r=new js(e)),i=o?r.fromEquirectangular(n,i):r.fromCubemap(n,i),t.set(n,i),i.texture}if(t.has(n))return t.get(n).texture;{const s=n.image;if(o&&s&&s.height>0||a&&s&&function(e){let t=0;const r=6;for(let i=0;i<r;i++)void 0!==e[i]&&t++;return t===r}(s)){null===r&&(r=new js(e));const s=o?r.fromEquirectangular(n):r.fromCubemap(n);return t.set(n,s),n.addEventListener("dispose",i),s.texture}return null}}}return n},dispose:function(){t=new WeakMap,null!==r&&(r.dispose(),r=null)}}}function Xs(e){const t={};function r(r){if(void 0!==t[r])return t[r];let i;switch(r){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(r)}return t[r]=i,i}return{has:function(e){return null!==r(e)},init:function(e){e.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(e){const t=r(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Zs(e,t,r,i){const n={},s=new WeakMap;function o(e){const a=e.target;null!==a.index&&t.remove(a.index);for(const e in a.attributes)t.remove(a.attributes[e]);a.removeEventListener("dispose",o),delete n[a.id];const l=s.get(a);l&&(t.remove(l),s.delete(a)),i.releaseStatesOfGeometry(a),!0===a.isInstancedBufferGeometry&&delete a._maxInstanceCount,r.memory.geometries--}function a(e){const r=[],i=e.index,n=e.attributes.position;let o=0;if(null!==i){const e=i.array;o=i.version;for(let t=0,i=e.length;t<i;t+=3){const i=e[t+0],n=e[t+1],s=e[t+2];r.push(i,n,n,s,s,i)}}else{const e=n.array;o=n.version;for(let t=0,i=e.length/3-1;t<i;t+=3){const e=t+0,i=t+1,n=t+2;r.push(e,i,i,n,n,e)}}const a=new(Cr(r)?Sn:An)(r,1);a.version=o;const l=s.get(e);l&&t.remove(l),s.set(e,a)}return{get:function(e,t){return!0===n[t.id]||(t.addEventListener("dispose",o),n[t.id]=!0,r.memory.geometries++),t},update:function(e){const r=e.attributes;for(const e in r)t.update(r[e],34962);const i=e.morphAttributes;for(const e in i){const r=i[e];for(let e=0,i=r.length;e<i;e++)t.update(r[e],34962)}},getWireframeAttribute:function(e){const t=s.get(e);if(t){const r=e.index;null!==r&&t.version<r.version&&a(e)}else a(e);return s.get(e)}}}function Js(e,t,r,i){const n=i.isWebGL2;let s,o,a;this.setMode=function(e){s=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,i){e.drawElements(s,i,o,t*a),r.update(i,s,1)},this.renderInstances=function(i,l,c){if(0===c)return;let u,h;if(n)u=e,h="drawElementsInstanced";else if(u=t.get("ANGLE_instanced_arrays"),h="drawElementsInstancedANGLE",null===u)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[h](s,l,o,i*a,c),r.update(l,s,c)}}function Ks(e){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,r,i){switch(t.calls++,r){case 4:t.triangles+=i*(e/3);break;case 1:t.lines+=i*(e/2);break;case 3:t.lines+=i*(e-1);break;case 2:t.lines+=i*e;break;case 0:t.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function Qs(e,t){return e[0]-t[0]}function eo(e,t){return Math.abs(t[1])-Math.abs(e[1])}function to(e,t){let r=1;const i=t.isInterleavedBufferAttribute?t.data.array:t.array;i instanceof Int8Array?r=127:i instanceof Int16Array?r=32767:i instanceof Int32Array?r=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),e.divideScalar(r)}function ro(e,t,r){const i={},n=new Float32Array(8),s=new WeakMap,o=new Hr,a=[];for(let e=0;e<8;e++)a[e]=[e,0];return{update:function(l,c,u,h){const d=l.morphTargetInfluences;if(!0===t.isWebGL2){const i=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,n=void 0!==i?i.length:0;let a=s.get(c);if(void 0===a||a.count!==n){void 0!==a&&a.texture.dispose();const e=void 0!==c.morphAttributes.position,r=void 0!==c.morphAttributes.normal,i=void 0!==c.morphAttributes.color,l=c.morphAttributes.position||[],u=c.morphAttributes.normal||[],h=c.morphAttributes.color||[];let d=0;!0===e&&(d=1),!0===r&&(d=2),!0===i&&(d=3);let f=c.attributes.position.count*d,p=1;f>t.maxTextureSize&&(p=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);const m=new Float32Array(f*p*4*n),g=new Yr(m,f,p,n);g.format=De,g.type=Ie,g.needsUpdate=!0;const v=4*d;for(let t=0;t<n;t++){const n=l[t],s=u[t],a=h[t],c=f*p*4*t;for(let t=0;t<n.count;t++){const l=t*v;!0===e&&(o.fromBufferAttribute(n,t),!0===n.normalized&&to(o,n),m[c+l+0]=o.x,m[c+l+1]=o.y,m[c+l+2]=o.z,m[c+l+3]=0),!0===r&&(o.fromBufferAttribute(s,t),!0===s.normalized&&to(o,s),m[c+l+4]=o.x,m[c+l+5]=o.y,m[c+l+6]=o.z,m[c+l+7]=0),!0===i&&(o.fromBufferAttribute(a,t),!0===a.normalized&&to(o,s),m[c+l+8]=o.x,m[c+l+9]=o.y,m[c+l+10]=o.z,m[c+l+11]=4===a.itemSize?o.w:1)}}a={count:n,texture:g,size:new Sr(f,p)},s.set(c,a),c.addEventListener("dispose",(function e(){g.dispose(),s.delete(c),c.removeEventListener("dispose",e)}))}let l=0;for(let e=0;e<d.length;e++)l+=d[e];const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",a.texture,r),h.getUniforms().setValue(e,"morphTargetsTextureSize",a.size)}else{const t=void 0===d?0:d.length;let r=i[c.id];if(void 0===r||r.length!==t){r=[];for(let e=0;e<t;e++)r[e]=[e,0];i[c.id]=r}for(let e=0;e<t;e++){const t=r[e];t[0]=e,t[1]=d[e]}r.sort(eo);for(let e=0;e<8;e++)e<t&&r[e][1]?(a[e][0]=r[e][0],a[e][1]=r[e][1]):(a[e][0]=Number.MAX_SAFE_INTEGER,a[e][1]=0);a.sort(Qs);const s=c.morphAttributes.position,o=c.morphAttributes.normal;let l=0;for(let e=0;e<8;e++){const t=a[e],r=t[0],i=t[1];r!==Number.MAX_SAFE_INTEGER&&i?(s&&c.getAttribute("morphTarget"+e)!==s[r]&&c.setAttribute("morphTarget"+e,s[r]),o&&c.getAttribute("morphNormal"+e)!==o[r]&&c.setAttribute("morphNormal"+e,o[r]),n[e]=i,l+=i):(s&&!0===c.hasAttribute("morphTarget"+e)&&c.deleteAttribute("morphTarget"+e),o&&!0===c.hasAttribute("morphNormal"+e)&&c.deleteAttribute("morphNormal"+e),n[e]=0)}const u=c.morphTargetsRelative?1:1-l;h.getUniforms().setValue(e,"morphTargetBaseInfluence",u),h.getUniforms().setValue(e,"morphTargetInfluences",n)}}}}function io(e,t,r,i){let n=new WeakMap;function s(e){const t=e.target;t.removeEventListener("dispose",s),r.remove(t.instanceMatrix),null!==t.instanceColor&&r.remove(t.instanceColor)}return{update:function(e){const o=i.render.frame,a=e.geometry,l=t.get(e,a);return n.get(l)!==o&&(t.update(l),n.set(l,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",s)&&e.addEventListener("dispose",s),r.update(e.instanceMatrix,34962),null!==e.instanceColor&&r.update(e.instanceColor,34962)),l},dispose:function(){n=new WeakMap}}}const no=new Wr,so=new Yr,oo=new Xr,ao=new ds,lo=[],co=[],uo=new Float32Array(16),ho=new Float32Array(9),fo=new Float32Array(4);function po(e,t,r){const i=e[0];if(i<=0||i>0)return e;const n=t*r;let s=lo[n];if(void 0===s&&(s=new Float32Array(n),lo[n]=s),0!==t){i.toArray(s,0);for(let i=1,n=0;i!==t;++i)n+=r,e[i].toArray(s,n)}return s}function mo(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function go(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function vo(e,t){let r=co[t];void 0===r&&(r=new Int32Array(t),co[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function _o(e,t){const r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function bo(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(mo(r,t))return;e.uniform2fv(this.addr,t),go(r,t)}}function yo(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(void 0!==t.r)r[0]===t.r&&r[1]===t.g&&r[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(mo(r,t))return;e.uniform3fv(this.addr,t),go(r,t)}}function Eo(e,t){const r=this.cache;if(void 0!==t.x)r[0]===t.x&&r[1]===t.y&&r[2]===t.z&&r[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(mo(r,t))return;e.uniform4fv(this.addr,t),go(r,t)}}function wo(e,t){const r=this.cache,i=t.elements;if(void 0===i){if(mo(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),go(r,t)}else{if(mo(r,i))return;fo.set(i),e.uniformMatrix2fv(this.addr,!1,fo),go(r,i)}}function xo(e,t){const r=this.cache,i=t.elements;if(void 0===i){if(mo(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),go(r,t)}else{if(mo(r,i))return;ho.set(i),e.uniformMatrix3fv(this.addr,!1,ho),go(r,i)}}function Ao(e,t){const r=this.cache,i=t.elements;if(void 0===i){if(mo(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),go(r,t)}else{if(mo(r,i))return;uo.set(i),e.uniformMatrix4fv(this.addr,!1,uo),go(r,i)}}function To(e,t){const r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function So(e,t){const r=this.cache;mo(r,t)||(e.uniform2iv(this.addr,t),go(r,t))}function Mo(e,t){const r=this.cache;mo(r,t)||(e.uniform3iv(this.addr,t),go(r,t))}function Co(e,t){const r=this.cache;mo(r,t)||(e.uniform4iv(this.addr,t),go(r,t))}function Ro(e,t){const r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Io(e,t){const r=this.cache;mo(r,t)||(e.uniform2uiv(this.addr,t),go(r,t))}function Oo(e,t){const r=this.cache;mo(r,t)||(e.uniform3uiv(this.addr,t),go(r,t))}function Po(e,t){const r=this.cache;mo(r,t)||(e.uniform4uiv(this.addr,t),go(r,t))}function ko(e,t,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||no,n)}function Lo(e,t,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||oo,n)}function No(e,t,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||ao,n)}function Go(e,t,r){const i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||so,n)}function Do(e,t){e.uniform1fv(this.addr,t)}function Uo(e,t){const r=po(t,this.size,2);e.uniform2fv(this.addr,r)}function Vo(e,t){const r=po(t,this.size,3);e.uniform3fv(this.addr,r)}function Bo(e,t){const r=po(t,this.size,4);e.uniform4fv(this.addr,r)}function Fo(e,t){const r=po(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function jo(e,t){const r=po(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function zo(e,t){const r=po(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function Wo(e,t){e.uniform1iv(this.addr,t)}function Ho(e,t){e.uniform2iv(this.addr,t)}function $o(e,t){e.uniform3iv(this.addr,t)}function Yo(e,t){e.uniform4iv(this.addr,t)}function qo(e,t){e.uniform1uiv(this.addr,t)}function Xo(e,t){e.uniform2uiv(this.addr,t)}function Zo(e,t){e.uniform3uiv(this.addr,t)}function Jo(e,t){e.uniform4uiv(this.addr,t)}function Ko(e,t,r){const i=t.length,n=vo(r,i);e.uniform1iv(this.addr,n);for(let e=0;e!==i;++e)r.setTexture2D(t[e]||no,n[e])}function Qo(e,t,r){const i=t.length,n=vo(r,i);e.uniform1iv(this.addr,n);for(let e=0;e!==i;++e)r.setTexture3D(t[e]||oo,n[e])}function ea(e,t,r){const i=t.length,n=vo(r,i);e.uniform1iv(this.addr,n);for(let e=0;e!==i;++e)r.setTextureCube(t[e]||ao,n[e])}function ta(e,t,r){const i=t.length,n=vo(r,i);e.uniform1iv(this.addr,n);for(let e=0;e!==i;++e)r.setTexture2DArray(t[e]||so,n[e])}function ra(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return _o;case 35664:return bo;case 35665:return yo;case 35666:return Eo;case 35674:return wo;case 35675:return xo;case 35676:return Ao;case 5124:case 35670:return To;case 35667:case 35671:return So;case 35668:case 35672:return Mo;case 35669:case 35673:return Co;case 5125:return Ro;case 36294:return Io;case 36295:return Oo;case 36296:return Po;case 35678:case 36198:case 36298:case 36306:case 35682:return ko;case 35679:case 36299:case 36307:return Lo;case 35680:case 36300:case 36308:case 36293:return No;case 36289:case 36303:case 36311:case 36292:return Go}}(t.type)}function ia(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Do;case 35664:return Uo;case 35665:return Vo;case 35666:return Bo;case 35674:return Fo;case 35675:return jo;case 35676:return zo;case 5124:case 35670:return Wo;case 35667:case 35671:return Ho;case 35668:case 35672:return $o;case 35669:case 35673:return Yo;case 5125:return qo;case 36294:return Xo;case 36295:return Zo;case 36296:return Jo;case 35678:case 36198:case 36298:case 36306:case 35682:return Ko;case 35679:case 36299:case 36307:return Qo;case 35680:case 36300:case 36308:case 36293:return ea;case 36289:case 36303:case 36311:case 36292:return ta}}(t.type)}function na(e){this.id=e,this.seq=[],this.map={}}ia.prototype.updateCache=function(e){const t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),go(t,e)},na.prototype.setValue=function(e,t,r){const i=this.seq;for(let n=0,s=i.length;n!==s;++n){const s=i[n];s.setValue(e,t[s.id],r)}};const sa=/(\w+)(\])?(\[|\.)?/g;function oa(e,t){e.seq.push(t),e.map[t.id]=t}function aa(e,t,r){const i=e.name,n=i.length;for(sa.lastIndex=0;;){const s=sa.exec(i),o=sa.lastIndex;let a=s[1];const l="]"===s[2],c=s[3];if(l&&(a|=0),void 0===c||"["===c&&o+2===n){oa(r,void 0===c?new ra(a,e,t):new ia(a,e,t));break}{let e=r.map[a];void 0===e&&(e=new na(a),oa(r,e)),r=e}}}function la(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){const r=e.getActiveUniform(t,i);aa(r,e.getUniformLocation(t,r.name),this)}}function ca(e,t,r){const i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}la.prototype.setValue=function(e,t,r,i){const n=this.map[t];void 0!==n&&n.setValue(e,r,i)},la.prototype.setOptional=function(e,t,r){const i=t[r];void 0!==i&&this.setValue(e,r,i)},la.upload=function(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){const s=t[n],o=r[s.id];!1!==o.needsUpdate&&s.setValue(e,o.value,i)}},la.seqWithValue=function(e,t){const r=[];for(let i=0,n=e.length;i!==n;++i){const n=e[i];n.id in t&&r.push(n)}return r};let ua=0;function ha(e,t,r){const i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();return i&&""===n?"":r.toUpperCase()+"\n\n"+n+"\n\n"+function(e){const t=e.split("\n");for(let e=0;e<t.length;e++)t[e]=e+1+": "+t[e];return t.join("\n")}(e.getShaderSource(t))}function da(e,t){const r=function(e){switch(e){case kt:return["Linear","( value )"];case Lt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function fa(e,t){let r;switch(t){case Q:r="Linear";break;case ee:r="Reinhard";break;case te:r="OptimizedCineon";break;case re:r="ACESFilmic";break;case ie:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function pa(e){return""!==e}function ma(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function ga(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const va=/^[ \t]*#include +<([\w\d./]+)>/gm;function _a(e){return e.replace(va,ba)}function ba(e,t){const r=As[t];if(void 0===r)throw new Error("Can not resolve #include <"+t+">");return _a(r)}const ya=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Ea=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wa(e){return e.replace(Ea,Aa).replace(ya,xa)}function xa(e,t,r,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Aa(e,t,r,i)}function Aa(e,t,r,i){let n="";for(let e=parseInt(t);e<parseInt(r);e++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return n}function Ta(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Sa(e,t,r,i){const n=e.getContext(),s=r.defines;let o=r.vertexShader,a=r.fragmentShader;const l=function(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===h?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===d?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===f&&(t="SHADOWMAP_TYPE_VSM"),t}(r),c=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case se:case oe:t="ENVMAP_TYPE_CUBE";break;case ce:case ue:t="ENVMAP_TYPE_CUBE_UV"}return t}(r),u=function(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case oe:case ue:t="ENVMAP_MODE_REFRACTION"}return t}(r),p=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case X:t="ENVMAP_BLENDING_MULTIPLY";break;case Z:t="ENVMAP_BLENDING_MIX";break;case J:t="ENVMAP_BLENDING_ADD"}return t}(r),m=function(e){const t=e.envMapCubeUVHeight;if(null===t)return null;const r=Math.log2(t/32+1)+3,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),112)),texelHeight:i,maxMip:r}}(r),g=r.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(pa).join("\n")}(r),v=function(e){const t=[];for(const r in e){const i=e[r];!1!==i&&t.push("#define "+r+" "+i)}return t.join("\n")}(s),_=n.createProgram();let b,y,E=r.glslVersion?"#version "+r.glslVersion+"\n":"";r.isRawShaderMaterial?(b=[v].filter(pa).join("\n"),b.length>0&&(b+="\n"),y=[g,v].filter(pa).join("\n"),y.length>0&&(y+="\n")):(b=[Ta(r),"#define SHADER_NAME "+r.shaderName,v,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+r.maxBones,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.useVertexTexture?"#define BONE_TEXTURE":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&!1===r.flatShading?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(pa).join("\n"),y=[g,Ta(r),"#define SHADER_NAME "+r.shaderName,v,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+c:"",r.envMap?"#define "+u:"",r.envMap?"#define "+p:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==K?"#define TONE_MAPPING":"",r.toneMapping!==K?As.tonemapping_pars_fragment:"",r.toneMapping!==K?fa("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",As.encodings_pars_fragment,da("linearToOutputTexel",r.outputEncoding),r.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(pa).join("\n")),o=_a(o),o=ma(o,r),o=ga(o,r),a=_a(a),a=ma(a,r),a=ga(a,r),o=wa(o),a=wa(a),r.isWebGL2&&!0!==r.isRawShaderMaterial&&(E="#version 300 es\n",b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+b,y=["#define varying in",r.glslVersion===hr?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===hr?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+y);const w=E+y+a,x=ca(n,35633,E+b+o),A=ca(n,35632,w);if(n.attachShader(_,x),n.attachShader(_,A),void 0!==r.index0AttributeName?n.bindAttribLocation(_,0,r.index0AttributeName):!0===r.morphTargets&&n.bindAttribLocation(_,0,"position"),n.linkProgram(_),e.debug.checkShaderErrors){const e=n.getProgramInfoLog(_).trim(),t=n.getShaderInfoLog(x).trim(),r=n.getShaderInfoLog(A).trim();let i=!0,s=!0;if(!1===n.getProgramParameter(_,35714)){i=!1;const t=ha(n,x,"vertex"),r=ha(n,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(_,35715)+"\n\nProgram Info Log: "+e+"\n"+t+"\n"+r)}else""!==e?console.warn("THREE.WebGLProgram: Program Info Log:",e):""!==t&&""!==r||(s=!1);s&&(this.diagnostics={runnable:i,programLog:e,vertexShader:{log:t,prefix:b},fragmentShader:{log:r,prefix:y}})}let T,S;return n.deleteShader(x),n.deleteShader(A),this.getUniforms=function(){return void 0===T&&(T=new la(n,_)),T},this.getAttributes=function(){return void 0===S&&(S=function(e,t){const r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){const i=e.getActiveAttrib(t,n),s=i.name;let o=1;35674===i.type&&(o=2),35675===i.type&&(o=3),35676===i.type&&(o=4),r[s]={type:i.type,location:e.getAttribLocation(t,s),locationSize:o}}return r}(n,_)),S},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(_),this.program=void 0},this.name=r.shaderName,this.id=ua++,this.cacheKey=t,this.usedTimes=1,this.program=_,this.vertexShader=x,this.fragmentShader=A,this}let Ma=0;class Ca{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(n)&&(s.add(n),n.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const r=new Ra;t.set(e,r)}return t.get(e)}}class Ra{constructor(){this.id=Ma++,this.usedTimes=0}}function Ia(e,t,r,i,n,s,o){const a=new Fi,l=new Ca,c=[],u=n.isWebGL2,h=n.logarithmicDepthBuffer,d=n.floatVertexTextures,f=n.maxVertexUniforms,p=n.vertexTextures;let v=n.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(s,a,c,b,E){const w=b.fog,x=E.geometry,A=s.isMeshStandardMaterial?b.environment:null,T=(s.isMeshStandardMaterial?r:t).get(s.envMap||A),S=!T||T.mapping!==ce&&T.mapping!==ue?null:T.image.height,M=_[s.type],C=E.isSkinnedMesh?function(e){const t=e.skeleton.bones;if(d)return 1024;{const e=f,r=Math.floor((e-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}}(E):0;null!==s.precision&&(v=n.getMaxPrecision(s.precision),v!==s.precision&&console.warn("THREE.WebGLProgram.getParameters:",s.precision,"not supported, using",v,"instead."));const R=x.morphAttributes.position||x.morphAttributes.normal||x.morphAttributes.color,I=void 0!==R?R.length:0;let O,P,k,L,N=0;if(void 0!==x.morphAttributes.position&&(N=1),void 0!==x.morphAttributes.normal&&(N=2),void 0!==x.morphAttributes.color&&(N=3),M){const e=Ss[M];O=e.vertexShader,P=e.fragmentShader}else O=s.vertexShader,P=s.fragmentShader,l.update(s),k=l.getVertexShaderID(s),L=l.getFragmentShaderID(s);const G=e.getRenderTarget(),D=s.alphaTest>0,U=s.clearcoat>0;return{isWebGL2:u,shaderID:M,shaderName:s.type,vertexShader:O,fragmentShader:P,defines:s.defines,customVertexShaderID:k,customFragmentShaderID:L,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:v,instancing:!0===E.isInstancedMesh,instancingColor:!0===E.isInstancedMesh&&null!==E.instanceColor,supportsVertexTextures:p,outputEncoding:null===G?e.outputEncoding:!0===G.isXRRenderTarget?G.texture.encoding:kt,map:!!s.map,matcap:!!s.matcap,envMap:!!T,envMapMode:T&&T.mapping,envMapCubeUVHeight:S,lightMap:!!s.lightMap,aoMap:!!s.aoMap,emissiveMap:!!s.emissiveMap,bumpMap:!!s.bumpMap,normalMap:!!s.normalMap,objectSpaceNormalMap:s.normalMapType===Ut,tangentSpaceNormalMap:s.normalMapType===Dt,decodeVideoTexture:!!s.map&&!0===s.map.isVideoTexture&&s.map.encoding===Lt,clearcoat:U,clearcoatMap:U&&!!s.clearcoatMap,clearcoatRoughnessMap:U&&!!s.clearcoatRoughnessMap,clearcoatNormalMap:U&&!!s.clearcoatNormalMap,displacementMap:!!s.displacementMap,roughnessMap:!!s.roughnessMap,metalnessMap:!!s.metalnessMap,specularMap:!!s.specularMap,specularIntensityMap:!!s.specularIntensityMap,specularColorMap:!!s.specularColorMap,opaque:!1===s.transparent&&s.blending===y,alphaMap:!!s.alphaMap,alphaTest:D,gradientMap:!!s.gradientMap,sheen:s.sheen>0,sheenColorMap:!!s.sheenColorMap,sheenRoughnessMap:!!s.sheenRoughnessMap,transmission:s.transmission>0,transmissionMap:!!s.transmissionMap,thicknessMap:!!s.thicknessMap,combine:s.combine,vertexTangents:!!s.normalMap&&!!x.attributes.tangent,vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!x.attributes.color&&4===x.attributes.color.itemSize,vertexUvs:!!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatMap||s.clearcoatRoughnessMap||s.clearcoatNormalMap||s.displacementMap||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheenColorMap||s.sheenRoughnessMap),uvsVertexOnly:!(s.map||s.bumpMap||s.normalMap||s.specularMap||s.alphaMap||s.emissiveMap||s.roughnessMap||s.metalnessMap||s.clearcoatNormalMap||s.transmission>0||s.transmissionMap||s.thicknessMap||s.specularIntensityMap||s.specularColorMap||s.sheen>0||s.sheenColorMap||s.sheenRoughnessMap||!s.displacementMap),fog:!!w,useFog:s.fog,fogExp2:w&&w.isFogExp2,flatShading:!!s.flatShading,sizeAttenuation:s.sizeAttenuation,logarithmicDepthBuffer:h,skinning:!0===E.isSkinnedMesh&&C>0,maxBones:C,useVertexTexture:d,morphTargets:void 0!==x.morphAttributes.position,morphNormals:void 0!==x.morphAttributes.normal,morphColors:void 0!==x.morphAttributes.color,morphTargetsCount:I,morphTextureStride:N,numDirLights:a.directional.length,numPointLights:a.point.length,numSpotLights:a.spot.length,numRectAreaLights:a.rectArea.length,numHemiLights:a.hemi.length,numDirLightShadows:a.directionalShadowMap.length,numPointLightShadows:a.pointShadowMap.length,numSpotLightShadows:a.spotShadowMap.length,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:s.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:s.toneMapped?e.toneMapping:K,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:s.premultipliedAlpha,doubleSided:s.side===g,flipSided:s.side===m,depthPacking:void 0!==s.depthPacking&&s.depthPacking,index0AttributeName:s.index0AttributeName,extensionDerivatives:s.extensions&&s.extensions.derivatives,extensionFragDepth:s.extensions&&s.extensions.fragDepth,extensionDrawBuffers:s.extensions&&s.extensions.drawBuffers,extensionShaderTextureLOD:s.extensions&&s.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:s.customProgramCacheKey()}},getProgramCacheKey:function(t){const r=[];if(t.shaderID?r.push(t.shaderID):(r.push(t.customVertexShaderID),r.push(t.customFragmentShaderID)),void 0!==t.defines)for(const e in t.defines)r.push(e),r.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputEncoding),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.combine),e.push(t.vertexUvs),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.maxBones),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection)}(r,t),function(e,t){a.disableAll(),t.isWebGL2&&a.enable(0);t.supportsVertexTextures&&a.enable(1);t.instancing&&a.enable(2);t.instancingColor&&a.enable(3);t.map&&a.enable(4);t.matcap&&a.enable(5);t.envMap&&a.enable(6);t.lightMap&&a.enable(7);t.aoMap&&a.enable(8);t.emissiveMap&&a.enable(9);t.bumpMap&&a.enable(10);t.normalMap&&a.enable(11);t.objectSpaceNormalMap&&a.enable(12);t.tangentSpaceNormalMap&&a.enable(13);t.clearcoat&&a.enable(14);t.clearcoatMap&&a.enable(15);t.clearcoatRoughnessMap&&a.enable(16);t.clearcoatNormalMap&&a.enable(17);t.displacementMap&&a.enable(18);t.specularMap&&a.enable(19);t.roughnessMap&&a.enable(20);t.metalnessMap&&a.enable(21);t.gradientMap&&a.enable(22);t.alphaMap&&a.enable(23);t.alphaTest&&a.enable(24);t.vertexColors&&a.enable(25);t.vertexAlphas&&a.enable(26);t.vertexUvs&&a.enable(27);t.vertexTangents&&a.enable(28);t.uvsVertexOnly&&a.enable(29);t.fog&&a.enable(30);e.push(a.mask),a.disableAll(),t.useFog&&a.enable(0);t.flatShading&&a.enable(1);t.logarithmicDepthBuffer&&a.enable(2);t.skinning&&a.enable(3);t.useVertexTexture&&a.enable(4);t.morphTargets&&a.enable(5);t.morphNormals&&a.enable(6);t.morphColors&&a.enable(7);t.premultipliedAlpha&&a.enable(8);t.shadowMapEnabled&&a.enable(9);t.physicallyCorrectLights&&a.enable(10);t.doubleSided&&a.enable(11);t.flipSided&&a.enable(12);t.depthPacking&&a.enable(13);t.dithering&&a.enable(14);t.specularIntensityMap&&a.enable(15);t.specularColorMap&&a.enable(16);t.transmission&&a.enable(17);t.transmissionMap&&a.enable(18);t.thicknessMap&&a.enable(19);t.sheen&&a.enable(20);t.sheenColorMap&&a.enable(21);t.sheenRoughnessMap&&a.enable(22);t.decodeVideoTexture&&a.enable(23);t.opaque&&a.enable(24);e.push(a.mask)}(r,t),r.push(e.outputEncoding)),r.push(t.customProgramCacheKey),r.join()},getUniforms:function(e){const t=_[e.type];let r;if(t){const e=Ss[t];r=os.clone(e.uniforms)}else r=e.uniforms;return r},acquireProgram:function(t,r){let i;for(let e=0,t=c.length;e<t;e++){const t=c[e];if(t.cacheKey===r){i=t,++i.usedTimes;break}}return void 0===i&&(i=new Sa(e,r,t,s),c.push(i)),i},releaseProgram:function(e){if(0==--e.usedTimes){const t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function Oa(){let e=new WeakMap;return{get:function(t){let r=e.get(t);return void 0===r&&(r={},e.set(t,r)),r},remove:function(t){e.delete(t)},update:function(t,r,i){e.get(t)[r]=i},dispose:function(){e=new WeakMap}}}function Pa(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ka(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function La(){const e=[];let t=0;const r=[],i=[],n=[];function s(r,i,n,s,o,a){let l=e[t];return void 0===l?(l={id:r.id,object:r,geometry:i,material:n,groupOrder:s,renderOrder:r.renderOrder,z:o,group:a},e[t]=l):(l.id=r.id,l.object=r,l.geometry=i,l.material=n,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=o,l.group=a),t++,l}return{opaque:r,transmissive:i,transparent:n,init:function(){t=0,r.length=0,i.length=0,n.length=0},push:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.push(u):!0===o.transparent?n.push(u):r.push(u)},unshift:function(e,t,o,a,l,c){const u=s(e,t,o,a,l,c);o.transmission>0?i.unshift(u):!0===o.transparent?n.unshift(u):r.unshift(u)},finish:function(){for(let r=t,i=e.length;r<i;r++){const t=e[r];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Pa),i.length>1&&i.sort(t||ka),n.length>1&&n.sort(t||ka)}}}function Na(){let e=new WeakMap;return{get:function(t,r){let i;return!1===e.has(t)?(i=new La,e.set(t,[i])):r>=e.get(t).length?(i=new La,e.get(t).push(i)):i=e.get(t)[r],i},dispose:function(){e=new WeakMap}}}function Ga(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new Qr,color:new Ur};break;case"SpotLight":r={position:new Qr,direction:new Qr,color:new Ur,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new Qr,color:new Ur,distance:0,decay:0};break;case"HemisphereLight":r={direction:new Qr,skyColor:new Ur,groundColor:new Ur};break;case"RectAreaLight":r={color:new Ur,position:new Qr,halfWidth:new Qr,halfHeight:new Qr}}return e[t.id]=r,r}}}let Da=0;function Ua(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Va(e,t){const r=new Ga,i=function(){const e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];let r;switch(t.type){case"DirectionalLight":case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Sr};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Sr,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=r,r}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let e=0;e<9;e++)n.probe.push(new Qr);const s=new Qr,o=new Ii,a=new Ii;return{setup:function(s,o){let a=0,l=0,c=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let u=0,h=0,d=0,f=0,p=0,m=0,g=0,v=0;s.sort(Ua);const _=!0!==o?Math.PI:1;for(let e=0,t=s.length;e<t;e++){const t=s[e],o=t.color,b=t.intensity,y=t.distance,E=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)a+=o.r*b*_,l+=o.g*b*_,c+=o.b*b*_;else if(t.isLightProbe)for(let e=0;e<9;e++)n.probe[e].addScaledVector(t.sh.coefficients[e],b);else if(t.isDirectionalLight){const e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),t.castShadow){const e=t.shadow,r=i.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,n.directionalShadow[u]=r,n.directionalShadowMap[u]=E,n.directionalShadowMatrix[u]=t.shadow.matrix,m++}n.directional[u]=e,u++}else if(t.isSpotLight){const e=r.get(t);if(e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(o).multiplyScalar(b*_),e.distance=y,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,t.castShadow){const e=t.shadow,r=i.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,n.spotShadow[d]=r,n.spotShadowMap[d]=E,n.spotShadowMatrix[d]=t.shadow.matrix,v++}n.spot[d]=e,d++}else if(t.isRectAreaLight){const e=r.get(t);e.color.copy(o).multiplyScalar(b),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),n.rectArea[f]=e,f++}else if(t.isPointLight){const e=r.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),e.distance=t.distance,e.decay=t.decay,t.castShadow){const e=t.shadow,r=i.get(t);r.shadowBias=e.bias,r.shadowNormalBias=e.normalBias,r.shadowRadius=e.radius,r.shadowMapSize=e.mapSize,r.shadowCameraNear=e.camera.near,r.shadowCameraFar=e.camera.far,n.pointShadow[h]=r,n.pointShadowMap[h]=E,n.pointShadowMatrix[h]=t.shadow.matrix,g++}n.point[h]=e,h++}else if(t.isHemisphereLight){const e=r.get(t);e.skyColor.copy(t.color).multiplyScalar(b*_),e.groundColor.copy(t.groundColor).multiplyScalar(b*_),n.hemi[p]=e,p++}}f>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(n.rectAreaLTC1=Ts.LTC_FLOAT_1,n.rectAreaLTC2=Ts.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(n.rectAreaLTC1=Ts.LTC_HALF_1,n.rectAreaLTC2=Ts.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=a,n.ambient[1]=l,n.ambient[2]=c;const b=n.hash;b.directionalLength===u&&b.pointLength===h&&b.spotLength===d&&b.rectAreaLength===f&&b.hemiLength===p&&b.numDirectionalShadows===m&&b.numPointShadows===g&&b.numSpotShadows===v||(n.directional.length=u,n.spot.length=d,n.rectArea.length=f,n.point.length=h,n.hemi.length=p,n.directionalShadow.length=m,n.directionalShadowMap.length=m,n.pointShadow.length=g,n.pointShadowMap.length=g,n.spotShadow.length=v,n.spotShadowMap.length=v,n.directionalShadowMatrix.length=m,n.pointShadowMatrix.length=g,n.spotShadowMatrix.length=v,b.directionalLength=u,b.pointLength=h,b.spotLength=d,b.rectAreaLength=f,b.hemiLength=p,b.numDirectionalShadows=m,b.numPointShadows=g,b.numSpotShadows=v,n.version=Da++)},setupView:function(e,t){let r=0,i=0,l=0,c=0,u=0;const h=t.matrixWorldInverse;for(let t=0,d=e.length;t<d;t++){const d=e[t];if(d.isDirectionalLight){const e=n.directional[r];e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),r++}else if(d.isSpotLight){const e=n.spot[l];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),e.direction.setFromMatrixPosition(d.matrixWorld),s.setFromMatrixPosition(d.target.matrixWorld),e.direction.sub(s),e.direction.transformDirection(h),l++}else if(d.isRectAreaLight){const e=n.rectArea[c];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),a.identity(),o.copy(d.matrixWorld),o.premultiply(h),a.extractRotation(o),e.halfWidth.set(.5*d.width,0,0),e.halfHeight.set(0,.5*d.height,0),e.halfWidth.applyMatrix4(a),e.halfHeight.applyMatrix4(a),c++}else if(d.isPointLight){const e=n.point[i];e.position.setFromMatrixPosition(d.matrixWorld),e.position.applyMatrix4(h),i++}else if(d.isHemisphereLight){const e=n.hemi[u];e.direction.setFromMatrixPosition(d.matrixWorld),e.direction.transformDirection(h),e.direction.normalize(),u++}}},state:n}}function Ba(e,t){const r=new Va(e,t),i=[],n=[];return{init:function(){i.length=0,n.length=0},state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:function(e){r.setup(i,e)},setupLightsView:function(e){r.setupView(i,e)},pushLight:function(e){i.push(e)},pushShadow:function(e){n.push(e)}}}function Fa(e,t){let r=new WeakMap;return{get:function(i,n=0){let s;return!1===r.has(i)?(s=new Ba(e,t),r.set(i,[s])):n>=r.get(i).length?(s=new Ba(e,t),r.get(i).push(s)):s=r.get(i)[n],s},dispose:function(){r=new WeakMap}}}class ja extends mn{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=Nt,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}ja.prototype.isMeshDepthMaterial=!0;class za extends mn{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Qr,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}za.prototype.isMeshDistanceMaterial=!0;function Wa(e,t,r){let i=new ys;const n=new Sr,s=new Sr,o=new Hr,a=new ja({depthPacking:Gt}),l=new za,c={},u=r.maxTextureSize,d={0:m,1:p,2:g},v=new as({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Sr},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),_=v.clone();_.defines.HORIZONTAL_PASS=1;const y=new Dn;y.setAttribute("position",new bn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new ts(y,v),w=this;function x(r,i){const n=t.update(E);v.defines.VSM_SAMPLES!==r.blurSamples&&(v.defines.VSM_SAMPLES=r.blurSamples,_.defines.VSM_SAMPLES=r.blurSamples,v.needsUpdate=!0,_.needsUpdate=!0),v.uniforms.shadow_pass.value=r.map.texture,v.uniforms.resolution.value=r.mapSize,v.uniforms.radius.value=r.radius,e.setRenderTarget(r.mapPass),e.clear(),e.renderBufferDirect(i,null,n,v,E,null),_.uniforms.shadow_pass.value=r.mapPass.texture,_.uniforms.resolution.value=r.mapSize,_.uniforms.radius.value=r.radius,e.setRenderTarget(r.map),e.clear(),e.renderBufferDirect(i,null,n,_,E,null)}function A(t,r,i,n,s,o){let u=null;const h=!0===i.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(u=void 0!==h?h:!0===i.isPointLight?l:a,e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length||r.displacementMap&&0!==r.displacementScale||r.alphaMap&&r.alphaTest>0){const e=u.uuid,t=r.uuid;let i=c[e];void 0===i&&(i={},c[e]=i);let n=i[t];void 0===n&&(n=u.clone(),i[t]=n),u=n}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=o===f?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:d[r.side],u.alphaMap=r.alphaMap,u.alphaTest=r.alphaTest,u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.displacementMap=r.displacementMap,u.displacementScale=r.displacementScale,u.displacementBias=r.displacementBias,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,!0===i.isPointLight&&!0===u.isMeshDistanceMaterial&&(u.referencePosition.setFromMatrixPosition(i.matrixWorld),u.nearDistance=n,u.farDistance=s),u}function T(r,n,s,o,a){if(!1===r.visible)return;if(r.layers.test(n.layers)&&(r.isMesh||r.isLine||r.isPoints)&&(r.castShadow||r.receiveShadow&&a===f)&&(!r.frustumCulled||i.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,r.matrixWorld);const i=t.update(r),n=r.material;if(Array.isArray(n)){const t=i.groups;for(let l=0,c=t.length;l<c;l++){const c=t[l],u=n[c.materialIndex];if(u&&u.visible){const t=A(r,u,o,s.near,s.far,a);e.renderBufferDirect(s,null,i,t,r,c)}}}else if(n.visible){const t=A(r,n,o,s.near,s.far,a);e.renderBufferDirect(s,null,i,t,r,null)}}const l=r.children;for(let e=0,t=l.length;e<t;e++)T(l[e],n,s,o,a)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=h,this.render=function(t,r,a){if(!1===w.enabled)return;if(!1===w.autoUpdate&&!1===w.needsUpdate)return;if(0===t.length)return;const l=e.getRenderTarget(),c=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),d=e.state;d.setBlending(b),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(let l=0,c=t.length;l<c;l++){const c=t[l],h=c.shadow;if(void 0===h){console.warn("THREE.WebGLShadowMap:",c,"has no shadow.");continue}if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;n.copy(h.mapSize);const p=h.getFrameExtents();if(n.multiply(p),s.copy(h.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(s.x=Math.floor(u/p.x),n.x=s.x*p.x,h.mapSize.x=s.x),n.y>u&&(s.y=Math.floor(u/p.y),n.y=s.y*p.y,h.mapSize.y=s.y)),null===h.map&&!h.isPointLightShadow&&this.type===f){const e={minFilter:be,magFilter:be,format:De};h.map=new $r(n.x,n.y,e),h.map.texture.name=c.name+".shadowMap",h.mapPass=new $r(n.x,n.y,e),h.camera.updateProjectionMatrix()}if(null===h.map){const e={minFilter:pe,magFilter:pe,format:De};h.map=new $r(n.x,n.y,e),h.map.texture.name=c.name+".shadowMap",h.camera.updateProjectionMatrix()}e.setRenderTarget(h.map),e.clear();const m=h.getViewportCount();for(let e=0;e<m;e++){const t=h.getViewport(e);o.set(s.x*t.x,s.y*t.y,s.x*t.z,s.y*t.w),d.viewport(o),h.updateMatrices(c,e),i=h.getFrustum(),T(r,a,h.camera,c,this.type)}h.isPointLightShadow||this.type!==f||x(h,a),h.needsUpdate=!1}w.needsUpdate=!1,e.setRenderTarget(l,c,h)}}function Ha(e,t,r){const i=r.isWebGL2;const n=new function(){let t=!1;const r=new Hr;let i=null;const n=new Hr(0,0,0,0);return{setMask:function(r){i===r||t||(e.colorMask(r,r,r,r),i=r)},setLocked:function(e){t=e},setClear:function(t,i,s,o,a){!0===a&&(t*=o,i*=o,s*=o),r.set(t,i,s,o),!1===n.equals(r)&&(e.clearColor(t,i,s,o),n.copy(r))},reset:function(){t=!1,i=null,n.set(-1,0,0,0)}}},s=new function(){let t=!1,r=null,i=null,n=null;return{setTest:function(e){e?be(2929):ye(2929)},setMask:function(i){r===i||t||(e.depthMask(i),r=i)},setFunc:function(t){if(i!==t){if(t)switch(t){case F:e.depthFunc(512);break;case j:e.depthFunc(519);break;case z:e.depthFunc(513);break;case W:e.depthFunc(515);break;case H:e.depthFunc(514);break;case $:e.depthFunc(518);break;case Y:e.depthFunc(516);break;case q:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);i=t}},setLocked:function(e){t=e},setClear:function(t){n!==t&&(e.clearDepth(t),n=t)},reset:function(){t=!1,r=null,i=null,n=null}}},c=new function(){let t=!1,r=null,i=null,n=null,s=null,o=null,a=null,l=null,c=null;return{setTest:function(e){t||(e?be(2960):ye(2960))},setMask:function(i){r===i||t||(e.stencilMask(i),r=i)},setFunc:function(t,r,o){i===t&&n===r&&s===o||(e.stencilFunc(t,r,o),i=t,n=r,s=o)},setOp:function(t,r,i){o===t&&a===r&&l===i||(e.stencilOp(t,r,i),o=t,a=r,l=i)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,r=null,i=null,n=null,s=null,o=null,a=null,l=null,c=null}}};let u={},h={},d=new WeakMap,f=[],p=null,v=!1,_=null,X=null,Z=null,J=null,K=null,Q=null,ee=null,te=!1,re=null,ie=null,ne=null,se=null,oe=null;const ae=e.getParameter(35661);let le=!1,ce=0;const ue=e.getParameter(7938);-1!==ue.indexOf("WebGL")?(ce=parseFloat(/^WebGL (\d)/.exec(ue)[1]),le=ce>=1):-1!==ue.indexOf("OpenGL ES")&&(ce=parseFloat(/^OpenGL ES (\d)/.exec(ue)[1]),le=ce>=2);let he=null,de={};const fe=e.getParameter(3088),pe=e.getParameter(2978),me=(new Hr).fromArray(fe),ge=(new Hr).fromArray(pe);function ve(t,r,i){const n=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(let t=0;t<i;t++)e.texImage2D(r+t,0,6408,1,1,0,6408,5121,n);return s}const _e={};function be(t){!0!==u[t]&&(e.enable(t),u[t]=!0)}function ye(t){!1!==u[t]&&(e.disable(t),u[t]=!1)}_e[3553]=ve(3553,3553,1),_e[34067]=ve(34067,34069,6),n.setClear(0,0,0,1),s.setClear(1),c.setClear(0),be(2929),s.setFunc(W),Ae(!1),Te(a),be(2884),xe(b);const Ee={[T]:32774,[S]:32778,[M]:32779};if(i)Ee[C]=32775,Ee[R]=32776;else{const e=t.get("EXT_blend_minmax");null!==e&&(Ee[C]=e.MIN_EXT,Ee[R]=e.MAX_EXT)}const we={[I]:0,[O]:1,[P]:768,[L]:770,[B]:776,[U]:774,[G]:772,[k]:769,[N]:771,[V]:775,[D]:773};function xe(t,r,i,n,s,o,a,l){if(t!==b){if(!1===v&&(be(3042),v=!0),t===A)s=s||r,o=o||i,a=a||n,r===X&&s===K||(e.blendEquationSeparate(Ee[r],Ee[s]),X=r,K=s),i===Z&&n===J&&o===Q&&a===ee||(e.blendFuncSeparate(we[i],we[n],we[o],we[a]),Z=i,J=n,Q=o,ee=a),_=t,te=null;else if(t!==_||l!==te){if(X===T&&K===T||(e.blendEquation(32774),X=T,K=T),l)switch(t){case y:e.blendFuncSeparate(1,771,1,771);break;case E:e.blendFunc(1,1);break;case w:e.blendFuncSeparate(0,769,0,1);break;case x:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case y:e.blendFuncSeparate(770,771,1,771);break;case E:e.blendFunc(770,1);break;case w:e.blendFuncSeparate(0,769,0,1);break;case x:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}Z=null,J=null,Q=null,ee=null,_=t,te=l}}else!0===v&&(ye(3042),v=!1)}function Ae(t){re!==t&&(t?e.frontFace(2304):e.frontFace(2305),re=t)}function Te(t){t!==o?(be(2884),t!==ie&&(t===a?e.cullFace(1029):t===l?e.cullFace(1028):e.cullFace(1032))):ye(2884),ie=t}function Se(t,r,i){t?(be(32823),se===r&&oe===i||(e.polygonOffset(r,i),se=r,oe=i)):ye(32823)}function Me(t){void 0===t&&(t=33984+ae-1),he!==t&&(e.activeTexture(t),he=t)}return{buffers:{color:n,depth:s,stencil:c},enable:be,disable:ye,bindFramebuffer:function(t,r){return h[t]!==r&&(e.bindFramebuffer(t,r),h[t]=r,i&&(36009===t&&(h[36160]=r),36160===t&&(h[36009]=r)),!0)},drawBuffers:function(i,n){let s=f,o=!1;if(i)if(s=d.get(n),void 0===s&&(s=[],d.set(n,s)),i.isWebGLMultipleRenderTargets){const e=i.texture;if(s.length!==e.length||36064!==s[0]){for(let t=0,r=e.length;t<r;t++)s[t]=36064+t;s.length=e.length,o=!0}}else 36064!==s[0]&&(s[0]=36064,o=!0);else 1029!==s[0]&&(s[0]=1029,o=!0);o&&(r.isWebGL2?e.drawBuffers(s):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:xe,setMaterial:function(e,t){e.side===g?ye(2884):be(2884);let r=e.side===m;t&&(r=!r),Ae(r),e.blending===y&&!1===e.transparent?xe(b):xe(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),n.setMask(e.colorWrite);const i=e.stencilWrite;c.setTest(i),i&&(c.setMask(e.stencilWriteMask),c.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),c.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Se(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?be(32926):ye(32926)},setFlipSided:Ae,setCullFace:Te,setLineWidth:function(t){t!==ne&&(le&&e.lineWidth(t),ne=t)},setPolygonOffset:Se,setScissorTest:function(e){e?be(3089):ye(3089)},activeTexture:Me,bindTexture:function(t,r){null===he&&Me();let i=de[he];void 0===i&&(i={type:void 0,texture:void 0},de[he]=i),i.type===t&&i.texture===r||(e.bindTexture(t,r||_e[t]),i.type=t,i.texture=r)},unbindTexture:function(){const t=de[he];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===me.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),me.copy(t))},viewport:function(t){!1===ge.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ge.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===i&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},he=null,de={},h={},d=new WeakMap,f=[],p=null,v=!1,_=null,X=null,Z=null,J=null,K=null,Q=null,ee=null,te=!1,re=null,ie=null,ne=null,se=null,oe=null,me.set(0,0,e.canvas.width,e.canvas.height),ge.set(0,0,e.canvas.width,e.canvas.height),n.reset(),s.reset(),c.reset()}}}function $a(e,t,r,i,n,s,o){const a=n.isWebGL2,l=n.maxTextures,c=n.maxCubemapSize,u=n.maxTextureSize,h=n.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=new WeakMap;let p;const m=new WeakMap;let g=!1;try{g="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function v(e,t){return g?new OffscreenCanvas(e,t):Or("canvas")}function _(e,t,r,i){let n=1;if((e.width>i||e.height>i)&&(n=i/Math.max(e.width,e.height)),n<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const i=t?Ar:Math.floor,s=i(n*e.width),o=i(n*e.height);void 0===p&&(p=v(s,o));const a=r?v(s,o):p;a.width=s,a.height=o;return a.getContext("2d").drawImage(e,0,0,s,o),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+s+"x"+o+")."),a}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function b(e){return wr(e.width)&&wr(e.height)}function y(e,t){return e.generateMipmaps&&t&&e.minFilter!==pe&&e.minFilter!==be}function E(t){e.generateMipmap(t)}function w(r,i,n,s,o=!1){if(!1===a)return i;if(null!==r){if(void 0!==e[r])return e[r];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+r+"'")}let l=i;return 6403===i&&(5126===n&&(l=33326),5131===n&&(l=33325),5121===n&&(l=33321)),33319===i&&(5126===n&&(l=33328),5131===n&&(l=33327),5121===n&&(l=33323)),6408===i&&(5126===n&&(l=34836),5131===n&&(l=34842),5121===n&&(l=s===Lt&&!1===o?35907:32856),32819===n&&(l=32854),32820===n&&(l=32855)),33325!==l&&33326!==l&&33327!==l&&33328!==l&&34842!==l&&34836!==l||t.get("EXT_color_buffer_float"),l}function x(e,t,r){return!0===y(e,r)||e.isFramebufferTexture&&e.minFilter!==pe&&e.minFilter!==be?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function A(e){return e===pe||e===me||e===ve?9728:9729}function T(e){const t=e.target;t.removeEventListener("dispose",T),function(e){const t=i.get(e);if(void 0===t.__webglInit)return;const r=e.source,n=m.get(r);if(n){const i=n[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&M(e),0===Object.keys(n).length&&m.delete(r)}i.remove(e)}(t),t.isVideoTexture&&f.delete(t)}function S(t){const r=t.target;r.removeEventListener("dispose",S),function(t){const r=t.texture,n=i.get(t),s=i.get(r);void 0!==s.__webglTexture&&(e.deleteTexture(s.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer&&e.deleteRenderbuffer(n.__webglColorRenderbuffer),n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer);if(t.isWebGLMultipleRenderTargets)for(let t=0,n=r.length;t<n;t++){const n=i.get(r[t]);n.__webglTexture&&(e.deleteTexture(n.__webglTexture),o.memory.textures--),i.remove(r[t])}i.remove(r),i.remove(t)}(r)}function M(t){const r=i.get(t);e.deleteTexture(r.__webglTexture);const n=t.source;delete m.get(n)[r.__cacheKey],o.memory.textures--}let C=0;function R(e,t){const n=i.get(e);if(e.isVideoTexture&&function(e){const t=o.render.frame;f.get(e)!==t&&(f.set(e,t),e.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&n.__version!==e.version){const r=e.image;if(null===r)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==r.complete)return void L(n,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}r.activeTexture(33984+t),r.bindTexture(3553,n.__webglTexture)}const I={[he]:10497,[de]:33071,[fe]:33648},O={[pe]:9728,[me]:9984,[ve]:9986,[be]:9729,[ye]:9985,[we]:9987};function P(r,s,o){if(o?(e.texParameteri(r,10242,I[s.wrapS]),e.texParameteri(r,10243,I[s.wrapT]),32879!==r&&35866!==r||e.texParameteri(r,32882,I[s.wrapR]),e.texParameteri(r,10240,O[s.magFilter]),e.texParameteri(r,10241,O[s.minFilter])):(e.texParameteri(r,10242,33071),e.texParameteri(r,10243,33071),32879!==r&&35866!==r||e.texParameteri(r,32882,33071),s.wrapS===de&&s.wrapT===de||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(r,10240,A(s.magFilter)),e.texParameteri(r,10241,A(s.minFilter)),s.minFilter!==pe&&s.minFilter!==be&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){const o=t.get("EXT_texture_filter_anisotropic");if(s.type===Ie&&!1===t.has("OES_texture_float_linear"))return;if(!1===a&&s.type===Oe&&!1===t.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(e.texParameterf(r,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,n.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function k(t,r){let i=!1;void 0===t.__webglInit&&(t.__webglInit=!0,r.addEventListener("dispose",T));const n=r.source;let s=m.get(n);void 0===s&&(s={},m.set(n,s));const a=function(e){const t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.encoding),t.join()}(r);if(a!==t.__cacheKey){void 0===s[a]&&(s[a]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,i=!0),s[a].usedTimes++;const n=s[t.__cacheKey];void 0!==n&&(s[t.__cacheKey].usedTimes--,0===n.usedTimes&&M(r)),t.__cacheKey=a,t.__webglTexture=s[a].texture}return i}function L(t,i,n){let o=3553;i.isDataArrayTexture&&(o=35866),i.isData3DTexture&&(o=32879);const l=k(t,i),c=i.source;if(r.activeTexture(33984+n),r.bindTexture(o,t.__webglTexture),c.version!==c.__currentVersion||!0===l){e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const n=function(e){return!a&&(e.wrapS!==de||e.wrapT!==de||e.minFilter!==pe&&e.minFilter!==be)}(i)&&!1===b(i.image);let l=_(i.image,n,!1,u);l=B(i,l);const h=b(l)||a,d=s.convert(i.format,i.encoding);let f,p=s.convert(i.type),m=w(i.internalFormat,d,p,i.encoding,i.isVideoTexture);P(o,i,h);const g=i.mipmaps,v=a&&!0!==i.isVideoTexture,A=void 0===t.__version,T=x(i,l,h);if(i.isDepthTexture)m=6402,a?m=i.type===Ie?36012:i.type===Re?33190:i.type===Le?35056:33189:i.type===Ie&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),i.format===Be&&6402===m&&i.type!==Me&&i.type!==Re&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),i.type=Me,p=s.convert(i.type)),i.format===Fe&&6402===m&&(m=34041,i.type!==Le&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),i.type=Le,p=s.convert(i.type))),v&&A?r.texStorage2D(3553,1,m,l.width,l.height):r.texImage2D(3553,0,m,l.width,l.height,0,d,p,null);else if(i.isDataTexture)if(g.length>0&&h){v&&A&&r.texStorage2D(3553,T,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)f=g[e],v?r.texSubImage2D(3553,e,0,0,f.width,f.height,d,p,f.data):r.texImage2D(3553,e,m,f.width,f.height,0,d,p,f.data);i.generateMipmaps=!1}else v?(A&&r.texStorage2D(3553,T,m,l.width,l.height),r.texSubImage2D(3553,0,0,0,l.width,l.height,d,p,l.data)):r.texImage2D(3553,0,m,l.width,l.height,0,d,p,l.data);else if(i.isCompressedTexture){v&&A&&r.texStorage2D(3553,T,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)f=g[e],i.format!==De?null!==d?v?r.compressedTexSubImage2D(3553,e,0,0,f.width,f.height,d,f.data):r.compressedTexImage2D(3553,e,m,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):v?r.texSubImage2D(3553,e,0,0,f.width,f.height,d,p,f.data):r.texImage2D(3553,e,m,f.width,f.height,0,d,p,f.data)}else if(i.isDataArrayTexture)v?(A&&r.texStorage3D(35866,T,m,l.width,l.height,l.depth),r.texSubImage3D(35866,0,0,0,0,l.width,l.height,l.depth,d,p,l.data)):r.texImage3D(35866,0,m,l.width,l.height,l.depth,0,d,p,l.data);else if(i.isData3DTexture)v?(A&&r.texStorage3D(32879,T,m,l.width,l.height,l.depth),r.texSubImage3D(32879,0,0,0,0,l.width,l.height,l.depth,d,p,l.data)):r.texImage3D(32879,0,m,l.width,l.height,l.depth,0,d,p,l.data);else if(i.isFramebufferTexture)v&&A?r.texStorage2D(3553,T,m,l.width,l.height):r.texImage2D(3553,0,m,l.width,l.height,0,d,p,null);else if(g.length>0&&h){v&&A&&r.texStorage2D(3553,T,m,g[0].width,g[0].height);for(let e=0,t=g.length;e<t;e++)f=g[e],v?r.texSubImage2D(3553,e,0,0,d,p,f):r.texImage2D(3553,e,m,d,p,f);i.generateMipmaps=!1}else v?(A&&r.texStorage2D(3553,T,m,l.width,l.height),r.texSubImage2D(3553,0,0,0,d,p,l)):r.texImage2D(3553,0,m,d,p,l);y(i,h)&&E(o),c.__currentVersion=c.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}function N(t,n,o,a,l){const c=s.convert(o.format,o.encoding),u=s.convert(o.type),h=w(o.internalFormat,c,u,o.encoding);i.get(n).__hasExternalTextures||(32879===l||35866===l?r.texImage3D(l,0,h,n.width,n.height,n.depth,0,c,u,null):r.texImage2D(l,0,h,n.width,n.height,0,c,u,null)),r.bindFramebuffer(36160,t),V(n)?d.framebufferTexture2DMultisampleEXT(36160,a,l,i.get(o).__webglTexture,0,U(n)):e.framebufferTexture2D(36160,a,l,i.get(o).__webglTexture,0),r.bindFramebuffer(36160,null)}function G(t,r,i){if(e.bindRenderbuffer(36161,t),r.depthBuffer&&!r.stencilBuffer){let n=33189;if(i||V(r)){const t=r.depthTexture;t&&t.isDepthTexture&&(t.type===Ie?n=36012:t.type===Re&&(n=33190));const i=U(r);V(r)?d.renderbufferStorageMultisampleEXT(36161,i,n,r.width,r.height):e.renderbufferStorageMultisample(36161,i,n,r.width,r.height)}else e.renderbufferStorage(36161,n,r.width,r.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(r.depthBuffer&&r.stencilBuffer){const n=U(r);i&&!1===V(r)?e.renderbufferStorageMultisample(36161,n,35056,r.width,r.height):V(r)?d.renderbufferStorageMultisampleEXT(36161,n,35056,r.width,r.height):e.renderbufferStorage(36161,34041,r.width,r.height),e.framebufferRenderbuffer(36160,33306,36161,t)}else{const t=!0===r.isWebGLMultipleRenderTargets?r.texture[0]:r.texture,n=s.convert(t.format,t.encoding),o=s.convert(t.type),a=w(t.internalFormat,n,o,t.encoding),l=U(r);i&&!1===V(r)?e.renderbufferStorageMultisample(36161,l,a,r.width,r.height):V(r)?d.renderbufferStorageMultisampleEXT(36161,l,a,r.width,r.height):e.renderbufferStorage(36161,a,r.width,r.height)}e.bindRenderbuffer(36161,null)}function D(t){const n=i.get(t),s=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!n.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),R(n.depthTexture,0);const s=i.get(n.depthTexture).__webglTexture,o=U(n);if(n.depthTexture.format===Be)V(n)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,s,0,o):e.framebufferTexture2D(36160,36096,3553,s,0);else{if(n.depthTexture.format!==Fe)throw new Error("Unknown depthTexture format");V(n)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,s,0,o):e.framebufferTexture2D(36160,33306,3553,s,0)}}(n.__webglFramebuffer,t)}else if(s){n.__webglDepthbuffer=[];for(let i=0;i<6;i++)r.bindFramebuffer(36160,n.__webglFramebuffer[i]),n.__webglDepthbuffer[i]=e.createRenderbuffer(),G(n.__webglDepthbuffer[i],t,!1)}else r.bindFramebuffer(36160,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),G(n.__webglDepthbuffer,t,!1);r.bindFramebuffer(36160,null)}function U(e){return Math.min(h,e.samples)}function V(e){const r=i.get(e);return a&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==r.__useRenderToTexture}function B(e,r){const i=e.encoding,n=e.format,s=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===dr||i!==kt&&(i===Lt?!1===a?!0===t.has("EXT_sRGB")&&n===De?(e.format=dr,e.minFilter=be,e.generateMipmaps=!1):r=Br.sRGBToLinear(r):n===De&&s===Ae||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),r}this.allocateTextureUnit=function(){const e=C;return e>=l&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+l),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=R,this.setTexture2DArray=function(e,t){const n=i.get(e);e.version>0&&n.__version!==e.version?L(n,e,t):(r.activeTexture(33984+t),r.bindTexture(35866,n.__webglTexture))},this.setTexture3D=function(e,t){const n=i.get(e);e.version>0&&n.__version!==e.version?L(n,e,t):(r.activeTexture(33984+t),r.bindTexture(32879,n.__webglTexture))},this.setTextureCube=function(t,n){const o=i.get(t);t.version>0&&o.__version!==t.version?function(t,i,n){if(6!==i.image.length)return;const o=k(t,i),l=i.source;if(r.activeTexture(33984+n),r.bindTexture(34067,t.__webglTexture),l.version!==l.__currentVersion||!0===o){e.pixelStorei(37440,i.flipY),e.pixelStorei(37441,i.premultiplyAlpha),e.pixelStorei(3317,i.unpackAlignment),e.pixelStorei(37443,0);const n=i.isCompressedTexture||i.image[0].isCompressedTexture,o=i.image[0]&&i.image[0].isDataTexture,u=[];for(let e=0;e<6;e++)u[e]=n||o?o?i.image[e].image:i.image[e]:_(i.image[e],!1,!0,c),u[e]=B(i,u[e]);const h=u[0],d=b(h)||a,f=s.convert(i.format,i.encoding),p=s.convert(i.type),m=w(i.internalFormat,f,p,i.encoding),g=a&&!0!==i.isVideoTexture,v=void 0===t.__version;let A,T=x(i,h,d);if(P(34067,i,d),n){g&&v&&r.texStorage2D(34067,T,m,h.width,h.height);for(let e=0;e<6;e++){A=u[e].mipmaps;for(let t=0;t<A.length;t++){const n=A[t];i.format!==De?null!==f?g?r.compressedTexSubImage2D(34069+e,t,0,0,n.width,n.height,f,n.data):r.compressedTexImage2D(34069+e,t,m,n.width,n.height,0,n.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):g?r.texSubImage2D(34069+e,t,0,0,n.width,n.height,f,p,n.data):r.texImage2D(34069+e,t,m,n.width,n.height,0,f,p,n.data)}}}else{A=i.mipmaps,g&&v&&(A.length>0&&T++,r.texStorage2D(34067,T,m,u[0].width,u[0].height));for(let e=0;e<6;e++)if(o){g?r.texSubImage2D(34069+e,0,0,0,u[e].width,u[e].height,f,p,u[e].data):r.texImage2D(34069+e,0,m,u[e].width,u[e].height,0,f,p,u[e].data);for(let t=0;t<A.length;t++){const i=A[t].image[e].image;g?r.texSubImage2D(34069+e,t+1,0,0,i.width,i.height,f,p,i.data):r.texImage2D(34069+e,t+1,m,i.width,i.height,0,f,p,i.data)}}else{g?r.texSubImage2D(34069+e,0,0,0,f,p,u[e]):r.texImage2D(34069+e,0,m,f,p,u[e]);for(let t=0;t<A.length;t++){const i=A[t];g?r.texSubImage2D(34069+e,t+1,0,0,f,p,i.image[e]):r.texImage2D(34069+e,t+1,m,f,p,i.image[e])}}}y(i,d)&&E(34067),l.__currentVersion=l.version,i.onUpdate&&i.onUpdate(i)}t.__version=i.version}(o,t,n):(r.activeTexture(33984+n),r.bindTexture(34067,o.__webglTexture))},this.rebindTextures=function(e,t,r){const n=i.get(e);void 0!==t&&N(n.__webglFramebuffer,e,e.texture,36064,3553),void 0!==r&&D(e)},this.setupRenderTarget=function(t){const l=t.texture,c=i.get(t),u=i.get(l);t.addEventListener("dispose",S),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=l.version,o.memory.textures++);const h=!0===t.isWebGLCubeRenderTarget,d=!0===t.isWebGLMultipleRenderTargets,f=b(t)||a;if(h){c.__webglFramebuffer=[];for(let t=0;t<6;t++)c.__webglFramebuffer[t]=e.createFramebuffer()}else if(c.__webglFramebuffer=e.createFramebuffer(),d)if(n.drawBuffers){const r=t.texture;for(let t=0,n=r.length;t<n;t++){const n=i.get(r[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(a&&t.samples>0&&!1===V(t)){c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,c.__webglColorRenderbuffer);const i=s.convert(l.format,l.encoding),n=s.convert(l.type),o=w(l.internalFormat,i,n,l.encoding),a=U(t);e.renderbufferStorageMultisample(36161,a,o,t.width,t.height),r.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,c.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),G(c.__webglDepthRenderbuffer,t,!0)),r.bindFramebuffer(36160,null)}if(h){r.bindTexture(34067,u.__webglTexture),P(34067,l,f);for(let e=0;e<6;e++)N(c.__webglFramebuffer[e],t,l,36064,34069+e);y(l,f)&&E(34067),r.unbindTexture()}else if(d){const e=t.texture;for(let n=0,s=e.length;n<s;n++){const s=e[n],o=i.get(s);r.bindTexture(3553,o.__webglTexture),P(3553,s,f),N(c.__webglFramebuffer,t,s,36064+n,3553),y(s,f)&&E(3553)}r.unbindTexture()}else{let e=3553;(t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(a?e=t.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(e,u.__webglTexture),P(e,l,f),N(c.__webglFramebuffer,t,l,36064,e),y(l,f)&&E(e),r.unbindTexture()}t.depthBuffer&&D(t)},this.updateRenderTargetMipmap=function(e){const t=b(e)||a,n=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let s=0,o=n.length;s<o;s++){const o=n[s];if(y(o,t)){const t=e.isWebGLCubeRenderTarget?34067:3553,n=i.get(o).__webglTexture;r.bindTexture(t,n),E(t),r.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(a&&t.samples>0&&!1===V(t)){const n=t.width,s=t.height;let o=16384;const a=[36064],l=t.stencilBuffer?33306:36096;t.depthBuffer&&a.push(l);const c=i.get(t),u=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;!1===u&&(t.depthBuffer&&(o|=256),t.stencilBuffer&&(o|=1024)),r.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,c.__webglFramebuffer),!0===u&&(e.invalidateFramebuffer(36008,[l]),e.invalidateFramebuffer(36009,[l])),e.blitFramebuffer(0,0,n,s,0,0,n,s,o,9728),e.invalidateFramebuffer(36008,a),r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=D,this.setupFrameBufferTexture=N,this.useMultisampledRTT=V}function Ya(e,t,r){const i=r.isWebGL2;return{convert:function(e,r=null){let n;if(e===Ae)return 5121;if(e===Pe)return 32819;if(e===ke)return 32820;if(e===Te)return 5120;if(e===Se)return 5122;if(e===Me)return 5123;if(e===Ce)return 5124;if(e===Re)return 5125;if(e===Ie)return 5126;if(e===Oe)return i?5131:(n=t.get("OES_texture_half_float"),null!==n?n.HALF_FLOAT_OES:null);if(e===Ne)return 6406;if(e===De)return 6408;if(e===Ue)return 6409;if(e===Ve)return 6410;if(e===Be)return 6402;if(e===Fe)return 34041;if(e===je)return 6403;if(e===Ge)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(e===dr)return n=t.get("EXT_sRGB"),null!==n?n.SRGB_ALPHA_EXT:null;if(e===ze)return 36244;if(e===We)return 33319;if(e===He)return 33320;if(e===$e)return 36249;if(e===Ye||e===qe||e===Xe||e===Ze)if(r===Lt){if(n=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===n)return null;if(e===Ye)return n.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===qe)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Xe)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Ze)return n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(n=t.get("WEBGL_compressed_texture_s3tc"),null===n)return null;if(e===Ye)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===qe)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Xe)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Ze)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===Je||e===Ke||e===Qe||e===et){if(n=t.get("WEBGL_compressed_texture_pvrtc"),null===n)return null;if(e===Je)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===Ke)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===Qe)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===et)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===tt)return n=t.get("WEBGL_compressed_texture_etc1"),null!==n?n.COMPRESSED_RGB_ETC1_WEBGL:null;if(e===rt||e===it){if(n=t.get("WEBGL_compressed_texture_etc"),null===n)return null;if(e===rt)return r===Lt?n.COMPRESSED_SRGB8_ETC2:n.COMPRESSED_RGB8_ETC2;if(e===it)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:n.COMPRESSED_RGBA8_ETC2_EAC}if(e===nt||e===st||e===ot||e===at||e===lt||e===ct||e===ut||e===ht||e===dt||e===ft||e===pt||e===mt||e===gt||e===vt){if(n=t.get("WEBGL_compressed_texture_astc"),null===n)return null;if(e===nt)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:n.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===st)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:n.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===ot)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:n.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===at)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:n.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===lt)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:n.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===ct)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:n.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===ut)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:n.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===ht)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:n.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===dt)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:n.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===ft)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:n.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===pt)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:n.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===mt)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:n.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===gt)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:n.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===vt)return r===Lt?n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:n.COMPRESSED_RGBA_ASTC_12x12_KHR}if(e===_t){if(n=t.get("EXT_texture_compression_bptc"),null===n)return null;if(e===_t)return r===Lt?n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:n.COMPRESSED_RGBA_BPTC_UNORM_EXT}return e===Le?i?34042:(n=t.get("WEBGL_depth_texture"),null!==n?n.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class qa extends cs{constructor(e=[]){super(),this.cameras=e}}qa.prototype.isArrayCamera=!0;class Xa extends tn{constructor(){super(),this.type="Group"}}Xa.prototype.isGroup=!0;const Za={type:"move"};class Ja{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Xa,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Xa,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Qr,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Qr),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Xa,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Qr,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Qr),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null;const o=this._targetRay,a=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==o&&(i=t.getPose(e.targetRaySpace,r),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(Za))),l&&e.hand){s=!0;for(const i of e.hand.values()){const e=t.getJointPose(i,r);if(void 0===l.joints[i.jointName]){const e=new Xa;e.matrixAutoUpdate=!1,e.visible=!1,l.joints[i.jointName]=e,l.add(e)}const n=l.joints[i.jointName];null!==e&&(n.matrix.fromArray(e.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.jointRadius=e.radius),n.visible=null!==e}const i=l.joints["index-finger-tip"],n=l.joints["thumb-tip"],o=i.position.distanceTo(n.position),a=.02,c=.005;l.inputState.pinching&&o>a+c?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&o<=a-c&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==a&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),null!==n&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1));return null!==o&&(o.visible=null!==i),null!==a&&(a.visible=null!==n),null!==l&&(l.visible=null!==s),this}}class Ka extends Wr{constructor(e,t,r,i,n,s,o,a,l,c){if((c=void 0!==c?c:Be)!==Be&&c!==Fe)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&c===Be&&(r=Me),void 0===r&&c===Fe&&(r=Le),super(null,i,n,s,o,a,c,r,l),this.image={width:e,height:t},this.magFilter=void 0!==o?o:pe,this.minFilter=void 0!==a?a:pe,this.flipY=!1,this.generateMipmaps=!1}}Ka.prototype.isDepthTexture=!0;class Qa extends fr{constructor(e,t){super();const r=this;let i=null,n=1,s=null,o="local-floor",a=null,l=null,c=null,u=null,h=null;const d=t.getContextAttributes();let f=null,p=null;const m=[],g=new Map,v=new cs;v.layers.enable(1),v.viewport=new Hr;const _=new cs;_.layers.enable(2),_.viewport=new Hr;const b=[v,_],y=new qa;y.layers.enable(1),y.layers.enable(2);let E=null,w=null;function x(e){const t=g.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function A(){g.forEach((function(e,t){e.disconnect(t)})),g.clear(),E=null,w=null,e.setRenderTarget(f),u=null,c=null,l=null,i=null,p=null,I.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}function T(e){const t=i.inputSources;for(let e=0;e<m.length;e++)g.set(t[e],m[e]);for(let t=0;t<e.removed.length;t++){const r=e.removed[t],i=g.get(r);i&&(i.dispatchEvent({type:"disconnected",data:r}),g.delete(r))}for(let t=0;t<e.added.length;t++){const r=e.added[t],i=g.get(r);i&&i.dispatchEvent({type:"connected",data:r})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=m[e];return void 0===t&&(t=new Ja,m[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=m[e];return void 0===t&&(t=new Ja,m[e]=t),t.getGripSpace()},this.getHand=function(e){let t=m[e];return void 0===t&&(t=new Ja,m[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){n=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){o=e,!0===r.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return s},this.getBaseLayer=function(){return null!==c?c:u},this.getBinding=function(){return l},this.getFrame=function(){return h},this.getSession=function(){return i},this.setSession=async function(a){if(i=a,null!==i){if(f=e.getRenderTarget(),i.addEventListener("select",x),i.addEventListener("selectstart",x),i.addEventListener("selectend",x),i.addEventListener("squeeze",x),i.addEventListener("squeezestart",x),i.addEventListener("squeezeend",x),i.addEventListener("end",A),i.addEventListener("inputsourceschange",T),!0!==d.xrCompatible&&await t.makeXRCompatible(),void 0===i.renderState.layers||!1===e.capabilities.isWebGL2){const r={antialias:void 0!==i.renderState.layers||d.antialias,alpha:d.alpha,depth:d.depth,stencil:d.stencil,framebufferScaleFactor:n};u=new XRWebGLLayer(i,t,r),i.updateRenderState({baseLayer:u}),p=new $r(u.framebufferWidth,u.framebufferHeight,{format:De,type:Ae,encoding:e.outputEncoding})}else{let r=null,s=null,o=null;d.depth&&(o=d.stencil?35056:33190,r=d.stencil?Fe:Be,s=d.stencil?Le:Me);const a={colorFormat:e.outputEncoding===Lt?35907:32856,depthFormat:o,scaleFactor:n};l=new XRWebGLBinding(i,t),c=l.createProjectionLayer(a),i.updateRenderState({layers:[c]}),p=new $r(c.textureWidth,c.textureHeight,{format:De,type:Ae,depthTexture:new Ka(c.textureWidth,c.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,r),stencilBuffer:d.stencil,encoding:e.outputEncoding,samples:d.antialias?4:0});e.properties.get(p).__ignoreDepthValues=c.ignoreDepthValues}p.isXRRenderTarget=!0,this.setFoveation(1),s=await i.requestReferenceSpace(o),I.setContext(i),I.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};const S=new Qr,M=new Qr;function C(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===i)return;y.near=_.near=v.near=e.near,y.far=_.far=v.far=e.far,E===y.near&&w===y.far||(i.updateRenderState({depthNear:y.near,depthFar:y.far}),E=y.near,w=y.far);const t=e.parent,r=y.cameras;C(y,t);for(let e=0;e<r.length;e++)C(r[e],t);y.matrixWorld.decompose(y.position,y.quaternion,y.scale),e.position.copy(y.position),e.quaternion.copy(y.quaternion),e.scale.copy(y.scale),e.matrix.copy(y.matrix),e.matrixWorld.copy(y.matrixWorld);const n=e.children;for(let e=0,t=n.length;e<t;e++)n[e].updateMatrixWorld(!0);2===r.length?function(e,t,r){S.setFromMatrixPosition(t.matrixWorld),M.setFromMatrixPosition(r.matrixWorld);const i=S.distanceTo(M),n=t.projectionMatrix.elements,s=r.projectionMatrix.elements,o=n[14]/(n[10]-1),a=n[14]/(n[10]+1),l=(n[9]+1)/n[5],c=(n[9]-1)/n[5],u=(n[8]-1)/n[0],h=(s[8]+1)/s[0],d=o*u,f=o*h,p=i/(-u+h),m=p*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();const g=o+p,v=a+p,_=d-m,b=f+(i-m),y=l*a/v*g,E=c*a/v*g;e.projectionMatrix.makePerspective(_,b,y,E,g,v)}(y,v,_):y.projectionMatrix.copy(v.projectionMatrix)},this.getCamera=function(){return y},this.getFoveation=function(){return null!==c?c.fixedFoveation:null!==u?u.fixedFoveation:void 0},this.setFoveation=function(e){null!==c&&(c.fixedFoveation=e),null!==u&&void 0!==u.fixedFoveation&&(u.fixedFoveation=e)};let R=null;const I=new Es;I.setAnimationLoop((function(t,r){if(a=r.getViewerPose(s),h=r,null!==a){const t=a.views;null!==u&&(e.setRenderTargetFramebuffer(p,u.framebuffer),e.setRenderTarget(p));let r=!1;t.length!==y.cameras.length&&(y.cameras.length=0,r=!0);for(let i=0;i<t.length;i++){const n=t[i];let s=null;if(null!==u)s=u.getViewport(n);else{const t=l.getViewSubImage(c,n);s=t.viewport,0===i&&(e.setRenderTargetTextures(p,t.colorTexture,c.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(p))}const o=b[i];o.matrix.fromArray(n.transform.matrix),o.projectionMatrix.fromArray(n.projectionMatrix),o.viewport.set(s.x,s.y,s.width,s.height),0===i&&y.matrix.copy(o.matrix),!0===r&&y.cameras.push(o)}}const n=i.inputSources;for(let e=0;e<m.length;e++){const t=m[e],i=n[e];t.update(i,r,s)}R&&R(t,r),h=null})),this.setAnimationLoop=function(e){R=e},this.dispose=function(){}}}function el(e){function t(t,r){t.opacity.value=r.opacity,r.color&&t.diffuse.value.copy(r.color),r.emissive&&t.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(t.map.value=r.map),r.alphaMap&&(t.alphaMap.value=r.alphaMap),r.specularMap&&(t.specularMap.value=r.specularMap),r.alphaTest>0&&(t.alphaTest.value=r.alphaTest);const i=e.get(r).envMap;let n,s;i&&(t.envMap.value=i,t.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,t.reflectivity.value=r.reflectivity,t.ior.value=r.ior,t.refractionRatio.value=r.refractionRatio),r.lightMap&&(t.lightMap.value=r.lightMap,t.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(t.aoMap.value=r.aoMap,t.aoMapIntensity.value=r.aoMapIntensity),r.map?n=r.map:r.specularMap?n=r.specularMap:r.displacementMap?n=r.displacementMap:r.normalMap?n=r.normalMap:r.bumpMap?n=r.bumpMap:r.roughnessMap?n=r.roughnessMap:r.metalnessMap?n=r.metalnessMap:r.alphaMap?n=r.alphaMap:r.emissiveMap?n=r.emissiveMap:r.clearcoatMap?n=r.clearcoatMap:r.clearcoatNormalMap?n=r.clearcoatNormalMap:r.clearcoatRoughnessMap?n=r.clearcoatRoughnessMap:r.specularIntensityMap?n=r.specularIntensityMap:r.specularColorMap?n=r.specularColorMap:r.transmissionMap?n=r.transmissionMap:r.thicknessMap?n=r.thicknessMap:r.sheenColorMap?n=r.sheenColorMap:r.sheenRoughnessMap&&(n=r.sheenRoughnessMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix)),r.aoMap?s=r.aoMap:r.lightMap&&(s=r.lightMap),void 0!==s&&(s.isWebGLRenderTarget&&(s=s.texture),!0===s.matrixAutoUpdate&&s.updateMatrix(),t.uv2Transform.value.copy(s.matrix))}function r(t,r){t.roughness.value=r.roughness,t.metalness.value=r.metalness,r.roughnessMap&&(t.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(t.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(t.emissiveMap.value=r.emissiveMap),r.bumpMap&&(t.bumpMap.value=r.bumpMap,t.bumpScale.value=r.bumpScale,r.side===m&&(t.bumpScale.value*=-1)),r.normalMap&&(t.normalMap.value=r.normalMap,t.normalScale.value.copy(r.normalScale),r.side===m&&t.normalScale.value.negate()),r.displacementMap&&(t.displacementMap.value=r.displacementMap,t.displacementScale.value=r.displacementScale,t.displacementBias.value=r.displacementBias);e.get(r).envMap&&(t.envMapIntensity.value=r.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,i,n,s,o){i.isMeshBasicMaterial?t(e,i):i.isMeshLambertMaterial?(t(e,i),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,i)):i.isMeshToonMaterial?(t(e,i),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshPhongMaterial?(t(e,i),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshStandardMaterial?(t(e,i),i.isMeshPhysicalMaterial?function(e,t,i){r(e,t),e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===m&&e.clearcoatNormalScale.value.negate()));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=i.texture,e.transmissionSamplerSize.value.set(i.width,i.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap);t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap)}(e,i,o):r(e,i)):i.isMeshMatcapMaterial?(t(e,i),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshDepthMaterial?(t(e,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isMeshDistanceMaterial?(t(e,i),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,i)):i.isMeshNormalMaterial?(t(e,i),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===m&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===m&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,i)):i.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,i),i.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,i)):i.isPointsMaterial?function(e,t,r,i){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*i,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,i,n,s):i.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);t.alphaTest>0&&(e.alphaTest.value=t.alphaTest);let r;t.map?r=t.map:t.alphaMap&&(r=t.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix))}(e,i):i.isShadowMaterial?(e.color.value.copy(i.color),e.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function tl(e={}){const t=void 0!==e.canvas?e.canvas:function(){const e=Or("canvas");return e.style.display="block",e}(),r=void 0!==e.context?e.context:null,n=void 0===e.depth||e.depth,s=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,a=void 0===e.premultipliedAlpha||e.premultipliedAlpha,l=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,c=void 0!==e.powerPreference?e.powerPreference:"default",u=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat;let h;h=void 0!==e.context?r.getContextAttributes().alpha:void 0!==e.alpha&&e.alpha;let d=null,f=null;const v=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=kt,this.physicallyCorrectLights=!1,this.toneMapping=K,this.toneMappingExposure=1;const b=this;let y=!1,E=0,w=0,x=null,A=-1,T=null;const S=new Hr,M=new Hr;let C=null,R=t.width,I=t.height,O=1,P=null,k=null;const L=new Hr(0,0,R,I),N=new Hr(0,0,R,I);let G=!1;const D=new ys;let U=!1,V=!1,B=null;const F=new Ii,j=new Sr,z=new Qr,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function H(){return null===x?O:1}let $,Y,q,X,Z,J,Q,ee,te,re,ie,ne,se,oe,ae,le,ce,ue,he,de,fe,pe,me,ge=r;function ve(e,r){for(let i=0;i<e.length;i++){const n=e[i],s=t.getContext(n,r);if(null!==s)return s}return null}try{const e={alpha:!0,depth:n,stencil:s,antialias:o,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${i}`),t.addEventListener("webglcontextlost",ye,!1),t.addEventListener("webglcontextrestored",Ee,!1),null===ge){const t=["webgl2","webgl","experimental-webgl"];if(!0===b.isWebGL1Renderer&&t.shift(),ge=ve(t,e),null===ge)throw ve(t)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ge.getShaderPrecisionFormat&&(ge.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function _e(){$=new Xs(ge),Y=new Is(ge,$,e),$.init(Y),pe=new Ya(ge,$,Y),q=new Ha(ge,$,Y),X=new Ks(ge),Z=new Oa,J=new $a(ge,$,q,Z,Y,pe,X),Q=new Ps(b),ee=new qs(b),te=new ws(ge,Y),me=new Cs(ge,$,te,Y),re=new Zs(ge,te,X,me),ie=new io(ge,re,te,X),he=new ro(ge,Y,J),le=new Os(Z),ne=new Ia(b,Q,ee,$,Y,me,le),se=new el(Z),oe=new Na,ae=new Fa($,Y),ue=new Ms(b,Q,q,ie,h,a),ce=new Wa(b,ie,Y),de=new Rs(ge,$,X,Y),fe=new Js(ge,$,X,Y),X.programs=ne.programs,b.capabilities=Y,b.extensions=$,b.properties=Z,b.renderLists=oe,b.shadowMap=ce,b.state=q,b.info=X}_e();const be=new Qa(b,ge);function ye(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function Ee(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const e=X.autoReset,t=ce.enabled,r=ce.autoUpdate,i=ce.needsUpdate,n=ce.type;_e(),X.autoReset=e,ce.enabled=t,ce.autoUpdate=r,ce.needsUpdate=i,ce.type=n}function xe(e){const t=e.target;t.removeEventListener("dispose",xe),function(e){(function(e){const t=Z.get(e).programs;void 0!==t&&(t.forEach((function(e){ne.releaseProgram(e)})),e.isShaderMaterial&&ne.releaseShaderCache(e))})(e),Z.remove(e)}(t)}this.xr=be,this.getContext=function(){return ge},this.getContextAttributes=function(){return ge.getContextAttributes()},this.forceContextLoss=function(){const e=$.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){const e=$.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return O},this.setPixelRatio=function(e){void 0!==e&&(O=e,this.setSize(R,I,!1))},this.getSize=function(e){return e.set(R,I)},this.setSize=function(e,r,i){be.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(R=e,I=r,t.width=Math.floor(e*O),t.height=Math.floor(r*O),!1!==i&&(t.style.width=e+"px",t.style.height=r+"px"),this.setViewport(0,0,e,r))},this.getDrawingBufferSize=function(e){return e.set(R*O,I*O).floor()},this.setDrawingBufferSize=function(e,r,i){R=e,I=r,O=i,t.width=Math.floor(e*i),t.height=Math.floor(r*i),this.setViewport(0,0,e,r)},this.getCurrentViewport=function(e){return e.copy(S)},this.getViewport=function(e){return e.copy(L)},this.setViewport=function(e,t,r,i){e.isVector4?L.set(e.x,e.y,e.z,e.w):L.set(e,t,r,i),q.viewport(S.copy(L).multiplyScalar(O).floor())},this.getScissor=function(e){return e.copy(N)},this.setScissor=function(e,t,r,i){e.isVector4?N.set(e.x,e.y,e.z,e.w):N.set(e,t,r,i),q.scissor(M.copy(N).multiplyScalar(O).floor())},this.getScissorTest=function(){return G},this.setScissorTest=function(e){q.setScissorTest(G=e)},this.setOpaqueSort=function(e){P=e},this.setTransparentSort=function(e){k=e},this.getClearColor=function(e){return e.copy(ue.getClearColor())},this.setClearColor=function(){ue.setClearColor.apply(ue,arguments)},this.getClearAlpha=function(){return ue.getClearAlpha()},this.setClearAlpha=function(){ue.setClearAlpha.apply(ue,arguments)},this.clear=function(e=!0,t=!0,r=!0){let i=0;e&&(i|=16384),t&&(i|=256),r&&(i|=1024),ge.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ye,!1),t.removeEventListener("webglcontextrestored",Ee,!1),oe.dispose(),ae.dispose(),Z.dispose(),Q.dispose(),ee.dispose(),ie.dispose(),me.dispose(),ne.dispose(),be.dispose(),be.removeEventListener("sessionstart",Se),be.removeEventListener("sessionend",Me),B&&(B.dispose(),B=null),Ce.stop()},this.renderBufferDirect=function(e,t,r,i,n,s){null===t&&(t=W);const o=n.isMesh&&n.matrixWorld.determinant()<0,a=function(e,t,r,i,n){!0!==t.isScene&&(t=W);J.resetTextureUnits();const s=t.fog,o=i.isMeshStandardMaterial?t.environment:null,a=null===x?b.outputEncoding:!0===x.isXRRenderTarget?x.texture.encoding:kt,l=(i.isMeshStandardMaterial?ee:Q).get(i.envMap||o),c=!0===i.vertexColors&&!!r.attributes.color&&4===r.attributes.color.itemSize,u=!!i.normalMap&&!!r.attributes.tangent,h=!!r.morphAttributes.position,d=!!r.morphAttributes.normal,p=!!r.morphAttributes.color,m=i.toneMapped?b.toneMapping:K,g=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,v=void 0!==g?g.length:0,_=Z.get(i),y=f.state.lights;if(!0===U&&(!0===V||e!==T)){const t=e===T&&i.id===A;le.setState(i,e,t)}let E=!1;i.version===_.__version?_.needsLights&&_.lightsStateVersion!==y.state.version||_.outputEncoding!==a||n.isInstancedMesh&&!1===_.instancing?E=!0:n.isInstancedMesh||!0!==_.instancing?n.isSkinnedMesh&&!1===_.skinning?E=!0:n.isSkinnedMesh||!0!==_.skinning?_.envMap!==l||i.fog&&_.fog!==s?E=!0:void 0===_.numClippingPlanes||_.numClippingPlanes===le.numPlanes&&_.numIntersection===le.numIntersection?(_.vertexAlphas!==c||_.vertexTangents!==u||_.morphTargets!==h||_.morphNormals!==d||_.morphColors!==p||_.toneMapping!==m||!0===Y.isWebGL2&&_.morphTargetsCount!==v)&&(E=!0):E=!0:E=!0:E=!0:(E=!0,_.__version=i.version);let w=_.currentProgram;!0===E&&(w=Ne(i,t,n));let S=!1,M=!1,C=!1;const R=w.getUniforms(),P=_.uniforms;q.useProgram(w.program)&&(S=!0,M=!0,C=!0);i.id!==A&&(A=i.id,M=!0);if(S||T!==e){if(R.setValue(ge,"projectionMatrix",e.projectionMatrix),Y.logarithmicDepthBuffer&&R.setValue(ge,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),T!==e&&(T=e,M=!0,C=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){const t=R.map.cameraPosition;void 0!==t&&t.setValue(ge,z.setFromMatrixPosition(e.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&R.setValue(ge,"isOrthographic",!0===e.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||n.isSkinnedMesh)&&R.setValue(ge,"viewMatrix",e.matrixWorldInverse)}if(n.isSkinnedMesh){R.setOptional(ge,n,"bindMatrix"),R.setOptional(ge,n,"bindMatrixInverse");const e=n.skeleton;e&&(Y.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),R.setValue(ge,"boneTexture",e.boneTexture,J),R.setValue(ge,"boneTextureSize",e.boneTextureSize)):R.setOptional(ge,e,"boneMatrices"))}const k=r.morphAttributes;(void 0!==k.position||void 0!==k.normal||void 0!==k.color&&!0===Y.isWebGL2)&&he.update(n,r,i,w);(M||_.receiveShadow!==n.receiveShadow)&&(_.receiveShadow=n.receiveShadow,R.setValue(ge,"receiveShadow",n.receiveShadow));M&&(R.setValue(ge,"toneMappingExposure",b.toneMappingExposure),_.needsLights&&(N=C,(L=P).ambientLightColor.needsUpdate=N,L.lightProbe.needsUpdate=N,L.directionalLights.needsUpdate=N,L.directionalLightShadows.needsUpdate=N,L.pointLights.needsUpdate=N,L.pointLightShadows.needsUpdate=N,L.spotLights.needsUpdate=N,L.spotLightShadows.needsUpdate=N,L.rectAreaLights.needsUpdate=N,L.hemisphereLights.needsUpdate=N),s&&i.fog&&se.refreshFogUniforms(P,s),se.refreshMaterialUniforms(P,i,O,I,B),la.upload(ge,_.uniformsList,P,J));var L,N;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(la.upload(ge,_.uniformsList,P,J),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&R.setValue(ge,"center",n.center);return R.setValue(ge,"modelViewMatrix",n.modelViewMatrix),R.setValue(ge,"normalMatrix",n.normalMatrix),R.setValue(ge,"modelMatrix",n.matrixWorld),w}(e,t,r,i,n);q.setMaterial(i,o);let l=r.index;const c=r.attributes.position;if(null===l){if(void 0===c||0===c.count)return}else if(0===l.count)return;let u,h=1;!0===i.wireframe&&(l=re.getWireframeAttribute(r),h=2),me.setup(n,i,a,r,l);let d=de;null!==l&&(u=te.get(l),d=fe,d.setIndex(u));const p=null!==l?l.count:c.count,m=r.drawRange.start*h,g=r.drawRange.count*h,v=null!==s?s.start*h:0,_=null!==s?s.count*h:1/0,y=Math.max(m,v),E=Math.min(p,m+g,v+_)-1,w=Math.max(0,E-y+1);if(0!==w){if(n.isMesh)!0===i.wireframe?(q.setLineWidth(i.wireframeLinewidth*H()),d.setMode(1)):d.setMode(4);else if(n.isLine){let e=i.linewidth;void 0===e&&(e=1),q.setLineWidth(e*H()),n.isLineSegments?d.setMode(1):n.isLineLoop?d.setMode(2):d.setMode(3)}else n.isPoints?d.setMode(0):n.isSprite&&d.setMode(4);if(n.isInstancedMesh)d.renderInstances(y,w,n.count);else if(r.isInstancedBufferGeometry){const e=Math.min(r.instanceCount,r._maxInstanceCount);d.renderInstances(y,w,e)}else d.render(y,w)}},this.compile=function(e,t){f=ae.get(e),f.init(),_.push(f),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(b.physicallyCorrectLights),e.traverse((function(t){const r=t.material;if(r)if(Array.isArray(r))for(let i=0;i<r.length;i++){Ne(r[i],e,t)}else Ne(r,e,t)})),_.pop(),f=null};let Te=null;function Se(){Ce.stop()}function Me(){Ce.start()}const Ce=new Es;function Re(e,t,r,i){if(!1===e.visible)return;if(e.layers.test(t.layers))if(e.isGroup)r=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)f.pushLight(e),e.castShadow&&f.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||D.intersectsSprite(e)){i&&z.setFromMatrixPosition(e.matrixWorld).applyMatrix4(F);const t=ie.update(e),n=e.material;n.visible&&d.push(e,t,n,r,z.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==X.render.frame&&(e.skeleton.update(),e.skeleton.frame=X.render.frame),!e.frustumCulled||D.intersectsObject(e))){i&&z.setFromMatrixPosition(e.matrixWorld).applyMatrix4(F);const t=ie.update(e),n=e.material;if(Array.isArray(n)){const i=t.groups;for(let s=0,o=i.length;s<o;s++){const o=i[s],a=n[o.materialIndex];a&&a.visible&&d.push(e,t,a,r,z.z,o)}}else n.visible&&d.push(e,t,n,r,z.z,null)}const n=e.children;for(let e=0,s=n.length;e<s;e++)Re(n[e],t,r,i)}function Pe(e,t,r,i){const n=e.opaque,s=e.transmissive,a=e.transparent;f.setupLightsView(r),s.length>0&&function(e,t,r){const i=Y.isWebGL2;null===B&&(B=new $r(1,1,{generateMipmaps:!0,type:null!==pe.convert(Oe)?Oe:Ae,minFilter:we,samples:i&&!0===o?4:0}));b.getDrawingBufferSize(j),i?B.setSize(j.x,j.y):B.setSize(Ar(j.x),Ar(j.y));const n=b.getRenderTarget();b.setRenderTarget(B),b.clear();const s=b.toneMapping;b.toneMapping=K,ke(e,t,r),b.toneMapping=s,J.updateMultisampleRenderTarget(B),J.updateRenderTargetMipmap(B),b.setRenderTarget(n)}(n,t,r),i&&q.viewport(S.copy(i)),n.length>0&&ke(n,t,r),s.length>0&&ke(s,t,r),a.length>0&&ke(a,t,r),q.buffers.depth.setTest(!0),q.buffers.depth.setMask(!0),q.buffers.color.setMask(!0),q.setPolygonOffset(!1)}function ke(e,t,r){const i=!0===t.isScene?t.overrideMaterial:null;for(let n=0,s=e.length;n<s;n++){const s=e[n],o=s.object,a=s.geometry,l=null===i?s.material:i,c=s.group;o.layers.test(r.layers)&&Le(o,t,r,a,l,c)}}function Le(e,t,r,i,n,s){e.onBeforeRender(b,t,r,i,n,s),e.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),n.onBeforeRender(b,t,r,i,e,s),!0===n.transparent&&n.side===g?(n.side=m,n.needsUpdate=!0,b.renderBufferDirect(r,t,i,n,e,s),n.side=p,n.needsUpdate=!0,b.renderBufferDirect(r,t,i,n,e,s),n.side=g):b.renderBufferDirect(r,t,i,n,e,s),e.onAfterRender(b,t,r,i,n,s)}function Ne(e,t,r){!0!==t.isScene&&(t=W);const i=Z.get(e),n=f.state.lights,s=f.state.shadowsArray,o=n.state.version,a=ne.getParameters(e,n.state,s,t,r),l=ne.getProgramCacheKey(a);let c=i.programs;i.environment=e.isMeshStandardMaterial?t.environment:null,i.fog=t.fog,i.envMap=(e.isMeshStandardMaterial?ee:Q).get(e.envMap||i.environment),void 0===c&&(e.addEventListener("dispose",xe),c=new Map,i.programs=c);let u=c.get(l);if(void 0!==u){if(i.currentProgram===u&&i.lightsStateVersion===o)return Ge(e,a),u}else a.uniforms=ne.getUniforms(e),e.onBuild(r,a,b),e.onBeforeCompile(a,b),u=ne.acquireProgram(a,l),c.set(l,u),i.uniforms=a.uniforms;const h=i.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(h.clippingPlanes=le.uniform),Ge(e,a),i.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),i.lightsStateVersion=o,i.needsLights&&(h.ambientLightColor.value=n.state.ambient,h.lightProbe.value=n.state.probe,h.directionalLights.value=n.state.directional,h.directionalLightShadows.value=n.state.directionalShadow,h.spotLights.value=n.state.spot,h.spotLightShadows.value=n.state.spotShadow,h.rectAreaLights.value=n.state.rectArea,h.ltc_1.value=n.state.rectAreaLTC1,h.ltc_2.value=n.state.rectAreaLTC2,h.pointLights.value=n.state.point,h.pointLightShadows.value=n.state.pointShadow,h.hemisphereLights.value=n.state.hemi,h.directionalShadowMap.value=n.state.directionalShadowMap,h.directionalShadowMatrix.value=n.state.directionalShadowMatrix,h.spotShadowMap.value=n.state.spotShadowMap,h.spotShadowMatrix.value=n.state.spotShadowMatrix,h.pointShadowMap.value=n.state.pointShadowMap,h.pointShadowMatrix.value=n.state.pointShadowMatrix);const d=u.getUniforms(),p=la.seqWithValue(d.seq,h);return i.currentProgram=u,i.uniformsList=p,u}function Ge(e,t){const r=Z.get(e);r.outputEncoding=t.outputEncoding,r.instancing=t.instancing,r.skinning=t.skinning,r.morphTargets=t.morphTargets,r.morphNormals=t.morphNormals,r.morphColors=t.morphColors,r.morphTargetsCount=t.morphTargetsCount,r.numClippingPlanes=t.numClippingPlanes,r.numIntersection=t.numClipIntersection,r.vertexAlphas=t.vertexAlphas,r.vertexTangents=t.vertexTangents,r.toneMapping=t.toneMapping}Ce.setAnimationLoop((function(e){Te&&Te(e)})),"undefined"!=typeof window&&Ce.setContext(window),this.setAnimationLoop=function(e){Te=e,be.setAnimationLoop(e),null===e?Ce.stop():Ce.start()},be.addEventListener("sessionstart",Se),be.addEventListener("sessionend",Me),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===y)return;!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===be.enabled&&!0===be.isPresenting&&(!0===be.cameraAutoUpdate&&be.updateCamera(t),t=be.getCamera()),!0===e.isScene&&e.onBeforeRender(b,e,t,x),f=ae.get(e,_.length),f.init(),_.push(f),F.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),D.setFromProjectionMatrix(F),V=this.localClippingEnabled,U=le.init(this.clippingPlanes,V,t),d=oe.get(e,v.length),d.init(),v.push(d),Re(e,t,0,b.sortObjects),d.finish(),!0===b.sortObjects&&d.sort(P,k),!0===U&&le.beginShadows();const r=f.state.shadowsArray;if(ce.render(r,e,t),!0===U&&le.endShadows(),!0===this.info.autoReset&&this.info.reset(),ue.render(d,e),f.setupLights(b.physicallyCorrectLights),t.isArrayCamera){const r=t.cameras;for(let t=0,i=r.length;t<i;t++){const i=r[t];Pe(d,e,i,i.viewport)}}else Pe(d,e,t);null!==x&&(J.updateMultisampleRenderTarget(x),J.updateRenderTargetMipmap(x)),!0===e.isScene&&e.onAfterRender(b,e,t),me.resetDefaultState(),A=-1,T=null,_.pop(),f=_.length>0?_[_.length-1]:null,v.pop(),d=v.length>0?v[v.length-1]:null},this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(e,t,r){Z.get(e.texture).__webglTexture=t,Z.get(e.depthTexture).__webglTexture=r;const i=Z.get(e);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===r,i.__autoAllocateDepthBuffer||!0===$.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){const r=Z.get(e);r.__webglFramebuffer=t,r.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,r=0){x=e,E=t,w=r;let i=!0;if(e){const t=Z.get(e);void 0!==t.__useDefaultFramebuffer?(q.bindFramebuffer(36160,null),i=!1):void 0===t.__webglFramebuffer?J.setupRenderTarget(e):t.__hasExternalTextures&&J.rebindTextures(e,Z.get(e.texture).__webglTexture,Z.get(e.depthTexture).__webglTexture)}let n=null,s=!1,o=!1;if(e){const r=e.texture;(r.isData3DTexture||r.isDataArrayTexture)&&(o=!0);const i=Z.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(n=i[t],s=!0):n=Y.isWebGL2&&e.samples>0&&!1===J.useMultisampledRTT(e)?Z.get(e).__webglMultisampledFramebuffer:i,S.copy(e.viewport),M.copy(e.scissor),C=e.scissorTest}else S.copy(L).multiplyScalar(O).floor(),M.copy(N).multiplyScalar(O).floor(),C=G;if(q.bindFramebuffer(36160,n)&&Y.drawBuffers&&i&&q.drawBuffers(e,n),q.viewport(S),q.scissor(M),q.setScissorTest(C),s){const i=Z.get(e.texture);ge.framebufferTexture2D(36160,36064,34069+t,i.__webglTexture,r)}else if(o){const i=Z.get(e.texture),n=t||0;ge.framebufferTextureLayer(36160,36064,i.__webglTexture,r||0,n)}A=-1},this.readRenderTargetPixels=function(e,t,r,i,n,s,o){if(!e||!e.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let a=Z.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(a=a[o]),a){q.bindFramebuffer(36160,a);try{const o=e.texture,a=o.format,l=o.type;if(a!==De&&pe.convert(a)!==ge.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const c=l===Oe&&($.has("EXT_color_buffer_half_float")||Y.isWebGL2&&$.has("EXT_color_buffer_float"));if(!(l===Ae||pe.convert(l)===ge.getParameter(35738)||l===Ie&&(Y.isWebGL2||$.has("OES_texture_float")||$.has("WEBGL_color_buffer_float"))||c))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ge.checkFramebufferStatus(36160)?t>=0&&t<=e.width-i&&r>=0&&r<=e.height-n&&ge.readPixels(t,r,i,n,pe.convert(a),pe.convert(l),s):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const e=null!==x?Z.get(x).__webglFramebuffer:null;q.bindFramebuffer(36160,e)}}},this.copyFramebufferToTexture=function(e,t,r=0){if(!0!==t.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const i=Math.pow(2,-r),n=Math.floor(t.image.width*i),s=Math.floor(t.image.height*i);J.setTexture2D(t,0),ge.copyTexSubImage2D(3553,r,0,0,e.x,e.y,n,s),q.unbindTexture()},this.copyTextureToTexture=function(e,t,r,i=0){const n=t.image.width,s=t.image.height,o=pe.convert(r.format),a=pe.convert(r.type);J.setTexture2D(r,0),ge.pixelStorei(37440,r.flipY),ge.pixelStorei(37441,r.premultiplyAlpha),ge.pixelStorei(3317,r.unpackAlignment),t.isDataTexture?ge.texSubImage2D(3553,i,e.x,e.y,n,s,o,a,t.image.data):t.isCompressedTexture?ge.compressedTexSubImage2D(3553,i,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ge.texSubImage2D(3553,i,e.x,e.y,o,a,t.image),0===i&&r.generateMipmaps&&ge.generateMipmap(3553),q.unbindTexture()},this.copyTextureToTexture3D=function(e,t,r,i,n=0){if(b.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const s=e.max.x-e.min.x+1,o=e.max.y-e.min.y+1,a=e.max.z-e.min.z+1,l=pe.convert(i.format),c=pe.convert(i.type);let u;if(i.isData3DTexture)J.setTexture3D(i,0),u=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");J.setTexture2DArray(i,0),u=35866}ge.pixelStorei(37440,i.flipY),ge.pixelStorei(37441,i.premultiplyAlpha),ge.pixelStorei(3317,i.unpackAlignment);const h=ge.getParameter(3314),d=ge.getParameter(32878),f=ge.getParameter(3316),p=ge.getParameter(3315),m=ge.getParameter(32877),g=r.isCompressedTexture?r.mipmaps[0]:r.image;ge.pixelStorei(3314,g.width),ge.pixelStorei(32878,g.height),ge.pixelStorei(3316,e.min.x),ge.pixelStorei(3315,e.min.y),ge.pixelStorei(32877,e.min.z),r.isDataTexture||r.isData3DTexture?ge.texSubImage3D(u,n,t.x,t.y,t.z,s,o,a,l,c,g.data):r.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ge.compressedTexSubImage3D(u,n,t.x,t.y,t.z,s,o,a,l,g.data)):ge.texSubImage3D(u,n,t.x,t.y,t.z,s,o,a,l,c,g),ge.pixelStorei(3314,h),ge.pixelStorei(32878,d),ge.pixelStorei(3316,f),ge.pixelStorei(3315,p),ge.pixelStorei(32877,m),0===n&&i.generateMipmaps&&ge.generateMipmap(u),q.unbindTexture()},this.initTexture=function(e){J.setTexture2D(e,0),q.unbindTexture()},this.resetState=function(){E=0,w=0,x=null,q.reset(),me.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}tl.prototype.isWebGLRenderer=!0;class rl extends tl{}rl.prototype.isWebGL1Renderer=!0;class il{constructor(e,t=25e-5){this.name="",this.color=new Ur(e),this.density=t}clone(){return new il(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}il.prototype.isFogExp2=!0;class nl{constructor(e,t=1,r=1e3){this.name="",this.color=new Ur(e),this.near=t,this.far=r}clone(){return new nl(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}nl.prototype.isFog=!0;class sl extends tn{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}sl.prototype.isScene=!0;class ol{constructor(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=tr,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=_r()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=_r()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=_r()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}ol.prototype.isInterleavedBuffer=!0;const al=new Qr;class ll{constructor(e,t,r,i=!1){this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=!0===i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)al.x=this.getX(t),al.y=this.getY(t),al.z=this.getZ(t),al.applyMatrix4(e),this.setXYZ(t,al.x,al.y,al.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)al.x=this.getX(t),al.y=this.getY(t),al.z=this.getZ(t),al.applyNormalMatrix(e),this.setXYZ(t,al.x,al.y,al.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)al.x=this.getX(t),al.y=this.getY(t),al.z=this.getZ(t),al.transformDirection(e),this.setXYZ(t,al.x,al.y,al.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return new bn(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ll(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const r=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[r+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}ll.prototype.isInterleavedBufferAttribute=!0;class cl extends mn{constructor(e){super(),this.type="SpriteMaterial",this.color=new Ur(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let ul;cl.prototype.isSpriteMaterial=!0;const hl=new Qr,dl=new Qr,fl=new Qr,pl=new Sr,ml=new Sr,gl=new Ii,vl=new Qr,_l=new Qr,bl=new Qr,yl=new Sr,El=new Sr,wl=new Sr;class xl extends tn{constructor(e){if(super(),this.type="Sprite",void 0===ul){ul=new Dn;const e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new ol(e,5);ul.setIndex([0,1,2,0,2,3]),ul.setAttribute("position",new ll(t,3,0,!1)),ul.setAttribute("uv",new ll(t,2,3,!1))}this.geometry=ul,this.material=void 0!==e?e:new cl,this.center=new Sr(.5,.5)}raycast(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),dl.setFromMatrixScale(this.matrixWorld),gl.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),fl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&dl.multiplyScalar(-fl.z);const r=this.material.rotation;let i,n;0!==r&&(n=Math.cos(r),i=Math.sin(r));const s=this.center;Al(vl.set(-.5,-.5,0),fl,s,dl,i,n),Al(_l.set(.5,-.5,0),fl,s,dl,i,n),Al(bl.set(.5,.5,0),fl,s,dl,i,n),yl.set(0,0),El.set(1,0),wl.set(1,1);let o=e.ray.intersectTriangle(vl,_l,bl,!1,hl);if(null===o&&(Al(_l.set(-.5,.5,0),fl,s,dl,i,n),El.set(0,1),o=e.ray.intersectTriangle(vl,bl,_l,!1,hl),null===o))return;const a=e.ray.origin.distanceTo(hl);a<e.near||a>e.far||t.push({distance:a,point:hl.clone(),uv:fn.getUV(hl,vl,_l,bl,yl,El,wl,new Sr),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Al(e,t,r,i,n,s){pl.subVectors(e,r).addScalar(.5).multiply(i),void 0!==n?(ml.x=s*pl.x-n*pl.y,ml.y=n*pl.x+s*pl.y):ml.copy(pl),e.copy(t),e.x+=ml.x,e.y+=ml.y,e.applyMatrix4(gl)}xl.prototype.isSprite=!0;const Tl=new Qr,Sl=new Qr;class Ml extends tn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let e=0,r=t.length;e<r;e++){const r=t[e];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const r=this.levels;let i;for(i=0;i<r.length&&!(t<r[i].distance);i++);return r.splice(i,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i&&!(e<t[r].distance);r++);return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){Tl.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Tl);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Tl.setFromMatrixPosition(e.matrixWorld),Sl.setFromMatrixPosition(this.matrixWorld);const r=Tl.distanceTo(Sl)/e.zoom;let i,n;for(t[0].object.visible=!0,i=1,n=t.length;i<n&&r>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(this._currentLevel=i-1;i<n;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let e=0,i=r.length;e<i;e++){const i=r[e];t.object.levels.push({object:i.object.uuid,distance:i.distance})}return t}}const Cl=new Qr,Rl=new Hr,Il=new Hr,Ol=new Qr,Pl=new Ii;class kl extends ts{constructor(e,t){super(e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ii,this.bindMatrixInverse=new Ii}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Hr,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.x=t.getX(r),e.y=t.getY(r),e.z=t.getZ(r),e.w=t.getW(r);const i=1/e.manhattanLength();i!==1/0?e.multiplyScalar(i):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const r=this.skeleton,i=this.geometry;Rl.fromBufferAttribute(i.attributes.skinIndex,e),Il.fromBufferAttribute(i.attributes.skinWeight,e),Cl.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){const i=Il.getComponent(e);if(0!==i){const n=Rl.getComponent(e);Pl.multiplyMatrices(r.bones[n].matrixWorld,r.boneInverses[n]),t.addScaledVector(Ol.copy(Cl).applyMatrix4(Pl),i)}}return t.applyMatrix4(this.bindMatrixInverse)}}kl.prototype.isSkinnedMesh=!0;class Ll extends tn{constructor(){super(),this.type="Bone"}}Ll.prototype.isBone=!0;class Nl extends Wr{constructor(e=null,t=1,r=1,i,n,s,o,a,l=pe,c=pe,u,h){super(null,s,o,a,l,c,i,n,u,h),this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Nl.prototype.isDataTexture=!0;const Gl=new Ii,Dl=new Ii;class Ul{constructor(e=[],t=[]){this.uuid=_r(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new Ii)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const t=new Ii;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let i=0,n=e.length;i<n;i++){const n=e[i]?e[i].matrixWorld:Dl;Gl.multiplyMatrices(n,t[i]),Gl.toArray(r,16*i)}null!==i&&(i.needsUpdate=!0)}clone(){return new Ul(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=xr(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Nl(t,e,e,De,Ie);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const i=e.bones[r];let n=t[i];void 0===n&&(console.warn("THREE.Skeleton: No bone found with UUID:",i),n=new Ll),this.bones.push(n),this.boneInverses.push((new Ii).fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,n=t.length;i<n;i++){const n=t[i];e.bones.push(n.uuid);const s=r[i];e.boneInverses.push(s.toArray())}return e}}class Vl extends bn{constructor(e,t,r,i=1){"number"==typeof r&&(i=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,r),this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Vl.prototype.isInstancedBufferAttribute=!0;const Bl=new Ii,Fl=new Ii,jl=[],zl=new ts;class Wl extends ts{constructor(e,t,r){super(e,t),this.instanceMatrix=new Vl(new Float32Array(16*r),16),this.instanceColor=null,this.count=r,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){const r=this.matrixWorld,i=this.count;if(zl.geometry=this.geometry,zl.material=this.material,void 0!==zl.material)for(let n=0;n<i;n++){this.getMatrixAt(n,Bl),Fl.multiplyMatrices(r,Bl),zl.matrixWorld=Fl,zl.raycast(e,jl);for(let e=0,r=jl.length;e<r;e++){const r=jl[e];r.instanceId=n,r.object=this,t.push(r)}jl.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new Vl(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Wl.prototype.isInstancedMesh=!0;class Hl extends mn{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Ur(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}Hl.prototype.isLineBasicMaterial=!0;const $l=new Qr,Yl=new Qr,ql=new Ii,Xl=new Ri,Zl=new Ei;class Jl extends tn{constructor(e=new Dn,t=new Hl){super(),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,r=[0];for(let e=1,i=t.count;e<i;e++)$l.fromBufferAttribute(t,e-1),Yl.fromBufferAttribute(t,e),r[e]=r[e-1],r[e]+=$l.distanceTo(Yl);e.setAttribute("lineDistance",new Cn(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),Zl.copy(r.boundingSphere),Zl.applyMatrix4(i),Zl.radius+=n,!1===e.ray.intersectsSphere(Zl))return;ql.copy(i).invert(),Xl.copy(e.ray).applyMatrix4(ql);const o=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new Qr,c=new Qr,u=new Qr,h=new Qr,d=this.isLineSegments?2:1;if(r.isBufferGeometry){const i=r.index,n=r.attributes.position;if(null!==i){for(let r=Math.max(0,s.start),o=Math.min(i.count,s.start+s.count)-1;r<o;r+=d){const s=i.getX(r),o=i.getX(r+1);l.fromBufferAttribute(n,s),c.fromBufferAttribute(n,o);if(Xl.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const d=e.ray.origin.distanceTo(h);d<e.near||d>e.far||t.push({distance:d,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}else{for(let r=Math.max(0,s.start),i=Math.min(n.count,s.start+s.count)-1;r<i;r+=d){l.fromBufferAttribute(n,r),c.fromBufferAttribute(n,r+1);if(Xl.distanceSqToSegment(l,c,h,u)>a)continue;h.applyMatrix4(this.matrixWorld);const i=e.ray.origin.distanceTo(h);i<e.near||i>e.far||t.push({distance:i,point:u.clone().applyMatrix4(this.matrixWorld),index:r,face:null,faceIndex:null,object:this})}}}else r.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Jl.prototype.isLine=!0;const Kl=new Qr,Ql=new Qr;class ec extends Jl{constructor(e,t){super(e,t),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const t=e.attributes.position,r=[];for(let e=0,i=t.count;e<i;e+=2)Kl.fromBufferAttribute(t,e),Ql.fromBufferAttribute(t,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+Kl.distanceTo(Ql);e.setAttribute("lineDistance",new Cn(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}ec.prototype.isLineSegments=!0;class tc extends Jl{constructor(e,t){super(e,t),this.type="LineLoop"}}tc.prototype.isLineLoop=!0;class rc extends mn{constructor(e){super(),this.type="PointsMaterial",this.color=new Ur(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}rc.prototype.isPointsMaterial=!0;const ic=new Ii,nc=new Ri,sc=new Ei,oc=new Qr;class ac extends tn{constructor(e=new Dn,t=new rc){super(),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,n=e.params.Points.threshold,s=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),sc.copy(r.boundingSphere),sc.applyMatrix4(i),sc.radius+=n,!1===e.ray.intersectsSphere(sc))return;ic.copy(i).invert(),nc.copy(e.ray).applyMatrix4(ic);const o=n/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o;if(r.isBufferGeometry){const n=r.index,o=r.attributes.position;if(null!==n){for(let r=Math.max(0,s.start),l=Math.min(n.count,s.start+s.count);r<l;r++){const s=n.getX(r);oc.fromBufferAttribute(o,s),lc(oc,s,a,i,e,t,this)}}else{for(let r=Math.max(0,s.start),n=Math.min(o.count,s.start+s.count);r<n;r++)oc.fromBufferAttribute(o,r),lc(oc,r,a,i,e,t,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const t=e.morphAttributes,r=Object.keys(t);if(r.length>0){const e=t[r[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,r=e.length;t<r;t++){const r=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}}}else{const t=e.morphTargets;void 0!==t&&t.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function lc(e,t,r,i,n,s,o){const a=nc.distanceSqToPoint(e);if(a<r){const r=new Qr;nc.closestPointToPoint(e,r),r.applyMatrix4(i);const l=n.ray.origin.distanceTo(r);if(l<n.near||l>n.far)return;s.push({distance:l,distanceToRay:Math.sqrt(a),point:r,index:t,face:null,object:o})}}ac.prototype.isPoints=!0;class cc extends Wr{constructor(e,t,r,i,n,s,o,a,l){super(e,t,r,i,n,s,o,a,l),this.minFilter=void 0!==s?s:be,this.magFilter=void 0!==n?n:be,this.generateMipmaps=!1;const c=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){c.needsUpdate=!0,e.requestVideoFrameCallback(t)}))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}cc.prototype.isVideoTexture=!0;class uc extends Wr{constructor(e,t,r){super({width:e,height:t}),this.format=r,this.magFilter=pe,this.minFilter=pe,this.generateMipmaps=!1,this.needsUpdate=!0}}uc.prototype.isFramebufferTexture=!0;class hc extends Wr{constructor(e,t,r,i,n,s,o,a,l,c,u,h){super(null,s,o,a,l,c,i,n,u,h),this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}hc.prototype.isCompressedTexture=!0;class dc extends Wr{constructor(e,t,r,i,n,s,o,a,l){super(e,t,r,i,n,s,o,a,l),this.needsUpdate=!0}}dc.prototype.isCanvasTexture=!0;class fc extends Dn{constructor(e=1,t=8,r=0,i=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const n=[],s=[],o=[],a=[],l=new Qr,c=new Sr;s.push(0,0,0),o.push(0,0,1),a.push(.5,.5);for(let n=0,u=3;n<=t;n++,u+=3){const h=r+n/t*i;l.x=e*Math.cos(h),l.y=e*Math.sin(h),s.push(l.x,l.y,l.z),o.push(0,0,1),c.x=(s[u]/e+1)/2,c.y=(s[u+1]/e+1)/2,a.push(c.x,c.y)}for(let e=1;e<=t;e++)n.push(e,e+1,0);this.setIndex(n),this.setAttribute("position",new Cn(s,3)),this.setAttribute("normal",new Cn(o,3)),this.setAttribute("uv",new Cn(a,2))}static fromJSON(e){return new fc(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class pc extends Dn{constructor(e=1,t=1,r=1,i=8,n=1,s=!1,o=0,a=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:o,thetaLength:a};const l=this;i=Math.floor(i),n=Math.floor(n);const c=[],u=[],h=[],d=[];let f=0;const p=[],m=r/2;let g=0;function v(r){const n=f,s=new Sr,p=new Qr;let v=0;const _=!0===r?e:t,b=!0===r?1:-1;for(let e=1;e<=i;e++)u.push(0,m*b,0),h.push(0,b,0),d.push(.5,.5),f++;const y=f;for(let e=0;e<=i;e++){const t=e/i*a+o,r=Math.cos(t),n=Math.sin(t);p.x=_*n,p.y=m*b,p.z=_*r,u.push(p.x,p.y,p.z),h.push(0,b,0),s.x=.5*r+.5,s.y=.5*n*b+.5,d.push(s.x,s.y),f++}for(let e=0;e<i;e++){const t=n+e,i=y+e;!0===r?c.push(i,i+1,t):c.push(i+1,i,t),v+=3}l.addGroup(g,v,!0===r?1:2),g+=v}!function(){const s=new Qr,v=new Qr;let _=0;const b=(t-e)/r;for(let l=0;l<=n;l++){const c=[],g=l/n,_=g*(t-e)+e;for(let e=0;e<=i;e++){const t=e/i,n=t*a+o,l=Math.sin(n),p=Math.cos(n);v.x=_*l,v.y=-g*r+m,v.z=_*p,u.push(v.x,v.y,v.z),s.set(l,b,p).normalize(),h.push(s.x,s.y,s.z),d.push(t,1-g),c.push(f++)}p.push(c)}for(let e=0;e<i;e++)for(let t=0;t<n;t++){const r=p[t][e],i=p[t+1][e],n=p[t+1][e+1],s=p[t][e+1];c.push(r,i,s),c.push(i,n,s),_+=6}l.addGroup(g,_,0),g+=_}(),!1===s&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(c),this.setAttribute("position",new Cn(u,3)),this.setAttribute("normal",new Cn(h,3)),this.setAttribute("uv",new Cn(d,2))}static fromJSON(e){return new pc(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class mc extends pc{constructor(e=1,t=1,r=8,i=1,n=!1,s=0,o=2*Math.PI){super(0,e,t,r,i,n,s,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:o}}static fromJSON(e){return new mc(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class gc extends Dn{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const n=[],s=[];function o(e,t,r,i){const n=i+1,s=[];for(let i=0;i<=n;i++){s[i]=[];const o=e.clone().lerp(r,i/n),a=t.clone().lerp(r,i/n),l=n-i;for(let e=0;e<=l;e++)s[i][e]=0===e&&i===n?o:o.clone().lerp(a,e/l)}for(let e=0;e<n;e++)for(let t=0;t<2*(n-e)-1;t++){const r=Math.floor(t/2);t%2==0?(a(s[e][r+1]),a(s[e+1][r]),a(s[e][r])):(a(s[e][r+1]),a(s[e+1][r+1]),a(s[e+1][r]))}}function a(e){n.push(e.x,e.y,e.z)}function l(t,r){const i=3*t;r.x=e[i+0],r.y=e[i+1],r.z=e[i+2]}function c(e,t,r,i){i<0&&1===e.x&&(s[t]=e.x-1),0===r.x&&0===r.z&&(s[t]=i/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}!function(e){const r=new Qr,i=new Qr,n=new Qr;for(let s=0;s<t.length;s+=3)l(t[s+0],r),l(t[s+1],i),l(t[s+2],n),o(r,i,n,e)}(i),function(e){const t=new Qr;for(let r=0;r<n.length;r+=3)t.x=n[r+0],t.y=n[r+1],t.z=n[r+2],t.normalize().multiplyScalar(e),n[r+0]=t.x,n[r+1]=t.y,n[r+2]=t.z}(r),function(){const e=new Qr;for(let r=0;r<n.length;r+=3){e.x=n[r+0],e.y=n[r+1],e.z=n[r+2];const i=u(e)/2/Math.PI+.5,o=(t=e,Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))/Math.PI+.5);s.push(i,1-o)}var t;(function(){const e=new Qr,t=new Qr,r=new Qr,i=new Qr,o=new Sr,a=new Sr,l=new Sr;for(let h=0,d=0;h<n.length;h+=9,d+=6){e.set(n[h+0],n[h+1],n[h+2]),t.set(n[h+3],n[h+4],n[h+5]),r.set(n[h+6],n[h+7],n[h+8]),o.set(s[d+0],s[d+1]),a.set(s[d+2],s[d+3]),l.set(s[d+4],s[d+5]),i.copy(e).add(t).add(r).divideScalar(3);const f=u(i);c(o,d+0,e,f),c(a,d+2,t,f),c(l,d+4,r,f)}})(),function(){for(let e=0;e<s.length;e+=6){const t=s[e+0],r=s[e+2],i=s[e+4],n=Math.max(t,r,i),o=Math.min(t,r,i);n>.9&&o<.1&&(t<.2&&(s[e+0]+=1),r<.2&&(s[e+2]+=1),i<.2&&(s[e+4]+=1))}}()}(),this.setAttribute("position",new Cn(n,3)),this.setAttribute("normal",new Cn(n.slice(),3)),this.setAttribute("uv",new Cn(s,2)),0===i?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new gc(e.vertices,e.indices,e.radius,e.details)}}class vc extends gc{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new vc(e.radius,e.detail)}}const _c=new Qr,bc=new Qr,yc=new Qr,Ec=new fn;class wc extends Dn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){const r=4,i=Math.pow(10,r),n=Math.cos(gr*t),s=e.getIndex(),o=e.getAttribute("position"),a=s?s.count:o.count,l=[0,0,0],c=["a","b","c"],u=new Array(3),h={},d=[];for(let e=0;e<a;e+=3){s?(l[0]=s.getX(e),l[1]=s.getX(e+1),l[2]=s.getX(e+2)):(l[0]=e,l[1]=e+1,l[2]=e+2);const{a:t,b:r,c:a}=Ec;if(t.fromBufferAttribute(o,l[0]),r.fromBufferAttribute(o,l[1]),a.fromBufferAttribute(o,l[2]),Ec.getNormal(yc),u[0]=`${Math.round(t.x*i)},${Math.round(t.y*i)},${Math.round(t.z*i)}`,u[1]=`${Math.round(r.x*i)},${Math.round(r.y*i)},${Math.round(r.z*i)}`,u[2]=`${Math.round(a.x*i)},${Math.round(a.y*i)},${Math.round(a.z*i)}`,u[0]!==u[1]&&u[1]!==u[2]&&u[2]!==u[0])for(let e=0;e<3;e++){const t=(e+1)%3,r=u[e],i=u[t],s=Ec[c[e]],o=Ec[c[t]],a=`${r}_${i}`,f=`${i}_${r}`;f in h&&h[f]?(yc.dot(h[f].normal)<=n&&(d.push(s.x,s.y,s.z),d.push(o.x,o.y,o.z)),h[f]=null):a in h||(h[a]={index0:l[e],index1:l[t],normal:yc.clone()})}}for(const e in h)if(h[e]){const{index0:t,index1:r}=h[e];_c.fromBufferAttribute(o,t),bc.fromBufferAttribute(o,r),d.push(_c.x,_c.y,_c.z),d.push(bc.x,bc.y,bc.z)}this.setAttribute("position",new Cn(d,3))}}}class xc{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const n=r.length;let s;s=t||e*r[n-1];let o,a=0,l=n-1;for(;a<=l;)if(i=Math.floor(a+(l-a)/2),o=r[i]-s,o<0)a=i+1;else{if(!(o>0)){l=i;break}l=i-1}if(i=l,r[i]===s)return i/(n-1);const c=r[i];return(i+(s-c)/(r[i+1]-c))/(n-1)}getTangent(e,t){const r=1e-4;let i=e-r,n=e+r;i<0&&(i=0),n>1&&(n=1);const s=this.getPoint(i),o=this.getPoint(n),a=t||(s.isVector2?new Sr:new Qr);return a.copy(o).sub(s).normalize(),a}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Qr,i=[],n=[],s=[],o=new Qr,a=new Ii;for(let t=0;t<=e;t++){const r=t/e;i[t]=this.getTangentAt(r,new Qr)}n[0]=new Qr,s[0]=new Qr;let l=Number.MAX_VALUE;const c=Math.abs(i[0].x),u=Math.abs(i[0].y),h=Math.abs(i[0].z);c<=l&&(l=c,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),h<=l&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],o),s[0].crossVectors(i[0],n[0]);for(let t=1;t<=e;t++){if(n[t]=n[t-1].clone(),s[t]=s[t-1].clone(),o.crossVectors(i[t-1],i[t]),o.length()>Number.EPSILON){o.normalize();const e=Math.acos(br(i[t-1].dot(i[t]),-1,1));n[t].applyMatrix4(a.makeRotationAxis(o,e))}s[t].crossVectors(i[t],n[t])}if(!0===t){let t=Math.acos(br(n[0].dot(n[e]),-1,1));t/=e,i[0].dot(o.crossVectors(n[0],n[e]))>0&&(t=-t);for(let r=1;r<=e;r++)n[r].applyMatrix4(a.makeRotationAxis(i[r],t*r)),s[r].crossVectors(i[r],n[r])}return{tangents:i,normals:n,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ac extends xc{constructor(e=0,t=0,r=1,i=1,n=0,s=2*Math.PI,o=!1,a=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(e,t){const r=t||new Sr,i=2*Math.PI;let n=this.aEndAngle-this.aStartAngle;const s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(n=s?0:i),!0!==this.aClockwise||s||(n===i?n=-i:n-=i);const o=this.aStartAngle+e*n;let a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){const e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),r=a-this.aX,i=l-this.aY;a=r*e-i*t+this.aX,l=r*t+i*e+this.aY}return r.set(a,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Ac.prototype.isEllipseCurve=!0;class Tc extends Ac{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.type="ArcCurve"}}function Sc(){let e=0,t=0,r=0,i=0;function n(n,s,o,a){e=n,t=o,r=-3*n+3*s-2*o-a,i=2*n-2*s+o+a}return{initCatmullRom:function(e,t,r,i,s){n(t,r,s*(r-e),s*(i-t))},initNonuniformCatmullRom:function(e,t,r,i,s,o,a){let l=(t-e)/s-(r-e)/(s+o)+(r-t)/o,c=(r-t)/o-(i-t)/(o+a)+(i-r)/a;l*=o,c*=o,n(t,r,l,c)},calc:function(n){const s=n*n;return e+t*n+r*s+i*(s*n)}}}Tc.prototype.isArcCurve=!0;const Mc=new Qr,Cc=new Sc,Rc=new Sc,Ic=new Sc;class Oc extends xc{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new Qr){const r=t,i=this.points,n=i.length,s=(n-(this.closed?0:1))*e;let o,a,l=Math.floor(s),c=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/n)+1)*n:0===c&&l===n-1&&(l=n-2,c=1),this.closed||l>0?o=i[(l-1)%n]:(Mc.subVectors(i[0],i[1]).add(i[0]),o=Mc);const u=i[l%n],h=i[(l+1)%n];if(this.closed||l+2<n?a=i[(l+2)%n]:(Mc.subVectors(i[n-1],i[n-2]).add(i[n-1]),a=Mc),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let t=Math.pow(o.distanceToSquared(u),e),r=Math.pow(u.distanceToSquared(h),e),i=Math.pow(h.distanceToSquared(a),e);r<1e-4&&(r=1),t<1e-4&&(t=r),i<1e-4&&(i=r),Cc.initNonuniformCatmullRom(o.x,u.x,h.x,a.x,t,r,i),Rc.initNonuniformCatmullRom(o.y,u.y,h.y,a.y,t,r,i),Ic.initNonuniformCatmullRom(o.z,u.z,h.z,a.z,t,r,i)}else"catmullrom"===this.curveType&&(Cc.initCatmullRom(o.x,u.x,h.x,a.x,this.tension),Rc.initCatmullRom(o.y,u.y,h.y,a.y,this.tension),Ic.initCatmullRom(o.z,u.z,h.z,a.z,this.tension));return r.set(Cc.calc(c),Rc.calc(c),Ic.calc(c)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push((new Qr).fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Pc(e,t,r,i,n){const s=.5*(i-t),o=.5*(n-r),a=e*e;return(2*r-2*i+s+o)*(e*a)+(-3*r+3*i-2*s-o)*a+s*e+r}function kc(e,t,r,i){return function(e,t){const r=1-e;return r*r*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,r)+function(e,t){return e*e*t}(e,i)}function Lc(e,t,r,i,n){return function(e,t){const r=1-e;return r*r*r*t}(e,t)+function(e,t){const r=1-e;return 3*r*r*e*t}(e,r)+function(e,t){return 3*(1-e)*e*e*t}(e,i)+function(e,t){return e*e*e*t}(e,n)}Oc.prototype.isCatmullRomCurve3=!0;class Nc extends xc{constructor(e=new Sr,t=new Sr,r=new Sr,i=new Sr){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Sr){const r=t,i=this.v0,n=this.v1,s=this.v2,o=this.v3;return r.set(Lc(e,i.x,n.x,s.x,o.x),Lc(e,i.y,n.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Nc.prototype.isCubicBezierCurve=!0;class Gc extends xc{constructor(e=new Qr,t=new Qr,r=new Qr,i=new Qr){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Qr){const r=t,i=this.v0,n=this.v1,s=this.v2,o=this.v3;return r.set(Lc(e,i.x,n.x,s.x,o.x),Lc(e,i.y,n.y,s.y,o.y),Lc(e,i.z,n.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Gc.prototype.isCubicBezierCurve3=!0;class Dc extends xc{constructor(e=new Sr,t=new Sr){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Sr){const r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const r=t||new Sr;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Dc.prototype.isLineCurve=!0;class Uc extends xc{constructor(e=new Qr,t=new Qr){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new Qr){const r=t;return 1===e?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Vc extends xc{constructor(e=new Sr,t=new Sr,r=new Sr){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Sr){const r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(kc(e,i.x,n.x,s.x),kc(e,i.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Vc.prototype.isQuadraticBezierCurve=!0;class Bc extends xc{constructor(e=new Qr,t=new Qr,r=new Qr){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Qr){const r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(kc(e,i.x,n.x,s.x),kc(e,i.y,n.y,s.y),kc(e,i.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Bc.prototype.isQuadraticBezierCurve3=!0;class Fc extends xc{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new Sr){const r=t,i=this.points,n=(i.length-1)*e,s=Math.floor(n),o=n-s,a=i[0===s?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return r.set(Pc(o,a.x,l.x,c.x,u.x),Pc(o,a.y,l.y,c.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const r=e.points[t];this.points.push((new Sr).fromArray(r))}return this}}Fc.prototype.isSplineCurve=!0;var jc=Object.freeze({__proto__:null,ArcCurve:Tc,CatmullRomCurve3:Oc,CubicBezierCurve:Nc,CubicBezierCurve3:Gc,EllipseCurve:Ac,LineCurve:Dc,LineCurve3:Uc,QuadraticBezierCurve:Vc,QuadraticBezierCurve3:Bc,SplineCurve:Fc});class zc extends xc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Dc(t,e))}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let n=0;for(;n<i.length;){if(i[n]>=r){const e=i[n]-r,s=this.curves[n],o=s.getLength(),a=0===o?0:1-e/o;return s.getPointAt(a,t)}n++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,n=this.curves;i<n.length;i++){const s=n[i],o=s.isEllipseCurve?2*e:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,a=s.getPoints(o);for(let e=0;e<a.length;e++){const i=a[e];r&&r.equals(i)||(t.push(i),r=i)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const r=e.curves[t];this.curves.push((new jc[r.type]).fromJSON(r))}return this}}class Wc extends zc{constructor(e){super(),this.type="Path",this.currentPoint=new Sr,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new Dc(this.currentPoint.clone(),new Sr(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const n=new Vc(this.currentPoint.clone(),new Sr(e,t),new Sr(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){const o=new Nc(this.currentPoint.clone(),new Sr(e,t),new Sr(r,i),new Sr(n,s));return this.curves.push(o),this.currentPoint.set(n,s),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new Fc(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){const o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+o,t+a,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,o,a){const l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,r,i,n,s,o,a),this}absellipse(e,t,r,i,n,s,o,a){const l=new Ac(e,t,r,i,n,s,o,a);if(this.curves.length>0){const e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);const c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Hc extends Wc{constructor(e){super(e),this.uuid=_r(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const r=e.holes[t];this.holes.push((new Wc).fromJSON(r))}return this}}const $c=function(e,t,r=2){const i=t&&t.length,n=i?t[0]*r:e.length;let s=Yc(e,0,n,r,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,u,h,d,f;if(i&&(s=function(e,t,r,i){const n=[];let s,o,a,l,c;for(s=0,o=t.length;s<o;s++)a=t[s]*i,l=s<o-1?t[s+1]*i:e.length,c=Yc(e,a,l,i,!1),c===c.next&&(c.steiner=!0),n.push(nu(c));for(n.sort(eu),s=0;s<n.length;s++)tu(n[s],r),r=qc(r,r.next);return r}(e,t,s,r)),e.length>80*r){a=c=e[0],l=u=e[1];for(let t=r;t<n;t+=r)h=e[t],d=e[t+1],h<a&&(a=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);f=Math.max(c-a,u-l),f=0!==f?1/f:0}return Xc(s,o,r,a,l,f),o};function Yc(e,t,r,i,n){let s,o;if(n===function(e,t,r,i){let n=0;for(let s=t,o=r-i;s<r;s+=i)n+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return n}(e,t,r,i)>0)for(s=t;s<r;s+=i)o=pu(s,e[s],e[s+1],o);else for(s=r-i;s>=t;s-=i)o=pu(s,e[s],e[s+1],o);return o&&lu(o,o.next)&&(mu(o),o=o.next),o}function qc(e,t){if(!e)return e;t||(t=e);let r,i=e;do{if(r=!1,i.steiner||!lu(i,i.next)&&0!==au(i.prev,i,i.next))i=i.next;else{if(mu(i),i=t=i.prev,i===i.next)break;r=!0}}while(r||i!==t);return t}function Xc(e,t,r,i,n,s,o){if(!e)return;!o&&s&&function(e,t,r,i){let n=e;do{null===n.z&&(n.z=iu(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){let t,r,i,n,s,o,a,l,c=1;do{for(r=e,e=null,s=null,o=0;r;){for(o++,i=r,a=0,t=0;t<c&&(a++,i=i.nextZ,i);t++);for(l=c;a>0||l>0&&i;)0!==a&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,c*=2}while(o>1)}(n)}(e,i,n,s);let a,l,c=e;for(;e.prev!==e.next;)if(a=e.prev,l=e.next,s?Jc(e,i,n,s):Zc(e))t.push(a.i/r),t.push(e.i/r),t.push(l.i/r),mu(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?Xc(e=Kc(qc(e),t,r),t,r,i,n,s,2):2===o&&Qc(e,t,r,i,n,s):Xc(qc(e),t,r,i,n,s,1);break}}function Zc(e){const t=e.prev,r=e,i=e.next;if(au(t,r,i)>=0)return!1;let n=e.next.next;for(;n!==e.prev;){if(su(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&au(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function Jc(e,t,r,i){const n=e.prev,s=e,o=e.next;if(au(n,s,o)>=0)return!1;const a=n.x<s.x?n.x<o.x?n.x:o.x:s.x<o.x?s.x:o.x,l=n.y<s.y?n.y<o.y?n.y:o.y:s.y<o.y?s.y:o.y,c=n.x>s.x?n.x>o.x?n.x:o.x:s.x>o.x?s.x:o.x,u=n.y>s.y?n.y>o.y?n.y:o.y:s.y>o.y?s.y:o.y,h=iu(a,l,t,r,i),d=iu(c,u,t,r,i);let f=e.prevZ,p=e.nextZ;for(;f&&f.z>=h&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&su(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&au(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&su(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&au(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&su(n.x,n.y,s.x,s.y,o.x,o.y,f.x,f.y)&&au(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&su(n.x,n.y,s.x,s.y,o.x,o.y,p.x,p.y)&&au(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Kc(e,t,r){let i=e;do{const n=i.prev,s=i.next.next;!lu(n,s)&&cu(n,i,i.next,s)&&du(n,s)&&du(s,n)&&(t.push(n.i/r),t.push(i.i/r),t.push(s.i/r),mu(i),mu(i.next),i=e=s),i=i.next}while(i!==e);return qc(i)}function Qc(e,t,r,i,n,s){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&ou(o,e)){let a=fu(o,e);return o=qc(o,o.next),a=qc(a,a.next),Xc(o,t,r,i,n,s),void Xc(a,t,r,i,n,s)}e=e.next}o=o.next}while(o!==e)}function eu(e,t){return e.x-t.x}function tu(e,t){if(t=function(e,t){let r=t;const i=e.x,n=e.y;let s,o=-1/0;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){const e=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(e<=i&&e>o){if(o=e,e===i){if(n===r.y)return r;if(n===r.next.y)return r.next}s=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!s)return null;if(i===o)return s;const a=s,l=s.x,c=s.y;let u,h=1/0;r=s;do{i>=r.x&&r.x>=l&&i!==r.x&&su(n<c?i:o,n,l,c,n<c?o:i,n,r.x,r.y)&&(u=Math.abs(n-r.y)/(i-r.x),du(r,e)&&(u<h||u===h&&(r.x>s.x||r.x===s.x&&ru(s,r)))&&(s=r,h=u)),r=r.next}while(r!==a);return s}(e,t),t){const r=fu(t,e);qc(t,t.next),qc(r,r.next)}}function ru(e,t){return au(e.prev,e,t.prev)<0&&au(t.next,e,e.next)<0}function iu(e,t,r,i,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function nu(e){let t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function su(e,t,r,i,n,s,o,a){return(n-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(i-a)-(r-o)*(t-a)>=0&&(r-o)*(s-a)-(n-o)*(i-a)>=0}function ou(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&cu(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(du(e,t)&&du(t,e)&&function(e,t){let r=e,i=!1;const n=(e.x+t.x)/2,s=(e.y+t.y)/2;do{r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==e);return i}(e,t)&&(au(e.prev,e,t.prev)||au(e,t.prev,t))||lu(e,t)&&au(e.prev,e,e.next)>0&&au(t.prev,t,t.next)>0)}function au(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function lu(e,t){return e.x===t.x&&e.y===t.y}function cu(e,t,r,i){const n=hu(au(e,t,r)),s=hu(au(e,t,i)),o=hu(au(r,i,e)),a=hu(au(r,i,t));return n!==s&&o!==a||(!(0!==n||!uu(e,r,t))||(!(0!==s||!uu(e,i,t))||(!(0!==o||!uu(r,e,i))||!(0!==a||!uu(r,t,i)))))}function uu(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function hu(e){return e>0?1:e<0?-1:0}function du(e,t){return au(e.prev,e,e.next)<0?au(e,t,e.next)>=0&&au(e,e.prev,t)>=0:au(e,t,e.prev)<0||au(e,e.next,t)<0}function fu(e,t){const r=new gu(e.i,e.x,e.y),i=new gu(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function pu(e,t,r,i){const n=new gu(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function mu(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function gu(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class vu{static area(e){const t=e.length;let r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return.5*r}static isClockWise(e){return vu.area(e)<0}static triangulateShape(e,t){const r=[],i=[],n=[];_u(e),bu(r,e);let s=e.length;t.forEach(_u);for(let e=0;e<t.length;e++)i.push(s),s+=t[e].length,bu(r,t[e]);const o=$c(r,i);for(let e=0;e<o.length;e+=3)n.push(o.slice(e,e+3));return n}}function _u(e){const t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function bu(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}class yu extends Dn{constructor(e=new Hc([new Sr(.5,.5),new Sr(-.5,.5),new Sr(-.5,-.5),new Sr(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],n=[];for(let t=0,r=e.length;t<r;t++){s(e[t])}function s(e){const s=[],o=void 0!==t.curveSegments?t.curveSegments:12,a=void 0!==t.steps?t.steps:1;let l=void 0!==t.depth?t.depth:1,c=void 0===t.bevelEnabled||t.bevelEnabled,u=void 0!==t.bevelThickness?t.bevelThickness:.2,h=void 0!==t.bevelSize?t.bevelSize:u-.1,d=void 0!==t.bevelOffset?t.bevelOffset:0,f=void 0!==t.bevelSegments?t.bevelSegments:3;const p=t.extrudePath,m=void 0!==t.UVGenerator?t.UVGenerator:Eu;void 0!==t.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),l=t.amount);let g,v,_,b,y,E=!1;p&&(g=p.getSpacedPoints(a),E=!0,c=!1,v=p.computeFrenetFrames(a,!1),_=new Qr,b=new Qr,y=new Qr),c||(f=0,u=0,h=0,d=0);const w=e.extractPoints(o);let x=w.shape;const A=w.holes;if(!vu.isClockWise(x)){x=x.reverse();for(let e=0,t=A.length;e<t;e++){const t=A[e];vu.isClockWise(t)&&(A[e]=t.reverse())}}const T=vu.triangulateShape(x,A),S=x;for(let e=0,t=A.length;e<t;e++){const t=A[e];x=x.concat(t)}function M(e,t,r){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(r).add(e)}const C=x.length,R=T.length;function I(e,t,r){let i,n,s;const o=e.x-t.x,a=e.y-t.y,l=r.x-e.x,c=r.y-e.y,u=o*o+a*a,h=o*c-a*l;if(Math.abs(h)>Number.EPSILON){const h=Math.sqrt(u),d=Math.sqrt(l*l+c*c),f=t.x-a/h,p=t.y+o/h,m=((r.x-c/d-f)*c-(r.y+l/d-p)*l)/(o*c-a*l);i=f+o*m-e.x,n=p+a*m-e.y;const g=i*i+n*n;if(g<=2)return new Sr(i,n);s=Math.sqrt(g/2)}else{let e=!1;o>Number.EPSILON?l>Number.EPSILON&&(e=!0):o<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(a)===Math.sign(c)&&(e=!0),e?(i=-a,n=o,s=Math.sqrt(u)):(i=o,n=a,s=Math.sqrt(u/2))}return new Sr(i/s,n/s)}const O=[];for(let e=0,t=S.length,r=t-1,i=e+1;e<t;e++,r++,i++)r===t&&(r=0),i===t&&(i=0),O[e]=I(S[e],S[r],S[i]);const P=[];let k,L=O.concat();for(let e=0,t=A.length;e<t;e++){const t=A[e];k=[];for(let e=0,r=t.length,i=r-1,n=e+1;e<r;e++,i++,n++)i===r&&(i=0),n===r&&(n=0),k[e]=I(t[e],t[i],t[n]);P.push(k),L=L.concat(k)}for(let e=0;e<f;e++){const t=e/f,r=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=S.length;e<t;e++){const t=M(S[e],O[e],i);D(t.x,t.y,-r)}for(let e=0,t=A.length;e<t;e++){const t=A[e];k=P[e];for(let e=0,n=t.length;e<n;e++){const n=M(t[e],k[e],i);D(n.x,n.y,-r)}}}const N=h+d;for(let e=0;e<C;e++){const t=c?M(x[e],L[e],N):x[e];E?(b.copy(v.normals[0]).multiplyScalar(t.x),_.copy(v.binormals[0]).multiplyScalar(t.y),y.copy(g[0]).add(b).add(_),D(y.x,y.y,y.z)):D(t.x,t.y,0)}for(let e=1;e<=a;e++)for(let t=0;t<C;t++){const r=c?M(x[t],L[t],N):x[t];E?(b.copy(v.normals[e]).multiplyScalar(r.x),_.copy(v.binormals[e]).multiplyScalar(r.y),y.copy(g[e]).add(b).add(_),D(y.x,y.y,y.z)):D(r.x,r.y,l/a*e)}for(let e=f-1;e>=0;e--){const t=e/f,r=u*Math.cos(t*Math.PI/2),i=h*Math.sin(t*Math.PI/2)+d;for(let e=0,t=S.length;e<t;e++){const t=M(S[e],O[e],i);D(t.x,t.y,l+r)}for(let e=0,t=A.length;e<t;e++){const t=A[e];k=P[e];for(let e=0,n=t.length;e<n;e++){const n=M(t[e],k[e],i);E?D(n.x,n.y+g[a-1].y,g[a-1].x+r):D(n.x,n.y,l+r)}}}function G(e,t){let r=e.length;for(;--r>=0;){const i=r;let n=r-1;n<0&&(n=e.length-1);for(let e=0,r=a+2*f;e<r;e++){const r=C*e,s=C*(e+1);V(t+i+r,t+n+r,t+n+s,t+i+s)}}}function D(e,t,r){s.push(e),s.push(t),s.push(r)}function U(e,t,n){B(e),B(t),B(n);const s=i.length/3,o=m.generateTopUV(r,i,s-3,s-2,s-1);F(o[0]),F(o[1]),F(o[2])}function V(e,t,n,s){B(e),B(t),B(s),B(t),B(n),B(s);const o=i.length/3,a=m.generateSideWallUV(r,i,o-6,o-3,o-2,o-1);F(a[0]),F(a[1]),F(a[3]),F(a[1]),F(a[2]),F(a[3])}function B(e){i.push(s[3*e+0]),i.push(s[3*e+1]),i.push(s[3*e+2])}function F(e){n.push(e.x),n.push(e.y)}!function(){const e=i.length/3;if(c){let e=0,t=C*e;for(let e=0;e<R;e++){const r=T[e];U(r[2]+t,r[1]+t,r[0]+t)}e=a+2*f,t=C*e;for(let e=0;e<R;e++){const r=T[e];U(r[0]+t,r[1]+t,r[2]+t)}}else{for(let e=0;e<R;e++){const t=T[e];U(t[2],t[1],t[0])}for(let e=0;e<R;e++){const t=T[e];U(t[0]+C*a,t[1]+C*a,t[2]+C*a)}}r.addGroup(e,i.length/3-e,0)}(),function(){const e=i.length/3;let t=0;G(S,t),t+=S.length;for(let e=0,r=A.length;e<r;e++){const r=A[e];G(r,t),t+=r.length}r.addGroup(e,i.length/3-e,1)}()}this.setAttribute("position",new Cn(i,3)),this.setAttribute("uv",new Cn(n,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(e,t,r){if(r.shapes=[],Array.isArray(e))for(let t=0,i=e.length;t<i;t++){const i=e[t];r.shapes.push(i.uuid)}else r.shapes.push(e.uuid);void 0!==t.extrudePath&&(r.options.extrudePath=t.extrudePath.toJSON());return r}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,t){const r=[];for(let i=0,n=e.shapes.length;i<n;i++){const n=t[e.shapes[i]];r.push(n)}const i=e.options.extrudePath;return void 0!==i&&(e.options.extrudePath=(new jc[i.type]).fromJSON(i)),new yu(r,e.options)}}const Eu={generateTopUV:function(e,t,r,i,n){const s=t[3*r],o=t[3*r+1],a=t[3*i],l=t[3*i+1],c=t[3*n],u=t[3*n+1];return[new Sr(s,o),new Sr(a,l),new Sr(c,u)]},generateSideWallUV:function(e,t,r,i,n,s){const o=t[3*r],a=t[3*r+1],l=t[3*r+2],c=t[3*i],u=t[3*i+1],h=t[3*i+2],d=t[3*n],f=t[3*n+1],p=t[3*n+2],m=t[3*s],g=t[3*s+1],v=t[3*s+2];return Math.abs(a-u)<Math.abs(o-c)?[new Sr(o,1-l),new Sr(c,1-h),new Sr(d,1-p),new Sr(m,1-v)]:[new Sr(a,1-l),new Sr(u,1-h),new Sr(f,1-p),new Sr(g,1-v)]}};class wu extends gc{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2;super([-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new wu(e.radius,e.detail)}}class xu extends Dn{constructor(e=[new Sr(0,.5),new Sr(.5,0),new Sr(0,-.5)],t=12,r=0,i=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=br(i,0,2*Math.PI);const n=[],s=[],o=[],a=[],l=[],c=1/t,u=new Qr,h=new Sr,d=new Qr,f=new Qr,p=new Qr;let m=0,g=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,d.x=1*g,d.y=-m,d.z=0*g,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case e.length-1:a.push(p.x,p.y,p.z);break;default:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,d.x=1*g,d.y=-m,d.z=0*g,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let n=0;n<=t;n++){const d=r+n*c*i,f=Math.sin(d),p=Math.cos(d);for(let r=0;r<=e.length-1;r++){u.x=e[r].x*f,u.y=e[r].y,u.z=e[r].x*p,s.push(u.x,u.y,u.z),h.x=n/t,h.y=r/(e.length-1),o.push(h.x,h.y);const i=a[3*r+0]*f,c=a[3*r+1],d=a[3*r+0]*p;l.push(i,c,d)}}for(let r=0;r<t;r++)for(let t=0;t<e.length-1;t++){const i=t+r*e.length,s=i,o=i+e.length,a=i+e.length+1,l=i+1;n.push(s,o,l),n.push(a,l,o)}this.setIndex(n),this.setAttribute("position",new Cn(s,3)),this.setAttribute("uv",new Cn(o,2)),this.setAttribute("normal",new Cn(l,3))}static fromJSON(e){return new xu(e.points,e.segments,e.phiStart,e.phiLength)}}class Au extends gc{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Au(e.radius,e.detail)}}class Tu extends Dn{constructor(e=.5,t=1,r=8,i=1,n=0,s=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:n,thetaLength:s},r=Math.max(3,r);const o=[],a=[],l=[],c=[];let u=e;const h=(t-e)/(i=Math.max(1,i)),d=new Qr,f=new Sr;for(let e=0;e<=i;e++){for(let e=0;e<=r;e++){const i=n+e/r*s;d.x=u*Math.cos(i),d.y=u*Math.sin(i),a.push(d.x,d.y,d.z),l.push(0,0,1),f.x=(d.x/t+1)/2,f.y=(d.y/t+1)/2,c.push(f.x,f.y)}u+=h}for(let e=0;e<i;e++){const t=e*(r+1);for(let e=0;e<r;e++){const i=e+t,n=i,s=i+r+1,a=i+r+2,l=i+1;o.push(n,s,l),o.push(s,a,l)}}this.setIndex(o),this.setAttribute("position",new Cn(a,3)),this.setAttribute("normal",new Cn(l,3)),this.setAttribute("uv",new Cn(c,2))}static fromJSON(e){return new Tu(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Su extends Dn{constructor(e=new Hc([new Sr(0,.5),new Sr(-.5,-.5),new Sr(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],n=[],s=[];let o=0,a=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(o,a,t),o+=a,a=0;function l(e){const o=i.length/3,l=e.extractPoints(t);let c=l.shape;const u=l.holes;!1===vu.isClockWise(c)&&(c=c.reverse());for(let e=0,t=u.length;e<t;e++){const t=u[e];!0===vu.isClockWise(t)&&(u[e]=t.reverse())}const h=vu.triangulateShape(c,u);for(let e=0,t=u.length;e<t;e++){const t=u[e];c=c.concat(t)}for(let e=0,t=c.length;e<t;e++){const t=c[e];i.push(t.x,t.y,0),n.push(0,0,1),s.push(t.x,t.y)}for(let e=0,t=h.length;e<t;e++){const t=h[e],i=t[0]+o,n=t[1]+o,s=t[2]+o;r.push(i,n,s),a+=3}}this.setIndex(r),this.setAttribute("position",new Cn(i,3)),this.setAttribute("normal",new Cn(n,3)),this.setAttribute("uv",new Cn(s,2))}toJSON(){const e=super.toJSON();return function(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){const i=e[r];t.shapes.push(i.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}static fromJSON(e,t){const r=[];for(let i=0,n=e.shapes.length;i<n;i++){const n=t[e.shapes[i]];r.push(n)}return new Su(r,e.curveSegments)}}class Mu extends Dn{constructor(e=1,t=32,r=16,i=0,n=2*Math.PI,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const a=Math.min(s+o,Math.PI);let l=0;const c=[],u=new Qr,h=new Qr,d=[],f=[],p=[],m=[];for(let d=0;d<=r;d++){const g=[],v=d/r;let _=0;0==d&&0==s?_=.5/t:d==r&&a==Math.PI&&(_=-.5/t);for(let r=0;r<=t;r++){const a=r/t;u.x=-e*Math.cos(i+a*n)*Math.sin(s+v*o),u.y=e*Math.cos(s+v*o),u.z=e*Math.sin(i+a*n)*Math.sin(s+v*o),f.push(u.x,u.y,u.z),h.copy(u).normalize(),p.push(h.x,h.y,h.z),m.push(a+_,1-v),g.push(l++)}c.push(g)}for(let e=0;e<r;e++)for(let i=0;i<t;i++){const t=c[e][i+1],n=c[e][i],o=c[e+1][i],l=c[e+1][i+1];(0!==e||s>0)&&d.push(t,n,l),(e!==r-1||a<Math.PI)&&d.push(n,o,l)}this.setIndex(d),this.setAttribute("position",new Cn(f,3)),this.setAttribute("normal",new Cn(p,3)),this.setAttribute("uv",new Cn(m,2))}static fromJSON(e){return new Mu(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Cu extends gc{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Cu(e.radius,e.detail)}}class Ru extends Dn{constructor(e=1,t=.4,r=8,i=6,n=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:n},r=Math.floor(r),i=Math.floor(i);const s=[],o=[],a=[],l=[],c=new Qr,u=new Qr,h=new Qr;for(let s=0;s<=r;s++)for(let d=0;d<=i;d++){const f=d/i*n,p=s/r*Math.PI*2;u.x=(e+t*Math.cos(p))*Math.cos(f),u.y=(e+t*Math.cos(p))*Math.sin(f),u.z=t*Math.sin(p),o.push(u.x,u.y,u.z),c.x=e*Math.cos(f),c.y=e*Math.sin(f),h.subVectors(u,c).normalize(),a.push(h.x,h.y,h.z),l.push(d/i),l.push(s/r)}for(let e=1;e<=r;e++)for(let t=1;t<=i;t++){const r=(i+1)*e+t-1,n=(i+1)*(e-1)+t-1,o=(i+1)*(e-1)+t,a=(i+1)*e+t;s.push(r,n,a),s.push(n,o,a)}this.setIndex(s),this.setAttribute("position",new Cn(o,3)),this.setAttribute("normal",new Cn(a,3)),this.setAttribute("uv",new Cn(l,2))}static fromJSON(e){return new Ru(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Iu extends Dn{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);const o=[],a=[],l=[],c=[],u=new Qr,h=new Qr,d=new Qr,f=new Qr,p=new Qr,m=new Qr,g=new Qr;for(let o=0;o<=r;++o){const _=o/r*n*Math.PI*2;v(_,n,s,e,d),v(_+.01,n,s,e,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=i;++e){const n=e/i*Math.PI*2,s=-t*Math.cos(n),f=t*Math.sin(n);u.x=d.x+(s*g.x+f*p.x),u.y=d.y+(s*g.y+f*p.y),u.z=d.z+(s*g.z+f*p.z),a.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(o/r),c.push(e/i)}}for(let e=1;e<=r;e++)for(let t=1;t<=i;t++){const r=(i+1)*(e-1)+(t-1),n=(i+1)*e+(t-1),s=(i+1)*e+t,a=(i+1)*(e-1)+t;o.push(r,n,a),o.push(n,s,a)}function v(e,t,r,i,n){const s=Math.cos(e),o=Math.sin(e),a=r/t*e,l=Math.cos(a);n.x=i*(2+l)*.5*s,n.y=i*(2+l)*o*.5,n.z=i*Math.sin(a)*.5}this.setIndex(o),this.setAttribute("position",new Cn(a,3)),this.setAttribute("normal",new Cn(l,3)),this.setAttribute("uv",new Cn(c,2))}static fromJSON(e){return new Iu(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Ou extends Dn{constructor(e=new Bc(new Qr(-1,-1,0),new Qr(-1,1,0),new Qr(1,1,0)),t=64,r=1,i=8,n=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:n};const s=e.computeFrenetFrames(t,n);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals;const o=new Qr,a=new Qr,l=new Sr;let c=new Qr;const u=[],h=[],d=[],f=[];function p(n){c=e.getPointAt(n/t,c);const l=s.normals[n],d=s.binormals[n];for(let e=0;e<=i;e++){const t=e/i*Math.PI*2,n=Math.sin(t),s=-Math.cos(t);a.x=s*l.x+n*d.x,a.y=s*l.y+n*d.y,a.z=s*l.z+n*d.z,a.normalize(),h.push(a.x,a.y,a.z),o.x=c.x+r*a.x,o.y=c.y+r*a.y,o.z=c.z+r*a.z,u.push(o.x,o.y,o.z)}}!function(){for(let e=0;e<t;e++)p(e);p(!1===n?t:0),function(){for(let e=0;e<=t;e++)for(let r=0;r<=i;r++)l.x=e/t,l.y=r/i,d.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=i;t++){const r=(i+1)*(e-1)+(t-1),n=(i+1)*e+(t-1),s=(i+1)*e+t,o=(i+1)*(e-1)+t;f.push(r,n,o),f.push(n,s,o)}}()}(),this.setIndex(f),this.setAttribute("position",new Cn(u,3)),this.setAttribute("normal",new Cn(h,3)),this.setAttribute("uv",new Cn(d,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Ou((new jc[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Pu extends Dn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){const t=[],r=new Set,i=new Qr,n=new Qr;if(null!==e.index){const s=e.attributes.position,o=e.index;let a=e.groups;0===a.length&&(a=[{start:0,count:o.count,materialIndex:0}]);for(let e=0,l=a.length;e<l;++e){const l=a[e],c=l.start;for(let e=c,a=c+l.count;e<a;e+=3)for(let a=0;a<3;a++){const l=o.getX(e+a),c=o.getX(e+(a+1)%3);i.fromBufferAttribute(s,l),n.fromBufferAttribute(s,c),!0===ku(i,n,r)&&(t.push(i.x,i.y,i.z),t.push(n.x,n.y,n.z))}}}else{const s=e.attributes.position;for(let e=0,o=s.count/3;e<o;e++)for(let o=0;o<3;o++){const a=3*e+o,l=3*e+(o+1)%3;i.fromBufferAttribute(s,a),n.fromBufferAttribute(s,l),!0===ku(i,n,r)&&(t.push(i.x,i.y,i.z),t.push(n.x,n.y,n.z))}}this.setAttribute("position",new Cn(t,3))}}}function ku(e,t,r){const i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,n=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==r.has(i)&&!0!==r.has(n)&&(r.add(i),r.add(n),!0)}var Lu=Object.freeze({__proto__:null,BoxGeometry:is,BoxBufferGeometry:is,CircleGeometry:fc,CircleBufferGeometry:fc,ConeGeometry:mc,ConeBufferGeometry:mc,CylinderGeometry:pc,CylinderBufferGeometry:pc,DodecahedronGeometry:vc,DodecahedronBufferGeometry:vc,EdgesGeometry:wc,ExtrudeGeometry:yu,ExtrudeBufferGeometry:yu,IcosahedronGeometry:wu,IcosahedronBufferGeometry:wu,LatheGeometry:xu,LatheBufferGeometry:xu,OctahedronGeometry:Au,OctahedronBufferGeometry:Au,PlaneGeometry:xs,PlaneBufferGeometry:xs,PolyhedronGeometry:gc,PolyhedronBufferGeometry:gc,RingGeometry:Tu,RingBufferGeometry:Tu,ShapeGeometry:Su,ShapeBufferGeometry:Su,SphereGeometry:Mu,SphereBufferGeometry:Mu,TetrahedronGeometry:Cu,TetrahedronBufferGeometry:Cu,TorusGeometry:Ru,TorusBufferGeometry:Ru,TorusKnotGeometry:Iu,TorusKnotBufferGeometry:Iu,TubeGeometry:Ou,TubeBufferGeometry:Ou,WireframeGeometry:Pu});class Nu extends mn{constructor(e){super(),this.type="ShadowMaterial",this.color=new Ur(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}Nu.prototype.isShadowMaterial=!0;class Gu extends as{constructor(e){super(e),this.type="RawShaderMaterial"}}Gu.prototype.isRawShaderMaterial=!0;class Du extends mn{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ur(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ur(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Sr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Du.prototype.isMeshStandardMaterial=!0;class Uu extends Du{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Sr(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return br(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.sheenColor=new Ur(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ur(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ur(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}Uu.prototype.isMeshPhysicalMaterial=!0;class Vu extends mn{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Ur(16777215),this.specular=new Ur(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ur(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Sr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}Vu.prototype.isMeshPhongMaterial=!0;class Bu extends mn{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ur(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ur(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Sr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Bu.prototype.isMeshToonMaterial=!0;class Fu extends mn{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Sr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}Fu.prototype.isMeshNormalMaterial=!0;class ju extends mn{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Ur(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ur(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=X,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}ju.prototype.isMeshLambertMaterial=!0;class zu extends mn{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ur(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Dt,this.normalScale=new Sr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}zu.prototype.isMeshMatcapMaterial=!0;class Wu extends Hl{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}Wu.prototype.isLineDashedMaterial=!0;const Hu={ShadowMaterial:Nu,SpriteMaterial:cl,RawShaderMaterial:Gu,ShaderMaterial:as,PointsMaterial:rc,MeshPhysicalMaterial:Uu,MeshStandardMaterial:Du,MeshPhongMaterial:Vu,MeshToonMaterial:Bu,MeshNormalMaterial:Fu,MeshLambertMaterial:ju,MeshDepthMaterial:ja,MeshDistanceMaterial:za,MeshBasicMaterial:gn,MeshMatcapMaterial:zu,LineDashedMaterial:Wu,LineBasicMaterial:Hl,Material:mn};mn.fromType=function(e){return new Hu[e]};const $u={arraySlice:function(e,t,r){return $u.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==r?r:e.length)):e.slice(t,r)},convertArray:function(e,t,r){return!e||!r&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){const t=e.length,r=new Array(t);for(let e=0;e!==t;++e)r[e]=e;return r.sort((function(t,r){return e[t]-e[r]})),r},sortedArray:function(e,t,r){const i=e.length,n=new e.constructor(i);for(let s=0,o=0;o!==i;++s){const i=r[s]*t;for(let r=0;r!==t;++r)n[o++]=e[i+r]}return n},flattenJSON:function(e,t,r,i){let n=1,s=e[0];for(;void 0!==s&&void 0===s[i];)s=e[n++];if(void 0===s)return;let o=s[i];if(void 0!==o)if(Array.isArray(o))do{o=s[i],void 0!==o&&(t.push(s.time),r.push.apply(r,o)),s=e[n++]}while(void 0!==s);else if(void 0!==o.toArray)do{o=s[i],void 0!==o&&(t.push(s.time),o.toArray(r,r.length)),s=e[n++]}while(void 0!==s);else do{o=s[i],void 0!==o&&(t.push(s.time),r.push(o)),s=e[n++]}while(void 0!==s)},subclip:function(e,t,r,i,n=30){const s=e.clone();s.name=t;const o=[];for(let e=0;e<s.tracks.length;++e){const t=s.tracks[e],a=t.getValueSize(),l=[],c=[];for(let e=0;e<t.times.length;++e){const s=t.times[e]*n;if(!(s<r||s>=i)){l.push(t.times[e]);for(let r=0;r<a;++r)c.push(t.values[e*a+r])}}0!==l.length&&(t.times=$u.convertArray(l,t.times.constructor),t.values=$u.convertArray(c,t.values.constructor),o.push(t))}s.tracks=o;let a=1/0;for(let e=0;e<s.tracks.length;++e)a>s.tracks[e].times[0]&&(a=s.tracks[e].times[0]);for(let e=0;e<s.tracks.length;++e)s.tracks[e].shift(-1*a);return s.resetDuration(),s},makeClipAdditive:function(e,t=0,r=e,i=30){i<=0&&(i=30);const n=r.tracks.length,s=t/i;for(let t=0;t<n;++t){const i=r.tracks[t],n=i.ValueTypeName;if("bool"===n||"string"===n)continue;const o=e.tracks.find((function(e){return e.name===i.name&&e.ValueTypeName===n}));if(void 0===o)continue;let a=0;const l=i.getValueSize();i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(a=l/3);let c=0;const u=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=u/3);const h=i.times.length-1;let d;if(s<=i.times[0]){const e=a,t=l-a;d=$u.arraySlice(i.values,e,t)}else if(s>=i.times[h]){const e=h*l+a,t=e+l-a;d=$u.arraySlice(i.values,e,t)}else{const e=i.createInterpolant(),t=a,r=l-a;e.evaluate(s),d=$u.arraySlice(e.resultBuffer,t,r)}if("quaternion"===n){(new Kr).fromArray(d).normalize().conjugate().toArray(d)}const f=o.times.length;for(let e=0;e<f;++e){const t=e*u+c;if("quaternion"===n)Kr.multiplyQuaternionsFlat(o.values,t,d,0,o.values,t);else{const e=u-2*c;for(let r=0;r<e;++r)o.values[t+r]-=d[r]}}}return e.blendMode=Rt,e}};class Yu{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==i?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],n=t[r-1];e:{t:{let s;r:{i:if(!(e<i)){for(let s=r+2;;){if(void 0===i){if(e<n)break i;return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,e,n)}if(r===s)break;if(n=i,i=t[++r],e<i)break t}s=t.length;break r}if(e>=n)break e;{const o=t[1];e<o&&(r=2,n=o);for(let s=r-2;;){if(void 0===n)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(r===s)break;if(i=n,n=t[--r-1],e>=n)break t}s=r,r=0}}for(;r<s;){const i=r+s>>>1;e<t[i]?s=i:r=i+1}if(i=t[r],n=t[r-1],void 0===n)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(void 0===i)return r=t.length,this._cachedIndex=r,this.afterEnd_(r-1,n,e)}this._cachedIndex=r,this.intervalChanged_(r,n,i)}return this.interpolate_(r,n,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i;for(let e=0;e!==i;++e)t[e]=r[n+e];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Yu.prototype.beforeStart_=Yu.prototype.copySampleValue_,Yu.prototype.afterEnd_=Yu.prototype.copySampleValue_;class qu extends Yu{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Tt,endingEnd:Tt}}intervalChanged_(e,t,r){const i=this.parameterPositions;let n=e-2,s=e+1,o=i[n],a=i[s];if(void 0===o)switch(this.getSettings_().endingStart){case St:n=e,o=2*t-r;break;case Mt:n=i.length-2,o=t+i[n]-i[n+1];break;default:n=e,o=r}if(void 0===a)switch(this.getSettings_().endingEnd){case St:s=e,a=2*r-t;break;case Mt:s=1,a=r+i[1]-i[0];break;default:s=e-1,a=t}const l=.5*(r-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(a-r),this._offsetPrev=n*c,this._offsetNext=s*c}interpolate_(e,t,r,i){const n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,f=(r-t)/(i-t),p=f*f,m=p*f,g=-h*m+2*h*p-h*f,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*f+1,_=(-1-d)*m+(1.5+d)*p+.5*f,b=d*m-d*p;for(let e=0;e!==o;++e)n[e]=g*s[c+e]+v*s[l+e]+_*s[a+e]+b*s[u+e];return n}}class Xu extends Yu{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=e*o,l=a-o,c=(r-t)/(i-t),u=1-c;for(let e=0;e!==o;++e)n[e]=s[l+e]*u+s[a+e]*c;return n}}class Zu extends Yu{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ju{constructor(e,t,r,i){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=$u.convertArray(t,this.TimeBufferType),this.values=$u.convertArray(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:$u.convertArray(e.times,Array),values:$u.convertArray(e.values,Array)};const t=e.getInterpolation();t!==e.DefaultInterpolation&&(r.interpolation=t)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Zu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Xu(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new qu(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case wt:t=this.InterpolantFactoryMethodDiscrete;break;case xt:t=this.InterpolantFactoryMethodLinear;break;case At:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(t);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return wt;case this.InterpolantFactoryMethodLinear:return xt;case this.InterpolantFactoryMethodSmooth:return At}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let n=0,s=i-1;for(;n!==i&&r[n]<e;)++n;for(;-1!==s&&r[s]>t;)--s;if(++s,0!==n||s!==i){n>=s&&(s=Math.max(s,1),n=s-1);const e=this.getValueSize();this.times=$u.arraySlice(r,n,s),this.values=$u.arraySlice(this.values,n*e,s*e)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,n=r.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let t=0;t!==n;t++){const i=r[t];if("number"==typeof i&&isNaN(i)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,i),e=!1;break}if(null!==s&&s>i){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,i,s),e=!1;break}s=i}if(void 0!==i&&$u.isTypedArray(i))for(let t=0,r=i.length;t!==r;++t){const r=i[t];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,r),e=!1;break}}return e}optimize(){const e=$u.arraySlice(this.times),t=$u.arraySlice(this.values),r=this.getValueSize(),i=this.getInterpolation()===At,n=e.length-1;let s=1;for(let o=1;o<n;++o){let n=!1;const a=e[o];if(a!==e[o+1]&&(1!==o||a!==e[0]))if(i)n=!0;else{const e=o*r,i=e-r,s=e+r;for(let o=0;o!==r;++o){const r=t[e+o];if(r!==t[i+o]||r!==t[s+o]){n=!0;break}}}if(n){if(o!==s){e[s]=e[o];const i=o*r,n=s*r;for(let e=0;e!==r;++e)t[n+e]=t[i+e]}++s}}if(n>0){e[s]=e[n];for(let e=n*r,i=s*r,o=0;o!==r;++o)t[i+o]=t[e+o];++s}return s!==e.length?(this.times=$u.arraySlice(e,0,s),this.values=$u.arraySlice(t,0,s*r)):(this.times=e,this.values=t),this}clone(){const e=$u.arraySlice(this.times,0),t=$u.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ju.prototype.TimeBufferType=Float32Array,Ju.prototype.ValueBufferType=Float32Array,Ju.prototype.DefaultInterpolation=xt;class Ku extends Ju{}Ku.prototype.ValueTypeName="bool",Ku.prototype.ValueBufferType=Array,Ku.prototype.DefaultInterpolation=wt,Ku.prototype.InterpolantFactoryMethodLinear=void 0,Ku.prototype.InterpolantFactoryMethodSmooth=void 0;class Qu extends Ju{}Qu.prototype.ValueTypeName="color";class eh extends Ju{}eh.prototype.ValueTypeName="number";class th extends Yu{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=(r-t)/(i-t);let l=e*o;for(let e=l+o;l!==e;l+=4)Kr.slerpFlat(n,0,s,l-o,s,l,a);return n}}class rh extends Ju{InterpolantFactoryMethodLinear(e){return new th(this.times,this.values,this.getValueSize(),e)}}rh.prototype.ValueTypeName="quaternion",rh.prototype.DefaultInterpolation=xt,rh.prototype.InterpolantFactoryMethodSmooth=void 0;class ih extends Ju{}ih.prototype.ValueTypeName="string",ih.prototype.ValueBufferType=Array,ih.prototype.DefaultInterpolation=wt,ih.prototype.InterpolantFactoryMethodLinear=void 0,ih.prototype.InterpolantFactoryMethodSmooth=void 0;class nh extends Ju{}nh.prototype.ValueTypeName="vector";class sh{constructor(e,t=-1,r,i=Ct){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=_r(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let e=0,n=r.length;e!==n;++e)t.push(oh(r[e]).scale(i));const n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,i=r.length;e!==i;++e)t.push(Ju.toJSON(r[e]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const n=t.length,s=[];for(let e=0;e<n;e++){let o=[],a=[];o.push((e+n-1)%n,e,(e+1)%n),a.push(0,1,0);const l=$u.getKeyframeOrder(o);o=$u.sortedArray(o,1,l),a=$u.sortedArray(a,1,l),i||0!==o[0]||(o.push(n),a.push(a[0])),s.push(new eh(".morphTargetInfluences["+t[e].name+"]",o,a).scale(1/r))}return new this(e,-1,s)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const t=e;r=t.geometry&&t.geometry.animations||t.animations}for(let e=0;e<r.length;e++)if(r[e].name===t)return r[e];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},n=/^([\w-]*?)([\d]+)$/;for(let t=0,r=e.length;t<r;t++){const r=e[t],s=r.name.match(n);if(s&&s.length>1){const e=s[1];let t=i[e];t||(i[e]=t=[]),t.push(r)}}const s=[];for(const e in i)s.push(this.CreateFromMorphTargetSequence(e,i[e],t,r));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(e,t,r,i,n){if(0!==r.length){const s=[],o=[];$u.flattenJSON(r,s,o,i),0!==s.length&&n.push(new e(t,s,o))}},i=[],n=e.name||"default",s=e.fps||30,o=e.blendMode;let a=e.length||-1;const l=e.hierarchy||[];for(let e=0;e<l.length;e++){const n=l[e].keys;if(n&&0!==n.length)if(n[0].morphTargets){const e={};let t;for(t=0;t<n.length;t++)if(n[t].morphTargets)for(let r=0;r<n[t].morphTargets.length;r++)e[n[t].morphTargets[r]]=-1;for(const r in e){const e=[],s=[];for(let i=0;i!==n[t].morphTargets.length;++i){const i=n[t];e.push(i.time),s.push(i.morphTarget===r?1:0)}i.push(new eh(".morphTargetInfluence["+r+"]",e,s))}a=e.length*s}else{const s=".bones["+t[e].name+"]";r(nh,s+".position",n,"pos",i),r(rh,s+".quaternion",n,"rot",i),r(nh,s+".scale",n,"scl",i)}}if(0===i.length)return null;return new this(n,a,i,o)}resetDuration(){let e=0;for(let t=0,r=this.tracks.length;t!==r;++t){const r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function oh(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return eh;case"vector":case"vector2":case"vector3":case"vector4":return nh;case"color":return Qu;case"quaternion":return rh;case"bool":case"boolean":return Ku;case"string":return ih}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){const t=[],r=[];$u.flattenJSON(e.keys,t,r,"value"),e.times=t,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}const ah={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class lh{constructor(e,t,r){const i=this;let n,s=!1,o=0,a=0;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(e){a++,!1===s&&void 0!==i.onStart&&i.onStart(e,o,a),s=!0},this.itemEnd=function(e){o++,void 0!==i.onProgress&&i.onProgress(e,o,a),o===a&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(e){void 0!==i.onError&&i.onError(e)},this.resolveURL=function(e){return n?n(e):e},this.setURLModifier=function(e){return n=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){const t=l.indexOf(e);return-1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,r=l.length;t<r;t+=2){const r=l[t],i=l[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return i}return null}}}const ch=new lh;class uh{constructor(e){this.manager=void 0!==e?e:ch,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise((function(i,n){r.load(e,i,t,n)}))}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const hh={};class dh extends uh{constructor(e){super(e)}load(e,t,r,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const n=ah.get(e);if(void 0!==n)return this.manager.itemStart(e),setTimeout((()=>{t&&t(n),this.manager.itemEnd(e)}),0),n;if(void 0!==hh[e])return void hh[e].push({onLoad:t,onProgress:r,onError:i});hh[e]=[],hh[e].push({onLoad:t,onProgress:r,onError:i});const s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then((t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;const r=hh[e],i=t.body.getReader(),n=t.headers.get("Content-Length"),s=n?parseInt(n):0,o=0!==s;let a=0;const l=new ReadableStream({start(e){!function t(){i.read().then((({done:i,value:n})=>{if(i)e.close();else{a+=n.byteLength;const i=new ProgressEvent("progress",{lengthComputable:o,loaded:a,total:s});for(let e=0,t=r.length;e<t;e++){const t=r[e];t.onProgress&&t.onProgress(i)}e.enqueue(n),t()}}))}()}});return new Response(l)}throw Error(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`)})).then((e=>{switch(a){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then((e=>(new DOMParser).parseFromString(e,o)));case"json":return e.json();default:if(void 0===o)return e.text();{const t=/charset="?([^;"\s]*)"?/i.exec(o),r=t&&t[1]?t[1].toLowerCase():void 0,i=new TextDecoder(r);return e.arrayBuffer().then((e=>i.decode(e)))}}})).then((t=>{ah.add(e,t);const r=hh[e];delete hh[e];for(let e=0,i=r.length;e<i;e++){const i=r[e];i.onLoad&&i.onLoad(t)}})).catch((t=>{const r=hh[e];if(void 0===r)throw this.manager.itemError(e),t;delete hh[e];for(let e=0,i=r.length;e<i;e++){const i=r[e];i.onError&&i.onError(t)}this.manager.itemError(e)})).finally((()=>{this.manager.itemEnd(e)})),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class fh extends uh{constructor(e){super(e)}load(e,t,r,i){const n=this,s=new dh(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{t(n.parse(JSON.parse(r)))}catch(t){i?i(t):console.error(t),n.manager.itemError(e)}}),r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=sh.parse(e[r]);t.push(i)}return t}}class ph extends uh{constructor(e){super(e)}load(e,t,r,i){const n=this,s=[],o=new hc,a=new dh(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(n.withCredentials);let l=0;function c(c){a.load(e[c],(function(e){const r=n.parse(e,!0);s[c]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},l+=1,6===l&&(1===r.mipmapCount&&(o.minFilter=be),o.image=s,o.format=r.format,o.needsUpdate=!0,t&&t(o))}),r,i)}if(Array.isArray(e))for(let t=0,r=e.length;t<r;++t)c(t);else a.load(e,(function(e){const r=n.parse(e,!0);if(r.isCubemap){const e=r.mipmaps.length/r.mipmapCount;for(let t=0;t<e;t++){s[t]={mipmaps:[]};for(let e=0;e<r.mipmapCount;e++)s[t].mipmaps.push(r.mipmaps[t*r.mipmapCount+e]),s[t].format=r.format,s[t].width=r.width,s[t].height=r.height}o.image=s}else o.image.width=r.width,o.image.height=r.height,o.mipmaps=r.mipmaps;1===r.mipmapCount&&(o.minFilter=be),o.format=r.format,o.needsUpdate=!0,t&&t(o)}),r,i);return o}}class mh extends uh{constructor(e){super(e)}load(e,t,r,i){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const n=this,s=ah.get(e);if(void 0!==s)return n.manager.itemStart(e),setTimeout((function(){t&&t(s),n.manager.itemEnd(e)}),0),s;const o=Or("img");function a(){c(),ah.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(t){c(),i&&i(t),n.manager.itemError(e),n.manager.itemEnd(e)}function c(){o.removeEventListener("load",a,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",a,!1),o.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),n.manager.itemStart(e),o.src=e,o}}class gh extends uh{constructor(e){super(e)}load(e,t,r,i){const n=new ds,s=new mh(this.manager);s.setCrossOrigin(this.crossOrigin),s.setPath(this.path);let o=0;function a(r){s.load(e[r],(function(e){n.images[r]=e,o++,6===o&&(n.needsUpdate=!0,t&&t(n))}),void 0,i)}for(let t=0;t<e.length;++t)a(t);return n}}class vh extends uh{constructor(e){super(e)}load(e,t,r,i){const n=this,s=new Nl,o=new dh(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(n.withCredentials),o.load(e,(function(e){const r=n.parse(e);r&&(void 0!==r.image?s.image=r.image:void 0!==r.data&&(s.image.width=r.width,s.image.height=r.height,s.image.data=r.data),s.wrapS=void 0!==r.wrapS?r.wrapS:de,s.wrapT=void 0!==r.wrapT?r.wrapT:de,s.magFilter=void 0!==r.magFilter?r.magFilter:be,s.minFilter=void 0!==r.minFilter?r.minFilter:be,s.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.encoding&&(s.encoding=r.encoding),void 0!==r.flipY&&(s.flipY=r.flipY),void 0!==r.format&&(s.format=r.format),void 0!==r.type&&(s.type=r.type),void 0!==r.mipmaps&&(s.mipmaps=r.mipmaps,s.minFilter=we),1===r.mipmapCount&&(s.minFilter=be),void 0!==r.generateMipmaps&&(s.generateMipmaps=r.generateMipmaps),s.needsUpdate=!0,t&&t(s,r))}),r,i),s}}class _h extends uh{constructor(e){super(e)}load(e,t,r,i){const n=new Wr,s=new mh(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(e,(function(e){n.image=e,n.needsUpdate=!0,void 0!==t&&t(n)}),r,i),n}}class bh extends tn{constructor(e,t=1){super(),this.type="Light",this.color=new Ur(e),this.intensity=t}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}bh.prototype.isLight=!0;class yh extends bh{constructor(e,t,r){super(e,r),this.type="HemisphereLight",this.position.copy(tn.DefaultUp),this.updateMatrix(),this.groundColor=new Ur(t)}copy(e){return bh.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}yh.prototype.isHemisphereLight=!0;const Eh=new Ii,wh=new Qr,xh=new Qr;class Ah{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Sr(512,512),this.map=null,this.mapPass=null,this.matrix=new Ii,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ys,this._frameExtents=new Sr(1,1),this._viewportCount=1,this._viewports=[new Hr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;wh.setFromMatrixPosition(e.matrixWorld),t.position.copy(wh),xh.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(xh),t.updateMatrixWorld(),Eh.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Eh),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Th extends Ah{constructor(){super(new cs(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,r=2*vr*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;r===t.fov&&i===t.aspect&&n===t.far||(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}Th.prototype.isSpotLightShadow=!0;class Sh extends bh{constructor(e,t,r=0,i=Math.PI/3,n=0,s=1){super(e,t),this.type="SpotLight",this.position.copy(tn.DefaultUp),this.updateMatrix(),this.target=new tn,this.distance=r,this.angle=i,this.penumbra=n,this.decay=s,this.shadow=new Th}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Sh.prototype.isSpotLight=!0;const Mh=new Ii,Ch=new Qr,Rh=new Qr;class Ih extends Ah{constructor(){super(new cs(90,1,.5,500)),this._frameExtents=new Sr(4,2),this._viewportCount=6,this._viewports=[new Hr(2,1,1,1),new Hr(0,1,1,1),new Hr(3,1,1,1),new Hr(1,1,1,1),new Hr(3,0,1,1),new Hr(1,0,1,1)],this._cubeDirections=[new Qr(1,0,0),new Qr(-1,0,0),new Qr(0,0,1),new Qr(0,0,-1),new Qr(0,1,0),new Qr(0,-1,0)],this._cubeUps=[new Qr(0,1,0),new Qr(0,1,0),new Qr(0,1,0),new Qr(0,1,0),new Qr(0,0,1),new Qr(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),Ch.setFromMatrixPosition(e.matrixWorld),r.position.copy(Ch),Rh.copy(r.position),Rh.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(Rh),r.updateMatrixWorld(),i.makeTranslation(-Ch.x,-Ch.y,-Ch.z),Mh.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Mh)}}Ih.prototype.isPointLightShadow=!0;class Oh extends bh{constructor(e,t,r=0,i=1){super(e,t),this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new Ih}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Oh.prototype.isPointLight=!0;class Ph extends Ah{constructor(){super(new ks(-5,5,5,-5,.5,500))}}Ph.prototype.isDirectionalLightShadow=!0;class kh extends bh{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(tn.DefaultUp),this.updateMatrix(),this.target=new tn,this.shadow=new Ph}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}kh.prototype.isDirectionalLight=!0;class Lh extends bh{constructor(e,t){super(e,t),this.type="AmbientLight"}}Lh.prototype.isAmbientLight=!0;class Nh extends bh{constructor(e,t,r=10,i=10){super(e,t),this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}Nh.prototype.isRectAreaLight=!0;class Gh{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Qr)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,n=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.282095),t.addScaledVector(s[1],.488603*i),t.addScaledVector(s[2],.488603*n),t.addScaledVector(s[3],.488603*r),t.addScaledVector(s[4],r*i*1.092548),t.addScaledVector(s[5],i*n*1.092548),t.addScaledVector(s[6],.315392*(3*n*n-1)),t.addScaledVector(s[7],r*n*1.092548),t.addScaledVector(s[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,n=e.z,s=this.coefficients;return t.copy(s[0]).multiplyScalar(.886227),t.addScaledVector(s[1],1.023328*i),t.addScaledVector(s[2],1.023328*n),t.addScaledVector(s[3],1.023328*r),t.addScaledVector(s[4],.858086*r*i),t.addScaledVector(s[5],.858086*i*n),t.addScaledVector(s[6],.743125*n*n-.247708),t.addScaledVector(s[7],.858086*r*n),t.addScaledVector(s[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+3*i);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+3*i);return e}static getBasisAt(e,t){const r=e.x,i=e.y,n=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*n,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*n,t[6]=.315392*(3*n*n-1),t[7]=1.092548*r*n,t[8]=.546274*(r*r-i*i)}}Gh.prototype.isSphericalHarmonics3=!0;class Dh extends bh{constructor(e=new Gh,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Dh.prototype.isLightProbe=!0;class Uh extends uh{constructor(e){super(e),this.textures={}}load(e,t,r,i){const n=this,s=new dh(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,(function(r){try{t(n.parse(JSON.parse(r)))}catch(t){i?i(t):console.error(t),n.manager.itemError(e)}}),r,i)}parse(e){const t=this.textures;function r(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}const i=mn.fromType(e.type);if(void 0!==e.uuid&&(i.uuid=e.uuid),void 0!==e.name&&(i.name=e.name),void 0!==e.color&&void 0!==i.color&&i.color.setHex(e.color),void 0!==e.roughness&&(i.roughness=e.roughness),void 0!==e.metalness&&(i.metalness=e.metalness),void 0!==e.sheen&&(i.sheen=e.sheen),void 0!==e.sheenColor&&(i.sheenColor=(new Ur).setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(i.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==i.emissive&&i.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==i.specular&&i.specular.setHex(e.specular),void 0!==e.specularIntensity&&(i.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==i.specularColor&&i.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(i.shininess=e.shininess),void 0!==e.clearcoat&&(i.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(i.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(i.transmission=e.transmission),void 0!==e.thickness&&(i.thickness=e.thickness),void 0!==e.attenuationDistance&&(i.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==i.attenuationColor&&i.attenuationColor.setHex(e.attenuationColor),void 0!==e.fog&&(i.fog=e.fog),void 0!==e.flatShading&&(i.flatShading=e.flatShading),void 0!==e.blending&&(i.blending=e.blending),void 0!==e.combine&&(i.combine=e.combine),void 0!==e.side&&(i.side=e.side),void 0!==e.shadowSide&&(i.shadowSide=e.shadowSide),void 0!==e.opacity&&(i.opacity=e.opacity),void 0!==e.transparent&&(i.transparent=e.transparent),void 0!==e.alphaTest&&(i.alphaTest=e.alphaTest),void 0!==e.depthTest&&(i.depthTest=e.depthTest),void 0!==e.depthWrite&&(i.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(i.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(i.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(i.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(i.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(i.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(i.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(i.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(i.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(i.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(i.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(i.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(i.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(i.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(i.rotation=e.rotation),1!==e.linewidth&&(i.linewidth=e.linewidth),void 0!==e.dashSize&&(i.dashSize=e.dashSize),void 0!==e.gapSize&&(i.gapSize=e.gapSize),void 0!==e.scale&&(i.scale=e.scale),void 0!==e.polygonOffset&&(i.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(i.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(i.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(i.dithering=e.dithering),void 0!==e.alphaToCoverage&&(i.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(i.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(i.visible=e.visible),void 0!==e.toneMapped&&(i.toneMapped=e.toneMapped),void 0!==e.userData&&(i.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),void 0!==e.uniforms)for(const t in e.uniforms){const n=e.uniforms[t];switch(i.uniforms[t]={},n.type){case"t":i.uniforms[t].value=r(n.value);break;case"c":i.uniforms[t].value=(new Ur).setHex(n.value);break;case"v2":i.uniforms[t].value=(new Sr).fromArray(n.value);break;case"v3":i.uniforms[t].value=(new Qr).fromArray(n.value);break;case"v4":i.uniforms[t].value=(new Hr).fromArray(n.value);break;case"m3":i.uniforms[t].value=(new Mr).fromArray(n.value);break;case"m4":i.uniforms[t].value=(new Ii).fromArray(n.value);break;default:i.uniforms[t].value=n.value}}if(void 0!==e.defines&&(i.defines=e.defines),void 0!==e.vertexShader&&(i.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(i.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const t in e.extensions)i.extensions[t]=e.extensions[t];if(void 0!==e.shading&&(i.flatShading=1===e.shading),void 0!==e.size&&(i.size=e.size),void 0!==e.sizeAttenuation&&(i.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(i.map=r(e.map)),void 0!==e.matcap&&(i.matcap=r(e.matcap)),void 0!==e.alphaMap&&(i.alphaMap=r(e.alphaMap)),void 0!==e.bumpMap&&(i.bumpMap=r(e.bumpMap)),void 0!==e.bumpScale&&(i.bumpScale=e.bumpScale),void 0!==e.normalMap&&(i.normalMap=r(e.normalMap)),void 0!==e.normalMapType&&(i.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),i.normalScale=(new Sr).fromArray(t)}return void 0!==e.displacementMap&&(i.displacementMap=r(e.displacementMap)),void 0!==e.displacementScale&&(i.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(i.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(i.roughnessMap=r(e.roughnessMap)),void 0!==e.metalnessMap&&(i.metalnessMap=r(e.metalnessMap)),void 0!==e.emissiveMap&&(i.emissiveMap=r(e.emissiveMap)),void 0!==e.emissiveIntensity&&(i.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(i.specularMap=r(e.specularMap)),void 0!==e.specularIntensityMap&&(i.specularIntensityMap=r(e.specularIntensityMap)),void 0!==e.specularColorMap&&(i.specularColorMap=r(e.specularColorMap)),void 0!==e.envMap&&(i.envMap=r(e.envMap)),void 0!==e.envMapIntensity&&(i.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(i.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(i.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(i.lightMap=r(e.lightMap)),void 0!==e.lightMapIntensity&&(i.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(i.aoMap=r(e.aoMap)),void 0!==e.aoMapIntensity&&(i.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(i.gradientMap=r(e.gradientMap)),void 0!==e.clearcoatMap&&(i.clearcoatMap=r(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(i.clearcoatNormalScale=(new Sr).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(i.transmissionMap=r(e.transmissionMap)),void 0!==e.thicknessMap&&(i.thicknessMap=r(e.thicknessMap)),void 0!==e.sheenColorMap&&(i.sheenColorMap=r(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}}class Vh{static decodeText(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return-1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class Bh extends Dn{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Bh.prototype.isInstancedBufferGeometry=!0;class Fh extends uh{constructor(e){super(e)}load(e,t,r,i){const n=this,s=new dh(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,(function(r){try{t(n.parse(JSON.parse(r)))}catch(t){i?i(t):console.error(t),n.manager.itemError(e)}}),r,i)}parse(e){const t={},r={};function i(e,i){if(void 0!==t[i])return t[i];const n=e.interleavedBuffers[i],s=function(e,t){if(void 0!==r[t])return r[t];const i=e.arrayBuffers[t],n=new Uint32Array(i).buffer;return r[t]=n,n}(e,n.buffer),o=Ir(n.type,s),a=new ol(o,n.stride);return a.uuid=n.uuid,t[i]=a,a}const n=e.isInstancedBufferGeometry?new Bh:new Dn,s=e.data.index;if(void 0!==s){const e=Ir(s.type,s.array);n.setIndex(new bn(e,1))}const o=e.data.attributes;for(const t in o){const r=o[t];let s;if(r.isInterleavedBufferAttribute){const t=i(e.data,r.data);s=new ll(t,r.itemSize,r.offset,r.normalized)}else{const e=Ir(r.type,r.array);s=new(r.isInstancedBufferAttribute?Vl:bn)(e,r.itemSize,r.normalized)}void 0!==r.name&&(s.name=r.name),void 0!==r.usage&&s.setUsage(r.usage),void 0!==r.updateRange&&(s.updateRange.offset=r.updateRange.offset,s.updateRange.count=r.updateRange.count),n.setAttribute(t,s)}const a=e.data.morphAttributes;if(a)for(const t in a){const r=a[t],s=[];for(let t=0,n=r.length;t<n;t++){const n=r[t];let o;if(n.isInterleavedBufferAttribute){const t=i(e.data,n.data);o=new ll(t,n.itemSize,n.offset,n.normalized)}else{const e=Ir(n.type,n.array);o=new bn(e,n.itemSize,n.normalized)}void 0!==n.name&&(o.name=n.name),s.push(o)}n.morphAttributes[t]=s}e.data.morphTargetsRelative&&(n.morphTargetsRelative=!0);const l=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==l)for(let e=0,t=l.length;e!==t;++e){const t=l[e];n.addGroup(t.start,t.count,t.materialIndex)}const c=e.data.boundingSphere;if(void 0!==c){const e=new Qr;void 0!==c.center&&e.fromArray(c.center),n.boundingSphere=new Ei(e,c.radius)}return e.name&&(n.name=e.name),e.userData&&(n.userData=e.userData),n}}class jh extends uh{constructor(e){super(e)}load(e,t,r,i){const n=this,s=""===this.path?Vh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;const o=new dh(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(r){let s=null;try{s=JSON.parse(r)}catch(t){return void 0!==i&&i(t),void console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message)}const o=s.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?n.parse(s,t):console.error("THREE.ObjectLoader: Can't load "+e)}),r,i)}async loadAsync(e,t){const r=""===this.path?Vh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const i=new dh(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials);const n=await i.loadAsync(e,t),s=JSON.parse(n),o=s.metadata;if(void 0===o||void 0===o.type||"geometry"===o.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(s)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,i),s=this.parseImages(e.images,(function(){void 0!==t&&t(l)})),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,n,a,o,r),c=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,c),void 0!==t){let e=!1;for(const t in s)if(s[t]instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),n=await this.parseImagesAsync(e.images),s=this.parseTextures(e.textures,n),o=this.parseMaterials(e.materials,s),a=this.parseObject(e.object,i,o,s,t),l=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,l),a}parseShapes(e){const t={};if(void 0!==e)for(let r=0,i=e.length;r<i;r++){const i=(new Hc).fromJSON(e[r]);t[i.uuid]=i}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse((function(e){e.isBone&&(i[e.uuid]=e)})),void 0!==e)for(let t=0,n=e.length;t<n;t++){const n=(new Ul).fromJSON(e[t],i);r[n.uuid]=n}return r}parseGeometries(e,t){const r={};if(void 0!==e){const i=new Fh;for(let n=0,s=e.length;n<s;n++){let s;const o=e[n];switch(o.type){case"BufferGeometry":case"InstancedBufferGeometry":s=i.parse(o);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:o.type in Lu?s=Lu[o.type].fromJSON(o,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${o.type}"`)}s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),!0===s.isBufferGeometry&&void 0!==o.userData&&(s.userData=o.userData),r[o.uuid]=s}}return r}parseMaterials(e,t){const r={},i={};if(void 0!==e){const n=new Uh;n.setTextures(t);for(let t=0,s=e.length;t<s;t++){const s=e[t];if("MultiMaterial"===s.type){const e=[];for(let t=0;t<s.materials.length;t++){const i=s.materials[t];void 0===r[i.uuid]&&(r[i.uuid]=n.parse(i)),e.push(r[i.uuid])}i[s.uuid]=e}else void 0===r[s.uuid]&&(r[s.uuid]=n.parse(s)),i[s.uuid]=r[s.uuid]}}return i}parseAnimations(e){const t={};if(void 0!==e)for(let r=0;r<e.length;r++){const i=e[r],n=sh.parse(i);t[n.uuid]=n}return t}parseImages(e,t){const r=this,i={};let n;function s(e){if("string"==typeof e){const t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:Ir(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){const r=new lh(t);n=new mh(r),n.setCrossOrigin(this.crossOrigin);for(let t=0,r=e.length;t<r;t++){const r=e[t],n=r.url;if(Array.isArray(n)){const e=[];for(let t=0,r=n.length;t<r;t++){const r=s(n[t]);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new Nl(r.data,r.width,r.height)))}i[r.uuid]=new Fr(e)}else{const e=s(r.url);i[r.uuid]=new Fr(e)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function n(e){if("string"==typeof e){const r=e,n=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(r)?r:t.resourcePath+r;return await i.loadAsync(n)}return e.data?{data:Ir(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){i=new mh(this.manager),i.setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){const i=e[t],s=i.url;if(Array.isArray(s)){const e=[];for(let t=0,r=s.length;t<r;t++){const r=s[t],i=await n(r);null!==i&&(i instanceof HTMLImageElement?e.push(i):e.push(new Nl(i.data,i.width,i.height)))}r[i.uuid]=new Fr(e)}else{const e=await n(i.url);r[i.uuid]=new Fr(e)}}}return r}parseTextures(e,t){function r(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}const i={};if(void 0!==e)for(let n=0,s=e.length;n<s;n++){const s=e[n];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);const o=t[s.image],a=o.data;let l;Array.isArray(a)?(l=new ds,6===a.length&&(l.needsUpdate=!0)):(l=a&&a.data?new Nl:new Wr,a&&(l.needsUpdate=!0)),l.source=o,l.uuid=s.uuid,void 0!==s.name&&(l.name=s.name),void 0!==s.mapping&&(l.mapping=r(s.mapping,zh)),void 0!==s.offset&&l.offset.fromArray(s.offset),void 0!==s.repeat&&l.repeat.fromArray(s.repeat),void 0!==s.center&&l.center.fromArray(s.center),void 0!==s.rotation&&(l.rotation=s.rotation),void 0!==s.wrap&&(l.wrapS=r(s.wrap[0],Wh),l.wrapT=r(s.wrap[1],Wh)),void 0!==s.format&&(l.format=s.format),void 0!==s.type&&(l.type=s.type),void 0!==s.encoding&&(l.encoding=s.encoding),void 0!==s.minFilter&&(l.minFilter=r(s.minFilter,Hh)),void 0!==s.magFilter&&(l.magFilter=r(s.magFilter,Hh)),void 0!==s.anisotropy&&(l.anisotropy=s.anisotropy),void 0!==s.flipY&&(l.flipY=s.flipY),void 0!==s.premultiplyAlpha&&(l.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(l.unpackAlignment=s.unpackAlignment),void 0!==s.userData&&(l.userData=s.userData),i[s.uuid]=l}return i}parseObject(e,t,r,i,n){let s,o,a;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){const t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i];void 0===r[n]&&console.warn("THREE.ObjectLoader: Undefined material",n),t.push(r[n])}return t}return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),r[e]}}function u(e){return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),i[e]}switch(e.type){case"Scene":s=new sl,void 0!==e.background&&(Number.isInteger(e.background)?s.background=new Ur(e.background):s.background=u(e.background)),void 0!==e.environment&&(s.environment=u(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?s.fog=new nl(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(s.fog=new il(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":s=new cs(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(s.focus=e.focus),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.filmGauge&&(s.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(s.filmOffset=e.filmOffset),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"OrthographicCamera":s=new ks(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(s.zoom=e.zoom),void 0!==e.view&&(s.view=Object.assign({},e.view));break;case"AmbientLight":s=new Lh(e.color,e.intensity);break;case"DirectionalLight":s=new kh(e.color,e.intensity);break;case"PointLight":s=new Oh(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":s=new Nh(e.color,e.intensity,e.width,e.height);break;case"SpotLight":s=new Sh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":s=new yh(e.color,e.groundColor,e.intensity);break;case"LightProbe":s=(new Dh).fromJSON(e);break;case"SkinnedMesh":o=l(e.geometry),a=c(e.material),s=new kl(o,a),void 0!==e.bindMode&&(s.bindMode=e.bindMode),void 0!==e.bindMatrix&&s.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(s.skeleton=e.skeleton);break;case"Mesh":o=l(e.geometry),a=c(e.material),s=new ts(o,a);break;case"InstancedMesh":o=l(e.geometry),a=c(e.material);const t=e.count,r=e.instanceMatrix,i=e.instanceColor;s=new Wl(o,a,t),s.instanceMatrix=new Vl(new Float32Array(r.array),16),void 0!==i&&(s.instanceColor=new Vl(new Float32Array(i.array),i.itemSize));break;case"LOD":s=new Ml;break;case"Line":s=new Jl(l(e.geometry),c(e.material));break;case"LineLoop":s=new tc(l(e.geometry),c(e.material));break;case"LineSegments":s=new ec(l(e.geometry),c(e.material));break;case"PointCloud":case"Points":s=new ac(l(e.geometry),c(e.material));break;case"Sprite":s=new xl(c(e.material));break;case"Group":s=new Xa;break;case"Bone":s=new Ll;break;default:s=new tn}if(s.uuid=e.uuid,void 0!==e.name&&(s.name=e.name),void 0!==e.matrix?(s.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(s.matrixAutoUpdate=e.matrixAutoUpdate),s.matrixAutoUpdate&&s.matrix.decompose(s.position,s.quaternion,s.scale)):(void 0!==e.position&&s.position.fromArray(e.position),void 0!==e.rotation&&s.rotation.fromArray(e.rotation),void 0!==e.quaternion&&s.quaternion.fromArray(e.quaternion),void 0!==e.scale&&s.scale.fromArray(e.scale)),void 0!==e.castShadow&&(s.castShadow=e.castShadow),void 0!==e.receiveShadow&&(s.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(s.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(s.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(s.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&s.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(s.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(s.visible=e.visible),void 0!==e.frustumCulled&&(s.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(s.renderOrder=e.renderOrder),void 0!==e.userData&&(s.userData=e.userData),void 0!==e.layers&&(s.layers.mask=e.layers),void 0!==e.children){const o=e.children;for(let e=0;e<o.length;e++)s.add(this.parseObject(o[e],t,r,i,n))}if(void 0!==e.animations){const t=e.animations;for(let e=0;e<t.length;e++){const r=t[e];s.animations.push(n[r])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(s.autoUpdate=e.autoUpdate);const t=e.levels;for(let e=0;e<t.length;e++){const r=t[e],i=s.getObjectByProperty("uuid",r.object);void 0!==i&&s.addLevel(i,r.distance)}}return s}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){const r=t[e.skeleton];void 0===r?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(r,e.bindMatrix)}}))}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const zh={UVMapping:ne,CubeReflectionMapping:se,CubeRefractionMapping:oe,EquirectangularReflectionMapping:ae,EquirectangularRefractionMapping:le,CubeUVReflectionMapping:ce,CubeUVRefractionMapping:ue},Wh={RepeatWrapping:he,ClampToEdgeWrapping:de,MirroredRepeatWrapping:fe},Hh={NearestFilter:pe,NearestMipmapNearestFilter:me,NearestMipmapLinearFilter:ve,LinearFilter:be,LinearMipmapNearestFilter:ye,LinearMipmapLinearFilter:we};class $h extends uh{constructor(e){super(e),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const n=this,s=ah.get(e);if(void 0!==s)return n.manager.itemStart(e),setTimeout((function(){t&&t(s),n.manager.itemEnd(e)}),0),s;const o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(n.options,{colorSpaceConversion:"none"}))})).then((function(r){ah.add(e,r),t&&t(r),n.manager.itemEnd(e)})).catch((function(t){i&&i(t),n.manager.itemError(e),n.manager.itemEnd(e)})),n.manager.itemStart(e)}}let Yh;$h.prototype.isImageBitmapLoader=!0;const qh={getContext:function(){return void 0===Yh&&(Yh=new(window.AudioContext||window.webkitAudioContext)),Yh},setContext:function(e){Yh=e}};class Xh extends uh{constructor(e){super(e)}load(e,t,r,i){const n=this,s=new dh(this.manager);s.setResponseType("arraybuffer"),s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(r){try{const e=r.slice(0);qh.getContext().decodeAudioData(e,(function(e){t(e)}))}catch(t){i?i(t):console.error(t),n.manager.itemError(e)}}),r,i)}}class Zh extends Dh{constructor(e,t,r=1){super(void 0,r);const i=(new Ur).set(e),n=(new Ur).set(t),s=new Qr(i.r,i.g,i.b),o=new Qr(n.r,n.g,n.b),a=Math.sqrt(Math.PI),l=a*Math.sqrt(.75);this.sh.coefficients[0].copy(s).add(o).multiplyScalar(a),this.sh.coefficients[1].copy(s).sub(o).multiplyScalar(l)}}Zh.prototype.isHemisphereLightProbe=!0;class Jh extends Dh{constructor(e,t=1){super(void 0,t);const r=(new Ur).set(e);this.sh.coefficients[0].set(r.r,r.g,r.b).multiplyScalar(2*Math.sqrt(Math.PI))}}Jh.prototype.isAmbientLightProbe=!0;const Kh=new Ii,Qh=new Ii,ed=new Ii;class td{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new cs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new cs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,ed.copy(e.projectionMatrix);const r=t.eyeSep/2,i=r*t.near/t.focus,n=t.near*Math.tan(gr*t.fov*.5)/t.zoom;let s,o;Qh.elements[12]=-r,Kh.elements[12]=r,s=-n*t.aspect+i,o=n*t.aspect+i,ed.elements[0]=2*t.near/(o-s),ed.elements[8]=(o+s)/(o-s),this.cameraL.projectionMatrix.copy(ed),s=-n*t.aspect-i,o=n*t.aspect-i,ed.elements[0]=2*t.near/(o-s),ed.elements[8]=(o+s)/(o-s),this.cameraR.projectionMatrix.copy(ed)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Qh),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Kh)}}class rd{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=id(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=id();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function id(){return("undefined"==typeof performance?Date:performance).now()}const nd=new Qr,sd=new Kr,od=new Qr,ad=new Qr;class ld extends tn{constructor(){super(),this.type="AudioListener",this.context=qh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new rd}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(nd,sd,od),ad.set(0,0,-1).applyQuaternion(sd),t.positionX){const e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(nd.x,e),t.positionY.linearRampToValueAtTime(nd.y,e),t.positionZ.linearRampToValueAtTime(nd.z,e),t.forwardX.linearRampToValueAtTime(ad.x,e),t.forwardY.linearRampToValueAtTime(ad.y,e),t.forwardZ.linearRampToValueAtTime(ad.z,e),t.upX.linearRampToValueAtTime(r.x,e),t.upY.linearRampToValueAtTime(r.y,e),t.upZ.linearRampToValueAtTime(r.z,e)}else t.setPosition(nd.x,nd.y,nd.z),t.setOrientation(ad.x,ad.y,ad.z,r.x,r.y,r.z)}}class cd extends tn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const ud=new Qr,hd=new Kr,dd=new Qr,fd=new Qr;class pd extends cd{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(ud,hd,dd),fd.set(0,0,1).applyQuaternion(hd);const t=this.panner;if(t.positionX){const e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(ud.x,e),t.positionY.linearRampToValueAtTime(ud.y,e),t.positionZ.linearRampToValueAtTime(ud.z,e),t.orientationX.linearRampToValueAtTime(fd.x,e),t.orientationY.linearRampToValueAtTime(fd.y,e),t.orientationZ.linearRampToValueAtTime(fd.z,e)}else t.setPosition(ud.x,ud.y,ud.z),t.setOrientation(fd.x,fd.y,fd.z)}}class md{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class gd{constructor(e,t,r){let i,n,s;switch(this.binding=e,this.valueSize=r,t){case"quaternion":i=this._slerp,n=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":i=this._select,n=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:i=this._lerp,n=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=n,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,n=e*i+i;let s=this.cumulativeWeight;if(0===s){for(let e=0;e!==i;++e)r[n+e]=r[e];s=t}else{s+=t;const e=t/s;this._mixBufferRegion(r,n,0,e,i)}this.cumulativeWeight=s}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,n=this.cumulativeWeight,s=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){const e=t*this._origIndex;this._mixBufferRegion(r,i,e,1-n,t)}s>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let e=t,n=t+t;e!==n;++e)if(r[e]!==r[e+t]){o.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let e=r,n=i;e!==n;++e)t[e]=t[i+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,n){if(i>=.5)for(let i=0;i!==n;++i)e[t+i]=e[r+i]}_slerp(e,t,r,i){Kr.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,n){const s=this._workIndex*n;Kr.multiplyQuaternionsFlat(e,s,e,t,e,r),Kr.slerpFlat(e,t,e,t,e,s,i)}_lerp(e,t,r,i,n){const s=1-i;for(let o=0;o!==n;++o){const n=t+o;e[n]=e[n]*s+e[r+o]*i}}_lerpAdditive(e,t,r,i,n){for(let s=0;s!==n;++s){const n=t+s;e[n]=e[n]+e[r+s]*i}}}const vd="\\[\\]\\.:\\/",_d=new RegExp("[\\[\\]\\.:\\/]","g"),bd="[^\\[\\]\\.:\\/]",yd="[^"+vd.replace("\\.","")+"]",Ed=/((?:WC+[\/:])*)/.source.replace("WC",bd),wd=/(WCOD+)?/.source.replace("WCOD",yd),xd=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",bd),Ad=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",bd),Td=new RegExp("^"+Ed+wd+xd+Ad+"$"),Sd=["material","materials","bones"];class Md{constructor(e,t,r){this.path=t,this.parsedPath=r||Md.parseTrackName(t),this.node=Md.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Md.Composite(e,t,r):new Md(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(_d,"")}static parseTrackName(e){const t=Td.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){const e=r.nodeName.substring(i+1);-1!==Sd.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(void 0!==r)return r}if(e.children){const r=function(e){for(let i=0;i<e.length;i++){const n=e[i];if(n.name===t||n.uuid===t)return n;const s=r(n.children);if(s)return s}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,n=r.length;i!==n;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let n=t.propertyIndex;if(e||(e=Md.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let i=t.objectIndex;switch(r){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===i){i=t;break}break;default:if(void 0===e[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[r]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}const s=e[i];if(void 0===s){const r=t.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+r+"."+i+" but it wasn't found.",e)}let o=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?o=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(o=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===i){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[n]&&(n=e.morphTargetDictionary[n])}a=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=n}else void 0!==s.fromArray&&void 0!==s.toArray?(a=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(a=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Md.Composite=class{constructor(e,t,r){const i=r||Md.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];void 0!==i&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}},Md.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Md.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Md.prototype.GetterByBindingType=[Md.prototype._getValue_direct,Md.prototype._getValue_array,Md.prototype._getValue_arrayElement,Md.prototype._getValue_toArray],Md.prototype.SetterByBindingTypeAndVersioning=[[Md.prototype._setValue_direct,Md.prototype._setValue_direct_setNeedsUpdate,Md.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Md.prototype._setValue_array,Md.prototype._setValue_array_setNeedsUpdate,Md.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Md.prototype._setValue_arrayElement,Md.prototype._setValue_arrayElement_setNeedsUpdate,Md.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Md.prototype._setValue_fromArray,Md.prototype._setValue_fromArray_setNeedsUpdate,Md.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Cd{constructor(){this.uuid=_r(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let t=0,r=arguments.length;t!==r;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,n=this._bindings,s=n.length;let o,a=e.length,l=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const u=arguments[c],h=u.uuid;let d=t[h];if(void 0===d){d=a++,t[h]=d,e.push(u);for(let e=0,t=s;e!==t;++e)n[e].push(new Md(u,r[e],i[e]))}else if(d<l){o=e[d];const a=--l,c=e[a];t[c.uuid]=d,e[d]=c,t[h]=a,e[a]=u;for(let e=0,t=s;e!==t;++e){const t=n[e],s=t[a];let o=t[d];t[d]=s,void 0===o&&(o=new Md(u,r[e],i[e])),t[a]=o}}else e[d]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let n=this.nCachedObjects_;for(let s=0,o=arguments.length;s!==o;++s){const o=arguments[s],a=o.uuid,l=t[a];if(void 0!==l&&l>=n){const s=n++,c=e[s];t[c.uuid]=l,e[l]=c,t[a]=s,e[s]=o;for(let e=0,t=i;e!==t;++e){const t=r[e],i=t[s],n=t[l];t[l]=i,t[s]=n}}}this.nCachedObjects_=n}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let n=this.nCachedObjects_,s=e.length;for(let o=0,a=arguments.length;o!==a;++o){const a=arguments[o].uuid,l=t[a];if(void 0!==l)if(delete t[a],l<n){const o=--n,a=e[o],c=--s,u=e[c];t[a.uuid]=l,e[l]=a,t[u.uuid]=o,e[o]=u,e.pop();for(let e=0,t=i;e!==t;++e){const t=r[e],i=t[o],n=t[c];t[l]=i,t[o]=n,t.pop()}}else{const n=--s,o=e[n];n>0&&(t[o.uuid]=l),e[l]=o,e.pop();for(let e=0,t=i;e!==t;++e){const t=r[e];t[l]=t[n],t.pop()}}}this.nCachedObjects_=n}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const n=this._bindings;if(void 0!==i)return n[i];const s=this._paths,o=this._parsedPaths,a=this._objects,l=a.length,c=this.nCachedObjects_,u=new Array(l);i=n.length,r[e]=i,s.push(e),o.push(t),n.push(u);for(let r=c,i=a.length;r!==i;++r){const i=a[r];u[r]=new Md(i,e,t)}return u}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(void 0!==r){const i=this._paths,n=this._parsedPaths,s=this._bindings,o=s.length-1,a=s[o];t[e[o]]=r,s[r]=a,s.pop(),n[r]=n[o],n.pop(),i[r]=i[o],i.pop()}}}Cd.prototype.isAnimationObjectGroup=!0;class Rd{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const n=t.tracks,s=n.length,o=new Array(s),a={endingStart:Tt,endingEnd:Tt};for(let e=0;e!==s;++e){const t=n[e].createInterpolant(null);o[e]=t,t.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=yt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const r=this._clip.duration,i=e._clip.duration,n=i/r,s=r/i;e.warp(1,n,t),this.warp(s,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,n=i.time,s=this.timeScale;let o=this._timeScaleInterpolant;null===o&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=n,a[1]=n+r,l[0]=e/s,l[1]=t/s,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled)return void this._updateWeight(e);const n=this._startTime;if(null!==n){const i=(e-n)*r;if(i<0||0===r)return;this._startTime=null,t=r*i}t*=this._updateTimeScale(e);const s=this._updateTime(t),o=this._updateWeight(e);if(o>0){const e=this._interpolants,t=this._propertyBindings;if(this.blendMode===Rt)for(let r=0,i=e.length;r!==i;++r)e[r].evaluate(s),t[r].accumulateAdditive(o);else for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(s),t[r].accumulate(i,o)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(null!==r){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),0===i&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(null!==r){t*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,n=this._loopCount;const s=r===Et;if(0===e)return-1===n?i:s&&1==(1&n)?t-i:i;if(r===bt){-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else{if(!(i<0)){this.time=i;break e}i=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===n&&(e>=0?(n=0,this._setEndings(!0,0===this.repetitions,s)):this._setEndings(0===this.repetitions,!0,s)),i>=t||i<0){const r=Math.floor(i/t);i-=t*r,n+=Math.abs(r);const o=this.repetitions-n;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){const t=e<0;this._setEndings(t,!t,s)}else this._setEndings(!1,!1,s);this._loopCount=n,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=i;if(s&&1==(1&n))return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=St,i.endingEnd=St):(i.endingStart=e?this.zeroSlopeAtStart?St:Tt:Mt,i.endingEnd=t?this.zeroSlopeAtEnd?St:Tt:Mt)}_scheduleFading(e,t,r){const i=this._mixer,n=i.time;let s=this._weightInterpolant;null===s&&(s=i._lendControlInterpolant(),this._weightInterpolant=s);const o=s.parameterPositions,a=s.sampleValues;return o[0]=n,a[0]=t,o[1]=n+e,a[1]=r,this}}class Id extends fr{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,n=i.length,s=e._propertyBindings,o=e._interpolants,a=r.uuid,l=this._bindingsByRootAndName;let c=l[a];void 0===c&&(c={},l[a]=c);for(let e=0;e!==n;++e){const n=i[e],l=n.name;let u=c[l];if(void 0!==u)++u.referenceCount,s[e]=u;else{if(u=s[e],void 0!==u){null===u._cacheIndex&&(++u.referenceCount,this._addInactiveBinding(u,a,l));continue}const i=t&&t._propertyBindings[e].binding.parsedPath;u=new gd(Md.create(r,l,i),n.ValueTypeName,n.getValueSize()),++u.referenceCount,this._addInactiveBinding(u,a,l),s[e]=u}o[e].resultBuffer=u.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const t=(e._localRoot||this._root).uuid,r=e._clip.uuid,i=this._actionsByClip[r];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,r,t)}const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,n=this._actionsByClip;let s=n[t];if(void 0===s)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=s;else{const t=s.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=i.length,i.push(e),s.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const n=e._clip.uuid,s=this._actionsByClip,o=s[n],a=o.knownActions,l=a[a.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,a[c]=l,a.pop(),e._byClipCacheIndex=null;delete o.actionByRoot[(e._localRoot||this._root).uuid],0===a.length&&delete s[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let e=0,r=t.length;e!==r;++e){const r=t[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,n=this._bindings;let s=i[t];void 0===s&&(s={},i[t]=s),s[r]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,n=r.path,s=this._bindingsByRootAndName,o=s[i],a=t[t.length-1],l=e._cacheIndex;a._cacheIndex=l,t[l]=a,t.pop(),delete o[n],0===Object.keys(o).length&&delete s[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,n=t[i];e._cacheIndex=i,t[i]=e,n._cacheIndex=r,t[r]=n}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return void 0===r&&(r=new Xu(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,n=t[i];e.__cacheIndex=i,t[i]=e,n.__cacheIndex=r,t[r]=n}clipAction(e,t,r){const i=t||this._root,n=i.uuid;let s="string"==typeof e?sh.findByName(i,e):e;const o=null!==s?s.uuid:e,a=this._actionsByClip[o];let l=null;if(void 0===r&&(r=null!==s?s.blendMode:Ct),void 0!==a){const e=a.actionByRoot[n];if(void 0!==e&&e.blendMode===r)return e;l=a.knownActions[0],null===s&&(s=l._clip)}if(null===s)return null;const c=new Rd(this,s,t,r);return this._bindAction(c,l),this._addInactiveAction(c,o,n),c}existingAction(e,t){const r=t||this._root,i=r.uuid,n="string"==typeof e?sh.findByName(r,e):e,s=n?n.uuid:e,o=this._actionsByClip[s];return void 0!==o&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,n=Math.sign(e),s=this._accuIndex^=1;for(let o=0;o!==r;++o){t[o]._update(i,e,n,s)}const o=this._bindings,a=this._nActiveBindings;for(let e=0;e!==a;++e)o[e].apply(s);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,n=i[r];if(void 0!==n){const e=n.knownActions;for(let r=0,i=e.length;r!==i;++r){const i=e[r];this._deactivateAction(i);const n=i._cacheIndex,s=t[t.length-1];i._cacheIndex=null,i._byClipCacheIndex=null,s._cacheIndex=n,t[n]=s,t.pop(),this._removeInactiveBindingsForAction(i)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const e in r){const i=r[e].actionByRoot[t];void 0!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}const i=this._bindingsByRootAndName[t];if(void 0!==i)for(const e in i){const t=i[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){const r=this.existingAction(e,t);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}Id.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Od{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Od(void 0===this.value.clone?this.value:this.value.clone())}}class Pd extends ol{constructor(e,t,r=1){super(e,t),this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}Pd.prototype.isInstancedInterleavedBuffer=!0;class kd{constructor(e,t,r,i,n){this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=n,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}kd.prototype.isGLBufferAttribute=!0;class Ld{constructor(e,t,r=0,i=1/0){this.ray=new Ri(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new Fi,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return Gd(e,this,r,t),r.sort(Nd),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)Gd(e[i],this,r,t);return r.sort(Nd),r}}function Nd(e,t){return e.distance-t.distance}function Gd(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),!0===i){const i=e.children;for(let e=0,n=i.length;e<n;e++)Gd(i[e],t,r,!0)}}class Dd{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){const e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(br(t/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Ud{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return(new this.constructor).copy(this)}}const Vd=new Sr;class Bd{constructor(e=new Sr(1/0,1/0),t=new Sr(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Vd.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Vd.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Bd.prototype.isBox2=!0;const Fd=new Qr,jd=new Qr;class zd{constructor(e=new Qr,t=new Qr){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Fd.subVectors(e,this.start),jd.subVectors(this.end,this.start);const r=jd.dot(jd);let i=jd.dot(Fd)/r;return t&&(i=br(i,0,1)),i}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}const Wd=new Qr;class Hd extends tn{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const r=new Dn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1,r=32;e<r;e++,t++){const n=e/r*Math.PI*2,s=t/r*Math.PI*2;i.push(Math.cos(n),Math.sin(n),1,Math.cos(s),Math.sin(s),1)}r.setAttribute("position",new Cn(i,3));const n=new Hl({fog:!1,toneMapped:!1});this.cone=new ec(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Wd.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Wd),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const $d=new Qr,Yd=new Ii,qd=new Ii;class Xd extends ec{constructor(e){const t=Zd(e),r=new Dn,i=[],n=[],s=new Ur(0,0,1),o=new Ur(0,1,0);for(let e=0;e<t.length;e++){const r=t[e];r.parent&&r.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),n.push(s.r,s.g,s.b),n.push(o.r,o.g,o.b))}r.setAttribute("position",new Cn(i,3)),r.setAttribute("color",new Cn(n,3));super(r,new Hl({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");qd.copy(this.root.matrixWorld).invert();for(let e=0,r=0;e<t.length;e++){const n=t[e];n.parent&&n.parent.isBone&&(Yd.multiplyMatrices(qd,n.matrixWorld),$d.setFromMatrixPosition(Yd),i.setXYZ(r,$d.x,$d.y,$d.z),Yd.multiplyMatrices(qd,n.parent.matrixWorld),$d.setFromMatrixPosition(Yd),i.setXYZ(r+1,$d.x,$d.y,$d.z),r+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Zd(e){const t=[];!0===e.isBone&&t.push(e);for(let r=0;r<e.children.length;r++)t.push.apply(t,Zd(e.children[r]));return t}class Jd extends ts{constructor(e,t,r){super(new Mu(t,4,2),new gn({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Kd=new Qr,Qd=new Ur,ef=new Ur;class tf extends tn{constructor(e,t,r){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;const i=new Au(t);i.rotateY(.5*Math.PI),this.material=new gn({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const n=i.getAttribute("position"),s=new Float32Array(3*n.count);i.setAttribute("color",new bn(s,3)),this.add(new ts(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Qd.copy(this.light.color),ef.copy(this.light.groundColor);for(let e=0,r=t.count;e<r;e++){const i=e<r/2?Qd:ef;t.setXYZ(e,i.r,i.g,i.b)}t.needsUpdate=!0}e.lookAt(Kd.setFromMatrixPosition(this.light.matrixWorld).negate())}}class rf extends ec{constructor(e=10,t=10,r=4473924,i=8947848){r=new Ur(r),i=new Ur(i);const n=t/2,s=e/t,o=e/2,a=[],l=[];for(let e=0,c=0,u=-o;e<=t;e++,u+=s){a.push(-o,0,u,o,0,u),a.push(u,0,-o,u,0,o);const t=e===n?r:i;t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3,t.toArray(l,c),c+=3}const c=new Dn;c.setAttribute("position",new Cn(a,3)),c.setAttribute("color",new Cn(l,3));super(c,new Hl({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class nf extends ec{constructor(e=10,t=16,r=8,i=64,n=4473924,s=8947848){n=new Ur(n),s=new Ur(s);const o=[],a=[];for(let r=0;r<=t;r++){const i=r/t*(2*Math.PI),l=Math.sin(i)*e,c=Math.cos(i)*e;o.push(0,0,0),o.push(l,0,c);const u=1&r?n:s;a.push(u.r,u.g,u.b),a.push(u.r,u.g,u.b)}for(let t=0;t<=r;t++){const l=1&t?n:s,c=e-e/r*t;for(let e=0;e<i;e++){let t=e/i*(2*Math.PI),r=Math.sin(t)*c,n=Math.cos(t)*c;o.push(r,0,n),a.push(l.r,l.g,l.b),t=(e+1)/i*(2*Math.PI),r=Math.sin(t)*c,n=Math.cos(t)*c,o.push(r,0,n),a.push(l.r,l.g,l.b)}}const l=new Dn;l.setAttribute("position",new Cn(o,3)),l.setAttribute("color",new Cn(a,3));super(l,new Hl({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const sf=new Qr,of=new Qr,af=new Qr;class lf extends tn{constructor(e,t,r){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===t&&(t=1);let i=new Dn;i.setAttribute("position",new Cn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const n=new Hl({fog:!1,toneMapped:!1});this.lightPlane=new Jl(i,n),this.add(this.lightPlane),i=new Dn,i.setAttribute("position",new Cn([0,0,0,0,0,1],3)),this.targetLine=new Jl(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){sf.setFromMatrixPosition(this.light.matrixWorld),of.setFromMatrixPosition(this.light.target.matrixWorld),af.subVectors(of,sf),this.lightPlane.lookAt(of),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(of),this.targetLine.scale.z=af.length()}}const cf=new Qr,uf=new ls;class hf extends ec{constructor(e){const t=new Dn,r=new Hl({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},o=new Ur(16755200),a=new Ur(16711680),l=new Ur(43775),c=new Ur(16777215),u=new Ur(3355443);function h(e,t,r){d(e,r),d(t,r)}function d(e,t){i.push(0,0,0),n.push(t.r,t.g,t.b),void 0===s[e]&&(s[e]=[]),s[e].push(i.length/3-1)}h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u),t.setAttribute("position",new Cn(i,3)),t.setAttribute("color",new Cn(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){const e=this.geometry,t=this.pointMap;uf.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),df("c",t,e,uf,0,0,-1),df("t",t,e,uf,0,0,1),df("n1",t,e,uf,-1,-1,-1),df("n2",t,e,uf,1,-1,-1),df("n3",t,e,uf,-1,1,-1),df("n4",t,e,uf,1,1,-1),df("f1",t,e,uf,-1,-1,1),df("f2",t,e,uf,1,-1,1),df("f3",t,e,uf,-1,1,1),df("f4",t,e,uf,1,1,1),df("u1",t,e,uf,.7,1.1,-1),df("u2",t,e,uf,-.7,1.1,-1),df("u3",t,e,uf,0,2,-1),df("cf1",t,e,uf,-1,0,1),df("cf2",t,e,uf,1,0,1),df("cf3",t,e,uf,0,-1,1),df("cf4",t,e,uf,0,1,1),df("cn1",t,e,uf,-1,0,-1),df("cn2",t,e,uf,1,0,-1),df("cn3",t,e,uf,0,-1,-1),df("cn4",t,e,uf,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function df(e,t,r,i,n,s,o){cf.set(n,s,o).unproject(i);const a=t[e];if(void 0!==a){const e=r.getAttribute("position");for(let t=0,r=a.length;t<r;t++)e.setXYZ(a[t],cf.x,cf.y,cf.z)}}const ff=new ri;class pf extends ec{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),n=new Dn;n.setIndex(new bn(r,1)),n.setAttribute("position",new bn(i,3)),super(n,new Hl({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&ff.setFromObject(this.object),ff.isEmpty())return;const t=ff.min,r=ff.max,i=this.geometry.attributes.position,n=i.array;n[0]=r.x,n[1]=r.y,n[2]=r.z,n[3]=t.x,n[4]=r.y,n[5]=r.z,n[6]=t.x,n[7]=t.y,n[8]=r.z,n[9]=r.x,n[10]=t.y,n[11]=r.z,n[12]=r.x,n[13]=r.y,n[14]=t.z,n[15]=t.x,n[16]=r.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=r.x,n[22]=t.y,n[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return ec.prototype.copy.call(this,e),this.object=e.object,this}}class mf extends ec{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Dn;i.setIndex(new bn(r,1)),i.setAttribute("position",new Cn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(i,new Hl({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class gf extends Jl{constructor(e,t=1,r=16776960){const i=r,n=new Dn;n.setAttribute("position",new Cn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),n.computeBoundingSphere(),super(n,new Hl({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const s=new Dn;s.setAttribute("position",new Cn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),s.computeBoundingSphere(),this.add(new ts(s,new gn({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?m:p,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const vf=new Qr;let _f,bf;class yf extends tn{constructor(e=new Qr(0,0,1),t=new Qr(0,0,0),r=1,i=16776960,n=.2*r,s=.2*n){super(),this.type="ArrowHelper",void 0===_f&&(_f=new Dn,_f.setAttribute("position",new Cn([0,0,0,0,1,0],3)),bf=new pc(0,.5,1,5,1),bf.translate(0,-.5,0)),this.position.copy(t),this.line=new Jl(_f,new Hl({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ts(bf,new gn({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,n,s)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{vf.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(vf,t)}}setLength(e,t=.2*e,r=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class Ef extends ec{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=new Dn;r.setAttribute("position",new Cn(t,3)),r.setAttribute("color",new Cn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));super(r,new Hl({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,t,r){const i=new Ur,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class wf{constructor(){this.type="ShapePath",this.color=new Ur,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Wc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){return this.currentPath.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function r(e){const t=[];for(let r=0,i=e.length;r<i;r++){const i=e[r],n=new Hc;n.curves=i.curves,t.push(n)}return t}function i(e,t){const r=t.length;let i=!1;for(let n=r-1,s=0;s<r;n=s++){let r=t[n],o=t[s],a=o.x-r.x,l=o.y-r.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(r=t[s],a=-a,o=t[n],l=-l),e.y<r.y||e.y>o.y)continue;if(e.y===r.y){if(e.x===r.x)return!0}else{const t=l*(e.x-r.x)-a*(e.y-r.y);if(0===t)return!0;if(t<0)continue;i=!i}}else{if(e.y!==r.y)continue;if(o.x<=e.x&&e.x<=r.x||r.x<=e.x&&e.x<=o.x)return!0}}return i}const n=vu.isClockWise,s=this.subPaths;if(0===s.length)return[];if(!0===t)return r(s);let o,a,l;const c=[];if(1===s.length)return a=s[0],l=new Hc,l.curves=a.curves,c.push(l),c;let u=!n(s[0].getPoints());u=e?!u:u;const h=[],d=[];let f,p,m=[],g=0;d[g]=void 0,m[g]=[];for(let t=0,r=s.length;t<r;t++)a=s[t],f=a.getPoints(),o=n(f),o=e?!o:o,o?(!u&&d[g]&&g++,d[g]={s:new Hc,p:f},d[g].s.curves=a.curves,u&&g++,m[g]=[]):m[g].push({h:a,p:f[0]});if(!d[0])return r(s);if(d.length>1){let e=!1,t=0;for(let e=0,t=d.length;e<t;e++)h[e]=[];for(let r=0,n=d.length;r<n;r++){const n=m[r];for(let s=0;s<n.length;s++){const o=n[s];let a=!0;for(let n=0;n<d.length;n++)i(o.p,d[n].p)&&(r!==n&&t++,a?(a=!1,h[n].push(o)):e=!0);a&&h[r].push(o)}}t>0&&!1===e&&(m=h)}for(let e=0,t=d.length;e<t;e++){l=d[e].s,c.push(l),p=m[e];for(let e=0,t=p.length;e<t;e++)l.holes.push(p[e].h)}return c}}const xf=new Float32Array(1),Af=new Int32Array(xf.buffer);class Tf{static toHalfFloat(e){e>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),e=65504),xf[0]=e;const t=Af[0];let r=t>>16&32768,i=t>>12&2047;const n=t>>23&255;return n<103?r:n>142?(r|=31744,r|=(255==n?0:1)&&8388607&t,r):n<113?(i|=2048,r|=(i>>114-n)+(i>>113-n&1),r):(r|=n-112<<10|i>>1,r+=1&i,r)}}const Sf=0,Mf=1,Cf=0,Rf=1,If=2;function Of(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function Pf(e=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function kf(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ac(e,t)}function Lf(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new xl(e)}function Nf(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ac(e,t)}function Gf(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new rc(e)}function Df(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new rc(e)}function Uf(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new rc(e)}function Vf(e,t,r){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Qr(e,t,r)}function Bf(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new bn(e,t).setUsage(rr)}function Ff(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new yn(e,t)}function jf(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new En(e,t)}function zf(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new wn(e,t)}function Wf(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new xn(e,t)}function Hf(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new An(e,t)}function $f(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Tn(e,t)}function Yf(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Sn(e,t)}function qf(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Cn(e,t)}function Xf(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Rn(e,t)}function Zf(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Ef(e)}function Jf(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new pf(e,t)}function Kf(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ec(new wc(e.geometry),new Hl({color:void 0!==t?t:16777215}))}function Qf(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ec(new Pu(e.geometry),new Hl({color:void 0!==t?t:16777215}))}function ep(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new dh(e)}function tp(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new vh(e)}function rp(e,t,r){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new fs(e,r)}function ip(){console.error("THREE.CanvasRenderer has been removed")}function np(){console.error("THREE.JSONLoader has been removed.")}xc.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(xc.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},Wc.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},rf.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Xd.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},uh.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Vh.extractUrlBase(e)},uh.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Bd.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},Bd.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Bd.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Bd.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},ri.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},ri.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ri.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},ri.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},ri.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},Bi.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},Ei.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},ys.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},zd.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Mr.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Mr.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Mr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Mr.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Mr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Mr.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Ii.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},Ii.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Ii.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Qr).setFromMatrixColumn(this,3)},Ii.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},Ii.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Ii.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Ii.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Ii.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Ii.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},Ii.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Ii.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Ii.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Ii.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Ii.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Ii.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Ii.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Ii.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Ii.prototype.makeFrustum=function(e,t,r,i,n,s){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,r,n,s)},Ii.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},vs.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Kr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Kr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Ri.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Ri.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},Ri.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},fn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},fn.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},fn.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},fn.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},fn.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},fn.barycoordFromPoint=function(e,t,r,i,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),fn.getBarycoord(e,t,r,i,n)},fn.normal=function(e,t,r,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),fn.getNormal(e,t,r,i)},Hc.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},Hc.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new yu(this,e)},Hc.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Su(this,e)},Sr.prototype.fromAttribute=function(e,t,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},Sr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Sr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Qr.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Qr.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Qr.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Qr.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Qr.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Qr.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Qr.prototype.fromAttribute=function(e,t,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},Qr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Qr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Hr.prototype.fromAttribute=function(e,t,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,r)},Hr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},tn.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},tn.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},tn.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},tn.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},tn.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(tn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ts.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(ts.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),It},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),kl.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},cs.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(bh.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(bn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===rr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(rr)}}}),bn.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?rr:tr),this},bn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},bn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Dn.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},Dn.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new bn(arguments[1],arguments[2])))},Dn.prototype.addDrawCall=function(e,t,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},Dn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Dn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Dn.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},Dn.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Dn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),ol.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?rr:tr),this},ol.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},yu.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},yu.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},yu.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},sl.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Od.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(mn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Ur}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===v}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(as.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),tl.prototype.clearTarget=function(e,t,r,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,r,i)},tl.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},tl.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},tl.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},tl.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},tl.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},tl.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},tl.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},tl.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},tl.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},tl.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},tl.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},tl.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},tl.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},tl.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},tl.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},tl.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},tl.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},tl.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},tl.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},tl.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},tl.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},tl.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},tl.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},tl.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(tl.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?Lt:kt}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(Wa.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties($r.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),cd.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const t=this;return(new Xh).load(e,(function(e){t.setBuffer(e)})),this},md.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},hs.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},hs.prototype.clear=function(e,t,r,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,r,i)},Br.crossOrigin=void 0,Br.loadTexture=function(e,t,r,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const n=new _h;n.setCrossOrigin(this.crossOrigin);const s=n.load(e,r,void 0,i);return t&&(s.mapping=t),s},Br.loadTextureCube=function(e,t,r,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const n=new gh;n.setCrossOrigin(this.crossOrigin);const s=n.load(e,r,void 0,i);return t&&(s.mapping=t),s},Br.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Br.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const sp={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function op(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function ap(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new Dn}function lp(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new Dn}function cp(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function up(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function hp(){console.error("THREE.ImmediateRenderObject has been removed.")}function dp(e,t,r){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.');const i=new $r(e,t,r);return i.samples=4,i}function fp(e,t,r,i){return console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),new Yr(e,t,r,i)}function pp(e,t,r,i){return console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),new Xr(e,t,r,i)}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:i}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=i)})),s.register("ldVf1",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Canvas=e.exports.CanvasEngine=void 0;var r=s("agDTQ");Object.defineProperty(e.exports,"Canvas",{enumerable:!0,get:function(){return r.Canvas}});var i=s("foelG");Object.defineProperty(e.exports,"CanvasEngine",{enumerable:!0,get:function(){return i.CanvasEngine}})})),s.register("agDTQ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Canvas=void 0;e.exports.Canvas=class{constructor(e,t,r){this._id=e,this._originalDefinition=t,this._canvasElement=r,this._originalDefinition&&this._originalDefinition instanceof HTMLCanvasElement&&(this._originalDefinition=this._originalDefinition.cloneNode(!0)),r?this._canvasElement=r:(this._canvasElement=document.createElement("canvas"),this._canvasElement.id=this._id)}get canvasElement(){return this._canvasElement}get id(){return this._id}reset(){var e;const t=null===(e=this._canvasElement)||void 0===e?void 0:e.parentElement;null==t||t.removeChild(this._canvasElement),this._originalDefinition instanceof HTMLCanvasElement&&(null==t||t.appendChild(this._canvasElement))}}})),s.register("foelG",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CanvasEngine=void 0,s("yoicn");var i=s("bJEmL"),n=s("crO5Z"),o=s("cTTbu"),a=s("agDTQ");let l=class{constructor(){this._canvasDictionary={},this._uuidGenerator=i.instance.resolve(o.UuidGenerator)}createCanvasObject(e,t){if(t=void 0!==t&&this._uuidGenerator.validate(t)?t:this._uuidGenerator.create(),e instanceof HTMLCanvasElement){const r=e;return r.id||(r.id=this._uuidGenerator.create()),this._canvasDictionary[t]=new a.Canvas(r.id,e,r),t}if(e){const r=e,i=document.getElementById(r);for(let e in this._canvasDictionary)if(this._canvasDictionary[e].id===r)return e;if(i instanceof HTMLCanvasElement)return this._canvasDictionary[t]=new a.Canvas(r,e,i),t;if(!i)return this._canvasDictionary[t]=new a.Canvas(r,e),t}return this._canvasDictionary[t]=new a.Canvas(t,e),t}getCanvas(e){return this._canvasDictionary[e]}};l=r([n.default()],l),e.exports.CanvasEngine=l})),s.register("12eGO",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GEOMETRYTYPEHINT=e.exports.PRIMITIVETYPEHINT=e.exports.SDTFItemData=e.exports.SDTFAttributeData=e.exports.ATTRIBUTEVISUALIZATION=e.exports.SDTFAttributeVisualization=e.exports.SDTFAttributesData=e.exports.SDTFAttributeOverview=e.exports.TASKTYPE=e.exports.CustomData=e.exports.HTMLElementAnchorData=e.exports.HTMLElementAnchorImageData=e.exports.HTMLElementAnchorTextData=e.exports.HTMLElementAnchorCustomData=e.exports.PRIMITIVE_MODE=e.exports.MaterialVariantsData=e.exports.PrimitiveData=e.exports.AttributeData=e.exports.GeometryData=e.exports.AnimationData=e.exports.TEXTURE_FILTERING=e.exports.TEXTURE_WRAPPING=e.exports.MATERIAL_SHADING=e.exports.MATERIAL_ALPHA=e.exports.MATERIAL_SIDE=e.exports.MapData=e.exports.MaterialSpecularGlossinessData=e.exports.MaterialUnlitData=e.exports.AbstractMaterialData=e.exports.MaterialStandardData=void 0;var r=s("N9NwF");Object.defineProperty(e.exports,"CustomData",{enumerable:!0,get:function(){return r.CustomData}});var i=s("YfKMc");Object.defineProperty(e.exports,"AttributeData",{enumerable:!0,get:function(){return i.AttributeData}}),Object.defineProperty(e.exports,"GeometryData",{enumerable:!0,get:function(){return i.GeometryData}}),Object.defineProperty(e.exports,"PRIMITIVE_MODE",{enumerable:!0,get:function(){return i.PRIMITIVE_MODE}}),Object.defineProperty(e.exports,"PrimitiveData",{enumerable:!0,get:function(){return i.PrimitiveData}});var n=s("kSdxY");Object.defineProperty(e.exports,"MaterialStandardData",{enumerable:!0,get:function(){return n.MaterialStandardData}});var o=s("d6dMu");Object.defineProperty(e.exports,"HTMLElementAnchorCustomData",{enumerable:!0,get:function(){return o.HTMLElementAnchorCustomData}}),Object.defineProperty(e.exports,"HTMLElementAnchorData",{enumerable:!0,get:function(){return o.HTMLElementAnchorData}}),Object.defineProperty(e.exports,"HTMLElementAnchorImageData",{enumerable:!0,get:function(){return o.HTMLElementAnchorImageData}}),Object.defineProperty(e.exports,"HTMLElementAnchorTextData",{enumerable:!0,get:function(){return o.HTMLElementAnchorTextData}});var a=s("ahMk5");Object.defineProperty(e.exports,"GEOMETRYTYPEHINT",{enumerable:!0,get:function(){return a.GEOMETRYTYPEHINT}}),Object.defineProperty(e.exports,"PRIMITIVETYPEHINT",{enumerable:!0,get:function(){return a.PRIMITIVETYPEHINT}}),Object.defineProperty(e.exports,"SDTFAttributeData",{enumerable:!0,get:function(){return a.SDTFAttributeData}}),Object.defineProperty(e.exports,"SDTFAttributesData",{enumerable:!0,get:function(){return a.SDTFAttributesData}});var l=s("esIXR");Object.defineProperty(e.exports,"SDTFItemData",{enumerable:!0,get:function(){return l.SDTFItemData}});var c=s("3vDMM");Object.defineProperty(e.exports,"SDTFAttributeOverview",{enumerable:!0,get:function(){return c.SDTFAttributeOverview}});var u=s("lq1YW");Object.defineProperty(e.exports,"ATTRIBUTEVISUALIZATION",{enumerable:!0,get:function(){return u.ATTRIBUTEVISUALIZATION}}),Object.defineProperty(e.exports,"SDTFAttributeVisualization",{enumerable:!0,get:function(){return u.SDTFAttributeVisualization}});var h=s("7U4aP");Object.defineProperty(e.exports,"AnimationData",{enumerable:!0,get:function(){return h.AnimationData}});var d=s("170bj");Object.defineProperty(e.exports,"TASKTYPE",{enumerable:!0,get:function(){return d.TASKTYPE}});var f=s("fcDWo");Object.defineProperty(e.exports,"MaterialVariantsData",{enumerable:!0,get:function(){return f.MaterialVariantsData}});var p=s("jYmZR");Object.defineProperty(e.exports,"MapData",{enumerable:!0,get:function(){return p.MapData}}),Object.defineProperty(e.exports,"TEXTURE_FILTERING",{enumerable:!0,get:function(){return p.TEXTURE_FILTERING}}),Object.defineProperty(e.exports,"TEXTURE_WRAPPING",{enumerable:!0,get:function(){return p.TEXTURE_WRAPPING}});var m=s("chw7c");Object.defineProperty(e.exports,"MATERIAL_SIDE",{enumerable:!0,get:function(){return m.MATERIAL_SIDE}}),Object.defineProperty(e.exports,"MATERIAL_ALPHA",{enumerable:!0,get:function(){return m.MATERIAL_ALPHA}}),Object.defineProperty(e.exports,"MATERIAL_SHADING",{enumerable:!0,get:function(){return m.MATERIAL_SHADING}}),Object.defineProperty(e.exports,"AbstractMaterialData",{enumerable:!0,get:function(){return m.AbstractMaterialData}});var g=s("cf5Bo");Object.defineProperty(e.exports,"MaterialSpecularGlossinessData",{enumerable:!0,get:function(){return g.MaterialSpecularGlossinessData}});var v=s("04FRV");Object.defineProperty(e.exports,"MaterialUnlitData",{enumerable:!0,get:function(){return v.MaterialUnlitData}})})),s.register("N9NwF",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},n=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CustomData=void 0;var o=s("eYU63");class a extends o.AbstractTreeNodeData{constructor(e,t){super(t),r.set(this,void 0),i(this,r,e,"f")}get data(){return n(this,r,"f")}set data(e){i(this,r,e,"f")}clone(){return new a(Object.assign({},this.data),this.id)}}e.exports.CustomData=a,r=new WeakMap})),s.register("YfKMc",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E,w,x,A,T,S,M,C,R,I,O,P,k=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},L=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GeometryData=e.exports.PrimitiveData=e.exports.AttributeData=e.exports.PRIMITIVE_MODE=void 0;var N,G,D=s("eIStk"),U=s("3iqbd"),V=s("eYU63"),B=s("6UMiq");(G=N=e.exports.PRIMITIVE_MODE||(e.exports.PRIMITIVE_MODE={}))[G.POINTS=0]="POINTS",G[G.LINES=1]="LINES",G[G.LINE_LOOP=2]="LINE_LOOP",G[G.LINE_STRIP=3]="LINE_STRIP",G[G.TRIANGLES=4]="TRIANGLES",G[G.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",G[G.TRIANGLE_FAN=6]="TRIANGLE_FAN";class F{constructor(e,t,s,v,_,b,y,E=[],w=[],x,A,T,S,M=[]){r.set(this,[]),i.set(this,void 0),n.set(this,void 0),o.set(this,void 0),a.set(this,void 0),l.set(this,void 0),c.set(this,void 0),u.set(this,void 0),h.set(this,[]),d.set(this,[]),f.set(this,void 0),p.set(this,void 0),m.set(this,void 0),g.set(this,void 0),k(this,i,e,"f"),k(this,u,t,"f"),k(this,c,s,"f"),k(this,n,v,"f"),k(this,l,_,"f"),k(this,f,b,"f"),k(this,a,y,"f"),k(this,d,E,"f"),k(this,h,w,"f"),k(this,o,x,"f"),k(this,p,A,"f"),k(this,m,T,"f"),k(this,g,S,"f"),k(this,r,M,"f")}get array(){return L(this,i,"f")}get byteOffset(){return L(this,n,"f")}get byteStride(){return L(this,o,"f")}get count(){return L(this,a,"f")}get elementBytes(){return L(this,l,"f")}get itemBytes(){return L(this,c,"f")}get itemSize(){return L(this,u,"f")}get max(){return L(this,h,"f")}get min(){return L(this,d,"f")}get morphAttributeData(){return L(this,r,"f")}get normalized(){return L(this,f,"f")}get sparse(){return L(this,p,"f")}get sparseIndices(){return L(this,m,"f")}get sparseValues(){return L(this,g,"f")}clone(){let e=L(this,i,"f").slice(0,L(this,i,"f").length);return e.set(L(this,i,"f")),new F(e,L(this,u,"f"),L(this,c,"f"),L(this,n,"f"),L(this,l,"f"),L(this,f,"f"),L(this,a,"f"),L(this,d,"f"),L(this,h,"f"),L(this,o,"f"),L(this,p,"f"),L(this,m,"f"),L(this,g,"f"),L(this,r,"f"))}}e.exports.AttributeData=F,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap;class j{constructor(e={},t=N.TRIANGLES,r=null,i=null,n=null){v.set(this,{}),_.set(this,N.TRIANGLES),b.set(this,new B.Box),y.set(this,null),E.set(this,null),w.set(this,null),x.set(this,[]),A.set(this,[]),T.set(this,null),k(this,v,e,"f"),k(this,_,t,"f"),k(this,y,r,"f"),k(this,E,i,"f"),k(this,w,i,"f"),k(this,T,n,"f"),L(this,v,"f").POSITION&&(3===L(this,v,"f").POSITION.min.length&&3===L(this,v,"f").POSITION.max.length?k(this,b,new B.Box(D.fromValues(L(this,v,"f").POSITION.min[0],L(this,v,"f").POSITION.min[1],L(this,v,"f").POSITION.min[2]),D.fromValues(L(this,v,"f").POSITION.max[0],L(this,v,"f").POSITION.max[1],L(this,v,"f").POSITION.max[2])),"f"):L(this,b,"f").setFromAttributeArray(L(this,v,"f").POSITION.array))}get attributes(){return L(this,v,"f")}get boundingBox(){return L(this,b,"f")}get indices(){return L(this,y,"f")}set indices(e){k(this,y,e,"f")}get standardMaterial(){return L(this,w,"f")}set standardMaterial(e){k(this,w,e,"f")}get material(){return L(this,E,"f")}set material(e){k(this,E,e,"f")}get effectMaterials(){return L(this,x,"f")}get materialVariants(){return L(this,A,"f")}get attributeMaterial(){return L(this,T,"f")}set attributeMaterial(e){k(this,T,e,"f")}get mode(){return L(this,_,"f")}clone(){var e,t,r;let i={};for(let e in L(this,v,"f"))i[e]=L(this,v,"f")[e].clone();return new j(i,L(this,_,"f"),null===(e=L(this,y,"f"))||void 0===e?void 0:e.clone(),null===(t=L(this,E,"f"))||void 0===t?void 0:t.clone(),null===(r=L(this,T,"f"))||void 0===r?void 0:r.clone())}}e.exports.PrimitiveData=j,v=new WeakMap,_=new WeakMap,b=new WeakMap,y=new WeakMap,E=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakMap,T=new WeakMap;class z extends V.AbstractTreeNodeData{constructor(e,t=U.create(),r,i=[],n=[],s=[]){super(r),S.set(this,void 0),M.set(this,void 0),C.set(this,new B.Box),R.set(this,0),I.set(this,[]),O.set(this,[]),P.set(this,[]),k(this,M,e,"f"),k(this,S,t,"f"),k(this,C,this.primitive.boundingBox.clone(),"f"),k(this,I,i,"f"),k(this,O,n,"f"),k(this,P,s,"f")}get boundingBox(){return L(this,C,"f")}get matrix(){return L(this,S,"f")}get primitive(){return L(this,M,"f")}get renderOrder(){return L(this,R,"f")}set renderOrder(e){k(this,R,e,"f")}get morphWeights(){return L(this,I,"f")}set morphWeights(e){k(this,I,e,"f")}get bones(){return L(this,O,"f")}set bones(e){k(this,O,e,"f")}get boneInverses(){return L(this,P,"f")}set boneInverses(e){k(this,P,e,"f")}clone(){return new z(L(this,M,"f").clone(),U.clone(this.matrix),this.id,L(this,I,"f"),L(this,O,"f"),L(this,P,"f"))}intersect(e,t){return this.primitive.mode!==N.TRIANGLES?null:this.boundingBox.intersect(e,t)}}e.exports.GeometryData=z,S=new WeakMap,M=new WeakMap,C=new WeakMap,R=new WeakMap,I=new WeakMap,O=new WeakMap,P=new WeakMap})),s.register("kSdxY",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E,w,x,A,T,S,M,C,R=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},I=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialStandardData=void 0;var O=s("chw7c");class P extends O.AbstractMaterialData{constructor(e,t){super(e,t),r.set(this,"#ffffff"),i.set(this,0),n.set(this,0),o.set(this,void 0),a.set(this,void 0),l.set(this,0),c.set(this,void 0),u.set(this,1.5),h.set(this,1),d.set(this,void 0),f.set(this,void 0),p.set(this,1),m.set(this,void 0),g.set(this,0),v.set(this,"#ffffff"),_.set(this,void 0),b.set(this,1),y.set(this,void 0),E.set(this,"#ffffff"),w.set(this,void 0),x.set(this,1),A.set(this,void 0),T.set(this,0),S.set(this,void 0),M.set(this,0),C.set(this,void 0),e&&(void 0!==e.metalness&&(this.metalness=e.metalness),void 0!==e.metalnessMap&&(this.metalnessMap=e.metalnessMap),void 0!==e.metalnessRoughnessMap&&(this.metalnessRoughnessMap=e.metalnessRoughnessMap),void 0!==e.roughness&&(this.roughness=e.roughness),void 0!==e.roughnessMap&&(this.roughnessMap=e.roughnessMap),void 0!==e.clearcoat&&(this.clearcoat=e.clearcoat),void 0!==e.clearcoatMap&&(this.clearcoatMap=e.clearcoatMap),void 0!==e.clearcoatNormalMap&&(this.clearcoatNormalMap=e.clearcoatNormalMap),void 0!==e.clearcoatRoughness&&(this.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.clearcoatRoughnessMap&&(this.clearcoatRoughnessMap=e.clearcoatRoughnessMap),void 0!==e.ior&&(this.ior=e.ior),void 0!==e.transmission&&(this.transmission=e.transmission),void 0!==e.transmissionMap&&(this.transmissionMap=e.transmissionMap),void 0!==e.thickness&&(this.thickness=e.thickness),void 0!==e.thicknessMap&&(this.thicknessMap=e.thicknessMap),void 0!==e.attenuationDistance&&(this.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&(this.attenuationColor=e.attenuationColor),void 0!==e.sheen&&(this.sheen=e.sheen),void 0!==e.sheenColor&&(this.sheenColor=e.sheenColor),void 0!==e.sheenRoughness&&(this.sheenRoughness=e.sheenRoughness),void 0!==e.sheenColorMap&&(this.sheenColorMap=e.sheenColorMap),void 0!==e.sheenRoughnessMap&&(this.sheenRoughnessMap=e.sheenRoughnessMap),void 0!==e.specularColor&&(this.specularColor=e.specularColor),void 0!==e.specularColorMap&&(this.specularColorMap=e.specularColorMap),void 0!==e.specularIntensity&&(this.specularIntensity=e.specularIntensity),void 0!==e.specularIntensityMap&&(this.specularIntensityMap=e.specularIntensityMap))}get attenuationColor(){return R(this,r,"f")}set attenuationColor(e){I(this,r,e,"f")}get attenuationDistance(){return R(this,i,"f")}set attenuationDistance(e){I(this,i,e,"f")}get clearcoat(){return R(this,n,"f")}set clearcoat(e){I(this,n,e,"f")}get clearcoatMap(){return R(this,o,"f")}set clearcoatMap(e){I(this,o,e,"f")}get clearcoatNormalMap(){return R(this,a,"f")}set clearcoatNormalMap(e){I(this,a,e,"f")}get clearcoatRoughness(){return R(this,l,"f")}set clearcoatRoughness(e){I(this,l,e,"f")}get clearcoatRoughnessMap(){return R(this,c,"f")}set clearcoatRoughnessMap(e){I(this,c,e,"f")}get ior(){return R(this,u,"f")}set ior(e){I(this,u,e,"f")}get metalness(){return R(this,h,"f")}set metalness(e){I(this,h,e,"f")}get metalnessMap(){return R(this,d,"f")}set metalnessMap(e){I(this,d,e,"f")}get metalnessRoughnessMap(){return R(this,f,"f")}set metalnessRoughnessMap(e){I(this,f,e,"f")}get roughness(){return R(this,p,"f")}set roughness(e){I(this,p,e,"f")}get roughnessMap(){return R(this,m,"f")}set roughnessMap(e){I(this,m,e,"f")}get sheen(){return R(this,g,"f")}set sheen(e){I(this,g,e,"f")}get sheenColor(){return R(this,v,"f")}set sheenColor(e){I(this,v,e,"f")}get sheenColorMap(){return R(this,_,"f")}set sheenColorMap(e){I(this,_,e,"f")}get sheenRoughness(){return R(this,b,"f")}set sheenRoughness(e){I(this,b,e,"f")}get sheenRoughnessMap(){return R(this,y,"f")}set sheenRoughnessMap(e){I(this,y,e,"f")}get specularColor(){return R(this,E,"f")}set specularColor(e){I(this,E,e,"f")}get specularColorMap(){return R(this,w,"f")}set specularColorMap(e){I(this,w,e,"f")}get specularIntensity(){return R(this,x,"f")}set specularIntensity(e){I(this,x,e,"f")}get specularIntensityMap(){return R(this,A,"f")}set specularIntensityMap(e){I(this,A,e,"f")}get thickness(){return R(this,T,"f")}set thickness(e){I(this,T,e,"f")}get thicknessMap(){return R(this,S,"f")}set thicknessMap(e){I(this,S,e,"f")}get transmission(){return R(this,M,"f")}set transmission(e){I(this,M,e,"f")}get transmissionMap(){return R(this,C,"f")}set transmissionMap(e){I(this,C,e,"f")}clone(){return new P({alphaMap:this.alphaMap,alphaCutoff:this.alphaCutoff,alphaMode:this.alphaMode,aoMap:this.aoMap,aoMapIntensity:this.aoMapIntensity,bumpMap:this.bumpMap,bumpScale:this.bumpScale,color:this.color,emissiveMap:this.emissiveMap,emissiveness:this.emissiveness,shading:this.shading,map:this.map,metalness:this.metalness,metalnessMap:this.metalnessMap,metalnessRoughnessMap:this.metalnessRoughnessMap,name:this.name,normalMap:this.normalMap,normalScale:this.normalScale,opacity:this.opacity,roughness:this.roughness,roughnessMap:this.roughnessMap,side:this.side,clearcoat:this.clearcoat,clearcoatMap:this.clearcoatMap,clearcoatNormalMap:this.clearcoatNormalMap,clearcoatRoughness:this.clearcoatRoughness,clearcoatRoughnessMap:this.clearcoatRoughnessMap,ior:this.ior,transmission:this.transmission,transmissionMap:this.transmissionMap,thickness:this.thickness,thicknessMap:this.thicknessMap,attenuationDistance:this.attenuationDistance,attenuationColor:this.attenuationColor,sheen:this.sheen,sheenColor:this.sheenColor,sheenColorMap:this.sheenColorMap,sheenRoughness:this.sheenRoughness,sheenRoughnessMap:this.sheenRoughnessMap,specularColor:this.specularColor,specularColorMap:this.specularColorMap,specularIntensity:this.specularIntensity,specularIntensityMap:this.specularIntensityMap},this.id)}}e.exports.MaterialStandardData=P,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,_=new WeakMap,b=new WeakMap,y=new WeakMap,E=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakMap,T=new WeakMap,S=new WeakMap,M=new WeakMap,C=new WeakMap})),s.register("chw7c",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},w=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractMaterialData=e.exports.MATERIAL_SHADING=e.exports.MATERIAL_ALPHA=e.exports.MATERIAL_SIDE=void 0;var x,A,T,S,M,C,R=s("eYU63");(A=x=e.exports.MATERIAL_SIDE||(e.exports.MATERIAL_SIDE={})).DOUBLE="double",A.FRONT="front",A.BACK="back",(S=T=e.exports.MATERIAL_ALPHA||(e.exports.MATERIAL_ALPHA={})).OPAQUE="opaque",S.MASK="mask",S.BLEND="blend",(C=M=e.exports.MATERIAL_SHADING||(e.exports.MATERIAL_SHADING={})).FLAT="flat",C.SMOOTH="smooth";class I extends R.AbstractTreeNodeData{constructor(e,t){super(t),r.set(this,0),i.set(this,void 0),n.set(this,T.OPAQUE),o.set(this,void 0),a.set(this,1),l.set(this,void 0),c.set(this,1),u.set(this,"#00fff7"),h.set(this,void 0),d.set(this,void 0),f.set(this,!1),p.set(this,void 0),m.set(this,void 0),g.set(this,void 0),v.set(this,1),_.set(this,1),b.set(this,M.SMOOTH),y.set(this,x.DOUBLE),e&&(void 0!==e.alphaMap&&(this.alphaMap=e.alphaMap),void 0!==e.alphaCutoff&&(this.alphaCutoff=e.alphaCutoff),void 0!==e.alphaMode&&(this.alphaMode=e.alphaMode),void 0!==e.aoMap&&(this.aoMap=e.aoMap),void 0!==e.aoMapIntensity&&(this.aoMapIntensity=e.aoMapIntensity),void 0!==e.bumpMap&&(this.bumpMap=e.bumpMap),void 0!==e.bumpScale&&(this.bumpScale=e.bumpScale),void 0!==e.color&&(this.color=e.color),void 0!==e.emissiveMap&&(this.emissiveMap=e.emissiveMap),void 0!==e.emissiveness&&(this.emissiveness=e.emissiveness),void 0!==e.shading&&(this.shading=e.shading),void 0!==e.map&&(this.map=e.map),void 0!==e.name&&(this.name=e.name),void 0!==e.normalMap&&(this.normalMap=e.normalMap),void 0!==e.normalScale&&(this.normalScale=e.normalScale),void 0!==e.opacity&&(this.opacity=e.opacity),void 0!==e.side&&(this.side=e.side))}get alphaCutoff(){return E(this,r,"f")}set alphaCutoff(e){w(this,r,e,"f")}get alphaMap(){return E(this,i,"f")}set alphaMap(e){w(this,i,e,"f")}get alphaMode(){return E(this,n,"f")}set alphaMode(e){w(this,n,e,"f")}get aoMap(){return E(this,o,"f")}set aoMap(e){w(this,o,e,"f")}get aoMapIntensity(){return E(this,a,"f")}set aoMapIntensity(e){w(this,a,e,"f")}get bumpMap(){return E(this,l,"f")}set bumpMap(e){w(this,l,e,"f")}get bumpScale(){return E(this,c,"f")}set bumpScale(e){w(this,c,e,"f")}get color(){return E(this,u,"f")}set color(e){w(this,u,e,"f")}get emissiveMap(){return E(this,h,"f")}set emissiveMap(e){w(this,h,e,"f")}get emissiveness(){return E(this,d,"f")}set emissiveness(e){w(this,d,e,"f")}get map(){return E(this,p,"f")}set map(e){w(this,p,e,"f")}get materialOutput(){return E(this,f,"f")}set materialOutput(e){w(this,f,e,"f")}get name(){return E(this,m,"f")}set name(e){w(this,m,e,"f")}get normalMap(){return E(this,g,"f")}set normalMap(e){w(this,g,e,"f")}get normalScale(){return E(this,v,"f")}set normalScale(e){w(this,v,e,"f")}get opacity(){return E(this,_,"f")}set opacity(e){w(this,_,e,"f")}get shading(){return E(this,b,"f")}set shading(e){w(this,b,e,"f")}get side(){return E(this,y,"f")}set side(e){w(this,y,e,"f")}}e.exports.AbstractMaterialData=I,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,_=new WeakMap,b=new WeakMap,y=new WeakMap})),s.register("d6dMu",(function(e,t){var r,i,n,o,a,l,c,u,h,d=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},f=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HTMLElementAnchorCustomData=e.exports.HTMLElementAnchorImageData=e.exports.HTMLElementAnchorTextData=e.exports.HTMLElementAnchorData=void 0;var p=s("eYU63");class m extends p.AbstractTreeNodeData{constructor(e){super(e.id),r.set(this,{}),i.set(this,void 0),n.set(this,void 0),o.set(this,!0),a.set(this,void 0),l.set(this,void 0),c.set(this,[]),d(this,l,e.location,"f"),d(this,i,e.data,"f"),d(this,n,e.format,"f"),d(this,o,void 0===e.hideable||e.hideable,"f"),d(this,c,e.viewers||[],"f"),d(this,a,e.intersectionTarget,"f"),this.internalHtmlElement=document.createElement("div"),this.internalHtmlElement.style.position="absolute",this.internalHtmlElement.style.whiteSpace="nowrap",this.internalHtmlElement.style.textOverflow="clip",this.internalHtmlElement.style.fontFamily='"Helvetica Neue", Helvetica, Arial, sans-serif'}get data(){return f(this,i,"f")}set data(e){d(this,i,e,"f")}get format(){return f(this,n,"f")}set format(e){d(this,n,e,"f")}get hideable(){return f(this,o,"f")}set hideable(e){d(this,o,e,"f")}get intersectionTarget(){return f(this,a,"f")}set intersectionTarget(e){d(this,a,e,"f")}get location(){return f(this,l,"f")}set location(e){d(this,l,e,"f")}get viewers(){return f(this,c,"f")}set viewers(e){d(this,c,e,"f")}createViewerHtmlElement(e){return f(this,r,"f")[e]?f(this,r,"f")[e]:this.viewers.includes(e)||0===this.viewers.length?(f(this,r,"f")[e]=this.internalHtmlElement.cloneNode(!0),this.create({anchor:this,parent:f(this,r,"f")[e]}),f(this,r,"f")[e]):null}getViewerHtmlElement(e){return f(this,r,"f")[e]?f(this,r,"f")[e]:null}update(e){let t,r;e.htmlElement.style.display="",this.hideable&&e.hidden&&(e.htmlElement.style.display="none"),t=this.data.position&&"right"===this.data.position.horizontal?e.container[0]-e.htmlElement.offsetWidth:this.data.position&&"left"===this.data.position.horizontal?e.container[0]:e.container[0]-e.htmlElement.offsetWidth/2,r=this.data.position&&"bottom"===this.data.position.vertical?e.container[1]-e.htmlElement.offsetHeight:this.data.position&&"top"===this.data.position.vertical?e.container[1]:e.container[1]-e.htmlElement.offsetHeight/2,t/=e.scale[0],r/=e.scale[1],e.htmlElement.style.left=t+"px",e.htmlElement.style.top=r+"px"}}e.exports.HTMLElementAnchorData=m,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap;class g extends m{constructor(e){super({location:e.location,data:e.data,format:"text",hideable:e.hideable,viewers:e.viewers,intersectionTarget:e.intersectionTarget,id:e.id})}clone(){return new g({location:this.location,data:this.data,hideable:this.hideable,viewers:this.viewers,intersectionTarget:this.intersectionTarget,id:this.id})}create(e){var t;const r=document.createElement("span");r.style.display="none",r.style.userSelect="none",r.style.cursor="default",r.style.pointerEvents="none",r.style.color=null===(t=e.anchor.data.color)||void 0===t?void 0:t.toString(),r.innerHTML=e.anchor.data.text,r.style.display="block",r.style.textOverflow="clip",r.style.overflow="hidden",e.parent.appendChild(r),!e.anchor.data.textAlign||"right"!==e.anchor.data.textAlign&&"center"!==e.anchor.data.textAlign?r.style.textAlign="left":r.style.textAlign=e.anchor.data.textAlign}}e.exports.HTMLElementAnchorTextData=g;class v extends m{constructor(e){super({location:e.location,data:e.data,format:"image",hideable:e.hideable,viewers:e.viewers,intersectionTarget:e.intersectionTarget,id:e.id})}clone(){return new v({location:this.location,data:this.data,hideable:this.hideable,viewers:this.viewers,intersectionTarget:this.intersectionTarget,id:this.id})}create(e){const t=document.createElement("img");t.style.userSelect="none",t.style.cursor="default",t.style.pointerEvents="none",e.parent.appendChild(t),t.src=e.anchor.data.src,e.anchor.data.height&&(t.height=e.anchor.data.height),e.anchor.data.width&&(t.width=e.anchor.data.width),e.anchor.data.alt&&(t.alt=e.anchor.data.alt)}}e.exports.HTMLElementAnchorImageData=v;class _ extends m{constructor(e){super({location:e.location,data:e.data,format:"custom",hideable:e.hideable,viewers:e.viewers,intersectionTarget:e.intersectionTarget,id:e.id}),u.set(this,void 0),h.set(this,void 0),d(this,u,e.create,"f"),d(this,h,e.update,"f")}create(e){f(this,u,"f").call(this,e)}update(e){f(this,h,"f").call(this,e)}clone(){return new _({location:this.location,data:this.data,hideable:this.hideable,viewers:this.viewers,intersectionTarget:this.intersectionTarget,id:this.id,create:f(this,u,"f"),update:f(this,h,"f")})}}e.exports.HTMLElementAnchorCustomData=_,u=new WeakMap,h=new WeakMap})),s.register("ahMk5",(function(e,t){var r,i,n,o=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},a=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDTFAttributesData=e.exports.SDTFAttributeData=e.exports.GEOMETRYTYPEHINT=e.exports.PRIMITIVETYPEHINT=void 0;var l,c,u=s("eYU63");(l=e.exports.PRIMITIVETYPEHINT||(e.exports.PRIMITIVETYPEHINT={})).DOUBLE="double",l.COLOR="color",l.STRING="string",l.BOOL="bool",l.FLOAT="float",l.DECIMAL="decimal",l.CULTUREINFO="cultureinfo",l.INT="int",(c=e.exports.GEOMETRYTYPEHINT||(e.exports.GEOMETRYTYPEHINT={})).COMPLEX="geometry.complex",c.INTERVAL2="geometry.interval2",c.PATH="grasshopper.path",c.ARC="geometry.arc",c.BOUNDINGBOX="geometry.boundingbox",c.BOX="geometry.box",c.CIRCLE="geometry.circle",c.CONE="geometry.cone",c.CYLINDER="geometry.cylinder",c.ELLIPSE="geometry.ellipse",c.INTERVAL="geometry.interval",c.LINE="geometry.line",c.MATRIX="geometry.matrix",c.PLANE="geometry.plane",c.POINT2D="geometry.point2d",c.POINT2F="geometry.point2f",c.POINT3D="geometry.point3d",c.POINT3F="geometry.point3f",c.POINT4D="geometry.point4d",c.POLYLINE="geometry.polyline",c.RAY="geometry.ray",c.RECTANGLE="geometry.rectangle",c.SPHERE="geometry.sphere",c.TORUS="geometry.torus",c.TRANSFORM="geometry.transform",c.VECTOR2D="geometry.vector2d",c.VECTOR2F="geometry.vector2f",c.VECTOR3D="geometry.vector3d",c.VECTOR3F="geometry.vector3f";e.exports.SDTFAttributeData=class{constructor(e,t){r.set(this,void 0),i.set(this,void 0),o(this,r,e,"f"),o(this,i,t,"f")}get typeHint(){return a(this,r,"f")}get value(){return a(this,i,"f")}},r=new WeakMap,i=new WeakMap;class h extends u.AbstractTreeNodeData{constructor(e={},t){super(t),n.set(this,{}),o(this,n,e,"f")}get attributes(){return a(this,n,"f")}clone(){return new h(this.attributes,this.id)}}e.exports.SDTFAttributesData=h,n=new WeakMap})),s.register("esIXR",(function(e,t){var r,i,n,o=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},a=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDTFItemData=void 0;var l=s("eYU63");class c extends l.AbstractTreeNodeData{constructor(e,t,s,a){super(a),r.set(this,void 0),i.set(this,void 0),n.set(this,{}),o(this,n,s,"f"),o(this,r,e,"f"),o(this,i,t,"f")}get attributes(){return a(this,n,"f")}get typeHint(){return a(this,r,"f")}get value(){return a(this,i,"f")}clone(){return new c(this.typeHint,this.value,this.attributes,this.id)}}e.exports.SDTFItemData=c,r=new WeakMap,i=new WeakMap,n=new WeakMap})),s.register("3vDMM",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},n=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDTFAttributeOverview=void 0;var o=s("eYU63"),a=s("ahMk5");class l extends o.AbstractTreeNodeData{constructor(e,t){super(t),r.set(this,{}),i(this,r,e,"f")}get overview(){return n(this,r,"f")}clone(){return new l(n(this,r,"f"),this.id)}merge(e){var t;for(let r in e.overview)for(let i=0;i<e.overview[r].length;i++){const n=e.overview[r][i],s=this.overview[r]?this.overview[r].filter((e=>e.typeHint===n.typeHint)):[];if(this.overview[r]&&s.length>0){const e=s[0];e.count++,n.typeHint===a.PRIMITIVETYPEHINT.STRING&&(e.values=null===(t=e.values)||void 0===t?void 0:t.concat(n.values.filter((t=>e.values.indexOf(t)<0)))),n.typeHint!==a.PRIMITIVETYPEHINT.DOUBLE&&n.typeHint!==a.PRIMITIVETYPEHINT.FLOAT&&n.typeHint!==a.PRIMITIVETYPEHINT.DECIMAL&&n.typeHint!==a.PRIMITIVETYPEHINT.INT||(e.min=Math.min(n.min,e.min),e.max=Math.max(n.max,e.max))}else this.overview[r]?this.overview[r].push({typeHint:n.typeHint,count:n.count,values:n.values,min:n.min,max:n.max}):this.overview[r]=[{typeHint:n.typeHint,count:n.count,values:n.values,min:n.min,max:n.max}]}}}e.exports.SDTFAttributeOverview=l,r=new WeakMap})),s.register("lq1YW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDTFAttributeVisualization=e.exports.ATTRIBUTEVISUALIZATION=void 0;var r,i,n=s("3iqbd"),o=s("04FRV");(i=r=e.exports.ATTRIBUTEVISUALIZATION||(e.exports.ATTRIBUTEVISUALIZATION={})).GRAYSCALE="grayscale",i.OPACITY="opacity",i.BLUE_RED="blue_red",i.BLUE_WHITE_RED="blue_white_red",i.GREEN_RED="green_red",i.GREEN_WHITE_RED="green_white_red",i.BLUE_GREEN_RED="blue_green_red",i.BLUE_GREEN_YELLOW_RED_PURPLE_WHITE="blue_green_yellow_red_purple_white",i.HSL="hsl";const a=e=>{const t=Math.floor(255*e);return{material:new o.MaterialUnlitData({color:"rgb("+t+", "+t+", "+t+")",opacity:1}),matrix:n.create()}},l=(e,t)=>({material:new o.MaterialUnlitData({color:(null==t?void 0:t.color)||"#00fff7",opacity:e}),matrix:n.create()}),c=e=>{const t=255*e,r=255*(1-e);return{material:new o.MaterialUnlitData({color:"rgb("+Math.floor(t)+", "+Math.floor(0)+", "+Math.floor(r)+")",opacity:1}),matrix:n.create()}},u=e=>{let t=255,r=255,i=255;if(e<.5){const n=e/.5;t=255*n,r=255*n,i=255}else{const n=(e-.5)/.5;t=255,r=255*(1-n),i=255*(1-n)}return{material:new o.MaterialUnlitData({color:"rgb("+Math.floor(t)+", "+Math.floor(r)+", "+Math.floor(i)+")",opacity:1}),matrix:n.create()}},h=e=>{const t=255*e,r=255*(1-e);return{material:new o.MaterialUnlitData({color:"rgb("+Math.floor(t)+", "+Math.floor(r)+", "+Math.floor(0)+")",opacity:1}),matrix:n.create()}},d=e=>{let t=255,r=255,i=255;if(e<.5){const n=e/.5;t=255*n,r=255,i=255*n}else{const n=(e-.5)/.5;t=255,r=255*(1-n),i=255*(1-n)}return{material:new o.MaterialUnlitData({color:"rgb("+Math.floor(t)+", "+Math.floor(r)+", "+Math.floor(i)+")",opacity:1}),matrix:n.create()}},f=e=>{let t=255,r=255,i=255;if(e<.5){const n=e/.5;t=0,r=255*n,i=255*(1-n)}else{const n=(e-.5)/.5;t=255*n,r=255*(1-n),i=0}return{material:new o.MaterialUnlitData({color:"rgb("+Math.floor(t)+", "+Math.floor(r)+", "+Math.floor(i)+")",opacity:1}),matrix:n.create()}},p=e=>{let t=255,r=255,i=255;if(e<.2){const n=e/.2;t=0,r=255*n,i=255*(1-n)}else if(e<.4){t=255*((e-.2)/.2),r=255,i=0}else if(e<.6){t=255,r=255*(1-(e-.4)/.2),i=0}else if(e<.8){t=255,r=0,i=255*((e-.6)/.2)}else{t=255,r=255*((e-.8)/.2),i=255}return{material:new o.MaterialUnlitData({color:"rgb("+Math.floor(t)+", "+Math.floor(r)+", "+Math.floor(i)+")",opacity:1}),matrix:n.create()}},m=e=>{const t=359.99*e;return{material:new o.MaterialUnlitData({color:"hsl("+Math.floor(t)+", 100%, 50%)",opacity:1}),matrix:n.create()}};e.exports.SDTFAttributeVisualization={numberVisualization:(e,t,i,n,s)=>{let o=(e-t)/(i-t);switch(o=Math.min(1,Math.max(0,o)),n){case r.GRAYSCALE:return a(o);case r.OPACITY:return l(o,s);case r.BLUE_RED:return c(o);case r.BLUE_WHITE_RED:return u(o);case r.GREEN_RED:return h(o);case r.GREEN_WHITE_RED:return d(o);case r.BLUE_GREEN_RED:return f(o);case r.BLUE_GREEN_YELLOW_RED_PURPLE_WHITE:return p(o);case r.HSL:return m(o)}},stringVisualization:(e,t,i,n)=>{let s=t.indexOf(e)/(t.length-1);switch(s=Math.min(1,Math.max(0,s)),i){case r.GRAYSCALE:return a(s);case r.OPACITY:return l(s,n);case r.BLUE_RED:return c(s);case r.BLUE_WHITE_RED:return u(s);case r.GREEN_RED:return h(s);case r.GREEN_WHITE_RED:return d(s);case r.BLUE_GREEN_RED:return f(s);case r.BLUE_GREEN_YELLOW_RED_PURPLE_WHITE:return p(s);case r.HSL:return m(s)}}}})),s.register("04FRV",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialUnlitData=void 0;var r=s("chw7c");class i extends r.AbstractMaterialData{constructor(e,t){super(e,t)}clone(){return new i({alphaMap:this.alphaMap,alphaCutoff:this.alphaCutoff,alphaMode:this.alphaMode,aoMap:this.aoMap,aoMapIntensity:this.aoMapIntensity,bumpMap:this.bumpMap,bumpScale:this.bumpScale,color:this.color,emissiveMap:this.emissiveMap,emissiveness:this.emissiveness,shading:this.shading,map:this.map,name:this.name,normalMap:this.normalMap,normalScale:this.normalScale,opacity:this.opacity,side:this.side},this.id)}}e.exports.MaterialUnlitData=i})),s.register("7U4aP",(function(e,t){var r,i,n,o,a,l,c,u,h,d=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},f=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AnimationData=void 0;var p=s("eYU63"),m=s("3iqbd"),g=s("eIStk"),v=s("k1dpP");class _ extends p.AbstractTreeNodeData{constructor(e,t,s,f,p){super(p),r.set(this,!1),i.set(this,0),n.set(this,void 0),o.set(this,void 0),a.set(this,!1),l.set(this,void 0),c.set(this,!1),u.set(this,void 0),h.set(this,!0),d(this,o,e,"f"),d(this,u,t,"f"),d(this,l,s,"f"),d(this,n,f,"f")}get animate(){return f(this,r,"f")}get animationTime(){return f(this,i,"f")}set animationTime(e){d(this,i,e,"f")}get duration(){return f(this,n,"f")}get name(){return f(this,o,"f")}get repeat(){return f(this,a,"f")}set repeat(e){d(this,a,e,"f")}get reset(){return f(this,h,"f")}set reset(e){d(this,h,e,"f")}get start(){return f(this,l,"f")}get tracks(){return f(this,u,"f")}clone(){return new _(this.name,f(this,u,"f"),this.start,this.duration,this.id)}continueAnimation(){f(this,c,"f")&&d(this,r,!0,"f")}pauseAnimation(){f(this,c,"f")&&d(this,r,!1,"f")}startAnimation(){d(this,i,0,"f"),d(this,r,!0,"f"),d(this,c,!0,"f");for(let e=0;e<f(this,u,"f").length;e++){const t=f(this,u,"f")[e],r=t.node.transformations.find((e=>"gltf_matrix"===e.id));if(r)t.previousMatrix={id:r.id,matrix:m.clone(r.matrix)},r.matrix=m.create();else switch(t.path){case"scale":const e=t.node.transformations.find((e=>"gltf_matrix_scale"===e.id));if(e){t.previousMatrix={id:e.id,matrix:m.clone(e.matrix)};continue}break;case"rotation":const r=t.node.transformations.find((e=>"gltf_matrix_rotation"===e.id));if(r){t.previousMatrix={id:r.id,matrix:m.clone(r.matrix)};continue}break;case"translation":const i=t.node.transformations.find((e=>"gltf_matrix_translation"===e.id));if(i){t.previousMatrix={id:i.id,matrix:m.clone(i.matrix)};continue}}}}stopAnimation(){if(this.reset)for(let e=0;e<f(this,u,"f").length;e++){const t=f(this,u,"f")[e],r=this.id+"_"+e,i=t.node.transformations.filter((e=>e.id===r));if(t.node.transformations=t.node.transformations.filter((e=>!i.includes(e))),t.previousMatrix){if("gltf_matrix"===t.previousMatrix.id){t.node.transformations.find((e=>"gltf_matrix"===e.id)).matrix=t.previousMatrix.matrix;t.node.transformations.find((e=>"gltf_matrix_translation"===e.id)).matrix=m.create();t.node.transformations.find((e=>"gltf_matrix_rotation"===e.id)).matrix=m.create();t.node.transformations.find((e=>"gltf_matrix_scale"===e.id)).matrix=m.create();continue}switch(t.path){case"scale":t.node.transformations.find((e=>"gltf_matrix_scale"===e.id)).matrix=t.previousMatrix.matrix;continue;case"rotation":t.node.transformations.find((e=>"gltf_matrix_rotation"===e.id)).matrix=t.previousMatrix.matrix;continue;case"translation":t.node.transformations.find((e=>"gltf_matrix_translation"===e.id)).matrix=t.previousMatrix.matrix;continue}}}else for(let e=0;e<f(this,u,"f").length;e++){const t=f(this,u,"f")[e],r=this.id+"_"+e,i=t.node.transformations.filter((e=>e.id===r));t.node.transformations=t.node.transformations.filter((e=>!i.includes(e)));const n=t.times.length-1;let s=t.node.transformations.find((e=>"gltf_matrix_translation"===e.id));s||(s={id:"gltf_matrix_translation",matrix:m.create()},t.node.transformations.push(s));let o=t.node.transformations.find((e=>"gltf_matrix_rotation"===e.id));o||(o={id:"gltf_matrix_rotation",matrix:m.create()},t.node.transformations.push(o));let a=t.node.transformations.find((e=>"gltf_matrix_scale"===e.id));switch(a||(a={id:"gltf_matrix_scale",matrix:m.create()},t.node.transformations.push(a)),t.path){case"scale":let e=g.fromValues(t.values[3*n+0],t.values[3*n+1],t.values[3*n+2]);a.matrix=m.fromScaling(m.create(),e);continue;case"rotation":let r=v.fromValues(t.values[4*n+0],t.values[4*n+1],t.values[4*n+2],t.values[4*n+3]);o.matrix=m.fromQuat(m.create(),r);continue;case"translation":let i=g.fromValues(t.values[3*n+0],t.values[3*n+1],t.values[3*n+2]);s.matrix=m.fromTranslation(m.create(),i);continue}}d(this,i,-1,"f"),d(this,c,!1,"f"),d(this,r,!1,"f")}}e.exports.AnimationData=_,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap})),s.register("170bj",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TASKTYPE=void 0,(r=e.exports.TASKTYPE||(e.exports.TASKTYPE={})).AR_LOADING="ar_loading",r.ENVIRONMENT_MAP_LOADING="environment_map_loading",r.SESSION_CUSTOMIZATION="session_customization",r.SESSION_CREATION="session_creation",r.SESSION_INITIAL_OUTPUTS_LOADED="session_initial_outputs_loaded",r.SESSION_OUTPUTS_UPDATE="session_outputs_update",r.VIEWER_CREATION="viewer_creation",r.EXPORT_REQUEST="export_request"})),s.register("fcDWo",(function(e,t){var r,i,n,o=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},a=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialVariantsData=void 0;var l=s("eYU63");class c extends l.AbstractTreeNodeData{constructor(e){super(e),r.set(this,[]),i.set(this,[]),n.set(this,void 0)}get primitiveData(){return o(this,i,"f")}get variants(){return o(this,r,"f")}get variantIndex(){return o(this,n,"f")}set variantIndex(e){a(this,n,e,"f");for(let e=0;e<this.primitiveData.length;e++){const t=this.primitiveData[e].materialVariants.find((e=>e.variant===o(this,n,"f")));this.primitiveData[e].material=t?t.material:this.primitiveData[e].standardMaterial}}clone(){return new c(this.id)}}e.exports.MaterialVariantsData=c,r=new WeakMap,i=new WeakMap,n=new WeakMap})),s.register("jYmZR",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},m=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MapData=e.exports.TEXTURE_FILTERING=e.exports.TEXTURE_WRAPPING=void 0;var g,v,_,b,y=s("6BoVD");(v=g=e.exports.TEXTURE_WRAPPING||(e.exports.TEXTURE_WRAPPING={}))[v.REPEAT=10497]="REPEAT",v[v.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",v[v.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(b=_=e.exports.TEXTURE_FILTERING||(e.exports.TEXTURE_FILTERING={}))[b.NONE=0]="NONE",b[b.NEAREST=9728]="NEAREST",b[b.LINEAR=9729]="LINEAR",b[b.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",b[b.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",b[b.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",b[b.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR";class E{constructor(e,t=g.REPEAT,s=g.REPEAT,m=_.NONE,v=_.NONE,b=y.fromValues(0,0),E,w=y.fromValues(0,0),x=y.fromValues(1,1),A=0,T=!0){r.set(this,y.fromValues(0,0)),i.set(this,void 0),n.set(this,!0),o.set(this,void 0),a.set(this,_.NONE),l.set(this,_.NONE),c.set(this,y.fromValues(0,0)),u.set(this,y.fromValues(1,1)),h.set(this,0),d.set(this,g.REPEAT),f.set(this,g.REPEAT),p(this,o,e,"f"),p(this,d,t,"f"),p(this,f,s,"f"),p(this,l,m,"f"),p(this,a,v,"f"),p(this,r,b,"f"),p(this,i,E,"f"),p(this,c,w,"f"),p(this,u,x,"f"),p(this,h,A,"f"),p(this,n,T,"f")}get center(){return m(this,r,"f")}get color(){return m(this,i,"f")}get flipY(){return m(this,n,"f")}get image(){return m(this,o,"f")}get magFilter(){return m(this,a,"f")}get minFilter(){return m(this,l,"f")}get offset(){return m(this,c,"f")}get repeat(){return m(this,u,"f")}get rotation(){return m(this,h,"f")}get wrapS(){return m(this,d,"f")}get wrapT(){return m(this,f,"f")}clone(){return new E(this.image.cloneNode(),this.wrapS,this.wrapT,this.minFilter,this.magFilter,this.center,this.color,this.offset,this.repeat,this.rotation,this.flipY)}}e.exports.MapData=E,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap})),s.register("cf5Bo",(function(e,t){var r,i,n,o,a,l=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},c=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialSpecularGlossinessData=void 0;var u=s("chw7c");class h extends u.AbstractMaterialData{constructor(e,t){super(e,t),r.set(this,1),i.set(this,void 0),n.set(this,"#ffffff"),o.set(this,void 0),a.set(this,void 0),e&&(void 0!==e.glossiness&&(this.glossiness=e.glossiness),void 0!==e.specular&&(this.specular=e.specular),void 0!==e.specularGlossinessMap&&(this.specularGlossinessMap=e.specularGlossinessMap),void 0!==e.specularMap&&(this.specularMap=e.specularMap),void 0!==e.glossinessMap&&(this.glossinessMap=e.glossinessMap))}get glossiness(){return l(this,r,"f")}set glossiness(e){c(this,r,e,"f")}get glossinessMap(){return l(this,i,"f")}set glossinessMap(e){c(this,i,e,"f")}get specular(){return l(this,n,"f")}set specular(e){c(this,n,e,"f")}get specularGlossinessMap(){return l(this,o,"f")}set specularGlossinessMap(e){c(this,o,e,"f")}get specularMap(){return l(this,a,"f")}set specularMap(e){c(this,a,e,"f")}clone(){return new h({alphaMap:this.alphaMap,alphaCutoff:this.alphaCutoff,alphaMode:this.alphaMode,aoMap:this.aoMap,aoMapIntensity:this.aoMapIntensity,bumpMap:this.bumpMap,bumpScale:this.bumpScale,color:this.color,emissiveMap:this.emissiveMap,emissiveness:this.emissiveness,shading:this.shading,map:this.map,name:this.name,normalMap:this.normalMap,normalScale:this.normalScale,opacity:this.opacity,side:this.side,specular:this.specular,specularMap:this.specularMap,specularGlossinessMap:this.specularGlossinessMap,glossiness:this.glossiness,glossinessMap:this.glossinessMap},this.id)}}e.exports.MaterialSpecularGlossinessData=h,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap})),s.register("4Lh4G",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SceneTreeManager=void 0;const o=n(s("ilwiq"));var a=s("12eGO"),l=s("eYU63"),c=s("6UMiq"),u=s("cTTbu"),h=s("eAhLl"),d=s("eIStk"),f=s("3iqbd");s("yoicn");var p=s("bJEmL"),m=s("iBhyF"),g=s("hrRY8"),v=s("cUjyw"),_=s("g1ukU"),b=s("lS3vH"),y=s("dk8Lz");e.exports.SceneTreeManager=class{constructor(e){this._renderingEngine=e,this._converter=p.instance.resolve(u.Converter),this._eventEngine=p.instance.resolve(u.EventEngine),this._inputValidator=p.instance.resolve(u.InputValidator),this._logger=p.instance.resolve(u.Logger),this._scene=new o.Scene,this._stateEngine=p.instance.resolve(u.StateEngine),this._tree=p.instance.resolve(l.Tree),this._boundingBox=new c.Box,this._boundingBoxSensitiveData=[],this._scene.background=new o.Color("#ffffff")}get boundingBox(){return this._boundingBox}get scene(){return this._scene}init(){}isEmpty(){return 0===this._boundingBox.min[0]&&0===this._boundingBox.min[1]&&0===this._boundingBox.min[2]&&0===this._boundingBox.max[0]&&0===this._boundingBox.max[1]&&0===this._boundingBox.max[2]||this._boundingBox.isEmpty()}getBone(e){let t;return this._mainNode.traverse((r=>{r.SDid===e.id&&(t=r)})),t}updateData(e,t,r){let i=t.children.find((e=>e.SDid===r.id&&e.SDversion===r.version));switch(i||(i=new _.SDData(r.id,r.version)),t.add(i),this._renderingEngine.type===m.RENDERERTYPE.ATTRIBUTES&&this.injectAttributeData(e,r),!0){case r instanceof a.GeometryData:i.SDtype=_.SD_DATA_TYPE.GEOMETRY;const t=r;let n;if(t.bones.length>0){const e=[];for(let r=0;r<t.bones.length;r++)e.push(this.getBone(t.bones[r]));const r=[];for(let e=0;e<t.boneInverses.length;e++)r.push((new o.Matrix4).fromArray(t.boneInverses[e]));n=new o.Skeleton(e,r)}const s=this._renderingEngine.geometryLoader.load(r,i,n);e.boundingBox.union(s);break;case r instanceof v.ThreejsData:i.SDtype=_.SD_DATA_TYPE.THREEJS,i.add(r.obj);break;case r instanceof a.AbstractMaterialData:i.SDtype=_.SD_DATA_TYPE.MATERIAL;break;case r instanceof h.AbstractLight:i.SDtype=_.SD_DATA_TYPE.LIGHT,this._renderingEngine.lightLoader.load(r,i),r instanceof h.DirectionalLight&&!1===r.useNodeData&&this._boundingBoxSensitiveData.push({data:r,dataChild:i});break;case r instanceof y.AbstractCamera:i.SDtype=_.SD_DATA_TYPE.CAMERA,this._renderingEngine.cameraManager.load(r,i);break;case r instanceof a.HTMLElementAnchorData:i.SDtype=_.SD_DATA_TYPE.HTML_ELEMENT_ANCHOR,this._renderingEngine.htmlElementAnchorLoader.load(r);break;case r instanceof a.AnimationData:i.SDtype=_.SD_DATA_TYPE.ANIMATION}}updateNodeTransformations(e=this._tree.root,t=this._mainNode){if(e&&t&&!e.excludeViewers.includes(this._renderingEngine.id)){t.visible=e.visible,t.applyTransformation(e.nodeMatrix);for(let r=0,i=e.children.length;r<i;r++){const i=e.children[r];if(!i)continue;const n=t.children.find((e=>e.SDid===i.id));this.updateNodeTransformations(i,n)}}}updateMorphWeights(e=this._tree.root,t=this._mainNode){if(e&&t&&!e.excludeViewers.includes(this._renderingEngine.id)){for(let r=0,i=e.data.length;r<i;r++)if(e.data[r]instanceof a.GeometryData){const i=e.data[r];t.children.find((e=>e.SDid===i.id&&e.SDversion===i.version)).traverse((e=>{(e instanceof o.Points||e instanceof o.LineSegments||e instanceof o.LineLoop||e instanceof o.Line||e instanceof o.Mesh)&&(e.morphTargetInfluences=i.morphWeights)}))}for(let r=0,i=e.children.length;r<i;r++){const i=e.children[r];if(!i)continue;const n=t.children.find((e=>e.SDid===i.id));this.updateMorphWeights(i,n)}}}updateNodeData(e,t){const r=t;if(e.excludeViewers.includes(this._renderingEngine.id))return;e.boundingBox=new c.Box;const i=e.data.map((e=>e.id));r.children.filter((e=>e instanceof _.SDData&&!i.includes(e.SDid))).forEach((e=>{this.removeData(e),r.remove(e)}));const n=e.children.map((e=>e.id));r.children.filter((e=>e instanceof g.SDNode&&!n.includes(e.SDid))).forEach((e=>{e.traverse((e=>{e instanceof _.SDData&&this.removeData(e)})),r.remove(e)}));for(let t=0,i=e.data.length;t<i;t++)this.updateData(e,r,e.data[t]);for(let t=0,i=e.children.length;t<i;t++){const i=e.children[t],n=r.children.find((e=>e.SDid===i.id));this.updateNodeData(i,n),i.boundingBox.isEmpty()||e.boundingBox.union(i.boundingBox)}e.boundingBox.isEmpty()||e.boundingBox.applyMatrix(e.nodeMatrix)}updateNodeHierarchy(e=this._tree.root,t=this._mainNode){const r=t;if(!e.excludeViewers.includes(this._renderingEngine.id)){for(let t=0,i=e.children.length;t<i;t++){const i=e.children[t],n=r.children.find((e=>e.SDid===i.id));if(n)n.SDversion!==i.version&&(this.updateNodeHierarchy(i,n),n.SDversion=i.version);else{const t=e.bone?new b.SDBone(i.id,i.version):new g.SDNode(i.id,i.version);i.transformedNodes[this._renderingEngine.id]=t,r.add(t),this.updateNodeHierarchy(i,t)}}r.visible=e.visible,r.applyTransformation(e.nodeMatrix)}}updateNode(e,t){const r=t;if(e.excludeViewers.includes(this._renderingEngine.id))return;e.boundingBox=new c.Box;const i=e.data.map((e=>e.id));r.children.filter((e=>e instanceof _.SDData&&!i.includes(e.SDid))).forEach((e=>{this.removeData(e),r.remove(e)}));const n=e.children.map((e=>e.id));r.children.filter((e=>e instanceof g.SDNode&&!n.includes(e.SDid))).forEach((e=>{e.traverse((e=>{e instanceof _.SDData&&this.removeData(e)})),r.remove(e)}));for(let t=0,i=e.data.length;t<i;t++)this.updateData(e,r,e.data[t]);for(let t=0,i=e.children.length;t<i;t++){const i=e.children[t],n=r.children.find((e=>e.SDid===i.id));if(n)n.SDversion!==i.version&&(this.updateNode(i,n),n.SDversion=i.version);else{const e=new g.SDNode(i.id,i.version);i.transformedNodes[this._renderingEngine.id]=e,r.add(e),this.updateNode(i,e)}i.boundingBox.isEmpty()||e.boundingBox.union(i.boundingBox)}r.visible=e.visible,r.applyTransformation(e.nodeMatrix),e.boundingBox.isEmpty()||e.boundingBox.applyMatrix(e.nodeMatrix)}updateSceneTree(e,t){const r=this._boundingBox.clone();this._boundingBox=new c.Box,this._renderingEngine.lightLoader.shadowMapCount=0,this._mainNode||(this._mainNode=new g.SDNode(e.id,e.version),e.transformedNodes[this._renderingEngine.id]=this._mainNode,this._scene.add(this._mainNode)),this._boundingBoxSensitiveData=[],this._currentSDTFOverview=this.createSDTFOverview(),this.updateNodeHierarchy(e,this._mainNode),this.updateNodeData(e,this._mainNode),this._boundingBox=e.boundingBox.clone();for(let e=0;e<this._boundingBoxSensitiveData.length;e++)this._renderingEngine.lightLoader.adjustToBoundingBox(this._boundingBoxSensitiveData[e].data,this._boundingBoxSensitiveData[e].dataChild,this._boundingBox);this._boundingBox.isEmpty()||this._boundingBox.applyMatrix(e.nodeMatrix),this._boundingBox.min[0]===r.min[0]&&this._boundingBox.min[1]===r.min[1]&&this._boundingBox.min[2]===r.min[2]&&this._boundingBox.max[0]===r.max[0]&&this._boundingBox.max[1]===r.max[1]&&this._boundingBox.max[2]===r.max[2]||this._boundingBox.isEmpty()||(this._stateEngine.boundingBoxCreated.resolved||this._stateEngine.boundingBoxCreated.resolve(!0),this._eventEngine.emitEvent(u.EVENTTYPE.SCENE.SCENE_BOUNDING_BOX_CHANGE,{viewerId:this._renderingEngine.id,boundingBox:{min:d.clone(this._boundingBox.min),max:d.clone(this._boundingBox.max)}})),this._renderingEngine.renderingManager.evaluateTextureUnitCount(this._renderingEngine.lightLoader.shadowMapCount+this._renderingEngine.materialLoader.maxMapCount)}collectSDTFItemData(e){for(let t=0,r=e.data.length;t<r;t++)if(e.data[t]instanceof a.SDTFItemData)return e.data[t];if(e.parent)return this.collectSDTFItemData(e.parent)}createSDTFOverview(e=this._tree.root){const t=new a.SDTFAttributeOverview({});for(let r=0,i=e.data.length;r<i;r++)e.data[r]instanceof a.SDTFAttributeOverview&&t.merge(e.data[r]);for(let r=0,i=e.children.length;r<i;r++)t.merge(new a.SDTFAttributeOverview(this.createSDTFOverview(e.children[r])));return t.overview}injectAttributeData(e,t){const r=this.collectSDTFItemData(e);let i={material:new a.MaterialStandardData({color:"#00fff7",opacity:1}),matrix:f.create()};if(this._renderingEngine.convertSDTFItemToVisualizationData){const e=this._renderingEngine.convertSDTFItemToVisualizationData(this._currentSDTFOverview,r);try{this._inputValidator.validateAndError(u.LOGGINGTOPIC.VIEWER,"Viewer.convertSDTFItemToVisualizationData",e,"object",!0),this._inputValidator.validateAndError(u.LOGGINGTOPIC.VIEWER,"Viewer.convertSDTFItemToVisualizationData",e.matrix,"mat4",!0),i.material=e.material,i.matrix=i.matrix}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw this._logger.handleError(u.LOGGINGTOPIC.VIEWER,"Viewer.convertSDTFItemToVisualizationData: Encountered an error while parsing the visualization data.",e)}}e.transformations.push({id:"sdtf",matrix:i.matrix}),t instanceof a.GeometryData&&(t.primitive.attributeMaterial=i.material)}removeData(e){switch(!0){case e.SDtype===_.SD_DATA_TYPE.GEOMETRY:e.traverse((e=>{var t,r,i,n,s,a,l,c,u,h;if(e instanceof _.SDData&&e instanceof o.Mesh){this._renderingEngine.geometryLoader.removeFromGeometryCache(e.geometry.userData.SDid+"_"+e.geometry.userData.SDversion),this._renderingEngine.materialLoader.removeFromMaterialCache(e.material.userData.SDid+"_"+e.material.userData.SDversion);for(const t in e.geometry.attributes)e.geometry.deleteAttribute(t);e.geometry.setIndex(null),e.geometry.dispose(),e.material.alphaMap&&(null===(t=e.material.alphaMap)||void 0===t||t.dispose()),e.material.aoMap&&(null===(r=e.material.aoMap)||void 0===r||r.dispose()),e.material.bumpMap&&(null===(i=e.material.bumpMap)||void 0===i||i.dispose()),e.material.map&&(null===(n=e.material.map)||void 0===n||n.dispose()),e.material.emissiveMap&&(null===(s=e.material.emissiveMap)||void 0===s||s.dispose()),e.material.metalnessMap&&(null===(a=e.material.metalnessMap)||void 0===a||a.dispose()),e.material.roughnessMap&&(null===(l=e.material.roughnessMap)||void 0===l||l.dispose()),e.material.normalMap&&(null===(c=e.material.normalMap)||void 0===c||c.dispose()),e.material.specularMap&&(null===(u=e.material.specularMap)||void 0===u||u.dispose()),e.material.glossinessMap&&(null===(h=e.material.glossinessMap)||void 0===h||h.dispose()),e.material.dispose()}}));break;case e.SDtype===_.SD_DATA_TYPE.THREEJS:case e.SDtype===_.SD_DATA_TYPE.MATERIAL:case e.SDtype===_.SD_DATA_TYPE.LIGHT:break;case e.SDtype===_.SD_DATA_TYPE.HTML_ELEMENT_ANCHOR:this._renderingEngine.htmlElementAnchorLoader.removeData(e.SDid,e.SDversion);case e.SDtype===_.SD_DATA_TYPE.ANIMATION:}}}})),s.register("hrRY8",(function(e,t){var r,i,n=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),o=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDNode=void 0;const u=a(s("ilwiq"));class h extends u.Object3D{constructor(e,t){super(),r.set(this,void 0),i.set(this,void 0),l(this,r,e,"f"),l(this,i,t,"f")}applyTransformation(e){this.matrix.identity(),this.matrixWorld.identity(),this.position.set(0,0,0),this.scale.set(1,1,1),this.quaternion.set(0,0,0,1),this.applyMatrix4((new u.Matrix4).fromArray(e))}get SDid(){return c(this,r,"f")}set SDid(e){l(this,r,e,"f")}get SDversion(){return c(this,i,"f")}set SDversion(e){l(this,i,e,"f")}}e.exports.SDNode=h,r=new WeakMap,i=new WeakMap})),s.register("cUjyw",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},n=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ThreejsData=void 0;var o=s("eYU63");class a extends o.AbstractTreeNodeData{constructor(e,t){super(t),r.set(this,void 0),i(this,r,e,"f")}get obj(){return n(this,r,"f")}set obj(e){i(this,r,e,"f")}clone(){return new a(this.obj.clone(),this.id)}}e.exports.ThreejsData=a,r=new WeakMap})),s.register("g1ukU",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},n=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDData=e.exports.SD_DATA_TYPE=void 0;var o,a,l=s("hrRY8");(a=o=e.exports.SD_DATA_TYPE||(e.exports.SD_DATA_TYPE={})).GEOMETRY="geometry",a.MATERIAL="material",a.THREEJS="threejs",a.LIGHT="light",a.CAMERA="camera",a.ANIMATION="animation",a.INTERACTION="interaction",a.HTML_ELEMENT_ANCHOR="html_element_anchor",a.CUSTOM="custom";class c extends l.SDNode{constructor(e,t){super(e,t),r.set(this,o.CUSTOM)}get SDtype(){return i(this,r,"f")}set SDtype(e){n(this,r,e,"f")}}e.exports.SDData=c,r=new WeakMap})),s.register("lS3vH",(function(e,t){var r,i,n=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),o=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDBone=void 0;const u=a(s("ilwiq"));class h extends u.Bone{constructor(e,t){super(),r.set(this,void 0),i.set(this,void 0),l(this,r,e,"f"),l(this,i,t,"f")}applyTransformation(e){this.matrix.identity(),this.matrixWorld.identity(),this.position.set(0,0,0),this.scale.set(1,1,1),this.quaternion.set(0,0,0,1),this.applyMatrix4((new u.Matrix4).fromArray(e))}get SDid(){return c(this,r,"f")}set SDid(e){l(this,r,e,"f")}get SDversion(){return c(this,i,"f")}set SDversion(e){l(this,i,e,"f")}}e.exports.SDBone=h,r=new WeakMap,i=new WeakMap})),s.register("cr4ix",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RenderingManager=void 0;const o=n(s("8PNKb")),a=n(s("c8CJQ")),l=n(s("ilwiq"));var c=s("dk8Lz"),u=s("cTTbu"),h=s("3iqbd");s("yoicn");var d=s("bJEmL"),f=s("iBhyF");e.exports.RenderingManager=class{constructor(e){this._renderingEngine=e,this._converter=d.instance.resolve(u.Converter),this._eventEngine=d.instance.resolve(u.EventEngine),this._logger=d.instance.resolve(u.Logger),this._stateEngine=d.instance.resolve(u.StateEngine),this._systemInfo=d.instance.resolve(u.SystemInfo),this._activeRendering=!0,this._cameraChanged=!1,this._continuousRendering=!1,this._continuousShadowMapUpdate=!1,this._height=0,this._lastCameraMatrix=h.create(),this._lastSize={adjustedWidth:0,adjustedHeight:0,width:0,height:0},this._lastTime=0,this._maxTextureUnits=0,this._minimalRendering=!1,this._noWebGL=!1,this._runningAnimation=!1,this._sizeChanged=!1,this._usingSwiftShader=!1,this._width=0}get continuousRendering(){return this._continuousRendering}set continuousRendering(e){this._continuousRendering=e}get continuousShadowMapUpdate(){return this._continuousShadowMapUpdate}set continuousShadowMapUpdate(e){this._continuousShadowMapUpdate=e}get minimalRendering(){return this._minimalRendering}get usingSwiftShader(){return this._usingSwiftShader}addLogo(e,t){var r,i;const n=document.createElement("div");if(n.style.backgroundColor=t.backgroundColor,n.style.position="relative",n.style.height="100%",n.style.width="100%",null===(r=e.parentElement)||void 0===r||r.insertBefore(n,null===(i=e.parentElement)||void 0===i?void 0:i.firstChild),t.logo){const e=new Image;e.style.position="absolute",e.style.top="50%",e.style.left="50%",e.style.transform="translateX(-50%) translateY(-50%)",e.src=t.logo,n.appendChild(e)}return n}createRenderer(e){const t={alpha:!0,depth:!0,antialias:!0,preserveDrawingBuffer:!0,canvas:e},r=this.createWebGLContext(t),i=new l.WebGLRenderer(Object.assign({context:r},t));return i.setPixelRatio(window.devicePixelRatio),i.physicallyCorrectLights=!1,i.outputEncoding=l.sRGBEncoding,i.toneMapping=l.NoToneMapping,i.shadowMap.enabled=!0,i.shadowMap.needsUpdate=!0,i.shadowMap.type=l.PCFSoftShadowMap,i.shadowMap.autoUpdate=!1,i.setSize(e.width,e.height),i.setClearColor(new l.Color("#ffffff"),1),this._maxTextureUnits=i.getContext().getParameter(i.getContext().MAX_TEXTURE_IMAGE_UNITS),i}evaluateTextureUnitCount(e){e>this._maxTextureUnits?(this._logger.warn(u.LOGGINGTOPIC.VIEWER,"RenderingManager.evaluateTextureUnitCount: Maximum number of texture units exceeded. Disabling shadows."),this._renderingEngine.lightLoader.forceDisabledShadows=!0,this._renderingEngine.update()):this._renderingEngine.lightLoader.forceDisabledShadows=!1}getScreenshot(e="image/png",t=1){return this._renderingEngine.renderer.domElement.toDataURL(e,t)}init(){try{this._eventEngine.addListener(u.EVENTTYPE.CAMERA.CAMERA_START,(e=>{e.viewerId===this._renderingEngine.id&&this.startRendering()})),this._eventEngine.addListener(u.EVENTTYPE.CAMERA.CAMERA_END,(e=>{e.viewerId===this._renderingEngine.id&&this.stopRendering()})),window.onresize=()=>{this.render()},this._renderingEngine.canvas.onresize=()=>{this.render()},this._renderingEngine.canvas.parentElement.onresize=()=>{this.render()};const e=new a.default;e.showPanel(0),e.dom.style.cssText="position:absolute;top:0px;left:0px;display:none;",this._renderingEngine.canvas.parentElement.appendChild(e.dom);const t=new a.default;t.showPanel(1),t.dom.style.cssText="position:absolute;top:0px;left:80px;display:none;",this._renderingEngine.canvas.parentElement.appendChild(t.dom);const r=new a.default;r.showPanel(2),r.dom.style.cssText="position:absolute;top:0px;left:160px;display:none;",this._renderingEngine.canvas.parentElement.appendChild(r.dom),this._stats={stats:[e,t,r],begin:()=>{e.begin(),t.begin(),r.begin()},end:()=>{e.end(),t.end(),r.end()}}}catch(e){throw this._noWebGL=!0,e}}render(){this.startAndStopRendering()}resize(e,t){this._width=e,this._height=t}start(){this.animate(0),this.startAndStopRendering()}updateShadowMap(){this._renderingEngine.renderer.shadowMap.needsUpdate=!0}animate(e){if(this._renderingEngine.closed||this._noWebGL)return;requestAnimationFrame((e=>this.animate(e))),o.update(e);const t=e-this._lastTime<0?0:e-this._lastTime;this._lastTime=e;const r=this._renderingEngine.animationManager.update(t);r!==this._runningAnimation&&this.render(),this._runningAnimation=r,this._runningAnimation&&this._renderingEngine.sceneTreeManager.updateNodeTransformations(),this._runningAnimation&&this._renderingEngine.sceneTreeManager.updateMorphWeights();const{width:i,height:n,adjustedWidth:s,adjustedHeight:a}=this.calculateSize(),c=i/n;this._sizeChanged=this._lastSize.adjustedHeight!==a||this._lastSize.adjustedWidth!==s||this._lastSize.height!==n||this._lastSize.width!==i,this._lastSize={width:i,height:n,adjustedWidth:s,adjustedHeight:a},this._cameraChanged=!!this._renderingEngine.cameraEngine.camera&&this._renderingEngine.cameraManager.updateCamera(t,c);const h=this.evaluateRenderingState();if(!1===h.showScene)return void this.toggleLogo(!0);if(this.toggleLogo(!1),!1===h.rendering)return;this._stats.begin(),this.showStatistics(),this.toggleBlur(h.blurScene),this._renderingEngine.renderer.setSize(s,a),this._renderingEngine.renderer.domElement.style.width=i+"px",this._renderingEngine.renderer.domElement.style.height=n+"px",this._renderingEngine.materialLoader.assignPointSize(this._renderingEngine.pointSize);const d=this._renderingEngine.cameraManager.adjustCamera(c);this._renderingEngine.htmlElementAnchorLoader.adjustPositions(s/i,a/n);const p=this._renderingEngine.renderer.shadowMap.enabled;this._renderingEngine.renderer.shadowMap.enabled=!this._renderingEngine.usingSwiftShader&&this._renderingEngine.type!==f.RENDERERTYPE.ATTRIBUTES&&this._renderingEngine.shadows,p!==this._renderingEngine.renderer.shadowMap.enabled&&this._renderingEngine.materialLoader.updateMaterials(),h.updateShadowMap&&this._renderingEngine.renderer.shadowMap.enabled&&(this._renderingEngine.renderer.shadowMap.needsUpdate=!0),this._renderingEngine.sceneTreeManager.scene.background=this._renderingEngine.environmentMapAsBackground?this._renderingEngine.environmentMapLoader.environmentMap:null,this._renderingEngine.renderer.setClearColor(new l.Color(this._converter.toThreeJsColorInput(this._renderingEngine.clearColor)),this._renderingEngine.clearAlpha),!0===h.beautyRendering?(this._renderingEngine.beautyRenderingManager.render(t,d,i,n),this._renderingEngine.beautyRenderingManager.beautyRenderingDurationActive>=this._renderingEngine.beautyRenderBlendingDuration?(this._eventEngine.emitEvent(u.EVENTTYPE.RENDERING.BEAUTY_RENDERING_FINISHED,{viewerId:this._renderingEngine.id}),this._renderingEngine.beautyRenderingManager.deactivateBeautyRenderShaders(),this._activeRendering=!1):this._renderingEngine.beautyRenderingManager.beautyRenderingDurationActive+=t):(this._renderingEngine.renderer.render(this._renderingEngine.sceneTreeManager.scene,d),this._renderingEngine.beautyRenderingManager.beautyRenderingActive&&(this._eventEngine.emitEvent(u.EVENTTYPE.RENDERING.BEAUTY_RENDERING_FINISHED,{viewerId:this._renderingEngine.id}),this._renderingEngine.beautyRenderingManager.deactivateBeautyRenderShaders(),this._activeRendering=!1)),this._stats.end()}calculateSize(){let e=this._width,t=this._height;this._renderingEngine.automaticResizing&&(e=this._renderingEngine.canvas.parentNode.clientWidth,t=this._renderingEngine.canvas.parentNode.clientHeight);const r=e/t;let i=e,n=t;return(e>1920||t>1080)&&((e-1920)/r>t-1080?(i=1920,n=1920/r):(i=1080*r,n=1080)),{width:e,adjustedWidth:i,height:t,adjustedHeight:n}}createWebGLContext(e){try{let t=e.canvas;t.addEventListener("webglcontextlost",(()=>{}),!1),t.addEventListener("webglcontextrestored",(()=>{}),!1);const r=Object.assign({stencil:!0,premultipliedAlpha:!0,powerPreference:"default"},e);let i=t.getContext("webgl2",r)||t.getContext("webgl",r)||t.getContext("experimental-webgl",r);if(null===i){if(i=t.getContext("webgl2",r)||t.getContext("webgl",r)||t.getContext("experimental-webgl",r),null===i){const e=new u.ShapeDiverViewerWebGLError("RenderingLogic.createWebGLContext: We were unable to get a WebGL context.");throw this._logger.handleError(u.LOGGINGTOPIC.VIEWER,"RenderingLogic.createWebGLContext",e,!1)}this._logger.warn(u.LOGGINGTOPIC.VIEWER,"RenderingLogic.createWebGLContext: We were unable to get a WebGL context using the requested attributes, falling back to default attributes.")}void 0===i.getShaderPrecisionFormat&&(i.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});const n=i.getExtension("WEBGL_debug_renderer_info");if(n){i.getParameter(n.UNMASKED_VENDOR_WEBGL);"Google SwiftShader"===i.getParameter(n.UNMASKED_RENDERER_WEBGL)&&(this._usingSwiftShader=!0,this._logger.warn(u.LOGGINGTOPIC.VIEWER,"RenderingLogic.createWebGLContext: The current device is using Google SwiftShader, a CPU-based renderer. To achieve better rendering results, please enable GPU-rendering in your settings."))}return i.getExtension("EXT_shader_texture_lod")||(this._minimalRendering=!0),i}catch(e){const t=new u.ShapeDiverViewerWebGLError("RenderingLogic.createWebGLContext: We were unable to get a WebGL context.",e);throw this._logger.handleError(u.LOGGINGTOPIC.VIEWER,"RenderingLogic.createWebGLContext",t,!1)}}evaluateRenderingState(){let e=!1;this._renderingEngine.cameraEngine.camera&&!0===this._renderingEngine.show&&(e=!0);let t=!1;!0!==this._activeRendering&&!0!==this._cameraChanged&&!0!==this._sizeChanged&&!0!==this._runningAnimation&&!0!==this._continuousRendering||(t=!0);let r=!1;if(!0!==this._runningAnimation&&!0!==this._continuousShadowMapUpdate||(r=!0),this._renderingEngine.cameraEngine.camera){const t=this._renderingEngine.cameraEngine.camera;if(t.type===c.CAMERATYPE.PERSPECTIVE){const i=t.controls;if(!0===i.enableAutoRotation&&0!==i.autoRotationSpeed)return{showScene:e,rendering:!0,updateShadowMap:r,blurScene:!1,beautyRendering:!1}}}else t=!1;let i=!1;(this._renderingEngine.blurSceneWhenBusy&&this._renderingEngine.busy||this._renderingEngine.blur)&&(i=!0);let n=!1;return!0===this._renderingEngine.beautyRenderingManager.beautyRenderingActive&&!1===i&&(this._renderingEngine.shadows||this._renderingEngine.ambientOcclusion&&this._renderingEngine.ambientOcclusionIntensity>0&&!this._systemInfo.isIOS)&&!1===this._renderingEngine.usingSwiftShader&&!1===this._runningAnimation&&this._renderingEngine.type!==f.RENDERERTYPE.ATTRIBUTES&&(n=!0),{showScene:e,rendering:t,updateShadowMap:r,blurScene:i,beautyRendering:n}}showStatistics(){if(this._renderingEngine.showStatistics)for(let e=0;e<this._stats.stats.length;e++)this._stats.stats[e].dom.style.display="";else for(let e=0;e<this._stats.stats.length;e++)this._stats.stats[e].dom.style.display="none"}startAndStopRendering(){this._activeRendering=!0,this._renderingEngine.beautyRenderingManager.stopBeautyRenderCountdown(),this._renderingEngine.beautyRenderingManager.startBeautyRenderCountdown()}startRendering(){this._activeRendering=!0,this._renderingEngine.beautyRenderingManager.stopBeautyRenderCountdown()}stopRendering(){this._renderingEngine.beautyRenderingManager.startBeautyRenderCountdown()}toggleBlur(e){if(this._renderingEngine.htmlElementAnchorLoader.toggleBlur(e),e){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&navigator.userAgent.toLowerCase().indexOf("android")>-1)return;this._renderingEngine.renderer.domElement.style.filter="blur(3px)"}else this._renderingEngine.renderer.domElement.style.filter=""}toggleLogo(e){this._renderingEngine.logoDivElement&&(this._renderingEngine.logoDivElement.style.display=e?"inherit":"none"),this._renderingEngine.canvas&&(this._renderingEngine.canvas.style.display=e?"none":"inherit")}}})),s.register("c8CJQ",(function(e,t){var r;e.exports,e.exports=(r=function(){function e(e){return n.appendChild(e.dom),e}function t(e){for(var t=0;t<n.children.length;t++)n.children[t].style.display=t===e?"block":"none";i=e}var i=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(e){e.preventDefault(),t(++i%n.children.length)}),!1);var s=(performance||Date).now(),o=s,a=0,l=e(new r.Panel("FPS","#0ff","#002")),c=e(new r.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=e(new r.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:n,addPanel:e,showPanel:t,begin:function(){s=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(c.update(e-s,200),e>o+1e3&&(l.update(1e3*a/(e-o),100),o=e,a=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){s=this.end()},domElement:n,setMode:t}},r.Panel=function(e,t,r){var i=1/0,n=0,s=Math.round,o=s(window.devicePixelRatio||1),a=80*o,l=48*o,c=3*o,u=2*o,h=3*o,d=15*o,f=74*o,p=30*o,m=document.createElement("canvas");m.width=a,m.height=l,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*o+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=r,g.fillRect(0,0,a,l),g.fillStyle=t,g.fillText(e,c,u),g.fillRect(h,d,f,p),g.fillStyle=r,g.globalAlpha=.9,g.fillRect(h,d,f,p),{dom:m,update:function(l,v){i=Math.min(i,l),n=Math.max(n,l),g.fillStyle=r,g.globalAlpha=1,g.fillRect(0,0,a,d),g.fillStyle=t,g.fillText(s(l)+" "+e+" ("+s(i)+"-"+s(n)+")",c,u),g.drawImage(m,h+o,d,f-o,p,h,d,f-o,p),g.fillRect(h+f-o,d,o,p),g.fillStyle=r,g.globalAlpha=.9,g.fillRect(h+f-o,d,o,s((1-l/v)*p))}}},r)})),s.register("gEWC5",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialLoader=e.exports.MATERIAL_TYPE=void 0;const o=n(s("ilwiq"));var a=s("12eGO"),l=s("2VtbH"),c=s("4Haor"),u=s("cTTbu");s("yoicn");var h,d,f=s("bJEmL"),p=s("gsATb");(d=h=e.exports.MATERIAL_TYPE||(e.exports.MATERIAL_TYPE={})).POINT="point",d.LINE="line",d.MESH="mesh";e.exports.MaterialLoader=class{constructor(e){this._renderingEngine=e,this._converter=f.instance.resolve(u.Converter),this._defaultColor="#00fff7",this._logger=f.instance.resolve(u.Logger),this._materialCache={},this._blending=0,this._envMap=null,this._height=1020,this._lightSizeUV=.025,this._pointSize=1,this._textureEncoding=o.sRGBEncoding,this._maxMapCount=0,this._envMapType=p.ENVIRONMENT_MAP_TYPE.NONE;let t=o.ShaderChunk.shadowmap_pars_fragment;if(t.includes("PCSS implementation")||(t=t.replace("#ifdef USE_SHADOWMAP","#ifdef USE_SHADOWMAP"+l.main),t=t.replace(t.substr(t.indexOf("#if defined( SHADOWMAP_TYPE_PCF )"),t.indexOf("#elif defined( SHADOWMAP_TYPE_PCF_SOFT )")-t.indexOf("#if defined( SHADOWMAP_TYPE_PCF )")),"#if defined( SHADOWMAP_TYPE_PCF )\n"+l.entry)),o.ShaderChunk.shadowmap_pars_fragment=t,o.ShaderChunk.envmap_fragment=o.ShaderChunk.envmap_fragment.replace("vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );","\n            #ifdef ENVMAP_TYPE_LDR\n                vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n            #else\n                vec4 envColor = textureCubeUV( envMap, reflectVec.xzy, 0.0 );\n            #endif\n            "),o.ShaderChunk.envmap_physical_pars_fragment=o.ShaderChunk.envmap_physical_pars_fragment.replace("vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );","\n            #ifdef ENVMAP_TYPE_LDR\n                vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n            #else\n                vec4 envMapColor = textureCubeLodEXT( envMap, queryVec.xzy, float( maxMIPLevel ) );\n            #endif"),o.ShaderChunk.envmap_physical_pars_fragment=o.ShaderChunk.envmap_physical_pars_fragment.replace("vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );","\n            #ifdef ENVMAP_TYPE_LDR\n                vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n            #else\n                vec4 envMapColor = textureCube( envMap, queryVec.xzy, float( maxMIPLevel ) );\n            #endif"),o.ShaderChunk.envmap_physical_pars_fragment=o.ShaderChunk.envmap_physical_pars_fragment.replace("vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );","\n            #ifdef ENVMAP_TYPE_LDR\n                vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n            #else\n                vec4 envMapColor = textureCubeUV( envMap, worldNormal.xzy, 1.0 );\n            #endif"),o.ShaderChunk.envmap_physical_pars_fragment=o.ShaderChunk.envmap_physical_pars_fragment.replace("vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );","\n            #ifdef ENVMAP_TYPE_LDR\n                vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n            #else\n                vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec.xzy, specularMIPLevel );\n            #endif"),o.ShaderChunk.envmap_physical_pars_fragment=o.ShaderChunk.envmap_physical_pars_fragment.replace("vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );","\n            #ifdef ENVMAP_TYPE_LDR\n                vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n            #else\n                vec4 envMapColor = textureCube( envMap, queryReflectVec.xzy, specularMIPLevel );\n            #endif"),o.ShaderChunk.envmap_physical_pars_fragment=o.ShaderChunk.envmap_physical_pars_fragment.replace("vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );","\n            #ifdef ENVMAP_TYPE_LDR\n                vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n            #else\n                vec4 envMapColor = textureCubeUV( envMap, reflectVec.xzy, roughness );\n            #endif"),!o.ShaderChunk.lights_fragment_maps.includes("vec3 reflectVec")){var r=o.ShaderChunk.lights_fragment_maps.lastIndexOf("#endif");o.ShaderChunk.lights_fragment_maps=o.ShaderChunk.lights_fragment_maps.substring(0,r)+"#else\n                vec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n                reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n                radiance += (vec3((reflectVec.z + 1.0) / 2.0) + 0.5) / 1.5;\n            #endif\n            "+o.ShaderChunk.lights_fragment_maps.substring(r+6)}}assignEnvironmentMap(e,t){this._envMap=e,this._envMapType=t;for(let t in this._materialCache)if(this._materialCache[t]instanceof o.MeshPhysicalMaterial||this._materialCache[t]instanceof o.MeshStandardMaterial){this._materialCache[t].envMap=e,this._materialCache[t].needsUpdate=!0;for(let e in this._materialCache[t].defines)e.startsWith("ENVMAP_TYPE_")&&delete this._materialCache[t].defines[e];this._materialCache[t].defines["ENVMAP_TYPE_"+this._envMapType.toUpperCase()]=""}}assignPointSize(e){const t=this._renderingEngine.renderer?this._renderingEngine.renderer.getSize(new o.Vector2).y:1080;if(t!==this._height||e*(this._height/1080)!==this._pointSize){this._height=t,this._pointSize=e*(this._height/1080);for(let e in this._materialCache)this._materialCache[e]instanceof o.PointsMaterial&&(this._materialCache[e].size=this._pointSize,this._materialCache[e].needsUpdate=!0)}}assignTextureEncoding(){for(let e in this._materialCache)(this._materialCache[e]instanceof o.MeshPhysicalMaterial||this._materialCache[e]instanceof o.MeshStandardMaterial)&&(this._materialCache[e].emissiveMap&&(this._materialCache[e].emissiveMap.encoding=this._textureEncoding),this._materialCache[e].map&&(this._materialCache[e].map.encoding=this._textureEncoding),this._materialCache[e].needsUpdate=!0)}emptyMaterialCache(){this._materialCache={}}removeFromMaterialCache(e){for(let t in this._materialCache)t.startsWith(e)&&delete this._materialCache[t]}init(){}getMaterialProperties(e,t,r){const i={};let n=0;if(!e)return i.color=new o.Color(this._converter.toThreeJsColorInput(this._defaultColor)),void 0!==r&&r.useVertexColors&&(i.color=new o.Color("#d3d3d3")),i.side=o.DoubleSide,{properties:i,mapCount:n};if(i.alphaTest=e.alphaCutoff,void 0!==e.opacity&&(i.opacity=e.opacity,i.transparent=i.opacity<1,i.depthWrite=!(i.opacity<1)),e.alphaMode===a.MATERIAL_ALPHA.BLEND?(i.transparent=!0,i.depthWrite=!1):i.transparent||(i.transparent=!1),void 0!==e.color&&(i.color=new o.Color(this._converter.toThreeJsColorInput(e.color))),void 0===e.color&&void 0!==e.map&&void 0!==e.map.color&&(i.color=new o.Color(this._converter.toThreeJsColorInput(e.map.color))),void 0!==e.color||void 0===e.map||void 0!==e.map.color||void 0!==r&&r.useVertexColors||(i.color=new o.Color(this._converter.toThreeJsColorInput(this._defaultColor))),void 0===r||!r.useVertexColors||e.color!==this._defaultColor&&e.color!==this._defaultColor+"ff"&&void 0!==e.color||(i.color=new o.Color("#d3d3d3")),void 0!==e.side&&(i.side=e.side===a.MATERIAL_SIDE.BACK?o.BackSide:e.side===a.MATERIAL_SIDE.FRONT?o.FrontSide:o.DoubleSide),t===h.POINT)return i.size=this._pointSize,{properties:i,mapCount:n};if(t===h.LINE)return{properties:i,mapCount:n};const s=i;if(void 0!==e.alphaMap&&(s.alphaMap=this.createTexture(e.alphaMap),s.transparent=!0,s.depthWrite=!1,n++),void 0!==e.aoMap&&(s.aoMap=this.createTexture(e.aoMap),n++),void 0!==e.aoMapIntensity&&(s.aoMapIntensity=e.aoMapIntensity),void 0!==e.map&&(s.map=this.createTexture(e.map),s.map.encoding=this._textureEncoding,n++),e instanceof a.MaterialUnlitData)return{properties:s,mapCount:n};const l=s;if(void 0!==e.shading&&(l.flatShading="smooth"!==e.shading),void 0!==e.bumpMap&&(l.bumpMap=this.createTexture(e.bumpMap),n++),l.bumpScale=e.bumpScale,void 0!==e.emissiveness&&(l.emissive=new o.Color(this._converter.toThreeJsColorInput(e.emissiveness))),void 0!==e.emissiveMap&&(l.emissiveMap=this.createTexture(e.emissiveMap),l.emissiveMap.encoding=this._textureEncoding,n++),l.envMap=this._envMap,void 0!==e.normalMap&&(l.normalMap=this.createTexture(e.normalMap),n++),void 0!==e.normalScale&&(l.normalScale=new o.Vector2(e.normalScale,-e.normalScale)),e instanceof a.MaterialSpecularGlossinessData){const t=l;return t.specular=new o.Color(this._converter.toThreeJsColorInput(e.specular)),t.glossiness=e.glossiness,void 0!==e.specularGlossinessMap?(t.specularMap=this.createTexture(e.specularGlossinessMap),t.specularMap.encoding=o.sRGBEncoding,t.glossinessMap=t.specularMap,n++):(void 0!==e.specularMap&&(t.specularMap=this.createTexture(e.specularMap),t.specularMap.encoding=o.sRGBEncoding,n++),void 0!==e.glossinessMap&&(t.glossinessMap=this.createTexture(e.glossinessMap),n++)),{properties:t,mapCount:n}}if(e instanceof a.MaterialStandardData){const t=l;return t.clearcoat=e.clearcoat,void 0!==e.clearcoatMap&&(t.clearcoatMap=this.createTexture(e.clearcoatMap),n++),void 0!==e.clearcoatNormalMap&&(t.clearcoatNormalMap=this.createTexture(e.clearcoatNormalMap),n++),t.clearcoatRoughness=e.clearcoatRoughness,void 0!==e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap=this.createTexture(e.clearcoatRoughnessMap),n++),t.ior=e.ior,t.transmission=e.transmission,t.transmission>0&&(t.opacity=1),void 0!==e.transmissionMap&&(t.transmissionMap=this.createTexture(e.transmissionMap),n++),t.thickness=e.thickness,void 0!==e.thicknessMap&&(t.thicknessMap=this.createTexture(e.thicknessMap),n++),t.attenuationDistance=e.attenuationDistance,t.attenuationColor=new o.Color(this._converter.toThreeJsColorInput(e.attenuationColor)),t.sheen=e.sheen,t.sheenColor=new o.Color(this._converter.toThreeJsColorInput(e.sheenColor)),t.sheenRoughness=e.sheenRoughness,void 0!==e.sheenColorMap&&(t.sheenColorMap=this.createTexture(e.sheenColorMap),n++),void 0!==e.sheenRoughnessMap&&(t.sheenRoughnessMap=this.createTexture(e.sheenRoughnessMap),n++),t.specularIntensity=e.specularIntensity,void 0!==e.specularIntensityMap&&(t.specularIntensityMap=this.createTexture(e.specularIntensityMap),n++),t.specularColor=new o.Color(this._converter.toThreeJsColorInput(e.specularColor)),void 0!==e.specularColorMap&&(t.specularColorMap=this.createTexture(e.specularColorMap),n++),t.metalness=e.metalness,t.roughness=e.roughness,void 0!==e.metalnessRoughnessMap?(t.metalnessMap=this.createTexture(e.metalnessRoughnessMap),t.roughnessMap=t.metalnessMap,n++):(void 0!==e.metalnessMap&&(t.metalnessMap=this.createTexture(e.metalnessMap),n++),void 0!==e.roughnessMap&&(t.roughnessMap=this.createTexture(e.roughnessMap),n++)),{properties:t,mapCount:n}}const c=new u.ShapeDiverViewerDataProcessingError("MaterialLoader.getMaterialProperties: No proper material properties were found.");throw this._logger.handleError(u.LOGGINGTOPIC.DATA_PROCESSING,"MaterialLoader.getMaterialProperties",c)}load(e,t){let r;if(r=t&&0===t.mode?h.POINT:!t||1!==t.mode&&2!==t.mode&&3!==t.mode?h.MESH:h.LINE,e&&this._materialCache[e.id+"_"+e.version+"_"+r])return this._materialCache[e.id+"_"+e.version+"_"+r];let i,{properties:n,mapCount:s}=this.getMaterialProperties(e,r,t);if(this.maxMapCount=Math.max(this.maxMapCount,s),r===h.POINT)i=new o.PointsMaterial(n);else if(r===h.LINE)i=new o.LineBasicMaterial(n);else if(e instanceof a.MaterialUnlitData)i=new o.MeshBasicMaterial(n);else{i=e instanceof a.MaterialSpecularGlossinessData?new c.SpecularGlossinessMaterial(n):new o.MeshPhysicalMaterial(n);const r=i.onBeforeCompile;i.onBeforeCompile=(e,t)=>{r(e,t),e.uniforms.lightSizeUV={value:this._lightSizeUV},e.uniforms.blending={value:this._blending},i.userData.shader=e},i.defines["ENVMAP_TYPE_"+this._envMapType.toUpperCase()]="",t&&t.useVertexTangents&&i.normalScale&&(i.normalScale.y*=-1),t&&t.useFlatShading&&(i.flatShading=!0)}return t&&t.useVertexColors&&(i.vertexColors=!0),e&&(i.userData={SDid:e.id,SDversion:e.version}),e&&this._materialCache[e.id+"_"+e.version+"_"+r]?(this._materialCache[e.id+"_"+e.version+"_"+r].copy(i),this._materialCache[e.id+"_"+e.version+"_"+r]):(i.needsUpdate=!0,e&&(this._materialCache[e.id+"_"+e.version+"_"+r]=i),i)}updateMaterials(){for(let e in this._materialCache)this._materialCache[e].needsUpdate=!0}updateSoftShadow(e,t){this._lightSizeUV=e,this._blending=t;for(let r in this._materialCache)this._materialCache[r].userData.shader&&(this._materialCache[r].userData.shader.uniforms.lightSizeUV.value=e,this._materialCache[r].userData.shader.uniforms.blending.value=t)}createTexture(e){const t=new o.Texture(e.image);return t.format=o.RGBAFormat,t.minFilter=(()=>{switch(e.minFilter){case a.TEXTURE_FILTERING.NEAREST:return o.NearestFilter;case a.TEXTURE_FILTERING.NEAREST_MIPMAP_NEAREST:return o.NearestMipMapNearestFilter;case a.TEXTURE_FILTERING.LINEAR_MIPMAP_NEAREST:return o.LinearMipMapNearestFilter;case a.TEXTURE_FILTERING.NEAREST_MIPMAP_LINEAR:return o.NearestMipMapLinearFilter;case a.TEXTURE_FILTERING.LINEAR:return o.LinearFilter;case a.TEXTURE_FILTERING.LINEAR_MIPMAP_LINEAR:default:return o.LinearMipMapLinearFilter}})(),t.magFilter=(()=>{switch(e.magFilter){case a.TEXTURE_FILTERING.NEAREST:return o.NearestFilter;case a.TEXTURE_FILTERING.LINEAR:default:return o.LinearFilter}})(),t.wrapS=(()=>{switch(e.wrapS){case a.TEXTURE_WRAPPING.CLAMP_TO_EDGE:return o.ClampToEdgeWrapping;case a.TEXTURE_WRAPPING.MIRRORED_REPEAT:return o.MirroredRepeatWrapping;case a.TEXTURE_WRAPPING.REPEAT:default:return o.RepeatWrapping}})(),t.wrapT=(()=>{switch(e.wrapT){case a.TEXTURE_WRAPPING.CLAMP_TO_EDGE:return o.ClampToEdgeWrapping;case a.TEXTURE_WRAPPING.MIRRORED_REPEAT:return o.MirroredRepeatWrapping;case a.TEXTURE_WRAPPING.REPEAT:default:return o.RepeatWrapping}})(),t.center=new o.Vector2(e.center[0],e.center[1]),t.offset=new o.Vector2(e.offset[0],e.offset[1]),t.repeat=new o.Vector2(e.repeat[0],e.repeat[1]),t.rotation=e.rotation,t.flipY=e.flipY,t.needsUpdate=!0,t}get maxMapCount(){return this._maxMapCount}set maxMapCount(e){this._maxMapCount=e}get textureEncoding(){return this._textureEncoding}set textureEncoding(e){this._textureEncoding=e,this.assignTextureEncoding()}}})),s.register("2VtbH",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.entry=e.exports.main=void 0,e.exports.main="\n\nuniform float lightSizeUV;\nuniform float blending;\n\n#ifdef SHADOWMAP_TYPE_PCF\n\n#define NEAR_PLANE 0.1\n#define NUM_SAMPLES 20\n#define NUM_RINGS 11\n\nvec2 poissonDisk[NUM_SAMPLES];\n\nvoid initPoissonSamples( const in vec2 randomSeed ) {\n    float ANGLE_STEP = PI2 * float(NUM_RINGS) / float(NUM_SAMPLES);\n    float INV_NUM_SAMPLES = 1.0 / float(NUM_SAMPLES);\n\n    // jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/\n    float angle = rand(randomSeed) * PI2;\n    float radius = INV_NUM_SAMPLES;\n    float radiusStep = radius;\n\n    for (int i = 0; i < int(NUM_SAMPLES); i++ ) {\n        poissonDisk[i] = vec2(cos(angle), sin(angle)) * pow(radius, 0.75);\n        radius += radiusStep;\n        angle += ANGLE_STEP;\n    }\n}\n\nfloat penumbraSize( const in float zReceiver, const in float zBlocker ) { // Parallel plane estimation\n    return (zReceiver - zBlocker) / zBlocker;\n}\n\nfloat findBlocker(sampler2D shadowMap, const in vec2 uv, const in float zReceiver ) {\n    // This uses similar triangles to compute what\n    // area of the shadow map we should search\n    float searchRadius = lightSizeUV * (zReceiver - NEAR_PLANE) / zReceiver;\n    float blockerDepthSum = 0.0;\n    int numBlockers = 0;\n\n    for (int i = 0; i < int(NUM_SAMPLES); i++ ) {\n        float shadowMapDepth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * searchRadius));\n        if (shadowMapDepth < zReceiver) {\n            blockerDepthSum += shadowMapDepth;\n            numBlockers++;\n        }\n    }\n\n    if (numBlockers == 0) return -1.0;\n\n    return blockerDepthSum / float(numBlockers);\n}\n\nfloat PCF_Filter(sampler2D shadowMap, vec2 uv, float zReceiver, float filterRadius) {\n    float sum = 0.0;\n    for (int i = 0; i < int(NUM_SAMPLES); i++ ) {\n        float depth = unpackRGBAToDepth(texture2D(shadowMap, uv + poissonDisk[i] * filterRadius));\n        if (zReceiver <= depth) sum += 1.0;\n    }\n    for (int i = 0; i < int(NUM_SAMPLES); i++ ) {\n        float depth = unpackRGBAToDepth(texture2D(shadowMap, uv + -poissonDisk[i].yx * filterRadius));\n        if (zReceiver <= depth) sum += 1.0;\n    }\n    return sum / (2.0 * float(NUM_SAMPLES));\n}\n\nfloat PCSS(sampler2D shadowMap, vec4 coords) {\n    vec2 uv = coords.xy;\n    float zReceiver = coords.z; // Assumed to be eye-space z in this code\n\n    initPoissonSamples(uv);\n    // STEP 1: blocker search\n    float avgBlockerDepth = findBlocker(shadowMap, uv, zReceiver);\n\n    //There are no occluders so early out (this saves filtering)\n    if (avgBlockerDepth == -1.0) return 1.0;\n\n    // STEP 2: penumbra size\n    float penumbraRatio = penumbraSize(zReceiver, avgBlockerDepth);\n    float filterRadius = penumbraRatio * lightSizeUV * NEAR_PLANE / zReceiver;\n\n    // STEP 3: filtering\n    //return avgBlockerDepth;\n    return PCF_Filter(shadowMap, uv, zReceiver, filterRadius);\n}\n#endif\n",e.exports.entry="\n// PCSS implementation\nvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\nfloat dx = texelSize.x;\nfloat dy = texelSize.y;\nvec2 uv = shadowCoord.xy;\nvec2 f = fract( uv * shadowMapSize + 0.5 );\nuv -= f * texelSize;\nfloat shadow1 = (\n    texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n    texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n    texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n    texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n    mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n         texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n         f.x ) +\n    mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n         texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n         f.x ) +\n    mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n         texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n         f.y ) +\n    mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n         texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n         f.y ) +\n    mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n              texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n              f.x ),\n         mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n              texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n              f.x ),\n         f.y )\n) * ( 1.0 / 9.0 );\nfloat shadow2 = PCSS( shadowMap, shadowCoord );\nshadow = shadow1 * (1.0 - blending) + blending * shadow2;\n            "})),s.register("4Haor",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SpecularGlossinessMaterial=void 0;const o=n(s("ilwiq"));class a extends o.MeshStandardMaterial{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),n=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new o.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(e){for(const t in a)e.uniforms[t]=a[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",i).replace("#include <metalnessmap_fragment>",n).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(e){a.specular.value=e}},specularMap:{get:function(){return a.specularMap.value},set:function(e){a.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(e){a.glossiness.value=e}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(e){a.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}e.exports.SpecularGlossinessMaterial=a})),s.register("gsATb",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},o=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.EnvironmentMapLoader=e.exports.ENVIRONMENT_MAP_TYPE=e.exports.ENVIRONMENT_MAP=e.exports.ENVIRONMENT_MAP_CUBE=void 0;const a=n(s("ilwiq"));var l=s("cTTbu");s("yoicn");var c,u,h,d,f,p=s("bJEmL"),m=s("hMG7k"),g=s("12eGO");(c=e.exports.ENVIRONMENT_MAP_CUBE||(e.exports.ENVIRONMENT_MAP_CUBE={})).DEFAULT="default",c.DEFAULT_BW="default_bw",c.BLURRED_LIGHTS="blurred_lights",c.GEORGENTOR="georgentor",c.GEORGENTOR_BLUR="georgentor_blur",c.GEORGENTOR_BLUE_BLUR="georgentor_blue_blur",c.GEORGENTOR_BW_BLUR="georgentor_bw_blur",c.LEVELSETS="levelsets",c.LYTHWOOD_FIELD="lythwood_field",c.MOUNTAINS="mountains",c.OCEAN="ocean",c.PIAZZA_SAN_MARCO="piazza_san_marco",c.RESIDENTIAL_GARDEN="residential_garden",c.ROOM_ABSTRACT_1="room_abstract_1",c.SKY="sky",c.STORAGE_ROOM="storage_room",c.STORM="storm",c.SUBWAY_ENTRANCE="subway_entrance",c.SUBWAY_ENTRANCE_BW_BLUR="subway_entrance_bw_blur",c.WHITE="white",c.YOKOHAMA="yokohama",(h=u=e.exports.ENVIRONMENT_MAP||(e.exports.ENVIRONMENT_MAP={})).ANNIVERSARY_LOUNGE="anniversary_lounge",h.BALLROOM="ballroom",h.CANNON_EXTERIOR="cannon_exterior",h.CAPE_HILL="cape_hill",h.CHRISTMAS_PHOTO_STUDIO="christmas_photo_studio",h.CIRCUS_MAXIMUS="circus_maximus",h.COLORFUL_STUDIO="colorful_studio",h.COMBINATION_ROOM="combination_room",h.GREEN_POINT_PARK="green_point_park",h.HILLTOP_CONSTRUCTION="hilltop_construction",h.LARGE_CORRIDOR="large_corridor",h.LYTHWOOD_LOUNGE="lythwood_lounge",h.NEUTRAL="neutral",h.OBERER_KUHBERG="oberer_kuhberg",h.OLD_HALL="old_hall",h.PAUL_LOBE_HAUS="paul_lobe_haus",h.PHOTO_STUDIO="photo_studio",h.PHOTO_STUDIO_BROADWAY_HALL="photo_studio_broadway_hall",h.SNOWY_FIELD="snowy_field",h.STUDIO_SMALL="studio_small",h.SUNFLOWERS="sunflowers",h.TABLE_MOUNTAIN="table_mountain",h.VENICE_SUNSET="venice_sunset",h.WIDE_STREET="wide_street",(f=d=e.exports.ENVIRONMENT_MAP_TYPE||(e.exports.ENVIRONMENT_MAP_TYPE={})).LDR="ldr",f.HDR="hdr",f.NONE="none";e.exports.EnvironmentMapLoader=class{constructor(e){this._renderingEngine=e,this._converter=p.instance.resolve(l.Converter),this._environmentMapFilenames=["px","nx","pz","nz","py","ny"],this._environmentMapHDR=[],this._environmentMapNamesHDR=Object.values(u).filter((e=>"string"==typeof e)),this._environmentMapNamesHDRKhronos=["cannon_exterior","colorful_studio","neutral","wide_street"],this._environmentMapNamesJPG=["default","default_bw","blurred_lights","georgentor","georgentor_blur","georgentor_blue_blur","georgentor_bw_blur","levelsets","lythwood_field","mountains","ocean","piazza_san_marco","residential_garden","room_abstract_1","sky","storage_room","storm","subway_entrance","subway_entrance_bw_blur","white","yokohama"],this._environmentMaps={},this._eventEngine=p.instance.resolve(l.EventEngine),this._stateEngine=p.instance.resolve(l.StateEngine),this._logger=p.instance.resolve(l.Logger),this._httpClient=p.instance.resolve(l.HttpClient),this._uuidGenerator=p.instance.resolve(l.UuidGenerator),this._environmentMapName="none",this._environmentMapNameInternal="none",this._isHDRMap=!1,this._textureEncoding=a.sRGBEncoding,this._type=d.NONE}get environmentMap(){return this._environmentMaps[this._environmentMapName]}get isHDRMap(){return this._isHDRMap}init(){this._environmentMaps.none=null,this._pmremGenerator=new a.PMREMGenerator(this._renderingEngine.renderer),this._pmremGenerator.compileEquirectangularShader()}notify(e,t=!1){let r;t?(r={type:g.TASKTYPE.ENVIRONMENT_MAP_LOADING,id:e,progress:1,status:"Loading of EnvironmentMap failed"},this._eventEngine.emitEvent(l.EVENTTYPE.TASK.TASK_CANCEL,r)):(r={type:g.TASKTYPE.ENVIRONMENT_MAP_LOADING,id:e,progress:1,status:"Loaded EnvironmentMap"},this._stateEngine.viewers[this._renderingEngine.id].environmentMapLoaded.resolve(!0),this._stateEngine.viewers[this._renderingEngine.id].environmentMapLoaded=new l.StatePromise,this._eventEngine.emitEvent(l.EVENTTYPE.TASK.TASK_END,r))}load(e){return o(this,void 0,void 0,(function*(){const t=this._uuidGenerator.create(),r={type:g.TASKTYPE.ENVIRONMENT_MAP_LOADING,id:t,data:{input:e},progress:0,status:"Loading EnvironmentMap"};this._eventEngine.emitEvent(l.EVENTTYPE.TASK.TASK_START,r);if("none"===e)return this._environmentMapNameInternal=e,this.assignEnvironmentMap(e,d.NONE,t),!0;let i,n,s;if(!Array.isArray(e)&&e.startsWith('["https')&&e.endsWith('"]'))try{e=JSON.parse(e)}catch(r){this.notify(t,!0);const i=new l.ShapeDiverViewerEnvironmentMapError("EnvironmentMapLoader.load: Was not able to load environment map.",e);throw this._logger.handleError(l.LOGGINGTOPIC.VIEWER,"EnvironmentMapLoader.load",i)}if(Array.isArray(e)){if(6!==e.length){this.notify(t,!0);const r=new l.ShapeDiverViewerEnvironmentMapError("EnvironmentMapLoader.load: Was not able to load environment map, exactly 6 files are needed in the array.",e);throw this._logger.handleError(l.LOGGINGTOPIC.VIEWER,"EnvironmentMapLoader.load",r)}i=JSON.stringify(e,null,0),n=i}else i=e.toLowerCase().replace(/ /g,"_"),n=i+this._renderingEngine.environmentMapResolution;this._environmentMapNameInternal=i;for(let e in this._environmentMaps)if(e===n)return this.assignEnvironmentMap(e,this._environmentMaps[e]instanceof a.CubeTexture?d.LDR:d.HDR,t),!0;try{if(Array.isArray(e))s=e;else{let r;if(s=[],this._environmentMapNamesHDR.indexOf(i)>=0){let e="https://viewer.shapediver.com/v3/envmaps/1k/"+i+"_1k.hdr";return this._environmentMapNamesHDRKhronos.indexOf(i)>=0&&(e="https://viewer.shapediver.com/v3/envmaps/khronos/"+i+".hdr"),this._environmentMapHDR.push(e),yield this.loadEnvironmentMap(e,[],t),Promise.resolve(!0)}if(this._environmentMapNamesJPG.indexOf(i)>=0)for(r=0;r<this._environmentMapFilenames.length;r++)s.push("https://viewer.shapediver.com/v2/envmaps/"+this._renderingEngine.environmentMapResolution+"/"+i+"/"+this._environmentMapFilenames[r]+".jpg");else{if(!e.startsWith("https://")&&!e.startsWith("http://")){this.notify(t,!0);const r=new l.ShapeDiverViewerEnvironmentMapError("EnvironmentMapLoader.load: Was not able to load environment map, format not supported.",e);throw this._logger.handleError(l.LOGGINGTOPIC.VIEWER,"EnvironmentMapLoader.load",r)}if(e.endsWith(".hdr"))return this._environmentMapHDR.push(e),yield this.loadEnvironmentMap(e,[],t),Promise.resolve(!0);for(e.endsWith("/")||(e+="/"),r=0;r<this._environmentMapFilenames.length;r++)s.push(e+this._environmentMapFilenames[r]+".jpg")}}return yield this.loadEnvironmentMap(n,s,t),Promise.resolve(!0)}catch(e){throw this.notify(t,!0),this._logger.handleError(l.LOGGINGTOPIC.VIEWER,"EnvironmentMapLoader.load",e)}}))}getEnvironmentMapImageUrl(e){if(Array.isArray(e))return"";if(this._environmentMapNamesHDR.indexOf(e)>=0){let t="https://viewer.shapediver.com/v3/envmaps/1k/"+e+"_1k.hdr";return this._environmentMapNamesHDRKhronos.indexOf(e)>=0&&(t="https://viewer.shapediver.com/v3/envmaps/khronos/"+e+".hdr"),t}return(e.startsWith("https://")||e.startsWith("http://"))&&(e.endsWith(".hdr")||e.endsWith(".jpg")||e.endsWith(".png"))?e:""}assignEnvironmentMap(e,t,r){e in this._environmentMaps!=!1&&(this._type=t,this._environmentMapName=e,this._renderingEngine.materialLoader.assignEnvironmentMap(this._environmentMaps[e],t),this.notify(r))}assignTextureEncoding(){var e;for(let t in this._environmentMaps)this._environmentMaps[t]&&!this._environmentMapHDR.includes(t)&&(null===(e=this._environmentMaps[t])||void 0===e||e.dispose(),this._environmentMaps[t].encoding=this._textureEncoding,this._environmentMaps[t].needsUpdate=!0)}loadEnvironmentMap(e,t,r){return o(this,void 0,void 0,(function*(){return new Promise(((i,n)=>o(this,void 0,void 0,(function*(){if(e.endsWith(".hdr")){const t=(yield this._httpClient.loadData(e)).data;(new m.RGBELoader).load(URL.createObjectURL(t),(t=>{const n=this._pmremGenerator.fromEquirectangular(t).texture;this._pmremGenerator.dispose(),this._environmentMaps[e]=n,this.assignEnvironmentMap(e,d.HDR,r),i()}),(()=>{}),(e=>n(e)))}else{const s=[];t.forEach((e=>s.push(this._httpClient.loadData(e).then((e=>this._converter.responseToImage(e)))))),(new a.CubeTextureLoader).load(t,(t=>{t.encoding=a.sRGBEncoding,t.format=a.RGBAFormat,t.mapping=a.CubeReflectionMapping,this._environmentMaps[e]=t,this.assignEnvironmentMap(e,d.LDR,r),i()}),(()=>{}),(e=>n(e)))}}))))}))}get textureEncoding(){return this._textureEncoding}set textureEncoding(e){this._textureEncoding=e,this.assignTextureEncoding()}}})),s.register("hMG7k",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RGBELoader=void 0;var r=s("ilwiq");class i extends r.DataTextureLoader{constructor(e){super(e),this.type=r.HalfFloatType}parse(e){const t=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},i=function(e,t,r){t=t||1024;let i=e.pos,n=-1,s=0,o="",a=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));for(;0>(n=a.indexOf("\n"))&&s<t&&i<e.byteLength;)o+=a,s+=a.length,i+=128,a+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(i,i+128)));return-1<n&&(!1!==r&&(e.pos+=s+n+1),o+a.slice(0,n))},n=function(e,t,r,i){const n=e[t+3],s=Math.pow(2,n-128)/255;r[i+0]=e[t+0]*s,r[i+1]=e[t+1]*s,r[i+2]=e[t+2]*s,r[i+3]=1},s=function(e,t,i,n){const s=e[t+3],o=Math.pow(2,s-128)/255;i[n+0]=r.DataUtils.toHalfFloat(Math.min(e[t+0]*o,65504)),i[n+1]=r.DataUtils.toHalfFloat(Math.min(e[t+1]*o,65504)),i[n+2]=r.DataUtils.toHalfFloat(Math.min(e[t+2]*o,65504)),i[n+3]=r.DataUtils.toHalfFloat(1)},o=new Uint8Array(e);o.pos=0;const a=function(e){const r=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,n=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,s=/^\s*FORMAT=(\S+)\s*$/,o=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,a={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let l,c;if(e.pos>=e.byteLength||!(l=i(e)))return t(1,"no header found");if(!(c=l.match(/^#\?(\S+)/)))return t(3,"bad initial token");for(a.valid|=1,a.programtype=c[1],a.string+=l+"\n";l=i(e),!1!==l;)if(a.string+=l+"\n","#"!==l.charAt(0)){if((c=l.match(r))&&(a.gamma=parseFloat(c[1])),(c=l.match(n))&&(a.exposure=parseFloat(c[1])),(c=l.match(s))&&(a.valid|=2,a.format=c[1]),(c=l.match(o))&&(a.valid|=4,a.height=parseInt(c[1],10),a.width=parseInt(c[2],10)),2&a.valid&&4&a.valid)break}else a.comments+=l+"\n";return 2&a.valid?4&a.valid?a:t(3,"missing image size specifier"):t(3,"missing format specifier")}(o);if(-1!==a){const e=a.width,i=a.height,l=function(e,r,i){const n=r;if(n<8||n>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(n!==(e[2]<<8|e[3]))return t(3,"wrong scanline width");const s=new Uint8Array(4*r*i);if(!s.length)return t(4,"unable to allocate buffer space");let o=0,a=0;const l=4*n,c=new Uint8Array(4),u=new Uint8Array(l);let h=i;for(;h>0&&a<e.byteLength;){if(a+4>e.byteLength)return t(1);if(c[0]=e[a++],c[1]=e[a++],c[2]=e[a++],c[3]=e[a++],2!=c[0]||2!=c[1]||(c[2]<<8|c[3])!=n)return t(3,"bad rgbe scanline format");let r,i=0;for(;i<l&&a<e.byteLength;){r=e[a++];const n=r>128;if(n&&(r-=128),0===r||i+r>l)return t(3,"bad scanline data");if(n){const t=e[a++];for(let e=0;e<r;e++)u[i++]=t}else u.set(e.subarray(a,a+r),i),i+=r,a+=r}const d=n;for(let e=0;e<d;e++){let t=0;s[o]=u[e+t],t+=n,s[o+1]=u[e+t],t+=n,s[o+2]=u[e+t],t+=n,s[o+3]=u[e+t],o+=4}h--}return s}(o.subarray(o.pos),e,i);if(-1!==l){let t,o,c,u;switch(this.type){case r.FloatType:u=l.length/4;const e=new Float32Array(4*u);for(let t=0;t<u;t++)n(l,4*t,e,4*t);t=e,c=r.FloatType;break;case r.HalfFloatType:u=l.length/4;const i=new Uint16Array(4*u);for(let e=0;e<u;e++)s(l,4*e,i,4*e);t=i,c=r.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:e,height:i,data:t,header:a.string,gamma:a.gamma,exposure:a.exposure,format:o,type:c}}}return null}setDataType(e){return this.type=e,this}load(e,t,i,n){return super.load(e,(function(e,i){switch(e.type){case r.FloatType:case r.HalfFloatType:e.encoding=r.LinearEncoding,e.minFilter=r.LinearFilter,e.magFilter=r.LinearFilter,e.generateMipmaps=!1,e.flipY=!0}t&&t(e,i)}),i,n)}}e.exports.RGBELoader=i})),s.register("cZIX4",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GeometryLoader=void 0;const o=n(s("ilwiq"));var a=s("12eGO"),l=s("cTTbu");s("yoicn");var c=s("bJEmL"),u=s("iBhyF"),h=s("g1ukU");e.exports.GeometryLoader=class{constructor(e){this._renderingEngine=e,this._counter=0,this._geometryCache={},this._logger=c.instance.resolve(l.Logger)}emptyGeometryCache(){this._geometryCache={}}init(){}load(e,t,r){if(this._geometryCache[e.id+"_"+e.version]){let r;r=this._renderingEngine.type===u.RENDERERTYPE.ATTRIBUTES?e.primitive.attributeMaterial:e.primitive.effectMaterials.length>0?e.primitive.effectMaterials[e.primitive.effectMaterials.length-1].material:e.primitive.material;const i=this._geometryCache[e.id+"_"+e.version].threeGeometry.clone(),n={mode:e.primitive.mode,useVertexTangents:void 0!==i.attributes.tangent,useVertexColors:void 0!==i.attributes.color&&this._renderingEngine.type!==u.RENDERERTYPE.ATTRIBUTES,useFlatShading:void 0===i.attributes.normal,useMorphTargets:Object.keys(i.morphAttributes).length>0,useMorphNormals:Object.keys(i.morphAttributes).length>0&&void 0!==i.morphAttributes.normal},s=this._renderingEngine.materialLoader.load(r,n),a=this._geometryCache[e.id+"_"+e.version].obj.clone();a.traverse((e=>{(e instanceof o.Points||e instanceof o.LineSegments||e instanceof o.LineLoop||e instanceof o.Line||e instanceof o.Mesh)&&(e.material=s)})),t.add(a)}else{const i=this.loadGeometry(e.primitive);let n;n=this._renderingEngine.type===u.RENDERERTYPE.ATTRIBUTES?e.primitive.attributeMaterial:e.primitive.effectMaterials.length>0?e.primitive.effectMaterials[e.primitive.effectMaterials.length-1].material:e.primitive.material;const s={mode:e.primitive.mode,useVertexTangents:void 0!==i.attributes.tangent,useVertexColors:void 0!==i.attributes.color&&this._renderingEngine.type!==u.RENDERERTYPE.ATTRIBUTES,useFlatShading:void 0===i.attributes.normal,useMorphTargets:Object.keys(i.morphAttributes).length>0,useMorphNormals:Object.keys(i.morphAttributes).length>0&&void 0!==i.morphAttributes.normal},o=this._renderingEngine.materialLoader.load(n,s),a=new h.SDData(e.id,e.version);this.createMesh(a,e,i,o,s,r),t.add(a)}return e.boundingBox.clone().applyMatrix(e.matrix)}loadGeometry(e){let t=new o.BufferGeometry;for(let r in e.attributes){const i=this.loadAttribute(e.attributes[r],r),n=this.getAttributeName(r);if("NORMAL"===r&&this.checkNormals(e,r,i,t))continue;t.setAttribute(n,i),e.indices&&t.setIndex(new o.BufferAttribute(e.indices.array,e.indices.itemSize));const s=e.attributes[r].morphAttributeData;if(s.length>0){t.morphTargetsRelative=!0;const e=[];for(let t=0;t<s.length;t++)e.push(this.loadAttribute(s[t],r));t.morphAttributes[n]=e}}return t}removeFromGeometryCache(e){this._geometryCache[e]&&delete this._geometryCache[e]}checkNormals(e,t,r,i){let n=!1;for(let e=0;e<10;++e){if(Math.abs(r.array[3*e])>.001){n=!0;break}if(Math.abs(r.array[3*e+1])>.001){n=!0;break}if(Math.abs(r.array[3*e+2])>.001){n=!0;break}}if(!n){i.computeVertexNormals();const r=i.getAttribute("normal");return e.attributes[t]=new a.AttributeData(new Float32Array(r.array),r.itemSize,0,0,3,r.normalized,r.array.length/3),!0}return!1}convertToTriangleMode(e,t){let r=e.getIndex();if(null===r){const t=[],i=e.getAttribute("position");if(void 0===i){const e=new l.ShapeDiverViewerDataProcessingError("GeometryLoader.convertToTriangleMode: Undefined position attribute. Processing not possible.");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryLoader.convertToTriangleMode",e)}for(let e=0;e<i.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}if(null===r){const e=new l.ShapeDiverViewerDataProcessingError("GeometryLoader.convertToTriangleMode: Undefined index. Processing not possible.");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryLoader.convertToTriangleMode",e)}const i=r.count-2,n=[];if(t===a.PRIMITIVE_MODE.TRIANGLE_FAN)for(let e=1;e<=i;e++)n.push(r.getX(0)),n.push(r.getX(e)),n.push(r.getX(e+1));else for(let e=0;e<i;e++)e%2==0?(n.push(r.getX(e)),n.push(r.getX(e+1)),n.push(r.getX(e+2))):(n.push(r.getX(e+2)),n.push(r.getX(e+1)),n.push(r.getX(e)));if(n.length/3!==i){const e=new l.ShapeDiverViewerDataProcessingError("GeometryLoader.convertToTriangleMode: Unable to generate correct amount of triangle.");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryLoader.convertToTriangleMode",e)}const s=e.clone();return s.setIndex(n),s}createMesh(e,t,r,i,n,s){if(t.primitive.mode===a.PRIMITIVE_MODE.POINTS)e.add(new o.Points(r,i));else if(t.primitive.mode===a.PRIMITIVE_MODE.LINES)e.add(new o.LineSegments(r,i));else if(t.primitive.mode===a.PRIMITIVE_MODE.LINE_LOOP)e.add(new o.LineLoop(r,i));else if(t.primitive.mode===a.PRIMITIVE_MODE.LINE_STRIP)e.add(new o.Line(r,i));else{if(t.primitive.mode!==a.PRIMITIVE_MODE.TRIANGLES&&t.primitive.mode!==a.PRIMITIVE_MODE.TRIANGLE_STRIP&&t.primitive.mode!==a.PRIMITIVE_MODE.TRIANGLE_FAN){const e=new l.ShapeDiverViewerDataProcessingError(`GeometryLoader.load: Unrecognized primitive mode ${t.primitive.mode}.`);throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryLoader.load",e)}{let n=r;if(t.primitive.mode!==a.PRIMITIVE_MODE.TRIANGLE_STRIP&&t.primitive.mode!==a.PRIMITIVE_MODE.TRIANGLE_FAN||(n=this.convertToTriangleMode(n,t.primitive.mode)),s){const t=new o.SkinnedMesh(n,i);t.bind(s,t.matrixWorld),n.attributes.skinWeight.normalized&&t.normalizeSkinWeights(),e.add(t)}else if(i.opacity<1||i.alphaMap){if(i.side===o.DoubleSide){const t=i.clone();t.side=o.BackSide,e.add(new o.Mesh(n,t));const r=i.clone();r.side=o.FrontSide,e.add(new o.Mesh(n,r))}else e.add(new o.Mesh(n,i))}else e.add(new o.Mesh(n,i));e.children.forEach((e=>e.castShadow=!0)),e.children.forEach((e=>e.receiveShadow=!0))}}e.children.forEach((r=>{r.geometry.boundingBox=new o.Box3(new o.Vector3(t.boundingBox.min[0],t.boundingBox.min[1],t.boundingBox.min[2]),new o.Vector3(t.boundingBox.max[0],t.boundingBox.max[1],t.boundingBox.max[2])),r.geometry.boundingSphere=new o.Sphere(new o.Vector3(t.boundingBox.boundingSphere.center[0],t.boundingBox.boundingSphere.center[1],t.boundingBox.boundingSphere.center[2]),t.boundingBox.boundingSphere.radius),r.geometry.userData={SDid:t.id,SDversion:t.version},r.renderOrder=t.renderOrder,r.morphTargetInfluences=t.morphWeights,e.add(r)})),this._geometryCache[t.id+"_"+t.version]={obj:e,threeGeometry:r,materialSettings:n}}getAttributeName(e){switch(e){case"POSITION":return"position";case"NORMAL":return"normal";case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":case"UV":return"uv";case"TEXCOORD_1":return"uv2";case"COLOR_0":case"COLOR0":case"COLOR":return"color";case"WEIGHT":case"WEIGHTS_0":return"skinWeight";case"JOINT":case"JOINTS_0":return"skinIndex";case"TANGENT":return"tangent";default:this._logger.warn(l.LOGGINGTOPIC.DATA_PROCESSING,`GeometryLoader.loadGeometry: Unrecognized attribute id ${e}.`)}return""}loadAttribute(e,t){let r;if(e.byteStride&&e.byteStride!==e.itemBytes){const t=new o.InterleavedBuffer(e.array,e.byteStride/e.elementBytes);r=new o.InterleavedBufferAttribute(t,e.itemSize,e.byteOffset%e.byteStride/e.elementBytes,e.normalized)}else r=new o.BufferAttribute(e.array,e.itemSize,"COLOR_0"===t||"COLOR0"===t||"COLOR"===t||e.normalized);if(e.sparse){null!==e.array&&(r=new o.BufferAttribute(e.array.slice(),e.itemSize,e.normalized));for(let t=0,i=e.sparseIndices.length;t<i;t++){const i=e.sparseIndices[t];if(r.setX(i,e.sparseValues[t*e.itemSize]),e.itemSize>=2&&r.setY(i,e.sparseValues[t*e.itemSize+1]),e.itemSize>=3&&r.setZ(i,e.sparseValues[t*e.itemSize+2]),e.itemSize>=4&&r.setW(i,e.sparseValues[t*e.itemSize+3]),e.itemSize>=5){const e=new l.ShapeDiverViewerDataProcessingError("GeometryLoader.loadGeometry: Unsupported itemSize in sparse BufferAttribute.");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryLoader.loadGeometry",e)}}}return r}}})),s.register("iaDwp",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.LightLoader=void 0;const o=n(s("ilwiq"));var a=s("eAhLl"),l=s("cTTbu");s("yoicn");var c=s("bJEmL");e.exports.LightLoader=class{constructor(e){this._renderingEngine=e,this._converter=c.instance.resolve(l.Converter),this._shadowMapCount=0,this._forceDisabledShadows=!1}init(){}load(e,t){let r=t.children[0]instanceof o.Light?t.children[0]:null;if(e instanceof a.AmbientLight){r||(r=new o.AmbientLight,t.add(r));const i=r;i.color=new o.Color(this._converter.toThreeJsColorInput(e.color)),i.intensity=e.intensity}if(e instanceof a.DirectionalLight){r||(r=new o.DirectionalLight,t.add(r),t.add(r.target));const i=r;i.color=new o.Color(this._converter.toThreeJsColorInput(e.color)),i.intensity=e.intensity,e.useNodeData&&(i.position.set(0,0,0),i.target.position.set(0,0,-1))}if(e instanceof a.HemisphereLight){r||(r=new o.HemisphereLight,t.add(r));const i=r;i.color=new o.Color(this._converter.toThreeJsColorInput(e.color)),i.intensity=e.intensity,i.groundColor=new o.Color(this._converter.toThreeJsColorInput(e.groundColor))}if(e instanceof a.PointLight){r||(r=new o.PointLight,t.add(r));const i=r;i.color=new o.Color(this._converter.toThreeJsColorInput(e.color)),i.intensity=e.intensity,i.distance=e.distance,i.decay=e.decay,i.position.set(e.position[0],e.position[1],e.position[2])}if(e instanceof a.SpotLight){r||(r=new o.SpotLight(new o.Color(this._converter.toThreeJsColorInput(e.color)),e.intensity,e.distance,e.angle,e.penumbra,e.decay),t.add(r),t.add(r.target));const i=r;i.color=new o.Color(this._converter.toThreeJsColorInput(e.color)),i.intensity=e.intensity,i.distance=e.distance,i.angle=e.angle,i.penumbra=e.penumbra,i.decay=e.decay,i.position.set(e.position[0],e.position[1],e.position[2]),i.target.position.set(e.target[0],e.target[1],e.target[2])}}adjustToBoundingBox(e,t,r){let i=t.children[0];if(e instanceof a.DirectionalLight){const t=i,n=r.boundingSphere;t.position.set(n.center[0]+e.direction[0]*n.radius*2.35,n.center[1]+e.direction[1]*n.radius*2.35,n.center[2]+e.direction[2]*n.radius*2.35),t.target.position.set(n.center[0],n.center[1],n.center[2]),!0===e.castShadow&&!1===this.forceDisabledShadows?(t.castShadow=!0,t.shadow.camera.up.set(0,0,1),t.shadow.camera.far=8*n.radius,t.shadow.camera.right=1.5*n.radius,t.shadow.camera.left=-1.5*n.radius,t.shadow.camera.top=1.5*n.radius,t.shadow.camera.bottom=-1.5*n.radius,t.shadow.mapSize.width=e.shadowMapResolution,t.shadow.mapSize.height=e.shadowMapResolution,t.shadow.bias=e.shadowMapBias,t.shadow.camera.updateProjectionMatrix(),this._shadowMapCount++):t.castShadow=!1}}get shadowMapCount(){return this._shadowMapCount}set shadowMapCount(e){this._shadowMapCount=e}get forceDisabledShadows(){return this._forceDisabledShadows}set forceDisabledShadows(e){this._forceDisabledShadows=e}}})),s.register("4g3Ng",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HTMLElementAnchorLoader=void 0;var r=s("eIStk"),i=s("6BoVD");e.exports.HTMLElementAnchorLoader=class{constructor(e){this._renderingEngine=e,this._htmlElements={},this._parentDiv=document.createElement("div"),this._parentDiv.style.userSelect="none",this._parentDiv.style.cursor="default",this._parentDiv.style.pointerEvents="none",this._parentDiv.style.overflow="hidden",this._parentDiv.style.position="absolute",this._parentDiv.style.width="100%",this._parentDiv.style.height="100%",this._parentDiv.style.left="0%",this._parentDiv.style.top="0%"}get parentDiv(){return this._parentDiv}adjustPositions(e,t){for(let n in this._htmlElements){const s=this._htmlElements[n],{page:o,container:a,client:l,hidden:c}=this._renderingEngine.sceneTracingManager.convert3Dto2D(r.clone(s.location)),u=s.createViewerHtmlElement(this._renderingEngine.id);u&&s.update({anchor:s,htmlElement:u,page:o,container:a,client:l,scale:i.fromValues(e,t),hidden:c})}}init(){var e;null===(e=this._renderingEngine.canvas.parentNode)||void 0===e||e.appendChild(this._parentDiv)}load(e){const t=e.createViewerHtmlElement(this._renderingEngine.id);t&&(this._parentDiv.appendChild(t),this._htmlElements[e.id+"_"+e.version]=e)}removeData(e,t){const r=this._htmlElements[e+"_"+t];r&&r.getViewerHtmlElement(this._renderingEngine.id)&&(this._parentDiv.removeChild(r.getViewerHtmlElement(this._renderingEngine.id)),delete this._htmlElements[e+"_"+t])}toggleBlur(e){if(e){if(navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&navigator.userAgent.toLowerCase().indexOf("android")>-1)return;this._parentDiv.style.filter="blur(3px)"}else this._parentDiv.style.filter=""}}})),s.register("dU1UM",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BeautyRenderingManager=void 0;const o=n(s("ilwiq"));var a=s("cTTbu");s("yoicn");var l=s("bJEmL"),c=s("fDY1U"),u=s("89pKq"),h=s("7hZ3T"),d=s("cQyDg"),f=s("zIani"),p=s("lvUWS");e.exports.BeautyRenderingManager=class{constructor(e){this._renderingEngine=e,this._systemInfo=l.instance.resolve(a.SystemInfo),this._beautyRenderingActive=!1,this._beautyRenderingDurationActive=0,this._beautyRenderingTimeout=null,this._lastTime=0,this._lightSizeUVEnd=.15,this._lightSizeUVStart=.025}get beautyRenderingActive(){return this._beautyRenderingActive}set beautyRenderingActive(e){this._beautyRenderingActive=e}get beautyRenderingDurationActive(){return this._beautyRenderingDurationActive}set beautyRenderingDurationActive(e){this._beautyRenderingDurationActive=e}get beautyRenderingTimeout(){return this._beautyRenderingTimeout}set beautyRenderingTimeout(e){this._beautyRenderingTimeout=e}activateBeautyRenderShaders(){this._renderingEngine.renderer.shadowMap.type=o.PCFShadowMap,this._renderingEngine.renderer.shadowMap.needsUpdate=!0,this._renderingEngine.materialLoader.updateMaterials()}assignOutputEncoding(e){3001===e?this._effectComposer.passes.includes(this._gammaCorrectionPass)||this._effectComposer.addPass(this._gammaCorrectionPass):this._effectComposer.passes.includes(this._gammaCorrectionPass)&&this._effectComposer.removePass(this._gammaCorrectionPass)}deactivateBeautyRenderShaders(){this._beautyRenderingTimeout=null,this._beautyRenderingActive=!1,this._beautyRenderingDurationActive=0,this._renderingEngine.renderer.shadowMap.type=o.PCFSoftShadowMap,this._renderingEngine.renderer.shadowMap.needsUpdate=!0,this._renderingEngine.materialLoader.updateSoftShadow(this._lightSizeUVStart,.1),this._renderingEngine.materialLoader.updateMaterials()}init(){const e=new o.PerspectiveCamera;var t=this._renderingEngine.renderer.getSize(new o.Vector2);const r=new o.WebGLRenderTarget(t.width,t.height,{minFilter:o.LinearFilter,magFilter:o.LinearFilter,format:o.RGBAFormat,stencilBuffer:!1,type:o.FloatType});r.texture.name="EffectComposer.rt1",this._effectComposer=new c.EffectComposer(this._renderingEngine.renderer,r),this._renderPass=new u.RenderPass(this._renderingEngine.scene,e),this._ssaaPass=new h.SSAARenderPass(this._renderingEngine.scene,e,this._renderingEngine.renderer.getClearColor(new o.Color),this._renderingEngine.renderer.getClearAlpha()),this._ssaaPass.sampleLevel=2,this._effectComposer.addPass(this._ssaaPass),this._saoPass=new p.SAOPass(this._renderingEngine.scene,e,!0,!0);const i=this._saoPass.render.bind(this._saoPass);this._saoPass.render=(e,t,r,n,s)=>{const a=[];this._renderingEngine.scene.traverse((function(e){!0===e.visible&&(e instanceof o.Mesh&&e.material&&e.material instanceof o.MeshPhysicalMaterial&&e.material.transparent&&(a.push(e),e.visible=!1),(e instanceof o.Line||e instanceof o.LineLoop||e instanceof o.LineSegments)&&(a.push(e),e.visible=!1),!1===e.userData.ambientOcclusion&&(a.push(e),e.visible=!1))})),i(e,t,r,n,s);for(let e=0;e<a.length;e++)a[e].visible=!0},this._effectComposer.addPass(this._saoPass),this._saoPass.params.output=0,this._saoPass.params.saoBias=.5,this._saoPass.params.saoIntensity=.01*this._renderingEngine.ambientOcclusionIntensity,this._saoPass.params.saoScale=1,this._saoPass.params.saoKernelRadius=100,this._saoPass.params.saoMinResolution=0,this._saoPass.params.saoBlur=!0,this._saoPass.params.saoBlurRadius=8,this._saoPass.params.saoBlurStdDev=4,this._saoPass.params.saoBlurDepthCutoff=.001,this._gammaCorrectionPass=new d.ShaderPass(f.GammaCorrectionShader),this._effectComposer.addPass(this._gammaCorrectionPass),this._renderingEngine.materialLoader.updateSoftShadow(this._lightSizeUVEnd,1),this._renderingEngine.renderer.shadowMap.type=o.PCFShadowMap,this._renderingEngine.renderer.shadowMap.needsUpdate=!0,this._renderingEngine.materialLoader.updateMaterials()}render(e,t,r,i){const n=this.setShaderProperties();if(this._renderingEngine.ambientOcclusion&&this._renderingEngine.ambientOcclusionIntensity>0&&!(this._systemInfo.isIOS||this._systemInfo.isMobile||this._systemInfo.isSafari)){this._ssaaPass.clearColor=this._renderingEngine.renderer.getClearColor(new o.Color),this._ssaaPass.clearAlpha=this._renderingEngine.renderer.getClearAlpha(),this._saoPass.params.saoIntensity=this._renderingEngine.ambientOcclusionIntensity;const s=.0025*this._saoPass.params.saoIntensity;this._saoPass.params.saoIntensity=n*s,this._renderPass.camera=t,this._saoPass.camera=t,this._ssaaPass.camera=t,this._gammaCorrectionPass.setSize(r,i),this._saoPass.setSize(r,i),this._ssaaPass.setSize(r,i),this._effectComposer.setSize(r,i),this._effectComposer.render(e),this._saoPass.params.saoIntensity=s}else this._renderingEngine.renderer.render(this._renderingEngine.scene,t)}startBeautyRenderCountdown(){this._beautyRenderingTimeout=setTimeout((()=>{this._beautyRenderingActive=!0,this._beautyRenderingDurationActive=0,this.activateBeautyRenderShaders()}),this._renderingEngine.beautyRenderDelay)}stopBeautyRenderCountdown(){this.beautyRenderingTimeout&&clearTimeout(this.beautyRenderingTimeout),this.deactivateBeautyRenderShaders()}setShaderProperties(){const e=Math.min(this._beautyRenderingDurationActive,this._renderingEngine.beautyRenderBlendingDuration)/this._renderingEngine.beautyRenderBlendingDuration;if(e<.25){const t=e/.25;this._renderingEngine.materialLoader.updateSoftShadow(this._lightSizeUVStart,t)}else{const t=(e-.25)/.75;this._renderingEngine.materialLoader.updateSoftShadow(this._lightSizeUVStart+(this._lightSizeUVEnd-this._lightSizeUVStart)*t,1)}return e}}})),s.register("fDY1U",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.FullScreenQuad=e.exports.Pass=e.exports.EffectComposer=void 0;var r=s("ilwiq"),i=s("gOF5G"),n=s("cQyDg"),o=s("dqbyZ");o=s("dqbyZ");e.exports.EffectComposer=class{constructor(e,t){if(this.renderer=e,void 0===t){const i={minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:r.RGBAFormat},n=e.getSize(new r.Vector2);this._pixelRatio=e.getPixelRatio(),this._width=n.width,this._height=n.height,(t=new r.WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===i.CopyShader&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===n.ShaderPass&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new n.ShaderPass(i.CopyShader),this.clock=new r.Clock}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let t=0,i=this.passes.length;t<i;t++){const i=this.passes[t];if(!1!==i.enabled){if(i.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),i.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),i.needsSwap){if(r){const t=this.renderer.getContext(),r=this.renderer.state.buffers.stencil;r.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),r.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==o.MaskPass&&(i instanceof o.MaskPass?r=!0:i instanceof o.ClearMaskPass&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new r.Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}};e.exports.Pass=class{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}};const a=new r.OrthographicCamera(-1,1,1,-1,0,1),l=new r.BufferGeometry;l.setAttribute("position",new r.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),l.setAttribute("uv",new r.Float32BufferAttribute([0,2,0,0,2,0],2));e.exports.FullScreenQuad=class{constructor(e){this._mesh=new r.Mesh(l,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,a)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}})),s.register("gOF5G",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CopyShader=void 0;const r={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\t\t}"};e.exports.CopyShader=r})),s.register("cQyDg",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ShaderPass=void 0;var r=s("ilwiq"),i=s("8kGsu");class n extends i.Pass{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof r.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=r.UniformsUtils.clone(e.uniforms),this.material=new r.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new i.FullScreenQuad(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}e.exports.ShaderPass=n})),s.register("8kGsu",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.FullScreenQuad=e.exports.Pass=void 0;var r=s("ilwiq");e.exports.Pass=class{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}};const i=new r.OrthographicCamera(-1,1,1,-1,0,1),n=new r.BufferGeometry;n.setAttribute("position",new r.Float32BufferAttribute([-1,3,0,-1,-1,0,3,-1,0],3)),n.setAttribute("uv",new r.Float32BufferAttribute([0,2,0,0,2,0],2));e.exports.FullScreenQuad=class{constructor(e){this._mesh=new r.Mesh(n,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,i)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}})),s.register("dqbyZ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ClearMaskPass=e.exports.MaskPass=void 0;var r=s("8kGsu");class i extends r.Pass{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),n=e.state;let s,o;n.buffers.color.setMask(!1),n.buffers.depth.setMask(!1),n.buffers.color.setLocked(!0),n.buffers.depth.setLocked(!0),this.inverse?(s=0,o=1):(s=1,o=0),n.buffers.stencil.setTest(!0),n.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),n.buffers.stencil.setFunc(i.ALWAYS,s,4294967295),n.buffers.stencil.setClear(o),n.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),n.buffers.color.setLocked(!1),n.buffers.depth.setLocked(!1),n.buffers.stencil.setLocked(!1),n.buffers.stencil.setFunc(i.EQUAL,1,4294967295),n.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),n.buffers.stencil.setLocked(!0)}}e.exports.MaskPass=i;class n extends r.Pass{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}e.exports.ClearMaskPass=n})),s.register("89pKq",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RenderPass=void 0;var r=s("ilwiq"),i=s("8kGsu");class n extends i.Pass{constructor(e,t,i,n,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=n,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new r.Color}render(e,t,r){const i=e.autoClear;let n,s;e.autoClear=!1,void 0!==this.overrideMaterial&&(s=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(e.getClearColor(this._oldClearColor),n=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(this._oldClearColor,n),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=s),e.autoClear=i}}e.exports.RenderPass=n})),s.register("7hZ3T",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SSAARenderPass=void 0;var r=s("ilwiq"),i=s("8kGsu"),n=s("gOF5G");class o extends i.Pass{constructor(e,t,s,o){super(),this.scene=e,this.camera=t,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==s?s:0,this.clearAlpha=void 0!==o?o:0,this._oldClearColor=new r.Color,void 0===n.CopyShader&&console.error("THREE.SSAARenderPass relies on CopyShader");const a=n.CopyShader;this.copyUniforms=r.UniformsUtils.clone(a.uniforms),this.copyMaterial=new r.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:r.AdditiveBlending,depthTest:!1,depthWrite:!1}),this.fsQuad=new i.FullScreenQuad(this.copyMaterial)}dispose(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)}setSize(e,t){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,t)}render(e,t,i){this.sampleRenderTarget||(this.sampleRenderTarget=new r.WebGLRenderTarget(i.width,i.height,{minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:r.RGBAFormat}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");const n=a[Math.max(0,Math.min(this.sampleLevel,5))],s=e.autoClear;e.autoClear=!1,e.getClearColor(this._oldClearColor);const o=e.getClearAlpha(),l=1/n.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;const c={fullWidth:i.width,fullHeight:i.height,offsetX:0,offsetY:0,width:i.width,height:i.height},u=Object.assign({},this.camera.view);u.enabled&&Object.assign(c,u);for(let r=0;r<n.length;r++){const i=n[r];this.camera.setViewOffset&&this.camera.setViewOffset(c.fullWidth,c.fullHeight,c.offsetX+.0625*i[0],c.offsetY+.0625*i[1],c.width,c.height);let s=l;if(this.unbiased){s+=.03125*((r+.5)/n.length-.5)}this.copyUniforms.opacity.value=s,e.setClearColor(this.clearColor,this.clearAlpha),e.setRenderTarget(this.sampleRenderTarget),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.renderToScreen?null:t),0===r&&(e.setClearColor(0,0),e.clear()),this.fsQuad.render(e)}this.camera.setViewOffset&&u.enabled?this.camera.setViewOffset(u.fullWidth,u.fullHeight,u.offsetX,u.offsetY,u.width,u.height):this.camera.clearViewOffset&&this.camera.clearViewOffset(),e.autoClear=s,e.setClearColor(this._oldClearColor,o)}}e.exports.SSAARenderPass=o;const a=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]]})),s.register("zIani",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GammaCorrectionShader=void 0;const r={uniforms:{tDiffuse:{value:null}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 tex = texture2D( tDiffuse, vUv );\n\n\t\t\tgl_FragColor = LinearTosRGB( tex );\n\n\t\t}"};e.exports.GammaCorrectionShader=r})),s.register("lvUWS",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SAOPass=void 0;var r=s("ilwiq"),i=s("8kGsu"),n=s("h5RFw"),o=s("h0LF4"),a=(o=s("h0LF4"),s("gOF5G")),l=s("9VXAe");class c extends i.Pass{constructor(e,t,s,c,u){let h;super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==s&&s,this.supportsNormalTexture=void 0!==c&&c,this.originalClearColor=new r.Color,this._oldClearColor=new r.Color,this.oldClearAlpha=1,this.params={output:0,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==u?new r.Vector2(u.x,u.y):new r.Vector2(256,256),this.saoRenderTarget=new r.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:r.NearestFilter,magFilter:r.NearestFilter,format:r.RGBAFormat,type:r.FloatType}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new r.WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:r.NearestFilter,magFilter:r.NearestFilter,format:r.RGBAFormat}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension&&(h=new r.DepthTexture,h.type=r.UnsignedShortType,this.beautyRenderTarget.depthTexture=h,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new r.MeshDepthMaterial,this.depthMaterial.depthPacking=r.RGBADepthPacking,this.depthMaterial.blending=r.NoBlending,this.depthMaterial.side=r.DoubleSide,this.normalMaterial=new r.MeshNormalMaterial,this.normalMaterial.blending=r.NoBlending,this.normalMaterial.side=r.DoubleSide,void 0===n.SAOShader&&console.error("THREE.SAOPass relies on SAOShader"),this.saoMaterial=new r.ShaderMaterial({defines:Object.assign({},n.SAOShader.defines),fragmentShader:n.SAOShader.fragmentShader,vertexShader:n.SAOShader.vertexShader,uniforms:r.UniformsUtils.clone(n.SAOShader.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?h:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=r.NoBlending,void 0===o.DepthLimitedBlurShader&&console.error("THREE.SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new r.ShaderMaterial({uniforms:r.UniformsUtils.clone(o.DepthLimitedBlurShader.uniforms),defines:Object.assign({},o.DepthLimitedBlurShader.defines),vertexShader:o.DepthLimitedBlurShader.vertexShader,fragmentShader:o.DepthLimitedBlurShader.fragmentShader}),this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?h:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=r.NoBlending,this.hBlurMaterial=new r.ShaderMaterial({uniforms:r.UniformsUtils.clone(o.DepthLimitedBlurShader.uniforms),defines:Object.assign({},o.DepthLimitedBlurShader.defines),vertexShader:o.DepthLimitedBlurShader.vertexShader,fragmentShader:o.DepthLimitedBlurShader.fragmentShader}),this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?h:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=r.NoBlending,void 0===a.CopyShader&&console.error("THREE.SAOPass relies on CopyShader"),this.materialCopy=new r.ShaderMaterial({uniforms:r.UniformsUtils.clone(a.CopyShader.uniforms),vertexShader:a.CopyShader.vertexShader,fragmentShader:a.CopyShader.fragmentShader,blending:r.NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=r.CustomBlending,this.materialCopy.blendSrc=r.DstColorFactor,this.materialCopy.blendDst=r.ZeroFactor,this.materialCopy.blendEquation=r.AddEquation,this.materialCopy.blendSrcAlpha=r.DstAlphaFactor,this.materialCopy.blendDstAlpha=r.ZeroFactor,this.materialCopy.blendEquationAlpha=r.AddEquation,void 0===l.UnpackDepthRGBAShader&&console.error("THREE.SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new r.ShaderMaterial({uniforms:r.UniformsUtils.clone(l.UnpackDepthRGBAShader.uniforms),vertexShader:l.UnpackDepthRGBAShader.vertexShader,fragmentShader:l.UnpackDepthRGBAShader.fragmentShader,blending:r.NoBlending}),this.fsQuad=new i.FullScreenQuad(null)}render(e,t,i){if(this.renderToScreen&&(this.materialCopy.blending=r.NoBlending,this.materialCopy.uniforms.tDiffuse.value=i.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),1===this.params.output)return;e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const n=e.autoClear;e.autoClear=!1,e.setRenderTarget(this.depthRenderTarget),e.clear(),this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;const s=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);if(this.vBlurMaterial.uniforms.depthCutoff.value=s,this.hBlurMaterial.uniforms.depthCutoff.value=s,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),this.prevStdDev===this.params.saoBlurStdDev&&this.prevNumSamples===this.params.saoBlurRadius||(o.BlurShaderUtils.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new r.Vector2(0,1)),o.BlurShaderUtils.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new r.Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),!this.supportsDepthTextureExtension){const t=this.scene.background;this.scene.background=null,this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,16777215,1),this.scene.background=t}if(this.supportsNormalTexture){const t=this.scene.background;this.scene.background=null,this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.scene.background=t}this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));let a=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,a=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),0===this.params.output?a.blending=r.CustomBlending:a.blending=r.NoBlending,this.renderPass(e,a,this.renderToScreen?null:i),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=n}renderPass(e,t,r,i,n){e.getClearColor(this.originalClearColor);const s=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,null!=i&&(e.setClearColor(i),e.setClearAlpha(n||0),e.clear()),this.fsQuad.material=t,this.fsQuad.render(e),e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(s)}renderOverride(e,t,r,i,n){e.getClearColor(this.originalClearColor);const s=e.getClearAlpha(),o=e.autoClear;e.setRenderTarget(r),e.autoClear=!1,i=t.clearColor||i,n=t.clearAlpha||n,null!=i&&(e.setClearColor(i),e.setClearAlpha(n||0),e.clear()),this.scene.overrideMaterial=t,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=o,e.setClearColor(this.originalClearColor),e.setClearAlpha(s)}setSize(e,t){this.beautyRenderTarget.setSize(e,t),this.saoRenderTarget.setSize(e,t),this.blurIntermediateRenderTarget.setSize(e,t),this.normalRenderTarget.setSize(e,t),this.depthRenderTarget.setSize(e,t),this.saoMaterial.uniforms.size.value.set(e,t),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.copy(this.camera.projectionMatrixInverse),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,t),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,t),this.hBlurMaterial.needsUpdate=!0}}e.exports.SAOPass=c,c.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4}})),s.register("h5RFw",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SAOShader=void 0;var r=s("ilwiq");const i={defines:{NUM_SAMPLES:8,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new r.Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new r.Matrix4},cameraInverseProjectionMatrix:{value:new r.Matrix4},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\t#if DIFFUSE_TEXTURE == 1\n\t\tuniform sampler2D tDiffuse;\n\t\t#endif\n\n\t\tuniform sampler2D tDepth;\n\n\t\t#if NORMAL_TEXTURE == 1\n\t\tuniform sampler2D tNormal;\n\t\t#endif\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform mat4 cameraProjectionMatrix;\n\t\tuniform mat4 cameraInverseProjectionMatrix;\n\n\t\tuniform float scale;\n\t\tuniform float intensity;\n\t\tuniform float kernelRadius;\n\t\tuniform vec2 size;\n\n\t\t// RGBA depth\n\n\t\t#include <common>\n\t\t#include <packing>\n\n\t\tvec4 getDefaultColor( const in vec2 screenPosition ) {\n\t\t\t#if DIFFUSE_TEXTURE == 1\n\t\t\treturn texture2D( tDiffuse, vUv );\n\t\t\t#else\n\t\t\treturn vec4( 1.0 );\n\t\t\t#endif\n\t\t}\n\n\t\tvec3 getViewPosition(const in vec2 screenPosition, const in float depth, const in float viewZ) {\n\t\t\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];\n\t\t\tvec4 clipPosition = vec4((vec3(screenPosition, depth) - 0.5) * 2.0, 1.0);\n\t\t\tclipPosition *= clipW; // unprojection\n\t\t\n\t\t\treturn (cameraInverseProjectionMatrix * clipPosition).xyz;\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\t\t\n\t\tfloat getOcclusion(const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition) {\n\t\t\tvec3 viewDelta = sampleViewPosition - centerViewPosition;\n\t\t\tfloat viewDistance = length(viewDelta);\n\t\t\tfloat scaledScreenDistance = scale * viewDistance;\n\t\t\treturn max(0.0, (dot(centerViewNormal, viewDelta))/scaledScreenDistance)/(1.0 + pow2(scaledScreenDistance));\n\t\t}\n\t\t\n\t\tfloat getAmbientOcclusion(const in vec3 centerViewPosition) {\n\t\t\tvec3 centerViewNormal = unpackRGBToNormal(texture2D(tNormal, vUv).xyz);\n\t\t\n\t\t\tfloat angle = rand(vUv) * PI2;\n\t\t\tvec2 radius = vec2(kernelRadius * (1.0/float(NUM_SAMPLES)))/size;\n\t\t\tvec2 radiusStep = radius;\n\t\t\tfloat occlusionSum = 0.0;\n\t\t\tfloat weightSum = 0.0;\n\t\t\tfloat angleStep = PI2 * 3.0/float(NUM_SAMPLES);\n\t\t\n\t\t\tfor(int i = 0; i < NUM_SAMPLES; i ++) {\n\t\t\t\tvec2 sampleUv = vUv + vec2(cos(angle), sin(angle)) * radius;\n\t\t\t\tradius += radiusStep;\n\t\t\t\tangle += PI2 * 3.0/float(NUM_SAMPLES);\n\t\t\n\t\t\t\tfloat sampleDepth = unpackRGBAToDepth(texture2D(tDepth, sampleUv));\n\t\t\t\tif(sampleDepth >= (1.0 - EPSILON)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\n\t\t\t\tfloat sampleViewZ = getViewZ(sampleDepth);\n\t\t\t\tvec3 sampleViewPosition = getViewPosition(sampleUv, sampleDepth, sampleViewZ);\n\t\t\t\tocclusionSum += getOcclusion(centerViewPosition, centerViewNormal, sampleViewPosition);\n\t\t\t\tweightSum += 1.0;\n\t\t\t}\n\t\t\n\t\t\tif(weightSum == 0.0) discard;\n\t\t\n\t\t\treturn occlusionSum * (intensity/weightSum);\n\t\t}\n\n\t\tvoid main() {\n\t\t\tfloat centerDepth = unpackRGBAToDepth(texture2D(tDepth, vUv));\n\t\t\tif( centerDepth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\tdiscard;\n\t\t\t}\n\n\t\t\tfloat centerViewZ = getViewZ( centerDepth );\n\t\t\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );\n\t\t\tgl_FragColor = vec4(viewPosition, 1);\n\n\t\t\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );\n\n\t\t\tgl_FragColor = getDefaultColor( vUv );\n\t\t\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;\n\t\t}"};e.exports.SAOShader=i})),s.register("h0LF4",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BlurShaderUtils=e.exports.DepthLimitedBlurShader=void 0;var r=s("ilwiq");const i={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new r.Vector2(512,512)},sampleUvOffsets:{value:[new r.Vector2(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:"\n\n\t\t#include <common>\n\n\t\tuniform vec2 size;\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vInvSize;\n\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tvInvSize = 1.0 / size;\n\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t}",fragmentShader:"\n\n\t\t#include <common>\n\t\t#include <packing>\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform sampler2D tDepth;\n\n\t\tuniform float cameraNear;\n\t\tuniform float cameraFar;\n\t\tuniform float depthCutoff;\n\n\t\tuniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];\n\t\tuniform float sampleWeights[ KERNEL_RADIUS + 1 ];\n\n\t\tvarying vec2 vUv;\n\t\tvarying vec2 vInvSize;\n\n\t\tfloat getDepth( const in vec2 screenPosition ) {\n\t\t\t#if DEPTH_PACKING == 1\n\t\t\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );\n\t\t\t#else\n\t\t\treturn texture2D( tDepth, screenPosition ).x;\n\t\t\t#endif\n\t\t}\n\n\t\tfloat getViewZ( const in float depth ) {\n\t\t\t#if PERSPECTIVE_CAMERA == 1\n\t\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#else\n\t\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );\n\t\t\t#endif\n\t\t}\n\n\t\tvoid main() {\n\t\t\tfloat depth = getDepth( vUv );\n\t\t\tif( depth >= ( 1.0 - EPSILON ) ) {\n\t\t\t\tdiscard;\n\t\t\t}\n\n\t\t\tfloat centerViewZ = -getViewZ( depth );\n\t\t\tbool rBreak = false, lBreak = false;\n\n\t\t\tfloat weightSum = sampleWeights[0];\n\t\t\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;\n\n\t\t\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {\n\n\t\t\t\tfloat sampleWeight = sampleWeights[i];\n\t\t\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;\n\n\t\t\t\tvec2 sampleUv = vUv + sampleUvOffset;\n\t\t\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );\n\n\t\t\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;\n\n\t\t\t\tif( ! rBreak ) {\n\t\t\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\n\t\t\t\t\tweightSum += sampleWeight;\n\t\t\t\t}\n\n\t\t\t\tsampleUv = vUv - sampleUvOffset;\n\t\t\t\tviewZ = -getViewZ( getDepth( sampleUv ) );\n\n\t\t\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;\n\n\t\t\t\tif( ! lBreak ) {\n\t\t\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;\n\t\t\t\t\tweightSum += sampleWeight;\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tgl_FragColor = diffuseSum / weightSum;\n\t\t}"};e.exports.DepthLimitedBlurShader=i;const n={createSampleWeights:function(e,t){const r=[];for(let i=0;i<=e;i++)r.push(o(i,t));return r},createSampleOffsets:function(e,t){const r=[];for(let i=0;i<=e;i++)r.push(t.clone().multiplyScalar(i));return r},configure:function(e,t,r,i){e.defines.KERNEL_RADIUS=t,e.uniforms.sampleUvOffsets.value=n.createSampleOffsets(t,i),e.uniforms.sampleWeights.value=n.createSampleWeights(t,r),e.needsUpdate=!0}};function o(e,t){return Math.exp(-e*e/(t*t*2))/(Math.sqrt(2*Math.PI)*t)}e.exports.BlurShaderUtils=n})),s.register("9VXAe",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.UnpackDepthRGBAShader=void 0;const r={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\t#include <packing>\n\n\t\tvoid main() {\n\n\t\t\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );\n\t\t\tgl_FragColor = vec4( vec3( depth ), opacity );\n\n\t\t}"};e.exports.UnpackDepthRGBAShader=r})),s.register("1qIf2",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.EnvironmentGeometryManager=void 0;const o=n(s("ilwiq"));var a=s("12eGO"),l=s("eIStk"),c=s("6UMiq"),u=s("cTTbu"),h=s("hrRY8");s("yoicn");var d=s("bJEmL"),f=s("g1ukU");e.exports.EnvironmentGeometryManager=class{constructor(e){this._renderingEngine=e,this._converter=d.instance.resolve(u.Converter),this._eventEngine=d.instance.resolve(u.EventEngine),this._groundPlaneColor="#d3d3d3ff",this._gridColor="#44444426",this._initialized=!1,this._eventEngine.addListener(u.EVENTTYPE.SESSION.SESSION_CUSTOMIZED,(e=>{const t=new c.Box(this._renderingEngine.sceneTreeManager.boundingBox.min,this._renderingEngine.sceneTreeManager.boundingBox.max);if(!(0===t.min[0]&&0===t.min[1]&&0===t.min[2]&&0===t.max[0]&&0===t.max[1]&&0===t.max[2]||t.isEmpty()))if(this._initialized){let e=.005,r=t.boundingSphere;this._grid&&this._grid.position.set(r.center[0],r.center[1],t.min[2]-e),this._groundPlane&&this._groundPlane.position.set(r.center[0],r.center[1],t.min[2]-e)}else this.changeSceneExtents(t)}))}get gridColor(){return this._gridColor}set gridColor(e){this._gridColor=e,this._grid.material.opacity=this._gridColor.length<=8?.15:this._converter.toAlpha(this._gridColor),this._grid.material.transparent=1!==this._grid.material.opacity,this._grid.material.color=new o.Color(this._converter.toThreeJsColorInput(this._gridColor)),this._grid.material.needsUpdate=!0}get groundPlaneColor(){return this._groundPlaneColor}set groundPlaneColor(e){this._groundPlaneColor=e,this.assignGroundPlaneColor(e)}get grid(){return this._grid}get groundPlane(){return this._groundPlane}assignGroundPlaneColor(e){this._groundPlane.material.opacity=this._converter.toAlpha(e),this._groundPlane.material.transparent=1!==this._groundPlane.material.opacity,this._groundPlane.material.depthWrite=!this._groundPlane.material.transparent,this._groundPlane.material.color=new o.Color(this._converter.toThreeJsColorInput(e)),this._groundPlane.material.needsUpdate=!0}assignGroundPlaneEnvironmentIntensity(e){this._groundPlane.material.envMapIntensity=e,this._groundPlane.material.needsUpdate=!0}changeSceneExtents(e){if(0===e.min[0]&&0===e.min[1]&&0===e.min[2]&&0===e.max[0]&&0===e.max[1]&&0===e.max[2]||e.isEmpty())return;this._initialized=!0;let t=l.distance(e.min,e.max),r=.1,i=1;if(t>1){let e=Math.floor(t).toString(),n=Math.pow(10,e.length-1);i=Math.max(Math.ceil(t/n)*n,1),n/=10,r=i/n}else if(0!==t){let e=1-Math.floor(Math.log(t)/Math.log(10))-2,n=t.toFixed(e+1),s=parseInt(n.substr(n.length-1))+1,o="0.";for(let t=0;t<e;++t)o+="0";i=parseFloat(o+s),r=10*s}this._gridObject.remove(this._grid),this._grid=new o.GridHelper(2*i,r),this._grid.material.opacity=this._gridColor.length<=8?.15:this._converter.toAlpha(this._gridColor),this._grid.material.transparent=1!==this._grid.material.opacity,this._grid.material.color=new o.Color(this._converter.toThreeJsColorInput(this._gridColor)),this._grid.rotateX(Math.PI/2),this._grid.visible=this._renderingEngine.gridVisibility,this._gridObject.add(this._grid),this._groundPlane.geometry=new o.PlaneGeometry(2*i,2*i,2,2);let n=e.boundingSphere;this._grid.position.set(n.center[0],n.center[1],e.min[2]-.005),this._groundPlane.position.set(n.center[0],n.center[1],e.min[2]-.005)}init(){this._environmentGeometryObject=new h.SDNode("environmentGeometry",""),this._renderingEngine.sceneTreeManager.scene.add(this._environmentGeometryObject),this._gridObject=new f.SDData("grid",""),this._grid=new o.GridHelper,this._grid.material.opacity=this._gridColor.length<=8?.15:this._converter.toAlpha(this._gridColor),this._grid.material.transparent=1!==this._grid.material.opacity,this._grid.material.color=new o.Color(this._converter.toThreeJsColorInput(this._gridColor)),this._grid.rotateX(Math.PI/2),this._grid.visible=this._renderingEngine.gridVisibility,this._gridObject.add(this._grid),this._gridObject.userData.ambientOcclusion=!1,this._environmentGeometryObject.add(this._gridObject),this._groundPlaneObject=new f.SDData("grid","");let e=new a.MaterialStandardData;e.color=this._groundPlaneColor,e.side=a.MATERIAL_SIDE.FRONT,e.opacity=this._converter.toAlpha(this._groundPlaneColor),e.roughness=1,e.metalness=0,this._groundPlane=new o.Mesh(new o.PlaneGeometry,this._renderingEngine.materialLoader.load(e)),this._groundPlane.receiveShadow=!0,this._groundPlane.visible=this._renderingEngine.groundPlaneVisibility,this._groundPlaneObject.add(this._groundPlane),this._groundPlaneObject.userData.ambientOcclusion=!1,this._environmentGeometryObject.add(this._groundPlaneObject);this._grid.position.set(0,0,-.005),this._groundPlane.position.set(0,0,-.005)}}})),s.register("aMxoQ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SceneTracingManager=void 0;var r=s("eIStk"),i=s("6BoVD"),n=s("eYU63"),o=s("12eGO");s("yoicn");var a=s("bJEmL"),l=s("cTTbu");e.exports.SceneTracingManager=class{constructor(e){this._renderingEngine=e,this._logger=a.instance.resolve(l.Logger),this._tree=a.instance.resolve(n.Tree)}convert3Dto2D(e){const t=this._renderingEngine.canvas.getBoundingClientRect(),n=this._renderingEngine.canvas.width,s=this._renderingEngine.canvas.height,o=this._renderingEngine.cameraEngine.camera;if(!o){const e=new l.ShapeDiverViewerGeneralError("SceneTracingManager.convert3Dto2D: No camera is defined for this viewer.");throw this._logger.handleError(l.LOGGINGTOPIC.SESSION,"SceneTracingManager.convert3Dto2D",e)}const a=r.normalize(r.create(),r.subtract(r.create(),e,o.position)),c=this.trace(o.position,a),u=o.project(r.clone(e));return u[0]=u[0]*(n/2)+n/2,u[1]=-u[1]*(s/2)+s/2,u[0]=u[0]/devicePixelRatio,u[1]=u[1]/devicePixelRatio,{hidden:c.length>1&&c[0].distance>0&&c[0].distance<1/0&&c[0].distance<r.distance(o.position,e),container:i.clone(u),client:i.fromValues(u[0]+t.left,u[1]+t.top),page:i.fromValues(u[0]+t.left+window.pageXOffset,u[1]+t.top+window.pageYOffset)}}init(){}trace(e,t,r=this._tree.root){const i=[],n=r=>{for(let n=0;n<r.data.length;n++)if(r.data[n]instanceof o.GeometryData){const s=r.data[n].intersect(e,t);s&&i.push({distance:s,data:r.data[n]})}for(let e=0;e<r.children.length;e++)n(r.children[e])};return n(r),i.sort(((e,t)=>e.distance-t.distance)),i}}})),s.register("3Bg06",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.CameraManager=void 0;const o=n(s("ilwiq"));var a=s("eIStk"),l=s("dk8Lz");e.exports.CameraManager=class{constructor(e){this._renderingEngine=e,this._orthographicCameraThree=new o.OrthographicCamera(1,1,1,1,1,1),this._perspectiveCameraThree=new o.PerspectiveCamera(1,1,1,1)}updateCamera(e,t){var r;return"perspective"===(null===(r=this._renderingEngine.cameraEngine.camera)||void 0===r?void 0:r.type)&&(this._renderingEngine.cameraEngine.camera.aspect=t),this._renderingEngine.cameraEngine.camera.update(e)}load(e,t){let r=t.children[0]instanceof o.Camera?t.children[0]:null;if(e instanceof l.PerspectiveCamera){r||(r=new o.PerspectiveCamera,t.add(r));const i=e,n=r;n.up.set(0,0,1),i.useNodeData&&(n.fov=i.fov,n.aspect=i.aspect,n.far=i.far,n.near=i.near,n.updateProjectionMatrix())}else{r||(r=new o.OrthographicCamera(0,0,0,0),t.add(r));const i=e,n=r;n.up.set(i.up[0],i.up[1],i.up[2]),i.useNodeData&&(n.left=i.left,n.bottom=i.bottom,n.right=i.right,n.top=i.top,n.near=i.near,n.far=i.far,n.updateProjectionMatrix())}}adjustCamera(e){let t;const r=this._renderingEngine.cameraEngine.camera;if(r.useNodeData){t=r.node.transformedNodes[this._renderingEngine.id].children[0].children[0]}else if(this._renderingEngine.cameraEngine.camera.type===l.CAMERATYPE.ORTHOGRAPHIC){const r=this._renderingEngine.cameraEngine.camera,i=a.distance(r.position,r.target)/2;this._orthographicCameraThree.up.set(r.up[0],r.up[1],r.up[2]),this._orthographicCameraThree.left=r.left=-i*e,this._orthographicCameraThree.bottom=r.bottom=-i,this._orthographicCameraThree.right=r.right=i*e,this._orthographicCameraThree.top=r.top=i,this._orthographicCameraThree.near=r.near=.01,this._orthographicCameraThree.far=r.far=100*i,this._orthographicCameraThree.position.set(r.position[0],r.position[1],r.position[2]),this._orthographicCameraThree.lookAt(r.target[0],r.target[1],r.target[2]),this._orthographicCameraThree.updateProjectionMatrix(),t=this._orthographicCameraThree}else{const r=this._renderingEngine.cameraEngine.camera;this._perspectiveCameraThree.up.set(0,0,1);const i=this._renderingEngine.cameraEngine.camera.fov,n=this._renderingEngine.sceneTreeManager.boundingBox.boundingSphere,s=n.radius>0?n.radius:2;this._perspectiveCameraThree.fov=r.fov=i,this._perspectiveCameraThree.aspect=r.aspect=e,this._perspectiveCameraThree.far=r.far=i<10?1e4*i*s:100*s,this._perspectiveCameraThree.near=r.near=i<10?1*i*s:.01*s,this._perspectiveCameraThree.position.set(r.position[0],r.position[1],r.position[2]),this._perspectiveCameraThree.lookAt(r.target[0],r.target[1],r.target[2]),this._perspectiveCameraThree.updateProjectionMatrix(),t=this._perspectiveCameraThree}return t}init(){this._orthographicCameraThree.up.set(0,1,0)}}})),s.register("8nFhy",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AnimationManager=void 0;var r=s("cTTbu");s("yoicn");var i=s("bJEmL"),n=s("3iqbd"),o=s("k1dpP"),a=s("jxhwV"),l=s("eIStk"),c=s("12eGO");e.exports.AnimationManager=class{constructor(e){this._renderingEngine=e,this._systemInfo=i.instance.resolve(r.SystemInfo)}init(){}update(e){const t=this._renderingEngine.animations;let r=!1;for(let i=0;i<t.length;i++){const s=t[i];if(-1===s.animationTime&&(r=!0,s.animationTime=0),!s.animate)continue;r=!0,s.animationTime+=e,s.animationTime/1e3>s.duration&&(s.repeat?s.startAnimation():s.stopAnimation());const u=s.duration,h=s.animationTime/1e3%u;for(let e=0;e<s.tracks.length;e++){const t=s.tracks[e],r=s.id+"_"+e;for(let e=1;e<t.times.length;e++)if(h<t.times[e]&&h>t.times[e-1]){const i=t.node.transformations.filter((e=>e.id===r));t.node.transformations=t.node.transformations.filter((e=>!i.includes(e)));const s=(h-t.times[e-1])/(t.times[e]-t.times[e-1]);let u=t.node.transformations.find((e=>"gltf_matrix_translation"===e.id));u||(u={id:"gltf_matrix_translation",matrix:n.create()},t.node.transformations.push(u));let d=t.node.transformations.find((e=>"gltf_matrix_rotation"===e.id));d||(d={id:"gltf_matrix_rotation",matrix:n.create()},t.node.transformations.push(d));let f=t.node.transformations.find((e=>"gltf_matrix_scale"===e.id));if(f||(f={id:"gltf_matrix_scale",matrix:n.create()},t.node.transformations.push(f)),"rotation"===t.path){let r;r="step"===t.interpolation?o.fromValues(t.values[4*(e-1)+0],t.values[4*(e-1)+1],t.values[4*(e-1)+2],t.values[4*(e-1)+3]):o.slerp(a.create(),a.fromValues(t.values[4*(e-1)+0],t.values[4*(e-1)+1],t.values[4*(e-1)+2],t.values[4*(e-1)+3]),a.fromValues(t.values[4*e+0],t.values[4*e+1],t.values[4*e+2],t.values[4*e+3]),s),d.matrix=n.fromQuat(n.create(),r)}else if("translation"===t.path){let r;r="step"===t.interpolation?l.fromValues(t.values[3*(e-1)+0],t.values[3*(e-1)+1],t.values[3*(e-1)+2]):l.lerp(l.create(),l.fromValues(t.values[3*(e-1)+0],t.values[3*(e-1)+1],t.values[3*(e-1)+2]),l.fromValues(t.values[3*e+0],t.values[3*e+1],t.values[3*e+2]),s),u.matrix=n.fromTranslation(n.create(),r)}else if("scale"===t.path){let r;r="step"===t.interpolation?l.fromValues(t.values[3*(e-1)+0],t.values[3*(e-1)+1],t.values[3*(e-1)+2]):l.lerp(l.create(),l.fromValues(t.values[3*(e-1)+0],t.values[3*(e-1)+1],t.values[3*(e-1)+2]),l.fromValues(t.values[3*e+0],t.values[3*e+1],t.values[3*e+2]),s),f.matrix=n.fromScaling(n.create(),r)}else if("weights"===t.path){let r=[];const i=t.values.length/t.times.length;if("step"===t.interpolation)for(let n=0;n<i;n++)r.push(t.values[(e-1)*i+n]);else for(let n=0;n<i;n++)r.push(t.values[(e-1)*i+n]*(1-s)+s*t.values[(e-1)*i+n]);const n=e=>{for(let t=0;t<e.data.length;t++)e.data[t]instanceof c.GeometryData&&e.data[t].morphWeights.length===i&&(e.data[t].morphWeights=r);for(let t=0;t<e.children.length;t++)n(e.children[t])};n(t.node)}break}}}return r}}})),s.register("dxpc0",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SessionOutputData=e.exports.SessionData=e.exports.Session=void 0;var r=s("gocl1");Object.defineProperty(e.exports,"Session",{enumerable:!0,get:function(){return r.Session}});var i=s("irHKn");Object.defineProperty(e.exports,"SessionOutputData",{enumerable:!0,get:function(){return i.SessionOutputData}});var n=s("7n1Em");Object.defineProperty(e.exports,"SessionData",{enumerable:!0,get:function(){return n.SessionData}})})),s.register("gocl1",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Session=void 0,s("yoicn");var i=s("bJEmL"),n=s("cTTbu"),o=s("fTT0m"),a=s("lvmE8"),l=s("jscMs"),c=s("7n1Em"),u=s("l1HmL");e.exports.Session=class{constructor(e){this._converter=i.instance.resolve(n.Converter),this._exports={},this._httpClient=i.instance.resolve(n.HttpClient),this._logger=i.instance.resolve(n.Logger),this._outputs={},this._outputsFreeze={},this._parameterValues={},this._parameters={},this._performanceEvaluator=i.instance.resolve(n.PerformanceEvaluator),this._sessionEngineId=i.instance.resolve(n.UuidGenerator).create(),this._closed=!1,this._headers={"X-ShapeDiver-Origin":i.instance.resolve(n.SystemInfo).origin,"X-ShapeDiver-SessionEngineId":this._sessionEngineId,"X-ShapeDiver-BuildVersion":"","X-ShapeDiver-BuildDate":""},this._initialized=!1,this._retryCounter=0,this._dataCache={},this._id=e.id,this._ticket=e.ticket,this._modelViewUrl=e.modelViewUrl,this._closeOnFailure=e.closeOnFailure,this._bearerToken=e.bearerToken,this._headers["X-ShapeDiver-BuildDate"]=e.buildDate,this._headers["X-ShapeDiver-BuildVersion"]=e.buildVersion,this._outputLoader=new a.OutputLoader,this._sdk=u.create(this._modelViewUrl,this._bearerToken),this._sdk.setConfigurationValue(u.ShapeDiverSdkConfigType.REQUEST_HEADERS,this._headers)}get bearerToken(){return this._bearerToken}set bearerToken(e){this._bearerToken=e,this._sdk.setConfigurationValue(u.ShapeDiverSdkConfigType.JWT_TOKEN,e)}get canUploadGLTF(){try{return this.checkAvailability("gltf-upload"),!0}catch(e){return!1}}get exports(){return this._exports}get id(){return this._id}get initialized(){return this._initialized}get modelViewUrl(){return this._modelViewUrl}get outputs(){return this._outputs}get outputsFreeze(){return this._outputsFreeze}get parameterValues(){return this._parameterValues}get parameters(){return this._parameters}set refreshBearerToken(e){this._refreshBearerToken=e}get ticket(){return this._ticket}get viewerSettings(){return this._viewerSettings}handleError(e,t,i,s=!1){return r(this,void 0,void 0,(function*(){if(!(i instanceof u.ShapeDiverResponseError))throw this._logger.handleError(e,t,i);if(i.error===u.ShapeDiverResponseErrorType.SESSION_GONE_ERROR){if(this._logger.warn(e,"The session has been closed, trying to re-initialize."),!(this._retryCounter<3)){this._logger.warn(n.LOGGINGTOPIC.SESSION,"Tried to retry the connect multiple times, bearer token still not valid. Closing Session.");try{yield this._closeOnFailure()}catch(e){}throw this._logger.handleError(e,t,i)}this._retryCounter=s?this._retryCounter+1:1;try{this._initialized=!1,yield this.init(this.parameterValues,!0)}catch(r){if(r instanceof n.ShapeDiverViewerError||r instanceof u.ShapeDiverError)throw r;throw this._logger.handleError(e,t,r)}}else{if(i.error!==u.ShapeDiverResponseErrorType.JWT_VALIDATION_ERROR)throw this._logger.handleError(e,t,i);if(!(this._retryCounter<3)){this._logger.warn(n.LOGGINGTOPIC.SESSION,"Tried to retry the connect multiple times, bearer token still not valid. Closing Session.");try{yield this._closeOnFailure()}catch(e){}throw this._logger.handleError(e,t,i)}if(!this._refreshBearerToken){this._logger.warn(n.LOGGINGTOPIC.SESSION,"No retry possible, no new bearer token was supplied. Closing Session.");try{yield this._closeOnFailure()}catch(e){}throw this._logger.handleError(e,t,i)}this.bearerToken=yield this._refreshBearerToken(),this._retryCounter=s?this._retryCounter+1:1,this._logger.warn(n.LOGGINGTOPIC.SESSION,"Re-trying with new bearer token.")}}))}close(e=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("close");try{return yield this._sdk.session.close(this._sessionId),this._closed=!0,!0}catch(t){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.close",t,e),yield this.close(!0)}}))}customize(e){return r(this,void 0,void 0,(function*(){return this.customizeSession(this._parameterValues,e)}))}init(e,t=!1){var i,s;return r(this,void 0,void 0,(function*(){if(!0===this._initialized){const e=new n.ShapeDiverViewerSessionError("Session.init: Session already initialized.");throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.init",e)}try{if(this._performanceEvaluator.startSection("sessionResponse"),this._responseDto=yield this._sdk.session.init(this._ticket,e),this._performanceEvaluator.endSection("sessionResponse"),this._viewerSettings=null===(i=this._responseDto.viewer)||void 0===i?void 0:i.config,this._sessionId=this._responseDto.sessionId,this._modelId=null===(s=this._responseDto.model)||void 0===s?void 0:s.id,!this._sessionId)throw new n.ShapeDiverViewerSessionError("Session.init: Initialization of session failed. ResponseDto did not have a sessionId.");if(!this._modelId)throw new n.ShapeDiverViewerSessionError("Session.init: Initialization of session failed. ResponseDto did not have a model.id.");this.updateResponseDto(this._responseDto),this._initialized=!0}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.init",r,t),yield this.init(e,!0)}}))}loadOutputs(e=(()=>!1),t=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability();const r=Object.assign({},this._outputs),i=Object.assign({},this._outputsFreeze);try{const e=yield this._outputLoader.loadOutputs(this._responseDto,r,i);return e.data.push(new c.SessionData(this._responseDto)),e}catch(i){if(!(i instanceof o.OutputDelayException))return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.loadOutputs",i,t),yield this.loadOutputs(e,!0);if(yield this.timeout(i.delay),e())return new l.SessionTreeNode;let s={};for(let e in r)s[e]=r[e].version;try{const t=yield this._sdk.output.getCache(this._sessionId,s);return e()?new l.SessionTreeNode:(this.updateResponseDto(t),yield this.loadOutputs(e))}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.loadOutputs",r,t),yield this.loadOutputs(e,!0)}}}))}requestExport(e,t,i,s=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("export");try{const r=yield this._sdk.utils.submitAndWaitForExport(this._sdk,this._sessionId,{exports:{id:e},parameters:t},i);return this.updateResponseDto(r),this.exports[e]}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.requestExport",r,s),yield this.requestExport(e,t,i,!0)}}))}saveDefaultParameters(e=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("defaultparam",!0);try{return yield this._sdk.model.setDefaultParams(this._modelId,this._parameterValues),!0}catch(t){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.saveDefaultParameters",t,e),yield this.saveDefaultParameters(!0)}}))}saveExportProperties(e,t=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("export-definition",!0);try{return yield this._sdk.export.updateDefinitions(this._modelId,e),!0}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.saveExportProperties",r,t),yield this.saveExportProperties(e,!0)}}))}saveOutputProperties(e,t=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("output-definition",!0);try{return yield this._sdk.output.updateDefinitions(this._modelId,e),!0}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.saveOutputProperties",r,t),yield this.saveOutputProperties(e,!0)}}))}saveParameterProperties(e,t=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("parameter-definition",!0);try{return yield this._sdk.model.updateParameterDefinitions(this._modelId,e),!0}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.saveParameterProperties",r,t),yield this.saveParameterProperties(e,!0)}}))}saveSettings(e,t=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("configure",!0);try{return yield this._sdk.model.updateConfig(this._modelId,e),!0}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.saveSettings",r,t),yield this.saveSettings(e,!0)}}))}uploadFile(e,t,i,s=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("file-upload");try{const r=yield this._sdk.file.requestUpload(this._sessionId,{[e]:{size:t.size,format:i}});if(r&&r.asset&&r.asset.file&&r.asset.file[e]){const n=r.asset.file[e];return yield this._sdk.utils.upload(n.href,yield t.arrayBuffer(),i),n.id}{const e=new n.ShapeDiverViewerSessionError("Session.uploadFile: Upload reply has not the required format.");throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.uploadFile",e)}}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.uploadFile",r,s),yield this.uploadFile(e,t,i,!0)}}))}uploadGLTF(e,t=u.ShapeDiverRequestGltfUploadQueryConversion.NONE,i=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("gltf-upload");try{const r=yield this._sdk.gltf.upload(this._sessionId,yield e.arrayBuffer(),"model/gltf-binary",t);if(!r||!r.gltf||!r.gltf.href){const e=new n.ShapeDiverViewerSessionError("Session.uploadGLTF: Upload reply has not the required format.");throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.uploadGLTF",e)}return r.gltf.href}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.uploadGLTF",r,i),yield this.uploadGLTF(e,t,!0)}}))}checkAvailability(e,t=!1){var r;if(!this._responseDto){const e=new n.ShapeDiverViewerSessionError("Session.checkAvailability: responseDto not available.");throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.checkAvailability",e)}if(!this._sessionId){const e=new n.ShapeDiverViewerSessionError("Session.checkAvailability: sessionId not available.");throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.checkAvailability",e)}if(t&&!this._modelId){const e=new n.ShapeDiverViewerSessionError("Session.checkAvailability: modelId not available.");throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.checkAvailability",e)}if(e&&!this._responseDto.actions){const e=new n.ShapeDiverViewerSessionError("Session.checkAvailability: actions not available.");throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.checkAvailability",e)}const i=null===(r=this._responseDto.actions)||void 0===r?void 0:r.find((t=>t.name===e));if(e&&!i){const t=new n.ShapeDiverViewerSessionError(`Session.checkAvailability: action ${e} not available.`);throw this._logger.handleError(n.LOGGINGTOPIC.SESSION,"Session.checkAvailability",t)}}customizeSession(e,t,i=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability("customize");try{this._performanceEvaluator.startSection("sessionResponse");const r=yield this._sdk.utils.submitAndWaitForCustomization(this._sdk,this._sessionId,e);return this._performanceEvaluator.endSection("sessionResponse"),t()?new l.SessionTreeNode:(this.updateResponseDto(r),this.loadOutputs(t))}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.customizeSession",r,i),yield this.customizeSession(e,t,!0)}}))}loadData(e,t={responseType:"blob"},i=!1){return r(this,void 0,void 0,(function*(){this.checkAvailability();try{const r=btoa(e);return this._dataCache[r]||(e.startsWith("blob:")||e.startsWith("data:")?this._dataCache[r]=this._httpClient.get(e,t):this._dataCache[r]=this._httpClient.get(`${this.modelViewUrl}/api/v2/session/${this._sessionId}/image?url=${r}`,t)),yield this._dataCache[r]}catch(r){return yield this.handleError(n.LOGGINGTOPIC.SESSION,"Session.loadData",r,i),yield this.loadData(e,t,!0)}}))}timeout(e){return r(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}updateResponseDto(e){if(this._responseDto){if(e.parameters)for(let t in e.parameters)this._responseDto.parameters=this._responseDto.parameters||{},this._responseDto.parameters[t]=this._responseDto.parameters[t]||e.parameters[t];if(e.outputs)for(let t in e.outputs)this._responseDto.outputs=this._responseDto.outputs||{},!("version"in e.outputs[t])&&this._responseDto.outputs[t]&&"version"in this._responseDto.outputs[t]||(this._responseDto.outputs[t]=e.outputs[t]);if(e.exports)for(let t in e.exports)this._responseDto.exports=this._responseDto.exports||{},!("version"in e.exports[t])&&this._responseDto.exports[t]&&"version"in this._responseDto.exports[t]||(this._responseDto.exports[t]=e.exports[t]);for(let e in this._responseDto.parameters)this.parameters[e]||(this.parameters[e]=this._responseDto.parameters[e],this.parameters[e].id=e);for(let e in this._responseDto.exports)this._responseDto.exports[e].type!==u.ShapeDiverResponseExportDefinitionType.EMAIL&&this._responseDto.exports[e].type!==u.ShapeDiverResponseExportDefinitionType.DOWNLOAD||(this.exports[e]=this._responseDto.exports[e],this.exports[e].id=e);for(let e in this._responseDto.outputs)this.outputs[e]=this._responseDto.outputs[e],this.outputs[e].id=e,void 0===this.outputsFreeze[e]&&(this.outputsFreeze[e]=!1)}else this._responseDto=e}}})),s.register("fTT0m",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OutputDelayException=void 0;class r extends Error{constructor(e){super(),this._delay=e}get delay(){return this._delay}}e.exports.OutputDelayException=r})),s.register("lvmE8",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OutputLoader=void 0,s("yoicn");var i=s("bJEmL"),n=s("12eGO"),o=s("fcs0K"),a=s("eYU63"),l=s("fTT0m"),c=s("jscMs"),u=s("irHKn"),h=s("cTTbu");e.exports.OutputLoader=class{constructor(){this._dataEngine=i.instance.resolve(o.DataEngine),this._loadedOutputNodes={},this._lastOutputNodes={},this._performanceEvaluator=i.instance.resolve(h.PerformanceEvaluator)}loadOutputs(e,t,i){var n;return r(this,void 0,void 0,(function*(){this._performanceEvaluator.startSection("outputLoading");const r=new c.SessionTreeNode(null===(n=e.model)||void 0===n?void 0:n.name);let s={},o=[],a=[],h=0;for(let e in t)if(s[e]={},this._loadedOutputNodes[e]||(this._loadedOutputNodes[e]={}),i[e])s[e][t[e].version]=this._lastOutputNodes[e];else if(t[e].delay)h=Math.max(h,t[e].delay);else if(this._loadedOutputNodes[e][t[e].version])s[e][t[e].version]=this._loadedOutputNodes[e][t[e].version];else if(s[e][t[e].version]=new c.SessionTreeNode(e),s[e][t[e].version].data.push(new u.SessionOutputData(t[e])),t[e].content)for(let r=0,i=t[e].content.length;r<i;r++)o.push(this._dataEngine.loadContent(t[e].content[r])),a.push(s[e][t[e].version]);if(h)throw new l.OutputDelayException(h);yield Promise.all(o);for(let e=0;e<o.length;e++)a[e].addChild(yield o[e]);for(let e in t)r.addChild(s[e][t[e].version]);for(let e in t)this._loadedOutputNodes[e]={},this._loadedOutputNodes[e][t[e].version]=s[e][t[e].version],this._lastOutputNodes[e]=s[e][t[e].version];for(let e in t)if(s[e][t[e].version].children.length>1)for(let r=0,i=t[e].content.length;r<i;r++)if("sdtf"===t[e].content[r].format){this.mergeContentNodes(s[e][t[e].version]);break}return this.assignMaterials(r),this._performanceEvaluator.endSection("outputLoading"),r}))}assignMaterials(e){const t=(e,r)=>{for(let t=0;t<e.data.length;t++)if(e.data[t]instanceof n.GeometryData){const i=e.data[t],n=i.primitive.material;null!==n&&!0!==n.materialOutput||(i.primitive.material=r)}for(let i=0;i<e.children.length;i++){const n=e.children[i];n&&t(n,r)}},r=(e,t=[])=>{for(let r=0;r<e.data.length;r++)if(e.data[r]instanceof n.AbstractMaterialData){const i=e.data[r];i.materialOutput=!0,t.push(i)}for(let i=0;i<e.children.length;i++){const n=e.children[i];n&&t.push(...r(n))}return t};for(let i=0;i<e.children.length;i++){const n=e.children[i];if(n)for(let i=0;i<n.data.length;i++){if(!(n.data[i]instanceof u.SessionOutputData))continue;const s=n.data[i];if(s.responseOutput.material){let i=[];for(let t=0;t<e.children.length;t++){const r=e.children[t];r&&(r.name===s.responseOutput.material&&(i=r.children))}const o=n.children;if(i.length>=o.length)for(let e=0;e<o.length;e++)t(o[e],r(i[e])[0]);else if(i.length>=1)for(let e=0;e<o.length;e++)t(o[e],r(i[0])[0])}else{const e=s.responseOutput.content;if(void 0===e)continue;const i=[],o=[];for(let t=0;t<e.length;t++)"material"===e[t].format?i.push(n.children[t]):o.push(n.children[t]);if(i.length>=o.length)for(let e=0;e<o.length;e++)t(o[e],r(i[e])[0]);else if(i.length>=1)for(let e=0;e<o.length;e++)t(o[e],r(i[0])[0])}}}}mergeContentNodes(e){if(!(e.children.length>1))return;const t=[];for(;e.children.length>0;)t.push(...e.children[0].children),e.removeChild(e.children[0]);const r=(e,t)=>{for(let r=0;r<e.data.length;r++)t.data.push(e.data[r]);for(let i=0;i<e.children.length;i++){let n;for(let r=0;r<t.children.length;r++)if(e.children[i].name===t.children[r].name){n=t.children[r];break}n||(n=new a.TreeNode(e.children[i].name),t.addChild(n)),r(e.children[i],n)}},i=new a.TreeNode("content_array");e.addChild(i);for(let e=0;e<t.length;e++)r(t[e],i)}}})),s.register("fcs0K",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DataEngine=void 0;var r=s("9i5uP");Object.defineProperty(e.exports,"DataEngine",{enumerable:!0,get:function(){return r.DataEngine}})})),s.register("9i5uP",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DataEngine=void 0,s("yoicn");var n=s("bJEmL"),o=s("crO5Z"),a=s("12eGO"),l=s("6TMyR"),c=s("loGDz"),u=s("fwEwy"),h=s("57buV"),d=s("eYU63"),f=s("cTTbu"),p=s("6bM2h"),m=s("3iqbd");let g=class{constructor(){this._geometryEngine=n.instance.resolve(l.GeometryEngine),this._htmlElementAnchorEngine=n.instance.resolve(p.HTMLElementAnchorEngine),this._logger=n.instance.resolve(f.Logger),this._materialEngine=n.instance.resolve(c.MaterialEngine),this._sdtfEngine=n.instance.resolve(u.SDTFEngine),this._tag3dEngine=n.instance.resolve(h.Tag3dEngine)}loadContent(e){return i(this,void 0,void 0,(function*(){if(!e||e&&!e.format){const e=new f.ShapeDiverViewerDataProcessingError("DataEngine cannot load content.");throw this._logger.handleError(f.LOGGINGTOPIC.DATA_PROCESSING,"DataEngine.loadContent",e)}try{let t;"glb"===e.format||"gltf"===e.format?t=yield this._geometryEngine.loadContent(e):"material"===e.format?t=yield this._materialEngine.loadContent(e):"tag2d"===e.format||"anchor"===e.format?t=yield this._htmlElementAnchorEngine.loadContent(e):"tag3d"===e.format?t=yield this._tag3dEngine.loadContent(e):"sdtf"===e.format?t=yield this._sdtfEngine.loadContent(e):(t=new d.TreeNode("custom"),t.data.push(new a.CustomData(Object.assign({},e))));const r=new d.TreeNode("transformation");if(e.transformations&&Array.isArray(e.transformations))for(let i=0;i<e.transformations.length;i++){const n=e.transformations[i];if(Array.isArray(n)&&16===n.length){const e=t.cloneInstance();e.transformations=[{id:"content_"+i,matrix:m.fromValues(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}].concat(t.transformations),r.addChild(e)}}else r.addChild(t);return r}catch(e){throw this._logger.handleError(f.LOGGINGTOPIC.DATA_PROCESSING,"DataEngine.loadContent",e)}}))}};g=r([o.default()],g),e.exports.DataEngine=g})),s.register("6TMyR",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GeometryEngine=void 0;var r=s("hFcTq");Object.defineProperty(e.exports,"GeometryEngine",{enumerable:!0,get:function(){return r.GeometryEngine}})})),s.register("hFcTq",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GeometryEngine=void 0,s("yoicn");var o=s("bJEmL"),a=s("crO5Z"),l=s("cTTbu"),c=s("5XWzi"),u=s("7NBET");let h=class{constructor(){this.BINARY_EXTENSION_HEADER_LENGTH=20,this._httpClient=o.instance.resolve(l.HttpClient),this._logger=o.instance.resolve(l.Logger),this._performanceEvaluator=o.instance.resolve(l.PerformanceEvaluator)}loadContent(e){return n(this,void 0,void 0,(function*(){if(!e||e&&!e.href){const e=new l.ShapeDiverViewerDataProcessingError("GeometryEngine cannot load content.");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryEngine.loadContent",e)}const t=e.href;let r,i,n,s,o,a="2.0";if("glb"===e.format||"gltf"===e.format){let e;this._performanceEvaluator.startSection("gltfProcessing."+t);try{this._performanceEvaluator.startSection("loadGltf."+t),e=yield this._httpClient.get(t,{responseType:"arraybuffer"}),this._performanceEvaluator.endSection("loadGltf."+t)}catch(e){throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryEngine.loadContent",e)}const o=(new TextDecoder).decode(new Uint8Array(e.data,0,4));if("glTF"===o||e.headers["content-type"]&&("model/gltf-binary"===e.headers["content-type"]||"application/octet-stream"===e.headers["content-type"]||"model/gltf.binary"===e.headers["content-type"])){i=e.data;const t=new DataView(i,0,this.BINARY_EXTENSION_HEADER_LENGTH);if(s={magic:o,version:t.getUint32(4,!0),length:t.getUint32(8,!0),contentLength:t.getUint32(12,!0),contentFormat:t.getUint32(16,!0)},"glTF"!=s.magic){const e=new l.ShapeDiverViewerDataProcessingError("Invalid data: glTF magic wrong.");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryEngine.loadContent",e)}const n=new DataView(i,this.BINARY_EXTENSION_HEADER_LENGTH,s.contentLength),c=(new TextDecoder).decode(n);if(r=JSON.parse(c),r&&r.asset&&r.asset.version){const e=(r.asset.version+"").endsWith(".0")?r.asset.version:r.asset.version+".0";if(s.version+".0"!==e){const t=new l.ShapeDiverViewerDataProcessingError("GeometryEngine.loadContent: glTF header version ("+s.version+") is not the same as asset version ("+e+").");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryEngine.loadContent",t)}a=s.version+".0"}else a=s.version+".0"}else{if(r=JSON.parse((new TextDecoder).decode(e.data)),r&&r.asset&&r.asset.version){if("2.0"!==r.asset.version){const e=new l.ShapeDiverViewerDataProcessingError("GeometryEngine.loadContent: Only gltf v2 is supported in a non-binary format.");throw this._logger.handleError(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryEngine.loadContent",e)}}else this._logger.warn(l.LOGGINGTOPIC.DATA_PROCESSING,"GeometryEngine.loadContent: No version specified in asset, trying to load as v2."),a="2.0";const i=e=>{const t=e.includes("/")?"/":"\\",r=e.split(t);return r.pop(),r.join(t)};n=i(t),!n&&window&&window.location&&window.location.href&&(n=i(window.location.href))}}return o="1.0"===a?yield(new c.GLTFLoader).load(r,i,s,n):yield(new u.GLTFLoader).load(r,i,s,n),this._performanceEvaluator.endSection("gltfProcessing."+t),o}))}};h=r([a.default(),i("design:paramtypes",[])],h),e.exports.GeometryEngine=h})),s.register("5XWzi",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GLTFLoader=void 0;var i=s("eYU63"),n=s("cTTbu"),o=s("1BiQ9"),a=s("3iqbd"),l=s("eIStk"),c=s("jxhwV"),u=s("12eGO");s("yoicn");var h=s("bJEmL"),d=s("4ExG4");e.exports.GLTFLoader=class{constructor(){this.BINARY_EXTENSION_HEADER_LENGTH=20,this._httpClient=h.instance.resolve(n.HttpClient),this._uuidGenerator=h.instance.resolve(n.UuidGenerator),this._logger=h.instance.resolve(n.Logger),this._implementedExtensions=["KHR_materials_common"],this._globalTransformation=a.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),this._converter=h.instance.resolve(n.Converter),this._performanceEvaluator=h.instance.resolve(n.PerformanceEvaluator)}load(e,t,i,s){return r(this,void 0,void 0,(function*(){let r;this._baseUri=s,t&&i&&(this._body=t.slice(this.BINARY_EXTENSION_HEADER_LENGTH+i.contentLength,i.length)),this._content=e,t&&i&&(r=yield(new d.SDGTFLoader).load(t,i.length));try{this.validateVersionAndExtensions();const e=yield this.loadScene();return r&&e.addChild(r),e}catch(e){throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.loadContent",e)}}))}loadWithUrl(e){return r(this,void 0,void 0,(function*(){let t;this._performanceEvaluator.startSection("gltfProcessing."+e);try{this._performanceEvaluator.startSection("loadGltf."+e),t=(yield this._httpClient.get(e,{responseType:"arraybuffer"})).data,this._performanceEvaluator.endSection("loadGltf."+e)}catch(e){throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.load",e)}const r=new DataView(t,0,this.BINARY_EXTENSION_HEADER_LENGTH),i={magic:String.fromCharCode(r.getUint8(0))+String.fromCharCode(r.getUint8(1))+String.fromCharCode(r.getUint8(2))+String.fromCharCode(r.getUint8(3)),version:r.getUint32(4,!0),length:r.getUint32(8,!0),contentLength:r.getUint32(12,!0),contentFormat:r.getUint32(16,!0)};if("glTF"!=i.magic){const e=new n.ShapeDiverViewerDataProcessingError("GLTFLoader.load: Invalid data: glTF magic wrong.");throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.load",e)}const s=new DataView(t,this.BINARY_EXTENSION_HEADER_LENGTH,i.contentLength),o=(new TextDecoder).decode(s);this._content=JSON.parse(o),this._body=t.slice(this.BINARY_EXTENSION_HEADER_LENGTH+i.contentLength,i.length);const a=yield(new d.SDGTFLoader).load(t,i.length);try{this.validateVersionAndExtensions();const t=yield this.loadScene();return t.addChild(a),this._performanceEvaluator.endSection("gltfProcessing."+e),t}catch(e){throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.load",e)}}))}validateVersionAndExtensions(){if(this._content.extensionsUsed){const e=[];for(let t=0;t<this._content.extensionsUsed.length;t++)this._implementedExtensions.includes(this._content.extensionsUsed[t])||e.push(this._content.extensionsUsed[t]);if(e.length>0){let t="Extension"+(1===e.length?" ":"s ");e.forEach(((r,i)=>{t+='"'+r+'"'+(i===e.length-1?"":i===e.length-2?" and ":", ")})),t+=(1===e.length?" is":" are")+" not supported, but used. Loading glTF regardless.",this._logger.info(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.validateVersionAndExtensions: "+t)}}}loadAccessor(e){var t,i;return r(this,void 0,void 0,(function*(){if(!this._content.accessors[e])throw new Error("Accessor not available.");const r=this._content.accessors[e],s=yield this.loadBufferView(r.bufferView),a=o.ACCESSORTYPE_V1[r.type];5124===r.componentType&&this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.loadAccessor: The componentType for this accessor is 5124, which is not allowed. Trying to load it anyway.");const l=o.ACCESSORCOMPONENTTYPE_V1[r.componentType],c=l.BYTES_PER_ELEMENT,h=c*a,d=r.byteOffset||0,f=r.byteStride,p=this._content.asset&&"ShapeDiverGltfV1Writer"===(null===(t=this._content.asset)||void 0===t?void 0:t.generator)&&r.min||[],m=this._content.asset&&"ShapeDiverGltfV1Writer"===(null===(i=this._content.asset)||void 0===i?void 0:i.generator)&&r.max||[];return new u.AttributeData(new l(s),a,h,d,c,!1,r.count,p,m,f)}))}loadBuffer(e){return r(this,void 0,void 0,(function*(){if(!this._content.buffers[e])throw new Error("Buffer not available.");const t=this._content.buffers[e];if("binary_glTF"===e)return this._body;if("arraybuffer"===t.type){return(yield this._httpClient.get(t.uri,{responseType:"arraybuffer"})).data}if(!this._body)throw new Error("Buffer not available.");return this._body}))}loadBufferView(e){return r(this,void 0,void 0,(function*(){if(!this._content.bufferViews[e])throw new Error("Buffer View not available.");const t=this._content.bufferViews[e],r=yield this.loadBuffer(t.buffer),i=void 0!==t.byteLength?t.byteLength:0;return r.slice(t.byteOffset,t.byteOffset+i)}))}loadMaterial(e){return r(this,void 0,void 0,(function*(){if(!this._content.materials[e])throw new Error("Material not available.");const t=this._content.materials[e],r=new u.MaterialStandardData;if(void 0!==t.name&&(r.name=t.name),t.extensions&&t.extensions.KHR_materials_common){const e=t.extensions.KHR_materials_common.technique;e&&"BLINN"!==e&&this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"The technique "+e+" is not supported. Trying to load the material either way.");const i=t.extensions.KHR_materials_common.values;if(i.hasOwnProperty("doubleSided")&&(r.side=i.doubleSided?u.MATERIAL_SIDE.DOUBLE:u.MATERIAL_SIDE.FRONT),r.color="#d3d3d3",i.hasOwnProperty("diffuse")&&Array.isArray(i.diffuse)){const e=i.diffuse.map((e=>255*e));r.color=this._converter.toColor(e),r.opacity=Math.max(0,Math.min(i.diffuse[3],1))}else i.hasOwnProperty("diffuse")&&this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.loadMaterial: The value diffuse was set for a material, but is not supported in that type.");if(!i.hasOwnProperty("diffuse")&&i.hasOwnProperty("ambient")){const e=i.ambient.map((e=>255*e));r.color=this._converter.toColor(e)}i.hasOwnProperty("emission")&&Array.isArray(i.emission)?r.emissiveness=this._converter.toColor(i.emission):i.hasOwnProperty("emission")&&this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.loadMaterial: The value emission was set for a material, but is not supported in that type."),i.hasOwnProperty("shininess")&&(r.metalness=Math.min(1,i.shininess),r.roughness=1-Math.min(1,i.shininess)),i.hasOwnProperty("transparency")&&(r.opacity=Math.max(0,Math.min(i.transparency,1))),i.hasOwnProperty("transparency")||!i.hasOwnProperty("transparent")||"true"!==i.transparency&&!0!==i.transparency||(r.opacity=0),i.hasOwnProperty("_roughness")&&(r.roughness=Math.min(1,Math.max(0,i.roughness))),i.hasOwnProperty("_metalness")&&(r.metalness=Math.min(1,Math.max(0,i.metalness)))}return r}))}loadMesh(e){return r(this,void 0,void 0,(function*(){if(!this._content.meshes[e])throw new Error("Mesh not available.");const t=this._content.meshes[e],r=new i.TreeNode(e);if(!t.primitives)return new i.TreeNode("primitive");for(let e=0,n=t.primitives.length;e<n;e++){const n=new i.TreeNode("primitive_"+e);r.addChild(n);let s=t.primitives[e];const o={};for(let e in s.attributes){let t=e;if(/\d/.test(t)&&!t.includes("_")){const e=t.search(/\d/);t=t.substring(0,e)+"_"+t.substring(e,t.length)}else"TEXCOORD"===t||"COLOR"===t||"JOINTS"===t||"WEIGHTS"===t?t+="_0":"UV"===t&&(t="TEXCOORD_0");o[t]=yield this.loadAccessor(s.attributes[e]),t.startsWith("COLOR")&&(o[t]=new u.AttributeData(o[t].array,o[t].itemSize,o[t].itemBytes,o[t].byteOffset,o[t].elementBytes,!0,o[t].count,[],[],o[t].byteStride))}let a;s.material&&(a=yield this.loadMaterial(s.material));const l=new u.GeometryData(new u.PrimitiveData(o,4,yield this.loadAccessor(s.indices),a));n.data.push(l)}return r}))}loadNode(e){return r(this,void 0,void 0,(function*(){if(!this._content.nodes[e])throw new Error("Node not available.");const t=this._content.nodes[e],r=new i.TreeNode(e);if(t.matrix)r.transformations.push({id:this._uuidGenerator.create(),matrix:a.fromValues(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5],t.matrix[6],t.matrix[7],t.matrix[8],t.matrix[9],t.matrix[10],t.matrix[11],t.matrix[12],t.matrix[13],t.matrix[14],t.matrix[15])});else if(t.translation||t.scale||t.rotation){const e=t.translation?a.fromTranslation(a.create(),l.fromValues(t.translation[0],t.translation[1],t.translation[2])):a.create(),i=t.scale?a.fromScaling(a.create(),l.fromValues(t.scale[0],t.scale[1],t.scale[2])):a.create(),n=t.rotation?a.fromQuat(a.create(),c.fromValues(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3])):a.create(),s=a.mul(a.create(),a.mul(a.create(),e,i),n);r.transformations.push({id:this._uuidGenerator.create(),matrix:s})}if(t.meshes)for(let e=0,i=t.meshes.length;e<i;e++)r.addChild(yield this.loadMesh(t.meshes[e]));if(t.children)for(let e=0,i=t.children.length;e<i;e++)r.addChild(yield this.loadNode(t.children[e]));return r}))}loadScene(){var e,t;return r(this,void 0,void 0,(function*(){if(!this._content.scene)throw new Error("No scene.");if(!this._content.scenes[this._content.scene])throw new Error("Scene not available.");const r=this._content.scenes[this._content.scene],n=new i.TreeNode(this._content.scene);if(this._content.asset&&"ShapeDiverGltfWriter"!==(null===(e=this._content.asset)||void 0===e?void 0:e.generator)&&"ShapeDiverGltfV1Writer"!==(null===(t=this._content.asset)||void 0===t?void 0:t.generator)&&n.transformations.push({id:this._uuidGenerator.create(),matrix:this._globalTransformation}),r.nodes)for(let e=0,t=r.nodes.length;e<t;e++)n.addChild(yield this.loadNode(r.nodes[e]));return n}))}}})),s.register("1BiQ9",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.JUSTIFICATION=e.exports.ACCESSORTYPE_V2=e.exports.ACCESSORCOMPONENTSIZE_V2=e.exports.ACCESSORCOMPONENTTYPE_V2=e.exports.ACCESSORTYPE_V1=e.exports.ACCESSORCOMPONENTSIZE_V1=e.exports.ACCESSORCOMPONENTTYPE_V1=void 0;var r=s("edNzR");Object.defineProperty(e.exports,"JUSTIFICATION",{enumerable:!0,get:function(){return r.JUSTIFICATION}});var i=s("3KWIa");Object.defineProperty(e.exports,"ACCESSORCOMPONENTSIZE_V1",{enumerable:!0,get:function(){return i.ACCESSORCOMPONENTSIZE}}),Object.defineProperty(e.exports,"ACCESSORCOMPONENTTYPE_V1",{enumerable:!0,get:function(){return i.ACCESSORCOMPONENTTYPE}}),Object.defineProperty(e.exports,"ACCESSORTYPE_V1",{enumerable:!0,get:function(){return i.ACCESSORTYPE}});var n=s("eL5F1");Object.defineProperty(e.exports,"ACCESSORCOMPONENTSIZE_V2",{enumerable:!0,get:function(){return n.ACCESSORCOMPONENTSIZE}}),Object.defineProperty(e.exports,"ACCESSORCOMPONENTTYPE_V2",{enumerable:!0,get:function(){return n.ACCESSORCOMPONENTTYPE}}),Object.defineProperty(e.exports,"ACCESSORTYPE_V2",{enumerable:!0,get:function(){return n.ACCESSORTYPE}})})),s.register("edNzR",(function(e,t){var r;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.JUSTIFICATION=void 0,(r=e.exports.JUSTIFICATION||(e.exports.JUSTIFICATION={})).TOP_LEFT="TL",r.TOP_CENTER="TC",r.TOP_RIGHT="TR",r.MIDDLE_LEFT="ML",r.MIDDLE_CENTER="MC",r.MIDDLE_RIGHT="MR",r.BOTTOM_LEFT="BL",r.BOTTOM_CENTER="BC",r.BOTTOM_RIGHT="BR"})),s.register("3KWIa",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ACCESSORTYPE=e.exports.ACCESSORCOMPONENTSIZE=e.exports.ACCESSORCOMPONENTTYPE=void 0,e.exports.ACCESSORCOMPONENTTYPE={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5124:Uint32Array,5125:Uint32Array,5126:Float32Array},e.exports.ACCESSORCOMPONENTSIZE={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},e.exports.ACCESSORTYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,VEC7:7,VEC10:10,VEC12:12,MAT2:4,MAT3:9,MAT4:16}})),s.register("eL5F1",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ACCESSORTYPE=e.exports.ACCESSORCOMPONENTSIZE=e.exports.ACCESSORCOMPONENTTYPE=void 0,e.exports.ACCESSORCOMPONENTTYPE={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5124:Uint16Array,5125:Uint32Array,5126:Float32Array},e.exports.ACCESSORCOMPONENTSIZE={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},e.exports.ACCESSORTYPE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}})),s.register("4ExG4",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDGTFLoader=void 0;var i=s("eYU63"),n=s("cTTbu"),o=s("1BiQ9"),a=s("12eGO");s("yoicn");var l=s("bJEmL"),c=s("eIStk"),u=s("3iqbd"),h=s("jxhwV");e.exports.SDGTFLoader=class{constructor(){this.BINARY_EXTENSION_HEADER_LENGTH=20,this._logger=l.instance.resolve(n.Logger)}load(e,t){return r(this,void 0,void 0,(function*(){if(!(t<e.byteLength))return new i.TreeNode;{const r=new DataView(e,t,this.BINARY_EXTENSION_HEADER_LENGTH+1),i={magic:String.fromCharCode(r.getUint8(0))+String.fromCharCode(r.getUint8(1))+String.fromCharCode(r.getUint8(2))+String.fromCharCode(r.getUint8(3))+String.fromCharCode(r.getUint8(4)),version:r.getUint32(5,!0),length:r.getUint32(9,!0),contentLength:r.getUint32(13,!0),contentFormat:r.getUint32(17,!0)};if("sdgTF"!=i.magic){const e=new n.ShapeDiverViewerDataProcessingError("SDGTFLoader.load: Invalid data: sdgTF magic wrong.");throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"SDGTFLoader.load",e)}const s=new DataView(e,t+this.BINARY_EXTENSION_HEADER_LENGTH+1,i.contentLength),o=(new TextDecoder).decode(s);this._content=JSON.parse(o),this._body=e.slice(t+this.BINARY_EXTENSION_HEADER_LENGTH+1+i.contentLength,t+i.length)}try{return yield this.loadScene()}catch(e){throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"SDGTFLoader.load",e)}}))}convertToIndicesArray(e){const t=Math.max(0,...e);return t<255?new Uint8Array(e):t<65535?new Uint16Array(e):new Uint32Array(e)}loadAccessor(e){return r(this,void 0,void 0,(function*(){if(!this._content.accessors[e])throw new Error("Accessor not available.");const t=this._content.accessors[e],r=this._body,i=o.ACCESSORTYPE_V1[t.type],n=o.ACCESSORCOMPONENTTYPE_V1[t.componentType],s=n.BYTES_PER_ELEMENT,l=s*i,c=t.byteOffset||0;return new a.AttributeData(new n(r,c,i*t.count),i,l,c,s,!1,t.count)}))}loadArcs(){return r(this,void 0,void 0,(function*(){if(!this._content.arcs)throw new Error("Arcs not available.");const e=this._content.arcs,t=new i.TreeNode("arcs"),r=yield this.loadAccessor(e.attributes.ARCS),s=r.array.length/r.itemSize;for(let e=0;e<s;++e){const s=new i.TreeNode("arc_"+e),o=12*e,l=c.fromValues(r.array[o+0],r.array[o+1],r.array[o+2]),h=c.fromValues(r.array[o+3],r.array[o+4],r.array[o+5]),d=c.fromValues(r.array[o+6],r.array[o+7],r.array[o+8]),f=r.array[o+9],p=r.array[o+10],m=r.array[o+11],g=c.cross(c.create(),h,d);if(f<=0){this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"SDGTFLoader.loadArcs: Arc radius is <= 0.");continue}const v=[],_=e=>{const t=2*Math.PI;let r=m-p;const i=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=t;for(;r>t;)r-=t;r=r<Number.EPSILON?i?0:t:r;const n=p+e*r;let s=f*Math.cos(n),o=f*Math.sin(n);v.push(s,o,0)},b=Math.max(3,Math.round((m-p)/2*Math.PI*50));for(let e=0;e<=b;e++)_(e/b);const y=new Float32Array(v),E={};E.POSITION=new a.AttributeData(y,3,0,0,0,!1,y.length/3);const w=new a.GeometryData(new a.PrimitiveData(E,a.PRIMITIVE_MODE.LINE_STRIP,null));s.data.push(w),s.transformations.push({id:"arc_"+e+"_translation",matrix:u.translate(u.create(),u.create(),c.fromValues(l[0],l[1],l[2]))});const x=u.transpose(u.create(),u.fromValues(h[0],d[0],g[0],0,h[1],d[1],g[1],0,h[2],d[2],g[2],0,0,0,0,1));s.transformations.push({id:"arc_"+e+"_rotation",matrix:x}),t.addChild(s)}return t}))}loadBeziercurve(e){return r(this,void 0,void 0,(function*(){if(!this._content.beziercurves[e])throw new Error("Beziercurve not available.");const t=this._content.beziercurves[e],r=new i.TreeNode(e),n=yield this.loadAccessor(t.attributes.CONTROLPOINTS),s=[];for(let e=0;e<n.array.length;e+=3)s.push(h.fromValues(n.array[e],n.array[e+1],n.array[e+2],1));const o=yield this.loadAccessor(t.attributes.KNOTS),l=[o.array[0]];for(let e=0;e<o.array.length;e++)l.push(o.array[e]);l.push(o.array[o.array.length-1]);const u=t.degree,d=e=>{const t=(e=>{const t=l.length-u-1;if(e>=l[t])return t-1;if(e<=l[u])return u;let r=u,i=t,n=Math.floor((r+i)/2);for(;e<l[n]||e>=l[n+1];)e<l[n]?i=n:r=n,n=Math.floor((r+i)/2);return n})(e),r=((e,t)=>{const r=[],i=[],n=[];r[0]=1;for(let s=1;s<=u;++s){i[s]=t-l[e+1-s],n[s]=l[e+s]-t;let o=0;for(let e=0;e<s;++e){const t=n[e+1],a=i[s-e],l=r[e]/(t+a);r[e]=o+t*l,o=a*l}r[s]=o}return r})(t,e),i=h.create();for(let e=0;e<=u;++e){const n=s[t-u+e],o=r[e],a=n[3]*o;h.add(i,i,h.fromValues(n[0]*a,n[1]*a,n[2]*a,n[3]*o))}return i},f=[],p=e=>{const t=l[0]+e*(l[l.length-1]-l[0]);let r=d(t);1!==r[3]&&(r=h.divide(h.create(),r,h.fromValues(r[3],r[3],r[3],r[3]))),f.push(r[0],r[1],r[2])};let m=0;for(let e=1;e<s.length;e++)m+=c.distance(c.fromValues(s[e-1][0],s[e-1][1],s[e-1][2]),c.fromValues(s[e][0],s[e][1],s[e][2]));const g=Math.min(100,Math.max(25,Math.floor(m/.1)));for(let e=0;e<=g;e++)p(e/g);const v=new Float32Array(f),_={};_.POSITION=new a.AttributeData(v,3,0,0,0,!1,v.length/3);const b=new a.GeometryData(new a.PrimitiveData(_,a.PRIMITIVE_MODE.LINE_STRIP,null));return r.data.push(b),r}))}loadCircles(){return r(this,void 0,void 0,(function*(){if(!this._content.circles)throw new Error("Circles not available.");const e=this._content.circles,t=new i.TreeNode("circles"),r=yield this.loadAccessor(e.attributes.CIRCLES),s=r.array.length/r.itemSize;for(let e=0;e<s;e++){const s=new i.TreeNode("circle_"+e),o=10*e,l=c.fromValues(r.array[o+0],r.array[o+1],r.array[o+2]),h=c.fromValues(r.array[o+3],r.array[o+4],r.array[o+5]),d=c.fromValues(r.array[o+6],r.array[o+7],r.array[o+8]),f=r.array[o+9],p=c.cross(c.create(),h,d);if(f<=0){this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"SDGTFLoader.loadCircles: Circle radius is <= 0.");continue}const m=[],g=e=>{const t=2*Math.PI;let r=2*Math.PI-0;const i=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=t;for(;r>t;)r-=t;r=r<Number.EPSILON?i?0:t:r;const n=0+e*r;let s=f*Math.cos(n),o=f*Math.sin(n);m.push(s,o,0)},v=50;for(let e=0;e<=v;e++)g(e/v);const _=new Float32Array(m),b={};b.POSITION=new a.AttributeData(_,3,0,0,0,!1,_.length/3);const y=new a.GeometryData(new a.PrimitiveData(b,a.PRIMITIVE_MODE.LINE_STRIP,null));s.data.push(y),s.transformations.push({id:"circle_"+e+"_translation",matrix:u.translate(u.create(),u.create(),c.fromValues(l[0],l[1],l[2]))});const E=u.transpose(u.create(),u.fromValues(h[0],d[0],p[0],0,h[1],d[1],p[1],0,h[2],d[2],p[2],0,0,0,0,1));s.transformations.push({id:"circle_"+e+"_rotation",matrix:E}),t.addChild(s)}return t}))}loadCylinders(){return r(this,void 0,void 0,(function*(){if(!this._content.cylinders)throw new Error("Cylinders not available.");const e=this._content.cylinders,t=new i.TreeNode("cylinders"),r=yield this.loadAccessor(e.attributes.CYLINDERS),s=r.array.length/r.itemSize;for(let e=0;e<s;e++){const s=new i.TreeNode("cylinder_"+e),o=7*e,l=c.fromValues(r.array[o+0],r.array[o+1],r.array[o+2]),h=c.fromValues(r.array[o+3],r.array[o+4],r.array[o+5]),d=r.array[o+6],f=c.sub(c.create(),l,h);let p;p=Math.abs(c.dot(f,c.fromValues(1,0,0)))<Math.abs(c.dot(f,c.fromValues(0,1,0)))?c.cross(c.create(),f,c.fromValues(1,0,0)):c.cross(c.create(),f,c.fromValues(0,1,0));const m=c.cross(c.create(),f,p);if(c.normalize(f,f),c.normalize(p,p),c.normalize(m,m),d<=0){this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"SDGTFLoader.loadCylinders: Cylinder radius is <= 0.");continue}const g=[],v=[],_=[],b=[],y=c.distance(l,h),E=y/2,w=0,x=2*Math.PI;let A=0;const T=[],S=1,M=50,C=c.create(),R=c.create();let I=0;const O=0;for(let e=0;e<=S;e++){const t=[],r=e/S,i=d;for(let e=0;e<=M;e++){const n=e/M,s=n*x+w,o=Math.sin(s),a=Math.cos(s);R[0]=i*o,R[1]=-r*y+E,R[2]=i*a,v.push(R[0],R[1],R[2]),c.normalize(C,c.fromValues(o,O,a)),_.push(C[0],C[1],C[2]),b.push(n,1-r),t.push(A++)}T.push(t)}for(let e=0;e<M;e++)for(let t=0;t<S;t++){const r=T[t][e],i=T[t+1][e],n=T[t+1][e+1],s=T[t][e+1];g.push(r,i,s),g.push(i,n,s),I+=6}const P={};P.POSITION=new a.AttributeData(new Float32Array(v),3,0,0,0,!1,v.length/3),P.NORMAL=new a.AttributeData(new Float32Array(_),3,0,0,0,!1,_.length/3),P.TEXCOORD_0=new a.AttributeData(new Float32Array(b),2,0,0,0,!1,b.length/2);const k=new a.GeometryData(new a.PrimitiveData(P,a.PRIMITIVE_MODE.TRIANGLES,new a.AttributeData(this.convertToIndicesArray(g),1,0,0,0,!1,g.length)));s.data.push(k),s.transformations.push({id:"cylinder_"+e+"_translation",matrix:u.translate(u.create(),u.create(),h)});const L=u.transpose(u.create(),u.fromValues(p[0],m[0],f[0],0,p[1],m[1],f[1],0,p[2],m[2],f[2],0,0,0,0,1));s.transformations.push({id:"cylinder_"+e+"_rotation",matrix:L}),s.transformations.push({id:"cylinder_"+e+"_rotation2",matrix:u.rotateX(u.create(),u.create(),.5*Math.PI)}),s.transformations.push({id:"cylinder_"+e+"_translation2",matrix:u.translate(u.create(),u.create(),c.fromValues(0,0,.5*c.distance(l,h)))}),t.addChild(s)}return t}))}loadSpheres(){return r(this,void 0,void 0,(function*(){if(!this._content.spheres)throw new Error("Spheres not available.");const e=this._content.spheres,t=new i.TreeNode("spheres"),r=yield this.loadAccessor(e.attributes.SPHERES),s=r.array.length/r.itemSize;for(let e=0;e<s;e++){const s=new i.TreeNode("sphere_"+e),o=4*e,l=c.fromValues(r.array[o+0],r.array[o+1],r.array[o+2]),h=r.array[o+3];if(h<=0){this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"SDGTFLoader.loadSpheres: Sphere radius is <= 0.");continue}const d=[],f=[],p=[],m=[],g=[],v=15,_=15,b=0,y=2*Math.PI,E=0,w=Math.PI,x=Math.min(E+w,Math.PI);let A=0;for(let e=0;e<=v;e++){const t=[],r=e/v;let i=0;0==e&&0==E?i=.5/_:e==v&&x==Math.PI&&(i=-.5/_);for(let e=0;e<=_;e++){const n=e/_,s=c.fromValues(-h*Math.cos(b+n*y)*Math.sin(E+r*w),h*Math.cos(E+r*w),h*Math.sin(b+n*y)*Math.sin(E+r*w));f.push(s[0],s[1],s[2]);const o=c.normalize(c.create(),s);p.push(o[0],o[1],o[2]),m.push(n+i,1-r),t.push(A++)}g.push(t)}for(let e=0;e<v;e++)for(let t=0;t<_;t++){const r=g[e][t+1],i=g[e][t],n=g[e+1][t],s=g[e+1][t+1];(0!==e||E>0)&&d.push(r,i,s),(e!==v-1||x<Math.PI)&&d.push(i,n,s)}const T={};T.POSITION=new a.AttributeData(new Float32Array(f),3,0,0,0,!1,f.length/3),T.NORMAL=new a.AttributeData(new Float32Array(p),3,0,0,0,!1,p.length/3),T.TEXCOORD_0=new a.AttributeData(new Float32Array(m),2,0,0,0,!1,m.length/2);const S=new a.GeometryData(new a.PrimitiveData(T,a.PRIMITIVE_MODE.TRIANGLES,new a.AttributeData(this.convertToIndicesArray(d),1,0,0,0,!1,d.length)));s.data.push(S),s.transformations.push({id:"sphere_"+e+"_translation",matrix:u.translate(u.create(),u.create(),l)}),t.addChild(s)}return t}))}loadPoint(e){return r(this,void 0,void 0,(function*(){if(!this._content.points[e])throw new Error("Point not available.");const t=this._content.points[e],r=new i.TreeNode(e),n={},s=yield this.loadAccessor(t.attributes.POINTS);n.POSITION=new a.AttributeData(s.array,3,s.itemBytes,s.byteOffset,s.elementBytes,s.normalized,s.count);const o=new a.GeometryData(new a.PrimitiveData(n,a.PRIMITIVE_MODE.POINTS,null));return r.data.push(o),r}))}loadPolyline(e){return r(this,void 0,void 0,(function*(){if(!this._content.polylines[e])throw new Error("Polyline not available.");const t=this._content.polylines[e],r=new i.TreeNode(e),n={},s=yield this.loadAccessor(t.attributes.VERTICES);n.POSITION=new a.AttributeData(s.array,3,s.itemBytes,s.byteOffset,s.elementBytes,s.normalized,s.count);const o=new a.GeometryData(new a.PrimitiveData(n,a.PRIMITIVE_MODE.LINE_STRIP,null));return r.data.push(o),r}))}loadSurfacepatch(e){return r(this,void 0,void 0,(function*(){if(!this._content.surfacepatches[e])throw new Error("Surfacepatch not available.");const t=this._content.surfacepatches[e],r=new i.TreeNode(e),n=t.controlPointCountU,s=t.controlPointCountV,o=yield this.loadAccessor(t.attributes.CONTROLPOINTS),l=[];let u=0;for(let e=0;e<n;e++){let e=[];for(let t=0;t<s;t++)e.push(h.fromValues(o.array[3*u],o.array[3*u+1],o.array[3*u+2],1)),u++;l.push(e)}const d=yield this.loadAccessor(t.attributes.KNOTSU),f=[d.array[0]];for(let e=0;e<d.array.length;e++)f.push(d.array[e]);f.push(d.array[d.array.length-1]);const p=yield this.loadAccessor(t.attributes.KNOTSV),m=[p.array[0]];for(let e=0;e<p.array.length;e++)m.push(p.array[e]);m.push(p.array[p.array.length-1]);const g=t.degreeU,v=t.degreeV,_=(e,t,r)=>{const i=e.length-t-1;if(r>=e[i])return i-1;if(r<=e[t])return t;let n=t,s=i,o=Math.floor((n+s)/2);for(;r<e[o]||r>=e[o+1];)r<e[o]?s=o:n=o,o=Math.floor((n+s)/2);return o},b=(e,t,r,i)=>{const n=[],s=[],o=[];n[0]=1;for(let a=1;a<=t;++a){s[a]=i-e[r+1-a],o[a]=e[r+a]-i;let t=0;for(let e=0;e<a;++e){const r=o[e+1],i=s[a-e],l=n[e]/(r+i);n[e]=t+r*l,t=i*l}n[a]=t}return n},y=(e,t)=>((e,t)=>{const r=_(f,g,e),i=_(m,v,t),n=b(f,g,r,e),s=b(m,v,i,t),o=[];for(let e=0;e<=v;++e){o[e]=h.create();for(let t=0;t<=g;++t){const s=h.clone(l[r-g+t][i-v+e]),a=s[3];s[0]*=a,s[1]*=a,s[2]*=a,h.add(o[e],o[e],h.multiply(h.create(),s,h.fromValues(n[t],n[t],n[t],n[t])))}}const a=h.create();for(let e=0;e<=v;++e)h.add(a,a,h.multiply(h.create(),o[e],h.fromValues(s[e],s[e],s[e],s[e])));return h.divide(a,a,h.fromValues(a[3],a[3],a[3],a[3])),c.fromValues(a[0],a[1],a[2])})(f[0]+e*(f[f.length-1]-f[0]),m[0]+t*(m[m.length-1]-m[0])),E=15,w=[],x=[];for(let e=0;e<=E;e++){const t=e/E;for(let e=0;e<=E;e++){const r=y(e/E,t);x.push(r[0],r[1],r[2])}}for(let e=0;e<E;e++)for(let t=0;t<E;t++){const r=16*e+t,i=16*e+t+1,n=16*(e+1)+t,s=16*(e+1)+t+1;w.push(n,i,r),w.push(i,n,s)}const A={};A.POSITION=new a.AttributeData(new Float32Array(x),3,0,0,0,!1,x.length/3),A.NORMAL=new a.AttributeData(new Float32Array([0,0,0,0,0,0,0,0,0,0]),3,0,0,0,!1,x.length/3);const T=new a.GeometryData(new a.PrimitiveData(A,a.PRIMITIVE_MODE.TRIANGLES,new a.AttributeData(this.convertToIndicesArray(w),1,0,0,0,!1,w.length)));return r.data.push(T),r}))}loadScene(){return r(this,void 0,void 0,(function*(){const e=new i.TreeNode("sdgtf_content");if(this._content.arcs&&e.addChild(yield this.loadArcs()),this._content.beziercurves)for(let t in this._content.beziercurves)e.addChild(yield this.loadBeziercurve(t));if(this._content.circles&&e.addChild(yield this.loadCircles()),this._content.cylinders&&e.addChild(yield this.loadCylinders()),this._content.points)for(let t in this._content.points)e.addChild(yield this.loadPoint(t));if(this._content.polylines)for(let t in this._content.polylines)e.addChild(yield this.loadPolyline(t));if(this._content.spheres&&e.addChild(yield this.loadSpheres()),this._content.surfacepatches)for(let t in this._content.surfacepatches)e.addChild(yield this.loadSurfacepatch(t));return e}))}}})),s.register("7NBET",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GLTFLoader=e.exports.GLTF_EXTENSIONS=void 0;var i=s("eYU63"),n=s("cTTbu");s("yoicn");var o,a,l=s("bJEmL"),c=s("3iqbd"),u=s("eIStk"),h=s("jxhwV"),d=s("12eGO"),f=s("dk8Lz"),p=s("eAhLl"),m=s("5ganD"),g=s("fkwHH"),v=s("fi0f0"),_=s("HhCPd"),b=s("1Reqz"),y=s("gCGTN");(a=o=e.exports.GLTF_EXTENSIONS||(e.exports.GLTF_EXTENSIONS={})).KHR_BINARY_GLTF="KHR_binary_glTF",a.KHR_DRACO_MESH_COMPRESSION="KHR_draco_mesh_compression",a.KHR_LIGHTS_PUNCTUAL="KHR_lights_punctual",a.KHR_MATERIALS_CLEARCOAT="KHR_materials_clearcoat",a.KHR_MATERIALS_IOR="KHR_materials_ior",a.KHR_MATERIALS_PBRSPECULARGLOSSINESS="KHR_materials_pbrSpecularGlossiness",a.KHR_MATERIALS_SHEEN="KHR_materials_sheen",a.KHR_MATERIALS_SPECULAR="KHR_materials_specular",a.KHR_MATERIALS_TRANSMISSION="KHR_materials_transmission",a.KHR_MATERIALS_UNLIT="KHR_materials_unlit",a.KHR_MATERIALS_VARIANTS="KHR_materials_variants",a.KHR_MATERIALS_VOLUME="KHR_materials_volume",a.KHR_MESH_QUANTIZATION="KHR_mesh_quantization",a.KHR_TEXTURE_TRANSFORM="KHR_texture_transform",a.SHAPEDIVER_MATERIALS_PRESET="SHAPEDIVER_materials_preset";var E=s("bp3PQ");e.exports.GLTFLoader=class{constructor(){this.BINARY_EXTENSION_HEADER_LENGTH=20,this._converter=l.instance.resolve(n.Converter),this._globalTransformation=c.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),this._httpClient=l.instance.resolve(n.HttpClient),this._logger=l.instance.resolve(n.Logger),this._performanceEvaluator=l.instance.resolve(n.PerformanceEvaluator),this._uuidGenerator=l.instance.resolve(n.UuidGenerator),this._nodes={}}load(e,t,i,s){var a,l;return r(this,void 0,void 0,(function*(){this._baseUri=s,t&&i&&(this._body=t.slice(this.BINARY_EXTENSION_HEADER_LENGTH+i.contentLength+8,i.length)),this._content=e;try{this.validateVersionAndExtensions();const e=yield new E;this._bufferLoader=new m.BufferLoader(this._content,this._body,this._baseUri),yield this._bufferLoader.load(),this._bufferViewLoader=new g.BufferViewLoader(this._content,this._bufferLoader),this._bufferViewLoader.load(),this._accessorLoader=new v.AccessorLoader(this._content,this._bufferViewLoader),this._accessorLoader.load(),this._textureLoader=new _.TextureLoader(this._content,this._bufferViewLoader,this._baseUri),yield this._textureLoader.load(),this._materialLoader=new b.MaterialLoader(this._content,this._textureLoader),yield this._materialLoader.load(),this._geometryLoader=new y.GeometryLoader(this._content,this._accessorLoader,this._bufferViewLoader,this._materialLoader,e);const t=this.loadScene();if(this._content.extensions&&this._content.extensions[o.KHR_MATERIALS_VARIANTS]){const e=this._content.extensions[o.KHR_MATERIALS_VARIANTS].variants;for(let t=0;t<e.length;t++)this._geometryLoader.materialVariantsData.variants.push(e[t].name);this._geometryLoader.materialVariantsData.variantIndex=0,t.data.push(this._geometryLoader.materialVariantsData)}if(void 0!==this._content.skins&&void 0!==this._content.nodes)for(let e=0;e<(null===(a=this._content.nodes)||void 0===a?void 0:a.length);e++)if(void 0!==this._content.nodes[e].skin){const t=this.loadSkin(this._content.nodes[e].skin),r=this._nodes[e],i=[],n=[];for(let e=0;e<t.joints.length;e++){this._nodes[t.joints[e]].bone=!0,i.push(this._nodes[t.joints[e]]);let r=c.create();if(void 0!==t.inverseBindMatrices){const i=t.inverseBindMatrices.array;r=c.fromValues(i[16*e+0],i[16*e+1],i[16*e+2],i[16*e+3],i[16*e+4],i[16*e+5],i[16*e+6],i[16*e+7],i[16*e+8],i[16*e+9],i[16*e+10],i[16*e+11],i[16*e+12],i[16*e+13],i[16*e+14],i[16*e+15])}n.push(r)}const s=e=>{for(let t=0;t<e.data.length;t++)e.data[t]instanceof d.GeometryData&&(e.data[t].bones=i,e.data[t].boneInverses=n);for(let t=0;t<e.children.length;t++)s(e.children[t])};s(r)}if(this._content.animations)for(let e=0;e<(null===(l=this._content.animations)||void 0===l?void 0:l.length);e++)t.data.push(this.loadAnimation(e));return t}catch(e){throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.load",e)}}))}loadWithUrl(e){return r(this,void 0,void 0,(function*(){let t,r,i,s,o;this._performanceEvaluator.startSection("gltfProcessing."+e);try{this._performanceEvaluator.startSection("loadGltf."+e),t=yield this._httpClient.get(e,{responseType:"arraybuffer"}),this._performanceEvaluator.endSection("loadGltf."+e)}catch(e){throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.load",e)}const a=(new TextDecoder).decode(new Uint8Array(t.data,0,4));if("glTF"===a||t.headers["content-type"]&&("model/gltf-binary"===t.headers["content-type"]||"application/octet-stream"===t.headers["content-type"]||"model/gltf.binary"===t.headers["content-type"])){i=t.data;const e=new DataView(i,0,this.BINARY_EXTENSION_HEADER_LENGTH);if(o={magic:a,version:e.getUint32(4,!0),length:e.getUint32(8,!0),contentLength:e.getUint32(12,!0),contentFormat:e.getUint32(16,!0)},"glTF"!=o.magic){const e=new n.ShapeDiverViewerDataProcessingError("GLTFLoader.load: Invalid data: sdgTF magic wrong.");throw this._logger.handleError(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.load",e)}const s=new DataView(i,this.BINARY_EXTENSION_HEADER_LENGTH,o.contentLength),l=(new TextDecoder).decode(s);r=JSON.parse(l),this._body=i.slice(this.BINARY_EXTENSION_HEADER_LENGTH+o.contentLength+8,o.length)}else{r=JSON.parse((new TextDecoder).decode(t.data));const i=e=>{const t=e.includes("/")?"/":"\\",r=e.split(t);return r.pop(),r.join(t)};s=i(e),!s&&window&&window.location&&window.location.href&&(s=i(window.location.href))}return yield this.load(r,i,o,s)}))}loadAnimation(e){if(!this._content.animations)throw new Error("Animations not available.");if(!this._content.animations[e])throw new Error("Animations not available.");const t=this._content.animations[e],r=[];let i=1/0,s=-1/0;for(let e=0;e<t.channels.length;e++){const o=t.channels[e],a=t.samplers[o.sampler],l=o.target,c=l.path,u=this._nodes[l.node];if(void 0===u)throw new Error("Animation node not available.");const h=this._accessorLoader.getAccessor(a.input);i=Math.min(i,h.min[0]),s=Math.max(s,h.max[0]);const d=this._accessorLoader.getAccessor(a.output);let f=a.interpolation;"CUBICSPLINE"===f&&(this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"Animation with CUBICSPLINE interpolation is currently not supported. Assigning linear interpolation instead."),f="linear"),r.push({node:u,times:h.array,values:d.array,path:c,interpolation:null==f?void 0:f.toLowerCase()})}return new d.AnimationData(t.name||"gltf_animation_"+e,r,i,s-i)}loadCamera(e){if(!this._content.cameras)throw new Error("Cameras not available.");if(!this._content.cameras[e])throw new Error("Cameras not available.");const t=this._content.cameras[e],r=new i.TreeNode(t.name||"camera_"+e);let n;if("perspective"===t.type){const e=t.perspective;n=new f.PerspectiveCamera(r.id),r.data.push(n),n.fov=e.yfov*(180/Math.PI),n.aspect=e.aspectRatio||1,n.near=e.znear||1,n.far=e.zfar||2e6}else{const e=t.orthographic;n=new f.OrthographicCamera(r.id),r.data.push(n),n.left=-e.xmag,n.right=e.xmag,n.top=-e.ymag,n.bottom=e.ymag,n.near=e.znear||1,n.far=e.zfar||2e6}return n.useNodeData=!0,n.node=r,r}loadLights(e){if(!this._content.extensions||!this._content.extensions[o.KHR_LIGHTS_PUNCTUAL]||!this._content.extensions[o.KHR_LIGHTS_PUNCTUAL].lights)throw new Error(`Extension ${o.KHR_LIGHTS_PUNCTUAL} not available.`);if(!this._content.extensions[o.KHR_LIGHTS_PUNCTUAL].lights[e])throw new Error("Light not available.");const t=this._content.extensions[o.KHR_LIGHTS_PUNCTUAL].lights[e],r=new i.TreeNode(t.name||"light_"+e);let n="#ffffffff";void 0!==t.color&&(n=this._converter.toColor([255*t.color[0],255*t.color[1],255*t.color[2]]));const s=void 0!==t.range?t.range:0;let a;if("directional"===t.type){a=new p.DirectionalLight({color:n}),r.data.push(a);const e=a;void 0!==t.intensity&&(e.intensity=t.intensity)}else if("point"===t.type){a=new p.PointLight({color:n}),r.data.push(a);const e=a;e.distance=s,e.decay=2,void 0!==t.intensity&&(a.intensity=t.intensity),e.position=[0,0,0]}else{if("spot"!==t.type)throw new Error("Unexpected light type: "+t.type);{a=new p.SpotLight({color:n}),r.data.push(a),t.spot=t.spot||{},t.spot.innerConeAngle=void 0!==t.spot.innerConeAngle?t.spot.innerConeAngle:0,t.spot.outerConeAngle=void 0!==t.spot.outerConeAngle?t.spot.outerConeAngle:Math.PI/4;const e=a;e.distance=s,e.angle=t.spot.outerConeAngle,e.penumbra=1-t.spot.innerConeAngle/t.spot.outerConeAngle,e.decay=2,void 0!==t.intensity&&(a.intensity=t.intensity),e.position=[0,0,0],e.target=[0,0,-1]}}return a.useNodeData=!0,r}loadNode(e){if(!this._content.nodes)throw new Error("Nodes not available.");if(!this._content.nodes[e])throw new Error("Node not available.");const t=this._content.nodes[e],r=new i.TreeNode(t.name||"node_"+e);if(this._nodes[e]=r,t.matrix)r.transformations.push({id:"gltf_matrix",matrix:c.fromValues(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5],t.matrix[6],t.matrix[7],t.matrix[8],t.matrix[9],t.matrix[10],t.matrix[11],t.matrix[12],t.matrix[13],t.matrix[14],t.matrix[15])}),r.transformations.push({id:"gltf_matrix_translation",matrix:c.create()}),r.transformations.push({id:"gltf_matrix_rotation",matrix:c.create()}),r.transformations.push({id:"gltf_matrix_scale",matrix:c.create()});else if(t.translation||t.scale||t.rotation){const e=t.translation?c.fromTranslation(c.create(),u.fromValues(t.translation[0],t.translation[1],t.translation[2])):c.create(),i=t.scale?c.fromScaling(c.create(),u.fromValues(t.scale[0],t.scale[1],t.scale[2])):c.create(),n=t.rotation?c.fromQuat(c.create(),h.fromValues(t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3])):c.create();r.transformations.push({id:"gltf_matrix_translation",matrix:e}),r.transformations.push({id:"gltf_matrix_rotation",matrix:n}),r.transformations.push({id:"gltf_matrix_scale",matrix:i})}if(void 0!==t.mesh&&r.addChild(this._geometryLoader.loadMesh(t.mesh,t.weights)),void 0!==t.camera&&r.addChild(this.loadCamera(t.camera)),t.extensions&&t.extensions[o.KHR_LIGHTS_PUNCTUAL]&&r.addChild(this.loadLights(t.extensions[o.KHR_LIGHTS_PUNCTUAL].light)),t.children)for(let e=0,i=t.children.length;e<i;e++)r.addChild(this.loadNode(t.children[e]));return r}loadScene(){if(!this._content.scenes)throw new Error("Scenes not available.");const e=this._content.scene||0;if(!this._content.scenes[e])throw new Error("Scene not available.");const t=this._content.scenes[e],r=new i.TreeNode(t.name||"scene_"+e);if(r.transformations.push({id:this._uuidGenerator.create(),matrix:this._globalTransformation}),t.nodes)for(let e=0,i=t.nodes.length;e<i;e++)r.addChild(this.loadNode(t.nodes[e]));return r}loadSkin(e){if(!this._content.skins)throw new Error("Skins not available.");if(!this._content.skins[e])throw new Error("Skin not available.");const t=this._content.skins[e],r={joints:t.joints,inverseBindMatrices:null};return void 0===t.inverseBindMatrices||(r.inverseBindMatrices=this._accessorLoader.getAccessor(t.inverseBindMatrices)),r}validateVersionAndExtensions(){if(!this._content.asset)throw new Error("Asset not available.");const e=this._content.asset;if(!e.version)throw new Error("Asset does not have a version.");if(!(e.minVersion?e.minVersion:e.version).startsWith("2"))throw new Error("Version of the glTF not supported.");if(this._content.extensionsUsed){const e=[];for(let t=0;t<this._content.extensionsUsed.length;t++)Object.values(o).includes(this._content.extensionsUsed[t])||e.push(this._content.extensionsUsed[t]);if(e.length>0){let t="Extension"+(1===e.length?" ":"s ");e.forEach(((r,i)=>{t+='"'+r+'"'+(i===e.length-1?"":i===e.length-2?" and ":", ")})),t+=(1===e.length?" is":" are")+" not supported, but used. Loading glTF regardless.",this._logger.info(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.validateVersionAndExtensions: "+t)}}if(this._content.extensionsRequired){const e=[];for(let t=0;t<this._content.extensionsRequired.length;t++)Object.values(o).includes(this._content.extensionsRequired[t])||e.push(this._content.extensionsRequired[t]);if(e.length>0){let t="Extension"+(1===e.length?" ":"s ");throw e.forEach(((r,i)=>{t+='"'+r+'"'+(i===e.length-1?"":i===e.length-2?" and ":", ")})),t+=(1===e.length?" is":" are")+" not supported, but required. Aborting glTF loading.",new Error(t)}}}}})),s.register("5ganD",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BufferLoader=void 0,s("yoicn");var i=s("bJEmL"),n=s("cTTbu");e.exports.BufferLoader=class{constructor(e,t,r){this._content=e,this._body=t,this._baseUri=r,this._httpClient=i.instance.resolve(n.HttpClient),this._loaded={}}getBuffer(e){if(!this._content.buffers)throw new Error("BufferLoader.getBuffer: Buffers not available.");if(!this._content.buffers[e])throw new Error("BufferLoader.getBuffer: Buffer not available.");if(!this._loaded[e])throw new Error("BufferLoader.getBuffer: Buffer not loaded.");return this._loaded[e]}load(){return r(this,void 0,void 0,(function*(){if(!this._content.buffers)return;let e=[];for(let t=0;t<this._content.buffers.length;t++){const r=t,i=this._content.buffers[r];if(i.type&&"arraybuffer"!==i.type)throw new Error(`BufferLoader.load: ${i.type} is not supported.`);if(void 0===i.uri&&0===r){if(!this._body)throw new Error("BufferLoader.load: Buffer not available.");return void(this._loaded[r]=this._body)}const n=/^data:(.*?)(;base64)?,(.*)$/,s=i.uri.match(n);if(s){const e=!!s[2];let t=s[3];t=decodeURIComponent(t),e&&(t=atob(t));const i=new Uint8Array(t.length);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);this._loaded[r]=i.buffer}else{let t=this._httpClient.get(this._baseUri+"/"+i.uri,{responseType:"arraybuffer"}).then((e=>{this._loaded[r]=e.data}));e.push(t)}}yield Promise.all(e)}))}}})),s.register("fkwHH",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BufferViewLoader=void 0;e.exports.BufferViewLoader=class{constructor(e,t){this._content=e,this._bufferLoader=t,this._loaded={}}getBufferView(e){if(!this._content.bufferViews)throw new Error("BufferViewLoader.load: BufferViews not available.");if(!this._content.bufferViews[e])throw new Error("BufferViewLoader.load: BufferView not available.");if(!this._loaded[e])throw new Error("BufferViewLoader.load: BufferView not loaded.");return this._loaded[e]}load(){if(this._content.bufferViews)for(let e=0;e<this._content.bufferViews.length;e++){const t=e;if(!this._content.bufferViews[t])throw new Error("BufferViewLoader.load: BufferView not available.");const r=this._content.bufferViews[t],i=r.byteLength||0,n=r.byteOffset||0;if(void 0===r.buffer)throw new Error("BufferViewLoader.load: BufferView has no buffer defined.");const s=this._bufferLoader.getBuffer(r.buffer).slice(n,n+i);this._loaded[t]=s}}}})),s.register("fi0f0",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AccessorLoader=void 0;var r=s("12eGO"),i=s("1BiQ9"),n=s("cTTbu");s("yoicn");var o=s("bJEmL");e.exports.AccessorLoader=class{constructor(e,t){this._content=e,this._bufferViewLoader=t,this._logger=o.instance.resolve(n.Logger),this._loaded={}}getAccessor(e){if(!this._content.accessors)throw new Error("AccessorLoader.getAccessor: Accessors not available.");if(!this._content.accessors[e])throw new Error("AccessorLoader.getAccessor: Accessor not available.");if(!this._loaded[e])throw new Error("AccessorLoader.getAccessor: Accessor not loaded.");return this._loaded[e]}load(){if(this._content.accessors)for(let e=0;e<this._content.accessors.length;e++){const t=e;if(!this._content.accessors[t])throw new Error("AccessorLoader.load: BufferView not available.");const s=this._content.accessors[t];if(void 0===s.bufferView){this._loaded[t]=null;continue}const o=this._bufferViewLoader.getBufferView(s.bufferView),a=i.ACCESSORTYPE_V2[s.type];5124===s.componentType&&this._logger.warn(n.LOGGINGTOPIC.DATA_PROCESSING,"GLTFLoader.loadAccessor: The componentType for this accessor is 5124, which is not allowed. Trying to load it anyway.");const l=i.ACCESSORCOMPONENTTYPE_V2[s.componentType],c=l.BYTES_PER_ELEMENT,u=c*a,h=s.byteOffset||0,d=void 0!==s.bufferView&&this._content.bufferViews?this._content.bufferViews[s.bufferView].byteStride:void 0,f=!0===s.normalized;let p;if(d&&d!==u){p=new l(o,Math.floor(h/d)*d,s.count*d/c)}else p=null===o?new l(s.count*a):new l(o,h,s.count*a);if(f){const e=this.getNormalizedComponentScale(l),t=new Float32Array(p.length);for(let r=0,i=p.length;r<i;r++)t[r]=p[r]*e;p=t}if(void 0===s.sparse)this._loaded[t]=new r.AttributeData(p,a,u,h,c,f,s.count,s.min,s.max,d);else{const e=i.ACCESSORTYPE_V2.SCALAR,n=i.ACCESSORCOMPONENTTYPE_V2[s.sparse.indices.componentType],o=s.sparse.indices.byteOffset||0,m=s.sparse.values.byteOffset||0;if(!s.sparse.indices.bufferView||!s.sparse.values.bufferView)throw new Error("Sparse Mesh not properly defined.");const g=new n(this._bufferViewLoader.getBufferView(s.sparse.indices.bufferView),o,s.sparse.count*e),v=new l(this._bufferViewLoader.getBufferView(s.sparse.values.bufferView),m,s.sparse.count*a);this._loaded[t]=new r.AttributeData(p,a,u,h,c,f,s.count,s.min,s.max,d,!0,g,v)}}}getNormalizedComponentScale(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}}})),s.register("HhCPd",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TextureLoader=void 0;var i=s("cTTbu");s("yoicn");var n=s("bJEmL");e.exports.TextureLoader=class{constructor(e,t,r){this._content=e,this._bufferViewLoader=t,this._baseUri=r,this._converter=n.instance.resolve(i.Converter),this._httpClient=n.instance.resolve(i.HttpClient),this._loadData=this._httpClient.loadData.bind(this._httpClient),this._loaded={}}getTexture(e){if(!this._content.textures)throw new Error("TextureLoader.getTexture: Textures not available.");if(!this._content.textures[e])throw new Error("TextureLoader.getTexture: Texture not available.");if(!this._loaded[e])throw new Error("TextureLoader.getTexture: Texture not loaded.");return this._loaded[e]}load(){return r(this,void 0,void 0,(function*(){if(!this._content.textures)return;let e=[];for(let t=0;t<this._content.textures.length;t++){const r=t,i=this._content.textures[r];if(!this._content.images)throw new Error("TextureLoader.load: Images not available.");const n=this._content.images[i.source],s=/^data:(.*?)(;base64)?,(.*)$/,o=/^https:\/\//;if(void 0!==n.bufferView){const t=this._bufferViewLoader.getBufferView(n.bufferView),i=new DataView(t),s=[];for(let e=0;e<i.byteLength;e+=1)s[e]=i.getUint8(e);const o=new Blob([new Uint8Array(s)],{type:n.mimeType}),a=window.URL.createObjectURL(o);e.push(new Promise((e=>{this._loadData(a).then((t=>{this._converter.responseToImage(t).then((t=>{this._loaded[r]=t,e()}))}))})))}else{const t=s.test(n.uri)||o.test(n.uri)?n.uri:`${this._baseUri}/${n.uri}`;e.push(new Promise((e=>{this._loadData(t).then((t=>{this._converter.responseToImage(t).then((t=>{this._loaded[r]=t,e()}))}))})))}}yield Promise.all(e)}))}}})),s.register("1Reqz",(function(e,t){var r=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialLoader=void 0;var i=s("cTTbu");s("yoicn");var n=s("bJEmL"),o=s("6BoVD"),a=s("12eGO"),l=s("loGDz"),c=s("7NBET");e.exports.MaterialLoader=class{constructor(e,t){this._content=e,this._textureLoader=t,this._converter=n.instance.resolve(i.Converter),this._materialEngine=n.instance.resolve(l.MaterialEngine),this._loaded={}}getMaterial(e){if(!this._content.materials)throw new Error("MaterialLoader.getMaterial: Materials not available.");if(!this._content.materials[e])throw new Error("MaterialLoader.getMaterial: Material not available.");if(!this._loaded[e])throw new Error("MaterialLoader.getMaterial: Material not loaded.");return this._loaded[e]}load(){return r(this,void 0,void 0,(function*(){if(!this._content.materials)return;let e=[];for(let t=0;t<this._content.materials.length;t++){const i=t,n=this._content.materials[i],s=n.extensions||{},o={};if(void 0!==n.name&&(o.name=n.name),s[c.GLTF_EXTENSIONS.SHAPEDIVER_MATERIALS_PRESET]){const t=s[c.GLTF_EXTENSIONS.SHAPEDIVER_MATERIALS_PRESET],n=new a.MaterialStandardData(o);e.push(new Promise((e=>r(this,void 0,void 0,(function*(){yield this._materialEngine.loadPresetMaterial(t.materialpreset,n),n.color=this._converter.toColor(t.color),this._loaded[i]=n,e()})))));continue}if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_PBRSPECULARGLOSSINESS]){const e=s[c.GLTF_EXTENSIONS.KHR_MATERIALS_PBRSPECULARGLOSSINESS],t=o;if(t.color="#ffffff",t.opacity=1,void 0!==e.diffuseFactor&&(t.color=this._converter.toColor([255*e.diffuseFactor[0],255*e.diffuseFactor[1],255*e.diffuseFactor[2]]),t.opacity=e.diffuseFactor[3]),void 0!==e.diffuseTexture){const r=e.diffuseTexture.extensions&&e.diffuseTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.diffuseTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;t.map=this.loadMap(e.diffuseTexture.index,r)}if(t.emissiveness="#000000",t.glossiness=void 0!==e.glossinessFactor?e.glossinessFactor:1,t.specular="#ffffff",void 0!==e.specularFactor&&(t.specular=this._converter.toColor([255*e.specularFactor[0],255*e.specularFactor[1],255*e.specularFactor[2]])),void 0!==e.specularGlossinessTexture){const r=e.specularGlossinessTexture.extensions&&e.specularGlossinessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.specularGlossinessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;t.specularGlossinessMap=this.loadMap(e.specularGlossinessTexture.index,r)}}else if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_UNLIT]){const e=o;if(e.color="#ffffff",e.opacity=1,void 0!==n.pbrMetallicRoughness&&(void 0!==n.pbrMetallicRoughness.baseColorFactor&&(e.color=this._converter.toColor([255*n.pbrMetallicRoughness.baseColorFactor[0],255*n.pbrMetallicRoughness.baseColorFactor[1],255*n.pbrMetallicRoughness.baseColorFactor[2]]),e.opacity=n.pbrMetallicRoughness.baseColorFactor[3]),void 0!==n.pbrMetallicRoughness.baseColorTexture)){const t=n.pbrMetallicRoughness.baseColorTexture.extensions&&n.pbrMetallicRoughness.baseColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?n.pbrMetallicRoughness.baseColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;e.map=this.loadMap(n.pbrMetallicRoughness.baseColorTexture.index,t)}}else{const e=o;if(void 0!==n.pbrMetallicRoughness){if(e.color="#ffffff",void 0!==n.pbrMetallicRoughness.baseColorFactor&&(e.color=this._converter.toColor([255*n.pbrMetallicRoughness.baseColorFactor[0],255*n.pbrMetallicRoughness.baseColorFactor[1],255*n.pbrMetallicRoughness.baseColorFactor[2]]),e.opacity=n.pbrMetallicRoughness.baseColorFactor[3]),void 0!==n.pbrMetallicRoughness.baseColorTexture){const t=n.pbrMetallicRoughness.baseColorTexture.extensions&&n.pbrMetallicRoughness.baseColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?n.pbrMetallicRoughness.baseColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;e.map=this.loadMap(n.pbrMetallicRoughness.baseColorTexture.index,t)}if(void 0!==n.pbrMetallicRoughness.metallicFactor&&(e.metalness=n.pbrMetallicRoughness.metallicFactor),void 0!==n.pbrMetallicRoughness.roughnessFactor&&(e.roughness=n.pbrMetallicRoughness.roughnessFactor),void 0!==n.pbrMetallicRoughness.metallicRoughnessTexture){const t=n.pbrMetallicRoughness.metallicRoughnessTexture.extensions&&n.pbrMetallicRoughness.metallicRoughnessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?n.pbrMetallicRoughness.metallicRoughnessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;e.metalnessRoughnessMap=this.loadMap(n.pbrMetallicRoughness.metallicRoughnessTexture.index,t)}}}if(void 0!==n.normalTexture){const e=n.normalTexture.extensions&&n.normalTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?n.normalTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;o.normalMap=this.loadMap(n.normalTexture.index,e),o.normalScale=1,void 0!==n.normalTexture.scale&&(o.normalScale=n.normalTexture.scale)}if(void 0!==n.occlusionTexture){const e=n.occlusionTexture.extensions&&n.occlusionTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?n.occlusionTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;o.aoMap=this.loadMap(n.occlusionTexture.index,e),void 0!==n.occlusionTexture.strength&&(o.aoMapIntensity=n.occlusionTexture.strength)}if(void 0!==n.emissiveTexture){const e=n.emissiveTexture.extensions&&n.emissiveTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?n.emissiveTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;o.emissiveMap=this.loadMap(n.emissiveTexture.index,e)}if(void 0!==n.emissiveFactor&&(o.emissiveness=this._converter.toColor([255*n.emissiveFactor[0],255*n.emissiveFactor[1],255*n.emissiveFactor[2]])),void 0!==n.alphaMode&&(o.alphaMode=n.alphaMode.toLowerCase()===a.MATERIAL_ALPHA.MASK?a.MATERIAL_ALPHA.MASK:n.alphaMode.toLowerCase()===a.MATERIAL_ALPHA.BLEND?a.MATERIAL_ALPHA.BLEND:a.MATERIAL_ALPHA.OPAQUE,o.alphaMode===a.MATERIAL_ALPHA.MASK&&(o.alphaCutoff=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.alphaCutoff&&(o.alphaCutoff=n.alphaCutoff),void 0!==n.doubleSided&&(o.side=n.doubleSided?a.MATERIAL_SIDE.DOUBLE:a.MATERIAL_SIDE.FRONT),s[c.GLTF_EXTENSIONS.KHR_MATERIALS_PBRSPECULARGLOSSINESS]){const e=o;this._loaded[i]=new a.MaterialSpecularGlossinessData(e);continue}if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_UNLIT]){const e=o;this._loaded[i]=new a.MaterialUnlitData(e);continue}const l=o;if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_CLEARCOAT]){const e=s[c.GLTF_EXTENSIONS.KHR_MATERIALS_CLEARCOAT];if(void 0!==e.clearcoatFactor&&(l.clearcoat=e.clearcoatFactor),void 0!==e.clearcoatTexture){const t=e.clearcoatTexture.extensions&&e.clearcoatTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.clearcoatTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.clearcoatMap=this.loadMap(e.clearcoatTexture.index,t)}if(void 0!==e.clearcoatRoughnessFactor&&(l.clearcoatRoughness=e.clearcoatRoughnessFactor),void 0!==e.clearcoatRoughnessTexture){const t=e.clearcoatRoughnessTexture.extensions&&e.clearcoatRoughnessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.clearcoatRoughnessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.clearcoatRoughnessMap=this.loadMap(e.clearcoatRoughnessTexture.index,t)}if(void 0!==e.clearcoatNormalTexture){const t=e.clearcoatNormalTexture.extensions&&e.clearcoatNormalTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.clearcoatNormalTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.clearcoatNormalMap=this.loadMap(e.clearcoatNormalTexture.index,t)}}if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_IOR]){const e=s[c.GLTF_EXTENSIONS.KHR_MATERIALS_IOR];void 0!==e.ior&&(l.ior=e.ior)}if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_TRANSMISSION]){const e=s[c.GLTF_EXTENSIONS.KHR_MATERIALS_TRANSMISSION];if(void 0!==e.transmissionFactor&&(l.transmission=e.transmissionFactor),void 0!==e.transmissionTexture){const t=e.transmissionTexture.extensions&&e.transmissionTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.transmissionTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.transmissionMap=this.loadMap(e.transmissionTexture.index,t)}}if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_VOLUME]){const e=s[c.GLTF_EXTENSIONS.KHR_MATERIALS_VOLUME];if(void 0!==e.thicknessFactor&&(l.thickness=e.thicknessFactor),void 0!==e.thicknessTexture){const t=e.thicknessTexture.extensions&&e.thicknessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.thicknessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.thicknessMap=this.loadMap(e.thicknessTexture.index,t)}void 0!==e.attenuationDistance&&(l.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&(l.attenuationColor=this._converter.toColor([255*e.attenuationColor[0],255*e.attenuationColor[1],255*e.attenuationColor[2]]))}if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_SHEEN]){const e=s[c.GLTF_EXTENSIONS.KHR_MATERIALS_SHEEN];if(l.sheen=1,void 0!==e.sheenColorFactor&&(l.sheenColor=this._converter.toColor([255*e.sheenColorFactor[0],255*e.sheenColorFactor[1],255*e.sheenColorFactor[2]])),void 0!==e.sheenRoughnessFactor&&(l.sheenRoughness=e.sheenRoughnessFactor),void 0!==e.sheenColorTexture){const t=e.sheenColorTexture.extensions&&e.sheenColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.sheenColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.sheenColorMap=this.loadMap(e.sheenColorTexture.index,t)}if(void 0!==e.sheenRoughnessTexture){const t=e.sheenRoughnessTexture.extensions&&e.sheenRoughnessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.sheenRoughnessTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.sheenRoughnessMap=this.loadMap(e.sheenRoughnessTexture.index,t)}}if(s[c.GLTF_EXTENSIONS.KHR_MATERIALS_SPECULAR]){const e=s[c.GLTF_EXTENSIONS.KHR_MATERIALS_SPECULAR];if(void 0!==e.specularFactor&&(l.specularIntensity=e.specularFactor),void 0!==e.specularColorFactor&&(l.specularColor=this._converter.toColor([255*e.specularColorFactor[0],255*e.specularColorFactor[1],255*e.specularColorFactor[2]])),void 0!==e.specularColorTexture){const t=e.specularColorTexture.extensions&&e.specularColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.specularColorTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.specularColorMap=this.loadMap(e.specularColorTexture.index,t)}if(void 0!==e.specularTexture){const t=e.specularTexture.extensions&&e.specularTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]?e.specularTexture.extensions[c.GLTF_EXTENSIONS.KHR_TEXTURE_TRANSFORM]:void 0;l.specularIntensityMap=this.loadMap(e.specularTexture.index,t)}}this._loaded[i]=new a.MaterialStandardData(l)}yield Promise.all(e)}))}loadMap(e,t){if(!this._content.textures)throw new Error("Textures not available.");const r=this._content.textures[e];if(!this._content.images)throw new Error("Images not available.");const i=this._content.samplers&&r.sampler&&this._content.samplers[r.sampler]?this._content.samplers[r.sampler]:{},n=this._textureLoader.getTexture(e);return new a.MapData(n,i.wrapS,i.wrapT,i.minFilter,i.magFilter,void 0,void 0,t&&t.offset?o.fromValues(t.offset[0],t.offset[1]):void 0,t&&t.scale?o.fromValues(t.scale[0],t.scale[1]):void 0,t&&void 0!==t.rotation?t.rotation:0,!1)}}})),s.register("loGDz",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialEngine=void 0;var r=s("iJWNp");Object.defineProperty(e.exports,"MaterialEngine",{enumerable:!0,get:function(){return r.MaterialEngine}})})),s.register("iJWNp",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MaterialEngine=void 0;var o=s("eYU63");s("yoicn");var a=s("bJEmL"),l=s("crO5Z"),c=s("cTTbu"),u=s("12eGO"),h=s("6BoVD"),d=s("jxhwV"),f=s("i34v7");let p=class{constructor(){this._converter=a.instance.resolve(c.Converter),this._httpClient=a.instance.resolve(c.HttpClient),this._logger=a.instance.resolve(c.Logger),this._loadData=this._httpClient.loadData.bind(this._httpClient)}loadContent(e){return n(this,void 0,void 0,(function*(){const t=new o.TreeNode(e.name||"material");if(!e){const e=new c.ShapeDiverViewerDataProcessingError("MaterialEngine.loadContent: Invalid content was provided to material engine.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"MaterialEngine.loadContent",e)}const r=new u.MaterialStandardData;if(t.data.push(r),!e.data){const e=new c.ShapeDiverViewerDataProcessingError("MaterialEngine.loadContent: No material data was provided to material engine.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"MaterialEngine.loadContent",e)}{const t=e.data;if(t.materialpreset&&(yield this.loadPresetMaterial(t.materialpreset,r)),t.materialType&&"standard"!==t.materialType);else if(t.version)if("1.0"===t.version)yield this.loadMaterialV1(t,r);else if("2.0"===t.version)yield this.loadMaterialV2(t,r);else{if("3.0"!==t.version){const e=new c.ShapeDiverViewerDataProcessingError("MaterialEngine.loadContent: Material data version not supported.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"MaterialEngine.loadContent",e)}yield this.loadMaterialV3(t,r)}}return t}))}assignGeneralDefinition(e,t,r,i){return n(this,void 0,void 0,(function*(){if(t.transparencytexture&&!r.transparencytexture){const r=yield this.loadMap(t.transparencytexture,e.class);r&&(i.alphaMap=r)}if(t.hasOwnProperty("alphaThreshold")&&!r.hasOwnProperty("alphaThreshold")&&(i.alphaCutoff=t.alphaThreshold),t.bumptexture&&!r.bumptexture){const r=yield this.loadMap(t.bumptexture,e.class);r&&(i.bumpMap=r)}if(t.hasOwnProperty("bumpAmplitude")&&!r.hasOwnProperty("bumpAmplitude")&&(i.bumpScale=t.bumpAmplitude),t.color&&!r.color&&(i.color=this._converter.toColor(t.color)),t.bitmaptexture&&!r.bitmaptexture){const r=yield this.loadMap(t.bitmaptexture,e.class);r&&(i.map=r)}if(t.hasOwnProperty("metalness")&&!r.hasOwnProperty("metalness")&&(i.metalness=t.metalness),t.metalnesstexture&&!r.metalnesstexture){const r=yield this.loadMap(t.metalnesstexture,e.class);r&&(i.metalnessMap=r)}if(t.normaltexture&&!r.normaltexture){const r=yield this.loadMap(t.normaltexture,e.class);r&&(i.normalMap=r)}if(t.hasOwnProperty("transparency")&&!r.hasOwnProperty("transparency")&&(i.opacity=1-t.transparency),t.hasOwnProperty("roughness")&&!r.hasOwnProperty("roughness")&&(i.roughness=t.roughness),t.roughnesstexture&&!r.roughnesstexture){const r=yield this.loadMap(t.roughnesstexture,e.class);r&&(i.roughnessMap=r)}t.side&&!r.side&&(i.side="front"===t.side?u.MATERIAL_SIDE.FRONT:"back"===t.side?u.MATERIAL_SIDE.BACK:u.MATERIAL_SIDE.DOUBLE)}))}assignSpecificDefinition(e,t,r){return n(this,void 0,void 0,(function*(){if(t.transparencytexture){const i=yield this.loadMap(t.transparencytexture,e.class+"/"+e.specific);i&&(r.alphaMap=i)}if(t.hasOwnProperty("alphaThreshold")&&(r.alphaCutoff=t.alphaThreshold),t.bumptexture){const i=yield this.loadMap(t.bumptexture,e.class+"/"+e.specific);i&&(r.bumpMap=i)}if(t.hasOwnProperty("bumpAmplitude")&&(r.bumpScale=t.bumpAmplitude),t.color&&(r.color=this._converter.toColor(t.color)),t.bitmaptexture){const i=yield this.loadMap(t.bitmaptexture,e.class+"/"+e.specific);i&&(r.map=i)}if(t.hasOwnProperty("metalness")&&(r.metalness=t.metalness),t.metalnesstexture){const i=yield this.loadMap(t.metalnesstexture,e.class+"/"+e.specific);i&&(r.metalnessMap=i)}if(t.normaltexture){const i=yield this.loadMap(t.normaltexture,e.class+"/"+e.specific);i&&(r.normalMap=i)}if(t.hasOwnProperty("transparency")&&(r.opacity=1-t.transparency),t.hasOwnProperty("roughness")&&(r.roughness=t.roughness),t.roughnesstexture){const i=yield this.loadMap(t.roughnesstexture,e.class+"/"+e.specific);i&&(r.roughnessMap=i)}t.side&&(r.side="front"===t.side?u.MATERIAL_SIDE.FRONT:"back"===t.side?u.MATERIAL_SIDE.BACK:u.MATERIAL_SIDE.DOUBLE)}))}getClassAndSpecificID(e){e<100&&e%10==0&&(e/=10),e<10&&(e*=100);const t=e=>String(e).padStart(2,"0").slice(0,2);return{class:t(Math.floor(e/100)),specific:t(e-100*Math.floor(e/100))}}loadMap(e,t){return n(this,void 0,void 0,(function*(){let r;try{r=t?yield this._converter.responseToImage(yield this._loadData("https://viewer.shapediver.com/v2/materials/1024/"+t+"/"+e)):yield this._converter.responseToImage(yield this._loadData(e))}catch(e){throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"MaterialEngine.loadMap",e)}return new u.MapData(r)}))}loadMapWithProperties(e){return n(this,void 0,void 0,(function*(){let t;try{t=yield this._converter.responseToImage(yield this._loadData(e.href))}catch(e){throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"MaterialEngine.loadMapWithProperties",e)}const r=1===e.wrapS?u.TEXTURE_WRAPPING.CLAMP_TO_EDGE:2===e.wrapS?u.TEXTURE_WRAPPING.MIRRORED_REPEAT:u.TEXTURE_WRAPPING.REPEAT,i=1===e.wrapT?u.TEXTURE_WRAPPING.CLAMP_TO_EDGE:2===e.wrapT?u.TEXTURE_WRAPPING.MIRRORED_REPEAT:u.TEXTURE_WRAPPING.REPEAT,n=e.center?h.fromValues(e.center[0],e.center[1]):h.fromValues(0,0),s=e.color?d.fromValues(e.color[0]/255,e.color[1]/255,e.color[2]/255,e.color[3]/255):d.fromValues(1,1,1,1),o=e.offset?h.fromValues(e.offset[0],e.offset[1]):h.fromValues(0,0),a=e.repeat?h.fromValues(e.repeat[0],e.repeat[1]):h.fromValues(1,1);return new u.MapData(t,r,i,u.TEXTURE_FILTERING.LINEAR_MIPMAP_LINEAR,u.TEXTURE_FILTERING.LINEAR,n,this._converter.toColor(s),o,a,e.rotation||0)}))}loadMaterialV1(e,t){return n(this,void 0,void 0,(function*(){if(e.color?t.color=this._converter.toColor(e.color):e.diffuse&&(t.color=this._converter.toColor(e.diffuse)),e.emission&&(t.emissiveness=this._converter.toColor(e.emission)),(e.shine||0===e.shine)&&(t.metalness=Math.min(1,e.shine),t.roughness=1-Math.min(1,e.shine)),e.hasOwnProperty("transparency")&&(t.opacity=1-e.transparency),e.bitmaptexture){const r=yield this.loadMap(e.bitmaptexture);r&&(t.map=r)}if(e.bumptexture){const r=yield this.loadMap(e.bumptexture);r&&(t.bumpMap=r)}if(e.transparencytexture){const r=yield this.loadMap(e.transparencytexture);r&&(t.alphaMap=r)}}))}loadMaterialV2(e,t){return n(this,void 0,void 0,(function*(){if(e.color&&(t.color=this._converter.toColor(e.color)),t.side="front"===e.side?u.MATERIAL_SIDE.FRONT:"back"===e.side?u.MATERIAL_SIDE.BACK:u.MATERIAL_SIDE.DOUBLE,(e.metalness||0===e.metalness)&&(t.metalness=e.metalness),(e.roughness||0===e.roughness)&&(t.roughness=e.roughness),e.hasOwnProperty("transparency")&&(t.opacity=1-e.transparency),(e.alphaThreshold||0===e.alphaThreshold)&&(t.alphaCutoff=e.alphaThreshold),e.bitmaptexture){const r=yield this.loadMap(e.bitmaptexture);r&&(t.map=r)}if(e.metalnesstexture){const r=yield this.loadMap(e.metalnesstexture);r&&(t.metalnessMap=r)}if(e.roughnesstexture){const r=yield this.loadMap(e.roughnesstexture);r&&(t.roughnessMap=r)}if(e.bumptexture){const r=yield this.loadMap(e.bumptexture);r&&(t.bumpMap=r)}if(e.normaltexture){const r=yield this.loadMap(e.normaltexture);r&&(t.normalMap=r)}if(e.transparencytexture){const r=yield this.loadMap(e.transparencytexture);r&&(t.alphaMap=r)}}))}loadMaterialV3(e,t){return n(this,void 0,void 0,(function*(){if(e.color&&(t.color=this._converter.toColor(e.color)),t.side="front"===e.side?u.MATERIAL_SIDE.FRONT:"back"===e.side?u.MATERIAL_SIDE.BACK:u.MATERIAL_SIDE.DOUBLE,(e.metalness||0===e.metalness)&&(t.metalness=e.metalness),(e.roughness||0===e.roughness)&&(t.roughness=e.roughness),e.hasOwnProperty("transparency")&&(t.opacity=1-e.transparency),(e.alphaThreshold||0===e.alphaThreshold)&&(t.alphaCutoff=e.alphaThreshold),(e.bumpAmplitude||0===e.bumpAmplitude)&&(t.bumpScale=e.bumpAmplitude),e.bitmaptexture){const r=yield this.loadMapWithProperties(e.bitmaptexture);r&&(t.map=r)}if(e.metalnesstexture){const r=yield this.loadMapWithProperties(e.metalnesstexture);r&&(t.metalnessMap=r)}if(e.roughnesstexture){const r=yield this.loadMapWithProperties(e.roughnesstexture);r&&(t.roughnessMap=r)}if(e.bumptexture){const r=yield this.loadMapWithProperties(e.bumptexture);r&&(t.bumpMap=r)}if(e.normaltexture){const r=yield this.loadMapWithProperties(e.normaltexture);r&&(t.normalMap=r)}if(e.transparencytexture){const r=yield this.loadMapWithProperties(e.transparencytexture);r&&(t.alphaMap=r)}}))}loadPresetMaterial(e,t){return n(this,void 0,void 0,(function*(){const r=this.getClassAndSpecificID(e);f.materialDatabase[r.class]&&f.materialDatabase[r.class][r.specific]?(yield this.assignSpecificDefinition(r,f.materialDatabase[r.class][r.specific],t),yield this.assignGeneralDefinition(r,f.materialDatabase[r.class].properties,f.materialDatabase[r.class][r.specific],t)):f.materialDatabase[r.class]&&f.materialDatabase[r.class]["00"]?(yield this.assignSpecificDefinition({class:r.class,specific:"00"},f.materialDatabase[r.class]["00"],t),yield this.assignGeneralDefinition({class:r.class,specific:"00"},f.materialDatabase[r.class].properties,f.materialDatabase[r.class]["00"],t)):(yield this.assignSpecificDefinition({class:"00",specific:"00"},f.materialDatabase["00"]["00"],t),yield this.assignGeneralDefinition({class:"00",specific:"00"},f.materialDatabase["00"].properties,f.materialDatabase["00"]["00"],t))}))}};p=r([l.default(),i("design:paramtypes",[])],p),e.exports.MaterialEngine=p})),s.register("i34v7",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.materialDatabase=void 0,e.exports.materialDatabase={"00":{"00":{name:"Default material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Default materials"}},"01":{"01":{name:"Default groundplane material",color:[211,211,211,255],metalness:0,roughness:1},properties:{name:"Groundplane materials"}},"02":{"00":{name:"Default plastic material",color:[211,211,211,255],metalness:0,roughness:1,normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Plastic materials"}},"03":{"00":{name:"Default metal material",color:[205,205,205,255],roughness:.25},"01":{name:"Used metal material 1",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},"02":{name:"Used metal material 2",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},"03":{name:"Used metal material 3",color:[205,205,205,255],roughness:1,roughnesstexture:"roughnessMap.jpg"},10:{name:"Gold material",color:[230,207,92,255],roughness:0},11:{name:"Used gold material",color:[230,207,92,255],roughness:0,roughnesstexture:"roughnessMap.jpg"},21:{name:"Hammered metal material",color:[205,205,205,255],roughness:1,normaltexture:"normalMap.jpg"},properties:{name:"Metal materials",metalness:1}},"04":{"00":{name:"Default glass material",color:[211,211,211,255],metalness:1,roughness:0,transparency:.75},properties:{name:"Glass materials"}},"05":{"00":{bitmaptexture:"map.jpg",name:"Default wood material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Wood floor material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},10:{bitmaptexture:"map.jpg",name:"Natural oak material",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},11:{bitmaptexture:"map.jpg",name:"Premium oak material",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Wood materials",color:[211,211,211,255],metalness:0,roughness:1}},"06":{"00":{bitmaptexture:"map.jpg",name:"Default leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Dark brown leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"02":{bitmaptexture:"map.jpg",name:"Black leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},10:{bitmaptexture:"map.jpg",name:"Worn leather material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Leather materials",metalness:0,roughness:1}},"07":{"00":{bitmaptexture:"map.jpg",name:"Default fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},"01":{bitmaptexture:"map.jpg",name:"Grey fabric material",metalnesstexture:"metalnessMap.jpg",normaltexture:"normalMap.jpg",roughnesstexture:"roughnessMap.jpg"},properties:{name:"Fabric materials",metalness:1,roughness:1}}}})),s.register("gCGTN",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GeometryLoader=void 0;var r=s("eYU63"),i=s("12eGO"),n=s("7NBET");e.exports.GeometryLoader=class{constructor(e,t,r,n,s){this._content=e,this._accessorLoader=t,this._bufferViewLoader=r,this._materialLoader=n,this._dracoModule=s,this._materialVariantsData=new i.MaterialVariantsData}get materialVariantsData(){return this._materialVariantsData}loadMesh(e,t){if(!this._content.meshes)throw new Error("GeometryLoader.loadMesh: Meshes not available.");if(!this._content.meshes[e])throw new Error("GeometryLoader.loadMesh: Mesh not available.");const i=this._content.meshes[e],n=new r.TreeNode(i.name||"mesh_"+e);if(i.primitives)for(let e=0,r=i.primitives.length;e<r;e++)n.addChild(this.loadPrimitive(i.primitives,e,i.weights||t));return n}loadPrimitive(e,t,s=[]){const o=e[t],a=new r.TreeNode("primitive_"+t),l={};let c=null;const u={};if(o.extensions&&o.extensions[n.GLTF_EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]){const e=o.extensions[n.GLTF_EXTENSIONS.KHR_DRACO_MESH_COMPRESSION],t=this._bufferViewLoader.getBufferView(e.bufferView),r=new this._dracoModule.Decoder,s=new this._dracoModule.DecoderBuffer;s.Init(new Int8Array(t),t.byteLength);const a=r.GetEncodedGeometryType(s);let u;if(a===this._dracoModule.TRIANGULAR_MESH?(u=new this._dracoModule.Mesh,r.DecodeBufferToMesh(s,u)):a===this._dracoModule.POINT_CLOUD&&(u=new this._dracoModule.PointCloud,r.DecodeBufferToPointCloud(s,u)),this._dracoModule.destroy(s),void 0===e.attributes.POSITION){const e="No position attribute found in the mesh.";throw this._dracoModule.destroy(r),this._dracoModule.destroy(u),new Error(e)}for(let t in e.attributes){const n=r.GetAttributeByUniqueId(u,e.attributes[t]),s=new this._dracoModule.DracoFloat32Array;r.GetAttributeFloatForAllPoints(u,n,s);const o=n.byte_offset(),a=n.normalized(),c=n.num_components(),h=s.size(),d=new Float32Array(h);for(let e=0;e<h;e++)for(let t=0;t<c;t++){const r=e*c,i=s.GetValue(r+t);d[r+t]=i}this._dracoModule.destroy(s),l[t]=new i.AttributeData(d,c,d.BYTES_PER_ELEMENT*c,o,d.BYTES_PER_ELEMENT,a,d.length/c)}const h=a==this._dracoModule.TRIANGULAR_MESH?u.num_faces():0,d=new Uint32Array(3*h);if(a==this._dracoModule.TRIANGULAR_MESH){const e=new this._dracoModule.DracoInt32Array;for(let t=0;t<h;++t){r.GetFaceFromMesh(u,t,e);const i=3*t;d[i]=e.GetValue(0),d[i+1]=e.GetValue(1),d[i+2]=e.GetValue(2)}this._dracoModule.destroy(e)}this._dracoModule.destroy(r),this._dracoModule.destroy(u),a==this._dracoModule.TRIANGULAR_MESH&&(c=new i.AttributeData(d,1,1*d.BYTES_PER_ELEMENT,0,d.BYTES_PER_ELEMENT,!1,d.length))}for(let e in o.attributes){if(l[e]){u[e]=e;continue}let t=e;if(/\d/.test(t)&&!t.includes("_")){const e=t.search(/\d/);t=t.substring(0,e)+"_"+t.substring(e,t.length)}else"TEXCOORD"===t||"COLOR"===t||"JOINTS"===t||"WEIGHTS"===t?t+="_0":"UV"===t&&(t="TEXCOORD_0");u[e]=t,l[t]=this._accessorLoader.getAccessor(o.attributes[e])}if(!o.indices&&0!==o.indices||c||(c=this._accessorLoader.getAccessor(o.indices)),o.targets)for(let e=0;e<o.targets.length;e++)for(let t in o.targets[e])l[t]&&l[u[t]].morphAttributeData.push(this._accessorLoader.getAccessor(o.targets[e][t]));let h=null;(o.material||0===o.material)&&(h=this._materialLoader.getMaterial(o.material));const d=new i.PrimitiveData(l,o.mode,c,h);if(o.extensions&&o.extensions[n.GLTF_EXTENSIONS.KHR_MATERIALS_VARIANTS]){this._materialVariantsData.primitiveData.push(d);const e=o.extensions[n.GLTF_EXTENSIONS.KHR_MATERIALS_VARIANTS];for(let t=0;t<e.mappings.length;t++){const r=e.mappings[t],i=this._materialLoader.getMaterial(r.material);for(let e=0;e<r.variants.length;e++)d.materialVariants.push({variant:r.variants[e],material:i})}}const f=new i.GeometryData(d);return f.morphWeights=s,a.data.push(f),a}}})),s.register("bp3PQ",(function(e,t){var r,i="node_modules/@shapediver/viewer.data-engine.geometry-engine/dist/gltfv2/draco/draco_decoder.js",n=s("hPtJY"),o=s("6ZWSX").Buffer,a=(r=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0)||i,function(e){var t,i,a=void 0!==(e=e||{})?e:{},l=Object.assign;a.ready=new Promise((function(e,r){t=e,i=r}));var c=!1,u=!1;a.onRuntimeInitialized=function(){c=!0,u&&"function"==typeof a.onModuleLoaded&&a.onModuleLoaded(a)},a.onModuleParsed=function(){u=!0,c&&"function"==typeof a.onModuleLoaded&&a.onModuleLoaded(a)},a.isVersionSupported=function(e){if("string"!=typeof e)return!1;const t=e.split(".");return!(t.length<2||t.length>3)&&(1==t[0]&&t[1]>=0&&t[1]<=5||!(0!=t[0]||t[1]>10))};var h,d,f,p,m,g,v=l({},a),_=[],b="object"==typeof window,y="function"==typeof importScripts,E="object"==typeof n&&"object"==typeof n.versions&&"string"==typeof n.versions.node,w="";E?(w=y?s("kjyEk").dirname(w)+"/":"node_modules/@shapediver/viewer.data-engine.geometry-engine/dist/gltfv2/draco/",g=()=>{m||(p=s("kjyEk"),m=s("kjyEk"))},h=function(e,t){var r=le(e);return r?t?r:r.toString():(g(),e=m.normalize(e),p.readFileSync(e,t?null:"utf8"))},f=e=>{var t=h(e,!0);return t.buffer||(t=new Uint8Array(t)),t},d=(e,t,r)=>{var i=le(e);i&&t(i),g(),e=m.normalize(e),p.readFile(e,(function(e,i){e?r(e):t(i.buffer)}))},n.argv.length>1&&n.argv[1].replace(/\\/g,"/"),_=n.argv.slice(2),a.inspect=function(){return"[Emscripten Module object]"}):(b||y)&&(y?w=self.location.href:"undefined"!=typeof document&&document.currentScript&&(w=document.currentScript.src),r&&(w=r),w=0!==w.indexOf("blob:")?w.substr(0,w.replace(/[?#].*/,"").lastIndexOf("/")+1):"",h=e=>{try{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText}catch(t){var r=le(e);if(r)return function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r];i>255&&(i&=255),t.push(String.fromCharCode(i))}return t.join("")}(r);throw t}},y&&(f=e=>{try{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}catch(t){var r=le(e);if(r)return r;throw t}}),d=(e,t,r)=>{var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.onload=()=>{if(200==i.status||0==i.status&&i.response)t(i.response);else{var n=le(e);n?t(n.buffer):r()}},i.onerror=r,i.send(null)});var x,A=a.print||console.log.bind(console),T=a.printErr||console.warn.bind(console);l(a,v),v=null,a.arguments&&(_=a.arguments),a.thisProgram&&a.thisProgram,a.quit&&a.quit,a.wasmBinary&&(x=a.wasmBinary);a.noExitRuntime;var S,M={Memory:function(e){this.buffer=new ArrayBuffer(65536*e.initial)},Module:function(e){},Instance:function(e,t){this.exports=function(e){for(var t,r=new Uint8Array(123),i=25;i>=0;--i)r[48+i]=52+i,r[65+i]=i,r[97+i]=26+i;function n(e,t,i){for(var n,s,o=0,a=t,l=i.length,c=t+(3*l>>2)-("="==i[l-2])-("="==i[l-1]);o<l;o+=4)n=r[i.charCodeAt(o+1)],s=r[i.charCodeAt(o+2)],e[a++]=r[i.charCodeAt(o)]<<2|n>>4,a<c&&(e[a++]=n<<4|s>>2),a<c&&(e[a++]=s<<6|r[i.charCodeAt(o+3)])}r[43]=62,r[47]=63;var s=new ArrayBuffer(16),o=new Int32Array(s),a=new Float32Array(s);function l(e){a[2]=e}function c(e){return o[e]}return new Float64Array(s),function(e){var r=e.a,i=r.buffer;r.grow=function(e){e|=0;var n=0|Rn(),o=n+e|0;if(n<o&&o<65536){var a=new ArrayBuffer(v(o,65536));new Int8Array(a).set(s),s=new Int8Array(a),u=new Int16Array(a),h=new Int32Array(a),d=new Uint8Array(a),f=new Uint16Array(a),p=new Uint32Array(a),m=new Float32Array(a),g=new Float64Array(a),i=a,r.buffer=i,t=d}return n};var s=new Int8Array(i),u=new Int16Array(i),h=new Int32Array(i),d=new Uint8Array(i),f=new Uint16Array(i),p=new Uint32Array(i),m=new Float32Array(i),g=new Float64Array(i),v=Math.imul,_=Math.fround,b=Math.abs,y=Math.clz32,E=Math.min,w=Math.max,x=Math.floor,A=Math.ceil,T=(Math.trunc,Math.sqrt),S=e.abort,M=e.b,C=e.c,R=e.d,I=e.e,O=e.f,P=e.g,k=e.h,L=e.i,N=5260320,G=0;function D(e,t,r){var i,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0;N=i=N-672|0,o=h[t+12>>2],n=h[t+20>>2],n=(w=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n;e:{t:{r:if(!(w>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o)||(n=s+h[t>>2]|0,h[e>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(s=(w=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,T=s,h[t+16>>2]=s,h[t+20>>2]=n,p[e>>2]>31||(s=h[t+12>>2],n=o,n=(o=w+8|0)>>>0<8?n+1|0:n,o>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s)||(n=T+h[t>>2]|0,h[e+4>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(s=(w=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,T=s,h[t+16>>2]=s,h[t+20>>2]=n,s=h[t+12>>2],n=o,n=(o=w+8|0)>>>0<8?n+1|0:n,o>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s)||(n=T+h[t>>2]|0,h[e+12>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(s=(w=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,E=s,h[t+16>>2]=s,h[t+20>>2]=n,n=h[e+20>>2],(0|(T=h[e+12>>2]))!=(0|n)&&n||(s=h[t+12>>2],n=o,n=(o=w+8|0)>>>0<8?n+1|0:n,o>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s))))))))if(n=E+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[e+16>>2]=o,n=h[t+20>>2],n=(s=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=s,h[t+20>>2]=n,o>>>0>=7)h[i>>2]=o,Bt(1857,i);else{h[i+664>>2]=r;i:if(T){n:if(w=h[r>>2],!(T>>>0<=(h[r+8>>2]-w|0)/12>>>0)){if(!(T>>>0<357913942))break t;if(s=h[r+4>>2],T=(n=mi(o=v(T,12)))+o|0,n=o=n+v((s-w|0)/12|0,12)|0,(0|s)!=(0|w))for(n=o;s=s-12|0,h[(n=n-12|0)>>2]=h[s>>2],h[n+4>>2]=h[s+4>>2],h[n+8>>2]=h[s+8>>2],(0|s)!=(0|w););if(h[r+8>>2]=T,h[r+4>>2]=o,h[r>>2]=n,!w)break n;ve(w)}n:switch(h[e+16>>2]){case 0:if(l=Ze(i+8|0,3),w=i+664|0,o=h[t+12>>2],n=h[t+20>>2],n=(s=(a=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(s>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o))&&(n=a+h[t>>2]|0,h[l>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(a=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,u=a,h[t+16>>2]=a,h[t+20>>2]=n,!(p[l>>2]>32)&&(a=h[t+12>>2],n=o,n=(o=s+8|0)>>>0<8?n+1|0:n,!(o>>>0>p[t+8>>2]&(0|n)>=(0|a)|(0|n)>(0|a))&&(n=u+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[l+4>>2]=o,n=h[t+20>>2],n=(a=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=a,h[t+20>>2]=n,o&&(h[l+8>>2]=0,Tt(l+16|0,t)&&Tt(l+36|0,t)&&Tt(l+56|0,t)&&Tt(l+76|0,t)))))){if(T=h[l+4>>2],o=0,t=0,N=s=N-48|0,a=h[l+12>>2],h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,a){if(a>>>0>=1073741824)break e;o=mi(n=a<<2),h[s+8>>2]=o,t=n+o|0,h[s+16>>2]=t,St(o,0,n),h[s+12>>2]=t}if(n=h[l+120>>2],(u=h[n>>2])&&(h[n+4>>2]=u,ve(u),h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,a=h[l+12>>2],o=h[s+8>>2],t=h[s+12>>2]),h[n+4>>2]=t,h[n>>2]=o,h[n+8>>2]=h[s+16>>2],o=0,h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,a){if(a>>>0>=1073741824)break e;c=mi(t=a<<2),h[s+8>>2]=c,o=t+c|0,h[s+16>>2]=o,St(c,0,t),h[s+12>>2]=o}t=h[l+132>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,c=h[s+8>>2],o=h[s+12>>2]),h[t+4>>2]=o,h[t>>2]=c,h[t+8>>2]=h[s+16>>2],h[s+24>>2]=0,h[s+28>>2]=0,h[s+16>>2]=0,h[s+20>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,Qe(s+8|0),n=((t=h[s+24>>2]+h[s+28>>2]|0)>>>0)/341|0,t=h[h[s+12>>2]+(n<<2)>>2]+v(t-v(n,341)|0,12)|0,h[t+4>>2]=0,h[t+8>>2]=0,h[t>>2]=T,a=(t=h[s+28>>2])+1|0,h[s+28>>2]=a;s:if(!(t>>>0>a>>>0))for(;;){if(E=h[s+12>>2],o=h[s+24>>2],t=h[E+((n=((t=o+(u=a-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(n,341)|0,12)|0,f=h[t+8>>2],c=h[t+4>>2],n=h[t>>2],h[s+28>>2]=u,1+(((u=(t=h[s+16>>2])-E|0)?v(u>>2,341)-1|0:0)-(a+o|0)|0)>>>0>=682&&(ve(h[t-4>>2]),h[s+16>>2]=h[s+16>>2]-4),o=0,n>>>0>T>>>0)break s;if((c=(0|c)==((t=h[l+12>>2])-1|0)?0:c+1|0)>>>0>=t>>>0)break s;E=(a=v(f,12))+h[l+132>>2]|0,u=a+h[l+120>>2]|0;o:{a:if(g=c<<2,b=h[l>>2]-h[g+h[E>>2]>>2]|0){l:{c:{u:{h:{if(n>>>0<=2){if(t=h[l+108>>2],h[t>>2]=c,o=1,(a=h[l+12>>2])>>>0>1)break h;break l}if(p[l+8>>2]>p[l+4>>2])break s;(0|(o=(t=h[l+120>>2])+(E=v(m=f+1|0,12))|0))!=(0|u)&&(Ft(o,h[u>>2],h[u+4>>2]),t=h[l+120>>2]),t=g+h[t+E>>2]|0,h[t>>2]=h[t>>2]+(1<<b-1);d:if((0|(t=31^y(n)))<=(0|(b=32-(o=h[l+32>>2])|0))){if((0|(u=h[l+28>>2]))==h[l+20>>2]){o=0;break d}if(b=h[u>>2],_=t+o|0,h[l+32>>2]=_,o=b<<o>>>32-t|0,32!=(0|_))break d;h[l+32>>2]=0,h[l+28>>2]=u+4}else(0|(_=(u=h[l+28>>2])+4|0))!=h[l+20>>2]?(x=h[u>>2],h[l+28>>2]=_,b=t-b|0,h[l+32>>2]=b,o=h[u+4>>2]>>>32-b|x<<o>>>32-t):o=0;if((0|(o=n-(t=(n>>>1|0)-o|0)|0))!=(0|t)){if((0|(n=h[l+88>>2]))==h[l+80>>2])break u;u=h[n>>2],_=(b=h[l+92>>2])+1|0,h[l+92>>2]=_,u&=-2147483648>>>b;d:{if(32==(0|_)){if(h[l+92>>2]=0,h[l+88>>2]=n+4,u)break d;break u}if(!u)break u}n=o}else n=t;o=t;break c}for(;c=(a-1|0)==(0|c)?0:c+1|0,h[t+(o<<2)>>2]=c,(o=o+1|0)>>>0<(a=h[l+12>>2])>>>0;);break l}n=t}if(t=h[l+132>>2],u=h[(a=t+a|0)>>2],h[(g=u+g|0)>>2]=h[g>>2]+1,Ft(t+E|0,u,h[a+4>>2]),o&&(a=h[s+28>>2]+h[s+24>>2]|0,t=h[s+12>>2],(0|a)==(0|((u=h[s+16>>2]-t|0)?v(u>>2,341)-1|0:0))?(Qe(s+8|0),a=h[s+24>>2]+h[s+28>>2]|0,u=h[s+12>>2]):u=t,t=h[u+((t=(a>>>0)/341|0)<<2)>>2]+v(a-v(t,341)|0,12)|0,h[t+8>>2]=f,h[t+4>>2]=c,h[t>>2]=o,h[s+28>>2]=h[s+28>>2]+1),!n)break a;a=h[s+28>>2]+h[s+24>>2]|0,o=h[s+12>>2],(0|a)==(0|((t=h[s+16>>2]-o|0)?v(t>>2,341)-1|0:0))&&(Qe(s+8|0),a=h[s+24>>2]+h[s+28>>2]|0,o=h[s+12>>2]),t=h[o+((t=(a>>>0)/341|0)<<2)>>2]+v(a-v(t,341)|0,12)|0,h[t+8>>2]=m,h[t+4>>2]=c,h[t>>2]=n,a=h[s+28>>2]+1|0,h[s+28>>2]=a;break o}if(c=0,n)for(;;){if(o=h[l+96>>2],a){for(g=h[l+40>>2],x=h[l+108>>2],R=h[u>>2],O=h[E>>2],a=0;;){h[(h[(b=x+(a<<2)|0)>>2]<<2)+o>>2]=0,f=h[b>>2]<<2;l:if(t=h[l>>2]-h[f+O>>2]|0)if(f=o+f|0,(0|(A=32-(m=h[l+52>>2])|0))>=(0|t)){if((0|(_=h[l+48>>2]))==(0|g)){h[f>>2]=0;break l}if(h[f>>2]=h[_>>2]<<m>>>32-t,t=t+h[l+52>>2]|0,h[l+52>>2]=t,32!=(0|t))break l;h[l+52>>2]=0,h[l+48>>2]=_+4}else(0|(M=(_=h[l+48>>2])+4|0))!=(0|g)?(I=h[_>>2],h[l+48>>2]=M,A=t-A|0,h[l+52>>2]=A,h[f>>2]=h[_+4>>2]>>>32-A|I<<m>>>32-t):h[f>>2]=0;if(t=h[b>>2]<<2,h[(f=t+o|0)>>2]=h[f>>2]|h[t+R>>2],!((a=a+1|0)>>>0<p[l+12>>2]))break}o=h[l+96>>2]}if(h[s+32>>2]=h[o>>2],h[s+36>>2]=h[o+4>>2],h[s+40>>2]=h[o+8>>2],It(h[w>>2],s+32|0),h[l+8>>2]=h[l+8>>2]+1,(0|n)==(0|(c=c+1|0)))break a;a=h[l+12>>2]}}else{if(!n)break a;for(;;){if(t=h[u>>2],E=h[t+8>>2],g=h[t+4>>2],b=h[t>>2],t=h[w>>2],(a=h[t+4>>2])>>>0<(m=h[t+8>>2])>>>0)h[a+8>>2]=E,h[a+4>>2]=g,h[a>>2]=b,h[t+4>>2]=a+12;else{if((c=1+(_=(a-(f=h[t>>2])|0)/12|0)|0)>>>0>=357913942)break e;if(x=(m=(m-f|0)/12|0)<<1,(c=m>>>0<178956970?c>>>0>x>>>0?c:x:357913941)>>>0>=357913942)break t;if(C=v(_,12),_=mi(m=v(c,12)),h[8+(c=C+_|0)>>2]=E,h[c+4>>2]=g,h[c>>2]=b,E=c+12|0,(0|a)!=(0|f))for(;a=a-12|0,h[(c=c-12|0)>>2]=h[a>>2],h[c+4>>2]=h[a+4>>2],h[c+8>>2]=h[a+8>>2],(0|a)!=(0|f););h[t+8>>2]=m+_,h[t+4>>2]=E,h[t>>2]=c,f&&ve(f)}if(h[l+8>>2]=h[l+8>>2]+1,(0|n)==(0|(o=o+1|0)))break}}a=h[s+28>>2]}if(!a)break}if(h[s+28>>2]=0,(c=(a=h[s+16>>2])-(t=h[s+12>>2])|0)>>>0>=9)for(;ve(h[t>>2]),t=h[s+12>>2]+4|0,h[s+12>>2]=t,(c=(a=h[s+16>>2])-t|0)>>>0>8;);switch(o=170,(c>>>2|0)-1|0){case 1:o=341;case 0:h[s+24>>2]=o}if((0|t)!=(0|a)){for(;ve(h[t>>2]),(0|a)!=(0|(t=t+4|0)););(0|(t=h[s+16>>2]))!=(0|(n=h[s+12>>2]))&&(h[s+16>>2]=t+(((t-n|0)-4>>>2^-1)<<2))}(t=h[s+8>>2])&&ve(t),N=s+48|0}Yt(l);break i;case 1:if(l=Ze(i+8|0,3),T=i+664|0,o=h[t+12>>2],n=h[t+20>>2],n=(s=(a=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(s>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o))&&(n=a+h[t>>2]|0,h[l>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(a=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,f=a,h[t+16>>2]=a,h[t+20>>2]=n,!(p[l>>2]>32)&&(a=h[t+12>>2],n=o,n=(o=s+8|0)>>>0<8?n+1|0:n,!(o>>>0>p[t+8>>2]&(0|n)>=(0|a)|(0|n)>(0|a))&&(n=f+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[l+4>>2]=o,n=h[t+20>>2],n=(a=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=a,h[t+20>>2]=n,o&&(h[l+8>>2]=0,Tt(l+16|0,t)&&Tt(l+36|0,t)&&Tt(l+56|0,t)&&Tt(l+76|0,t)))))){if(E=h[l+4>>2],o=0,N=s=N-48|0,a=h[l+12>>2],h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,a){if(a>>>0>=1073741824)break e;u=mi(t=a<<2),h[s+8>>2]=u,o=t+u|0,h[s+16>>2]=o,St(u,0,t),h[s+12>>2]=o}if(t=h[l+120>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,u=h[s+8>>2],a=h[l+12>>2],o=h[s+12>>2]),h[t+4>>2]=o,h[t>>2]=u,h[t+8>>2]=h[s+16>>2],u=0,h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,a){if(a>>>0>=1073741824)break e;c=mi(t=a<<2),h[s+8>>2]=c,u=t+c|0,h[s+16>>2]=u,St(c,0,t),h[s+12>>2]=u}t=h[l+132>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,u=h[s+12>>2],c=h[s+8>>2]),h[t+4>>2]=u,h[t>>2]=c,h[t+8>>2]=h[s+16>>2],h[s+24>>2]=0,h[s+28>>2]=0,h[s+16>>2]=0,h[s+20>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,Qe(s+8|0),n=((t=h[s+24>>2]+h[s+28>>2]|0)>>>0)/341|0,t=h[h[s+12>>2]+(n<<2)>>2]+v(t-v(n,341)|0,12)|0,h[t+4>>2]=0,h[t+8>>2]=0,h[t>>2]=E,a=(t=h[s+28>>2])+1|0,h[s+28>>2]=a;s:if(!(t>>>0>a>>>0))for(;;){if(u=h[s+12>>2],o=h[s+24>>2],t=h[u+((n=((t=o+(c=a-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(n,341)|0,12)|0,w=h[t+8>>2],n=h[t+4>>2],t=h[t>>2],h[s+28>>2]=c,1+(((u=(c=h[s+16>>2])-u|0)?v(u>>2,341)-1|0:0)-(a+o|0)|0)>>>0>=682&&(ve(h[c-4>>2]),h[s+16>>2]=h[s+16>>2]-4),t>>>0>E>>>0)break s;if(o=0,(c=(0|n)==((a=h[l+12>>2])-1|0)?0:n+1|0)>>>0>=a>>>0)break s;f=(n=h[l+120>>2])+(a=v(w,12))|0;o:{a:if(u=c<<2,_=a+h[l+132>>2]|0,g=h[l>>2]-h[u+h[_>>2]>>2]|0){l:{c:{u:{h:{if(t>>>0<=2){if(n=h[l+108>>2],h[n>>2]=c,u=1,(a=h[l+12>>2])>>>0>1)break h;break l}if(p[l+8>>2]>p[l+4>>2])break s;Ft((o=n)+(n=a+12|0)|0,h[f>>2],h[f+4>>2]),n=u+h[n+h[l+120>>2]>>2]|0,h[n>>2]=h[n>>2]+(1<<g-1);d:if((0|(n=31^y(t)))<=(0|(g=32-(o=h[l+32>>2])|0))){if((0|(f=h[l+28>>2]))==h[l+20>>2]){o=0;break d}if(g=h[f>>2],b=n+o|0,h[l+32>>2]=b,o=g<<o>>>32-n|0,32!=(0|b))break d;h[l+32>>2]=0,h[l+28>>2]=f+4}else(0|(b=(f=h[l+28>>2])+4|0))!=h[l+20>>2]?(m=h[f>>2],h[l+28>>2]=b,g=n-g|0,h[l+32>>2]=g,o=h[f+4>>2]>>>32-g|m<<o>>>32-n):o=0;if(f=w+1|0,(0|(o=(n=t)-(t=(t>>>1|0)-o|0)|0))!=(0|t)){if((0|(n=h[l+88>>2]))==h[l+80>>2])break u;g=h[n>>2],m=(b=h[l+92>>2])+1|0,h[l+92>>2]=m,g&=-2147483648>>>b;d:{if(32==(0|m)){if(h[l+92>>2]=0,h[l+88>>2]=n+4,g)break d;break u}if(!g)break u}n=o}else n=t;o=t;break c}for(;c=(a-1|0)==(0|c)?0:c+1|0,h[n+(u<<2)>>2]=c,(a=h[l+12>>2])>>>0>(u=u+1|0)>>>0;);break l}n=t}if(C=u,t=h[l+132>>2],u=h[(a=t+a|0)>>2],h[(g=C+u|0)>>2]=h[g>>2]+1,Ft(t+v(f,12)|0,u,h[a+4>>2]),o&&(a=h[s+28>>2]+h[s+24>>2]|0,u=h[s+12>>2],(0|a)==(0|((t=h[s+16>>2]-u|0)?v(t>>2,341)-1|0:0))&&(Qe(s+8|0),u=h[s+12>>2],a=h[s+24>>2]+h[s+28>>2]|0),t=h[((t=(a>>>0)/341|0)<<2)+u>>2]+v(a-v(t,341)|0,12)|0,h[t+8>>2]=w,h[t+4>>2]=c,h[t>>2]=o,h[s+28>>2]=h[s+28>>2]+1),!n)break a;a=h[s+28>>2]+h[s+24>>2]|0,u=h[s+12>>2],(0|a)==(0|((t=h[s+16>>2]-u|0)?v(t>>2,341)-1|0:0))&&(Qe(s+8|0),u=h[s+12>>2],a=h[s+24>>2]+h[s+28>>2]|0),t=h[((t=(a>>>0)/341|0)<<2)+u>>2]+v(a-v(t,341)|0,12)|0,h[t+8>>2]=f,h[t+4>>2]=c,h[t>>2]=n,a=h[s+28>>2]+1|0,h[s+28>>2]=a;break o}if(c=0,t)for(;;){if(u=h[l+96>>2],a){for(w=h[l+40>>2],x=h[l+108>>2],R=h[f>>2],O=h[_>>2],a=0;;){h[(h[(g=x+(a<<2)|0)>>2]<<2)+u>>2]=0,o=h[g>>2]<<2;l:if(n=h[l>>2]-h[o+O>>2]|0)if(o=o+u|0,(0|(A=32-(b=h[l+52>>2])|0))>=(0|n)){if((0|(m=h[l+48>>2]))==(0|w)){h[o>>2]=0;break l}if(h[o>>2]=h[m>>2]<<b>>>32-n,n=n+h[l+52>>2]|0,h[l+52>>2]=n,32!=(0|n))break l;h[l+52>>2]=0,h[l+48>>2]=m+4}else(0|(M=(m=h[l+48>>2])+4|0))!=(0|w)?(I=h[m>>2],h[l+48>>2]=M,A=n-A|0,h[l+52>>2]=A,h[o>>2]=h[m+4>>2]>>>32-A|I<<b>>>32-n):h[o>>2]=0;if(n=h[g>>2]<<2,h[(o=n+u|0)>>2]=h[o>>2]|h[n+R>>2],!((a=a+1|0)>>>0<p[l+12>>2]))break}u=h[l+96>>2]}if(h[s+32>>2]=h[u>>2],h[s+36>>2]=h[u+4>>2],h[s+40>>2]=h[u+8>>2],It(h[T>>2],s+32|0),h[l+8>>2]=h[l+8>>2]+1,(0|t)==(0|(c=c+1|0)))break a;a=h[l+12>>2]}}else{if(!t)break a;for(;;){if(n=h[f>>2],w=h[n+8>>2],g=h[n+4>>2],b=h[n>>2],n=h[T>>2],(a=h[n+4>>2])>>>0<(m=h[n+8>>2])>>>0)h[a+8>>2]=w,h[a+4>>2]=g,h[a>>2]=b,h[n+4>>2]=a+12;else{if((c=1+(_=(a-(u=h[n>>2])|0)/12|0)|0)>>>0>=357913942)break e;if(x=(m=(m-u|0)/12|0)<<1,(c=m>>>0<178956970?c>>>0>x>>>0?c:x:357913941)>>>0>=357913942)break t;if(C=v(_,12),_=mi(m=v(c,12)),h[8+(c=C+_|0)>>2]=w,h[c+4>>2]=g,h[c>>2]=b,w=c+12|0,(0|a)!=(0|u))for(;a=a-12|0,h[(c=c-12|0)>>2]=h[a>>2],h[c+4>>2]=h[a+4>>2],h[c+8>>2]=h[a+8>>2],(0|a)!=(0|u););h[n+8>>2]=m+_,h[n+4>>2]=w,h[n>>2]=c,u&&ve(u)}if(h[l+8>>2]=h[l+8>>2]+1,(0|t)==(0|(o=o+1|0)))break}}a=h[s+28>>2]}if(!a)break}if(h[s+28>>2]=0,(c=(a=h[s+16>>2])-(t=h[s+12>>2])|0)>>>0>=9)for(;ve(h[t>>2]),t=h[s+12>>2]+4|0,h[s+12>>2]=t,(c=(a=h[s+16>>2])-t|0)>>>0>8;);switch(u=170,(c>>>2|0)-1|0){case 1:u=341;case 0:h[s+24>>2]=u}if((0|t)!=(0|a)){for(;ve(h[t>>2]),(0|a)!=(0|(t=t+4|0)););(0|(t=h[s+16>>2]))!=(0|(n=h[s+12>>2]))&&(h[s+16>>2]=t+(((t-n|0)-4>>>2^-1)<<2))}(t=h[s+8>>2])&&ve(t),N=s+48|0}Yt(l);break i;case 2:if(c=qe(i+8|0,3),w=i+664|0,o=h[t+12>>2],n=h[t+20>>2],n=(s=(a=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(s>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o))&&(n=a+h[t>>2]|0,h[c>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(a=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,l=a,h[t+16>>2]=l,h[t+20>>2]=n,!(p[c>>2]>32)&&(a=h[t+12>>2],n=o,n=(o=s+8|0)>>>0<8?n+1|0:n,!(o>>>0>p[t+8>>2]&(0|n)>=(0|a)|(0|n)>(0|a))&&(n=l+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[c+4>>2]=o,n=h[t+20>>2],n=(a=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=a,h[t+20>>2]=n,o&&(h[c+8>>2]=0,ze(c+16|0,t)&&Tt(c+32|0,t)&&Tt(c+52|0,t)&&Tt(c+72|0,t)))))){if(T=h[c+4>>2],o=0,t=0,N=a=N-48|0,s=h[c+12>>2],h[a+16>>2]=0,h[a+8>>2]=0,h[a+12>>2]=0,s){if(s>>>0>=1073741824)break e;o=mi(n=s<<2),h[a+8>>2]=o,t=n+o|0,h[a+16>>2]=t,St(o,0,n),h[a+12>>2]=t}if(n=h[c+116>>2],(l=h[n>>2])&&(h[n+4>>2]=l,ve(l),h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,s=h[c+12>>2],o=h[a+8>>2],t=h[a+12>>2]),h[n+4>>2]=t,h[n>>2]=o,h[n+8>>2]=h[a+16>>2],o=0,h[a+16>>2]=0,h[a+8>>2]=0,h[a+12>>2]=0,s){if(s>>>0>=1073741824)break e;f=mi(t=s<<2),h[a+8>>2]=f,o=t+f|0,h[a+16>>2]=o,St(f,0,t),h[a+12>>2]=o}t=h[c+128>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,f=h[a+8>>2],o=h[a+12>>2]),h[t+4>>2]=o,h[t>>2]=f,h[t+8>>2]=h[a+16>>2],h[a+24>>2]=0,h[a+28>>2]=0,h[a+16>>2]=0,h[a+20>>2]=0,h[a+8>>2]=0,h[a+12>>2]=0,Qe(a+8|0),n=((t=h[a+24>>2]+h[a+28>>2]|0)>>>0)/341|0,t=h[h[a+12>>2]+(n<<2)>>2]+v(t-v(n,341)|0,12)|0,h[t+4>>2]=0,h[t+8>>2]=0,h[t>>2]=T,s=(t=h[a+28>>2])+1|0,h[a+28>>2]=s;s:if(!(t>>>0>s>>>0))for(x=c+16|0;;){if(E=h[a+12>>2],o=h[a+24>>2],t=h[E+((n=((t=o+(f=s-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(n,341)|0,12)|0,u=h[t+8>>2],l=h[t+4>>2],n=h[t>>2],h[a+28>>2]=f,1+(((f=(t=h[a+16>>2])-E|0)?v(f>>2,341)-1|0:0)-(s+o|0)|0)>>>0>=682&&(ve(h[t-4>>2]),h[a+16>>2]=h[a+16>>2]-4),o=0,n>>>0>T>>>0)break s;if((f=(0|l)==((t=h[c+12>>2])-1|0)?0:l+1|0)>>>0>=t>>>0)break s;E=(s=v(u,12))+h[c+128>>2]|0,l=s+h[c+116>>2]|0;o:if(g=f<<2,b=h[c>>2]-h[g+h[E>>2]>>2]|0){a:{l:{c:{u:{if(n>>>0<=2){if(t=h[c+104>>2],h[t>>2]=f,o=1,(s=h[c+12>>2])>>>0>1)break u;break a}if(p[c+8>>2]>p[c+4>>2])break s;if((0|(o=(t=h[c+116>>2])+(E=v(m=u+1|0,12))|0))!=(0|l)&&(Ft(o,h[l>>2],h[l+4>>2]),t=h[c+116>>2]),t=g+h[t+E>>2]|0,h[t>>2]=h[t>>2]+(1<<b-1),h[a+32>>2]=0,mr(x,31^y(n),a+32|0),(0|(o=n-(t=(n>>>1|0)-h[a+32>>2]|0)|0))!=(0|t)){if((0|(n=h[c+84>>2]))==h[c+76>>2])break c;l=h[n>>2],_=(b=h[c+88>>2])+1|0,h[c+88>>2]=_,l&=-2147483648>>>b;h:{if(32==(0|_)){if(h[c+88>>2]=0,h[c+84>>2]=n+4,l)break h;break c}if(!l)break c}n=o}else n=t;o=t;break l}for(;f=(s-1|0)==(0|f)?0:f+1|0,h[t+(o<<2)>>2]=f,(s=h[c+12>>2])>>>0>(o=o+1|0)>>>0;);break a}n=t}if(t=h[c+128>>2],l=h[(s=t+s|0)>>2],h[(g=l+g|0)>>2]=h[g>>2]+1,Ft(t+E|0,l,h[s+4>>2]),o&&(s=h[a+28>>2]+h[a+24>>2]|0,t=h[a+12>>2],(0|s)==(0|((l=h[a+16>>2]-t|0)?v(l>>2,341)-1|0:0))?(Qe(a+8|0),s=h[a+24>>2]+h[a+28>>2]|0,C=h[a+12>>2]):C=t,t=h[C+((t=(s>>>0)/341|0)<<2)>>2]+v(s-v(t,341)|0,12)|0,h[t+8>>2]=u,h[t+4>>2]=f,h[t>>2]=o,h[a+28>>2]=h[a+28>>2]+1),!n)break o;s=h[a+28>>2]+h[a+24>>2]|0,o=h[a+12>>2],(0|s)==(0|((t=h[a+16>>2]-o|0)?v(t>>2,341)-1|0:0))&&(Qe(a+8|0),s=h[a+24>>2]+h[a+28>>2]|0,o=h[a+12>>2]),t=h[o+((t=(s>>>0)/341|0)<<2)>>2]+v(s-v(t,341)|0,12)|0,h[t+8>>2]=m,h[t+4>>2]=f,h[t>>2]=n,h[a+28>>2]=h[a+28>>2]+1;break o}if(f=0,n)for(;;){if(o=h[c+92>>2],s){for(g=h[c+36>>2],R=h[c+104>>2],O=h[l>>2],A=h[E>>2],s=0;;){h[(h[(b=R+(s<<2)|0)>>2]<<2)+o>>2]=0,u=h[b>>2]<<2;a:if(t=h[c>>2]-h[u+A>>2]|0)if(u=o+u|0,(0|(M=32-(m=h[c+48>>2])|0))>=(0|t)){if((0|(_=h[c+44>>2]))==(0|g)){h[u>>2]=0;break a}if(h[u>>2]=h[_>>2]<<m>>>32-t,t=t+h[c+48>>2]|0,h[c+48>>2]=t,32!=(0|t))break a;h[c+48>>2]=0,h[c+44>>2]=_+4}else(0|(I=(_=h[c+44>>2])+4|0))!=(0|g)?(C=h[_>>2],h[c+44>>2]=I,M=t-M|0,h[c+48>>2]=M,h[u>>2]=h[_+4>>2]>>>32-M|C<<m>>>32-t):h[u>>2]=0;if(t=h[b>>2]<<2,h[(u=t+o|0)>>2]=h[u>>2]|h[t+O>>2],!((s=s+1|0)>>>0<p[c+12>>2]))break}o=h[c+92>>2]}if(h[a+32>>2]=h[o>>2],h[a+36>>2]=h[o+4>>2],h[a+40>>2]=h[o+8>>2],It(h[w>>2],a+32|0),h[c+8>>2]=h[c+8>>2]+1,(0|n)==(0|(f=f+1|0)))break o;s=h[c+12>>2]}}else{if(!n)break o;for(;;){if(t=h[l>>2],E=h[t+8>>2],g=h[t+4>>2],b=h[t>>2],t=h[w>>2],(s=h[t+4>>2])>>>0<(m=h[t+8>>2])>>>0)h[s+8>>2]=E,h[s+4>>2]=g,h[s>>2]=b,h[t+4>>2]=s+12;else{if((f=1+(_=(s-(u=h[t>>2])|0)/12|0)|0)>>>0>=357913942)break e;if(R=(m=(m-u|0)/12|0)<<1,(f=m>>>0<178956970?f>>>0>R>>>0?f:R:357913941)>>>0>=357913942)break t;if(C=v(_,12),_=mi(m=v(f,12)),h[8+(f=C+_|0)>>2]=E,h[f+4>>2]=g,h[f>>2]=b,E=f+12|0,(0|s)!=(0|u))for(;s=s-12|0,h[(f=f-12|0)>>2]=h[s>>2],h[f+4>>2]=h[s+4>>2],h[f+8>>2]=h[s+8>>2],(0|s)!=(0|u););h[t+8>>2]=m+_,h[t+4>>2]=E,h[t>>2]=f,u&&ve(u)}if(h[c+8>>2]=h[c+8>>2]+1,(0|n)==(0|(o=o+1|0)))break}}if(!(s=h[a+28>>2]))break}if(h[a+28>>2]=0,(f=(s=h[a+16>>2])-(t=h[a+12>>2])|0)>>>0>=9)for(;ve(h[t>>2]),t=h[a+12>>2]+4|0,h[a+12>>2]=t,(f=(s=h[a+16>>2])-t|0)>>>0>8;);switch(o=170,(f>>>2|0)-1|0){case 1:o=341;case 0:h[a+24>>2]=o}if((0|t)!=(0|s)){for(;ve(h[t>>2]),(0|s)!=(0|(t=t+4|0)););(0|(t=h[a+16>>2]))!=(0|(n=h[a+12>>2]))&&(h[a+16>>2]=t+(((t-n|0)-4>>>2^-1)<<2))}(t=h[a+8>>2])&&ve(t),N=a+48|0}Zt(c);break i;case 3:if(u=qe(i+8|0,3),T=i+664|0,o=h[t+12>>2],n=h[t+20>>2],n=(l=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(l>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o))&&(n=s+h[t>>2]|0,h[u>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(s=(l=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,f=s,h[t+16>>2]=s,h[t+20>>2]=n,!(p[u>>2]>32)&&(s=h[t+12>>2],n=o,n=(o=l+8|0)>>>0<8?n+1|0:n,!(o>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s))&&(n=f+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[u+4>>2]=o,n=h[t+20>>2],n=(s=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=s,h[t+20>>2]=n,o&&(h[u+8>>2]=0,ze(u+16|0,t)&&Tt(u+32|0,t)&&Tt(u+52|0,t)&&Tt(u+72|0,t)))))){if(E=h[u+4>>2],o=0,N=l=N-48|0,s=h[u+12>>2],h[l+16>>2]=0,h[l+8>>2]=0,h[l+12>>2]=0,s){if(s>>>0>=1073741824)break e;a=mi(t=s<<2),h[l+8>>2]=a,o=t+a|0,h[l+16>>2]=o,St(a,0,t),h[l+12>>2]=o}if(t=h[u+116>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,a=h[l+8>>2],s=h[u+12>>2],o=h[l+12>>2]),h[t+4>>2]=o,h[t>>2]=a,h[t+8>>2]=h[l+16>>2],a=0,h[l+16>>2]=0,h[l+8>>2]=0,h[l+12>>2]=0,s){if(s>>>0>=1073741824)break e;c=mi(t=s<<2),h[l+8>>2]=c,a=t+c|0,h[l+16>>2]=a,St(c,0,t),h[l+12>>2]=a}t=h[u+128>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,c=h[l+8>>2],a=h[l+12>>2]),h[t+4>>2]=a,h[t>>2]=c,h[t+8>>2]=h[l+16>>2],h[l+24>>2]=0,h[l+28>>2]=0,h[l+16>>2]=0,h[l+20>>2]=0,h[l+8>>2]=0,h[l+12>>2]=0,Qe(l+8|0),n=((t=h[l+24>>2]+h[l+28>>2]|0)>>>0)/341|0,t=h[h[l+12>>2]+(n<<2)>>2]+v(t-v(n,341)|0,12)|0,h[t+4>>2]=0,h[t+8>>2]=0,h[t>>2]=E,s=(t=h[l+28>>2])+1|0,h[l+28>>2]=s;s:if(!(t>>>0>s>>>0))for(_=u+16|0;;){if(c=h[l+12>>2],o=h[l+24>>2],t=h[c+((n=((t=o+(a=s-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(n,341)|0,12)|0,f=h[t+8>>2],n=h[t+4>>2],t=h[t>>2],h[l+28>>2]=a,1+(((c=(a=h[l+16>>2])-c|0)?v(c>>2,341)-1|0:0)-(s+o|0)|0)>>>0>=682&&(ve(h[a-4>>2]),h[l+16>>2]=h[l+16>>2]-4),t>>>0>E>>>0)break s;if(o=0,(c=(0|n)==((a=h[u+12>>2])-1|0)?0:n+1|0)>>>0>=a>>>0)break s;w=(n=h[u+116>>2])+(a=v(f,12))|0;o:if(s=c<<2,x=a+h[u+128>>2]|0,g=h[u>>2]-h[s+h[x>>2]>>2]|0){a:{l:{c:{u:{if(t>>>0<=2){if(n=h[u+104>>2],h[n>>2]=c,a=1,(s=h[u+12>>2])>>>0>1)break u;break a}if(p[u+8>>2]>p[u+4>>2])break s;if(Ft((o=n)+(n=a+12|0)|0,h[w>>2],h[w+4>>2]),n=s+h[n+h[u+116>>2]>>2]|0,h[n>>2]=h[n>>2]+(1<<g-1),h[l+32>>2]=0,mr(_,31^y(t),l+32|0),w=f+1|0,(0|(o=(n=t)-(t=(t>>>1|0)-h[l+32>>2]|0)|0))!=(0|t)){if((0|(n=h[u+84>>2]))==h[u+76>>2])break c;g=h[n>>2],m=(b=h[u+88>>2])+1|0,h[u+88>>2]=m,g&=-2147483648>>>b;h:{if(32==(0|m)){if(h[u+88>>2]=0,h[u+84>>2]=n+4,g)break h;break c}if(!g)break c}n=o}else n=t;o=t;break l}for(;c=(s-1|0)==(0|c)?0:c+1|0,h[n+(a<<2)>>2]=c,(s=h[u+12>>2])>>>0>(a=a+1|0)>>>0;);break a}n=t}if(C=s,t=h[u+128>>2],s=h[(a=t+a|0)>>2],h[(g=C+s|0)>>2]=h[g>>2]+1,Ft(t+v(w,12)|0,s,h[a+4>>2]),o&&(s=h[l+28>>2]+h[l+24>>2]|0,a=h[l+12>>2],(0|s)==(0|((t=h[l+16>>2]-a|0)?v(t>>2,341)-1|0:0))&&(Qe(l+8|0),s=h[l+24>>2]+h[l+28>>2]|0,a=h[l+12>>2]),t=h[a+((t=(s>>>0)/341|0)<<2)>>2]+v(s-v(t,341)|0,12)|0,h[t+8>>2]=f,h[t+4>>2]=c,h[t>>2]=o,h[l+28>>2]=h[l+28>>2]+1),!n)break o;s=h[l+28>>2]+h[l+24>>2]|0,a=h[l+12>>2],(0|s)==(0|((t=h[l+16>>2]-a|0)?v(t>>2,341)-1|0:0))&&(Qe(l+8|0),s=h[l+24>>2]+h[l+28>>2]|0,a=h[l+12>>2]),t=h[a+((t=(s>>>0)/341|0)<<2)>>2]+v(s-v(t,341)|0,12)|0,h[t+8>>2]=w,h[t+4>>2]=c,h[t>>2]=n,h[l+28>>2]=h[l+28>>2]+1;break o}if(f=0,t)for(;;){if(a=h[u+92>>2],s){for(c=h[u+36>>2],R=h[u+104>>2],O=h[w>>2],A=h[x>>2],s=0;;){h[(h[(g=R+(s<<2)|0)>>2]<<2)+a>>2]=0,o=h[g>>2]<<2;a:if(n=h[u>>2]-h[o+A>>2]|0)if(o=a+o|0,(0|(M=32-(b=h[u+48>>2])|0))>=(0|n)){if((0|(m=h[u+44>>2]))==(0|c)){h[o>>2]=0;break a}if(h[o>>2]=h[m>>2]<<b>>>32-n,n=n+h[u+48>>2]|0,h[u+48>>2]=n,32!=(0|n))break a;h[u+48>>2]=0,h[u+44>>2]=m+4}else(0|(I=(m=h[u+44>>2])+4|0))!=(0|c)?(C=h[m>>2],h[u+44>>2]=I,M=n-M|0,h[u+48>>2]=M,h[o>>2]=h[m+4>>2]>>>32-M|C<<b>>>32-n):h[o>>2]=0;if(n=h[g>>2]<<2,h[(o=n+a|0)>>2]=h[o>>2]|h[n+O>>2],!((s=s+1|0)>>>0<p[u+12>>2]))break}a=h[u+92>>2]}if(h[l+32>>2]=h[a>>2],h[l+36>>2]=h[a+4>>2],h[l+40>>2]=h[a+8>>2],It(h[T>>2],l+32|0),h[u+8>>2]=h[u+8>>2]+1,(0|t)==(0|(f=f+1|0)))break o;s=h[u+12>>2]}}else{if(!t)break o;for(;;){if(n=h[w>>2],f=h[n+8>>2],g=h[n+4>>2],b=h[n>>2],n=h[T>>2],(s=h[n+4>>2])>>>0<(m=h[n+8>>2])>>>0)h[s+8>>2]=f,h[s+4>>2]=g,h[s>>2]=b,h[n+4>>2]=s+12;else{if((c=1+(x=(s-(a=h[n>>2])|0)/12|0)|0)>>>0>=357913942)break e;if(R=(m=(m-a|0)/12|0)<<1,(c=m>>>0<178956970?c>>>0>R>>>0?c:R:357913941)>>>0>=357913942)break t;if(C=v(x,12),x=mi(m=v(c,12)),h[8+(c=C+x|0)>>2]=f,h[c+4>>2]=g,h[c>>2]=b,f=c+12|0,(0|s)!=(0|a))for(;s=s-12|0,h[(c=c-12|0)>>2]=h[s>>2],h[c+4>>2]=h[s+4>>2],h[c+8>>2]=h[s+8>>2],(0|s)!=(0|a););h[n+8>>2]=m+x,h[n+4>>2]=f,h[n>>2]=c,a&&ve(a)}if(h[u+8>>2]=h[u+8>>2]+1,(0|t)==(0|(o=o+1|0)))break}}if(!(s=h[l+28>>2]))break}if(h[l+28>>2]=0,(c=(s=h[l+16>>2])-(t=h[l+12>>2])|0)>>>0>=9)for(;ve(h[t>>2]),t=h[l+12>>2]+4|0,h[l+12>>2]=t,(c=(s=h[l+16>>2])-t|0)>>>0>8;);switch(a=170,(c>>>2|0)-1|0){case 1:a=341;case 0:h[l+24>>2]=a}if((0|t)!=(0|s)){for(;ve(h[t>>2]),(0|s)!=(0|(t=t+4|0)););(0|(t=h[l+16>>2]))!=(0|(n=h[l+12>>2]))&&(h[l+16>>2]=t+(((t-n|0)-4>>>2^-1)<<2))}(t=h[l+8>>2])&&ve(t),N=l+48|0}Zt(u);break i;case 4:if(c=J(i+8|0,3),w=i+664|0,o=h[t+12>>2],n=h[t+20>>2],n=(u=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(u>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o))&&(n=s+h[t>>2]|0,h[c>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(s=(u=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,f=s,h[t+16>>2]=s,h[t+20>>2]=n,!(p[c>>2]>32)&&(s=h[t+12>>2],n=o,n=(o=u+8|0)>>>0<8?n+1|0:n,!(o>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s))&&(n=f+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[c+4>>2]=o,n=h[t+20>>2],n=(s=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=s,h[t+20>>2]=n,o&&(h[c+8>>2]=0,ot(c+16|0,t)&&Tt(c+544|0,t)&&Tt(c+564|0,t)&&Tt(c+584|0,t)))))){if(T=h[c+4>>2],n=0,N=s=N-48|0,o=h[c+12>>2],h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,o){if(o>>>0>=1073741824)break e;a=mi(t=o<<2),h[s+8>>2]=a,n=t+a|0,h[s+16>>2]=n,St(a,0,t),h[s+12>>2]=n}if(t=h[c+628>>2],(u=h[t>>2])&&(h[t+4>>2]=u,ve(u),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,o=h[c+12>>2],a=h[s+8>>2],n=h[s+12>>2]),h[t+4>>2]=n,h[t>>2]=a,h[t+8>>2]=h[s+16>>2],a=0,h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,o){if(o>>>0>=1073741824)break e;l=mi(t=o<<2),h[s+8>>2]=l,a=t+l|0,h[s+16>>2]=a,St(l,0,t),h[s+12>>2]=a}t=h[c+640>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,l=h[s+8>>2],a=h[s+12>>2]),h[t+4>>2]=a,h[t>>2]=l,h[t+8>>2]=h[s+16>>2],h[s+24>>2]=0,h[s+28>>2]=0,h[s+16>>2]=0,h[s+20>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,Qe(s+8|0),n=((t=h[s+24>>2]+h[s+28>>2]|0)>>>0)/341|0,t=h[h[s+12>>2]+(n<<2)>>2]+v(t-v(n,341)|0,12)|0,h[t+4>>2]=0,h[t+8>>2]=0,h[t>>2]=T,o=(t=h[s+28>>2])+1|0,h[s+28>>2]=o;s:if(!(t>>>0>o>>>0))for(;;){if(E=h[s+12>>2],l=h[s+24>>2],t=h[E+((n=((t=l+(u=o-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(n,341)|0,12)|0,f=h[t+8>>2],a=h[t+4>>2],n=h[t>>2],h[s+28>>2]=u,1+(((u=(t=h[s+16>>2])-E|0)?v(u>>2,341)-1|0:0)-(o+l|0)|0)>>>0>=682&&(ve(h[t-4>>2]),h[s+16>>2]=h[s+16>>2]-4),n>>>0>T>>>0)break s;if((l=(0|a)==((t=h[c+12>>2])-1|0)?0:a+1|0)>>>0>=t>>>0)break s;g=(E=v(f,12))+h[c+640>>2]|0,u=E+h[c+628>>2]|0;o:{a:if(b=l<<2,o=h[c>>2]-h[b+h[g>>2]>>2]|0){l:{c:{u:{h:{if(n>>>0<=2){if(t=h[c+616>>2],h[t>>2]=l,a=1,(o=h[c+12>>2])>>>0>1)break h;break l}if(p[c+8>>2]>p[c+4>>2])break s;if((0|(a=(t=h[c+628>>2])+(g=v(m=f+1|0,12))|0))!=(0|u)&&(Ft(a,h[u>>2],h[u+4>>2]),t=h[c+628>>2]),t=b+h[t+g>>2]|0,h[t>>2]=h[t>>2]+(1<<o-1),a=0,o=0,t=31^y(n))for(;a=Br(16+(c+(o<<4)|0)|0)|a<<1,(0|t)!=(0|(o=o+1|0)););if((0|(o=n-(t=(n>>>1|0)-a|0)|0))!=(0|t)){if((0|(n=h[c+596>>2]))==h[c+588>>2])break u;a=h[n>>2],_=(u=h[c+600>>2])+1|0,h[c+600>>2]=_,a&=-2147483648>>>u;d:{if(32==(0|_)){if(h[c+600>>2]=0,h[c+596>>2]=n+4,a)break d;break u}if(!a)break u}n=o}else n=t;o=t;break c}for(;l=(o-1|0)==(0|l)?0:l+1|0,h[t+(a<<2)>>2]=l,(o=h[c+12>>2])>>>0>(a=a+1|0)>>>0;);break l}n=t}if(t=h[c+640>>2],u=h[(a=t+E|0)>>2],h[(E=u+b|0)>>2]=h[E>>2]+1,Ft(t+g|0,u,h[a+4>>2]),o&&(a=h[s+28>>2]+h[s+24>>2]|0,t=h[s+12>>2],(0|a)==(0|((u=h[s+16>>2]-t|0)?v(u>>2,341)-1|0:0))?(Qe(s+8|0),a=h[s+24>>2]+h[s+28>>2]|0,u=h[s+12>>2]):u=t,t=h[u+((t=(a>>>0)/341|0)<<2)>>2]+v(a-v(t,341)|0,12)|0,h[t+8>>2]=f,h[t+4>>2]=l,h[t>>2]=o,h[s+28>>2]=h[s+28>>2]+1),!n)break a;o=h[s+28>>2]+h[s+24>>2]|0,a=h[s+12>>2],(0|o)==(0|((t=h[s+16>>2]-a|0)?v(t>>2,341)-1|0:0))&&(Qe(s+8|0),a=h[s+12>>2],o=h[s+24>>2]+h[s+28>>2]|0),t=h[((t=(o>>>0)/341|0)<<2)+a>>2]+v(o-v(t,341)|0,12)|0,h[t+8>>2]=m,h[t+4>>2]=l,h[t>>2]=n,o=h[s+28>>2]+1|0,h[s+28>>2]=o;break o}if(t=0,n)for(;;){if(a=h[c+604>>2],o){for(E=h[c+548>>2],x=h[c+616>>2],R=h[u>>2],O=h[g>>2],o=0;;){h[(h[(b=x+(o<<2)|0)>>2]<<2)+a>>2]=0,f=h[b>>2]<<2;l:if(l=h[c>>2]-h[f+O>>2]|0)if(f=a+f|0,(0|(A=32-(m=h[c+560>>2])|0))>=(0|l)){if((0|(_=h[c+556>>2]))==(0|E)){h[f>>2]=0;break l}if(h[f>>2]=h[_>>2]<<m>>>32-l,l=l+h[c+560>>2]|0,h[c+560>>2]=l,32!=(0|l))break l;h[c+560>>2]=0,h[c+556>>2]=_+4}else(0|(M=(_=h[c+556>>2])+4|0))!=(0|E)?(I=h[_>>2],h[c+556>>2]=M,A=l-A|0,h[c+560>>2]=A,h[f>>2]=h[_+4>>2]>>>32-A|I<<m>>>32-l):h[f>>2]=0;if(l=h[b>>2]<<2,h[(f=l+a|0)>>2]=h[f>>2]|h[l+R>>2],!((o=o+1|0)>>>0<p[c+12>>2]))break}a=h[c+604>>2]}if(h[s+32>>2]=h[a>>2],h[s+36>>2]=h[a+4>>2],h[s+40>>2]=h[a+8>>2],It(h[w>>2],s+32|0),h[c+8>>2]=h[c+8>>2]+1,(0|n)==(0|(t=t+1|0)))break a;o=h[c+12>>2]}}else{if(t=0,!n)break a;for(;;){if(o=h[u>>2],E=h[o+8>>2],g=h[o+4>>2],b=h[o>>2],a=h[w>>2],(o=h[a+4>>2])>>>0<(m=h[a+8>>2])>>>0)h[o+8>>2]=E,h[o+4>>2]=g,h[o>>2]=b,h[a+4>>2]=o+12;else{if((l=1+(_=(o-(f=h[a>>2])|0)/12|0)|0)>>>0>=357913942)break e;if(x=(m=(m-f|0)/12|0)<<1,(l=m>>>0<178956970?l>>>0>x>>>0?l:x:357913941)>>>0>=357913942)break t;if(C=v(_,12),_=mi(m=v(l,12)),h[8+(l=C+_|0)>>2]=E,h[l+4>>2]=g,h[l>>2]=b,E=l+12|0,(0|o)!=(0|f))for(;o=o-12|0,h[(l=l-12|0)>>2]=h[o>>2],h[l+4>>2]=h[o+4>>2],h[l+8>>2]=h[o+8>>2],(0|o)!=(0|f););h[a+8>>2]=m+_,h[a+4>>2]=E,h[a>>2]=l,f&&ve(f)}if(h[c+8>>2]=h[c+8>>2]+1,(0|n)==(0|(t=t+1|0)))break}}o=h[s+28>>2]}if(!o)break}if(h[s+28>>2]=0,(l=(o=h[s+16>>2])-(t=h[s+12>>2])|0)>>>0>=9)for(;ve(h[t>>2]),t=h[s+12>>2]+4|0,h[s+12>>2]=t,(l=(o=h[s+16>>2])-t|0)>>>0>8;);switch(n=170,(l>>>2|0)-1|0){case 1:n=341;case 0:h[s+24>>2]=n}if((0|t)!=(0|o)){for(;ve(h[t>>2]),(0|o)!=(0|(t=t+4|0)););(0|(t=h[s+16>>2]))!=(0|(n=h[s+12>>2]))&&(h[s+16>>2]=t+(((t-n|0)-4>>>2^-1)<<2))}(t=h[s+8>>2])&&ve(t),N=s+48|0}Xt(c);break i;case 5:if(l=J(i+8|0,3),T=i+664|0,o=h[t+12>>2],n=h[t+20>>2],n=(u=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(u>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o))&&(n=s+h[t>>2]|0,h[l>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(s=(u=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,f=s,h[t+16>>2]=s,h[t+20>>2]=n,!(p[l>>2]>32)&&(s=h[t+12>>2],n=o,n=(o=u+8|0)>>>0<8?n+1|0:n,!(o>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s))&&(n=f+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[l+4>>2]=o,n=h[t+20>>2],n=(s=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=s,h[t+20>>2]=n,o&&(h[l+8>>2]=0,ot(l+16|0,t)&&Tt(l+544|0,t)&&Tt(l+564|0,t)&&Tt(l+584|0,t)))))){if(E=h[l+4>>2],n=0,N=s=N-48|0,o=h[l+12>>2],h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,o){if(o>>>0>=1073741824)break e;a=mi(t=o<<2),h[s+8>>2]=a,n=t+a|0,h[s+16>>2]=n,St(a,0,t),h[s+12>>2]=n}if(t=h[l+628>>2],(u=h[t>>2])&&(h[t+4>>2]=u,ve(u),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,o=h[l+12>>2],a=h[s+8>>2],n=h[s+12>>2]),h[t+4>>2]=n,h[t>>2]=a,h[t+8>>2]=h[s+16>>2],a=0,h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,o){if(o>>>0>=1073741824)break e;c=mi(t=o<<2),h[s+8>>2]=c,a=t+c|0,h[s+16>>2]=a,St(c,0,t),h[s+12>>2]=a}t=h[l+640>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,c=h[s+8>>2],a=h[s+12>>2]),h[t+4>>2]=a,h[t>>2]=c,h[t+8>>2]=h[s+16>>2],h[s+24>>2]=0,h[s+28>>2]=0,h[s+16>>2]=0,h[s+20>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,Qe(s+8|0),n=((t=h[s+24>>2]+h[s+28>>2]|0)>>>0)/341|0,t=h[h[s+12>>2]+(n<<2)>>2]+v(t-v(n,341)|0,12)|0,h[t+4>>2]=0,h[t+8>>2]=0,h[t>>2]=E,o=(t=h[s+28>>2])+1|0,h[s+28>>2]=o;s:if(!(t>>>0>o>>>0))for(;;){if(u=h[s+12>>2],a=h[s+24>>2],t=h[u+((n=((t=a+(c=o-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(n,341)|0,12)|0,w=h[t+8>>2],n=h[t+4>>2],t=h[t>>2],h[s+28>>2]=c,1+(((u=(c=h[s+16>>2])-u|0)?v(u>>2,341)-1|0:0)-(a+o|0)|0)>>>0>=682&&(ve(h[c-4>>2]),h[s+16>>2]=h[s+16>>2]-4),t>>>0>E>>>0)break s;if((c=(0|n)==((o=h[l+12>>2])-1|0)?0:n+1|0)>>>0>=o>>>0)break s;f=(n=h[l+628>>2])+(u=v(w,12))|0;o:{a:if(g=c<<2,_=u+h[l+640>>2]|0,o=h[l>>2]-h[g+h[_>>2]>>2]|0){l:{c:{u:{h:{if(t>>>0<=2){if(n=h[l+616>>2],h[n>>2]=c,a=1,(o=h[l+12>>2])>>>0>1)break h;break l}if(p[l+8>>2]>p[l+4>>2])break s;if(Ft((a=n)+(n=u+12|0)|0,h[f>>2],h[f+4>>2]),n=g+h[n+h[l+628>>2]>>2]|0,h[n>>2]=h[n>>2]+(1<<o-1),a=0,o=0,n=31^y(t))for(;a=Br(16+(l+(o<<4)|0)|0)|a<<1,(0|n)!=(0|(o=o+1|0)););if(f=w+1|0,(0|(o=(n=t)-(t=(t>>>1|0)-a|0)|0))!=(0|t)){if((0|(n=h[l+596>>2]))==h[l+588>>2])break u;a=h[n>>2],m=(b=h[l+600>>2])+1|0,h[l+600>>2]=m,a&=-2147483648>>>b;d:{if(32==(0|m)){if(h[l+600>>2]=0,h[l+596>>2]=n+4,a)break d;break u}if(!a)break u}n=o}else n=t;o=t;break c}for(;c=(o-1|0)==(0|c)?0:c+1|0,h[n+(a<<2)>>2]=c,(o=h[l+12>>2])>>>0>(a=a+1|0)>>>0;);break l}n=t}if(t=h[l+640>>2],u=h[(a=t+u|0)>>2],h[(g=u+g|0)>>2]=h[g>>2]+1,Ft(t+v(f,12)|0,u,h[a+4>>2]),o&&(a=h[s+28>>2]+h[s+24>>2]|0,u=h[s+12>>2],(0|a)==(0|((t=h[s+16>>2]-u|0)?v(t>>2,341)-1|0:0))&&(Qe(s+8|0),u=h[s+12>>2],a=h[s+24>>2]+h[s+28>>2]|0),t=h[((t=(a>>>0)/341|0)<<2)+u>>2]+v(a-v(t,341)|0,12)|0,h[t+8>>2]=w,h[t+4>>2]=c,h[t>>2]=o,h[s+28>>2]=h[s+28>>2]+1),!n)break a;o=h[s+28>>2]+h[s+24>>2]|0,a=h[s+12>>2],(0|o)==(0|((t=h[s+16>>2]-a|0)?v(t>>2,341)-1|0:0))&&(Qe(s+8|0),a=h[s+12>>2],o=h[s+24>>2]+h[s+28>>2]|0),t=h[((t=(o>>>0)/341|0)<<2)+a>>2]+v(o-v(t,341)|0,12)|0,h[t+8>>2]=f,h[t+4>>2]=c,h[t>>2]=n,o=h[s+28>>2]+1|0,h[s+28>>2]=o;break o}if(u=0,t)for(;;){if(a=h[l+604>>2],o){for(w=h[l+548>>2],x=h[l+616>>2],R=h[f>>2],O=h[_>>2],o=0;;){h[(h[(g=x+(o<<2)|0)>>2]<<2)+a>>2]=0,c=h[g>>2]<<2;l:if(n=h[l>>2]-h[c+O>>2]|0)if(c=a+c|0,(0|(A=32-(b=h[l+560>>2])|0))>=(0|n)){if((0|(m=h[l+556>>2]))==(0|w)){h[c>>2]=0;break l}if(h[c>>2]=h[m>>2]<<b>>>32-n,n=n+h[l+560>>2]|0,h[l+560>>2]=n,32!=(0|n))break l;h[l+560>>2]=0,h[l+556>>2]=m+4}else(0|(M=(m=h[l+556>>2])+4|0))!=(0|w)?(I=h[m>>2],h[l+556>>2]=M,A=n-A|0,h[l+560>>2]=A,h[c>>2]=h[m+4>>2]>>>32-A|I<<b>>>32-n):h[c>>2]=0;if(n=h[g>>2]<<2,h[(c=n+a|0)>>2]=h[c>>2]|h[n+R>>2],!((o=o+1|0)>>>0<p[l+12>>2]))break}a=h[l+604>>2]}if(h[s+32>>2]=h[a>>2],h[s+36>>2]=h[a+4>>2],h[s+40>>2]=h[a+8>>2],It(h[T>>2],s+32|0),h[l+8>>2]=h[l+8>>2]+1,(0|t)==(0|(u=u+1|0)))break a;o=h[l+12>>2]}}else{if(u=0,!t)break a;for(;;){if(n=h[f>>2],w=h[n+8>>2],g=h[n+4>>2],b=h[n>>2],n=h[T>>2],(o=h[n+4>>2])>>>0<(m=h[n+8>>2])>>>0)h[o+8>>2]=w,h[o+4>>2]=g,h[o>>2]=b,h[n+4>>2]=o+12;else{if((c=1+(_=(o-(a=h[n>>2])|0)/12|0)|0)>>>0>=357913942)break e;if(x=(m=(m-a|0)/12|0)<<1,(c=m>>>0<178956970?c>>>0>x>>>0?c:x:357913941)>>>0>=357913942)break t;if(C=v(_,12),_=mi(m=v(c,12)),h[8+(c=C+_|0)>>2]=w,h[c+4>>2]=g,h[c>>2]=b,w=c+12|0,(0|a)!=(0|o))for(;o=o-12|0,h[(c=c-12|0)>>2]=h[o>>2],h[c+4>>2]=h[o+4>>2],h[c+8>>2]=h[o+8>>2],(0|a)!=(0|o););h[n+8>>2]=m+_,h[n+4>>2]=w,h[n>>2]=c,a&&ve(a)}if(h[l+8>>2]=h[l+8>>2]+1,(0|t)==(0|(u=u+1|0)))break}}o=h[s+28>>2]}if(!o)break}if(h[s+28>>2]=0,(c=(o=h[s+16>>2])-(t=h[s+12>>2])|0)>>>0>=9)for(;ve(h[t>>2]),t=h[s+12>>2]+4|0,h[s+12>>2]=t,(c=(o=h[s+16>>2])-t|0)>>>0>8;);switch(a=170,(c>>>2|0)-1|0){case 1:a=341;case 0:h[s+24>>2]=a}if((0|t)!=(0|o)){for(;ve(h[t>>2]),(0|o)!=(0|(t=t+4|0)););(0|(t=h[s+16>>2]))!=(0|(n=h[s+12>>2]))&&(h[s+16>>2]=t+(((t-n|0)-4>>>2^-1)<<2))}(t=h[s+8>>2])&&ve(t),N=s+48|0}Xt(l);break i;case 6:break n;default:break r}if(c=J(i+8|0,3),w=i+664|0,o=h[t+12>>2],n=h[t+20>>2],n=(u=(s=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(u>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o))&&(n=s+h[t>>2]|0,h[c>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,o=n=h[t+20>>2],n=(s=(u=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,f=s,h[t+16>>2]=s,h[t+20>>2]=n,!(p[c>>2]>32)&&(s=h[t+12>>2],n=o,n=(o=u+8|0)>>>0<8?n+1|0:n,!(o>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s))&&(n=f+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[c+4>>2]=o,n=h[t+20>>2],n=(s=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=s,h[t+20>>2]=n,o&&(h[c+8>>2]=0,ot(c+16|0,t)&&Tt(c+544|0,t)&&Tt(c+564|0,t)&&Tt(c+584|0,t)))))){if(T=h[c+4>>2],n=0,N=s=N-48|0,o=h[c+12>>2],h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,o){if(o>>>0>=1073741824)break e;a=mi(t=o<<2),h[s+8>>2]=a,n=t+a|0,h[s+16>>2]=n,St(a,0,t),h[s+12>>2]=n}if(t=h[c+628>>2],(u=h[t>>2])&&(h[t+4>>2]=u,ve(u),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,o=h[c+12>>2],a=h[s+8>>2],n=h[s+12>>2]),h[t+4>>2]=n,h[t>>2]=a,h[t+8>>2]=h[s+16>>2],a=0,h[s+16>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,o){if(o>>>0>=1073741824)break e;l=mi(t=o<<2),h[s+8>>2]=l,a=t+l|0,h[s+16>>2]=a,St(l,0,t),h[s+12>>2]=a}t=h[c+640>>2],(n=h[t>>2])&&(h[t+4>>2]=n,ve(n),h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,l=h[s+8>>2],a=h[s+12>>2]),h[t+4>>2]=a,h[t>>2]=l,h[t+8>>2]=h[s+16>>2],h[s+24>>2]=0,h[s+28>>2]=0,h[s+16>>2]=0,h[s+20>>2]=0,h[s+8>>2]=0,h[s+12>>2]=0,Qe(s+8|0),n=((t=h[s+24>>2]+h[s+28>>2]|0)>>>0)/341|0,t=h[h[s+12>>2]+(n<<2)>>2]+v(t-v(n,341)|0,12)|0,h[t+4>>2]=0,h[t+8>>2]=0,h[t>>2]=T,o=(t=h[s+28>>2])+1|0,h[s+28>>2]=o;n:if(!(t>>>0>o>>>0))for(;;){if(u=h[s+12>>2],t=h[s+24>>2],n=h[u+((l=((n=t+(a=o-1|0)|0)>>>0)/341|0)<<2)>>2]+v(n-v(l,341)|0,12)|0,f=h[n+8>>2],n=h[n>>2],h[s+28>>2]=a,1+(((l=(a=h[s+16>>2])-u|0)?v(l>>2,341)-1|0:0)-(t+o|0)|0)>>>0>=682&&(ve(h[a-4>>2]),h[s+16>>2]=h[s+16>>2]-4),n>>>0>T>>>0)break n;if(t=h[c+628>>2],(l=ft(c,n,g=(E=v(f,12))+h[c+640>>2]|0))>>>0>=p[c+12>>2])break n;u=t+E|0;s:{o:if(b=l<<2,o=h[c>>2]-h[b+h[g>>2]>>2]|0){a:{l:{c:{u:{if(n>>>0<=2){if(t=h[c+616>>2],h[t>>2]=l,a=1,(o=h[c+12>>2])>>>0>1)break u;break a}if(p[c+8>>2]>p[c+4>>2])break n;if((0|(a=(t=h[c+628>>2])+(g=v(m=f+1|0,12))|0))!=(0|u)&&(Ft(a,h[u>>2],h[u+4>>2]),t=h[c+628>>2]),t=b+h[t+g>>2]|0,h[t>>2]=h[t>>2]+(1<<o-1),a=0,o=0,t=31^y(n))for(;a=Br(16+(c+(o<<4)|0)|0)|a<<1,(0|t)!=(0|(o=o+1|0)););if((0|(o=n-(t=(n>>>1|0)-a|0)|0))!=(0|t)){if((0|(n=h[c+596>>2]))==h[c+588>>2])break c;a=h[n>>2],_=(u=h[c+600>>2])+1|0,h[c+600>>2]=_,a&=-2147483648>>>u;h:{if(32==(0|_)){if(h[c+600>>2]=0,h[c+596>>2]=n+4,a)break h;break c}if(!a)break c}n=o}else n=t;o=t;break l}for(;l=(o-1|0)==(0|l)?0:l+1|0,h[t+(a<<2)>>2]=l,(o=h[c+12>>2])>>>0>(a=a+1|0)>>>0;);break a}n=t}if(t=h[c+640>>2],u=h[(a=t+E|0)>>2],h[(E=u+b|0)>>2]=h[E>>2]+1,Ft(t+g|0,u,h[a+4>>2]),o&&(a=h[s+28>>2]+h[s+24>>2]|0,t=h[s+12>>2],(0|a)==(0|((u=h[s+16>>2]-t|0)?v(u>>2,341)-1|0:0))?(Qe(s+8|0),a=h[s+24>>2]+h[s+28>>2]|0,u=h[s+12>>2]):u=t,t=h[u+((t=(a>>>0)/341|0)<<2)>>2]+v(a-v(t,341)|0,12)|0,h[t+8>>2]=f,h[t+4>>2]=l,h[t>>2]=o,h[s+28>>2]=h[s+28>>2]+1),!n)break o;o=h[s+28>>2]+h[s+24>>2]|0,a=h[s+12>>2],(0|o)==(0|((t=h[s+16>>2]-a|0)?v(t>>2,341)-1|0:0))&&(Qe(s+8|0),a=h[s+12>>2],o=h[s+24>>2]+h[s+28>>2]|0),t=h[((t=(o>>>0)/341|0)<<2)+a>>2]+v(o-v(t,341)|0,12)|0,h[t+8>>2]=m,h[t+4>>2]=l,h[t>>2]=n,o=h[s+28>>2]+1|0,h[s+28>>2]=o;break s}if(t=0,n)for(;;){if(a=h[c+604>>2],o){for(E=h[c+548>>2],x=h[c+616>>2],R=h[u>>2],O=h[g>>2],o=0;;){h[(h[(b=x+(o<<2)|0)>>2]<<2)+a>>2]=0,f=h[b>>2]<<2;a:if(l=h[c>>2]-h[f+O>>2]|0)if(f=a+f|0,(0|(A=32-(m=h[c+560>>2])|0))>=(0|l)){if((0|(_=h[c+556>>2]))==(0|E)){h[f>>2]=0;break a}if(h[f>>2]=h[_>>2]<<m>>>32-l,l=l+h[c+560>>2]|0,h[c+560>>2]=l,32!=(0|l))break a;h[c+560>>2]=0,h[c+556>>2]=_+4}else(0|(M=(_=h[c+556>>2])+4|0))!=(0|E)?(I=h[_>>2],h[c+556>>2]=M,A=l-A|0,h[c+560>>2]=A,h[f>>2]=h[_+4>>2]>>>32-A|I<<m>>>32-l):h[f>>2]=0;if(l=h[b>>2]<<2,h[(f=l+a|0)>>2]=h[f>>2]|h[l+R>>2],!((o=o+1|0)>>>0<p[c+12>>2]))break}a=h[c+604>>2]}if(h[s+32>>2]=h[a>>2],h[s+36>>2]=h[a+4>>2],h[s+40>>2]=h[a+8>>2],It(h[w>>2],s+32|0),h[c+8>>2]=h[c+8>>2]+1,(0|n)==(0|(t=t+1|0)))break o;o=h[c+12>>2]}}else{if(t=0,!n)break o;for(;;){if(o=h[u>>2],E=h[o+8>>2],g=h[o+4>>2],b=h[o>>2],a=h[w>>2],(o=h[a+4>>2])>>>0<(m=h[a+8>>2])>>>0)h[o+8>>2]=E,h[o+4>>2]=g,h[o>>2]=b,h[a+4>>2]=o+12;else{if((l=1+(_=(o-(f=h[a>>2])|0)/12|0)|0)>>>0>=357913942)break e;if(x=(m=(m-f|0)/12|0)<<1,(l=m>>>0<178956970?l>>>0>x>>>0?l:x:357913941)>>>0>=357913942)break t;if(C=v(_,12),_=mi(m=v(l,12)),h[8+(l=C+_|0)>>2]=E,h[l+4>>2]=g,h[l>>2]=b,E=l+12|0,(0|o)!=(0|f))for(;o=o-12|0,h[(l=l-12|0)>>2]=h[o>>2],h[l+4>>2]=h[o+4>>2],h[l+8>>2]=h[o+8>>2],(0|o)!=(0|f););h[a+8>>2]=m+_,h[a+4>>2]=E,h[a>>2]=l,f&&ve(f)}if(h[c+8>>2]=h[c+8>>2]+1,(0|n)==(0|(t=t+1|0)))break}}o=h[s+28>>2]}if(!o)break}if(h[s+28>>2]=0,(l=(o=h[s+16>>2])-(t=h[s+12>>2])|0)>>>0>=9)for(;ve(h[t>>2]),t=h[s+12>>2]+4|0,h[s+12>>2]=t,(l=(o=h[s+16>>2])-t|0)>>>0>8;);switch(n=170,(l>>>2|0)-1|0){case 1:n=341;case 0:h[s+24>>2]=n}if((0|t)!=(0|o)){for(;ve(h[t>>2]),(0|o)!=(0|(t=t+4|0)););(0|(t=h[s+16>>2]))!=(0|(n=h[s+12>>2]))&&(h[s+16>>2]=t+(((t-n|0)-4>>>2^-1)<<2))}(t=h[s+8>>2])&&ve(t),N=s+48|0}Xt(c)}a=h[e+12>>2]==((h[r+4>>2]-h[r>>2]|0)/12|0)}return N=i+672|0,a}Zr(1336),S()}vn(),S()}function U(e,t,r,i){var n=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,S=0,M=0,C=0,R=0;if(!e)return 1;e:if(!((0|(n=h[r+20>>2]))>=(0|(a=h[r+12>>2]))&(o=h[r+16>>2])>>>0>=p[r+8>>2]|(0|n)>(0|a))){a=d[o+h[r>>2]|0],n=(o=o+1|0)?n:n+1|0,h[r+16>>2]=o,h[r+20>>2]=n;t:switch(0|a){case 0:m=e,l=t,o=i,e=0,i=0,N=y=N+-64|0,h[y+56>>2]=0,h[y+48>>2]=0,h[y+52>>2]=0,h[y+40>>2]=0,h[y+44>>2]=0,h[y+32>>2]=0,h[y+36>>2]=0,h[y+24>>2]=0,h[y+28>>2]=0,h[y+16>>2]=0,h[y+20>>2]=0,h[y+8>>2]=0,h[y+12>>2]=0;r:if(Ce(y+8|0,r)&&!(!We(y+8|0,r)|(h[y+20>>2]?0:m))){if(Dt(r,0,0),m)for(E=l<<2,w=h[y+36>>2],A=h[y+48>>2],T=h[y+24>>2];;){i:if(!((_=h[y+56>>2])>>>0>16383))for(e=h[y+52>>2];;){if((0|e)<=0)break i;if(e=e-1|0,h[y+52>>2]=e,_=d[e+A|0]|_<<8,h[y+56>>2]=_,!(_>>>0<16384))break}if(t=w+((b=h[((e=4095&_)<<2)+T>>2])<<3)|0,h[y+56>>2]=(v(h[t>>2],_>>>12|0)+e|0)-h[t+4>>2],!((0|l)<=0)){if(e=0,!d[r+36|0]|b>>>0>32)break r;if(b){for(C=-2&b,R=1&b,a=i+l|0,t=h[r+32>>2];;){if(c=h[r+28>>2],u=h[r+24>>2],_=0,e=t,n=0,x=0,1!=(0|b))for(;(g=u+(e>>>3|0)|0)>>>0>=c>>>0?g=0:(g=d[0|g],t=e+1|0,h[r+32>>2]=t,g=g>>>(7&e)&1,e=t),g=g<<_|n,n=0,(S=u+(e>>>3|0)|0)>>>0<c>>>0&&(n=d[0|S],t=e+1|0,h[r+32>>2]=t,n=n>>>(7&e)&1,e=t),S=1|_,_=_+2|0,n=g|n<<S,(0|C)!=(0|(x=x+2|0)););if(g=o+(i<<2)|0,R&&((x=c)>>>0>(c=u+(e>>>3|0)|0)>>>0?(c=d[0|c],t=e+1|0,h[r+32>>2]=t,e=c>>>(7&e)&1):e=0,n|=e<<_),h[g>>2]=n,(0|a)==(0|(i=i+1|0)))break}i=a}else St(o+(i<<2)|0,0,E),i=i+l|0}if(!(m>>>0>(M=l+M|0)>>>0))break}s[r+36|0]=0,t=h[r+20>>2],n=0,e=(i=(7&(n=(e=h[r+32>>2]+7|0)>>>0<7?1:n))<<29|e>>>3)+h[r+16>>2]|0,n=(n>>>3|0)+t|0,h[r+16>>2]=e,h[r+20>>2]=e>>>0<i>>>0?n+1|0:n,e=1}return(t=h[y+36>>2])&&(h[y+40>>2]=t,ve(t)),(t=h[y+24>>2])&&(h[y+28>>2]=t,ve(t)),(t=h[y+8>>2])&&(h[y+12>>2]=t,ve(t)),N=y- -64|0,e;case 1:break t;default:break e}t=0;t:if(!((0|(n=h[r+20>>2]))>=(0|(a=h[r+12>>2]))&(o=h[r+16>>2])>>>0>=p[r+8>>2]|(0|n)>(0|a))){a=d[o+h[r>>2]|0],n=(o=o+1|0)?n:n+1|0,h[r+16>>2]=o,h[r+20>>2]=n;r:switch(a-1|0){case 8:a=e,y=i,N=o=N+-64|0,h[o+56>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0,b=o+8|0;i:{n:if(e=f[r+38>>1]){if(e>>>0<=511){if(e=h[r+12>>2],n=h[r+20>>2],(0|e)<=(0|(n=(i=(t=h[r+16>>2])+4|0)>>>0<4?n+1|0:n))&i>>>0>p[r+8>>2]|(0|e)<(0|n))break n;e=t+h[r>>2]|0,u=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,h[b+12>>2]=u,n=h[r+20>>2],n=(e=h[r+16>>2]+4|0)>>>0<4?n+1|0:n,h[r+16>>2]=e,h[r+20>>2]=n}else{if(!yr(1,b+12|0,r))break n;u=h[b+12>>2]}if(t=h[b>>2],(e=h[b+4>>2]-t>>2)>>>0<u>>>0?(er(b,u-e|0),u=h[b+12>>2]):e>>>0<=u>>>0||(h[b+4>>2]=t+(u<<2)),i=1,!u)break i;for(w=h[r+8>>2],g=h[r+12>>2],A=h[b>>2],t=0;;){if(i=0,(0|g)<=(0|(n=h[r+20>>2]))&w>>>0<=(e=h[r+16>>2])>>>0|(0|n)>(0|g))break i;i=h[r>>2],E=d[i+e|0],n=(e=e+1|0)?n:n+1|0,l=e,h[r+16>>2]=e,h[r+20>>2]=n,e=E>>>2|0,c=0;s:{o:{a:{l:switch(0|(T=3&E)){case 0:break o;case 3:break l;default:break a}if(i=0,(e=e+t|0)>>>0>=u>>>0)break i;St(A+(t<<2)|0,0,4+(252&E)|0),t=e;break s}for(;;){if((0|n)>=(0|g)&l>>>0>=w>>>0|(0|n)>(0|g))break n;if(u=d[i+l|0],n=(l=l+1|0)?n:n+1|0,h[r+16>>2]=l,h[r+20>>2]=n,e|=u<<(c<<3|6),(0|T)==(0|(c=c+1|0)))break}}h[A+(t<<2)>>2]=e}if(!((t=t+1|0)>>>0<(u=h[b+12>>2])>>>0))break}if(l=b+16|0,E=h[b>>2],t=h[b+16>>2],(e=h[b+20>>2]-t|0)>>>0<=32767?er(l,8192-(e>>>2|0)|0):32768!=(0|e)&&(h[b+20>>2]=t+32768),t=h[(e=b+28|0)>>2],(i=h[b+32>>2]-t>>3)>>>0<u>>>0)tr(e,u-i|0),t=h[e>>2];else if(i>>>0>u>>>0&&(h[b+32>>2]=(u<<3)+t),!u)break n;for(c=0,i=0;;){if(b=h[(n=E+(c<<2)|0)>>2],e=i,h[4+(g=(c<<3)+t|0)>>2]=e,h[g>>2]=b,(i=(n=h[n>>2])+e|0)>>>0>8192)break n;if(!(e>>>0>=i>>>0)){if(b=h[l>>2],g=0,w=7&n)for(;h[b+(e<<2)>>2]=c,e=e+1|0,(0|w)!=(0|(g=g+1|0)););if(!(n-1>>>0<=6))for(;h[(n=b+(e<<2)|0)>>2]=c,h[n+28>>2]=c,h[n+24>>2]=c,h[n+20>>2]=c,h[n+16>>2]=c,h[n+12>>2]=c,h[n+8>>2]=c,h[n+4>>2]=c,(0|i)!=(0|(e=e+8|0)););}if((0|u)==(0|(c=c+1|0)))break}m=8192==(0|i)}i=m}if(!(!i|(h[o+20>>2]?0:a))){i=0,N=b=N-16|0;i:{if(f[r+38>>1]<=511){if(e=c=h[r+12>>2],n=h[r+20>>2],n=(l=(m=h[r+16>>2])+8|0)>>>0<8?n+1|0:n,(t=h[r+8>>2])>>>0<l>>>0&(0|e)<=(0|n)|(0|e)<(0|n))break i;m=m+h[r>>2]|0,e=d[0|m]|d[m+1|0]<<8|d[m+2|0]<<16|d[m+3|0]<<24,m=d[m+4|0]|d[m+5|0]<<8|d[m+6|0]<<16|d[m+7|0]<<24,h[r+16>>2]=l,h[r+20>>2]=n}else{if(!hr(1,b+8|0,r))break i;l=h[r+16>>2],n=h[r+20>>2],t=h[r+8>>2],c=h[r+12>>2],e=h[b+8>>2],m=h[b+12>>2]}if(u=t-l|0,!((0|(t=c-((t>>>0<l>>>0)+n|0)|0))==(0|m)&e>>>0>u>>>0|t>>>0<m>>>0||(n=n+m|0,n=(t=e+l|0)>>>0<e>>>0?n+1|0:n,h[r+16>>2]=t,h[r+20>>2]=n,(0|e)<=0))){t=l+h[r>>2]|0,h[o+48>>2]=t;n:if((l=d[0|(n=(r=e-1|0)+t|0)])>>>0<=63)h[o+52>>2]=r,e=63&d[0|n];else{switch((l>>>6|0)-1|0){case 0:if(e>>>0<2)break i;h[o+52>>2]=e-2,e=d[1+(e=(e+t|0)-2|0)|0]<<8&16128|d[0|e];break n;case 1:if(e>>>0<3)break i;h[o+52>>2]=e-3,e=d[2+(e=(e+t|0)-3|0)|0]<<16&4128768|d[e+1|0]<<8|d[0|e];break n}h[o+52>>2]=e-4,e=d[2+(e=(e+t|0)-4|0)|0]<<16|d[e+3|0]<<24&1056964608|d[e+1|0]<<8|d[0|e]}e=e+32768|0,h[o+56>>2]=e,i=e>>>0<8388608}}if(N=b+16|0,i)if(a)for(t=h[o+36>>2],r=h[o+48>>2],i=h[o+24>>2],e=h[o+56>>2];;){i:if(!(e>>>0>32767))for(_=h[o+52>>2];;){if((0|_)<=0)break i;if(_=_-1|0,h[o+52>>2]=_,e=d[r+_|0]|e<<8,h[o+56>>2]=e,!(e>>>0<32768))break}if(l=h[i+((n=8191&e)<<2)>>2],e=(v(h[(_=t+(l<<3)|0)>>2],e>>>13|0)+n|0)-h[_+4>>2]|0,h[o+56>>2]=e,h[y+(x<<2)>>2]=l,_=1,(0|a)==(0|(x=x+1|0)))break}else _=1}(e=h[o+36>>2])&&(h[o+40>>2]=e,ve(e)),(e=h[o+24>>2])&&(h[o+28>>2]=e,ve(e)),(e=h[o+8>>2])&&(h[o+12>>2]=e,ve(e)),N=o- -64|0,t=_;break t;case 9:y=e,b=i,N=a=N+-64|0,h[a+56>>2]=0,h[a+48>>2]=0,h[a+52>>2]=0,h[a+40>>2]=0,h[a+44>>2]=0,h[a+32>>2]=0,h[a+36>>2]=0,h[a+24>>2]=0,h[a+28>>2]=0,h[a+16>>2]=0,h[a+20>>2]=0,h[a+8>>2]=0,h[a+12>>2]=0,o=a+8|0;i:{n:if(e=f[r+38>>1]){if(e>>>0<=511){if(e=h[r+12>>2],n=h[r+20>>2],(0|e)<=(0|(n=(i=(t=h[r+16>>2])+4|0)>>>0<4?n+1|0:n))&i>>>0>p[r+8>>2]|(0|e)<(0|n))break n;e=t+h[r>>2]|0,u=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,h[o+12>>2]=u,n=h[r+20>>2],n=(e=h[r+16>>2]+4|0)>>>0<4?n+1|0:n,h[r+16>>2]=e,h[r+20>>2]=n}else{if(!yr(1,o+12|0,r))break n;u=h[o+12>>2]}if(t=h[o>>2],(e=h[o+4>>2]-t>>2)>>>0<u>>>0?(er(o,u-e|0),u=h[o+12>>2]):e>>>0<=u>>>0||(h[o+4>>2]=t+(u<<2)),i=1,!u)break i;for(w=h[r+8>>2],g=h[r+12>>2],A=h[o>>2],t=0;;){if(i=0,(0|g)<=(0|(n=h[r+20>>2]))&w>>>0<=(e=h[r+16>>2])>>>0|(0|n)>(0|g))break i;i=h[r>>2],E=d[i+e|0],n=(e=e+1|0)?n:n+1|0,l=e,h[r+16>>2]=e,h[r+20>>2]=n,e=E>>>2|0,c=0;s:{o:{a:{l:switch(0|(T=3&E)){case 0:break o;case 3:break l;default:break a}if(i=0,(e=e+t|0)>>>0>=u>>>0)break i;St(A+(t<<2)|0,0,4+(252&E)|0),t=e;break s}for(;;){if((0|n)>=(0|g)&l>>>0>=w>>>0|(0|n)>(0|g))break n;if(u=d[i+l|0],n=(l=l+1|0)?n:n+1|0,h[r+16>>2]=l,h[r+20>>2]=n,e|=u<<(c<<3|6),(0|T)==(0|(c=c+1|0)))break}}h[A+(t<<2)>>2]=e}if(!((t=t+1|0)>>>0<(u=h[o+12>>2])>>>0))break}if(l=o+16|0,E=h[o>>2],t=h[o+16>>2],(e=h[o+20>>2]-t|0)>>>0<=131071?er(l,32768-(e>>>2|0)|0):131072!=(0|e)&&(h[o+20>>2]=t+131072),t=h[(e=o+28|0)>>2],(i=h[o+32>>2]-t>>3)>>>0<u>>>0)tr(e,u-i|0),t=h[e>>2];else if(i>>>0>u>>>0&&(h[o+32>>2]=(u<<3)+t),!u)break n;for(c=0,i=0;;){if(o=h[(n=E+(c<<2)|0)>>2],e=i,h[4+(g=(c<<3)+t|0)>>2]=e,h[g>>2]=o,(i=(n=h[n>>2])+e|0)>>>0>32768)break n;if(!(e>>>0>=i>>>0)){if(o=h[l>>2],g=0,w=7&n)for(;h[o+(e<<2)>>2]=c,e=e+1|0,(0|w)!=(0|(g=g+1|0)););if(!(n-1>>>0<=6))for(;h[(n=o+(e<<2)|0)>>2]=c,h[n+28>>2]=c,h[n+24>>2]=c,h[n+20>>2]=c,h[n+16>>2]=c,h[n+12>>2]=c,h[n+8>>2]=c,h[n+4>>2]=c,(0|i)!=(0|(e=e+8|0)););}if((0|u)==(0|(c=c+1|0)))break}m=32768==(0|i)}i=m}if(!(!i|(h[a+20>>2]?0:y))){i=0,N=u=N-16|0;i:{if(f[r+38>>1]<=511){if(e=c=h[r+12>>2],n=h[r+20>>2],n=(l=(m=h[r+16>>2])+8|0)>>>0<8?n+1|0:n,(t=h[r+8>>2])>>>0<l>>>0&(0|e)<=(0|n)|(0|e)<(0|n))break i;m=m+h[r>>2]|0,e=d[0|m]|d[m+1|0]<<8|d[m+2|0]<<16|d[m+3|0]<<24,m=d[m+4|0]|d[m+5|0]<<8|d[m+6|0]<<16|d[m+7|0]<<24,h[r+16>>2]=l,h[r+20>>2]=n}else{if(!hr(1,u+8|0,r))break i;l=h[r+16>>2],n=h[r+20>>2],t=h[r+8>>2],c=h[r+12>>2],e=h[u+8>>2],m=h[u+12>>2]}if(o=t-l|0,!((0|(t=c-((t>>>0<l>>>0)+n|0)|0))==(0|m)&e>>>0>o>>>0|t>>>0<m>>>0||(o=n+m|0,o=(t=e+l|0)>>>0<e>>>0?o+1|0:o,h[r+16>>2]=t,h[r+20>>2]=o,(0|e)<=0))){t=l+h[r>>2]|0,h[a+48>>2]=t;n:if((l=d[0|(n=(r=e-1|0)+t|0)])>>>0<=63)h[a+52>>2]=r,e=63&d[0|n];else{switch((l>>>6|0)-1|0){case 0:if(e>>>0<2)break i;h[a+52>>2]=e-2,e=d[1+(e=(e+t|0)-2|0)|0]<<8&16128|d[0|e];break n;case 1:if(e>>>0<3)break i;h[a+52>>2]=e-3,e=d[2+(e=(e+t|0)-3|0)|0]<<16&4128768|d[e+1|0]<<8|d[0|e];break n}h[a+52>>2]=e-4,e=d[2+(e=(e+t|0)-4|0)|0]<<16|d[e+3|0]<<24&1056964608|d[e+1|0]<<8|d[0|e]}e=e+131072|0,h[a+56>>2]=e,i=e>>>0<33554432}}if(N=u+16|0,i)if(y)for(t=h[a+36>>2],r=h[a+48>>2],i=h[a+24>>2],e=h[a+56>>2];;){i:if(!(e>>>0>131071))for(_=h[a+52>>2];;){if((0|_)<=0)break i;if(_=_-1|0,h[a+52>>2]=_,e=d[r+_|0]|e<<8,h[a+56>>2]=e,!(e>>>0<131072))break}if(l=h[i+((n=32767&e)<<2)>>2],e=(v(h[(_=t+(l<<3)|0)>>2],e>>>15|0)+n|0)-h[_+4>>2]|0,h[a+56>>2]=e,h[b+(x<<2)>>2]=l,_=1,(0|y)==(0|(x=x+1|0)))break}else _=1}(e=h[a+36>>2])&&(h[a+40>>2]=e,ve(e)),(e=h[a+24>>2])&&(h[a+28>>2]=e,ve(e)),(e=h[a+8>>2])&&(h[a+12>>2]=e,ve(e)),N=a- -64|0,t=_;break t;case 10:y=e,b=i,N=a=N+-64|0,h[a+56>>2]=0,h[a+48>>2]=0,h[a+52>>2]=0,h[a+40>>2]=0,h[a+44>>2]=0,h[a+32>>2]=0,h[a+36>>2]=0,h[a+24>>2]=0,h[a+28>>2]=0,h[a+16>>2]=0,h[a+20>>2]=0,h[a+8>>2]=0,h[a+12>>2]=0,g=a+8|0;i:{n:if(e=f[r+38>>1]){if(e>>>0<=511){if(e=h[r+12>>2],n=h[r+20>>2],(0|e)<=(0|(n=(i=(t=h[r+16>>2])+4|0)>>>0<4?n+1|0:n))&i>>>0>p[r+8>>2]|(0|e)<(0|n))break n;e=t+h[r>>2]|0,u=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,h[g+12>>2]=u,n=h[r+20>>2],n=(e=h[r+16>>2]+4|0)>>>0<4?n+1|0:n,h[r+16>>2]=e,h[r+20>>2]=n}else{if(!yr(1,g+12|0,r))break n;u=h[g+12>>2]}if(t=h[g>>2],(e=h[g+4>>2]-t>>2)>>>0<u>>>0?(er(g,u-e|0),u=h[g+12>>2]):e>>>0<=u>>>0||(h[g+4>>2]=t+(u<<2)),i=1,!u)break i;for(w=h[r+8>>2],E=h[r+12>>2],A=h[g>>2],t=0;;){if(i=0,(0|E)<=(0|(n=h[r+20>>2]))&w>>>0<=(e=h[r+16>>2])>>>0|(0|n)>(0|E))break i;i=h[r>>2],o=d[i+e|0],n=(e=e+1|0)?n:n+1|0,l=e,h[r+16>>2]=e,h[r+20>>2]=n,e=o>>>2|0,c=0;s:{o:{a:{l:switch(0|(T=3&o)){case 0:break o;case 3:break l;default:break a}if(i=0,(e=e+t|0)>>>0>=u>>>0)break i;St(A+(t<<2)|0,0,4+(252&o)|0),t=e;break s}for(;;){if((0|n)>=(0|E)&l>>>0>=w>>>0|(0|n)>(0|E))break n;if(u=d[i+l|0],o=n,o=(n=l+1|0)?o:o+1|0,l=n,h[r+16>>2]=n,n=o,h[r+20>>2]=n,e|=u<<(c<<3|6),(0|T)==(0|(c=c+1|0)))break}}h[A+(t<<2)>>2]=e}if(!((t=t+1|0)>>>0<(u=h[g+12>>2])>>>0))break}if(l=g+16|0,E=h[g>>2],t=h[g+16>>2],(e=h[g+20>>2]-t|0)>>>0<=262143?er(l,65536-(e>>>2|0)|0):262144!=(0|e)&&(h[g+20>>2]=t+262144),t=h[(e=g+28|0)>>2],(i=h[g+32>>2]-t>>3)>>>0<u>>>0)tr(e,u-i|0),t=h[e>>2];else if(i>>>0>u>>>0&&(h[g+32>>2]=(u<<3)+t),!u)break n;for(c=0,i=0;;){if(o=h[(n=E+(c<<2)|0)>>2],e=i,h[4+(g=(c<<3)+t|0)>>2]=e,h[g>>2]=o,(i=(n=h[n>>2])+e|0)>>>0>65536)break n;if(!(e>>>0>=i>>>0)){if(o=h[l>>2],g=0,w=7&n)for(;h[o+(e<<2)>>2]=c,e=e+1|0,(0|w)!=(0|(g=g+1|0)););if(!(n-1>>>0<=6))for(;h[(n=o+(e<<2)|0)>>2]=c,h[n+28>>2]=c,h[n+24>>2]=c,h[n+20>>2]=c,h[n+16>>2]=c,h[n+12>>2]=c,h[n+8>>2]=c,h[n+4>>2]=c,(0|i)!=(0|(e=e+8|0)););}if((0|u)==(0|(c=c+1|0)))break}m=65536==(0|i)}i=m}if(!(!i|(h[a+20>>2]?0:y))){i=0,N=o=N-16|0;i:{if(f[r+38>>1]<=511){if(e=c=h[r+12>>2],n=h[r+20>>2],n=(l=(m=h[r+16>>2])+8|0)>>>0<8?n+1|0:n,(t=h[r+8>>2])>>>0<l>>>0&(0|e)<=(0|n)|(0|e)<(0|n))break i;m=m+h[r>>2]|0,e=d[0|m]|d[m+1|0]<<8|d[m+2|0]<<16|d[m+3|0]<<24,m=d[m+4|0]|d[m+5|0]<<8|d[m+6|0]<<16|d[m+7|0]<<24,h[r+16>>2]=l,h[r+20>>2]=n}else{if(!hr(1,o+8|0,r))break i;l=h[r+16>>2],n=h[r+20>>2],t=h[r+8>>2],c=h[r+12>>2],e=h[o+8>>2],m=h[o+12>>2]}if(u=t-l|0,!((0|(t=c-((t>>>0<l>>>0)+n|0)|0))==(0|m)&e>>>0>u>>>0|t>>>0<m>>>0||(n=n+m|0,n=(t=e+l|0)>>>0<e>>>0?n+1|0:n,h[r+16>>2]=t,h[r+20>>2]=n,(0|e)<=0))){t=l+h[r>>2]|0,h[a+48>>2]=t;n:if((l=d[0|(n=(r=e-1|0)+t|0)])>>>0<=63)h[a+52>>2]=r,e=63&d[0|n];else{switch((l>>>6|0)-1|0){case 0:if(e>>>0<2)break i;h[a+52>>2]=e-2,e=d[1+(e=(e+t|0)-2|0)|0]<<8&16128|d[0|e];break n;case 1:if(e>>>0<3)break i;h[a+52>>2]=e-3,e=d[2+(e=(e+t|0)-3|0)|0]<<16&4128768|d[e+1|0]<<8|d[0|e];break n}h[a+52>>2]=e-4,e=d[2+(e=(e+t|0)-4|0)|0]<<16|d[e+3|0]<<24&1056964608|d[e+1|0]<<8|d[0|e]}e=e+262144|0,h[a+56>>2]=e,i=e>>>0<67108864}}if(N=o+16|0,i)if(y)for(t=h[a+36>>2],r=h[a+48>>2],i=h[a+24>>2],e=h[a+56>>2];;){i:if(!(e>>>0>262143))for(_=h[a+52>>2];;){if((0|_)<=0)break i;if(_=_-1|0,h[a+52>>2]=_,e=d[r+_|0]|e<<8,h[a+56>>2]=e,!(e>>>0<262144))break}if(l=h[i+((n=65535&e)<<2)>>2],e=(v(h[(_=t+(l<<3)|0)>>2],e>>>16|0)+n|0)-h[_+4>>2]|0,h[a+56>>2]=e,h[b+(x<<2)>>2]=l,_=1,(0|y)==(0|(x=x+1|0)))break}else _=1}(e=h[a+36>>2])&&(h[a+40>>2]=e,ve(e)),(e=h[a+24>>2])&&(h[a+28>>2]=e,ve(e)),(e=h[a+8>>2])&&(h[a+12>>2]=e,ve(e)),N=a- -64|0,t=_;break t;case 11:a=e,y=i,N=o=N+-64|0,h[o+56>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0,b=o+8|0;i:{n:if(e=f[r+38>>1]){if(e>>>0<=511){if(e=h[r+12>>2],n=h[r+20>>2],(0|e)<=(0|(n=(i=(t=h[r+16>>2])+4|0)>>>0<4?n+1|0:n))&i>>>0>p[r+8>>2]|(0|e)<(0|n))break n;e=t+h[r>>2]|0,u=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,h[b+12>>2]=u,n=h[r+20>>2],n=(e=h[r+16>>2]+4|0)>>>0<4?n+1|0:n,h[r+16>>2]=e,h[r+20>>2]=n}else{if(!yr(1,b+12|0,r))break n;u=h[b+12>>2]}if(t=h[b>>2],(e=h[b+4>>2]-t>>2)>>>0<u>>>0?(er(b,u-e|0),u=h[b+12>>2]):e>>>0<=u>>>0||(h[b+4>>2]=t+(u<<2)),i=1,!u)break i;for(w=h[r+8>>2],g=h[r+12>>2],A=h[b>>2],t=0;;){if(i=0,(0|g)<=(0|(n=h[r+20>>2]))&w>>>0<=(e=h[r+16>>2])>>>0|(0|n)>(0|g))break i;i=h[r>>2],E=d[i+e|0],n=(e=e+1|0)?n:n+1|0,l=e,h[r+16>>2]=e,h[r+20>>2]=n,e=E>>>2|0,c=0;s:{o:{a:{l:switch(0|(T=3&E)){case 0:break o;case 3:break l;default:break a}if(i=0,(e=e+t|0)>>>0>=u>>>0)break i;St(A+(t<<2)|0,0,4+(252&E)|0),t=e;break s}for(;;){if((0|n)>=(0|g)&l>>>0>=w>>>0|(0|n)>(0|g))break n;if(u=d[i+l|0],n=(l=l+1|0)?n:n+1|0,h[r+16>>2]=l,h[r+20>>2]=n,e|=u<<(c<<3|6),(0|T)==(0|(c=c+1|0)))break}}h[A+(t<<2)>>2]=e}if(!((t=t+1|0)>>>0<(u=h[b+12>>2])>>>0))break}if(l=b+16|0,E=h[b>>2],t=h[b+16>>2],(e=h[b+20>>2]-t|0)>>>0<=1048575?er(l,262144-(e>>>2|0)|0):1048576!=(0|e)&&(h[b+20>>2]=t- -1048576),t=h[(e=b+28|0)>>2],(i=h[b+32>>2]-t>>3)>>>0<u>>>0)tr(e,u-i|0),t=h[e>>2];else if(i>>>0>u>>>0&&(h[b+32>>2]=(u<<3)+t),!u)break n;for(c=0,i=0;;){if(b=h[(n=E+(c<<2)|0)>>2],e=i,h[4+(g=(c<<3)+t|0)>>2]=e,h[g>>2]=b,(i=(n=h[n>>2])+e|0)>>>0>262144)break n;if(!(e>>>0>=i>>>0)){if(b=h[l>>2],g=0,w=7&n)for(;h[b+(e<<2)>>2]=c,e=e+1|0,(0|w)!=(0|(g=g+1|0)););if(!(n-1>>>0<=6))for(;h[(n=b+(e<<2)|0)>>2]=c,h[n+28>>2]=c,h[n+24>>2]=c,h[n+20>>2]=c,h[n+16>>2]=c,h[n+12>>2]=c,h[n+8>>2]=c,h[n+4>>2]=c,(0|i)!=(0|(e=e+8|0)););}if((0|u)==(0|(c=c+1|0)))break}m=262144==(0|i)}i=m}if(!(!i|(h[o+20>>2]?0:a))){i=0,N=b=N-16|0;i:{if(f[r+38>>1]<=511){if(e=c=h[r+12>>2],n=h[r+20>>2],n=(l=(m=h[r+16>>2])+8|0)>>>0<8?n+1|0:n,(t=h[r+8>>2])>>>0<l>>>0&(0|e)<=(0|n)|(0|e)<(0|n))break i;m=m+h[r>>2]|0,e=d[0|m]|d[m+1|0]<<8|d[m+2|0]<<16|d[m+3|0]<<24,m=d[m+4|0]|d[m+5|0]<<8|d[m+6|0]<<16|d[m+7|0]<<24,h[r+16>>2]=l,h[r+20>>2]=n}else{if(!hr(1,b+8|0,r))break i;l=h[r+16>>2],n=h[r+20>>2],t=h[r+8>>2],c=h[r+12>>2],e=h[b+8>>2],m=h[b+12>>2]}if(u=t-l|0,!((0|(t=c-((t>>>0<l>>>0)+n|0)|0))==(0|m)&e>>>0>u>>>0|t>>>0<m>>>0||(n=n+m|0,n=(t=e+l|0)>>>0<e>>>0?n+1|0:n,h[r+16>>2]=t,h[r+20>>2]=n,(0|e)<=0))){t=l+h[r>>2]|0,h[o+48>>2]=t;n:if((l=d[0|(n=(r=e-1|0)+t|0)])>>>0<=63)h[o+52>>2]=r,e=63&d[0|n];else{switch((l>>>6|0)-1|0){case 0:if(e>>>0<2)break i;h[o+52>>2]=e-2,e=d[1+(e=(e+t|0)-2|0)|0]<<8&16128|d[0|e];break n;case 1:if(e>>>0<3)break i;h[o+52>>2]=e-3,e=d[2+(e=(e+t|0)-3|0)|0]<<16&4128768|d[e+1|0]<<8|d[0|e];break n}h[o+52>>2]=e-4,e=d[2+(e=(e+t|0)-4|0)|0]<<16|d[e+3|0]<<24&1056964608|d[e+1|0]<<8|d[0|e]}e=e- -1048576|0,h[o+56>>2]=e,i=e>>>0<268435456}}if(N=b+16|0,i)if(a)for(t=h[o+36>>2],r=h[o+48>>2],i=h[o+24>>2],e=h[o+56>>2];;){i:if(!(e>>>0>1048575))for(_=h[o+52>>2];;){if((0|_)<=0)break i;if(_=_-1|0,h[o+52>>2]=_,e=d[r+_|0]|e<<8,h[o+56>>2]=e,!(e>>>0<1048576))break}if(l=h[i+((n=262143&e)<<2)>>2],e=(v(h[(_=t+(l<<3)|0)>>2],e>>>18|0)+n|0)-h[_+4>>2]|0,h[o+56>>2]=e,h[y+(x<<2)>>2]=l,_=1,(0|a)==(0|(x=x+1|0)))break}else _=1}(e=h[o+36>>2])&&(h[o+40>>2]=e,ve(e)),(e=h[o+24>>2])&&(h[o+28>>2]=e,ve(e)),(e=h[o+8>>2])&&(h[o+12>>2]=e,ve(e)),N=o- -64|0,t=_;break t;case 12:y=e,b=i,N=a=N+-64|0,h[a+56>>2]=0,h[a+48>>2]=0,h[a+52>>2]=0,h[a+40>>2]=0,h[a+44>>2]=0,h[a+32>>2]=0,h[a+36>>2]=0,h[a+24>>2]=0,h[a+28>>2]=0,h[a+16>>2]=0,h[a+20>>2]=0,h[a+8>>2]=0,h[a+12>>2]=0,o=a+8|0;i:{n:if(e=f[r+38>>1]){if(e>>>0<=511){if(e=h[r+12>>2],n=h[r+20>>2],(0|e)<=(0|(n=(i=(t=h[r+16>>2])+4|0)>>>0<4?n+1|0:n))&i>>>0>p[r+8>>2]|(0|e)<(0|n))break n;e=t+h[r>>2]|0,u=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,h[o+12>>2]=u,n=h[r+20>>2],n=(e=h[r+16>>2]+4|0)>>>0<4?n+1|0:n,h[r+16>>2]=e,h[r+20>>2]=n}else{if(!yr(1,o+12|0,r))break n;u=h[o+12>>2]}if(t=h[o>>2],(e=h[o+4>>2]-t>>2)>>>0<u>>>0?(er(o,u-e|0),u=h[o+12>>2]):e>>>0<=u>>>0||(h[o+4>>2]=t+(u<<2)),i=1,!u)break i;for(w=h[r+8>>2],g=h[r+12>>2],A=h[o>>2],t=0;;){if(i=0,(0|g)<=(0|(n=h[r+20>>2]))&w>>>0<=(e=h[r+16>>2])>>>0|(0|n)>(0|g))break i;i=h[r>>2],E=d[i+e|0],n=(e=e+1|0)?n:n+1|0,l=e,h[r+16>>2]=e,h[r+20>>2]=n,e=E>>>2|0,c=0;s:{o:{a:{l:switch(0|(T=3&E)){case 0:break o;case 3:break l;default:break a}if(i=0,(e=e+t|0)>>>0>=u>>>0)break i;St(A+(t<<2)|0,0,4+(252&E)|0),t=e;break s}for(;;){if((0|n)>=(0|g)&l>>>0>=w>>>0|(0|n)>(0|g))break n;if(u=d[i+l|0],n=(l=l+1|0)?n:n+1|0,h[r+16>>2]=l,h[r+20>>2]=n,e|=u<<(c<<3|6),(0|T)==(0|(c=c+1|0)))break}}h[A+(t<<2)>>2]=e}if(!((t=t+1|0)>>>0<(u=h[o+12>>2])>>>0))break}if(l=o+16|0,E=h[o>>2],t=h[o+16>>2],(e=h[o+20>>2]-t|0)>>>0<=2097151?er(l,524288-(e>>>2|0)|0):2097152!=(0|e)&&(h[o+20>>2]=t+2097152),t=h[(e=o+28|0)>>2],(i=h[o+32>>2]-t>>3)>>>0<u>>>0)tr(e,u-i|0),t=h[e>>2];else if(i>>>0>u>>>0&&(h[o+32>>2]=(u<<3)+t),!u)break n;for(c=0,i=0;;){if(o=h[(n=E+(c<<2)|0)>>2],e=i,h[4+(g=(c<<3)+t|0)>>2]=e,h[g>>2]=o,(i=(n=h[n>>2])+e|0)>>>0>524288)break n;if(!(e>>>0>=i>>>0)){if(o=h[l>>2],g=0,w=7&n)for(;h[o+(e<<2)>>2]=c,e=e+1|0,(0|w)!=(0|(g=g+1|0)););if(!(n-1>>>0<=6))for(;h[(n=o+(e<<2)|0)>>2]=c,h[n+28>>2]=c,h[n+24>>2]=c,h[n+20>>2]=c,h[n+16>>2]=c,h[n+12>>2]=c,h[n+8>>2]=c,h[n+4>>2]=c,(0|i)!=(0|(e=e+8|0)););}if((0|u)==(0|(c=c+1|0)))break}m=524288==(0|i)}i=m}if(!(!i|(h[a+20>>2]?0:y))){i=0,N=u=N-16|0;i:{if(f[r+38>>1]<=511){if(e=c=h[r+12>>2],n=h[r+20>>2],n=(l=(m=h[r+16>>2])+8|0)>>>0<8?n+1|0:n,(t=h[r+8>>2])>>>0<l>>>0&(0|e)<=(0|n)|(0|e)<(0|n))break i;m=m+h[r>>2]|0,e=d[0|m]|d[m+1|0]<<8|d[m+2|0]<<16|d[m+3|0]<<24,m=d[m+4|0]|d[m+5|0]<<8|d[m+6|0]<<16|d[m+7|0]<<24,h[r+16>>2]=l,h[r+20>>2]=n}else{if(!hr(1,u+8|0,r))break i;l=h[r+16>>2],n=h[r+20>>2],t=h[r+8>>2],c=h[r+12>>2],e=h[u+8>>2],m=h[u+12>>2]}if(o=t-l|0,!((0|(t=c-((t>>>0<l>>>0)+n|0)|0))==(0|m)&e>>>0>o>>>0|t>>>0<m>>>0||(o=n+m|0,o=(t=e+l|0)>>>0<e>>>0?o+1|0:o,h[r+16>>2]=t,h[r+20>>2]=o,(0|e)<=0))){t=l+h[r>>2]|0,h[a+48>>2]=t;n:if((l=d[0|(n=(r=e-1|0)+t|0)])>>>0<=63)h[a+52>>2]=r,e=63&d[0|n];else{switch((l>>>6|0)-1|0){case 0:if(e>>>0<2)break i;h[a+52>>2]=e-2,e=d[1+(e=(e+t|0)-2|0)|0]<<8&16128|d[0|e];break n;case 1:if(e>>>0<3)break i;h[a+52>>2]=e-3,e=d[2+(e=(e+t|0)-3|0)|0]<<16&4128768|d[e+1|0]<<8|d[0|e];break n}h[a+52>>2]=e-4,e=d[2+(e=(e+t|0)-4|0)|0]<<16|d[e+3|0]<<24&1056964608|d[e+1|0]<<8|d[0|e]}e=e+2097152|0,h[a+56>>2]=e,i=e>>>0<536870912}}if(N=u+16|0,i)if(y)for(t=h[a+36>>2],r=h[a+48>>2],i=h[a+24>>2],e=h[a+56>>2];;){i:if(!(e>>>0>2097151))for(_=h[a+52>>2];;){if((0|_)<=0)break i;if(_=_-1|0,h[a+52>>2]=_,e=d[r+_|0]|e<<8,h[a+56>>2]=e,!(e>>>0<2097152))break}if(l=h[i+((n=524287&e)<<2)>>2],e=(v(h[(_=t+(l<<3)|0)>>2],e>>>19|0)+n|0)-h[_+4>>2]|0,h[a+56>>2]=e,h[b+(x<<2)>>2]=l,_=1,(0|y)==(0|(x=x+1|0)))break}else _=1}(e=h[a+36>>2])&&(h[a+40>>2]=e,ve(e)),(e=h[a+24>>2])&&(h[a+28>>2]=e,ve(e)),(e=h[a+8>>2])&&(h[a+12>>2]=e,ve(e)),N=a- -64|0,t=_;break t;case 17:t=ae(e,r,i);break t;case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:if(N=n=N+-64|0,h[n+56>>2]=0,h[n+48>>2]=0,h[n+52>>2]=0,h[n+40>>2]=0,h[n+44>>2]=0,h[n+32>>2]=0,h[n+36>>2]=0,h[n+24>>2]=0,h[n+28>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,!(!Ce(n+8|0,r)|(h[n+20>>2]?0:e))&&We(n+8|0,r))if(e)for(_=h[n+36>>2],m=h[n+48>>2],o=h[n+24>>2],r=h[n+56>>2];;){i:if(!(r>>>0>16383))for(t=h[n+52>>2];;){if((0|t)<=0)break i;if(t=t-1|0,h[n+52>>2]=t,r=d[t+m|0]|r<<8,h[n+56>>2]=r,!(r>>>0<16384))break}if(a=h[o+((t=4095&r)<<2)>>2],r=(v(h[(y=_+(a<<3)|0)>>2],r>>>12|0)+t|0)-h[y+4>>2]|0,h[n+56>>2]=r,h[(l<<2)+i>>2]=a,t=1,(0|(l=l+1|0))==(0|e))break}else t=1;(e=h[n+36>>2])&&(h[n+40>>2]=e,ve(e)),(e=h[n+24>>2])&&(h[n+28>>2]=e,ve(e)),(e=h[n+8>>2])&&(h[n+12>>2]=e,ve(e)),N=n- -64|0;break t;case 13:case 14:case 15:case 16:break r;default:break t}t=ae(e,r,i)}l=t}return l}function V(e){var t,r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0;N=t=N-16|0;e:{t:{r:{i:{n:{s:{o:{a:{l:{c:{u:{if((e|=0)>>>0<=244){if(3&(r=(s=h[4233])>>>(i=(l=e>>>0<11?16:e+11&-8)>>>3|0)|0)){e=(o=h[16980+(r=(n=i+(1&(-1^r))|0)<<3)>>2])+8|0,(0|(i=h[o+8>>2]))!=(0|(r=r+16972|0))?(h[i+12>>2]=r,h[r+8>>2]=i):(m=16932,g=ki(n)&s,h[m>>2]=g),r=n<<3,h[o+4>>2]=3|r,h[4+(r=r+o|0)>>2]=1|h[r+4>>2];break e}if((f=h[4235])>>>0>=l>>>0)break u;if(r){i=e=(r=(0-(e=(0-(e=2<<i)|e)&r<<i)&e)-1|0)>>>12&16,i|=e=(r=r>>>e|0)>>>5&8,i|=e=(r=r>>>e|0)>>>2&4,a=h[16980+(e=(i=((i|=e=(r=r>>>e|0)>>>1&2)|(e=(r=r>>>e|0)>>>1&1))+(r>>>e|0)|0)<<3)>>2],(0|(r=h[a+8>>2]))!=(0|(e=e+16972|0))?(h[r+12>>2]=e,h[e+8>>2]=r):(s=ki(i)&s,h[4233]=s),e=a+8|0,h[a+4>>2]=3|l,o=(r=i<<3)-l|0,h[4+(n=a+l|0)>>2]=1|o,h[r+a>>2]=o,f&&(i=16972+((r=f>>>3|0)<<3)|0,a=h[4238],(r=1<<r)&s?r=h[i+8>>2]:(h[4233]=r|s,r=i),h[i+8>>2]=a,h[r+12>>2]=a,h[a+12>>2]=i,h[a+8>>2]=r),h[4238]=n,h[4235]=o;break e}if(!(u=h[4234]))break u;for(i=e=(r=(u&0-u)-1|0)>>>12&16,i|=e=(r=r>>>e|0)>>>5&8,i|=e=(r=r>>>e|0)>>>2&4,r=h[17236+(((i|=e=(r=r>>>e|0)>>>1&2)|(e=(r=r>>>e|0)>>>1&1))+(r>>>e|0)<<2)>>2],n=(-8&h[r+4>>2])-l|0,i=r;(e=h[i+16>>2])||(e=h[i+20>>2]);)n=(o=(i=(-8&h[e+4>>2])-l|0)>>>0<n>>>0)?i:n,r=o?e:r,i=e;if(c=h[r+24>>2],(0|(o=h[r+12>>2]))!=(0|r)){e=h[r+8>>2],h[e+12>>2]=o,h[o+8>>2]=e;break t}if(!(e=h[(i=r+20|0)>>2])){if(!(e=h[r+16>>2]))break c;i=r+16|0}for(;a=i,o=e,(e=h[(i=e+20|0)>>2])||(i=o+16|0,e=h[o+16>>2]););h[a>>2]=0;break t}if(l=-1,!(e>>>0>4294967231)&&(l=-8&(e=e+11|0),u=h[4234])){n=0-l|0,s=0,l>>>0<256||(s=31,l>>>0>16777215||(e=e>>>8|0,e<<=a=e+1048320>>>16&8,s=28+((e=((e<<=i=e+520192>>>16&4)<<(r=e+245760>>>16&2)>>>15|0)-(r|i|a)|0)<<1|l>>>e+21&1)|0));h:{d:{if(i=h[17236+(s<<2)>>2])for(e=0,r=l<<(31==(0|s)?0:25-(s>>>1|0)|0);;){if(!((a=(-8&h[i+4>>2])-l|0)>>>0>=n>>>0||(o=i,n=a))){n=0,e=i;break d}if(a=h[i+20>>2],i=h[16+((r>>>29&4)+i|0)>>2],e=a?(0|a)==(0|i)?e:a:e,r<<=1,!i)break}else e=0;if(!(e|o)){if(o=0,!(e=(0-(e=2<<s)|e)&u))break u;i=e=(r=(e&0-e)-1|0)>>>12&16,i|=e=(r=r>>>e|0)>>>5&8,i|=e=(r=r>>>e|0)>>>2&4,e=h[17236+(((i|=e=(r=r>>>e|0)>>>1&2)|(e=(r=r>>>e|0)>>>1&1))+(r>>>e|0)<<2)>>2]}if(!e)break h}for(;n=(i=(r=(-8&h[e+4>>2])-l|0)>>>0<n>>>0)?r:n,o=i?e:o,e=(r=h[e+16>>2])||h[e+20>>2];);}if(!(!o|h[4235]-l>>>0<=n>>>0)){if(s=h[o+24>>2],(0|o)!=(0|(r=h[o+12>>2]))){e=h[o+8>>2],h[e+12>>2]=r,h[r+8>>2]=e;break r}if(!(e=h[(i=o+20|0)>>2])){if(!(e=h[o+16>>2]))break l;i=o+16|0}for(;a=i,r=e,(e=h[(i=e+20|0)>>2])||(i=r+16|0,e=h[r+16>>2]););h[a>>2]=0;break r}}}if((i=h[4235])>>>0>=l>>>0){n=h[4238],(r=i-l|0)>>>0>=16?(h[4235]=r,e=n+l|0,h[4238]=e,h[e+4>>2]=1|r,h[i+n>>2]=r,h[n+4>>2]=3|l):(h[4238]=0,h[4235]=0,h[n+4>>2]=3|i,h[4+(e=i+n|0)>>2]=1|h[e+4>>2]),e=n+8|0;break e}if((c=h[4236])>>>0>l>>>0){r=c-l|0,h[4236]=r,e=(i=h[4239])+l|0,h[4239]=e,h[e+4>>2]=1|r,h[i+4>>2]=3|l,e=i+8|0;break e}if(e=0,u=l+47|0,h[4351]?i=h[4353]:(h[4354]=-1,h[4355]=-1,h[4352]=4096,h[4353]=4096,h[4351]=t+12&-16^1431655768,h[4356]=0,h[4344]=0,i=4096),(i=(a=u+i|0)&(o=0-i|0))>>>0<=l>>>0)break e;if((n=h[4343])&&n>>>0<(s=(r=h[4341])+i|0)>>>0|r>>>0>=s>>>0)break e;if(4&d[17376])break s;u:{h:{if(n=h[4239])for(e=17380;;){if((r=h[e>>2])>>>0<=n>>>0&n>>>0<r+h[e+4>>2]>>>0)break h;if(!(e=h[e+8>>2]))break}if(-1==(0|(r=ii(0))))break o;if(s=i,(e=(n=h[4352])-1|0)&r&&(s=(i-r|0)+(e+r&0-n)|0),s>>>0<=l>>>0|s>>>0>2147483646)break o;if((n=h[4343])&&n>>>0<(o=(e=h[4341])+s|0)>>>0|e>>>0>=o>>>0)break o;if((0|r)!=(0|(e=ii(s))))break u;break n}if((s=o&a-c)>>>0>2147483646)break o;if((0|(r=ii(s)))==(h[e>>2]+h[e+4>>2]|0))break a;e=r}if(!(-1==(0|e)|l+48>>>0<=s>>>0)){if((r=(r=h[4353])+(u-s|0)&0-r)>>>0>2147483646){r=e;break n}if(-1!=(0|ii(r))){s=r+s|0,r=e;break n}ii(0-s|0);break o}if(r=e,-1!=(0|e))break n;break o}o=0;break t}r=0;break r}if(-1!=(0|r))break n}h[4344]=4|h[4344]}if(i>>>0>2147483646)break i;if(-1==(0|(r=ii(i)))|-1==(0|(e=ii(0)))|e>>>0<=r>>>0)break i;if((s=e-r|0)>>>0<=l+40>>>0)break i}e=h[4341]+s|0,h[4341]=e,e>>>0>p[4342]&&(h[4342]=e);n:{s:{o:{if(a=h[4239]){for(e=17380;;){if(((n=h[e>>2])+(i=h[e+4>>2])|0)==(0|r))break o;if(!(e=h[e+8>>2]))break}break s}for((e=h[4237])>>>0<=r>>>0&&e||(h[4237]=r),e=0,h[4346]=s,h[4345]=r,h[4241]=-1,h[4242]=h[4351],h[4348]=0;i=16972+(n=e<<3)|0,h[n+16980>>2]=i,h[n+16984>>2]=i,32!=(0|(e=e+1|0)););i=(n=s-40|0)-(e=r+8&7?-8-r&7:0)|0,h[4236]=i,e=e+r|0,h[4239]=e,h[e+4>>2]=1|i,h[4+(r+n|0)>>2]=40,h[4240]=h[4355];break n}if(!(8&d[e+12|0]|n>>>0>a>>>0|r>>>0<=a>>>0)){h[e+4>>2]=i+s,i=(e=a+8&7?-8-a&7:0)+a|0,h[4239]=i,e=(r=h[4236]+s|0)-e|0,h[4236]=e,h[i+4>>2]=1|e,h[4+(r+a|0)>>2]=40,h[4240]=h[4355];break n}}p[4237]>r>>>0&&(h[4237]=r),i=r+s|0,e=17380;s:{o:{a:{l:{c:{u:{for(;;){if((0|i)!=h[e>>2]){if(e=h[e+8>>2])continue;break u}break}if(!(8&d[e+12|0]))break c}for(e=17380;;){if((i=h[e>>2])>>>0<=a>>>0&&(o=i+h[e+4>>2]|0)>>>0>a>>>0)break l;e=h[e+8>>2]}}if(h[e>>2]=r,h[e+4>>2]=h[e+4>>2]+s,h[4+(u=(r+8&7?-8-r&7:0)+r|0)>>2]=3|l,i=(s=i+(i+8&7?-8-i&7:0)|0)-(c=l+u|0)|0,(0|s)==(0|a)){h[4239]=c,e=h[4236]+i|0,h[4236]=e,h[c+4>>2]=1|e;break o}if(h[4238]==(0|s)){h[4238]=c,e=h[4235]+i|0,h[4235]=e,h[c+4>>2]=1|e,h[e+c>>2]=e;break o}if(1==(3&(e=h[s+4>>2]))){a=-8&e;c:if(e>>>0<=255){if(n=h[s+8>>2],e=e>>>3|0,(0|(r=h[s+12>>2]))==(0|n)){m=16932,g=h[4233]&ki(e),h[m>>2]=g;break c}h[n+12>>2]=r,h[r+8>>2]=n}else{if(l=h[s+24>>2],(0|s)==(0|(r=h[s+12>>2])))if((n=h[(e=s+20|0)>>2])||(n=h[(e=s+16|0)>>2])){for(;o=e,(n=h[(e=(r=n)+20|0)>>2])||(e=r+16|0,n=h[r+16>>2]););h[o>>2]=0}else r=0;else e=h[s+8>>2],h[e+12>>2]=r,h[r+8>>2]=e;if(l){n=h[s+28>>2];u:{if(h[(e=17236+(n<<2)|0)>>2]==(0|s)){if(h[e>>2]=r,r)break u;m=16936,g=h[4234]&ki(n),h[m>>2]=g;break c}if(h[l+(h[l+16>>2]==(0|s)?16:20)>>2]=r,!r)break c}h[r+24>>2]=l,(e=h[s+16>>2])&&(h[r+16>>2]=e,h[e+24>>2]=r),(e=h[s+20>>2])&&(h[r+20>>2]=e,h[e+24>>2]=r)}}s=s+a|0,i=i+a|0}if(h[s+4>>2]=-2&h[s+4>>2],h[c+4>>2]=1|i,h[i+c>>2]=i,i>>>0<=255){r=16972+((e=i>>>3|0)<<3)|0,(i=h[4233])&(e=1<<e)?e=h[r+8>>2]:(h[4233]=e|i,e=r),h[r+8>>2]=c,h[e+12>>2]=c,h[c+12>>2]=r,h[c+8>>2]=e;break o}if(e=31,i>>>0<=16777215&&(e=i>>>8|0,e<<=o=e+1048320>>>16&8,e=28+((e=((e<<=n=e+520192>>>16&4)<<(r=e+245760>>>16&2)>>>15|0)-(r|n|o)|0)<<1|i>>>e+21&1)|0),h[c+28>>2]=e,h[c+16>>2]=0,h[c+20>>2]=0,o=17236+(e<<2)|0,(n=h[4234])&(r=1<<e)){for(e=i<<(31==(0|e)?0:25-(e>>>1|0)|0),r=h[o>>2];;){if(n=r,(-8&h[r+4>>2])==(0|i))break a;if(r=e>>>29|0,e<<=1,!(r=h[16+(o=n+(4&r)|0)>>2]))break}h[o+16>>2]=c,h[c+24>>2]=n}else h[4234]=r|n,h[o>>2]=c,h[c+24>>2]=o;h[c+12>>2]=c,h[c+8>>2]=c;break o}for(i=(n=s-40|0)-(e=r+8&7?-8-r&7:0)|0,h[4236]=i,e=e+r|0,h[4239]=e,h[e+4>>2]=1|i,h[4+(r+n|0)>>2]=40,h[4240]=h[4355],h[(i=(e=(o+(o-39&7?39-o&7:0)|0)-47|0)>>>0<a+16>>>0?a:e)+4>>2]=27,e=h[4348],h[i+16>>2]=h[4347],h[i+20>>2]=e,e=h[4346],h[i+8>>2]=h[4345],h[i+12>>2]=e,h[4347]=i+8,h[4346]=s,h[4345]=r,h[4348]=0,e=i+24|0;h[e+4>>2]=7,r=e+8|0,e=e+4|0,r>>>0<o>>>0;);if((0|i)==(0|a))break n;if(h[i+4>>2]=-2&h[i+4>>2],o=i-a|0,h[a+4>>2]=1|o,h[i>>2]=o,o>>>0<=255){r=16972+((e=o>>>3|0)<<3)|0,(i=h[4233])&(e=1<<e)?e=h[r+8>>2]:(h[4233]=e|i,e=r),h[r+8>>2]=a,h[e+12>>2]=a,h[a+12>>2]=r,h[a+8>>2]=e;break n}if(e=31,h[a+16>>2]=0,h[a+20>>2]=0,o>>>0<=16777215&&(e=o>>>8|0,e<<=n=e+1048320>>>16&8,e=28+((e=((e<<=i=e+520192>>>16&4)<<(r=e+245760>>>16&2)>>>15|0)-(r|i|n)|0)<<1|o>>>e+21&1)|0),h[a+28>>2]=e,n=17236+(e<<2)|0,(i=h[4234])&(r=1<<e)){for(e=o<<(31==(0|e)?0:25-(e>>>1|0)|0),r=h[n>>2];;){if(i=r,(0|o)==(-8&h[r+4>>2]))break s;if(r=e>>>29|0,e<<=1,!(r=h[16+(n=i+(4&r)|0)>>2]))break}h[n+16>>2]=a,h[a+24>>2]=i}else h[4234]=r|i,h[n>>2]=a,h[a+24>>2]=n;h[a+12>>2]=a,h[a+8>>2]=a;break n}e=h[n+8>>2],h[e+12>>2]=c,h[n+8>>2]=c,h[c+24>>2]=0,h[c+12>>2]=n,h[c+8>>2]=e}e=u+8|0;break e}e=h[i+8>>2],h[e+12>>2]=a,h[i+8>>2]=a,h[a+24>>2]=0,h[a+12>>2]=i,h[a+8>>2]=e}if(!((e=h[4236])>>>0<=l>>>0)){r=e-l|0,h[4236]=r,e=(i=h[4239])+l|0,h[4239]=e,h[e+4>>2]=1|r,h[i+4>>2]=3|l,e=i+8|0;break e}}h[4190]=48,e=0;break e}r:if(s){i=h[o+28>>2];i:{if(h[(e=17236+(i<<2)|0)>>2]==(0|o)){if(h[e>>2]=r,r)break i;u=ki(i)&u,h[4234]=u;break r}if(h[s+(h[s+16>>2]==(0|o)?16:20)>>2]=r,!r)break r}h[r+24>>2]=s,(e=h[o+16>>2])&&(h[r+16>>2]=e,h[e+24>>2]=r),(e=h[o+20>>2])&&(h[r+20>>2]=e,h[e+24>>2]=r)}r:if(n>>>0<=15)e=n+l|0,h[o+4>>2]=3|e,h[4+(e=e+o|0)>>2]=1|h[e+4>>2];else if(h[o+4>>2]=3|l,h[4+(s=o+l|0)>>2]=1|n,h[n+s>>2]=n,n>>>0<=255)r=16972+((e=n>>>3|0)<<3)|0,(i=h[4233])&(e=1<<e)?e=h[r+8>>2]:(h[4233]=e|i,e=r),h[r+8>>2]=s,h[e+12>>2]=s,h[s+12>>2]=r,h[s+8>>2]=e;else{e=31,n>>>0<=16777215&&(e=n>>>8|0,e<<=a=e+1048320>>>16&8,e=28+((e=((e<<=i=e+520192>>>16&4)<<(r=e+245760>>>16&2)>>>15|0)-(r|i|a)|0)<<1|n>>>e+21&1)|0),h[s+28>>2]=e,h[s+16>>2]=0,h[s+20>>2]=0,r=17236+(e<<2)|0;i:{if((i=1<<e)&u){for(e=n<<(31==(0|e)?0:25-(e>>>1|0)|0),l=h[r>>2];;){if((-8&h[(r=l)+4>>2])==(0|n))break i;if(i=e>>>29|0,e<<=1,!(l=h[16+(i=(4&i)+r|0)>>2]))break}h[i+16>>2]=s}else h[4234]=i|u,h[r>>2]=s;h[s+24>>2]=r,h[s+12>>2]=s,h[s+8>>2]=s;break r}e=h[r+8>>2],h[e+12>>2]=s,h[r+8>>2]=s,h[s+24>>2]=0,h[s+12>>2]=r,h[s+8>>2]=e}e=o+8|0;break e}t:if(c){i=h[r+28>>2];r:{if(h[(e=17236+(i<<2)|0)>>2]==(0|r)){if(h[e>>2]=o,o)break r;m=16936,g=ki(i)&u,h[m>>2]=g;break t}if(h[c+(h[c+16>>2]==(0|r)?16:20)>>2]=o,!o)break t}h[o+24>>2]=c,(e=h[r+16>>2])&&(h[o+16>>2]=e,h[e+24>>2]=o),(e=h[r+20>>2])&&(h[o+20>>2]=e,h[e+24>>2]=o)}n>>>0<=15?(e=n+l|0,h[r+4>>2]=3|e,h[4+(e=e+r|0)>>2]=1|h[e+4>>2]):(h[r+4>>2]=3|l,h[4+(o=r+l|0)>>2]=1|n,h[n+o>>2]=n,f&&(i=16972+((e=f>>>3|0)<<3)|0,a=h[4238],(e=1<<e)&s?e=h[i+8>>2]:(h[4233]=e|s,e=i),h[i+8>>2]=a,h[e+12>>2]=a,h[a+12>>2]=i,h[a+8>>2]=e),h[4238]=o,h[4235]=n),e=r+8|0}return N=t+16|0,0|e}function B(e,t){var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,v=0,_=0,b=0,y=0,E=0;N=r=N-48|0,i=mi(8),h[i+4>>2]=t,h[i>>2]=0,t=i+8|0,h[r+40>>2]=t,h[r+36>>2]=t,h[r+32>>2]=i;e:{t:{r:{i:{for(;;){if(f=h[4+(t=t-8|0)>>2],l=h[t>>2],h[r+36>>2]=t,l){h[r+24>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,i=1,t=h[e>>2],o=h[t+8>>2];n:if(!((0|(c=h[t+12>>2]))<=(0|(n=h[t+20>>2]))&(a=h[t+16>>2])>>>0>=o>>>0|(0|n)>(0|c))){if(o=d[a+h[t>>2]|0],n=(a=a+1|0)?n:n+1|0,h[t+16>>2]=a,h[t+20>>2]=n,rt(r+16|0,o),o){if(n=h[e>>2],g=pi(r+16|0),a=h[n+20>>2],t=o,v=(u=h[n+16>>2])+o|0,c=h[n+12>>2],a=o>>>0>v>>>0?a+1|0:a,v>>>0>p[n+8>>2]&(0|c)<=(0|a)|(0|a)>(0|c))break n;He(g,u+h[n>>2]|0,o),i=h[n+20>>2],i=(o=t+h[n+16>>2]|0)>>>0<t>>>0?i+1|0:i,h[n+16>>2]=o,h[n+20>>2]=i}f=mi(24),h[(t=f)+4>>2]=0,h[t+8>>2]=0,h[(t=t+16|0)>>2]=0,h[t+4>>2]=0,h[f>>2]=f+4,h[f+12>>2]=t,N=o=N-32|0;s:if((0|(m=Gt(a=l+12|0,i=r+16|0)))!=(0|(b=l+16|0)))f&&(ni(f+12|0,h[f+16>>2]),fi(f,h[f+4>>2]),ve(f));else{h[o+16>>2]=i;o:{a:{if(t=h[a+4>>2])for(c=(l=(n=d[i+11|0])<<24>>24<0)?h[i>>2]:i,l=l?h[i+4>>2]:n,i=a+4|0;;){l:{c:{u:{h:{d:{f:if(u=(g=(n=(v=(n=d[t+27|0])<<24>>24<0)?h[t+20>>2]:n)>>>0<l>>>0)?n:l){if(_=t+16|0,!(_=Sr(c,v=v?h[_>>2]:_,u))){if(n>>>0>l>>>0)break f;break d}if((0|_)>=0)break d}else if(n>>>0<=l>>>0)break h;if(n=h[t>>2])break l;break a}if(n=Sr(v,c,u))break u}if(g)break c;break o}if((0|n)>=0)break o}if(i=t+4|0,!(n=h[t+4>>2]))break o;t=i}i=t,t=n}t=a+4|0}i=t}if((n=h[i>>2])?t=0:(c=(n=mi(32))+16|0,l=h[o+16>>2],s[l+11|0]>=0?(v=h[l+4>>2],h[c>>2]=h[l>>2],h[c+4>>2]=v,h[c+8>>2]=h[l+8>>2]):Ur(c,h[l>>2],h[l+4>>2]),h[n+8>>2]=t,h[n>>2]=0,h[n+4>>2]=0,h[n+28>>2]=0,h[i>>2]=n,(t=h[h[a>>2]>>2])?(h[a>>2]=t,t=h[i>>2]):t=n,Je(h[a+4>>2],t),h[a+8>>2]=h[a+8>>2]+1,t=1),s[o+28|0]=t,h[o+24>>2]=n,i=h[o+24>>2],t=h[i+28>>2],h[i+28>>2]=f,!t)break s;ni(t+12|0,h[t+16>>2]),fi(t,h[t+4>>2]),ve(t)}N=o+32|0,i=(0|m)!=(0|b)}if(s[r+27|0]<0&&ve(h[r+16>>2]),i)break t}if(!f)break t;if(h[r+16>>2]=0,!Tr(1,r+16|0,h[e>>2]))break t;if(t=0,E=h[r+16>>2])for(;;){v=0,N=u=N-32|0,h[u+24>>2]=0,h[u+16>>2]=0,h[u+20>>2]=0,i=h[e>>2],o=h[i+8>>2];n:{s:{o:if(!((0|(a=h[i+12>>2]))<=(0|(n=h[i+20>>2]))&(l=h[i+16>>2])>>>0>=o>>>0|(0|n)>(0|a))){if(a=d[l+h[i>>2]|0],o=i,i=n,i=(n=l+1|0)?i:i+1|0,h[o+16>>2]=n,h[o+20>>2]=i,rt(u+16|0,a),a){if(o=h[e>>2],g=pi(u+16|0),n=h[o+20>>2],c=(m=h[o+16>>2])+(i=a)|0,l=h[o+12>>2],n=i>>>0>c>>>0?n+1|0:n,c>>>0>p[o+8>>2]&(0|l)<=(0|n)|(0|n)>(0|l))break o;He(g,m+h[o>>2]|0,a),n=h[o+20>>2],n=(a=i+h[o+16>>2]|0)>>>0<i>>>0?n+1|0:n,h[o+16>>2]=a,h[o+20>>2]=n}if(h[u+12>>2]=0,Tr(1,u+12|0,h[e>>2])&&(i=h[u+12>>2])){if(h[u+8>>2]=0,h[u>>2]=0,h[u+4>>2]=0,(0|i)<0)break s;if(n=mi(i),h[u>>2]=n,o=i+n|0,h[u+8>>2]=o,g=St(n,0,i),h[u+4>>2]=o,o=h[e>>2],v=h[o+8>>2],l=h[o+12>>2],a=h[o+20>>2],v=(0|(a=(c=i+(m=h[o+16>>2])|0)>>>0<i>>>0?a+1|0:a))<=(0|l)&c>>>0<=v>>>0|(0|a)<(0|l)){if(He(g,m+h[o>>2]|0,i),n=i,a=i+h[o+16>>2]|0,i=h[o+20>>2],h[o+16>>2]=a,h[o+20>>2]=n>>>0>a>>>0?i+1|0:i,N=l=N-48|0,(0|(n=Gt(f,u+16|0)))!=(f+4|0)){a:if(o=h[n+4>>2])for(;a=o,o=h[o>>2];);else{if(a=h[n+8>>2],h[a>>2]==(0|n))break a;for(i=n+8|0;i=(o=h[i>>2])+8|0,a=h[o+8>>2],(0|o)!=h[a>>2];);}h[f>>2]==(0|n)&&(h[f>>2]=a),h[f+8>>2]=h[f+8>>2]-1,a=h[f+4>>2],c=n;a:{l:{if(o=h[n>>2]){if(!(i=h[c+4>>2]))break l;for(;n=i,i=h[i>>2];);}if(!(o=h[n+4>>2])){o=0,g=1;break a}}h[o+8>>2]=h[n+8>>2],g=0}m=h[n+8>>2];a:if((0|n)!=(0|(i=h[m>>2])))h[m+4>>2]=o;else{if(h[m>>2]=o,(0|n)==(0|a)){i=0,a=o;break a}i=h[m+4>>2]}_=!d[n+12|0],(0|n)!=(0|c)&&(m=h[c+8>>2],h[n+8>>2]=m,h[m+(((0|c)!=h[h[c+8>>2]>>2])<<2)>>2]=n,m=h[c>>2],h[n>>2]=m,h[m+8>>2]=n,m=h[c+4>>2],h[n+4>>2]=m,m&&(h[m+8>>2]=n),s[n+12|0]=d[c+12|0],a=(0|a)==(0|c)?n:a);a:if(!(_|!a)){if(g)for(;;){o=d[i+12|0];l:{if(n=h[i+8>>2],h[n>>2]!=(0|i)){o||(s[i+12|0]=1,s[n+12|0]=0,o=h[n+4>>2],g=h[o>>2],h[n+4>>2]=g,g&&(h[g+8>>2]=n),h[o+8>>2]=h[n+8>>2],g=h[n+8>>2],h[(((0|n)!=h[g>>2])<<2)+g>>2]=o,h[o>>2]=n,h[n+8>>2]=o,n=i,a=(0|(i=h[i>>2]))==(0|a)?n:a,i=h[i+4>>2]);c:{u:{n=h[i>>2];h:{if(d[n+12|0]||!n){if(o=h[i+4>>2],!d[o+12|0]&&o)break h;if(s[i+12|0]=0,(0|a)!=(0|(i=h[i+8>>2]))){if(d[i+12|0])break l}else i=a;s[i+12|0]=1;break a}if(!(o=h[i+4>>2]))break u}if(!d[o+12|0]){n=i;break c}}s[n+12|0]=1,s[i+12|0]=0,o=h[n+4>>2],h[i>>2]=o,o&&(h[o+8>>2]=i),h[n+8>>2]=h[i+8>>2],o=h[i+8>>2],h[((h[o>>2]!=(0|i))<<2)+o>>2]=n,h[n+4>>2]=i,h[i+8>>2]=n,o=i}i=h[n+8>>2],s[n+12|0]=d[i+12|0],s[i+12|0]=1,s[o+12|0]=1,n=h[i+4>>2],o=h[n>>2],h[i+4>>2]=o,o&&(h[o+8>>2]=i),h[n+8>>2]=h[i+8>>2],o=h[i+8>>2],h[(((0|i)!=h[o>>2])<<2)+o>>2]=n,h[n>>2]=i,h[i+8>>2]=n;break a}o||(s[i+12|0]=1,s[n+12|0]=0,o=h[i+4>>2],h[n>>2]=o,o&&(h[o+8>>2]=n),h[i+8>>2]=h[n+8>>2],o=h[n+8>>2],h[(((0|n)!=h[o>>2])<<2)+o>>2]=i,h[i+4>>2]=n,h[n+8>>2]=i,a=(0|n)==(0|a)?i:a,i=h[n>>2]);c:if(!(o=h[i>>2])|d[o+12|0]){if(n=h[i+4>>2],d[n+12|0]||!n){if(s[i+12|0]=0,(0|(i=h[i+8>>2]))!=(0|a)&&d[i+12|0])break l;s[i+12|0]=1;break a}if(o){if(!d[o+12|0]){n=i;break c}n=h[i+4>>2]}s[n+12|0]=1,s[i+12|0]=0,o=h[n>>2],h[i+4>>2]=o,o&&(h[o+8>>2]=i),h[n+8>>2]=h[i+8>>2],o=h[i+8>>2],h[((h[o>>2]!=(0|i))<<2)+o>>2]=n,h[n>>2]=i,h[i+8>>2]=n,o=i}else n=i;i=h[n+8>>2],s[n+12|0]=d[i+12|0],s[i+12|0]=1,s[o+12|0]=1,n=h[i>>2],o=h[n+4>>2],h[i>>2]=o,o&&(h[o+8>>2]=i),h[n+8>>2]=h[i+8>>2],o=h[i+8>>2],h[(((0|i)!=h[o>>2])<<2)+o>>2]=n,h[n+4>>2]=i,h[i+8>>2]=n;break a}n=i,i=h[i+8>>2],i=h[(((0|n)==h[i>>2])<<2)+i>>2]}s[o+12|0]=1}(i=h[c+28>>2])&&(h[c+32>>2]=i,ve(i)),s[c+27|0]<0&&ve(h[c+16>>2]),ve(c)}h[l>>2]=0,h[l+4>>2]=0,h[l+8>>2]=0,sr(l,i=h[u+4>>2]-h[u>>2]|0),He(h[l>>2],h[u>>2],i),s[u+27|0]>=0?(h[l+24>>2]=h[u+24>>2],i=h[u+20>>2],h[l+16>>2]=h[u+16>>2],h[l+20>>2]=i):Ur(l+16|0,h[u+16>>2],h[u+20>>2]),h[l+36>>2]=0,h[l+28>>2]=0,h[l+32>>2]=0,sr(l+28|0,h[l+4>>2]-h[l>>2]|0),i=h[l>>2],He(h[l+28>>2],i,h[l+4>>2]-i|0),n=a=l+16|0;a:{l:{if(i=h[f+4>>2])for(g=(c=(o=d[n+11|0])<<24>>24<0)?h[n>>2]:n,c=c?h[n+4>>2]:o,n=f+4|0;;){c:{u:{h:{d:{f:{p:if(_=(b=(o=(m=(o=d[i+27|0])<<24>>24<0)?h[i+20>>2]:o)>>>0<c>>>0)?o:c){if(y=i+16|0,!(y=Sr(g,m=m?h[y>>2]:y,_))){if(o>>>0>c>>>0)break p;break f}if((0|y)>=0)break f}else if(o>>>0<=c>>>0)break d;if(o=h[i>>2])break c;break l}if(o=Sr(m,g,_))break h}if(b)break u;break a}if((0|o)>=0)break a}if(n=i+4|0,!(o=h[i+4>>2]))break a;i=n}n=i,i=o}i=f+4|0}n=i}if((o=h[n>>2])?i=0:(o=mi(40),h[o+24>>2]=h[a+8>>2],c=h[a+4>>2],h[o+16>>2]=h[a>>2],h[o+20>>2]=c,h[a>>2]=0,h[a+4>>2]=0,h[a+8>>2]=0,h[o+36>>2]=0,h[(c=o+28|0)>>2]=0,h[c+4>>2]=0,sr(c,h[a+16>>2]-h[a+12>>2]|0),He(g=h[c>>2],c=h[a+12>>2],h[a+16>>2]-c|0),h[o+8>>2]=i,h[o>>2]=0,h[o+4>>2]=0,h[n>>2]=o,(i=h[h[f>>2]>>2])?(h[f>>2]=i,i=h[n>>2]):i=o,Je(h[f+4>>2],i),h[f+8>>2]=h[f+8>>2]+1,i=1),s[l+44|0]=i,h[l+40>>2]=o,(i=h[l+28>>2])&&(h[l+32>>2]=i,ve(i)),s[l+27|0]<0&&ve(h[l+16>>2]),(i=h[l>>2])&&(h[l+4>>2]=i,ve(i)),N=l+48|0,!(n=h[u>>2]))break o}h[u+4>>2]=n,ve(n)}}s[u+27|0]<0&&ve(h[u+16>>2]),N=u+32|0;break n}vn(),S()}if(!v)break t;if((0|E)==(0|(t=t+1|0)))break}if(h[r+12>>2]=0,!Tr(1,r+12|0,h[e>>2]))break t;if(t=h[e>>2],(o=(i=h[t+8>>2])-(n=h[t+16>>2])|0)>>>0<(a=h[r+12>>2])>>>0&(0|(t=h[t+12>>2]-(h[t+20>>2]+(i>>>0<n>>>0)|0)|0))<=0|(0|t)<0)break t;if(i=0,t=h[r+36>>2],a)for(;;){if((o=h[r+40>>2])>>>0>t>>>0)h[t+4>>2]=0,h[t>>2]=f,t=t+8|0,h[r+36>>2]=t;else{if((t=1+(c=(l=t-(n=h[r+32>>2])|0)>>3)|0)>>>0>=536870912)break i;if(v=(o=o-n|0)>>2,(t=o>>>0<2147483640?t>>>0>v>>>0?t:v:536870911)>>>0>=536870912)break r;g=c<<3,o=mi(c=t<<3),h[4+(t=g+o|0)>>2]=0,h[t>>2]=f,t=t+8|0,(0|l)>0&&He(o,n,l),h[r+40>>2]=o+c,h[r+36>>2]=t,h[r+32>>2]=o,n&&ve(n)}if((0|a)==(0|(i=i+1|0)))break}if(h[r+32>>2]==(0|t))break}e=1;break e}vn(),S()}Zr(1336),S()}t=h[r+32>>2],e=0}return t&&ve(t),N=r+48|0,e}function F(e,t,r,i,n){var o,a=0,l=0,c=0,f=0,m=0,g=0,v=0,_=0,b=0,y=0;N=o=N-32|0,h[t+32>>2]=i,h[t+40>>2]=r,h[t+4>>2]=n,ue(e,i,o+16|0);e:if(!h[e>>2])if(c=e+4|0,s[e+15|0]<0&&ve(h[c>>2]),i=d[o+23|0],(0|Cn[h[h[t>>2]+8>>2]](t))==(0|i))if(r=d[o+21|0],s[t+36|0]=r,n=d[o+22|0],s[t+37|0]=n,(r-3&255)>>>0<=253)t=mi(32),r=d[1571]|d[1572]<<8|d[1573]<<16|d[1574]<<24,i=d[1567]|d[1568]<<8|d[1569]<<16|d[1570]<<24,s[t+14|0]=i,s[t+15|0]=i>>>8,s[t+16|0]=i>>>16,s[t+17|0]=i>>>24,s[t+18|0]=r,s[t+19|0]=r>>>8,s[t+20|0]=r>>>16,s[t+21|0]=r>>>24,r=d[1565]|d[1566]<<8|d[1567]<<16|d[1568]<<24,i=d[1561]|d[1562]<<8|d[1563]<<16|d[1564]<<24,s[t+8|0]=i,s[t+9|0]=i>>>8,s[t+10|0]=i>>>16,s[t+11|0]=i>>>24,s[t+12|0]=r,s[t+13|0]=r>>>8,s[t+14|0]=r>>>16,s[t+15|0]=r>>>24,r=d[1557]|d[1558]<<8|d[1559]<<16|d[1560]<<24,i=d[1553]|d[1554]<<8|d[1555]<<16|d[1556]<<24,s[0|t]=i,s[t+1|0]=i>>>8,s[t+2|0]=i>>>16,s[t+3|0]=i>>>24,s[t+4|0]=r,s[t+5|0]=r>>>8,s[t+6|0]=r>>>16,s[t+7|0]=r>>>24,s[t+22|0]=0,h[e>>2]=-5,Ur(c,t,22),ve(t);else if(2!=(0|r)|n>>>0<=(i?2:3)>>>0){if(r=n|r<<8,u[h[t+32>>2]+38>>1]=r,!((65535&r)>>>0<259|u[o+26>>1]>=0)){N=f=N-16|0,n=mi(36),h[(r=n)+4>>2]=0,h[r+8>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,h[(r=r+16|0)>>2]=0,h[r+4>>2]=0,h[n>>2]=n+4,h[n+32>>2]=0,h[n+12>>2]=r,h[f>>2]=0,i=h[t+32>>2],N=m=N-16|0,r=0;t:if(n&&(h[f>>2]=i,h[m+12>>2]=0,r=0,Tr(1,m+12|0,i))){if(_=h[m+12>>2])for(;;){r:{if(Tr(1,m+8|0,h[f>>2])){if(r=mi(28),h[r+4>>2]=0,h[r+8>>2]=0,h[(i=r+16|0)>>2]=0,h[i+4>>2]=0,h[r>>2]=r+4,h[r+12>>2]=i,h[r+24>>2]=h[m+8>>2],B(f,r))break r;ni(r+12|0,h[r+16>>2]),fi(r,h[r+4>>2]),ve(r)}r=0;break t}if(N=a=N-16|0,h[a+8>>2]=r,r){if((i=h[n+28>>2])>>>0<p[n+32>>2])h[a+8>>2]=0,h[i>>2]=r,h[n+28>>2]=i+4;else{i=0;r:{i:{n:{if(l=h[n+24>>2],(r=1+(v=h[n+28>>2]-l>>2)|0)>>>0<1073741824){if(g=(l=h[n+32>>2]-l|0)>>1,r=l>>>0<2147483644?r>>>0>g>>>0?r:g:1073741823){if(r>>>0>=1073741824)break n;i=mi(r<<2)}if(g=h[a+8>>2],h[a+8>>2]=0,h[(l=(v<<2)+i|0)>>2]=g,v=(r<<2)+i|0,g=l+4|0,(0|(i=h[n+28>>2]))==(0|(r=h[n+24>>2])))break i;for(;y=h[(i=i-4|0)>>2],h[i>>2]=0,h[(l=l-4|0)>>2]=y,(0|r)!=(0|i););if(h[n+32>>2]=v,i=h[n+28>>2],h[n+28>>2]=g,r=h[n+24>>2],h[n+24>>2]=l,(0|r)==(0|i))break r;for(;l=h[(i=i-4|0)>>2],h[i>>2]=0,l&&(ni(l+12|0,h[l+16>>2]),fi(l,h[l+4>>2]),ve(l)),(0|r)!=(0|i););break r}vn(),S()}Zr(1336),S()}h[n+32>>2]=v,h[n+28>>2]=g,h[n+24>>2]=l}r&&ve(r)}r=h[a+8>>2],h[a+8>>2]=0,r&&(ni(r+12|0,h[r+16>>2]),fi(r,h[r+4>>2]),ve(r))}else h[a+8>>2]=0;if(N=a+16|0,(0|_)==(0|(b=b+1|0)))break}r=B(f,n)}if(N=m+16|0,r?(i=h[t+4>>2],r=h[i+4>>2],h[i+4>>2]=n,r&&Mr(r),h[e>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0):(r=mi(32),i=d[1723]|d[1724]<<8,s[r+24|0]=i,s[r+25|0]=i>>>8,i=d[1719]|d[1720]<<8|d[1721]<<16|d[1722]<<24,a=d[1715]|d[1716]<<8|d[1717]<<16|d[1718]<<24,s[r+16|0]=a,s[r+17|0]=a>>>8,s[r+18|0]=a>>>16,s[r+19|0]=a>>>24,s[r+20|0]=i,s[r+21|0]=i>>>8,s[r+22|0]=i>>>16,s[r+23|0]=i>>>24,i=d[1711]|d[1712]<<8|d[1713]<<16|d[1714]<<24,a=d[1707]|d[1708]<<8|d[1709]<<16|d[1710]<<24,s[r+8|0]=a,s[r+9|0]=a>>>8,s[r+10|0]=a>>>16,s[r+11|0]=a>>>24,s[r+12|0]=i,s[r+13|0]=i>>>8,s[r+14|0]=i>>>16,s[r+15|0]=i>>>24,i=d[1703]|d[1704]<<8|d[1705]<<16|d[1706]<<24,a=d[1699]|d[1700]<<8|d[1701]<<16|d[1702]<<24,s[0|r]=a,s[r+1|0]=a>>>8,s[r+2|0]=a>>>16,s[r+3|0]=a>>>24,s[r+4|0]=i,s[r+5|0]=i>>>8,s[r+6|0]=i>>>16,s[r+7|0]=i>>>24,s[r+26|0]=0,h[e>>2]=-1,Ur(e+4|0,r,26),ve(r),h[f+8>>2]=0,Mr(n)),N=f+16|0,h[e>>2])break e;s[c+11|0]>=0||ve(h[c>>2])}if(0|Cn[h[h[t>>2]+12>>2]](t))if(0|Cn[h[h[t>>2]+20>>2]](t))if(0|Cn[h[h[t>>2]+24>>2]](t))h[e>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0;else{if(t=Hr(o,1461),h[e>>2]=-1,s[t+11|0]>=0){e=h[o+4>>2],h[c>>2]=h[o>>2],h[c+4>>2]=e,h[c+8>>2]=h[o+8>>2];break e}if(Ur(c,h[t>>2],h[t+4>>2]),s[t+11|0]>=0)break e;ve(h[t>>2])}else{if(t=Hr(o,1726),h[e>>2]=-1,s[t+11|0]>=0){e=h[o+4>>2],h[c>>2]=h[o>>2],h[c+4>>2]=e,h[c+8>>2]=h[o+8>>2];break e}if(Ur(c,h[t>>2],h[t+4>>2]),s[t+11|0]>=0)break e;ve(h[t>>2])}else t=mi(48),s[t+32|0]=d[1528],r=d[1524]|d[1525]<<8|d[1526]<<16|d[1527]<<24,i=d[1520]|d[1521]<<8|d[1522]<<16|d[1523]<<24,s[t+24|0]=i,s[t+25|0]=i>>>8,s[t+26|0]=i>>>16,s[t+27|0]=i>>>24,s[t+28|0]=r,s[t+29|0]=r>>>8,s[t+30|0]=r>>>16,s[t+31|0]=r>>>24,r=d[1516]|d[1517]<<8|d[1518]<<16|d[1519]<<24,i=d[1512]|d[1513]<<8|d[1514]<<16|d[1515]<<24,s[t+16|0]=i,s[t+17|0]=i>>>8,s[t+18|0]=i>>>16,s[t+19|0]=i>>>24,s[t+20|0]=r,s[t+21|0]=r>>>8,s[t+22|0]=r>>>16,s[t+23|0]=r>>>24,r=d[1508]|d[1509]<<8|d[1510]<<16|d[1511]<<24,i=d[1504]|d[1505]<<8|d[1506]<<16|d[1507]<<24,s[t+8|0]=i,s[t+9|0]=i>>>8,s[t+10|0]=i>>>16,s[t+11|0]=i>>>24,s[t+12|0]=r,s[t+13|0]=r>>>8,s[t+14|0]=r>>>16,s[t+15|0]=r>>>24,r=d[1500]|d[1501]<<8|d[1502]<<16|d[1503]<<24,i=d[1496]|d[1497]<<8|d[1498]<<16|d[1499]<<24,s[0|t]=i,s[t+1|0]=i>>>8,s[t+2|0]=i>>>16,s[t+3|0]=i>>>24,s[t+4|0]=r,s[t+5|0]=r>>>8,s[t+6|0]=r>>>16,s[t+7|0]=r>>>24,s[t+33|0]=0,h[e>>2]=-1,Ur(c,t,33),ve(t)}else t=mi(32),r=d[1548]|d[1549]<<8|d[1550]<<16|d[1551]<<24,i=d[1544]|d[1545]<<8|d[1546]<<16|d[1547]<<24,s[t+14|0]=i,s[t+15|0]=i>>>8,s[t+16|0]=i>>>16,s[t+17|0]=i>>>24,s[t+18|0]=r,s[t+19|0]=r>>>8,s[t+20|0]=r>>>16,s[t+21|0]=r>>>24,r=d[1542]|d[1543]<<8|d[1544]<<16|d[1545]<<24,i=d[1538]|d[1539]<<8|d[1540]<<16|d[1541]<<24,s[t+8|0]=i,s[t+9|0]=i>>>8,s[t+10|0]=i>>>16,s[t+11|0]=i>>>24,s[t+12|0]=r,s[t+13|0]=r>>>8,s[t+14|0]=r>>>16,s[t+15|0]=r>>>24,r=d[1534]|d[1535]<<8|d[1536]<<16|d[1537]<<24,i=d[1530]|d[1531]<<8|d[1532]<<16|d[1533]<<24,s[0|t]=i,s[t+1|0]=i>>>8,s[t+2|0]=i>>>16,s[t+3|0]=i>>>24,s[t+4|0]=r,s[t+5|0]=r>>>8,s[t+6|0]=r>>>16,s[t+7|0]=r>>>24,s[t+22|0]=0,h[e>>2]=-5,Ur(c,t,22),ve(t);else t=mi(64),r=d[1458]|d[1459]<<8,s[t+48|0]=r,s[t+49|0]=r>>>8,r=d[1454]|d[1455]<<8|d[1456]<<16|d[1457]<<24,i=d[1450]|d[1451]<<8|d[1452]<<16|d[1453]<<24,s[t+40|0]=i,s[t+41|0]=i>>>8,s[t+42|0]=i>>>16,s[t+43|0]=i>>>24,s[t+44|0]=r,s[t+45|0]=r>>>8,s[t+46|0]=r>>>16,s[t+47|0]=r>>>24,r=d[1446]|d[1447]<<8|d[1448]<<16|d[1449]<<24,i=d[1442]|d[1443]<<8|d[1444]<<16|d[1445]<<24,s[t+32|0]=i,s[t+33|0]=i>>>8,s[t+34|0]=i>>>16,s[t+35|0]=i>>>24,s[t+36|0]=r,s[t+37|0]=r>>>8,s[t+38|0]=r>>>16,s[t+39|0]=r>>>24,r=d[1438]|d[1439]<<8|d[1440]<<16|d[1441]<<24,i=d[1434]|d[1435]<<8|d[1436]<<16|d[1437]<<24,s[t+24|0]=i,s[t+25|0]=i>>>8,s[t+26|0]=i>>>16,s[t+27|0]=i>>>24,s[t+28|0]=r,s[t+29|0]=r>>>8,s[t+30|0]=r>>>16,s[t+31|0]=r>>>24,r=d[1430]|d[1431]<<8|d[1432]<<16|d[1433]<<24,i=d[1426]|d[1427]<<8|d[1428]<<16|d[1429]<<24,s[t+16|0]=i,s[t+17|0]=i>>>8,s[t+18|0]=i>>>16,s[t+19|0]=i>>>24,s[t+20|0]=r,s[t+21|0]=r>>>8,s[t+22|0]=r>>>16,s[t+23|0]=r>>>24,r=d[1422]|d[1423]<<8|d[1424]<<16|d[1425]<<24,i=d[1418]|d[1419]<<8|d[1420]<<16|d[1421]<<24,s[t+8|0]=i,s[t+9|0]=i>>>8,s[t+10|0]=i>>>16,s[t+11|0]=i>>>24,s[t+12|0]=r,s[t+13|0]=r>>>8,s[t+14|0]=r>>>16,s[t+15|0]=r>>>24,r=d[1414]|d[1415]<<8|d[1416]<<16|d[1417]<<24,i=d[1410]|d[1411]<<8|d[1412]<<16|d[1413]<<24,s[0|t]=i,s[t+1|0]=i>>>8,s[t+2|0]=i>>>16,s[t+3|0]=i>>>24,s[t+4|0]=r,s[t+5|0]=r>>>8,s[t+6|0]=r>>>16,s[t+7|0]=r>>>24,s[t+50|0]=0,h[e>>2]=-1,Ur(c,t,50),ve(t);N=o+32|0}function j(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0;if(s=h[t+12>>2],i=h[t+20>>2],i=(n=(l=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,!(n>>>0>p[t+8>>2]&(0|i)>=(0|s)|(0|i)>(0|s)||(i=l+h[t>>2]|0,h[e>>2]=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,s=i=h[t+20>>2],i=(l=(n=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,c=l,h[t+16>>2]=l,h[t+20>>2]=i,p[e>>2]>32||(l=h[t+12>>2],i=s,i=(s=n+8|0)>>>0<8?i+1|0:i,s>>>0>p[t+8>>2]&(0|i)>=(0|l)|(0|i)>(0|l))))){if(i=c+h[t>>2]|0,a=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[e+4>>2]=a,i=h[t+20>>2],i=(s=h[t+16>>2]+4|0)>>>0<4?i+1|0:i,h[t+16>>2]=s,h[t+20>>2]=i,!a)return 1;if(a=0,h[e+8>>2]=0,Tt(e+16|0,t)&&Tt(e+36|0,t)&&Tt(e+56|0,t)&&Tt(e+76|0,t)){w=h[e+4>>2],l=r,t=0,r=0,N=n=N-32|0,s=e,e=h[e+12>>2],h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;e:{t:{if(e){if(e>>>0>=1073741824)break t;t=mi(i=e<<2),h[n+8>>2]=t,r=t+i|0,h[n+16>>2]=r,St(t,0,i),h[n+12>>2]=r}i=h[s+120>>2],(a=h[i>>2])&&(h[i+4>>2]=a,ve(a),h[i+8>>2]=0,h[i>>2]=0,h[i+4>>2]=0,r=h[n+12>>2],t=h[n+8>>2],e=h[s+12>>2]),h[i+4>>2]=r,h[i>>2]=t,h[i+8>>2]=h[n+16>>2],t=0,h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;r:{if(e){if(e>>>0>=1073741824)break r;o=mi(e<<=2),h[n+8>>2]=o,t=e+o|0,h[n+16>>2]=t,St(o,0,e),h[n+12>>2]=t}e=h[s+132>>2],(r=h[e>>2])&&(h[e+4>>2]=r,ve(r),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,o=h[n+8>>2],t=h[n+12>>2]),h[e+4>>2]=t,h[e>>2]=o,h[e+8>>2]=h[n+16>>2],h[n+24>>2]=0,h[n+28>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,Qe(n+8|0),t=((e=h[n+24>>2]+h[n+28>>2]|0)>>>0)/341|0,e=h[h[n+12>>2]+(t<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=w,i=1,e=(t=h[n+28>>2])+1|0,h[n+28>>2]=e;i:if(!(e>>>0<t>>>0)){for(;;){if(u=h[n+12>>2],i=h[n+24>>2],r=h[u+((r=((t=i+(o=e-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(r,341)|0,12)|0,t=h[r+8>>2],a=h[r+4>>2],c=h[r>>2],h[n+28>>2]=o,1+(((o=(r=h[n+16>>2])-u|0)?v(o>>2,341)-1|0:0)-(e+i|0)|0)>>>0>=682&&(ve(h[r-4>>2]),h[n+16>>2]=h[n+16>>2]-4),i=0,c>>>0>w>>>0)break i;if((o=(0|a)==((e=h[s+12>>2])-1|0)?0:a+1|0)>>>0>=e>>>0)break i;m=(f=v(t,12))+h[s+132>>2]|0,u=f+h[s+120>>2]|0;n:{s:{if(_=o<<2,!(r=h[s>>2]-h[_+h[m>>2]>>2]|0)){if(!c)break s;if(m=0,(0|(e=h[l+16>>2]))==(0|(o=h[l+20>>2]))){e=h[s+8>>2],h[l+28>>2]=c+h[l+28>>2],h[s+8>>2]=e+c;break s}for(;;){a=0;o:if((0|e)!=(0|o))for(;;){if(i=v(a,20)+e|0,r=h[u>>2]+(h[i+4>>2]<<2)|0,f=h[i>>2],!((o=h[i+12>>2])>>>0>3))if(t=h[l+12>>2],h[i+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,o))+(o=h[i+12>>2])|0,(e=e+1|0)>>>0<p[i+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[f+84|0]?e:h[h[f+68>>2]+(e<<2)>>2])>>>0>=p[f+80>>2])break o;if(t=e,e=h[f+40>>2],He(h[h[f>>2]>>2]+v(t,e)|0,r,e),a=a+1|0,e=h[l+16>>2],!(a>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|c)==(0|(m=m+1|0)))break s;e=h[l+16>>2],o=h[l+20>>2]}}o:{a:{l:{c:{if(c>>>0<=2){if(r=h[s+108>>2],h[r>>2]=o,t=1,(e=h[s+12>>2])>>>0>1)break c;break o}if(p[s+8>>2]>p[s+4>>2])break i;(0|(i=(e=h[s+120>>2])+(m=v(g=t+1|0,12))|0))!=(0|u)&&(Ft(i,h[u>>2],h[u+4>>2]),e=h[s+120>>2]),e=_+h[e+m>>2]|0,h[e>>2]=h[e>>2]+(1<<r-1);u:if((0|(e=31^y(c)))<=(0|(a=32-(r=h[s+32>>2])|0))){if((0|(a=h[s+28>>2]))==h[s+20>>2]){i=0;break u}if(i=h[a>>2],u=e+r|0,h[s+32>>2]=u,i=i<<r>>>32-e|0,32!=(0|u))break u;h[s+32>>2]=0,h[s+28>>2]=a+4}else(0|(u=(i=h[s+28>>2])+4|0))!=h[s+20>>2]?(E=h[i>>2],h[s+28>>2]=u,a=e-a|0,h[s+32>>2]=a,i=h[i+4>>2]>>>32-a|E<<r>>>32-e):i=0;if((0|(i=c-(e=(c>>>1|0)-i|0)|0))!=(0|e)){if((0|(r=h[s+88>>2]))==h[s+80>>2])break l;a=h[r>>2],u=(c=h[s+92>>2])+1|0,h[s+92>>2]=u,a&=-2147483648>>>c;u:{if(32==(0|u)){if(h[s+92>>2]=0,h[s+88>>2]=r+4,a)break u;break l}if(!a)break l}}else i=e;a=i,i=e;break a}for(;o=(e-1|0)==(0|o)?0:o+1|0,h[r+(t<<2)>>2]=o,(e=h[s+12>>2])>>>0>(t=t+1|0)>>>0;);break o}a=e}if(e=h[s+132>>2],c=h[(r=e+f|0)>>2],h[(u=c+_|0)>>2]=h[u>>2]+1,Ft(e+m|0,c,h[r+4>>2]),i&&(e=h[n+28>>2]+h[n+24>>2]|0,r=h[n+12>>2],(0|e)==(0|((c=h[n+16>>2]-r|0)?v(c>>2,341)-1|0:0))&&(Qe(n+8|0),r=h[n+12>>2],e=h[n+24>>2]+h[n+28>>2]|0),e=h[(c=r)+((r=(e>>>0)/341|0)<<2)>>2]+v(e-v(r,341)|0,12)|0,h[e+8>>2]=t,h[e+4>>2]=o,h[e>>2]=i,h[n+28>>2]=h[n+28>>2]+1),!a)break s;e=h[n+28>>2]+h[n+24>>2]|0,t=h[n+12>>2],(0|e)==(0|((r=h[n+16>>2]-t|0)?v(r>>2,341)-1|0:0))&&(Qe(n+8|0),t=h[n+12>>2],e=h[n+24>>2]+h[n+28>>2]|0),e=h[(r=t)+((t=(e>>>0)/341|0)<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+8>>2]=g,h[e+4>>2]=o,h[e>>2]=a,e=h[n+28>>2]+1|0,h[n+28>>2]=e;break n}if(_=0,c)for(;;){if(e)for(a=h[s+40>>2],i=h[s+96>>2],E=h[s+108>>2],A=h[u>>2],T=h[m>>2],e=0;;){h[i+(h[(o=E+(e<<2)|0)>>2]<<2)>>2]=0,r=h[o>>2]<<2;o:if(t=h[s>>2]-h[r+T>>2]|0)if(r=r+i|0,(0|(b=32-(f=h[s+52>>2])|0))>=(0|t)){if((0|(g=h[s+48>>2]))==(0|a)){h[r>>2]=0;break o}if(h[r>>2]=h[g>>2]<<f>>>32-t,t=t+h[s+52>>2]|0,h[s+52>>2]=t,32!=(0|t))break o;h[s+52>>2]=0,h[s+48>>2]=g+4}else(0|a)!=(0|(x=(g=h[s+48>>2])+4|0))?(M=h[g>>2],h[s+48>>2]=x,b=t-b|0,h[s+52>>2]=b,h[r>>2]=h[g+4>>2]>>>32-b|M<<f>>>32-t):h[r>>2]=0;if(t=h[o>>2]<<2,h[(r=t+i|0)>>2]=h[r>>2]|h[t+A>>2],!((e=e+1|0)>>>0<p[s+12>>2]))break}a=0;o:if((0|(e=h[l+16>>2]))!=h[l+20>>2])for(;;){if(i=v(a,20)+e|0,r=h[s+96>>2]+(h[i+4>>2]<<2)|0,f=h[i>>2],!((o=h[i+12>>2])>>>0>3))if(t=h[l+12>>2],h[i+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,o))+(o=h[i+12>>2])|0,(e=e+1|0)>>>0<p[i+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[f+84|0]?e:h[h[f+68>>2]+(e<<2)>>2])>>>0>=p[f+80>>2])break o;if(t=e,e=h[f+40>>2],He(h[h[f>>2]>>2]+v(t,e)|0,r,e),a=a+1|0,e=h[l+16>>2],!(a>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|c)==(0|(_=_+1|0)))break s;e=h[s+12>>2]}}e=h[n+28>>2]}if(!e)break}i=1}if(h[n+28>>2]=0,(t=(o=h[n+16>>2])-(e=h[n+12>>2])|0)>>>0>=9)for(;ve(h[e>>2]),e=h[n+12>>2]+4|0,h[n+12>>2]=e,(t=(o=h[n+16>>2])-e|0)>>>0>8;);switch(r=170,(t>>>2|0)-1|0){case 1:r=341;case 0:h[n+24>>2]=r}if((0|e)!=(0|o)){for(;ve(h[e>>2]),(0|o)!=(0|(e=e+4|0)););(0|(e=h[n+16>>2]))!=(0|(t=h[n+12>>2]))&&(h[n+16>>2]=e+(((e-t|0)-4>>>2^-1)<<2))}(e=h[n+8>>2])&&ve(e),N=n+32|0;break e}vn(),S()}vn(),S()}a=i}}return a}function z(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0;if(s=h[t+12>>2],i=h[t+20>>2],i=(n=(l=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,!(n>>>0>p[t+8>>2]&(0|i)>=(0|s)|(0|i)>(0|s)||(i=l+h[t>>2]|0,h[e>>2]=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,s=i=h[t+20>>2],i=(l=(n=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,u=l,h[t+16>>2]=l,h[t+20>>2]=i,p[e>>2]>32||(l=h[t+12>>2],i=s,i=(s=n+8|0)>>>0<8?i+1|0:i,s>>>0>p[t+8>>2]&(0|i)>=(0|l)|(0|i)>(0|l))))){if(i=u+h[t>>2]|0,o=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[e+4>>2]=o,i=h[t+20>>2],i=(s=h[t+16>>2]+4|0)>>>0<4?i+1|0:i,h[t+16>>2]=s,h[t+20>>2]=i,!o)return 1;if(o=0,h[e+8>>2]=0,Tt(e+16|0,t)&&Tt(e+36|0,t)&&Tt(e+56|0,t)&&Tt(e+76|0,t)){b=h[e+4>>2],l=r,t=0,r=0,N=n=N-32|0,s=e,e=h[e+12>>2],h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;e:{t:{if(e){if(e>>>0>=1073741824)break t;t=mi(i=e<<2),h[n+8>>2]=t,r=t+i|0,h[n+16>>2]=r,St(t,0,i),h[n+12>>2]=r}i=h[s+120>>2],(o=h[i>>2])&&(h[i+4>>2]=o,ve(o),h[i+8>>2]=0,h[i>>2]=0,h[i+4>>2]=0,r=h[n+12>>2],t=h[n+8>>2],e=h[s+12>>2]),h[i+4>>2]=r,h[i>>2]=t,h[i+8>>2]=h[n+16>>2],t=0,h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;r:{if(e){if(e>>>0>=1073741824)break r;a=mi(e<<=2),h[n+8>>2]=a,t=e+a|0,h[n+16>>2]=t,St(a,0,e),h[n+12>>2]=t}e=h[s+132>>2],(r=h[e>>2])&&(h[e+4>>2]=r,ve(r),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,a=h[n+8>>2],t=h[n+12>>2]),h[e+4>>2]=t,h[e>>2]=a,h[e+8>>2]=h[n+16>>2],h[n+24>>2]=0,h[n+28>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,Qe(n+8|0),t=((e=h[n+24>>2]+h[n+28>>2]|0)>>>0)/341|0,e=h[h[n+12>>2]+(t<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=b,i=1,e=(t=h[n+28>>2])+1|0,h[n+28>>2]=e;i:if(!(e>>>0<t>>>0)){for(;;){if(c=h[n+12>>2],i=h[n+24>>2],t=h[c+((r=((t=i+(a=e-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(r,341)|0,12)|0,r=h[t+8>>2],o=h[t+4>>2],u=h[t>>2],h[n+28>>2]=a,1+(((a=(t=h[n+16>>2])-c|0)?v(a>>2,341)-1|0:0)-(e+i|0)|0)>>>0>=682&&(ve(h[t-4>>2]),h[n+16>>2]=h[n+16>>2]-4),u>>>0>b>>>0){i=0;break i}if(i=0,(a=(0|o)==((e=h[s+12>>2])-1|0)?0:o+1|0)>>>0>=e>>>0)break i;m=(e=h[s+120>>2])+(t=v(r,12))|0;n:{s:{if(c=a<<2,E=t+h[s+132>>2]|0,!(o=h[s>>2]-h[c+h[E>>2]>>2]|0)){if(!u)break s;if((0|(e=h[l+16>>2]))==(0|(a=h[l+20>>2]))){e=h[s+8>>2],h[l+28>>2]=u+h[l+28>>2],h[s+8>>2]=e+u;break s}for(;;){o=0;o:if((0|e)!=(0|a))for(;;){if(c=v(o,20)+e|0,r=h[m>>2]+(h[c+4>>2]<<2)|0,f=h[c>>2],!((a=h[c+12>>2])>>>0>3))if(t=h[l+12>>2],h[c+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,a))+(a=h[c+12>>2])|0,(e=e+1|0)>>>0<p[c+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[f+84|0]?e:h[h[f+68>>2]+(e<<2)>>2])>>>0>=p[f+80>>2])break o;if(t=e,e=h[f+40>>2],He(h[h[f>>2]>>2]+v(t,e)|0,r,e),o=o+1|0,e=h[l+16>>2],!(o>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|u)==(0|(i=i+1|0)))break s;e=h[l+16>>2],a=h[l+20>>2]}}o:{a:{l:{c:{if(u>>>0<=2){if(r=h[s+108>>2],h[r>>2]=a,t=1,(e=h[s+12>>2])>>>0>1)break c;break o}if(p[s+8>>2]>p[s+4>>2])break i;Ft((i=e)+(e=t+12|0)|0,h[m>>2],h[m+4>>2]),e=c+h[e+h[s+120>>2]>>2]|0,h[e>>2]=h[e>>2]+(1<<o-1);u:if((0|(e=31^y(u)))<=(0|(f=32-(i=h[s+32>>2])|0))){if((0|(o=h[s+28>>2]))==h[s+20>>2]){i=0;break u}if(f=h[o>>2],m=e+i|0,h[s+32>>2]=m,i=f<<i>>>32-e|0,32!=(0|m))break u;h[s+32>>2]=0,h[s+28>>2]=o+4}else(0|(m=(o=h[s+28>>2])+4|0))!=h[s+20>>2]?(g=h[o>>2],h[s+28>>2]=m,f=e-f|0,h[s+32>>2]=f,i=h[o+4>>2]>>>32-f|g<<i>>>32-e):i=0;if(f=r+1|0,(0|(i=u-(e=(u>>>1|0)-i|0)|0))!=(0|e)){if((0|(o=h[s+88>>2]))==h[s+80>>2])break l;u=h[o>>2],g=(m=h[s+92>>2])+1|0,h[s+92>>2]=g,u&=-2147483648>>>m;u:{if(32==(0|g)){if(h[s+92>>2]=0,h[s+88>>2]=o+4,u)break u;break l}if(!u)break l}}else i=e;o=i,i=e;break a}for(;a=(e-1|0)==(0|a)?0:a+1|0,h[r+(t<<2)>>2]=a,(e=h[s+12>>2])>>>0>(t=t+1|0)>>>0;);break o}o=e}if(e=h[s+132>>2],u=h[(t=e+t|0)>>2],h[(c=u+c|0)>>2]=h[c>>2]+1,Ft(e+v(f,12)|0,u,h[t+4>>2]),i&&(e=h[n+28>>2]+h[n+24>>2]|0,t=h[n+12>>2],(0|e)==(0|((u=h[n+16>>2]-t|0)?v(u>>2,341)-1|0:0))&&(Qe(n+8|0),t=h[n+12>>2],e=h[n+24>>2]+h[n+28>>2]|0),e=h[(u=t)+((t=(e>>>0)/341|0)<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+8>>2]=r,h[e+4>>2]=a,h[e>>2]=i,h[n+28>>2]=h[n+28>>2]+1),!o)break s;e=h[n+28>>2]+h[n+24>>2]|0,t=h[n+12>>2],(0|e)==(0|((r=h[n+16>>2]-t|0)?v(r>>2,341)-1|0:0))&&(Qe(n+8|0),t=h[n+12>>2],e=h[n+24>>2]+h[n+28>>2]|0),e=h[(r=t)+((t=(e>>>0)/341|0)<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+8>>2]=f,h[e+4>>2]=a,h[e>>2]=o,e=h[n+28>>2]+1|0,h[n+28>>2]=e;break n}if(u)for(;;){if(e)for(a=h[s+40>>2],o=h[s+96>>2],x=h[s+108>>2],A=h[m>>2],T=h[E>>2],e=0;;){h[o+(h[(c=(e<<2)+x|0)>>2]<<2)>>2]=0,r=h[c>>2]<<2;o:if(t=h[s>>2]-h[r+T>>2]|0)if(r=r+o|0,(0|(_=32-(f=h[s+52>>2])|0))>=(0|t)){if((0|(g=h[s+48>>2]))==(0|a)){h[r>>2]=0;break o}if(h[r>>2]=h[g>>2]<<f>>>32-t,t=t+h[s+52>>2]|0,h[s+52>>2]=t,32!=(0|t))break o;h[s+52>>2]=0,h[s+48>>2]=g+4}else(0|a)!=(0|(w=(g=h[s+48>>2])+4|0))?(M=h[g>>2],h[s+48>>2]=w,_=t-_|0,h[s+52>>2]=_,h[r>>2]=h[g+4>>2]>>>32-_|M<<f>>>32-t):h[r>>2]=0;if(t=h[c>>2]<<2,h[(r=t+o|0)>>2]=h[r>>2]|h[t+A>>2],!((e=e+1|0)>>>0<p[s+12>>2]))break}o=0;o:if((0|(e=h[l+16>>2]))!=h[l+20>>2])for(;;){if(c=v(o,20)+e|0,r=h[s+96>>2]+(h[c+4>>2]<<2)|0,f=h[c>>2],!((a=h[c+12>>2])>>>0>3))if(t=h[l+12>>2],h[c+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,a))+(a=h[c+12>>2])|0,(e=e+1|0)>>>0<p[c+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[f+84|0]?e:h[h[f+68>>2]+(e<<2)>>2])>>>0>=p[f+80>>2])break o;if(t=e,e=h[f+40>>2],He(h[h[f>>2]>>2]+v(t,e)|0,r,e),o=o+1|0,e=h[l+16>>2],!(o>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|u)==(0|(i=i+1|0)))break s;e=h[s+12>>2]}}e=h[n+28>>2]}if(!e)break}i=1}if(h[n+28>>2]=0,(t=(a=h[n+16>>2])-(e=h[n+12>>2])|0)>>>0>=9)for(;ve(h[e>>2]),e=h[n+12>>2]+4|0,h[n+12>>2]=e,(t=(a=h[n+16>>2])-e|0)>>>0>8;);switch(r=170,(t>>>2|0)-1|0){case 1:r=341;case 0:h[n+24>>2]=r}if((0|e)!=(0|a)){for(;ve(h[e>>2]),(0|a)!=(0|(e=e+4|0)););(0|(e=h[n+16>>2]))!=(0|(t=h[n+12>>2]))&&(h[n+16>>2]=e+(((e-t|0)-4>>>2^-1)<<2))}(e=h[n+8>>2])&&ve(e),N=n+32|0;break e}vn(),S()}vn(),S()}o=i}}return o}function W(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0;if(s=h[t+12>>2],i=h[t+20>>2],i=(n=(l=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,!(n>>>0>p[t+8>>2]&(0|i)>=(0|s)|(0|i)>(0|s)||(i=l+h[t>>2]|0,h[e>>2]=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,s=i=h[t+20>>2],i=(l=(n=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,c=l,h[t+16>>2]=l,h[t+20>>2]=i,p[e>>2]>32||(l=h[t+12>>2],i=s,i=(s=n+8|0)>>>0<8?i+1|0:i,s>>>0>p[t+8>>2]&(0|i)>=(0|l)|(0|i)>(0|l))))){if(i=c+h[t>>2]|0,a=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[e+4>>2]=a,i=h[t+20>>2],i=(s=h[t+16>>2]+4|0)>>>0<4?i+1|0:i,h[t+16>>2]=s,h[t+20>>2]=i,!a)return 1;if(a=0,h[e+8>>2]=0,ze(e+16|0,t)&&Tt(e+32|0,t)&&Tt(e+52|0,t)&&Tt(e+72|0,t)){E=h[e+4>>2],l=r,t=0,r=0,N=n=N-32|0,s=e,e=h[e+12>>2],h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;e:{t:{if(e){if(e>>>0>=1073741824)break t;t=mi(i=e<<2),h[n+8>>2]=t,r=t+i|0,h[n+16>>2]=r,St(t,0,i),h[n+12>>2]=r}i=h[s+116>>2],(a=h[i>>2])&&(h[i+4>>2]=a,ve(a),h[i+8>>2]=0,h[i>>2]=0,h[i+4>>2]=0,r=h[n+12>>2],t=h[n+8>>2],e=h[s+12>>2]),h[i+4>>2]=r,h[i>>2]=t,h[i+8>>2]=h[n+16>>2],t=0,h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;r:{if(e){if(e>>>0>=1073741824)break r;o=mi(e<<=2),h[n+8>>2]=o,t=e+o|0,h[n+16>>2]=t,St(o,0,e),h[n+12>>2]=t}e=h[s+128>>2],(r=h[e>>2])&&(h[e+4>>2]=r,ve(r),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,o=h[n+8>>2],t=h[n+12>>2]),h[e+4>>2]=t,h[e>>2]=o,h[e+8>>2]=h[n+16>>2],h[n+24>>2]=0,h[n+28>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,Qe(n+8|0),t=((e=h[n+24>>2]+h[n+28>>2]|0)>>>0)/341|0,e=h[h[n+12>>2]+(t<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=E,i=1,e=(t=h[n+28>>2])+1|0,h[n+28>>2]=e;i:if(!(e>>>0<t>>>0)){for(x=s+16|0;;){if(f=h[n+12>>2],i=h[n+24>>2],r=h[f+((r=((t=i+(o=e-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(r,341)|0,12)|0,t=h[r+8>>2],a=h[r+4>>2],c=h[r>>2],h[n+28>>2]=o,1+(((o=(r=h[n+16>>2])-f|0)?v(o>>2,341)-1|0:0)-(e+i|0)|0)>>>0>=682&&(ve(h[r-4>>2]),h[n+16>>2]=h[n+16>>2]-4),i=0,c>>>0>E>>>0)break i;if((o=((e=h[s+12>>2])-1|0)==(0|a)?0:a+1|0)>>>0>=e>>>0)break i;m=(r=v(t,12))+h[s+128>>2]|0,f=r+h[s+116>>2]|0;n:{if(u=o<<2,!(a=h[s>>2]-h[u+h[m>>2]>>2]|0)){if(!c)break n;if(m=0,(0|(e=h[l+16>>2]))==(0|(o=h[l+20>>2]))){e=h[s+8>>2],h[l+28>>2]=c+h[l+28>>2],h[s+8>>2]=e+c;break n}for(;;){a=0;s:if((0|e)!=(0|o))for(;;){if(i=v(a,20)+e|0,r=h[f>>2]+(h[i+4>>2]<<2)|0,u=h[i>>2],!((o=h[i+12>>2])>>>0>3))if(t=h[l+12>>2],h[i+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,o))+(o=h[i+12>>2])|0,(e=e+1|0)>>>0<p[i+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[u+84|0]?e:h[h[u+68>>2]+(e<<2)>>2])>>>0>=p[u+80>>2])break s;if(t=e,e=h[u+40>>2],He(h[h[u>>2]>>2]+v(t,e)|0,r,e),a=a+1|0,e=h[l+16>>2],!(a>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|c)==(0|(m=m+1|0)))break n;e=h[l+16>>2],o=h[l+20>>2]}}s:{o:{a:{l:{if(c>>>0<=2){if(r=h[s+104>>2],h[r>>2]=o,t=1,(e=h[s+12>>2])>>>0>1)break l;break s}if(p[s+8>>2]>p[s+4>>2])break i;if((0|(i=(e=h[s+116>>2])+(m=v(_=t+1|0,12))|0))!=(0|f)&&(Ft(i,h[f>>2],h[f+4>>2]),e=h[s+116>>2]),e=u+h[e+m>>2]|0,h[e>>2]=h[e>>2]+(1<<a-1),h[n+4>>2]=0,mr(x,31^y(c),n+4|0),(0|(i=c-(e=(c>>>1|0)-h[n+4>>2]|0)|0))!=(0|e)){if((0|(a=h[s+84>>2]))==h[s+76>>2])break a;c=h[a>>2],g=(f=h[s+88>>2])+1|0,h[s+88>>2]=g,c&=-2147483648>>>f;c:{if(32==(0|g)){if(h[s+88>>2]=0,h[s+84>>2]=a+4,c)break c;break a}if(!c)break a}}else i=e;a=i,i=e;break o}for(;o=(e-1|0)==(0|o)?0:o+1|0,h[r+(t<<2)>>2]=o,(e=h[s+12>>2])>>>0>(t=t+1|0)>>>0;);break s}a=e}if(e=h[s+128>>2],c=h[(r=e+r|0)>>2],h[(f=c+u|0)>>2]=h[f>>2]+1,Ft(e+m|0,c,h[r+4>>2]),i&&(e=h[n+28>>2]+h[n+24>>2]|0,r=h[n+12>>2],(0|e)==(0|((c=h[n+16>>2]-r|0)?v(c>>2,341)-1|0:0))&&(Qe(n+8|0),r=h[n+12>>2],e=h[n+24>>2]+h[n+28>>2]|0),e=h[(c=r)+((r=(e>>>0)/341|0)<<2)>>2]+v(e-v(r,341)|0,12)|0,h[e+8>>2]=t,h[e+4>>2]=o,h[e>>2]=i,h[n+28>>2]=h[n+28>>2]+1),!a)break n;e=h[n+28>>2]+h[n+24>>2]|0,t=h[n+12>>2],(0|e)==(0|((r=h[n+16>>2]-t|0)?v(r>>2,341)-1|0:0))&&(Qe(n+8|0),t=h[n+12>>2],e=h[n+24>>2]+h[n+28>>2]|0),e=h[(r=t)+((t=(e>>>0)/341|0)<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+8>>2]=_,h[e+4>>2]=o,h[e>>2]=a,h[n+28>>2]=h[n+28>>2]+1;break n}if(_=0,c)for(;;){if(e)for(a=h[s+36>>2],i=h[s+92>>2],A=h[s+104>>2],T=h[f>>2],M=h[m>>2],e=0;;){h[i+(h[(o=(e<<2)+A|0)>>2]<<2)>>2]=0,r=h[o>>2]<<2;s:if(t=h[s>>2]-h[r+M>>2]|0)if(r=r+i|0,(0|(b=32-(u=h[s+48>>2])|0))>=(0|t)){if((0|(g=h[s+44>>2]))==(0|a)){h[r>>2]=0;break s}if(h[r>>2]=h[g>>2]<<u>>>32-t,t=t+h[s+48>>2]|0,h[s+48>>2]=t,32!=(0|t))break s;h[s+48>>2]=0,h[s+44>>2]=g+4}else(0|a)!=(0|(w=(g=h[s+44>>2])+4|0))?(C=h[g>>2],h[s+44>>2]=w,b=t-b|0,h[s+48>>2]=b,h[r>>2]=h[g+4>>2]>>>32-b|C<<u>>>32-t):h[r>>2]=0;if(t=h[o>>2]<<2,h[(r=t+i|0)>>2]=h[r>>2]|h[t+T>>2],!((e=e+1|0)>>>0<p[s+12>>2]))break}a=0;s:if((0|(e=h[l+16>>2]))!=h[l+20>>2])for(;;){if(i=v(a,20)+e|0,r=h[s+92>>2]+(h[i+4>>2]<<2)|0,u=h[i>>2],!((o=h[i+12>>2])>>>0>3))if(t=h[l+12>>2],h[i+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,o))+(o=h[i+12>>2])|0,(e=e+1|0)>>>0<p[i+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[u+84|0]?e:h[h[u+68>>2]+(e<<2)>>2])>>>0>=p[u+80>>2])break s;if(t=e,e=h[u+40>>2],He(h[h[u>>2]>>2]+v(t,e)|0,r,e),a=a+1|0,e=h[l+16>>2],!(a>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|c)==(0|(_=_+1|0)))break n;e=h[s+12>>2]}}if(!(e=h[n+28>>2]))break}i=1}if(h[n+28>>2]=0,(t=(o=h[n+16>>2])-(e=h[n+12>>2])|0)>>>0>=9)for(;ve(h[e>>2]),e=h[n+12>>2]+4|0,h[n+12>>2]=e,(t=(o=h[n+16>>2])-e|0)>>>0>8;);switch(r=170,(t>>>2|0)-1|0){case 1:r=341;case 0:h[n+24>>2]=r}if((0|e)!=(0|o)){for(;ve(h[e>>2]),(0|o)!=(0|(e=e+4|0)););(0|(e=h[n+16>>2]))!=(0|(t=h[n+12>>2]))&&(h[n+16>>2]=e+(((e-t|0)-4>>>2^-1)<<2))}(e=h[n+8>>2])&&ve(e),N=n+32|0;break e}vn(),S()}vn(),S()}a=i}}return a}function H(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0;if(a=h[t+12>>2],s=h[t+20>>2],s=(o=(n=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,!(o>>>0>p[t+8>>2]&(0|s)>=(0|a)|(0|s)>(0|a)||(s=n+h[t>>2]|0,h[e>>2]=d[0|s]|d[s+1|0]<<8|d[s+2|0]<<16|d[s+3|0]<<24,a=s=h[t+20>>2],s=(n=(o=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,l=n,h[t+16>>2]=n,h[t+20>>2]=s,p[e>>2]>32||(s=a,(0|(n=h[t+12>>2]))<=(0|(s=(a=o+8|0)>>>0<8?s+1|0:s))&a>>>0>p[t+8>>2]|(0|n)<(0|s))))){if(i=l+h[t>>2]|0,s=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[e+4>>2]=s,i=h[t+20>>2],i=(a=h[t+16>>2]+4|0)>>>0<4?i+1|0:i,h[t+16>>2]=a,h[t+20>>2]=i,!s)return 1;if(i=0,h[e+8>>2]=0,ot(e+16|0,t)&&Tt(e+544|0,t)&&Tt(e+564|0,t)&&Tt(e+584|0,t)){E=h[e+4>>2],a=r,r=0,t=0,N=n=N-32|0,s=e,i=h[e+12>>2],h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;e:{t:{if(i){if(i>>>0>=1073741824)break t;r=mi(e=i<<2),h[n+8>>2]=r,t=e+r|0,h[n+16>>2]=t,St(r,0,e),h[n+12>>2]=t}e=h[s+628>>2],(o=h[e>>2])&&(h[e+4>>2]=o,ve(o),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,i=h[s+12>>2],r=h[n+8>>2],t=h[n+12>>2]),h[e+4>>2]=t,h[e>>2]=r,h[e+8>>2]=h[n+16>>2],r=0,h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,o=0;r:{if(i){if(i>>>0>=1073741824)break r;o=mi(e=i<<2),h[n+8>>2]=o,r=e+o|0,h[n+16>>2]=r,St(o,0,e),h[n+12>>2]=r}e=h[s+640>>2],(t=h[e>>2])&&(h[e+4>>2]=t,ve(t),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,o=h[n+8>>2],r=h[n+12>>2]),h[e+4>>2]=r,h[e>>2]=o,h[e+8>>2]=h[n+16>>2],h[n+24>>2]=0,h[n+28>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,Qe(n+8|0),t=((e=h[n+24>>2]+h[n+28>>2]|0)>>>0)/341|0,e=h[h[n+12>>2]+(t<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=E,t=1,i=(e=h[n+28>>2])+1|0,h[n+28>>2]=i;i:if(!(e>>>0>i>>>0)){for(;;){if(f=h[n+12>>2],t=h[n+24>>2],e=h[f+((r=((e=t+(o=i-1|0)|0)>>>0)/341|0)<<2)>>2]+v(e-v(r,341)|0,12)|0,c=h[e+8>>2],r=h[e+4>>2],l=h[e>>2],h[n+28>>2]=o,1+(((o=(e=h[n+16>>2])-f|0)?v(o>>2,341)-1|0:0)-(t+i|0)|0)>>>0>=682&&(ve(h[e-4>>2]),h[n+16>>2]=h[n+16>>2]-4),t=0,l>>>0>E>>>0)break i;if((o=((e=h[s+12>>2])-1|0)==(0|r)?0:r+1|0)>>>0>=e>>>0)break i;m=(u=v(c,12))+h[s+640>>2]|0,f=u+h[s+628>>2]|0;n:{s:if(_=o<<2,r=h[s>>2]-h[_+h[m>>2]>>2]|0){o:{a:{l:{c:{if(l>>>0<=2){if(e=h[s+616>>2],h[e>>2]=o,r=1,(i=h[s+12>>2])>>>0>1)break c;break o}if(p[s+8>>2]>p[s+4>>2])break i;if((0|(t=(e=h[s+628>>2])+(m=v(g=c+1|0,12))|0))!=(0|f)&&(Ft(t,h[f>>2],h[f+4>>2]),e=h[s+628>>2]),e=_+h[e+m>>2]|0,h[e>>2]=h[e>>2]+(1<<r-1),r=0,i=0,e=31^y(l))for(;r=Br(16+((i<<4)+s|0)|0)|r<<1,(0|e)!=(0|(i=i+1|0)););if((0|(i=l-(e=(l>>>1|0)-r|0)|0))!=(0|e)){if((0|(t=h[s+596>>2]))==h[s+588>>2])break l;r=h[t>>2],f=(l=h[s+600>>2])+1|0,h[s+600>>2]=f,r&=-2147483648>>>l;u:{if(32==(0|f)){if(h[s+600>>2]=0,h[s+596>>2]=t+4,r)break u;break l}if(!r)break l}t=i}else t=e;i=e;break a}for(;o=(i-1|0)==(0|o)?0:o+1|0,h[e+(r<<2)>>2]=o,(r=r+1|0)>>>0<(i=h[s+12>>2])>>>0;);break o}t=e}if(e=h[s+640>>2],l=h[(r=e+u|0)>>2],h[(f=l+_|0)>>2]=h[f>>2]+1,Ft(e+m|0,l,h[r+4>>2]),i&&(r=h[n+28>>2]+h[n+24>>2]|0,e=h[n+12>>2],(0|r)==(0|((l=h[n+16>>2]-e|0)?v(l>>2,341)-1|0:0))?(Qe(n+8|0),r=h[n+24>>2]+h[n+28>>2]|0,l=h[n+12>>2]):l=e,e=h[l+((e=(r>>>0)/341|0)<<2)>>2]+v(r-v(e,341)|0,12)|0,h[e+8>>2]=c,h[e+4>>2]=o,h[e>>2]=i,h[n+28>>2]=h[n+28>>2]+1),!t)break s;i=h[n+28>>2]+h[n+24>>2]|0,r=h[n+12>>2],(0|i)==(0|((e=h[n+16>>2]-r|0)?v(e>>2,341)-1|0:0))&&(Qe(n+8|0),i=h[n+24>>2]+h[n+28>>2]|0,r=h[n+12>>2]),e=h[r+((e=(i>>>0)/341|0)<<2)>>2]+v(i-v(e,341)|0,12)|0,h[e+8>>2]=g,h[e+4>>2]=o,h[e>>2]=t,i=h[n+28>>2]+1|0,h[n+28>>2]=i;break n}if(_=0,l)for(;;){if(i)for(o=h[s+548>>2],r=h[s+604>>2],x=h[s+616>>2],A=h[f>>2],T=h[m>>2],i=0;;){h[r+(h[(c=(i<<2)+x|0)>>2]<<2)>>2]=0,t=h[c>>2]<<2;o:if(e=h[s>>2]-h[t+T>>2]|0)if(t=t+r|0,(0|(b=32-(u=h[s+560>>2])|0))>=(0|e)){if((0|(g=h[s+556>>2]))==(0|o)){h[t>>2]=0;break o}if(h[t>>2]=h[g>>2]<<u>>>32-e,e=e+h[s+560>>2]|0,h[s+560>>2]=e,32!=(0|e))break o;h[s+560>>2]=0,h[s+556>>2]=g+4}else(0|o)!=(0|(w=(g=h[s+556>>2])+4|0))?(M=h[g>>2],h[s+556>>2]=w,b=e-b|0,h[s+560>>2]=b,h[t>>2]=h[g+4>>2]>>>32-b|M<<u>>>32-e):h[t>>2]=0;if(e=h[c>>2]<<2,h[(t=e+r|0)>>2]=h[t>>2]|h[e+A>>2],!((i=i+1|0)>>>0<p[s+12>>2]))break}e=0;o:if((0|(i=h[a+16>>2]))!=h[a+20>>2])for(;;){if(c=v(e,20)+i|0,t=h[s+604>>2]+(h[c+4>>2]<<2)|0,u=h[c>>2],!((o=h[c+12>>2])>>>0>3))if(r=h[a+12>>2],h[c+16>>2]){for(i=0;r=(r=He(r,(i<<2)+t|0,o))+(o=h[c+12>>2])|0,(i=i+1|0)>>>0<p[c+16>>2];);t=h[a+12>>2]}else t=r;if(i=h[a+28>>2],(i=d[u+84|0]?i:h[h[u+68>>2]+(i<<2)>>2])>>>0>=p[u+80>>2])break o;if(r=h[u+40>>2],He(h[h[u>>2]>>2]+v(r,i)|0,t,r),e=e+1|0,i=h[a+16>>2],!(e>>>0<(h[a+20>>2]-i|0)/20>>>0))break}if(h[a+28>>2]=h[a+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|l)==(0|(_=_+1|0)))break s;i=h[s+12>>2]}}else{if(m=0,!l)break s;for(;;){e=0;o:if((0|(i=h[a+16>>2]))!=h[a+20>>2])for(;;){if(c=v(e,20)+i|0,t=h[f>>2]+(h[c+4>>2]<<2)|0,u=h[c>>2],!((o=h[c+12>>2])>>>0>3))if(r=h[a+12>>2],h[c+16>>2]){for(i=0;r=(r=He(r,(i<<2)+t|0,o))+(o=h[c+12>>2])|0,(i=i+1|0)>>>0<p[c+16>>2];);t=h[a+12>>2]}else t=r;if(i=h[a+28>>2],(i=d[u+84|0]?i:h[h[u+68>>2]+(i<<2)>>2])>>>0>=p[u+80>>2])break o;if(r=h[u+40>>2],He(h[h[u>>2]>>2]+v(r,i)|0,t,r),e=e+1|0,i=h[a+16>>2],!(e>>>0<(h[a+20>>2]-i|0)/20>>>0))break}if(h[a+28>>2]=h[a+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|l)==(0|(m=m+1|0)))break}}i=h[n+28>>2]}if(!i)break}t=1}if(h[n+28>>2]=0,(r=(o=h[n+16>>2])-(i=h[n+12>>2])|0)>>>0>=9)for(;ve(h[i>>2]),i=h[n+12>>2]+4|0,h[n+12>>2]=i,(r=(o=h[n+16>>2])-i|0)>>>0>8;);switch(e=170,(r>>>2|0)-1|0){case 1:e=341;case 0:h[n+24>>2]=e}if((0|i)!=(0|o)){for(;ve(h[i>>2]),(0|o)!=(0|(i=i+4|0)););(0|(e=h[n+16>>2]))!=(0|(r=h[n+12>>2]))&&(h[n+16>>2]=e+(((e-r|0)-4>>>2^-1)<<2))}(e=h[n+8>>2])&&ve(e),N=n+32|0;break e}vn(),S()}vn(),S()}i=t}}return i}function $(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0;if(s=h[t+12>>2],n=h[t+20>>2],n=(i=(l=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,!(i>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s)||(n=l+h[t>>2]|0,h[e>>2]=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,s=n=h[t+20>>2],n=(l=(i=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,u=l,h[t+16>>2]=l,h[t+20>>2]=n,p[e>>2]>32||(l=h[t+12>>2],n=s,n=(s=i+8|0)>>>0<8?n+1|0:n,s>>>0>p[t+8>>2]&(0|n)>=(0|l)|(0|n)>(0|l))))){if(n=u+h[t>>2]|0,a=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[e+4>>2]=a,n=h[t+20>>2],n=(s=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=s,h[t+20>>2]=n,!a)return 1;if(a=0,h[e+8>>2]=0,ze(e+16|0,t)&&Tt(e+32|0,t)&&Tt(e+52|0,t)&&Tt(e+72|0,t)){b=h[e+4>>2],l=r,t=0,r=0,N=i=N-32|0,s=e,e=h[e+12>>2],h[i+16>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0;e:{t:{if(e){if(e>>>0>=1073741824)break t;t=mi(n=e<<2),h[i+8>>2]=t,r=t+n|0,h[i+16>>2]=r,St(t,0,n),h[i+12>>2]=r}n=h[s+116>>2],(a=h[n>>2])&&(h[n+4>>2]=a,ve(a),h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,r=h[i+12>>2],t=h[i+8>>2],e=h[s+12>>2]),h[n+4>>2]=r,h[n>>2]=t,h[n+8>>2]=h[i+16>>2],t=0,h[i+16>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0;r:{if(e){if(e>>>0>=1073741824)break r;o=mi(e<<=2),h[i+8>>2]=o,t=e+o|0,h[i+16>>2]=t,St(o,0,e),h[i+12>>2]=t}e=h[s+128>>2],(r=h[e>>2])&&(h[e+4>>2]=r,ve(r),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,o=h[i+8>>2],t=h[i+12>>2]),h[e+4>>2]=t,h[e>>2]=o,h[e+8>>2]=h[i+16>>2],h[i+24>>2]=0,h[i+28>>2]=0,h[i+16>>2]=0,h[i+20>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0,Qe(i+8|0),t=((e=h[i+24>>2]+h[i+28>>2]|0)>>>0)/341|0,e=h[h[i+12>>2]+(t<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=b,n=1,e=(t=h[i+28>>2])+1|0,h[i+28>>2]=e;i:if(!(e>>>0<t>>>0)){for(x=s+16|0;;){if(c=h[i+12>>2],n=h[i+24>>2],t=h[c+((r=((t=n+(o=e-1|0)|0)>>>0)/341|0)<<2)>>2]+v(t-v(r,341)|0,12)|0,r=h[t+8>>2],a=h[t+4>>2],u=h[t>>2],h[i+28>>2]=o,1+(((o=(t=h[i+16>>2])-c|0)?v(o>>2,341)-1|0:0)-(e+n|0)|0)>>>0>=682&&(ve(h[t-4>>2]),h[i+16>>2]=h[i+16>>2]-4),u>>>0>b>>>0){n=0;break i}if(n=0,(o=(0|a)==((e=h[s+12>>2])-1|0)?0:a+1|0)>>>0>=e>>>0)break i;g=(e=h[s+116>>2])+(t=v(r,12))|0;n:{if(c=o<<2,E=t+h[s+128>>2]|0,!(a=h[s>>2]-h[c+h[E>>2]>>2]|0)){if(!u)break n;if((0|(e=h[l+16>>2]))==(0|(o=h[l+20>>2]))){e=h[s+8>>2],h[l+28>>2]=u+h[l+28>>2],h[s+8>>2]=e+u;break n}for(;;){a=0;s:if((0|e)!=(0|o))for(;;){if(c=v(a,20)+e|0,r=h[g>>2]+(h[c+4>>2]<<2)|0,f=h[c>>2],!((o=h[c+12>>2])>>>0>3))if(t=h[l+12>>2],h[c+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,o))+(o=h[c+12>>2])|0,(e=e+1|0)>>>0<p[c+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[f+84|0]?e:h[h[f+68>>2]+(e<<2)>>2])>>>0>=p[f+80>>2])break s;if(t=e,e=h[f+40>>2],He(h[h[f>>2]>>2]+v(t,e)|0,r,e),a=a+1|0,e=h[l+16>>2],!(a>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|u)==(0|(n=n+1|0)))break n;e=h[l+16>>2],o=h[l+20>>2]}}s:{o:{a:{l:{if(u>>>0<=2){if(r=h[s+104>>2],h[r>>2]=o,t=1,(e=h[s+12>>2])>>>0>1)break l;break s}if(p[s+8>>2]>p[s+4>>2])break i;if(Ft((n=e)+(e=t+12|0)|0,h[g>>2],h[g+4>>2]),e=c+h[e+h[s+116>>2]>>2]|0,h[e>>2]=h[e>>2]+(1<<a-1),h[i+4>>2]=0,mr(x,31^y(u),i+4|0),f=r+1|0,(0|(n=u-(e=(u>>>1|0)-h[i+4>>2]|0)|0))!=(0|e)){if((0|(a=h[s+84>>2]))==h[s+76>>2])break a;u=h[a>>2],m=(g=h[s+88>>2])+1|0,h[s+88>>2]=m,u&=-2147483648>>>g;c:{if(32==(0|m)){if(h[s+88>>2]=0,h[s+84>>2]=a+4,u)break c;break a}if(!u)break a}}else n=e;a=n,n=e;break o}for(;o=(e-1|0)==(0|o)?0:o+1|0,h[r+(t<<2)>>2]=o,(e=h[s+12>>2])>>>0>(t=t+1|0)>>>0;);break s}a=e}if(e=h[s+128>>2],u=h[(t=e+t|0)>>2],h[(c=u+c|0)>>2]=h[c>>2]+1,Ft(e+v(f,12)|0,u,h[t+4>>2]),n&&(e=h[i+28>>2]+h[i+24>>2]|0,t=h[i+12>>2],(0|e)==(0|((u=h[i+16>>2]-t|0)?v(u>>2,341)-1|0:0))&&(Qe(i+8|0),t=h[i+12>>2],e=h[i+24>>2]+h[i+28>>2]|0),e=h[(u=t)+((t=(e>>>0)/341|0)<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+8>>2]=r,h[e+4>>2]=o,h[e>>2]=n,h[i+28>>2]=h[i+28>>2]+1),!a)break n;e=h[i+28>>2]+h[i+24>>2]|0,t=h[i+12>>2],(0|e)==(0|((r=h[i+16>>2]-t|0)?v(r>>2,341)-1|0:0))&&(Qe(i+8|0),t=h[i+12>>2],e=h[i+24>>2]+h[i+28>>2]|0),e=h[(r=t)+((t=(e>>>0)/341|0)<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+8>>2]=f,h[e+4>>2]=o,h[e>>2]=a,h[i+28>>2]=h[i+28>>2]+1;break n}if(u)for(;;){if(e)for(o=h[s+36>>2],a=h[s+92>>2],A=h[s+104>>2],T=h[g>>2],M=h[E>>2],e=0;;){h[a+(h[(c=(e<<2)+A|0)>>2]<<2)>>2]=0,r=h[c>>2]<<2;s:if(t=h[s>>2]-h[r+M>>2]|0)if(r=r+a|0,(0|(_=32-(f=h[s+48>>2])|0))>=(0|t)){if((0|(m=h[s+44>>2]))==(0|o)){h[r>>2]=0;break s}if(h[r>>2]=h[m>>2]<<f>>>32-t,t=t+h[s+48>>2]|0,h[s+48>>2]=t,32!=(0|t))break s;h[s+48>>2]=0,h[s+44>>2]=m+4}else(0|o)!=(0|(w=(m=h[s+44>>2])+4|0))?(C=h[m>>2],h[s+44>>2]=w,_=t-_|0,h[s+48>>2]=_,h[r>>2]=h[m+4>>2]>>>32-_|C<<f>>>32-t):h[r>>2]=0;if(t=h[c>>2]<<2,h[(r=t+a|0)>>2]=h[r>>2]|h[t+T>>2],!((e=e+1|0)>>>0<p[s+12>>2]))break}a=0;s:if((0|(e=h[l+16>>2]))!=h[l+20>>2])for(;;){if(c=v(a,20)+e|0,r=h[s+92>>2]+(h[c+4>>2]<<2)|0,f=h[c>>2],!((o=h[c+12>>2])>>>0>3))if(t=h[l+12>>2],h[c+16>>2]){for(e=0;t=(t=He(t,(e<<2)+r|0,o))+(o=h[c+12>>2])|0,(e=e+1|0)>>>0<p[c+16>>2];);r=h[l+12>>2]}else r=t;if(e=h[l+28>>2],(e=d[f+84|0]?e:h[h[f+68>>2]+(e<<2)>>2])>>>0>=p[f+80>>2])break s;if(t=e,e=h[f+40>>2],He(h[h[f>>2]>>2]+v(t,e)|0,r,e),a=a+1|0,e=h[l+16>>2],!(a>>>0<(h[l+20>>2]-e|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|u)==(0|(n=n+1|0)))break n;e=h[s+12>>2]}}if(!(e=h[i+28>>2]))break}n=1}if(h[i+28>>2]=0,(t=(o=h[i+16>>2])-(e=h[i+12>>2])|0)>>>0>=9)for(;ve(h[e>>2]),e=h[i+12>>2]+4|0,h[i+12>>2]=e,(t=(o=h[i+16>>2])-e|0)>>>0>8;);switch(r=170,(t>>>2|0)-1|0){case 1:r=341;case 0:h[i+24>>2]=r}if((0|e)!=(0|o)){for(;ve(h[e>>2]),(0|o)!=(0|(e=e+4|0)););(0|(e=h[i+16>>2]))!=(0|(t=h[i+12>>2]))&&(h[i+16>>2]=e+(((e-t|0)-4>>>2^-1)<<2))}(e=h[i+8>>2])&&ve(e),N=i+32|0;break e}vn(),S()}vn(),S()}a=n}}return a}function Y(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0;if(o=h[t+12>>2],s=h[t+20>>2],!((0|o)<=(0|(s=(n=(l=h[t+16>>2])+4|0)>>>0<4?s+1|0:s))&n>>>0>p[t+8>>2]|(0|o)<(0|s)||(s=l+h[t>>2]|0,h[e>>2]=d[0|s]|d[s+1|0]<<8|d[s+2|0]<<16|d[s+3|0]<<24,o=s=h[t+20>>2],s=(l=(n=h[t+16>>2])+4|0)>>>0<4?o+1|0:o,c=l,h[t+16>>2]=l,h[t+20>>2]=s,p[e>>2]>32||(l=h[t+12>>2],s=o,s=(o=n+8|0)>>>0<8?s+1|0:s,o>>>0>p[t+8>>2]&(0|s)>=(0|l)|(0|s)>(0|l))))){if(i=c+h[t>>2]|0,s=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[e+4>>2]=s,i=h[t+20>>2],i=(o=h[t+16>>2]+4|0)>>>0<4?i+1|0:i,h[t+16>>2]=o,h[t+20>>2]=i,!s)return 1;if(i=0,h[e+8>>2]=0,ot(e+16|0,t)&&Tt(e+544|0,t)&&Tt(e+564|0,t)&&Tt(e+584|0,t)){b=h[e+4>>2],l=r,t=0,r=0,N=n=N-32|0,o=e,i=h[e+12>>2],h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;e:{t:{if(i){if(i>>>0>=1073741824)break t;t=mi(e=i<<2),h[n+8>>2]=t,r=e+t|0,h[n+16>>2]=r,St(t,0,e),h[n+12>>2]=r}e=h[o+628>>2],(s=h[e>>2])&&(h[e+4>>2]=s,ve(s),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,i=h[o+12>>2],r=h[n+12>>2],t=h[n+8>>2]),h[e+4>>2]=r,h[e>>2]=t,h[e+8>>2]=h[n+16>>2],t=0,h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;r:{if(i){if(i>>>0>=1073741824)break r;a=mi(e=i<<2),h[n+8>>2]=a,t=e+a|0,h[n+16>>2]=t,St(a,0,e),h[n+12>>2]=t}e=h[o+640>>2],(r=h[e>>2])&&(h[e+4>>2]=r,ve(r),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,a=h[n+8>>2],t=h[n+12>>2]),h[e+4>>2]=t,h[e>>2]=a,h[e+8>>2]=h[n+16>>2],h[n+24>>2]=0,h[n+28>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,Qe(n+8|0),t=((e=h[n+24>>2]+h[n+28>>2]|0)>>>0)/341|0,e=h[h[n+12>>2]+(t<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=b,r=1,i=(e=h[n+28>>2])+1|0,h[n+28>>2]=i;i:if(!(e>>>0>i>>>0)){for(;;){if(a=h[n+12>>2],r=h[n+24>>2],e=h[a+((t=((e=r+(s=i-1|0)|0)>>>0)/341|0)<<2)>>2]+v(e-v(t,341)|0,12)|0,f=h[e+8>>2],t=h[e+4>>2],c=h[e>>2],h[n+28>>2]=s,1+(((s=(e=h[n+16>>2])-a|0)?v(s>>2,341)-1|0:0)-(r+i|0)|0)>>>0>=682&&(ve(h[e-4>>2]),h[n+16>>2]=h[n+16>>2]-4),c>>>0>b>>>0){r=0;break i}if(r=0,(a=(0|t)==((e=h[o+12>>2])-1|0)?0:t+1|0)>>>0>=e>>>0)break i;g=(e=h[o+628>>2])+(u=v(f,12))|0;n:{s:if(m=a<<2,E=u+h[o+640>>2]|0,t=h[o>>2]-h[m+h[E>>2]>>2]|0){o:{a:{l:{c:{if(c>>>0<=2){if(e=h[o+616>>2],h[e>>2]=a,t=1,(i=h[o+12>>2])>>>0>1)break c;break o}if(p[o+8>>2]>p[o+4>>2])break i;if(Ft((r=e)+(e=u+12|0)|0,h[g>>2],h[g+4>>2]),e=m+h[e+h[o+628>>2]>>2]|0,h[e>>2]=h[e>>2]+(1<<t-1),t=0,i=0,e=31^y(c))for(;t=Br(16+((i<<4)+o|0)|0)|t<<1,(0|e)!=(0|(i=i+1|0)););if(r=f+1|0,(0|(i=c-(e=(c>>>1|0)-t|0)|0))!=(0|e)){if((0|(t=h[o+596>>2]))==h[o+588>>2])break l;s=h[t>>2],g=(c=h[o+600>>2])+1|0,h[o+600>>2]=g,s&=-2147483648>>>c;u:{if(32==(0|g)){if(h[o+600>>2]=0,h[o+596>>2]=t+4,s)break u;break l}if(!s)break l}}else i=e;s=i,i=e;break a}for(;a=(i-1|0)==(0|a)?0:a+1|0,h[e+(t<<2)>>2]=a,(t=t+1|0)>>>0<(i=h[o+12>>2])>>>0;);break o}s=e}if(e=h[o+640>>2],c=h[(t=e+u|0)>>2],h[(u=c+m|0)>>2]=h[u>>2]+1,Ft(e+v(r,12)|0,c,h[t+4>>2]),i&&(t=h[n+28>>2]+h[n+24>>2]|0,e=h[n+12>>2],(0|t)==(0|((c=h[n+16>>2]-e|0)?v(c>>2,341)-1|0:0))?(Qe(n+8|0),t=h[n+24>>2]+h[n+28>>2]|0,c=h[n+12>>2]):c=e,e=h[c+((e=(t>>>0)/341|0)<<2)>>2]+v(t-v(e,341)|0,12)|0,h[e+8>>2]=f,h[e+4>>2]=a,h[e>>2]=i,h[n+28>>2]=h[n+28>>2]+1),!s)break s;i=h[n+28>>2]+h[n+24>>2]|0,t=h[n+12>>2],(0|i)==(0|((e=h[n+16>>2]-t|0)?v(e>>2,341)-1|0:0))&&(Qe(n+8|0),i=h[n+24>>2]+h[n+28>>2]|0,t=h[n+12>>2]),e=h[t+((e=(i>>>0)/341|0)<<2)>>2]+v(i-v(e,341)|0,12)|0,h[e+8>>2]=r,h[e+4>>2]=a,h[e>>2]=s,i=h[n+28>>2]+1|0,h[n+28>>2]=i;break n}if(e=0,c)for(;;){if(i)for(a=h[o+548>>2],s=h[o+604>>2],x=h[o+616>>2],A=h[g>>2],T=h[E>>2],i=0;;){h[s+(h[(f=(i<<2)+x|0)>>2]<<2)>>2]=0,r=h[f>>2]<<2;o:if(t=h[o>>2]-h[r+T>>2]|0)if(r=r+s|0,(0|(_=32-(u=h[o+560>>2])|0))>=(0|t)){if((0|(m=h[o+556>>2]))==(0|a)){h[r>>2]=0;break o}if(h[r>>2]=h[m>>2]<<u>>>32-t,t=t+h[o+560>>2]|0,h[o+560>>2]=t,32!=(0|t))break o;h[o+560>>2]=0,h[o+556>>2]=m+4}else(0|a)!=(0|(w=(m=h[o+556>>2])+4|0))?(M=h[m>>2],h[o+556>>2]=w,_=t-_|0,h[o+560>>2]=_,h[r>>2]=h[m+4>>2]>>>32-_|M<<u>>>32-t):h[r>>2]=0;if(t=h[f>>2]<<2,h[(r=t+s|0)>>2]=h[r>>2]|h[t+A>>2],!((i=i+1|0)>>>0<p[o+12>>2]))break}s=0;o:if((0|(i=h[l+16>>2]))!=h[l+20>>2])for(;;){if(f=v(s,20)+i|0,r=h[o+604>>2]+(h[f+4>>2]<<2)|0,u=h[f>>2],!((a=h[f+12>>2])>>>0>3))if(t=h[l+12>>2],h[f+16>>2]){for(i=0;t=(t=He(t,(i<<2)+r|0,a))+(a=h[f+12>>2])|0,(i=i+1|0)>>>0<p[f+16>>2];);r=h[l+12>>2]}else r=t;if(i=h[l+28>>2],(i=d[u+84|0]?i:h[h[u+68>>2]+(i<<2)>>2])>>>0>=p[u+80>>2])break o;if(t=h[u+40>>2],He(h[h[u>>2]>>2]+v(t,i)|0,r,t),s=s+1|0,i=h[l+16>>2],!(s>>>0<(h[l+20>>2]-i|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[o+8>>2]=h[o+8>>2]+1,(0|c)==(0|(e=e+1|0)))break s;i=h[o+12>>2]}}else{if(e=0,!c)break s;for(;;){s=0;o:if((0|(i=h[l+16>>2]))!=h[l+20>>2])for(;;){if(f=v(s,20)+i|0,r=h[g>>2]+(h[f+4>>2]<<2)|0,u=h[f>>2],!((a=h[f+12>>2])>>>0>3))if(t=h[l+12>>2],h[f+16>>2]){for(i=0;t=(t=He(t,(i<<2)+r|0,a))+(a=h[f+12>>2])|0,(i=i+1|0)>>>0<p[f+16>>2];);r=h[l+12>>2]}else r=t;if(i=h[l+28>>2],(i=d[u+84|0]?i:h[h[u+68>>2]+(i<<2)>>2])>>>0>=p[u+80>>2])break o;if(t=h[u+40>>2],He(h[h[u>>2]>>2]+v(t,i)|0,r,t),s=s+1|0,i=h[l+16>>2],!(s>>>0<(h[l+20>>2]-i|0)/20>>>0))break}if(h[l+28>>2]=h[l+28>>2]+1,h[o+8>>2]=h[o+8>>2]+1,(0|c)==(0|(e=e+1|0)))break}}i=h[n+28>>2]}if(!i)break}r=1}if(h[n+28>>2]=0,(t=(a=h[n+16>>2])-(i=h[n+12>>2])|0)>>>0>=9)for(;ve(h[i>>2]),i=h[n+12>>2]+4|0,h[n+12>>2]=i,(t=(a=h[n+16>>2])-i|0)>>>0>8;);switch(e=170,(t>>>2|0)-1|0){case 1:e=341;case 0:h[n+24>>2]=e}if((0|i)!=(0|a)){for(;ve(h[i>>2]),(0|a)!=(0|(i=i+4|0)););(0|(e=h[n+16>>2]))!=(0|(t=h[n+12>>2]))&&(h[n+16>>2]=e+(((e-t|0)-4>>>2^-1)<<2))}(e=h[n+8>>2])&&ve(e),N=n+32|0;break e}vn(),S()}vn(),S()}i=r}}return i}function q(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,_=0,b=0,E=0,w=0,x=0,A=0,T=0,M=0;if(a=h[t+12>>2],s=h[t+20>>2],s=(o=(n=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,!(o>>>0>p[t+8>>2]&(0|s)>=(0|a)|(0|s)>(0|a)||(s=n+h[t>>2]|0,h[e>>2]=d[0|s]|d[s+1|0]<<8|d[s+2|0]<<16|d[s+3|0]<<24,a=s=h[t+20>>2],s=(n=(o=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,l=n,h[t+16>>2]=n,h[t+20>>2]=s,p[e>>2]>32||(s=a,(0|(n=h[t+12>>2]))<=(0|(s=(a=o+8|0)>>>0<8?s+1|0:s))&a>>>0>p[t+8>>2]|(0|n)<(0|s))))){if(i=l+h[t>>2]|0,s=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[e+4>>2]=s,i=h[t+20>>2],i=(a=h[t+16>>2]+4|0)>>>0<4?i+1|0:i,h[t+16>>2]=a,h[t+20>>2]=i,!s)return 1;if(i=0,h[e+8>>2]=0,ot(e+16|0,t)&&Tt(e+544|0,t)&&Tt(e+564|0,t)&&Tt(e+584|0,t)){E=h[e+4>>2],a=r,r=0,t=0,N=n=N-32|0,s=e,i=h[e+12>>2],h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0;e:{t:{if(i){if(i>>>0>=1073741824)break t;r=mi(e=i<<2),h[n+8>>2]=r,t=e+r|0,h[n+16>>2]=t,St(r,0,e),h[n+12>>2]=t}e=h[s+628>>2],(o=h[e>>2])&&(h[e+4>>2]=o,ve(o),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,i=h[s+12>>2],r=h[n+8>>2],t=h[n+12>>2]),h[e+4>>2]=t,h[e>>2]=r,h[e+8>>2]=h[n+16>>2],r=0,h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,o=0;r:{if(i){if(i>>>0>=1073741824)break r;o=mi(e=i<<2),h[n+8>>2]=o,r=e+o|0,h[n+16>>2]=r,St(o,0,e),h[n+12>>2]=r}e=h[s+640>>2],(t=h[e>>2])&&(h[e+4>>2]=t,ve(t),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,o=h[n+8>>2],r=h[n+12>>2]),h[e+4>>2]=r,h[e>>2]=o,h[e+8>>2]=h[n+16>>2],h[n+24>>2]=0,h[n+28>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,Qe(n+8|0),t=((e=h[n+24>>2]+h[n+28>>2]|0)>>>0)/341|0,e=h[h[n+12>>2]+(t<<2)>>2]+v(e-v(t,341)|0,12)|0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=E,t=1,i=(e=h[n+28>>2])+1|0,h[n+28>>2]=i;i:if(!(e>>>0>i>>>0)){for(;;){if(f=h[n+12>>2],e=h[n+24>>2],r=h[f+((o=((r=e+(t=i-1|0)|0)>>>0)/341|0)<<2)>>2]+v(r-v(o,341)|0,12)|0,c=h[r+8>>2],l=h[r>>2],h[n+28>>2]=t,1+(((r=(t=h[n+16>>2])-f|0)?v(r>>2,341)-1|0:0)-(e+i|0)|0)>>>0>=682&&(ve(h[t-4>>2]),h[n+16>>2]=h[n+16>>2]-4),t=0,l>>>0>E>>>0)break i;if(e=h[s+628>>2],(o=ft(s,l,m=(u=v(c,12))+h[s+640>>2]|0))>>>0>=p[s+12>>2])break i;f=e+u|0;n:{s:if(_=o<<2,r=h[s>>2]-h[_+h[m>>2]>>2]|0){o:{a:{l:{c:{if(l>>>0<=2){if(e=h[s+616>>2],h[e>>2]=o,r=1,(i=h[s+12>>2])>>>0>1)break c;break o}if(p[s+8>>2]>p[s+4>>2])break i;if((0|(t=(e=h[s+628>>2])+(m=v(g=c+1|0,12))|0))!=(0|f)&&(Ft(t,h[f>>2],h[f+4>>2]),e=h[s+628>>2]),e=_+h[e+m>>2]|0,h[e>>2]=h[e>>2]+(1<<r-1),r=0,i=0,e=31^y(l))for(;r=Br(16+((i<<4)+s|0)|0)|r<<1,(0|e)!=(0|(i=i+1|0)););if((0|(i=l-(e=(l>>>1|0)-r|0)|0))!=(0|e)){if((0|(t=h[s+596>>2]))==h[s+588>>2])break l;r=h[t>>2],f=(l=h[s+600>>2])+1|0,h[s+600>>2]=f,r&=-2147483648>>>l;u:{if(32==(0|f)){if(h[s+600>>2]=0,h[s+596>>2]=t+4,r)break u;break l}if(!r)break l}t=i}else t=e;i=e;break a}for(;o=(i-1|0)==(0|o)?0:o+1|0,h[e+(r<<2)>>2]=o,(r=r+1|0)>>>0<(i=h[s+12>>2])>>>0;);break o}t=e}if(e=h[s+640>>2],l=h[(r=e+u|0)>>2],h[(f=l+_|0)>>2]=h[f>>2]+1,Ft(e+m|0,l,h[r+4>>2]),i&&(r=h[n+28>>2]+h[n+24>>2]|0,e=h[n+12>>2],(0|r)==(0|((l=h[n+16>>2]-e|0)?v(l>>2,341)-1|0:0))?(Qe(n+8|0),r=h[n+24>>2]+h[n+28>>2]|0,l=h[n+12>>2]):l=e,e=h[l+((e=(r>>>0)/341|0)<<2)>>2]+v(r-v(e,341)|0,12)|0,h[e+8>>2]=c,h[e+4>>2]=o,h[e>>2]=i,h[n+28>>2]=h[n+28>>2]+1),!t)break s;i=h[n+28>>2]+h[n+24>>2]|0,r=h[n+12>>2],(0|i)==(0|((e=h[n+16>>2]-r|0)?v(e>>2,341)-1|0:0))&&(Qe(n+8|0),i=h[n+24>>2]+h[n+28>>2]|0,r=h[n+12>>2]),e=h[r+((e=(i>>>0)/341|0)<<2)>>2]+v(i-v(e,341)|0,12)|0,h[e+8>>2]=g,h[e+4>>2]=o,h[e>>2]=t,i=h[n+28>>2]+1|0,h[n+28>>2]=i;break n}if(_=0,l)for(;;){if(i)for(o=h[s+548>>2],r=h[s+604>>2],x=h[s+616>>2],A=h[f>>2],T=h[m>>2],i=0;;){h[r+(h[(c=(i<<2)+x|0)>>2]<<2)>>2]=0,t=h[c>>2]<<2;o:if(e=h[s>>2]-h[t+T>>2]|0)if(t=t+r|0,(0|(b=32-(u=h[s+560>>2])|0))>=(0|e)){if((0|(g=h[s+556>>2]))==(0|o)){h[t>>2]=0;break o}if(h[t>>2]=h[g>>2]<<u>>>32-e,e=e+h[s+560>>2]|0,h[s+560>>2]=e,32!=(0|e))break o;h[s+560>>2]=0,h[s+556>>2]=g+4}else(0|o)!=(0|(w=(g=h[s+556>>2])+4|0))?(M=h[g>>2],h[s+556>>2]=w,b=e-b|0,h[s+560>>2]=b,h[t>>2]=h[g+4>>2]>>>32-b|M<<u>>>32-e):h[t>>2]=0;if(e=h[c>>2]<<2,h[(t=e+r|0)>>2]=h[t>>2]|h[e+A>>2],!((i=i+1|0)>>>0<p[s+12>>2]))break}e=0;o:if((0|(i=h[a+16>>2]))!=h[a+20>>2])for(;;){if(c=v(e,20)+i|0,t=h[s+604>>2]+(h[c+4>>2]<<2)|0,u=h[c>>2],!((o=h[c+12>>2])>>>0>3))if(r=h[a+12>>2],h[c+16>>2]){for(i=0;r=(r=He(r,(i<<2)+t|0,o))+(o=h[c+12>>2])|0,(i=i+1|0)>>>0<p[c+16>>2];);t=h[a+12>>2]}else t=r;if(i=h[a+28>>2],(i=d[u+84|0]?i:h[h[u+68>>2]+(i<<2)>>2])>>>0>=p[u+80>>2])break o;if(r=h[u+40>>2],He(h[h[u>>2]>>2]+v(r,i)|0,t,r),e=e+1|0,i=h[a+16>>2],!(e>>>0<(h[a+20>>2]-i|0)/20>>>0))break}if(h[a+28>>2]=h[a+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|l)==(0|(_=_+1|0)))break s;i=h[s+12>>2]}}else{if(m=0,!l)break s;for(;;){e=0;o:if((0|(i=h[a+16>>2]))!=h[a+20>>2])for(;;){if(c=v(e,20)+i|0,t=h[f>>2]+(h[c+4>>2]<<2)|0,u=h[c>>2],!((o=h[c+12>>2])>>>0>3))if(r=h[a+12>>2],h[c+16>>2]){for(i=0;r=(r=He(r,(i<<2)+t|0,o))+(o=h[c+12>>2])|0,(i=i+1|0)>>>0<p[c+16>>2];);t=h[a+12>>2]}else t=r;if(i=h[a+28>>2],(i=d[u+84|0]?i:h[h[u+68>>2]+(i<<2)>>2])>>>0>=p[u+80>>2])break o;if(r=h[u+40>>2],He(h[h[u>>2]>>2]+v(r,i)|0,t,r),e=e+1|0,i=h[a+16>>2],!(e>>>0<(h[a+20>>2]-i|0)/20>>>0))break}if(h[a+28>>2]=h[a+28>>2]+1,h[s+8>>2]=h[s+8>>2]+1,(0|l)==(0|(m=m+1|0)))break}}i=h[n+28>>2]}if(!i)break}t=1}if(h[n+28>>2]=0,(r=(o=h[n+16>>2])-(i=h[n+12>>2])|0)>>>0>=9)for(;ve(h[i>>2]),i=h[n+12>>2]+4|0,h[n+12>>2]=i,(r=(o=h[n+16>>2])-i|0)>>>0>8;);switch(e=170,(r>>>2|0)-1|0){case 1:e=341;case 0:h[n+24>>2]=e}if((0|i)!=(0|o)){for(;ve(h[i>>2]),(0|o)!=(0|(i=i+4|0)););(0|(e=h[n+16>>2]))!=(0|(r=h[n+12>>2]))&&(h[n+16>>2]=e+(((e-r|0)-4>>>2^-1)<<2))}(e=h[n+8>>2])&&ve(e),N=n+32|0;break e}vn(),S()}vn(),S()}i=t}}return i}function X(e,t,r,i,n){var o,a,l,c=0,f=0,p=0,m=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,S=0,M=0,C=0,R=0,I=0,O=0;N=o=N-80|0,h[o+76>>2]=t,l=o+55|0,a=o+56|0,t=0;e:{t:{r:{i:{n:for(;;){if((2147483647-E|0)<(0|t))break i;E=t+E|0;s:{o:{a:{if(b=h[o+76>>2],_=d[0|(t=b)])for(;;){l:{c:if(c=255&_){if(37!=(0|c))break l;for(_=t;;){if(37!=d[t+1|0])break c;if(c=t+2|0,h[o+76>>2]=c,_=_+1|0,f=d[t+2|0],t=c,37!=(0|f))break}}else _=t;if((0|(t=_-b|0))>(0|(C=2147483647-E|0)))break i;if(e&&$i(e,b,t),t)continue n;A=-1,c=1,t=h[o+76>>2],s[t+1|0]-48>>>0>=10|36!=d[t+2|0]||(A=s[t+1|0]-48|0,T=1,c=3),t=c+t|0,h[o+76>>2]=t,w=0;c:if((f=(m=s[0|t])-32|0)>>>0>31)c=t;else if(c=t,75913&(p=1<<f))for(;;){if(c=t+1|0,h[o+76>>2]=c,w|=p,(f=(m=s[t+1|0])-32|0)>>>0>=32)break c;if(t=c,!(75913&(p=1<<f)))break}c:if(42!=(0|m)){if((0|(x=zr(o+76|0)))<0)break i;t=h[o+76>>2]}else{if(s[c+1|0]-48>>>0>=10||(t=h[o+76>>2],36!=d[t+2|0])){if(T)break a;T=0,x=0,e&&(t=h[r>>2],h[r>>2]=t+4,x=h[t>>2]),t=h[o+76>>2]+1|0}else h[((s[t+1|0]<<2)+n|0)-192>>2]=10,x=h[((s[t+1|0]<<3)+i|0)-384>>2],T=1,t=t+3|0;if(h[o+76>>2]=t,(0|x)>=0)break c;x=0-x|0,w|=8192}if(c=0,p=-1,f=0,46==d[0|t])if(42!=d[t+1|0])h[o+76>>2]=t+1,p=zr(o+76|0),t=h[o+76>>2],f=1;else{if(s[t+2|0]-48>>>0>=10||(t=h[o+76>>2],36!=d[t+3|0])){if(T)break a;e?(t=h[r>>2],h[r>>2]=t+4,p=h[t>>2]):p=0,t=h[o+76>>2]+2|0}else h[((s[t+2|0]<<2)+n|0)-192>>2]=10,p=h[((s[t+2|0]<<3)+i|0)-384>>2],t=t+4|0;h[o+76>>2]=t,f=(-1^p)>>>31|0}for(S=f;;){if(y=c,_=28,s[0|t]-123>>>0<4294967238)break r;if(m=t+1|0,h[o+76>>2]=m,c=s[0|t],t=m,!((c=d[13743+(c+v(y,58)|0)|0])-1>>>0<8))break}c:{u:{if(27!=(0|c)){if(!c)break r;if((0|A)>=0){h[(A<<2)+n>>2]=c,c=h[4+(t=(A<<3)+i|0)>>2],h[o+64>>2]=h[t>>2],h[o+68>>2]=c;break u}if(!e)break s;xt(o- -64|0,c,r),m=h[o+76>>2];break c}if((0|A)>=0)break r}if(t=0,!e)continue n}f=-65537&w,c=8192&w?f:w,w=0,A=1244,_=a;c:{u:{h:{d:{f:{p:{m:{g:{v:{_:{b:{y:{E:{w:{x:{A:switch(t=s[m-1|0],(t=y&&3==(15&t)?-33&t:t)-88|0){case 11:break c;case 9:case 13:case 14:case 15:break u;case 27:break m;case 12:case 17:break _;case 23:break b;case 0:case 32:break y;case 24:break E;case 22:break w;case 29:break x;case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 10:case 16:case 18:case 19:case 20:case 21:case 25:case 26:case 28:case 30:case 31:break o}switch(t-65|0){case 0:case 4:case 5:case 6:break u;case 2:break f;case 1:case 3:break o}if(83==(0|t))break p;break o}m=h[o+64>>2],f=h[o+68>>2],A=1244;break v}t=0;w:switch(255&y){case 0:case 1:case 6:h[h[o+64>>2]>>2]=E;continue n;case 2:c=h[o+64>>2],h[c>>2]=E,h[c+4>>2]=E>>31;continue n;case 3:u[h[o+64>>2]>>1]=E;continue n;case 4:s[h[o+64>>2]]=E;continue n;case 7:break w;default:continue n}c=h[o+64>>2],h[c>>2]=E,h[c+4>>2]=E>>31;continue n}p=p>>>0>8?p:8,c|=8,t=120}if(y=a,M=32&t,(m=h[o+64>>2])|(f=h[o+68>>2]))for(;s[0|(y=y-1|0)]=M|d[14272+(15&m)|0],R=!f&m>>>0>15|0!=(0|f),b=f,f=f>>>4|0,m=(15&b)<<28|m>>>4,R;);if(b=y,!(h[o+64>>2]|h[o+68>>2])|!(8&c))break g;A=1244+(t>>>4|0)|0,w=2;break g}if(t=a,(m=h[o+64>>2])|(f=h[o+68>>2]))for(;s[0|(t=t-1|0)]=7&m|48,y=!f&m>>>0>7|0!=(0|f),b=f,f=f>>>3|0,m=(7&b)<<29|m>>>3,y;);if(b=t,!(8&c))break g;p=(0|(t=a-b|0))<(0|p)?p:t+1|0;break g}f=t=h[o+68>>2],m=h[o+64>>2],(0|t)<0?(f=0-((0!=(0|m))+f|0)|0,m=0-m|0,h[o+64>>2]=m,h[o+68>>2]=f,w=1,A=1244):2048&c?(w=1,A=1245):A=(w=1&c)?1246:1244}if(b=a,f)for(;I=b=b-1|0,O=m-qr(y=Xe(m,f,10,0),t=G,10,0)|48,s[0|I]=O,M=f>>>0>9,m=y,f=t,M;);else y=m;if(y)for(;t=(y>>>0)/10|0,s[0|(b=b-1|0)]=y-v(t,10)|48,f=y>>>0>9,y=t,f;);}if((0|p)<0&&S)break i;if(c=S?-65537&c:c,!(p|0!=((f=h[o+64>>2])|(t=h[o+68>>2])))){_=b=a,p=0;break o}p=(0|(t=!(t|f)+(a-b|0)|0))<(0|p)?p:t;break o}_=0!=(0|(c=m=(0|p)<0?2147483647:p));m:{g:{v:{_:if(!(!(3&(t=b=(t=h[o+64>>2])||1758))|!c))for(;;){if(!d[0|t])break v;if(_=0!=(0|(c=c-1|0)),!(3&(t=t+1|0)))break _;if(!c)break}if(!_)break g}v:if(!(!d[0|t]|c>>>0<4))for(;;){if((-1^(_=h[t>>2]))&_-16843009&-2139062144)break v;if(t=t+4|0,!((c=c-4|0)>>>0>3))break}if(c)for(;;){if(!d[0|t])break m;if(t=t+1|0,!(c=c-1|0))break}}t=0}if(_=(t=t?t-b|0:m)+b|0,(0|p)>=0){c=f,p=t;break o}if(c=f,p=t,d[0|_])break i;break o}if(p){_=h[o+64>>2];break d}t=0,Jr(e,32,x,0,c);break h}h[o+12>>2]=0,h[o+8>>2]=h[o+64>>2],_=o+8|0,h[o+64>>2]=_,p=-1}t=0;d:{for(;;){if(!(f=h[_>>2]))break d;if(!((b=(0|(f=Kt(o+4|0,f)))<0)|f>>>0>p-t>>>0)){if(_=_+4|0,p>>>0>(t=t+f|0)>>>0)continue;break d}break}if(b)break t}if(_=61,(0|t)<0)break r;if(Jr(e,32,x,t,c),t)for(p=0,_=h[o+64>>2];;){if(!(f=h[_>>2]))break h;if((p=(f=Kt(o+4|0,f))+p|0)>>>0>t>>>0)break h;if($i(e,o+4|0,f),_=_+4|0,!(t>>>0>p>>>0))break}else t=0}Jr(e,32,x,t,8192^c),t=(0|t)<(0|x)?x:t;continue n}if((0|p)<0&&S)break i;if(_=61,(0|(t=0|Cn[0](e,g[o+64>>3],x,p,c,t)))>=0)continue n;break r}s[o+55|0]=h[o+64>>2],p=1,b=l,c=f;break o}c=t+1|0,h[o+76>>2]=c,_=d[t+1|0],t=c}if(e)break e;if(!T)break s;for(t=1;;){if(e=h[(t<<2)+n>>2]){if(xt((t<<3)+i|0,e,r),E=1,10!=(0|(t=t+1|0)))continue;break e}break}if(E=1,t>>>0>=10)break e;for(;;){if(h[(t<<2)+n>>2])break a;if(10==(0|(t=t+1|0)))break}break e}_=28;break r}if((0|(y=(0|p)<(0|(m=_-b|0))?m:p))>(2147483647-w|0))break i;if(_=61,(0|C)<(0|(t=(0|(f=y+w|0))>(0|x)?f:x)))break r;Jr(e,32,t,f,c),$i(e,A,w),Jr(e,48,t,f,65536^c),Jr(e,48,y,m,0),$i(e,b,m),Jr(e,32,t,f,8192^c);continue}break}E=0;break e}_=61}h[4190]=_}E=-1}return N=o+80|0,E}function Z(e,t,r,i){var n=0,o=0,a=0,l=0,c=0;e:{t:if(i){r:{i:switch(h[e+28>>2]-1|0){case 0:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=s[0|t],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+1|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(s[0|t])/_(127),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+1|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 1:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=d[0|t],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+1|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(d[0|t])/_(255),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+1|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 2:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=u[t>>1],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+2|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(u[t>>1])/_(32767),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+2|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 3:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=f[t>>1],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+2|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(f[t>>1])/_(65535),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+2|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 4:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=h[t>>2],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+4|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(h[t>>2])*_(4.656612873077393e-10),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+4|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 5:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=p[t>>2],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+4|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(p[t>>2])*_(2.3283064365386963e-10),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+4|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 6:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=+p[t>>2]+4294967296*+h[t+4>>2],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+8|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(+p[t>>2]+4294967296*+h[t+4>>2])*_(10842021724855044e-35),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+8|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 7:c=1;n:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(n=h[e>>2],l=h[n>>2],o=t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,t=l+t|0,n=(a=h[n+4>>2])-l|0,!d[e+32|0]){if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=+p[t>>2]+4294967296*+p[t+4>>2],(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+8|0)>>>0))break}break e}if((0|n)<=(0|o))break e;for(o=0;;){if(m[(o<<2)+i>>2]=_(+p[t>>2]+4294967296*+p[t+4>>2])*_(5.421010862427522e-20),(0|(o=o+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break n;if(!(a>>>0>(t=t+8|0)>>>0))break}break e}if((0|r)>(0|n))break r;break t;case 8:if(c=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,a=h[n+4>>2];;){if(t>>>0>=a>>>0)break e;if(m[(o<<2)+i>>2]=m[t>>2],t=t+4|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 9:if(c=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,a=h[n+4>>2];;){if(t>>>0>=a>>>0)break e;if(m[(o<<2)+i>>2]=g[t>>3],t=t+8|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 10:break i;default:break t}if(c=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(a=h[e>>2],t=(n=h[a>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0;;){if(p[a+4>>2]<=t>>>0)break e;if(m[(o<<2)+i>>2]=d[0|t]?_(1):_(0),t=t+1|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)<=(0|n))break t}St((n<<2)+i|0,0,r-n<<2)}return c}return 0}function J(e,t){var r,i,n=0,o=0,a=0;N=r=N-16|0,h[e+12>>2]=t,h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,h[(o=e+16|0)>>2]=0,h[o+4>>2]=0,s[o+5|0]=0,s[o+6|0]=0,s[o+7|0]=0,s[o+8|0]=0,s[o+9|0]=0,s[o+10|0]=0,s[o+11|0]=0,s[o+12|0]=0,h[(n=o+16|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+32|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+48|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o- -64|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+80|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+96|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+112|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+128|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+144|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+160|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+176|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+192|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+208|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+224|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+240|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+256|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+272|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+288|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+304|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+320|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+336|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+352|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+368|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+384|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+400|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+416|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+432|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+448|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+464|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(n=o+480|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[(o=o+496|0)>>2]=0,h[o+4>>2]=0,s[o+5|0]=0,s[o+6|0]=0,s[o+7|0]=0,s[o+8|0]=0,s[o+9|0]=0,s[o+10|0]=0,s[o+11|0]=0,s[o+12|0]=0,h[e+528>>2]=0,h[e+532>>2]=0,s[e+533|0]=0,s[e+534|0]=0,s[e+535|0]=0,s[e+536|0]=0,s[e+537|0]=0,s[e+538|0]=0,s[e+539|0]=0,s[e+540|0]=0,h[e+544>>2]=0,h[e+548>>2]=0,h[e+560>>2]=0,h[e+552>>2]=0,h[e+556>>2]=0,h[e+564>>2]=0,h[e+568>>2]=0,h[e+580>>2]=0,h[e+572>>2]=0,h[e+576>>2]=0,h[e+584>>2]=0,h[e+588>>2]=0,h[e+600>>2]=0,h[e+592>>2]=0,h[e+596>>2]=0,h[e+612>>2]=0,h[e+604>>2]=0,h[e+608>>2]=0,i=e+628|0;e:{t:{if(t){if(t>>>0<1073741824)break t;vn(),S()}h[e+616>>2]=0,h[e+620>>2]=0,h[e+624>>2]=0,h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,o=1;break e}n=mi(o=t<<2),h[e+604>>2]=n,a=n+o|0,h[e+612>>2]=a,St(n,0,o),h[e+624>>2]=0,h[e+616>>2]=0,h[e+620>>2]=0,h[e+608>>2]=a,n=mi(o),h[e+616>>2]=n,a=n+o|0,h[e+624>>2]=a,St(n,0,o),h[e+620>>2]=a,n=mi(o),h[r>>2]=n,a=n+o|0,h[r+8>>2]=a,St(n,0,o),h[r+4>>2]=a,o=t<<5|1}return Ut(i,o,r),(n=h[r>>2])&&(h[r+4>>2]=n,ve(n)),h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,t&&(n=mi(t<<=2),h[r>>2]=n,a=t+n|0,h[r+8>>2]=a,St(n,0,t),h[r+4>>2]=a),Ut(e+640|0,o,r),(t=h[r>>2])&&(h[r+4>>2]=t,ve(t)),N=r+16|0,e}function K(e,t){t|=0;var r,i,n,o=0,a=0,l=0,c=0,u=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0;N=r=N-96|0,n=h[4+(e|=0)>>2],l=h[n+32>>2],u=_=h[l+8>>2];e:if(!((0|(a=y=h[l+12>>2]))<=(0|(o=h[l+20>>2]))&(i=h[l+16>>2])>>>0>=u>>>0|(0|o)>(0|a)||(c=h[l>>2],E=d[c+i|0],a=(u=i+1|0)?o:o+1|0,h[l+16>>2]=u,h[l+20>>2]=a,(0|a)>=(0|y)&u>>>0>=_>>>0|(0|a)>(0|y)))){b=d[c+u|0],a=(u=i+2|0)>>>0<2?o+1|0:o,g=u,h[l+16>>2]=u,h[l+20>>2]=a;t:{if((0|(m=E<<24>>24))>=0){if(u=h[e+216>>2],E>>>0>=(h[e+220>>2]-u|0)/144>>>0)break e;if(u=u+v(E,144)|0,h[u>>2]<0)break t;break e}if(h[e+212>>2]>=0)break e;u=e+212|0}h[u>>2]=t;t:{r:{i:{if((65535&((u=f[n+36>>1])<<8|u>>>8))>>>0>=258){if((0|a)>=(0|y)&g>>>0>=_>>>0|(0|a)>(0|y))break e;if(u=d[c+g|0],o=(a=i+3|0)>>>0<3?o+1|0:o,h[l+16>>2]=a,h[l+20>>2]=o,o=u>>>0>1)break e;if(o=o?0:u,!b)break i;if(o)break e;break r}if(b)break r;o=0}if((0|m)<0?l=e+184|0:(l=h[e+216>>2]+v(E,144)|0,s[l+100|0]=0,l=l+104|0),1!=(0|o)?(N=a=N+-64|0,c=h[h[e+4>>2]+44>>2],o=mi(80),h[o>>2]=12672,h[o+4>>2]=0,h[o+76>>2]=0,h[o+72>>2]=l,h[o+68>>2]=c,h[o+8>>2]=12836,h[o+12>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o- -64>>2]=0,h[(u=b=o+56|0)>>2]=0,h[u+4>>2]=0,_=h[e+8>>2],h[a+40>>2]=0,h[a+44>>2]=0,h[a+32>>2]=0,h[a+36>>2]=0,h[(u=g=a+24|0)>>2]=0,h[u+4>>2]=0,h[a+16>>2]=0,h[a+20>>2]=0,h[a+8>>2]=0,h[a+12>>2]=0,h[a+56>>2]=0,h[a+48>>2]=0,h[a+52>>2]=0,h[a>>2]=12836,h[a+4>>2]=_,m=h[_>>2],u=h[_+4>>2],s[a+63|0]=0,Rt(y=g,(u-m>>2>>>0)/3|0,g=a+63|0),u=h[a+4>>2],m=h[u+28>>2],u=h[u+24>>2],s[a+63|0]=0,Rt(a+36|0,m-u>>2,g),h[a+20>>2]=o,h[a+16>>2]=c,h[a+12>>2]=l,h[a+8>>2]=_,mt(o+8|0,a),Ot(b,h[a+48>>2],h[a+52>>2]),h[a>>2]=12836,(l=h[a+48>>2])&&(h[a+52>>2]=l,ve(l)),h[a>>2]=12652,(l=h[a+36>>2])&&ve(l),(l=h[a+24>>2])&&ve(l),N=a- -64|0):(N=c=N-112|0,g=h[h[e+4>>2]+44>>2],o=mi(120),h[o>>2]=12204,h[o+4>>2]=0,h[o+116>>2]=0,h[o+112>>2]=l,h[o+108>>2]=g,h[o+12>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o+56>>2]=0,h[o+60>>2]=0,h[o+8>>2]=12416,h[(a=o- -64|0)>>2]=0,h[a+4>>2]=0,h[o+72>>2]=0,h[o+76>>2]=0,h[o+80>>2]=0,h[o+84>>2]=0,h[o+88>>2]=0,h[o+104>>2]=0,h[o+96>>2]=0,h[o+100>>2]=0,b=h[e+8>>2],h[c+48>>2]=0,h[c+52>>2]=0,h[c+40>>2]=0,h[c+44>>2]=0,h[(a=m=c+32|0)>>2]=0,h[a+4>>2]=0,h[c+24>>2]=0,h[c+28>>2]=0,h[c+16>>2]=0,h[c+20>>2]=0,h[(a=c- -64|0)>>2]=0,h[a+4>>2]=0,h[c+72>>2]=0,h[c+76>>2]=0,h[c+80>>2]=0,h[c+84>>2]=0,h[c+88>>2]=0,h[c+104>>2]=0,h[c+56>>2]=0,h[c+60>>2]=0,h[c+8>>2]=12416,h[c+96>>2]=0,h[c+100>>2]=0,h[c+12>>2]=b,u=h[b>>2],a=h[b+4>>2],s[c+111|0]=0,Rt(_=m,(a-u>>2>>>0)/3|0,m=c+111|0),a=h[c+12>>2],u=h[a+28>>2],a=h[a+24>>2],s[c+111|0]=0,Rt(c+44|0,u-a>>2,m),h[c+28>>2]=o,h[c+24>>2]=g,h[c+20>>2]=l,h[c+16>>2]=b,mt(l=o+8|0,a=c+8|0),(0|a)!=(0|l)?(Ot(o+56|0,h[a+48>>2],h[a+52>>2]),Ot(o+68|0,h[a+60>>2],h[a- -64>>2]),Ot(o+80|0,h[a+72>>2],h[a+76>>2]),h[o+92>>2]=h[a+84>>2],Ft(o+96|0,h[a+88>>2],h[a+92>>2])):h[o+92>>2]=h[a+84>>2],h[c+8>>2]=12416,(l=h[c+96>>2])&&(h[c+100>>2]=l,ve(l)),(l=h[c+80>>2])&&(h[c+84>>2]=l,ve(l)),(l=h[c+68>>2])&&(h[c+72>>2]=l,ve(l)),(l=h[c+56>>2])&&(h[c+60>>2]=l,ve(l)),h[c+8>>2]=12652,(l=h[c+44>>2])&&ve(l),(l=h[c+32>>2])&&ve(l),N=c+112|0),!o)break e;break t}if((0|m)<0)break e;u=h[n+44>>2],l=h[e+216>>2],o=mi(80),h[o+76>>2]=0,h[o+68>>2]=u,h[o+8>>2]=11900,h[o>>2]=12964,h[o+4>>2]=0,p=104+(a=l+v(E,144)|0)|0,h[o+72>>2]=p,h[o- -64>>2]=0,h[o+56>>2]=0,h[o+60>>2]=0,h[o+52>>2]=0,h[o+44>>2]=0,h[o+48>>2]=0,h[o+36>>2]=0,h[o+40>>2]=0,h[o+28>>2]=0,h[o+32>>2]=0,h[o+20>>2]=0,h[o+24>>2]=0,h[o+12>>2]=0,h[o+16>>2]=0,h[r+24>>2]=u,h[r+68>>2]=0,h[r+72>>2]=0,h[r+60>>2]=0,h[r+64>>2]=0,h[r+52>>2]=0,h[r+56>>2]=0,h[r+44>>2]=0,h[r+48>>2]=0,h[r+84>>2]=0,h[r+88>>2]=0,h[r+76>>2]=0,h[r+80>>2]=0,h[r+28>>2]=o,l=h[r+28>>2],h[r+8>>2]=h[r+24>>2],h[r+12>>2]=l,a=a+4|0,h[r+16>>2]=a,h[r+20>>2]=p,h[r+36>>2]=0,h[r+40>>2]=0,h[r+32>>2]=11900,l=h[r+20>>2],h[r>>2]=h[r+16>>2],h[r+4>>2]=l,pr(p=r+32|0,a,r),mt(l=o+8|0,p),(0|l)!=(0|p)&&Ot(o+56|0,h[p+48>>2],h[p+52>>2]),ci(p)}o=Fr(mi(64),o),m=h[e+4>>2],e=o;t:{r:{if((0|(o=t))>=0){if(a=m+8|0,!((0|(u=(t=h[m+12>>2])-(l=h[m+8>>2])>>2))>(0|o)))if(p=o+1|0,o>>>0>=u>>>0)At(a,p-u|0);else if(!(u>>>0<=p>>>0)){if((0|(l=l+(p<<2)|0))!=(0|t))for(;p=h[(t=t-4|0)>>2],h[t>>2]=0,p&&Cn[h[h[p>>2]+4>>2]](p),(0|t)!=(0|l););h[m+12>>2]=l}if(l=h[a>>2]+(o<<2)|0,t=h[l>>2],h[l>>2]=e,t)break r;break t}if(t=e,!e)break t}Cn[h[h[t>>2]+4>>2]](t)}p=(-1^o)>>>31|0}return N=r+96|0,0|p}function Q(e){var t,r=0,i=0,n=0,s=0,o=0;if(N=t=N-16|0,h[t+12>>2]=e,e>>>0<=211)n=h[Gr(14288,14480,t+12|0)>>2];else{for(e>>>0>=4294967292&&(Tn(),S()),n=v(s=(e>>>0)/210|0,210),h[t+8>>2]=e-n,o=Gr(14480,14672,t+8|0)-14480>>2;;){n=h[14480+(o<<2)>>2]+n|0,e=5;e:{for(;;){t:if(47!=(0|e)){if((r=h[14288+(e<<2)>>2])>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if(e=e+1|0,(0|v(r,i))!=(0|n))continue}else for(e=211;;){if((r=(n>>>0)/(e>>>0)|0)>>>0<e>>>0)break e;if((0|v(e,r))==(0|n))break t;if((r=e+10|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+12|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+16|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+18|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+22|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+28|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+30|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+36|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+40|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+42|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+46|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+52|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+58|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+60|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+66|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+70|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+72|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+78|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+82|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+88|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+96|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+100|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+102|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+106|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+108|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+112|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+120|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+126|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+130|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+136|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+138|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+142|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+148|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+150|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+156|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+162|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+166|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+168|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+172|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+178|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+180|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+186|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+190|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+192|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+196|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+198|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if((0|v(r,i))==(0|n))break t;if((r=e+208|0)>>>0>(i=(n>>>0)/(r>>>0)|0)>>>0)break e;if(e=e+210|0,(0|v(r,i))==(0|n))break}break}o=(e=48==(0|(n=o+1|0)))?0:n,n=v(s=e+s|0,210);continue}break}h[t+12>>2]=n}return N=t+16|0,n}function ee(e,t){var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0,_=0,b=0,y=0,E=0;N=r=N-16|0;e:{t:{r:{if(d[h[e+4>>2]+36|0]<=1){if(m=-1,i=h[t+20>>2],i=(n=(o=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(0|(g=h[t+12>>2]))<=(0|i)&n>>>0>p[t+8>>2]|(0|i)>(0|g))break r;o=o+h[t>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[r+12>>2]=o,h[t+16>>2]=n,h[t+20>>2]=i}else{if(m=-1,!Ar(1,r+12|0,t))break r;o=h[r+12>>2]}i:{n:{s:{o:{a:{l:if(o){if(i=h[e+8>>2],(h[i+4>>2]-h[i>>2]>>2>>>0)/3>>>0<o>>>0)break r;if((65535&((i=f[h[e+4>>2]+36>>1])<<8|i>>>8))>>>0>=258){g=0;c:{u:{for(;;){if(!Ar(1,r+8|0,t))break r;if(i=h[r+8>>2],!Ar(1,r+8|0,t))break r;if((a=i+a|0)>>>0<(i=h[r+8>>2])>>>0)break r;if(c=a-i|0,(0|(l=h[e+40>>2]))==h[e+44>>2]){if((u=1+(l=(0|(n=l-(i=h[e+36>>2])|0))/12|0)|0)>>>0>=357913942)break u;if(_=l<<1,(u=l>>>0<178956970?u>>>0>_>>>0?u:_:357913941)>>>0>=357913942)break c;l=(_=mi(u=v(u,12)))+v(l,12)|0,h[l+4>>2]=a,h[l>>2]=c,c=l+v((0|n)/-12|0,12)|0,l=l+12|0,(0|n)>0&&He(c,i,n),h[e+44>>2]=u+_,h[e+40>>2]=l,h[e+36>>2]=c,i&&ve(i)}else h[l+4>>2]=a,h[l>>2]=c,h[e+40>>2]=l+12;if((0|(g=g+1|0))==(0|o))break}for(m=0,Dt(t,0,0),n=o>>>0>1?o:1;;){i=d[t+36|0];h:{d:{if((65535&((a=f[h[e+4>>2]+36>>1])<<8|a>>>8))>>>0<=513){if(!i)break h;if(l=0,(o=(a=(i=h[t+32>>2])>>>3|0)+(g=h[t+24>>2])|0)>>>0>=(c=h[t+28>>2])>>>0?o=i:(l=d[0|o],o=i+1|0,h[t+32>>2]=o,a=o>>>3|0,l=l>>>(7&i)&1),c>>>0>a+g>>>0)break d;break h}if(!i)break h;if(l=0,o=h[t+32>>2],(i=h[t+24>>2]+(o>>>3|0)|0)>>>0>=p[t+28>>2])break h;l=d[0|i]>>>(7&o)&1}h[t+32>>2]=o+1}if(i=h[e+36>>2]+v(m,12)|0,s[i+8|0]=254&d[i+8|0]|1&l,(0|n)==(0|(m=m+1|0)))break}s[t+36|0]=0,i=h[t+20>>2],a=0,n=(a=(o=h[t+32>>2]+7|0)>>>0<7?1:a)>>>3|0,a=(o=(7&a)<<29|o>>>3)+h[t+16>>2]|0,i=i+n|0,h[t+16>>2]=a,h[t+20>>2]=o>>>0>a>>>0?i+1|0:i;break l}vn(),S()}break e}for(g=0;;){if(n=h[t+12>>2],a=i=h[t+20>>2],i=(u=(c=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,_=u,(b=h[t+8>>2])>>>0<u>>>0&(0|i)>=(0|n)|(0|i)>(0|n))break r;if(y=h[t>>2],E=d[0|(u=y+c|0)]|d[u+1|0]<<8|d[u+2|0]<<16|d[u+3|0]<<24,h[t+16>>2]=_,h[t+20>>2]=i,i=a,(u=c+8|0)>>>0>b>>>0&(0|(i=u>>>0<8?i+1|0:i))>=(0|n)|(0|i)>(0|n))break r;if(_=d[0|(_=_+y|0)]|d[_+1|0]<<8|d[_+2|0]<<16|d[_+3|0]<<24,h[t+16>>2]=u,h[t+20>>2]=i,(0|i)>=(0|n)&u>>>0>=b>>>0|(0|i)>(0|n))break r;if(i=d[u+y|0],a=(n=c+9|0)>>>0<9?a+1|0:a,h[t+16>>2]=n,h[t+20>>2]=a,l=1&i|-2&l,(0|(i=h[e+40>>2]))==h[e+44>>2]){if((c=1+(i=(0|(n=i-(a=h[e+36>>2])|0))/12|0)|0)>>>0>=357913942)break a;if(u=i<<1,(c=i>>>0<178956970?c>>>0>u>>>0?c:u:357913941)>>>0>=357913942)break e;i=(b=mi(u=v(c,12)))+v(i,12)|0,s[i+8|0]=l,h[i+4>>2]=_,h[i>>2]=E,c=i+v((0|n)/-12|0,12)|0,(0|n)>0&&He(c,a,n),h[e+44>>2]=u+b,h[e+40>>2]=i+12,h[e+36>>2]=c,a&&ve(a)}else s[i+8|0]=l,h[i+4>>2]=_,h[i>>2]=E,h[e+40>>2]=i+12;if((0|(g=g+1|0))==(0|o))break}}if(h[r+8>>2]=0,(i=65535&((i=f[h[e+4>>2]+36>>1])<<8|i>>>8))>>>0<=511){if(m=-1,i=h[t+20>>2],i=(o=(a=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(0|(n=h[t+12>>2]))<=(0|i)&o>>>0>p[t+8>>2]|(0|i)>(0|n))break r;a=a+h[t>>2]|0,a=d[0|a]|d[a+1|0]<<8|d[a+2|0]<<16|d[a+3|0]<<24,h[t+16>>2]=o,h[t+20>>2]=i}else{if(512!=(0|i))break i;if(m=-1,!Ar(1,r+8|0,t))break r;a=h[r+8>>2]}if(!a)break i;if((65535&((i=f[h[e+4>>2]+36>>1])<<8|i>>>8))>>>0<258)break n;for(l=0,m=0;;){if(!Ar(1,r+4|0,t))break s;if(m=h[r+4>>2]+m|0,(0|(i=h[e+52>>2]))==h[e+56>>2]){if((i=1+(c=(o=i-(n=h[e+48>>2])|0)>>2)|0)>>>0>=1073741824)break o;if(g=o>>1,g=o>>>0<2147483644?i>>>0>g>>>0?i:g:1073741823){if(g>>>0>=1073741824)break e;i=mi(g<<2)}else i=0;h[(c=i+(c<<2)|0)>>2]=m,(0|o)>0&&He(i,n,o),h[e+56>>2]=i+(g<<2),h[e+52>>2]=c+4,h[e+48>>2]=i,n&&ve(n)}else h[i>>2]=m,h[e+52>>2]=i+4;if((0|a)==(0|(l=l+1|0)))break}break i}vn(),S()}vn(),S()}m=-1;break r}for(o=0;;){if(i=h[t+20>>2],i=(l=(n=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(0|(m=h[t+12>>2]))<=(0|i)&l>>>0>p[t+8>>2]|(0|i)>(0|m)){m=-1;break r}if(n=n+h[t>>2]|0,g=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[t+16>>2]=l,h[t+20>>2]=i,(0|(i=h[e+52>>2]))==h[e+56>>2]){if((i=1+(c=(n=i-(l=h[e+48>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(m=n>>1,m=n>>>0<2147483644?i>>>0>m>>>0?i:m:1073741823){if(m>>>0>=1073741824)break e;i=mi(m<<2)}else i=0;h[(c=i+(c<<2)|0)>>2]=g,(0|n)>0&&He(i,l,n),h[e+56>>2]=i+(m<<2),h[e+52>>2]=c+4,h[e+48>>2]=i,l&&ve(l)}else h[i>>2]=g,h[e+52>>2]=i+4;if((0|a)==(0|(o=o+1|0)))break}}m=h[t+16>>2]}return N=r+16|0,m}vn(),S()}Zr(1336),S()}function te(e,t,r,i){var n=0,o=0,a=0,l=0,c=_(0),u=0;e:if(i){t:{r:switch(h[e+28>>2]-1|0){case 0:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(s[t+i|0]=d[0|o],(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+1|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 1:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((0|(n=s[0|o]))<0)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+1|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 2:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(((n=f[o>>1])-128&65535)>>>0<65280)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+2|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 3:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((n=f[o>>1])>>>0>127)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+2|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 4:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((n=h[o>>2])-128>>>0<4294967040)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+4|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 5:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((n=h[o>>2])>>>0>127)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+4|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 6:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(l=h[o>>2],-1==(0|(n=h[o+4>>2]-(l>>>0<128)|0))&l-128>>>0<4294967040|-1!=(0|n))break e;if(s[t+i|0]=l,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+8|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 7:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(!(n=h[o+4>>2])&(l=h[o>>2])>>>0>127|n)break e;if(s[t+i|0]=l,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+8|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 8:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(l=t+i|0,c=m[o>>2],n=_(b(c))<_(2147483648)?~~c:-2147483648,s[0|l]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+4|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 9:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(l=t+i|0,u=g[o>>3],n=b(u)<2147483648?~~u:-2147483648,s[0|l]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+8|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 10:break r;default:break e}r:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(s[t+i|0]=d[0|o],(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break r;if(!((o=o+1|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)<=(0|n))break e}St(i+n|0,0,r-n|0)}return a}function re(e,t,r,i){var n=0,o=0,a=0,l=0,c=_(0),u=0;e:if(i){t:{r:switch(h[e+28>>2]-1|0){case 0:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((0|(n=s[0|o]))<0)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+1|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 1:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(s[t+i|0]=d[0|o],(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+1|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 2:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((n=f[o>>1])>>>0>255)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+2|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 3:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((n=f[o>>1])>>>0>255)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+2|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 4:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((n=h[o>>2])>>>0>255)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+4|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 5:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if((n=h[o>>2])>>>0>255)break e;if(s[t+i|0]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+4|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 6:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(!(n=h[o+4>>2])&(l=h[o>>2])>>>0>255|n)break e;if(s[t+i|0]=l,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+8|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 7:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(!(n=h[o+4>>2])&(l=h[o>>2])>>>0>255|n)break e;if(s[t+i|0]=l,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+8|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 8:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(l=t+i|0,n=(c=m[o>>2])<_(4294967296)&c>=_(0)?~~c>>>0:0,s[0|l]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+4|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 9:i:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(l=t+i|0,n=(u=g[o>>3])<4294967296&u>=0?~~u>>>0:0,s[0|l]=n,(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break i;if(!((o=o+8|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)>(0|n))break t;break e;case 10:break r;default:break e}r:if(!((0|((0|r)<(0|(n=s[e+24|0]))?r:n))<=0)){if(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0,o=h[e>>2],n=h[o>>2],(0|t)>=(h[o+4>>2]-n|0))break e;for(o=t+n|0,t=0;;){if(s[t+i|0]=d[0|o],(0|(t=t+1|0))>=(0|((0|r)<(0|(n=s[e+24|0]))?r:n)))break r;if(!((o=o+1|0)>>>0<p[h[e>>2]+4>>2]))break}break e}if(a=1,(0|r)<=(0|n))break e}St(i+n|0,0,r-n|0)}return a}function ie(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;e:{t:{r:{i:{n:if(h[e+92>>2]!=h[e+88>>2]){if((0|(r=h[e+52>>2]))==h[e+56>>2]){if((n=1+(s=(l=r-(i=h[e+48>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(r=l>>1,n=l>>>0<2147483644?r>>>0<n>>>0?n:r:1073741823){if(n>>>0>=1073741824)break e;r=mi(n<<2)}else r=0;h[(s=r+(s<<2)|0)>>2]=t,(0|l)>0&&He(r,i,l),h[e+56>>2]=r+(n<<2),h[e+52>>2]=s+4,h[e+48>>2]=r,i&&ve(i)}else h[r>>2]=t,h[e+52>>2]=r+4;h[e+84>>2]=0,s=-1,r=-1;s:if(-1!=(0|t)){if(n=h[e+4>>2],-1!=(0|(r=((r=t+1|0)>>>0)%3|0?r:t-2|0))&&(s=h[h[n>>2]+(r<<2)>>2]),(t>>>0)%3|0)i=t-1|0;else if(r=-1,-1==(0|(i=t+2|0)))break s;r=h[h[n>>2]+(i<<2)>>2]}if(a=r>>>3&536870908,n=h[e+36>>2],(l=h[(o=n+(s>>>3&536870908)|0)>>2])&(i=1<<s)||(h[o>>2]=i|l,tt(o=e+8|0,s,i=-1!=(0|t)?((n=t+1|0)>>>0)%3|0?n:t-2|0:-1),n=h[e+36>>2]),(n=h[(i=n+a|0)>>2])&(s=1<<r)||(h[i>>2]=n|s,s=-1,-1!=(0|t)&&(s=t-1|0,(t>>>0)%3|0||(s=t+2|0)),tt(i=e+8|0,r,s)),s=-1,s=-1!=(0|t)?h[h[h[e+4>>2]>>2]+(t<<2)>>2]:s,i=h[e+36>>2]+(s>>>3&536870908)|0,(n=h[i>>2])&(r=1<<s)||(h[i>>2]=r|n,tt(e+8|0,s,t)),!((0|(i=h[e+84>>2]))>2))for(;;){if(s=v(i,12)+e|0,(0|(t=h[s+52>>2]))==h[s+48>>2]){if(3!=(0|(i=i+1|0)))continue;break n}if(t=h[(r=t-4|0)>>2],h[s+52>>2]=r,h[e+84>>2]=i,-1==(0|t))break n;s=h[e+24>>2];s:if(!(h[s+((r=(t>>>0)/3|0)>>>3&268435452)>>2]>>>r&1)){o:{for(;;){h[(r=((u=(t>>>0)/3|0)>>>3&268435452)+s|0)>>2]=h[r>>2]|1<<u,s=-1;a:{l:{c:{u:{h:{d:{f:{p:{if(s=-1!=(0|t)?h[h[h[e+4>>2]>>2]+(t<<2)>>2]:s,i=h[e+36>>2]+(s>>>3&536870908)|0,!((n=h[i>>2])&(r=1<<s))){if(h[i>>2]=r|n,l=h[(h[h[e+16>>2]+96>>2]+v(u,12)|0)+((t>>>0)%3<<2)>>2],c=h[h[e+20>>2]+4>>2],(0|(r=h[c+4>>2]))==h[c+8>>2]){if((i=1+(n=(a=r-(o=h[c>>2])|0)>>2)|0)>>>0>=1073741824)break p;if(r=a>>1,i=a>>>0<2147483644?r>>>0<i>>>0?i:r:1073741823){if(i>>>0>=1073741824)break e;r=mi(i<<2)}else r=0;h[(n=r+(n<<2)|0)>>2]=l,(0|a)>0&&He(r,o,a),h[c+8>>2]=r+(i<<2),h[c+4>>2]=n+4,h[c>>2]=r,o&&ve(o)}else h[r>>2]=l,h[c+4>>2]=r+4;if(a=h[e+12>>2],(0|(r=h[a+4>>2]))==h[a+8>>2]){if((i=1+(n=(o=r-(l=h[a>>2])|0)>>2)|0)>>>0>=1073741824)break f;if(r=o>>1,i=o>>>0<2147483644?r>>>0<i>>>0?i:r:1073741823){if(i>>>0>=1073741824)break e;r=mi(i<<2)}else r=0;h[(n=r+(n<<2)|0)>>2]=t,(0|o)>0&&He(r,l,o),h[a+8>>2]=r+(i<<2),h[a+4>>2]=n+4,h[a>>2]=r,l&&ve(l)}else h[r>>2]=t,h[a+4>>2]=r+4;r=h[e+12>>2],h[h[r+12>>2]+(s<<2)>>2]=h[r+24>>2],h[r+24>>2]=h[r+24>>2]+1}if(-1==(0|t))break o;a=h[e+4>>2],s=-1,-1!=(0|(r=((r=t+1|0)>>>0)%3|0?r:t-2|0))&&(s=h[h[a+12>>2]+(r<<2)>>2]);m:{if((0|v(u,3))==(0|t)){if(n=t+2|0,t=-1,-1==(0|n))break m}else n=t-1|0;t=h[h[a+12>>2]+(n<<2)>>2]}if(o=-1==(0|t),l=(t>>>0)/3|0,n=(s>>>0)/3|0,!(r=-1==(0|s))){if(r=r?-1:n,r=h[h[e+24>>2]+(r>>>3&536870908)>>2]&1<<r,o)break d;i=0!=(0|r);break h}if(i=1,!o)break h;break o}vn(),S()}vn(),S()}if(!r)break u;break o}if(r=o?-1:l,!(h[h[e+24>>2]+(r>>>3&536870908)>>2]>>>r&1)){if(n=0,r=h[h[a>>2]+(t<<2)>>2],h[h[e+36>>2]+(r>>>3&536870908)>>2]>>>r&1||(r=h[e+88>>2]+(r<<2)|0,n=h[r>>2],h[r>>2]=n+1,n=(0|n)<=0?2:1),h[e+84>>2]>=(0|n)&&i)break l;if(c=v(n,12)+e|0,(0|(r=h[c+52>>2]))==h[c+56>>2]){if((o=1+(l=(u=r-(a=h[c+48>>2])|0)>>2)|0)>>>0>=1073741824)break i;if(r=u>>1,o=u>>>0<2147483644?r>>>0<o>>>0?o:r:1073741823){if(o>>>0>=1073741824)break e;r=mi(o<<2)}else r=0;h[(l=r+(l<<2)|0)>>2]=t,(0|u)>0&&He(r,a,u),h[c+48>>2]=r,h[c+52>>2]=l+4,h[c+56>>2]=r+(o<<2),a&&ve(a)}else h[r>>2]=t,h[c+52>>2]=r+4;h[e+84>>2]<=(0|n)||(h[e+84>>2]=n)}if(i)break o;if(t=-1,-1==(0|s))break c}t=h[h[h[e+4>>2]>>2]+(s<<2)>>2]}if(n=0,h[h[e+36>>2]+(t>>>3&536870908)>>2]>>>t&1||(t=h[e+88>>2]+(t<<2)|0,r=h[t>>2],h[t>>2]=r+1,n=(0|r)<=0?2:1),h[e+84>>2]<(0|n))break a;t=s}s=h[e+24>>2];continue}break}if(a=v(n,12)+e|0,(0|(t=h[a+52>>2]))==h[a+56>>2]){if((i=1+(r=(o=t-(l=h[a+48>>2])|0)>>2)|0)>>>0>=1073741824)break r;if(t=o>>1,i=o>>>0<2147483644?t>>>0<i>>>0?i:t:1073741823){if(i>>>0>=1073741824)break e;t=mi(i<<2)}else t=0;h[(r=t+(r<<2)|0)>>2]=s,(0|o)>0&&He(t,l,o),h[a+48>>2]=t,h[a+52>>2]=r+4,h[a+56>>2]=t+(i<<2),l&&ve(l)}else h[t>>2]=s,h[a+52>>2]=t+4;if((0|n)>=(0|(i=h[e+84>>2])))break s;h[e+84>>2]=n,i=n;break s}i=h[e+84>>2]}if(!((0|i)<3))break}}return 1}vn(),S()}vn(),S()}vn(),S()}Zr(1336),S()}function ne(e,t){var r,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0;if(N=r=N-48|0,i=h[h[e+4>>2]+44>>2],n=h[e+8>>2],o=h[n>>2],n=h[n+4>>2],h[r+40>>2]=0,h[r+32>>2]=0,h[r+36>>2]=0,n=(n-o>>2>>>0)/3|0,c=h[i+96>>2],n>>>0>(o=(h[i+100>>2]-c|0)/12|0)>>>0?ke(i+96|0,n-o|0,r+32|0):n>>>0>=o>>>0||(h[i+100>>2]=c+v(n,12)),h[e+216>>2]!=h[e+220>>2]){h[r+24>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,u=h[e+8>>2],t=h[u>>2],i=h[u+4>>2],h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0;e:{t:{r:{i:{n:{s:{o:{if(t=i-t|0){if((0|t)<0)break o;p=mi(t),h[r>>2]=p,i=(t=t>>2<<2)+p|0,h[r+8>>2]=i,St(p,0,t),h[r+4>>2]=i}if(i=h[u+24>>2],(h[u+28>>2]-i|0)<=0){n=0,t=0;break t}for(n=0,o=0,t=0;;){a:if(-1!=(0|(c=h[(m<<2)+i>>2]))){l:if(!(h[h[e+120>>2]+(m>>>3&536870908)>>2]>>>m&1)&&(_=h[e+216>>2],i=h[e+220>>2]-_|0))for(b=(i=(0|i)/144|0)>>>0>1?i:1,d=0,y=0!=(0|(i=(c>>>0)%3|0))|-1!=(0|(a=c+2|0)),E=i?c-1|0:a;;){if(l=c<<2,s=_+v(d,144)|0,i=h[l+h[h[s+68>>2]>>2]>>2],h[h[s+16>>2]+(i>>>3&536870908)>>2]>>>i&1&&(i=-1,y&&(i=-1,-1!=(0|(a=h[h[u+12>>2]+(E<<2)>>2]))&&(i=a-1|0,(a>>>0)%3|0||(i=a+2|0))),(0|c)!=(0|i)))for(s=h[s+32>>2],a=h[s+l>>2];;){if(f=0,-1==(0|i))break e;if(h[s+(i<<2)>>2]!=(0|a)){c=i;break l}c:{if((i>>>0)%3|0)l=i-1|0;else if(f=-1,-1==(0|(l=i+2|0)))break c;f=-1,-1!=(0|(i=h[h[u+12>>2]+(l<<2)>>2]))&&(f=i-1|0,(i>>>0)%3|0||(f=i+2|0))}if((0|c)==(0|(i=f)))break}if((0|b)==(0|(d=d+1|0)))break}if(a=(i=t-o|0)>>2,h[(c<<2)+p>>2]=a,t>>>0<g>>>0)h[t>>2]=c,t=t+4|0,h[r+20>>2]=t;else{if((t=a+1|0)>>>0>=1073741824)break s;if(s=(n=g-o|0)>>1,t=n>>>0<2147483644?t>>>0>s>>>0?t:s:1073741823){if(t>>>0>=1073741824)break n;n=mi(t<<2)}else n=0;h[(a=n+(a<<2)|0)>>2]=c,g=(t<<2)+n|0,t=a+4|0,(0|i)>0&&He(n,o,i),h[r+24>>2]=g,h[r+20>>2]=t,h[r+16>>2]=n,o&&(ve(o),u=h[e+8>>2]),o=n}if(-1!=(0|c)){if((c>>>0)%3|0)i=c-1|0;else if(-1==(0|(i=c+2|0)))break a;if(-1!=(0|(i=h[h[u+12>>2]+(i<<2)>>2]))&&-1!=(0|(i=i+((i>>>0)%3|0?-1:2)|0))&&(0|i)!=(0|(s=c)))for(;;){a=i;l:{c:if(l=h[e+216>>2],i=h[e+220>>2]-l|0){for(d=(i=(0|i)/144|0)>>>0>1?i:1,i=0;;){if(_=h[32+(l+v(i,144)|0)>>2],h[_+(b=a<<2)>>2]==h[_+(s<<2)>>2]){if((0|d)!=(0|(i=i+1|0)))continue;break c}break}if(s=(i=t-n|0)>>2,h[p+b>>2]=s,t>>>0<g>>>0){h[t>>2]=a,t=t+4|0,h[r+20>>2]=t,o=n;break l}if((t=s+1|0)>>>0>=1073741824)break i;if(l=(o=g-n|0)>>1,t=o>>>0<2147483644?t>>>0>l>>>0?t:l:1073741823){if(t>>>0>=1073741824)break r;o=mi(t<<2)}else o=0;if(h[(s=o+(s<<2)|0)>>2]=a,g=(t<<2)+o|0,t=s+4|0,(0|i)>0&&He(o,n,i),h[r+24>>2]=g,h[r+20>>2]=t,h[r+16>>2]=o,!n){n=o;break l}ve(n),u=h[e+8>>2],n=o;break l}h[(a<<2)+p>>2]=h[(s<<2)+p>>2]}if(-1==(0|a))break a;if((a>>>0)%3|0)i=a-1|0;else if(-1==(0|(i=a+2|0)))break a;if(-1==(0|(i=h[h[u+12>>2]+(i<<2)>>2])))break a;if(-1==(0|(i=i+((i>>>0)%3|0?-1:2)|0)))break a;if(s=a,(0|i)==(0|c))break}}}if(m=m+1|0,i=h[u+24>>2],!((0|m)<h[u+28>>2]-i>>2))break}break t}vn(),S()}vn(),S()}Zr(1336),S()}vn(),S()}Zr(1336),S()}if(m=h[e+4>>2],l=h[m+44>>2],(0|(d=h[l+100>>2]))!=h[l+96>>2])for(i=0;o=i+1|0,a=v(i,12),s=h[8+(c=a+p|0)>>2],u=h[c+4>>2],c=h[c>>2],(f=i)>>>0>=(d=(d-(i=h[l+96>>2])|0)/12|0)>>>0&&(h[r+40>>2]=0,h[r+32>>2]=0,h[r+36>>2]=0,ke(l+96|0,o-d|0,r+32|0),m=h[e+4>>2],i=h[l+96>>2]),h[8+(i=i+a|0)>>2]=s,h[i+4>>2]=u,h[i>>2]=c,i=o,l=h[m+44>>2],i>>>0<((d=h[l+100>>2])-h[l+96>>2]|0)/12>>>0;);h[h[m+4>>2]+80>>2]=t-n>>2,f=1}i=f,p&&ve(p),n&&(h[r+20>>2]=n,ve(n))}else{if(u=h[e+4>>2],l=h[u+44>>2],(0|(n=h[l+100>>2]))!=h[l+96>>2])for(i=0;;){a=h[e+8>>2];e:{if(-1!=(0|(s=v(i,3))))if(d=-1,c=h[h[a>>2]+(s<<2)>>2],-1!=(0|(o=s+1|0))){if(d=h[h[a>>2]+(o<<2)>>2],o=-1,-1==(0|(s=s+2|0)))break e}else s=0;else d=h[4+(h[a>>2]+(s<<2)|0)>>2],c=-1,s=1;o=h[h[a>>2]+(s<<2)>>2]}if(a=o,o=i+1|0,(s=((s=n)-(n=h[l+96>>2])|0)/12|0)>>>0<=i>>>0&&(h[r+40>>2]=0,h[r+32>>2]=0,h[r+36>>2]=0,ke(l+96|0,o-s|0,r+32|0),u=h[e+4>>2],n=h[l+96>>2]),i=v(i,12)+n|0,h[i+8>>2]=a,h[i+4>>2]=d,h[i>>2]=c,i=o,l=h[u+44>>2],!(i>>>0<((n=h[l+100>>2])-h[l+96>>2]|0)/12>>>0))break}h[h[u+4>>2]+80>>2]=t,i=1}return N=r+48|0,i}function se(e,t,r,i){var n=0,o=0,a=0,l=0,c=_(0),p=0,v=0;e:if(i){t:{r:switch(h[e+28>>2]-1|0){case 0:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(n=(o<<3)+i|0,a=s[0|t],h[n>>2]=a,h[n+4>>2]=a>>31,t=t+1|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 1:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(h[(n=(o<<3)+i|0)>>2]=d[0|t],h[n+4>>2]=0,t=t+1|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 2:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(n=(o<<3)+i|0,a=u[t>>1],h[n>>2]=a,h[n+4>>2]=a>>31,t=t+2|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 3:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(h[(n=(o<<3)+i|0)>>2]=f[t>>1],h[n+4>>2]=0,t=t+2|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 4:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(n=(o<<3)+i|0,a=h[t>>2],h[n>>2]=a,h[n+4>>2]=a>>31,t=t+4|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 5:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(h[(n=(o<<3)+i|0)>>2]=h[t>>2],h[n+4>>2]=0,t=t+4|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 6:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(a=h[t+4>>2],h[(n=(o<<3)+i|0)>>2]=h[t>>2],h[n+4>>2]=a,t=t+8|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 7:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(n=h[t>>2],(0|(a=h[t+4>>2]))<0)break e;if(h[(v=(o<<3)+i|0)>>2]=n,h[v+4>>2]=a,t=t+8|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 8:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,v=h[n+4>>2];;){if(t>>>0>=v>>>0)break e;if(n=(o<<3)+i|0,c=m[t>>2],_(b(c))<_(0x8000000000000000)?(a=_(b(c))>=_(1)?~~(c>_(0)?_(E(_(x(_(c*_(2.3283064365386963e-10)))),_(4294967296))):_(A(_(_(c-_(~~c>>>0>>>0))*_(2.3283064365386963e-10)))))>>>0:0,l=~~c>>>0):(a=-2147483648,l=0),h[n>>2]=l,h[n+4>>2]=a,t=t+4|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 9:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,v=h[n+4>>2];;){if(t>>>0>=v>>>0)break e;if(n=(o<<3)+i|0,p=g[t>>3],b(p)<0x8000000000000000?(a=b(p)>=1?~~(p>0?E(x(2.3283064365386963e-10*p),4294967295):A(2.3283064365386963e-10*(p-+(~~p>>>0>>>0))))>>>0:0,l=~~p>>>0):(a=-2147483648,l=0),h[n>>2]=l,h[n+4>>2]=a,t=t+8|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break t;break e;case 10:break r;default:break e}if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(a=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,l=h[n+4>>2];;){if(t>>>0>=l>>>0)break e;if(h[(n=(o<<3)+i|0)>>2]=d[0|t],h[n+4>>2]=0,t=t+1|0,!((0|(o=o+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)<=(0|n))break e}St((n<<3)+i|0,0,r-n<<3)}}function oe(e,t,r){t|=0,r|=0;var i,n=0,o=0,a=0,l=0,c=0,u=0,f=0,p=0,m=0,g=0,v=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0;N=i=N-96|0,o=h[16+(e|=0)>>2],s[i+92|0]=1,h[i+88>>2]=t,h[i+84>>2]=t,h[i+80>>2]=o,m=h[e+20>>2],n=h[m>>2];e:{t:{if((o=h[h[o+28>>2]+(t<<2)>>2])>>>0<h[m+4>>2]-n>>2>>>0){if(n=h[h[e+8>>2]+(h[n+(o<<2)>>2]<<2)>>2],o=h[e+4>>2],d[o+84|0]||(n=h[h[o+68>>2]+(n<<2)>>2]),h[i+72>>2]=0,h[i+76>>2]=0,h[(m=i- -64|0)>>2]=0,h[m+4>>2]=0,h[i+56>>2]=0,h[i+60>>2]=0,se(o,n,s[o+24|0],i+56|0),n=((o=t+1|0)>>>0)%3|0,t>>>0<=o>>>0)for(m=n?o:t-2|0,l=((t>>>0)%3|0?-1:2)+t|0;;){if(n=m,o=l,h[e+28>>2]&&(n=((o=t+1|0)>>>0)%3|0?o:t-2|0,o=t-1|0,(t>>>0)%3|0||(o=t+2|0)),f=h[e+20>>2],t=h[f>>2],(n=h[h[h[e+16>>2]+28>>2]+(n<<2)>>2])>>>0>=h[f+4>>2]-t>>2>>>0)break t;if(n=h[h[e+8>>2]+(h[t+(n<<2)>>2]<<2)>>2],t=h[e+4>>2],d[t+84|0]||(n=h[h[t+68>>2]+(n<<2)>>2]),h[i+48>>2]=0,h[i+52>>2]=0,h[i+40>>2]=0,h[i+44>>2]=0,h[i+32>>2]=0,h[i+36>>2]=0,se(t,n,s[t+24|0],i+32|0),n=h[e+20>>2],t=h[n>>2],(o=h[h[h[e+16>>2]+28>>2]+(o<<2)>>2])>>>0>=h[n+4>>2]-t>>2>>>0)break e;n=h[h[e+8>>2]+(h[t+(o<<2)>>2]<<2)>>2],t=h[e+4>>2],d[t+84|0]||(n=h[h[t+68>>2]+(n<<2)>>2]),h[i+24>>2]=0,h[i+28>>2]=0,h[i+16>>2]=0,h[i+20>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0,se(t,n,s[t+24|0],i+8|0),n=(o=h[i+8>>2])-(t=h[i+56>>2])|0,f=h[i+60>>2],g=h[i+12>>2]-(f+(t>>>0>o>>>0)|0)|0,E=(c=h[i+40>>2])-(o=h[i+64>>2])|0,w=h[i+68>>2],x=qr(n,g,E,c=h[i+44>>2]-(w+(o>>>0>c>>>0)|0)|0),a=a-(G+(u>>>0<x>>>0)|0)|0,T=A=u-x|0,o=qr(x=(u=h[i+16>>2])-o|0,w=h[i+20>>2]-((o>>>0>u>>>0)+w|0)|0,A=(u=h[i+32>>2])-t|0,f=h[i+36>>2]-((t>>>0>u>>>0)+f|0)|0),t=G+a|0,a=t=o>>>0>(u=T+o|0)>>>0?t+1|0:t,T=v,_=g,g=(t=h[i+48>>2])-(o=h[i+72>>2])|0,v=h[i+76>>2],_=qr(n,_,g,M=h[i+52>>2]-(v+(t>>>0<o>>>0)|0)|0),t=G+p|0,t=(n=T+_|0)>>>0<_>>>0?t+1|0:t,v=n-(p=qr(_=(p=h[i+24>>2])-o|0,o=h[i+28>>2]-((o>>>0>p>>>0)+v|0)|0,A,f))|0,p=t-(G+(n>>>0<p>>>0)|0)|0,n=b-(t=qr(x,w,g,M))|0,t=y-(G+(t>>>0>b>>>0)|0)|0,y=qr(_,o,E,c),t=G+t|0,y=t=(b=y+n|0)>>>0<y>>>0?t+1|0:t,t=h[i+88>>2],o=h[i+80>>2];r:if(d[i+92|0]){i:{if(-1==(0|t)||-1==(0|(t=((n=t+1|0)>>>0)%3|0?n:t-2|0))|h[h[o>>2]+(t>>>3&536870908)>>2]>>>t&1||-1==(0|(t=h[h[h[o+64>>2]+12>>2]+(t<<2)>>2])))h[i+88>>2]=-1;else if(t=((n=t+1|0)>>>0)%3|0?n:t-2|0,h[i+88>>2]=t,-1!=(0|t))break i;n=-1;n:if(-1!=(0|(t=h[i+84>>2]))){if((t>>>0)%3|0)t=t-1|0;else if(n=-1,-1==(0|(t=t+2|0)))break n;n=-1,h[h[o>>2]+(t>>>3&536870908)>>2]>>>t&1||(n=-1,-1!=(0|(t=h[h[h[o+64>>2]+12>>2]+(t<<2)>>2]))&&(n=t-1|0,(t>>>0)%3|0||(n=t+2|0)))}s[i+92|0]=0,h[i+88>>2]=n;break r}if((0|t)!=h[i+84>>2])break r;h[i+88>>2]=-1}else{n=-1;i:if(-1!=(0|t)){if((t>>>0)%3|0)t=t-1|0;else if(n=-1,-1==(0|(t=t+2|0)))break i;n=-1,h[h[o>>2]+(t>>>3&536870908)>>2]>>>t&1||(n=-1,-1!=(0|(t=h[h[h[o+64>>2]+12>>2]+(t<<2)>>2]))&&(n=t-1|0,(t>>>0)%3|0||(n=t+2|0)))}h[i+88>>2]=n}if(-1==(0|(t=h[i+88>>2])))break}n=(t=y>>31)+b|0,o=t,t=t+y|0,f=n^o,l=o^(n>>>0<o>>>0?t+1|0:t),g=-1,n=2147483647,c=t=p>>31,o=t+v|0,t=t+p|0,t=o>>>0<c>>>0?t+1|0:t,o^=c,c=t^=c,E=-1^o,t^=2147483647,m=a;r:{if(h[e+28>>2]){if(!((0|t)==(0|l)&f>>>0>E>>>0|t>>>0<l>>>0)&&(t=l+c|0,o=t=(e=o+f|0)>>>0<o>>>0?t+1|0:t,l=a,a=(t=a>>31)+u|0,c=l,l=t,t=c+t|0,t=a>>>0<l>>>0?t+1|0:t,a^=l,!((0|(l=2147483647^(t^=l)))==(0|o)&(-1^a)>>>0<e>>>0|o>>>0>l>>>0)&&(t=t+o|0,g=e=e+a|0,n=t=e>>>0<a>>>0?t+1|0:t,!t&e>>>0<536870913)))break r;t=n>>>29|0,e=(536870911&n)<<3|g>>>29}else{if((0|t)==(0|l)&f>>>0>E>>>0|t>>>0<l>>>0)break r;if(t=l+c|0,t=(e=o+f|0)>>>0<o>>>0?t+1|0:t,o=e,e=t,n=(t=a>>31)+u|0,l=a,a=t,t=l+t|0,l=n^a,a^=t=n>>>0<a>>>0?t+1|0:t,t=n=l+o|0,e=(0|(a^=2147483647))==(0|e)&(-1^l)>>>0<o>>>0|e>>>0>a>>>0,(a=!0)&(0|(e=e?-1:t))<=536870912|(0|e)<536870912)break r;t=0,e=e>>>29|0}u=$r(u,m,e,t),v=$r(v,p,e,t),b=$r(b,y,e,t)}return h[r+8>>2]=u,h[r+4>>2]=v,h[r>>2]=b,void(N=i+96|0)}An(),S()}An(),S()}An(),S()}function ae(e,t,r){var i,n=0,s=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0;N=i=N+-64|0,h[i+56>>2]=0,h[i+48>>2]=0,h[i+52>>2]=0,h[i+40>>2]=0,h[i+44>>2]=0,h[i+32>>2]=0,h[i+36>>2]=0,h[i+24>>2]=0,h[i+28>>2]=0,h[i+16>>2]=0,h[i+20>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0,o=i+8|0;e:{t:if(n=f[t+38>>1]){if(n>>>0<=511){if(s=h[t+12>>2],n=h[t+20>>2],n=(l=(a=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,l>>>0>p[t+8>>2]&(0|n)>=(0|s)|(0|n)>(0|s))break t;n=a+h[t>>2]|0,u=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[o+12>>2]=u,n=h[t+20>>2],n=(s=h[t+16>>2]+4|0)>>>0<4?n+1|0:n,h[t+16>>2]=s,h[t+20>>2]=n}else{if(!yr(1,o+12|0,t))break t;u=h[o+12>>2]}if(s=h[o>>2],(n=h[o+4>>2]-s>>2)>>>0<u>>>0?(er(o,u-n|0),u=h[o+12>>2]):n>>>0<=u>>>0||(h[o+4>>2]=s+(u<<2)),n=1,!u)break e;for(E=h[t+8>>2],g=h[t+12>>2],y=h[o>>2],a=0;;){if(n=0,(0|g)<=(0|(s=h[t+20>>2]))&E>>>0<=(l=h[t+16>>2])>>>0|(0|s)>(0|g))break e;x=h[t>>2],_=d[x+l|0],n=s,n=(s=l+1|0)?n:n+1|0,l=s,h[t+16>>2]=s,h[t+20>>2]=n,s=_>>>2|0,c=0;r:{i:{n:{s:switch(0|(A=3&_)){case 0:break i;case 3:break s;default:break n}if(n=0,(s=s+a|0)>>>0>=u>>>0)break e;St(y+(a<<2)|0,0,4+(252&_)|0),a=s;break r}for(;;){if((0|n)>=(0|g)&l>>>0>=E>>>0|(0|n)>(0|g))break t;if(u=d[l+x|0],n=(l=l+1|0)?n:n+1|0,h[t+16>>2]=l,h[t+20>>2]=n,s|=u<<(c<<3|6),(0|A)==(0|(c=c+1|0)))break}}h[y+(a<<2)>>2]=s}if(!((u=h[o+12>>2])>>>0>(a=a+1|0)>>>0))break}if(l=o+16|0,E=h[o>>2],s=h[o+16>>2],(n=h[o+20>>2]-s|0)>>>0<=4194303?er(l,1048576-(n>>>2|0)|0):4194304!=(0|n)&&(h[o+20>>2]=s+4194304),a=h[(n=o+28|0)>>2],(s=h[o+32>>2]-a>>3)>>>0<u>>>0)tr(n,u-s|0),a=h[n>>2];else if(s>>>0>u>>>0&&(h[o+32>>2]=(u<<3)+a),!u)break t;for(c=0,o=0;;){if(g=h[(n=(c<<2)+E|0)>>2],s=o,h[4+(_=(c<<3)+a|0)>>2]=s,h[_>>2]=g,(o=(n=h[n>>2])+s|0)>>>0>1048576)break t;if(!(s>>>0>=o>>>0)){if(g=h[l>>2],_=0,y=7&n)for(;h[g+(s<<2)>>2]=c,s=s+1|0,(0|y)!=(0|(_=_+1|0)););if(!(n-1>>>0<=6))for(;h[(n=g+(s<<2)|0)>>2]=c,h[n+28>>2]=c,h[n+24>>2]=c,h[n+20>>2]=c,h[n+16>>2]=c,h[n+12>>2]=c,h[n+8>>2]=c,h[n+4>>2]=c,(0|o)!=(0|(s=s+8|0)););}if((0|u)==(0|(c=c+1|0)))break}m=1048576==(0|o)}n=m}if(!(!n|(h[i+20>>2]?0:e))){o=0,N=c=N-16|0;e:{if(f[t+38>>1]<=511){if(u=s=h[t+12>>2],n=h[t+20>>2],n=(l=(m=h[t+16>>2])+8|0)>>>0<8?n+1|0:n,(a=h[t+8>>2])>>>0<l>>>0&(0|n)>=(0|s)|(0|n)>(0|s))break e;m=m+h[t>>2]|0,s=d[0|m]|d[m+1|0]<<8|d[m+2|0]<<16|d[m+3|0]<<24,m=d[m+4|0]|d[m+5|0]<<8|d[m+6|0]<<16|d[m+7|0]<<24,h[t+16>>2]=l,h[t+20>>2]=n}else{if(!hr(1,c+8|0,t))break e;l=h[t+16>>2],n=h[t+20>>2],a=h[t+8>>2],u=h[t+12>>2],s=h[c+8>>2],m=h[c+12>>2]}if(g=a-l|0,!((0|(a=u-(n+(l>>>0>a>>>0)|0)|0))==(0|m)&s>>>0>g>>>0|a>>>0<m>>>0||(n=n+m|0,n=(a=s+l|0)>>>0<s>>>0?n+1|0:n,h[t+16>>2]=a,h[t+20>>2]=n,(0|s)<=0))){t=l+h[t>>2]|0,h[i+48>>2]=t;t:if((l=d[0|(a=(n=s-1|0)+t|0)])>>>0<=63)h[i+52>>2]=n,t=63&d[0|a];else{switch((l>>>6|0)-1|0){case 0:if(s>>>0<2)break e;h[i+52>>2]=s-2,t=d[1+(t=(t+s|0)-2|0)|0]<<8&16128|d[0|t];break t;case 1:if(s>>>0<3)break e;h[i+52>>2]=s-3,t=d[2+(t=(t+s|0)-3|0)|0]<<16&4128768|d[t+1|0]<<8|d[0|t];break t}h[i+52>>2]=s-4,t=d[2+(t=(t+s|0)-4|0)|0]<<16|d[t+3|0]<<24&1056964608|d[t+1|0]<<8|d[0|t]}t=t+4194304|0,h[i+56>>2]=t,o=t>>>0<1073741824}}if(N=c+16|0,o)if(e)for(n=h[i+36>>2],s=h[i+48>>2],a=h[i+24>>2],t=h[i+56>>2];;){e:if(!(t>>>0>4194303))for(b=h[i+52>>2];;){if((0|b)<=0)break e;if(b=b-1|0,h[i+52>>2]=b,t=d[s+b|0]|t<<8,h[i+56>>2]=t,!(t>>>0<4194304))break}if(o=h[a+((l=1048575&t)<<2)>>2],t=(v(h[(m=n+(o<<3)|0)>>2],t>>>20|0)+l|0)-h[m+4>>2]|0,h[i+56>>2]=t,h[(w<<2)+r>>2]=o,b=1,(0|(w=w+1|0))==(0|e))break}else b=1}return(e=h[i+36>>2])&&(h[i+40>>2]=e,ve(e)),(e=h[i+24>>2])&&(h[i+28>>2]=e,ve(e)),(e=h[i+8>>2])&&(h[i+12>>2]=e,ve(e)),N=i- -64|0,b}function le(e,t,r,i){var n=0,o=0,a=0,l=0,c=0,p=_(0),v=0;e:{t:if(i){r:{i:switch(h[e+28>>2]-1|0){case 0:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(u[(a<<1)+i>>1]=s[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 1:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(u[(a<<1)+i>>1]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 2:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(u[(a<<1)+i>>1]=f[t>>1],t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 3:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((0|(n=u[t>>1]))<0)break t;if(u[(a<<1)+i>>1]=n,t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if(l=1,(0|r)>(0|n))break r;break t;case 4:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((n=h[t>>2])-32768>>>0<4294901760)break e;if(u[(a<<1)+i>>1]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 5:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((n=h[t>>2])>>>0>32767)break e;if(u[(a<<1)+i>>1]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 6:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=h[t>>2],-1==(0|(n=h[t+4>>2]-(c>>>0<32768)|0))&c-32768>>>0<4294901760|-1!=(0|n))break e;if(u[(a<<1)+i>>1]=c,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 7:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(!(n=h[t+4>>2])&(c=h[t>>2])>>>0>32767|n)break e;if(u[(a<<1)+i>>1]=c,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 8:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<1)+i|0,p=m[t>>2],n=_(b(p))<_(2147483648)?~~p:-2147483648,u[c>>1]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 9:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<1)+i|0,v=g[t>>3],n=b(v)<2147483648?~~v:-2147483648,u[c>>1]=n,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 10:break i;default:break t}if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(u[(a<<1)+i>>1]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)<=(0|n))break t}St((n<<1)+i|0,0,r-n<<1)}return l}return 0}function ce(e,t,r,i){var n=0,o=0,a=0,l=0,c=0,p=_(0),v=0;e:{t:if(i){r:{i:switch(h[e+28>>2]-1|0){case 0:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((0|(n=s[0|t]))<0)break t;if(u[(a<<1)+i>>1]=255&n,t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if(l=1,(0|r)>(0|n))break r;break t;case 1:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(u[(a<<1)+i>>1]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 2:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((0|(n=u[t>>1]))<0)break t;if(u[(a<<1)+i>>1]=n,t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if(l=1,(0|r)>(0|n))break r;break t;case 3:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(u[(a<<1)+i>>1]=f[t>>1],t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 4:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((n=h[t>>2])>>>0>65535)break e;if(u[(a<<1)+i>>1]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 5:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((n=h[t>>2])>>>0>65535)break e;if(u[(a<<1)+i>>1]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 6:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(!(n=h[t+4>>2])&(c=h[t>>2])>>>0>65535|n)break e;if(u[(a<<1)+i>>1]=c,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 7:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(!(n=h[t+4>>2])&(c=h[t>>2])>>>0>65535|n)break e;if(u[(a<<1)+i>>1]=c,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 8:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<1)+i|0,n=(p=m[t>>2])<_(4294967296)&p>=_(0)?~~p>>>0:0,u[c>>1]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 9:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<1)+i|0,n=(v=g[t>>3])<4294967296&v>=0?~~v>>>0:0,u[c>>1]=n,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 10:break i;default:break t}if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(u[(a<<1)+i>>1]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)<=(0|n))break t}St((n<<1)+i|0,0,r-n<<1)}return l}return 0}function ue(e,t,r){var i,n=0,o=0,a=0,l=0,c=0;N=i=N-48|0,n=f[6693]|f[6694]<<16,o=f[6691]|f[6692]<<16,u[i+38>>1]=o,u[i+40>>1]=o>>>16,u[i+42>>1]=n,u[i+44>>1]=n>>>16,n=h[3345],h[i+32>>2]=h[3344],h[i+36>>2]=n,n=h[3343],h[i+24>>2]=h[3342],h[i+28>>2]=n,n=h[3341],h[i+16>>2]=h[3340],h[i+20>>2]=n,o=h[t+12>>2],n=h[t+20>>2],n=(l=(a=h[t+16>>2])+5|0)>>>0<5?n+1|0:n;e:{t:if(l>>>0>p[t+8>>2]&(0|n)>=(0|o)|(0|n)>(0|o)){if((t=Rr(i+16|0))>>>0>=4294967280)break e;r:{if(t>>>0>=11)r=mi(n=t+16&-16),h[i+8>>2]=-2147483648|n,h[i>>2]=r,h[i+4>>2]=t;else if(s[i+11|0]=t,r=i,!t)break r;He(r,i+16|0,t)}if(s[t+r|0]=0,h[e>>2]=-2,e=e+4|0,s[i+11|0]>=0){t=h[i+4>>2],h[e>>2]=h[i>>2],h[e+4>>2]=t,h[e+8>>2]=h[i+8>>2];break t}Ur(t=e,e=h[i>>2],h[i+4>>2]),ve(e)}else if(n=a+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,s[0|r]=o,s[r+1|0]=o>>>8,s[r+2|0]=o>>>16,s[r+3|0]=o>>>24,s[r+4|0]=d[n+4|0],n=h[t+20>>2],n=(o=h[t+16>>2]+5|0)>>>0<5?n+1|0:n,h[t+16>>2]=o,h[t+20>>2]=n,Sr(r,1404,5))t=mi(32),s[t+16|0]=d[1640],r=d[1636]|d[1637]<<8|d[1638]<<16|d[1639]<<24,n=d[1632]|d[1633]<<8|d[1634]<<16|d[1635]<<24,s[t+8|0]=n,s[t+9|0]=n>>>8,s[t+10|0]=n>>>16,s[t+11|0]=n>>>24,s[t+12|0]=r,s[t+13|0]=r>>>8,s[t+14|0]=r>>>16,s[t+15|0]=r>>>24,r=d[1628]|d[1629]<<8|d[1630]<<16|d[1631]<<24,n=d[1624]|d[1625]<<8|d[1626]<<16|d[1627]<<24,s[0|t]=n,s[t+1|0]=n>>>8,s[t+2|0]=n>>>16,s[t+3|0]=n>>>24,s[t+4|0]=r,s[t+5|0]=r>>>8,s[t+6|0]=r>>>16,s[t+7|0]=r>>>24,s[t+17|0]=0,h[e>>2]=-1,Ur(e+4|0,t,17),ve(t);else if((0|(a=h[t+12>>2]))<=(0|n)&p[t+8>>2]<=o>>>0|(0|n)>(0|a)){if((t=Rr(i+16|0))>>>0>=4294967280)break e;r:{if(t>>>0>=11)r=mi(n=t+16&-16),h[i+8>>2]=-2147483648|n,h[i>>2]=r,h[i+4>>2]=t;else if(s[i+11|0]=t,r=i,!t)break r;He(r,i+16|0,t)}if(s[t+r|0]=0,h[e>>2]=-2,e=e+4|0,s[i+11|0]>=0){t=h[i+4>>2],h[e>>2]=h[i>>2],h[e+4>>2]=t,h[e+8>>2]=h[i+8>>2];break t}Ur(t=e,e=h[i>>2],h[i+4>>2]),ve(e)}else if(s[r+5|0]=d[o+h[t>>2]|0],n=h[t+20>>2],n=(o=h[t+16>>2]+1|0)?n:n+1|0,h[t+16>>2]=o,h[t+20>>2]=n,(0|(a=h[t+12>>2]))<=(0|n)&p[t+8>>2]<=o>>>0|(0|n)>(0|a)){if((t=Rr(i+16|0))>>>0>=4294967280)break e;r:{if(t>>>0>=11)r=mi(n=t+16&-16),h[i+8>>2]=-2147483648|n,h[i>>2]=r,h[i+4>>2]=t;else if(s[i+11|0]=t,r=i,!t)break r;He(r,i+16|0,t)}if(s[t+r|0]=0,h[e>>2]=-2,e=e+4|0,s[i+11|0]>=0){t=h[i+4>>2],h[e>>2]=h[i>>2],h[e+4>>2]=t,h[e+8>>2]=h[i+8>>2];break t}Ur(t=e,e=h[i>>2],h[i+4>>2]),ve(e)}else if(s[r+6|0]=d[o+h[t>>2]|0],n=h[t+20>>2],n=(o=h[t+16>>2]+1|0)?n:n+1|0,h[t+16>>2]=o,h[t+20>>2]=n,(0|(a=h[t+12>>2]))<=(0|n)&p[t+8>>2]<=o>>>0|(0|n)>(0|a)){if((t=Rr(i+16|0))>>>0>=4294967280)break e;r:{if(t>>>0>=11)r=mi(n=t+16&-16),h[i+8>>2]=-2147483648|n,h[i>>2]=r,h[i+4>>2]=t;else if(s[i+11|0]=t,r=i,!t)break r;He(r,i+16|0,t)}if(s[t+r|0]=0,h[e>>2]=-2,e=e+4|0,s[i+11|0]>=0){t=h[i+4>>2],h[e>>2]=h[i>>2],h[e+4>>2]=t,h[e+8>>2]=h[i+8>>2];break t}Ur(t=e,e=h[i>>2],h[i+4>>2]),ve(e)}else if(s[r+7|0]=d[o+h[t>>2]|0],n=h[t+20>>2],n=(o=h[t+16>>2]+1|0)?n:n+1|0,h[t+16>>2]=o,h[t+20>>2]=n,(0|(a=h[t+12>>2]))<=(0|n)&p[t+8>>2]<=o>>>0|(0|n)>(0|a)){if(t=Hr(i,i+16|0),h[e>>2]=-2,e=e+4|0,s[t+11|0]>=0){t=h[i+4>>2],h[e>>2]=h[i>>2],h[e+4>>2]=t,h[e+8>>2]=h[i+8>>2];break t}if(Ur(e,h[t>>2],h[t+4>>2]),s[t+11|0]>=0)break t;ve(h[t>>2])}else if(s[r+8|0]=d[o+h[t>>2]|0],o=n=h[t+20>>2],n=(a=(c=h[t+16>>2])+1|0)?n:n+1|0,h[t+16>>2]=a,h[t+20>>2]=n,l=h[t+12>>2],n=o,n=(o=c+3|0)>>>0<3?n+1|0:n,o>>>0>p[t+8>>2]&(0|n)>=(0|l)|(0|n)>(0|l)){if(t=Hr(i,i+16|0),h[e>>2]=-2,e=e+4|0,s[t+11|0]>=0){t=h[i+4>>2],h[e>>2]=h[i>>2],h[e+4>>2]=t,h[e+8>>2]=h[i+8>>2];break t}if(Ur(e,h[t>>2],h[t+4>>2]),s[t+11|0]>=0)break t;ve(h[t>>2])}else o=r,r=a+h[t>>2]|0,u[o+10>>1]=d[0|r]|d[r+1|0]<<8,n=h[t+20>>2],n=(r=h[t+16>>2]+2|0)>>>0<2?n+1|0:n,h[t+16>>2]=r,h[t+20>>2]=n,h[e+8>>2]=0,h[e+12>>2]=0,h[e>>2]=0,h[e+4>>2]=0;return void(N=i+48|0)}mn(),S()}function he(e,t,r,i){var n=0,o=0,a=0,l=0,c=0,p=_(0),v=0;e:{t:if(i){r:{i:switch(h[e+28>>2]-1|0){case 0:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=s[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 1:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 2:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=u[t>>1],t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 3:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=f[t>>1],t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 4:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=h[t>>2],t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 5:if((0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if((0|(n=h[t>>2]))<0)break t;if(h[(a<<2)+i>>2]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if(l=1,(0|r)>(0|n))break r;break t;case 6:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(n=h[t>>2],-1!=(h[t+4>>2]-(n>>>0<2147483648)|0))break e;if(h[(a<<2)+i>>2]=n,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 7:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(!(n=h[t+4>>2])&(c=h[t>>2])>>>0>2147483647|n)break e;if(h[(a<<2)+i>>2]=c,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 8:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<2)+i|0,p=m[t>>2],n=_(b(p))<_(2147483648)?~~p:-2147483648,h[c>>2]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 9:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<2)+i|0,v=g[t>>3],n=b(v)<2147483648?~~v:-2147483648,h[c>>2]=n,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 10:break i;default:break t}if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)<=(0|n))break t}St((n<<2)+i|0,0,r-n<<2)}return l}return 0}function de(e,t,r,i){var n=0,o=0,a=0,l=0,c=0,p=_(0),v=0;e:{t:if(i){r:{i:switch(h[e+28>>2]-1|0){case 0:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=s[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 1:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 2:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=u[t>>1],t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 3:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=f[t>>1],t=t+2|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 4:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=h[t>>2],t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 5:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=h[t>>2],t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 6:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(n=h[t>>2],h[t+4>>2])break e;if(h[(a<<2)+i>>2]=n,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 7:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(n=h[t>>2],h[t+4>>2])break e;if(h[(a<<2)+i>>2]=n,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 8:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<2)+i|0,n=(p=m[t>>2])<_(4294967296)&p>=_(0)?~~p>>>0:0,h[c>>2]=n,t=t+4|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 9:if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(c=(a<<2)+i|0,n=(v=g[t>>3])<4294967296&v>=0?~~v>>>0:0,h[c>>2]=n,t=t+8|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)>(0|n))break r;break t;case 10:break i;default:break t}if(l=1,(0|((0|r)<(0|(n=s[e+24|0]))?r:n))>0)for(n=h[e>>2],t=(o=h[n>>2])+(t=h[e+48>>2]+qr(h[e+40>>2],h[e+44>>2],t,0)|0)|0,o=h[n+4>>2];;){if(t>>>0>=o>>>0)break e;if(h[(a<<2)+i>>2]=d[0|t],t=t+1|0,!((0|(a=a+1|0))<(0|((0|r)<(0|(n=s[e+24|0]))?r:n))))break}if((0|r)<=(0|n))break t}St((n<<2)+i|0,0,r-n<<2)}return l}return 0}function fe(e,t,r,i){var n,o=0,a=0,l=0,c=0,u=0,f=0;if(N=n=N-80|0,o=h[r+36>>2],h[n+72>>2]=h[r+32>>2],h[n+76>>2]=o,a=h[r+28>>2],h[(o=n- -64|0)>>2]=h[r+24>>2],h[o+4>>2]=a,o=h[r+20>>2],h[n+56>>2]=h[r+16>>2],h[n+60>>2]=o,o=h[r+12>>2],h[n+48>>2]=h[r+8>>2],h[n+52>>2]=o,o=h[r+4>>2],h[n+40>>2]=h[r>>2],h[n+44>>2]=o,ue(e,n+40|0,n+24|0),!h[e>>2])if(u=e+4|0,s[e+15|0]<0&&ve(h[u>>2]),d[n+31|0])t=mi(32),r=d[1665]|d[1666]<<8|d[1667]<<16|d[1668]<<24,s[t+23|0]=r,s[t+24|0]=r>>>8,s[t+25|0]=r>>>16,s[t+26|0]=r>>>24,r=d[1662]|d[1663]<<8|d[1664]<<16|d[1665]<<24,i=d[1658]|d[1659]<<8|d[1660]<<16|d[1661]<<24,s[t+16|0]=i,s[t+17|0]=i>>>8,s[t+18|0]=i>>>16,s[t+19|0]=i>>>24,s[t+20|0]=r,s[t+21|0]=r>>>8,s[t+22|0]=r>>>16,s[t+23|0]=r>>>24,r=d[1654]|d[1655]<<8|d[1656]<<16|d[1657]<<24,i=d[1650]|d[1651]<<8|d[1652]<<16|d[1653]<<24,s[t+8|0]=i,s[t+9|0]=i>>>8,s[t+10|0]=i>>>16,s[t+11|0]=i>>>24,s[t+12|0]=r,s[t+13|0]=r>>>8,s[t+14|0]=r>>>16,s[t+15|0]=r>>>24,r=d[1646]|d[1647]<<8|d[1648]<<16|d[1649]<<24,i=d[1642]|d[1643]<<8|d[1644]<<16|d[1645]<<24,s[0|t]=i,s[t+1|0]=i>>>8,s[t+2|0]=i>>>16,s[t+3|0]=i>>>24,s[t+4|0]=r,s[t+5|0]=r>>>8,s[t+6|0]=r>>>16,s[t+7|0]=r>>>24,s[t+27|0]=0,h[e>>2]=-1,Ur(u,t,27),ve(t);else{N=c=N-16|0;e:{switch(s[n+32|0]){case 0:o=mi(44),h[o>>2]=0,h[o+4>>2]=0,h[o+40>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0,a=si(o),h[o>>2]=13528,h[n+8>>2]=0,h[n+12>>2]=0,h[n>>2]=0,h[n+4>>2]=0,h[n+16>>2]=a;break e;case 1:o=mi(44),h[o>>2]=0,h[o+4>>2]=0,h[o+40>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0,a=si(o),h[o>>2]=13436,h[n+8>>2]=0,h[n+12>>2]=0,h[n>>2]=0,h[n+4>>2]=0,h[n+16>>2]=a;break e}a=mi(32),o=d[1694]|d[1695]<<8|d[1696]<<16|d[1697]<<24,s[a+24|0]=o,s[a+25|0]=o>>>8,s[a+26|0]=o>>>16,s[a+27|0]=o>>>24,o=d[1690]|d[1691]<<8|d[1692]<<16|d[1693]<<24,l=d[1686]|d[1687]<<8|d[1688]<<16|d[1689]<<24,s[a+16|0]=l,s[a+17|0]=l>>>8,s[a+18|0]=l>>>16,s[a+19|0]=l>>>24,s[a+20|0]=o,s[a+21|0]=o>>>8,s[a+22|0]=o>>>16,s[a+23|0]=o>>>24,o=d[1682]|d[1683]<<8|d[1684]<<16|d[1685]<<24,l=d[1678]|d[1679]<<8|d[1680]<<16|d[1681]<<24,s[a+8|0]=l,s[a+9|0]=l>>>8,s[a+10|0]=l>>>16,s[a+11|0]=l>>>24,s[a+12|0]=o,s[a+13|0]=o>>>8,s[a+14|0]=o>>>16,s[a+15|0]=o>>>24,o=d[1674]|d[1675]<<8|d[1676]<<16|d[1677]<<24,l=d[1670]|d[1671]<<8|d[1672]<<16|d[1673]<<24,s[0|a]=l,s[a+1|0]=l>>>8,s[a+2|0]=l>>>16,s[a+3|0]=l>>>24,s[a+4|0]=o,s[a+5|0]=o>>>8,s[a+6|0]=o>>>16,s[a+7|0]=o>>>24,s[a+28|0]=0,h[c>>2]=-1,Ur(o=4|c,a,28),f=s[c+15|0],h[n>>2]=h[c>>2],l=n+4|0,(0|f)>=0?(f=h[o+4>>2],h[l>>2]=h[o>>2],h[l+4>>2]=f,h[l+8>>2]=h[o+8>>2]):Ur(l,h[c+4>>2],h[c+8>>2]),h[n+16>>2]=0,s[c+15|0]<0&&ve(h[c+4>>2]),ve(a)}N=c+16|0;e:if(o=h[n>>2]){if(h[e>>2]=o,s[n+15|0]>=0){t=h[4+(e=4|n)>>2],h[u>>2]=h[e>>2],h[u+4>>2]=t,h[u+8>>2]=h[e+8>>2];break e}Ur(u,h[n+4>>2],h[n+8>>2])}else o=h[n+16>>2],h[n+16>>2]=0,F(e,o,t,r,i),h[e>>2]||(s[u+11|0]<0&&ve(h[u>>2]),h[e>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0),Cn[h[h[o>>2]+4>>2]](o);e=h[n+16>>2],h[n+16>>2]=0,e&&Cn[h[h[e>>2]+4>>2]](e),s[n+15|0]>=0||ve(h[n+4>>2])}N=n+80|0}function pe(e,t){var r=0,i=0,n=0,o=0,a=0,l=0;if((o=((r=h[e+4>>2])-(i=h[e>>2])|0)/144|0)>>>0<t>>>0)if(i=e,(a=t-o|0)>>>0<=((r=h[e+8>>2])-(e=h[e+4>>2])|0)/144>>>0){if(a){for(t=v(a,144)+e|0;h[e>>2]=-1,gr(e+4|0),h[e+104>>2]=0,h[e+108>>2]=0,s[e+100|0]=1,h[e+112>>2]=0,h[e+116>>2]=0,h[e+120>>2]=0,h[e+124>>2]=0,h[e+128>>2]=0,h[e+132>>2]=0,h[e+136>>2]=0,h[e+140>>2]=0,(0|t)!=(0|(e=e+144|0)););e=t}h[i+4>>2]=e}else{e:{t:{r:{if((l=(o=((t=e)-(e=h[i>>2])|0)/144|0)+a|0)>>>0<29826162){if(e=(t=(r-e|0)/144|0)<<1,n=t>>>0<14913080?e>>>0<l>>>0?l:e:29826161){if(n>>>0>=29826162)break r;r=mi(v(n,144))}else r=0;for(l=(t=r+v(o,144)|0)+v(a,144)|0,e=t;h[e>>2]=-1,gr(e+4|0),h[e+104>>2]=0,h[e+108>>2]=0,s[e+100|0]=1,h[e+112>>2]=0,h[e+116>>2]=0,h[e+120>>2]=0,h[e+124>>2]=0,h[e+128>>2]=0,h[e+132>>2]=0,h[e+136>>2]=0,h[e+140>>2]=0,(0|l)!=(0|(e=e+144|0)););if(o=r+v(n,144)|0,(0|(e=h[i+4>>2]))==(0|(n=h[i>>2])))break t;for(;e=e-144|0,h[(t=t-144|0)>>2]=h[e>>2],h[t+4>>2]=h[e+4>>2],h[t+8>>2]=h[e+8>>2],h[t+12>>2]=h[e+12>>2],h[e+12>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[t+16>>2]=h[e+16>>2],h[t+20>>2]=h[e+20>>2],h[t+24>>2]=h[e+24>>2],h[e+24>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,r=d[e+28|0],h[t+40>>2]=0,h[t+32>>2]=0,h[t+36>>2]=0,s[t+28|0]=r,h[t+32>>2]=h[e+32>>2],h[t+36>>2]=h[e+36>>2],h[t+40>>2]=h[e+40>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[t+52>>2]=0,h[t+44>>2]=0,h[t+48>>2]=0,h[t+44>>2]=h[e+44>>2],h[t+48>>2]=h[e+48>>2],h[t+52>>2]=h[e+52>>2],h[e+52>>2]=0,h[e+44>>2]=0,h[e+48>>2]=0,h[(r=t- -64|0)>>2]=0,h[t+56>>2]=0,h[t+60>>2]=0,h[t+56>>2]=h[e+56>>2],h[t+60>>2]=h[e+60>>2],a=r,r=e- -64|0,h[a>>2]=h[r>>2],h[r>>2]=0,h[e+56>>2]=0,h[e+60>>2]=0,h[t+68>>2]=h[e+68>>2],r=h[e+72>>2],h[t+84>>2]=0,h[t+76>>2]=0,h[t+80>>2]=0,h[t+72>>2]=r,h[t+76>>2]=h[e+76>>2],h[t+80>>2]=h[e+80>>2],h[t+84>>2]=h[e+84>>2],h[e+84>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[t+96>>2]=0,h[t+88>>2]=0,h[t+92>>2]=0,h[t+88>>2]=h[e+88>>2],h[t+92>>2]=h[e+92>>2],h[t+96>>2]=h[e+96>>2],h[e+96>>2]=0,h[e+88>>2]=0,h[e+92>>2]=0,r=d[e+100|0],h[t+112>>2]=0,h[t+104>>2]=0,h[t+108>>2]=0,s[t+100|0]=r,h[t+104>>2]=h[e+104>>2],h[t+108>>2]=h[e+108>>2],h[t+112>>2]=h[e+112>>2],h[e+112>>2]=0,h[e+104>>2]=0,h[e+108>>2]=0,h[t+124>>2]=0,h[t+116>>2]=0,h[t+120>>2]=0,h[t+116>>2]=h[e+116>>2],h[t+120>>2]=h[e+120>>2],h[t+124>>2]=h[e+124>>2],h[e+124>>2]=0,h[e+116>>2]=0,h[e+120>>2]=0,r=h[e+128>>2],h[t+140>>2]=0,h[t+132>>2]=0,h[t+136>>2]=0,h[t+128>>2]=r,h[t+132>>2]=h[e+132>>2],h[t+136>>2]=h[e+136>>2],h[t+140>>2]=h[e+140>>2],h[e+140>>2]=0,h[e+132>>2]=0,h[e+136>>2]=0,(0|e)!=(0|n););if(h[i+8>>2]=o,e=h[i+4>>2],h[i+4>>2]=l,n=h[i>>2],h[i>>2]=t,(0|e)==(0|n))break e;for(;(t=h[e-12>>2])&&(h[e-8>>2]=t,ve(t)),(t=h[e-28>>2])&&(h[e-24>>2]=t,ve(t)),(t=h[e-40>>2])&&(h[e-36>>2]=t,ve(t)),Nr(e-140|0),(0|n)!=(0|(e=e-144|0)););break e}vn(),S()}Zr(1336),S()}h[i+8>>2]=o,h[i+4>>2]=l,h[i>>2]=t}n&&ve(n)}else if(t>>>0<o>>>0){if((0|(i=i+v(t,144)|0))!=(0|r))for(;(t=h[r-12>>2])&&(h[r-8>>2]=t,ve(t)),(t=h[r-28>>2])&&(h[r-24>>2]=t,ve(t)),(t=h[r-40>>2])&&(h[r-36>>2]=t,ve(t)),Nr(r-140|0),(0|i)!=(0|(r=r-144|0)););h[e+4>>2]=i}}function me(e,t,r){t|=0,r|=0;var i,n=0,o=0,a=0,l=0,c=0,u=0,f=0,p=0,m=0,g=0,v=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0;if(N=i=N-96|0,n=h[16+(e|=0)>>2],s[i+92|0]=1,h[i+88>>2]=t,h[i+84>>2]=t,h[i+80>>2]=n,-1!=(0|t)&&(m=h[e+20>>2],o=h[m>>2],!((n=h[h[n>>2]+(t<<2)>>2])>>>0>=h[m+4>>2]-o>>2>>>0))){n=h[h[e+8>>2]+(h[o+(n<<2)>>2]<<2)>>2],o=h[e+4>>2],d[o+84|0]||(n=h[h[o+68>>2]+(n<<2)>>2]),h[i+72>>2]=0,h[i+76>>2]=0,h[(m=i- -64|0)>>2]=0,h[m+4>>2]=0,h[i+56>>2]=0,h[i+60>>2]=0,se(o,n,s[o+24|0],i+56|0),m=((n=t+1|0)>>>0)%3|0?n:t-2|0,l=((t>>>0)%3|0?-1:2)+t|0;e:{t:{for(;;){if(o=m,n=l,h[e+28>>2]&&(o=((n=t+1|0)>>>0)%3|0?n:t-2|0,n=t-1|0,(t>>>0)%3|0||(n=t+2|0)),-1==(0|o))break e;if(f=h[e+20>>2],t=h[f>>2],(o=h[h[h[e+16>>2]>>2]+(o<<2)>>2])>>>0>=h[f+4>>2]-t>>2>>>0)break e;if(o=h[h[e+8>>2]+(h[(o<<2)+t>>2]<<2)>>2],t=h[e+4>>2],d[t+84|0]||(o=h[h[t+68>>2]+(o<<2)>>2]),h[i+48>>2]=0,h[i+52>>2]=0,h[i+40>>2]=0,h[i+44>>2]=0,h[i+32>>2]=0,h[i+36>>2]=0,se(t,o,s[t+24|0],i+32|0),-1==(0|n))break t;if(o=h[e+20>>2],t=h[o>>2],(n=h[h[h[e+16>>2]>>2]+(n<<2)>>2])>>>0>=h[o+4>>2]-t>>2>>>0)break t;if(o=h[h[e+8>>2]+(h[t+(n<<2)>>2]<<2)>>2],t=h[e+4>>2],d[t+84|0]||(o=h[h[t+68>>2]+(o<<2)>>2]),h[i+24>>2]=0,h[i+28>>2]=0,h[i+16>>2]=0,h[i+20>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0,se(t,o,s[t+24|0],i+8|0),o=(n=h[i+8>>2])-(t=h[i+56>>2])|0,f=h[i+60>>2],g=h[i+12>>2]-(f+(t>>>0>n>>>0)|0)|0,E=(c=h[i+40>>2])-(n=h[i+64>>2])|0,w=h[i+68>>2],x=qr(o,g,E,c=h[i+44>>2]-(w+(n>>>0>c>>>0)|0)|0),a=a-(G+(u>>>0<x>>>0)|0)|0,T=A=u-x|0,n=qr(x=(u=h[i+16>>2])-n|0,w=h[i+20>>2]-((n>>>0>u>>>0)+w|0)|0,A=(u=h[i+32>>2])-t|0,f=h[i+36>>2]-((t>>>0>u>>>0)+f|0)|0),t=G+a|0,a=t=n>>>0>(u=T+n|0)>>>0?t+1|0:t,T=v,_=g,g=(t=h[i+48>>2])-(n=h[i+72>>2])|0,v=h[i+76>>2],_=qr(o,_,g,M=h[i+52>>2]-(v+(t>>>0<n>>>0)|0)|0),t=G+p|0,t=(o=T+_|0)>>>0<_>>>0?t+1|0:t,v=o-(p=qr(_=(p=h[i+24>>2])-n|0,n=h[i+28>>2]-((n>>>0>p>>>0)+v|0)|0,A,f))|0,p=t-(G+(o>>>0<p>>>0)|0)|0,o=b-(t=qr(x,w,g,M))|0,t=y-(G+(t>>>0>b>>>0)|0)|0,y=qr(_,n,E,c),t=G+t|0,y=t=(b=y+o|0)>>>0<y>>>0?t+1|0:t,bt(i+80|0),-1==(0|(t=h[i+88>>2])))break}o=(t=y>>31)+b|0,n=t,t=t+y|0,f=o^n,l=n^(o>>>0<n>>>0?t+1|0:t),g=-1,o=2147483647,c=t=p>>31,n=t+v|0,t=t+p|0,t=n>>>0<c>>>0?t+1|0:t,n^=c,c=t^=c,E=-1^n,t^=2147483647,m=a;r:{if(h[e+28>>2]){if(!((0|t)==(0|l)&f>>>0>E>>>0|t>>>0<l>>>0)&&(t=l+c|0,n=t=(e=n+f|0)>>>0<n>>>0?t+1|0:t,l=a,a=(t=a>>31)+u|0,c=l,l=t,t=c+t|0,t=a>>>0<l>>>0?t+1|0:t,a^=l,!((0|(l=2147483647^(t^=l)))==(0|n)&(-1^a)>>>0<e>>>0|n>>>0>l>>>0)&&(t=t+n|0,g=e=e+a|0,o=t=e>>>0<a>>>0?t+1|0:t,!t&e>>>0<536870913)))break r;t=o>>>29|0,e=(536870911&o)<<3|g>>>29}else{if((0|t)==(0|l)&f>>>0>E>>>0|t>>>0<l>>>0)break r;if(t=l+c|0,t=(e=n+f|0)>>>0<n>>>0?t+1|0:t,n=e,e=t,o=(t=a>>31)+u|0,l=a,a=t,t=l+t|0,l=o^a,a^=t=o>>>0<a>>>0?t+1|0:t,t=o=l+n|0,e=(0|(a^=2147483647))==(0|e)&(-1^l)>>>0<n>>>0|e>>>0>a>>>0,(a=!0)&(0|(e=e?-1:t))<=536870912|(0|e)<536870912)break r;t=0,e=e>>>29|0}u=$r(u,m,e,t),v=$r(v,p,e,t),b=$r(b,y,e,t)}return h[r+8>>2]=u,h[r+4>>2]=v,h[r>>2]=b,void(N=i+96|0)}An(),S()}An(),S()}An(),S()}function ge(e,t){e|=0;var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0;if(!((0|(t|=0))<0||(i=h[e+12>>2])-(r=h[e+8>>2])>>2>>>0<=t>>>0)){s=h[(n=r+(t<<2)|0)>>2],l=h[s+60>>2],o=h[s+56>>2];e:{if((0|(r=n+4|0))!=(0|i)){for(;a=h[r>>2],h[r>>2]=0,h[n>>2]=a,s&&Wr(s),n=n+4|0,(0|(r=r+4|0))!=(0|i);)s=h[n>>2];if((0|n)==(0|(i=h[e+12>>2])))break e}for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Wr(r),(0|i)!=(0|n););}h[e+12>>2]=n;e:if(!(!(s=h[e+4>>2])|(0|l)<0)&&(0|(i=h[s+24>>2]))!=(0|(r=h[s+28>>2])))for(;;){if((0|l)==h[h[i>>2]+24>>2]){t:{if((0|(n=i+4|0))!=(0|(l=h[s+28>>2]))){for(;a=h[n>>2],h[n>>2]=0,r=h[i>>2],h[i>>2]=a,r&&(ni(r+12|0,h[r+16>>2]),fi(r,h[r+4>>2]),ve(r)),i=i+4|0,(0|l)!=(0|(n=n+4|0)););if((0|(n=h[s+28>>2]))==(0|i))break t}for(;r=h[(n=n-4|0)>>2],h[n>>2]=0,r&&(ni(r+12|0,h[r+16>>2]),fi(r,h[r+4>>2]),ve(r)),(0|i)!=(0|n););}h[s+28>>2]=i;break e}if((0|r)==(0|(i=i+4|0)))break}e:if(!((0|o)>4)){t:if(n=v(o,12)+e|0,(0|(i=h[n+20>>2]))!=(0|(r=h[n+24>>2]))){for(;;){if(h[i>>2]==(0|t))break t;if((0|r)==(0|(i=i+4|0)))break}break e}(0|i)!=(0|r)&&((r=r-(s=i+4|0)|0)&&Et(i,s,r),h[n+24>>2]=i+r)}if(n=h[e+20>>2],r=h[e+24>>2]-n|0){if(l=1&(s=(i=r>>2)>>>0>1?i:1),i=0,r>>>0>=8)for(s&=-2,r=0;(0|(c=h[(a=(o=i<<2)+n|0)>>2]))>(0|t)&&(h[a>>2]=c-1),(0|(a=h[(o=n+(4|o)|0)>>2]))>(0|t)&&(h[o>>2]=a-1),i=i+2|0,(0|s)!=(0|(r=r+2|0)););l&&((0|(r=h[(i=n+(i<<2)|0)>>2]))<=(0|t)||(h[i>>2]=r-1))}if(n=h[e+32>>2],r=h[e+36>>2]-n|0){if(l=1&(s=(i=r>>2)>>>0>1?i:1),i=0,r>>>0>=8)for(s&=-2,r=0;(0|(c=h[(a=(o=i<<2)+n|0)>>2]))>(0|t)&&(h[a>>2]=c-1),(0|(a=h[(o=n+(4|o)|0)>>2]))>(0|t)&&(h[o>>2]=a-1),i=i+2|0,(0|s)!=(0|(r=r+2|0)););l&&((0|(r=h[(i=n+(i<<2)|0)>>2]))<=(0|t)||(h[i>>2]=r-1))}if(n=h[e+44>>2],r=h[e+48>>2]-n|0){if(l=1&(s=(i=r>>2)>>>0>1?i:1),i=0,r>>>0>=8)for(s&=-2,r=0;(0|(c=h[(a=(o=i<<2)+n|0)>>2]))>(0|t)&&(h[a>>2]=c-1),(0|(a=h[(o=n+(4|o)|0)>>2]))>(0|t)&&(h[o>>2]=a-1),i=i+2|0,(0|s)!=(0|(r=r+2|0)););l&&((0|(r=h[(i=n+(i<<2)|0)>>2]))<=(0|t)||(h[i>>2]=r-1))}if(n=h[e+56>>2],r=h[e+60>>2]-n|0){if(l=1&(s=(i=r>>2)>>>0>1?i:1),i=0,r>>>0>=8)for(s&=-2,r=0;(0|(c=h[(a=(o=i<<2)+n|0)>>2]))>(0|t)&&(h[a>>2]=c-1),(0|(a=h[(o=n+(4|o)|0)>>2]))>(0|t)&&(h[o>>2]=a-1),i=i+2|0,(0|s)!=(0|(r=r+2|0)););l&&((0|(r=h[(i=n+(i<<2)|0)>>2]))<=(0|t)||(h[i>>2]=r-1))}if(r=(r=h[e+72>>2])-(e=h[e+68>>2])|0){if(s=1&(n=(i=r>>2)>>>0>1?i:1),i=0,r>>>0>=8)for(n&=-2,r=0;(0|(a=h[(o=(l=i<<2)+e|0)>>2]))>(0|t)&&(h[o>>2]=a-1),(0|(o=h[(l=e+(4|l)|0)>>2]))>(0|t)&&(h[l>>2]=o-1),i=i+2|0,(0|n)!=(0|(r=r+2|0)););s&&((0|(r=t))>=(0|(t=h[(e=e+(i<<2)|0)>>2]))||(h[e>>2]=t-1))}}}function ve(e){var t=0,r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0;e:if(e|=0){s=(i=e-8|0)+(e=-8&(t=h[e-4>>2]))|0;t:if(!(1&t)){if(!(3&t))break e;if((i=i-(t=h[i>>2])|0)>>>0<p[4237])break e;if(e=e+t|0,h[4238]==(0|i)){if(3==(3&(t=h[s+4>>2])))return h[4235]=e,h[s+4>>2]=-2&t,h[i+4>>2]=1|e,void(h[e+i>>2]=e)}else{if(t>>>0<=255){if(n=h[i+8>>2],t=t>>>3|0,(0|(r=h[i+12>>2]))==(0|n)){l=16932,c=h[4233]&ki(t),h[l>>2]=c;break t}h[n+12>>2]=r,h[r+8>>2]=n;break t}if(a=h[i+24>>2],(0|i)==(0|(t=h[i+12>>2])))if((r=h[(n=i+20|0)>>2])||(r=h[(n=i+16|0)>>2])){for(;o=n,(r=h[(n=(t=r)+20|0)>>2])||(n=t+16|0,r=h[t+16>>2]););h[o>>2]=0}else t=0;else r=h[i+8>>2],h[r+12>>2]=t,h[t+8>>2]=r;if(!a)break t;n=h[i+28>>2];r:{if(h[(r=17236+(n<<2)|0)>>2]==(0|i)){if(h[r>>2]=t,t)break r;l=16936,c=h[4234]&ki(n),h[l>>2]=c;break t}if(h[a+(h[a+16>>2]==(0|i)?16:20)>>2]=t,!t)break t}if(h[t+24>>2]=a,(r=h[i+16>>2])&&(h[t+16>>2]=r,h[r+24>>2]=t),!(r=h[i+20>>2]))break t;h[t+20>>2]=r,h[r+24>>2]=t}}if(!(i>>>0>=s>>>0)&&1&(t=h[s+4>>2])){t:{if(!(2&t)){if(h[4239]==(0|s)){if(h[4239]=i,e=h[4236]+e|0,h[4236]=e,h[i+4>>2]=1|e,h[4238]!=(0|i))break e;return h[4235]=0,void(h[4238]=0)}if(h[4238]==(0|s))return h[4238]=i,e=h[4235]+e|0,h[4235]=e,h[i+4>>2]=1|e,void(h[e+i>>2]=e);e=(-8&t)+e|0;r:if(t>>>0<=255){if(n=h[s+8>>2],t=t>>>3|0,(0|(r=h[s+12>>2]))==(0|n)){l=16932,c=h[4233]&ki(t),h[l>>2]=c;break r}h[n+12>>2]=r,h[r+8>>2]=n}else{if(a=h[s+24>>2],(0|s)==(0|(t=h[s+12>>2])))if((r=h[(n=s+20|0)>>2])||(r=h[(n=s+16|0)>>2])){for(;o=n,(r=h[(n=(t=r)+20|0)>>2])||(n=t+16|0,r=h[t+16>>2]););h[o>>2]=0}else t=0;else r=h[s+8>>2],h[r+12>>2]=t,h[t+8>>2]=r;if(a){n=h[s+28>>2];i:{if(h[(r=17236+(n<<2)|0)>>2]==(0|s)){if(h[r>>2]=t,t)break i;l=16936,c=h[4234]&ki(n),h[l>>2]=c;break r}if(h[a+(h[a+16>>2]==(0|s)?16:20)>>2]=t,!t)break r}h[t+24>>2]=a,(r=h[s+16>>2])&&(h[t+16>>2]=r,h[r+24>>2]=t),(r=h[s+20>>2])&&(h[t+20>>2]=r,h[r+24>>2]=t)}}if(h[i+4>>2]=1|e,h[e+i>>2]=e,h[4238]!=(0|i))break t;return void(h[4235]=e)}h[s+4>>2]=-2&t,h[i+4>>2]=1|e,h[e+i>>2]=e}if(e>>>0<=255)return t=16972+((e=e>>>3|0)<<3)|0,(r=h[4233])&(e=1<<e)?e=h[t+8>>2]:(h[4233]=e|r,e=t),h[t+8>>2]=i,h[e+12>>2]=i,h[i+12>>2]=t,void(h[i+8>>2]=e);n=31,h[i+16>>2]=0,h[i+20>>2]=0,e>>>0<=16777215&&(t=e>>>8|0,t<<=o=t+1048320>>>16&8,n=28+((t=((t<<=n=t+520192>>>16&4)<<(r=t+245760>>>16&2)>>>15|0)-(r|n|o)|0)<<1|e>>>t+21&1)|0),h[i+28>>2]=n,o=17236+(n<<2)|0;t:{r:{if((r=h[4234])&(t=1<<n)){for(n=e<<(31==(0|n)?0:25-(n>>>1|0)|0),t=h[o>>2];;){if(r=t,(-8&h[t+4>>2])==(0|e))break r;if(t=n>>>29|0,n<<=1,!(t=h[16+(o=r+(4&t)|0)>>2]))break}h[o+16>>2]=i,h[i+24>>2]=r}else h[4234]=t|r,h[o>>2]=i,h[i+24>>2]=o;h[i+12>>2]=i,h[i+8>>2]=i;break t}e=h[r+8>>2],h[e+12>>2]=i,h[r+8>>2]=i,h[i+24>>2]=0,h[i+12>>2]=r,h[i+8>>2]=e}e=h[4241]-1|0,h[4241]=e||-1}}}function _e(e,t,r,i){var n,o=0,a=0,l=0,c=0,u=0,d=_(0),f=0,g=0,v=_(0);n=h[r>>2];e:{t:if(a=h[t+4>>2]){r:{if((l=Ii(a))>>>0>=2){if((o=n)>>>0>=a>>>0&&(o=(n>>>0)%(a>>>0)|0),!(r=h[h[t>>2]+(o<<2)>>2]))break t;if(l>>>0<=1)break r;for(;;){if(!(r=h[r>>2]))break t;if((0|(l=h[r+4>>2]))!=(0|n)&&(a>>>0<=l>>>0&&(l=(l>>>0)%(a>>>0)|0),(0|o)!=(0|l)))break t;if(h[r+8>>2]==(0|n))break}t=0;break e}if(o=a-1&n,!(r=h[h[t>>2]+(o<<2)>>2]))break t}for(l=a-1|0;;){if(!(r=h[r>>2]))break t;if((0|(c=h[r+4>>2]))!=(0|n)&(l&c)!=(0|o))break t;if(h[r+8>>2]==(0|n))break}t=0;break e}if(r=mi(16),i=h[h[i>>2]>>2],h[r+12>>2]=0,h[r+8>>2]=i,h[r+4>>2]=n,h[r>>2]=0,v=_(h[t+12>>2]+1>>>0),d=m[t+16>>2],v>_(d*_(a>>>0))||!a){l=0!=(a-1&a)|a>>>0<3|a<<1,o=2,1!=(0|(i=(i=(d=_(A(_(v/d))))<_(4294967296)&d>=_(0)?~~d>>>0:0)>>>0>l>>>0?i:l))&&(i&i-1?(o=Q(i),a=h[t+4>>2]):o=i);t:{if(o>>>0<=a>>>0){if(o>>>0>=a>>>0)break t;if(l=a>>>0<3,i=(d=_(A(_(_(p[t+12>>2])/m[t+16>>2]))))<_(4294967296)&d>=_(0)?~~d>>>0:0,(o=(i=l||Ii(a)>>>0>1?Q(i):i>>>0<2?i:1<<32-y(i-1|0))>>>0>o>>>0?i:o)>>>0>=a>>>0)break t}a=0,c=o;r:{i:{n:{s:{if(o){if(c>>>0>=1073741824)break s;if(o=mi(c<<2),i=h[t>>2],h[t>>2]=o,i&&ve(i),h[t+4>>2]=c,o=0,c-1>>>0>=3)for(l=-4&c;h[(i=o<<2)+h[t>>2]>>2]=0,h[h[t>>2]+(4|i)>>2]=0,h[h[t>>2]+(8|i)>>2]=0,h[h[t>>2]+(12|i)>>2]=0,o=o+4|0,(0|l)!=(0|(a=a+4|0)););if(i=3&c)for(;h[h[t>>2]+(o<<2)>>2]=0,o=o+1|0,(0|i)!=(0|(u=u+1|0)););if(!(a=h[t+8>>2]))break r;if(i=t+8|0,l=h[a+4>>2],(o=Ii(c))>>>0<2)break n;if(l=l>>>0>=c>>>0?(l>>>0)%(c>>>0)|0:l,h[h[t>>2]+(l<<2)>>2]=i,!(i=h[a>>2]))break r;if(o>>>0<=1)break i;for(;;){if(c>>>0<=(u=h[i+4>>2])>>>0&&(u=(u>>>0)%(c>>>0)|0),(0|l)!=(0|u))if(o=i,g=(f=u<<2)+h[t>>2]|0,h[g>>2]){for(;u=o,o=h[o>>2],h[i+8>>2]==h[o+8>>2]&&o;);h[a>>2]=o,h[u>>2]=h[h[f+h[t>>2]>>2]>>2],h[h[f+h[t>>2]>>2]>>2]=i}else h[g>>2]=a,a=i,l=u;else a=i;if(!(i=h[a>>2]))break}break r}i=h[t>>2],h[t>>2]=0,i&&ve(i),h[t+4>>2]=0;break r}Zr(1336),S()}if(l&=c-1,h[h[t>>2]+(l<<2)>>2]=i,!(i=h[a>>2]))break r}for(f=c-1|0;;){if((0|(c=f&h[i+4>>2]))!=(0|l))if(o=i,g=(u=c<<2)+h[t>>2]|0,h[g>>2]){for(;c=o,o=h[o>>2],h[i+8>>2]==h[o+8>>2]&&o;);h[a>>2]=o,h[c>>2]=h[h[u+h[t>>2]>>2]>>2],h[h[u+h[t>>2]>>2]>>2]=i}else h[g>>2]=a,a=i,l=c;else a=i;if(!(i=h[a>>2]))break}}}o=(i=(a=h[t+4>>2])-1|0)&a?a>>>0>n>>>0?n:(n>>>0)%(a>>>0)|0:i&n}o=h[t>>2]+(o<<2)|0;t:if(i=h[o>>2])h[r>>2]=h[i>>2],h[i>>2]=r;else{if(h[r>>2]=h[t+8>>2],h[t+8>>2]=r,h[o>>2]=t+8,!(i=h[r>>2]))break t;i=h[i+4>>2],(o=a-1|0)&a?i>>>0<a>>>0||(i=(i>>>0)%(a>>>0)|0):i&=o,h[h[t>>2]+(i<<2)>>2]=r}h[t+12>>2]=h[t+12>>2]+1,t=1}s[e+4|0]=t,h[e>>2]=r}function be(e){var t=0,r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;h[e+56>>2]=h[e+52>>2],h[e+44>>2]=h[e+40>>2];e:{t:{r:{if(n=h[e+64>>2],(0|(r=h[n+24>>2]))!=h[n+28>>2])for(;;){i=t;i:if(-1!=(0|(l=h[(c<<2)+r>>2]))){if((0|(t=h[e+56>>2]))==h[e+60>>2]){if((t=1+(o=(r=t-(n=h[e+52>>2])|0)>>2)|0)>>>0>=1073741824)break r;if(s=r>>1,s=r>>>0<2147483644?t>>>0>s>>>0?t:s:1073741823){if(s>>>0>=1073741824)break e;t=mi(s<<2)}else t=0;h[(o=t+(o<<2)|0)>>2]=i,(0|r)>0&&He(t,n,r),h[e+60>>2]=t+(s<<2),h[e+56>>2]=o+4,h[e+52>>2]=t,n&&ve(n)}else h[t>>2]=i,h[e+56>>2]=t+4;n:if(h[h[e+12>>2]+(c>>>3&536870908)>>2]>>>c&1&&-1!=(0|(t=((t=l+1|0)>>>0)%3|0?t:l-2|0))&&(n=h[e>>2],!(h[n+(t>>>3&536870908)>>2]>>>t&1)&&-1!=(0|(t=h[h[h[e+64>>2]+12>>2]+(t<<2)>>2]))&&-1!=(0|(r=((r=t+1|0)>>>0)%3|0?r:t-2|0))))for(s=h[e+64>>2];;){if(l=r,-1==(0|(t=((t=r+1|0)>>>0)%3|0?t:r-2|0))|h[n+(t>>>3&536870908)>>2]>>>t&1)break n;if(-1==(0|(t=h[h[s+12>>2]+(t<<2)>>2])))break n;if(-1==(0|(r=((r=t+1|0)>>>0)%3|0?r:t-2|0)))break}if(h[h[e+28>>2]+(l<<2)>>2]=i,(0|(t=h[e+44>>2]))==h[e+48>>2]){if((t=1+(o=(r=t-(n=h[e+40>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(s=r>>1,s=r>>>0<2147483644?t>>>0>s>>>0?t:s:1073741823){if(s>>>0>=1073741824)break e;t=mi(s<<2)}else t=0;h[(o=t+(o<<2)|0)>>2]=l,(0|r)>0&&He(t,n,r),h[e+48>>2]=t+(s<<2),h[e+44>>2]=o+4,h[e+40>>2]=t,n&&ve(n)}else h[t>>2]=l,h[e+44>>2]=t+4;if(t=i+1|0,n=h[e+64>>2],(l>>>0)%3|0)r=l-1|0;else if(-1==(0|(r=l+2|0)))break i;if(-1!=(0|(r=h[h[n+12>>2]+(r<<2)>>2]))&&!(-1==(0|(r=r+((r>>>0)%3|0?-1:2)|0))|(0|r)==(0|l)))for(;;){if(n=((n=r+1|0)>>>0)%3|0?n:r-2|0,h[h[e>>2]+(n>>>3&536870908)>>2]>>>n&1){if((0|(i=h[e+56>>2]))==h[e+60>>2]){if((i=1+(a=(n=i-(s=h[e+52>>2])|0)>>2)|0)>>>0>=1073741824)break r;if(o=n>>1,o=n>>>0<2147483644?i>>>0>o>>>0?i:o:1073741823){if(o>>>0>=1073741824)break e;i=mi(o<<2)}else i=0;h[(a=i+(a<<2)|0)>>2]=t,(0|n)>0&&He(i,s,n),h[e+60>>2]=i+(o<<2),h[e+56>>2]=a+4,h[e+52>>2]=i,s&&ve(s)}else h[i>>2]=t,h[e+56>>2]=i+4;if(n=t+1|0,(0|(i=h[e+44>>2]))==h[e+48>>2]){if((i=1+(u=(s=i-(o=h[e+40>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(a=s>>1,a=s>>>0<2147483644?i>>>0>a>>>0?i:a:1073741823){if(a>>>0>=1073741824)break e;i=mi(a<<2)}else i=0;h[(u=i+(u<<2)|0)>>2]=r,(0|s)>0&&He(i,o,s),h[e+48>>2]=i+(a<<2),h[e+44>>2]=u+4,h[e+40>>2]=i,o&&ve(o)}else h[i>>2]=r,h[e+44>>2]=i+4;i=t,t=n}if(h[h[e+28>>2]+(r<<2)>>2]=i,n=h[e+64>>2],(r>>>0)%3|0)r=r-1|0;else if(-1==(0|(r=r+2|0)))break i;if(-1==(0|(r=h[h[n+12>>2]+(r<<2)>>2])))break i;if(-1==(0|(r=r+((r>>>0)%3|0?-1:2)|0)))break i;if((0|r)==(0|l))break}}if(c=c+1|0,r=h[n+24>>2],!(c>>>0<h[n+28>>2]-r>>2>>>0))break}return}vn(),S()}vn(),S()}Zr(1336),S()}function ye(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;if(-1==(0|t))return 1;if(r=(t>>>0)/3|0,!(h[h[e+24>>2]+(r>>>3&268435452)>>2]>>>r&1)){if(i=h[e+48>>2],h[e+52>>2]=i,(0|i)==h[e+56>>2]?(n=mi(4),h[n>>2]=t,s=n+4|0,h[e+56>>2]=s,h[e+52>>2]=s,h[e+48>>2]=n,i&&ve(i)):(h[i>>2]=t,h[e+52>>2]=i+4),s=h[h[e+4>>2]+28>>2],-1==(0|(i=h[s+((n=((i=t+1|0)>>>0)%3|0?i:t-2|0)<<2)>>2])))return 0;if(o=(t-v(r,3)|0?-1:2)+t|0,-1==(0|(r=h[s+(o<<2)>>2])))return 0;if(t=h[e+36>>2],(a=h[(s=t+(i>>>3&536870908)|0)>>2])&(l=1<<i)||(h[s>>2]=a|l,tt(e+8|0,i,n),t=h[e+36>>2]),(i=h[(t=(r>>>3&536870908)+t|0)>>2])&(n=1<<r)||(h[t>>2]=i|n,tt(e+8|0,r,o)),(0|(r=h[e+52>>2]))==h[e+48>>2])return 1;for(u=e+8|0;;){i=((t=h[(r=r-4|0)>>2])>>>0)/3|0;e:{t:if(-1!=(0|t)&&(n=h[e+24>>2]+(i>>>3&268435452)|0,!((s=h[n>>2])&(i=1<<i)))){if(h[n>>2]=i|s,n=h[e+4>>2],-1==(0|(i=h[h[n+28>>2]+(t<<2)>>2])))return 0;for(;;){r=t;r:{if(s=h[e+36>>2]+(i>>>3&536870908)|0,!((o=h[s>>2])&(a=1<<i)))if(-1==(0|(t=h[h[n+40>>2]+(i<<2)>>2]))||-1==(0|(t=((l=t+1|0)>>>0)%3|0?l:t-2|0))|h[h[n>>2]+(t>>>3&536870908)>>2]>>>t&1||-1==(0|(t=h[h[h[n+64>>2]+12>>2]+(t<<2)>>2])))h[s>>2]=o|a,tt(u,i,r);else if(h[s>>2]=o|a,tt(u,i,r),-1!=(0|(((i=t+1|0)>>>0)%3|0?i:t-2|0))){t=-1,n=h[e+4>>2],-1!=(0|r)&&(-1==(0|(i=((i=r+1|0)>>>0)%3|0?i:r-2|0))|h[h[n>>2]+(i>>>3&536870908)>>2]>>>i&1||(t=h[h[h[n+64>>2]+12>>2]+(i<<2)>>2])),a=1<<(i=(t>>>0)/3|0),r=h[e+24>>2],s=h[r+((l=i>>>5|0)<<2)>>2];break r}i:{if(-1!=(0|r)){i=-1,t=((t=r+1|0)>>>0)%3|0?t:r-2|0,n=h[e+4>>2],-1==(0|t)|h[h[n>>2]+(t>>>3&536870908)>>2]>>>t&1||(i=h[h[h[n+64>>2]+12>>2]+(t<<2)>>2]);n:{if((r>>>0)%3|0)r=r-1|0;else if(t=-1,-1==(0|(r=r+2|0)))break n;t=-1,h[h[n>>2]+(r>>>3&536870908)>>2]>>>r&1||(t=h[h[h[n+64>>2]+12>>2]+(r<<2)>>2])}if(o=(c=-1==(0|t))?-1:(t>>>0)/3|0,s=(i>>>0)/3|0,!((a=-1==(0|i))||(r=h[e+24>>2],(s=h[r+((l=(a=a?-1:s)>>>5|0)<<2)>>2])&(a=1<<a))))break i;if(!(c||(a=1<<o,r=h[e+24>>2],a&(s=h[r+((l=o>>>5|0)<<2)>>2]))))break r}r=h[e+52>>2]-4|0,h[e+52>>2]=r;break e}if(c)t=i;else if(h[(o>>>3&536870908)+r>>2]>>>o&1)t=i;else{if(r=h[e+52>>2],h[r-4>>2]=t,(0|r)!=h[e+56>>2]){h[r>>2]=i,r=r+4|0;break t}i:{if((t=1+(r=(n=r-(s=h[e+48>>2])|0)>>2)|0)>>>0<1073741824){if(o=n>>1,o=n>>>0<2147483644?t>>>0>o>>>0?t:o:1073741823){if(o>>>0>=1073741824)break i;t=mi(o<<2)}else t=0;if(h[(r=t+(r<<2)|0)>>2]=i,r=r+4|0,(0|n)>0&&He(t,s,n),h[e+56>>2]=t+(o<<2),h[e+52>>2]=r,h[e+48>>2]=t,!s)break e;ve(s),r=h[e+52>>2];break e}vn(),S()}Zr(1336),S()}}if(h[(l<<2)+r>>2]=s|a,-1==(0|(i=h[h[n+28>>2]+(t<<2)>>2])))break}return 0}h[e+52>>2]=r}if(h[e+48>>2]==(0|r))break}}return 1}function Ee(e,t,r,i){var n,o=0,a=0,l=0,c=0,u=0,f=0;if(N=n=N-80|0,o=h[r+36>>2],h[n+72>>2]=h[r+32>>2],h[n+76>>2]=o,a=h[r+28>>2],h[(o=n- -64|0)>>2]=h[r+24>>2],h[o+4>>2]=a,o=h[r+20>>2],h[n+56>>2]=h[r+16>>2],h[n+60>>2]=o,o=h[r+12>>2],h[n+48>>2]=h[r+8>>2],h[n+52>>2]=o,o=h[r+4>>2],h[n+40>>2]=h[r>>2],h[n+44>>2]=o,ue(e,n+40|0,n+24|0),!h[e>>2])if(u=e+4|0,s[e+15|0]<0&&ve(h[u>>2]),1==d[n+31|0]){N=c=N-16|0;e:{switch(d[n+32|0]){case 0:Hi(o=mi(48)),h[o>>2]=13144,h[n+8>>2]=0,h[n+12>>2]=0,h[n>>2]=0,h[n+4>>2]=0,h[n+16>>2]=o;break e;case 1:Hi(o=mi(52)),h[o+48>>2]=0,h[o>>2]=11304,h[n+8>>2]=0,h[n+12>>2]=0,h[n>>2]=0,h[n+4>>2]=0,h[n+16>>2]=o;break e}a=mi(32),o=d[1694]|d[1695]<<8|d[1696]<<16|d[1697]<<24,s[a+24|0]=o,s[a+25|0]=o>>>8,s[a+26|0]=o>>>16,s[a+27|0]=o>>>24,o=d[1690]|d[1691]<<8|d[1692]<<16|d[1693]<<24,l=d[1686]|d[1687]<<8|d[1688]<<16|d[1689]<<24,s[a+16|0]=l,s[a+17|0]=l>>>8,s[a+18|0]=l>>>16,s[a+19|0]=l>>>24,s[a+20|0]=o,s[a+21|0]=o>>>8,s[a+22|0]=o>>>16,s[a+23|0]=o>>>24,o=d[1682]|d[1683]<<8|d[1684]<<16|d[1685]<<24,l=d[1678]|d[1679]<<8|d[1680]<<16|d[1681]<<24,s[a+8|0]=l,s[a+9|0]=l>>>8,s[a+10|0]=l>>>16,s[a+11|0]=l>>>24,s[a+12|0]=o,s[a+13|0]=o>>>8,s[a+14|0]=o>>>16,s[a+15|0]=o>>>24,o=d[1674]|d[1675]<<8|d[1676]<<16|d[1677]<<24,l=d[1670]|d[1671]<<8|d[1672]<<16|d[1673]<<24,s[0|a]=l,s[a+1|0]=l>>>8,s[a+2|0]=l>>>16,s[a+3|0]=l>>>24,s[a+4|0]=o,s[a+5|0]=o>>>8,s[a+6|0]=o>>>16,s[a+7|0]=o>>>24,s[a+28|0]=0,h[c>>2]=-1,Ur(o=4|c,a,28),f=s[c+15|0],h[n>>2]=h[c>>2],l=n+4|0,(0|f)>=0?(f=h[o+4>>2],h[l>>2]=h[o>>2],h[l+4>>2]=f,h[l+8>>2]=h[o+8>>2]):Ur(l,h[c+4>>2],h[c+8>>2]),h[n+16>>2]=0,s[c+15|0]<0&&ve(h[c+4>>2]),ve(a)}N=c+16|0;e:if(o=h[n>>2]){if(h[e>>2]=o,s[n+15|0]>=0){t=h[4+(e=4|n)>>2],h[u>>2]=h[e>>2],h[u+4>>2]=t,h[u+8>>2]=h[e+8>>2];break e}Ur(u,h[n+4>>2],h[n+8>>2])}else o=h[n+16>>2],h[n+16>>2]=0,h[o+44>>2]=i,F(e,o,t,r,i),h[e>>2]||(s[u+11|0]<0&&ve(h[u>>2]),h[e>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0),Cn[h[h[o>>2]+4>>2]](o);e=h[n+16>>2],h[n+16>>2]=0,e&&Cn[h[h[e>>2]+4>>2]](e),s[n+15|0]>=0||ve(h[n+4>>2])}else t=mi(32),r=d[1592]|d[1593]<<8|d[1594]<<16|d[1595]<<24,s[t+16|0]=r,s[t+17|0]=r>>>8,s[t+18|0]=r>>>16,s[t+19|0]=r>>>24,r=d[1588]|d[1589]<<8|d[1590]<<16|d[1591]<<24,i=d[1584]|d[1585]<<8|d[1586]<<16|d[1587]<<24,s[t+8|0]=i,s[t+9|0]=i>>>8,s[t+10|0]=i>>>16,s[t+11|0]=i>>>24,s[t+12|0]=r,s[t+13|0]=r>>>8,s[t+14|0]=r>>>16,s[t+15|0]=r>>>24,r=d[1580]|d[1581]<<8|d[1582]<<16|d[1583]<<24,i=d[1576]|d[1577]<<8|d[1578]<<16|d[1579]<<24,s[0|t]=i,s[t+1|0]=i>>>8,s[t+2|0]=i>>>16,s[t+3|0]=i>>>24,s[t+4|0]=r,s[t+5|0]=r>>>8,s[t+6|0]=r>>>16,s[t+7|0]=r>>>24,s[t+20|0]=0,h[e>>2]=-1,Ur(u,t,20),ve(t);N=n+80|0}function we(e,t,r){var i,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0,g=0,_=0;i=v(t,12)+e|0,h[i+12>>2]=h[i+8>>2],u=-1==(0|r)?-1:(r>>>0)/3|0,p=1,c=r;e:{t:{r:{for(;;){i:{if(m=1&s){if(-1==(0|c))break i;if(-1==(0|Mt(e,((c>>>0)%3|0?-1:2)+c|0)))break e;if(-1==(0|(n=((r=c+1|0)>>>0)%3|0?r:c-2|0)))break e;if(-1==(0|(r=((r=n+1|0)>>>0)%3|0?r:n-2|0)))break e;if(-1==(0|(n=h[h[h[e+4>>2]+12>>2]+(r<<2)>>2])))break e;if(-1==(0|(r=((r=n+1|0)>>>0)%3|0?r:n-2|0)))break e;u=(r>>>0)/3|0}if(a=1<<u,f=h[e+56>>2]+(u>>>3&536870908)|0,!(a&(d=h[f>>2]))){for(s=0;;){if(h[f>>2]=a|d,(0|(n=h[i+12>>2]))==h[i+16>>2]){if((o=1+(l=(a=n-(d=h[i+8>>2])|0)>>2)|0)>>>0>=1073741824)break r;if(n=a>>1,o=a>>>0<2147483644?n>>>0<o>>>0?o:n:1073741823){if(o>>>0>=1073741824)break t;n=mi(o<<2)}else n=0;h[(l=n+(l<<2)|0)>>2]=u,(0|a)>0&&He(n,d,a),h[i+8>>2]=n,h[i+12>>2]=l+4,h[i+16>>2]=n+(o<<2),d&&ve(d)}else h[n>>2]=u,h[i+12>>2]=n+4;l=s+1|0;n:{s:{if(s)if(1&l){if(-1==(0|r)){r=-1;break n}r=((n=r+1|0)>>>0)%3|0?n:r-2|0}else{if(c=m?r:c,-1==(0|r)){r=-1;break n}if((r>>>0)%3|0){s=r-1|0;break s}r=r+2|0}if(n=r,r=-1,s=n,-1==(0|n))break n}if(r=h[h[h[e+4>>2]+12>>2]+(s<<2)>>2],f=-1,d=-1,(0|(o=((n=s+1|0)>>>0)%3|0?n:s-2|0))>=0&&(n=(o>>>0)/3|0,d=h[(h[h[e>>2]+96>>2]+v(n,12)|0)+(o-v(n,3)<<2)>>2]),-1!=(0|r)?(a=0,(0|(o=((r>>>0)%3|0?-1:2)+r|0))<0||(n=(o>>>0)/3|0,f=h[(h[h[e>>2]+96>>2]+v(n,12)|0)+(o-v(n,3)<<2)>>2])):a=1,(0|d)==(0|f)){s:{o:{a:{l:{if((0|(s=((s>>>0)%3|0?-1:2)+s|0))>=0){if(n=(s>>>0)/3|0,f=h[(h[h[e>>2]+96>>2]+v(n,12)|0)+(s-v(n,3)<<2)>>2],s=-1,!a)break l;break a}if(f=-1,a)break o}(0|(s=((n=r+1|0)>>>0)%3|0?n:r-2|0))<0?s=-1:(n=(s>>>0)/3|0,s=h[(h[h[e>>2]+96>>2]+v(n,12)|0)+(s-v(n,3)<<2)>>2])}if((0|s)!=(0|f)){r=-1;break n}if(-1!=(0|r))break s;r=-1;break n}if(-1==(0|r)){r=-1;break n}}if(s=l,u=(r>>>0)/3|0,f=h[e+56>>2]+(u>>>3&268435452)|0,!((d=h[f>>2])&(a=1<<u)))continue}else r=-1}break}!m|!(1&l)||(o=h[i+12>>2]-4|0,l=h[o>>2],s=h[e+56>>2]+(l>>>3&536870908)|0,n=h[s>>2],g=s,_=ki(l)&n,h[g>>2]=_,h[i+12>>2]=o)}if(s=1,n=p,p=0,n)continue;break e}break}c=-1,Mt(e,-1);break e}vn(),S()}Zr(1336),S()}if(h[44+((t<<2)+e|0)>>2]=c,o=h[i+8>>2],t=h[i+12>>2]-o|0){if(c=h[e+56>>2],l=1&(e=(e=t>>2)>>>0>1?e:1),r=0,t>>>0>=8)for(p=-2&e,u=0;n=h[(s=r<<2)+o>>2],e=h[(t=c+(n>>>3&536870908)|0)>>2],g=t,_=ki(n)&e,h[g>>2]=_,n=h[o+(4|s)>>2],e=h[(t=c+(n>>>3&536870908)|0)>>2],g=t,_=ki(n)&e,h[g>>2]=_,r=r+2|0,(0|p)!=(0|(u=u+2|0)););l&&(r=h[o+(r<<2)>>2],e=h[(t=c+(r>>>3&536870908)|0)>>2],g=t,_=ki(r)&e,h[g>>2]=_)}}function xe(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0;if(-1==(0|t))return 1;if(i=(t>>>0)/3|0,!(h[h[e+24>>2]+(i>>>3&268435452)>>2]>>>i&1)){if(r=h[e+48>>2],h[e+52>>2]=r,(0|r)==h[e+56>>2]?(n=mi(4),h[n>>2]=t,s=n+4|0,h[e+56>>2]=s,h[e+52>>2]=s,h[e+48>>2]=n,r&&ve(r)):(h[r>>2]=t,h[e+52>>2]=r+4),n=-1,s=h[e+4>>2],-1!=(0|(o=((r=t+1|0)>>>0)%3|0?r:t-2|0))&&(n=h[h[s>>2]+(o<<2)>>2]),a=t-v(i,3)|0)r=t-1|0;else if(-1==(0|(r=t+2|0)))return 0;if(-1==(0|n))return 0;if(-1==(0|(i=h[h[s>>2]+(r<<2)>>2])))return 0;if(r=h[e+36>>2],(l=h[(s=r+(n>>>3&536870908)|0)>>2])&(c=1<<n)||(h[s>>2]=l|c,tt(e+8|0,n,o),r=h[e+36>>2]),(n=h[(r=(i>>>3&536870908)+r|0)>>2])&(s=1<<i)||(h[r>>2]=n|s,tt(e+8|0,i,(a?-1:2)+t|0)),(0|(r=h[e+52>>2]))==h[e+48>>2])return 1;for(c=e+8|0;;){i=((t=h[(r=r-4|0)>>2])>>>0)/3|0;e:{t:if(-1!=(0|t)&&(n=h[e+24>>2]+(i>>>3&268435452)|0,!((s=h[n>>2])&(i=1<<i)))){for(h[n>>2]=i|s;;){if(i=h[e+4>>2],-1==(0|(r=h[h[i>>2]+(t<<2)>>2])))return 0;r:{if(n=h[e+36>>2]+(r>>>3&536870908)|0,!((s=h[n>>2])&(o=1<<r)))if(-1!=(0|(a=h[h[i+24>>2]+(r<<2)>>2]))&&-1!=(0|(a=((l=a+1|0)>>>0)%3|0?l:a-2|0))&&-1!=(0|(i=h[h[i+12>>2]+(a<<2)>>2]))){if(h[n>>2]=s|o,tt(c,r,t),-1!=(0|(((r=i+1|0)>>>0)%3|0?r:i-2|0))){i=t-2|0,r=t+1|0,t=-1,-1!=(0|(r=(r>>>0)%3|0?r:i))&&(t=h[h[h[e+4>>2]+12>>2]+(r<<2)>>2]),o=1<<(r=(t>>>0)/3|0),n=h[e+24>>2],i=h[n+((a=r>>>5|0)<<2)>>2];break r}}else h[n>>2]=s|o,tt(c,r,t);r=-1,s=h[e+4>>2],-1!=(0|(i=((i=t+1|0)>>>0)%3|0?i:t-2|0))&&(r=h[h[s+12>>2]+(i<<2)>>2]);i:{if((t>>>0)%3|0)n=t-1|0;else if(n=t+2|0,t=-1,-1==(0|n))break i;t=h[h[s+12>>2]+(n<<2)>>2]}if(s=(l=-1==(0|t))?-1:(t>>>0)/3|0,i=(r>>>0)/3|0,(o=-1==(0|r))||(n=h[e+24>>2],(i=h[n+((a=(o=o?-1:i)>>>5|0)<<2)>>2])&(o=1<<o))){if(!(l||(o=1<<s,n=h[e+24>>2],o&(i=h[n+((a=s>>>5|0)<<2)>>2]))))break r;r=h[e+52>>2]-4|0,h[e+52>>2]=r;break e}if(l)t=r;else if(h[(s>>>3&536870908)+n>>2]>>>s&1)t=r;else{if(i=h[e+52>>2],h[i-4>>2]=t,(0|i)!=h[e+56>>2]){h[i>>2]=r,r=i+4|0;break t}i:{if((t=1+(o=(i=i-(n=h[e+48>>2])|0)>>2)|0)>>>0<1073741824){if(s=i>>1,s=i>>>0<2147483644?t>>>0>s>>>0?t:s:1073741823){if(s>>>0>=1073741824)break i;t=mi(s<<2)}else t=0;if(h[(o=t+(o<<2)|0)>>2]=r,r=o+4|0,(0|i)>0&&He(t,n,i),h[e+56>>2]=t+(s<<2),h[e+52>>2]=r,h[e+48>>2]=t,!n)break e;ve(n),r=h[e+52>>2];break e}vn(),S()}Zr(1336),S()}}if(h[(a<<2)+n>>2]=i|o,-1==(0|t))break}return 0}h[e+52>>2]=r}if(h[e+48>>2]==(0|r))break}}return 1}function Ae(e,t){e|=0;var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0;N=r=N-32|0;e:{if(f[38+(t|=0)>>1]<=513){if((0|(i=h[t+20>>2]))>=(0|(c=h[t+12>>2]))&(n=h[t+16>>2])>>>0>=p[t+8>>2]|(0|i)>(0|c))break e;if(c=d[n+h[t>>2]|0],i=(n=n+1|0)?i:i+1|0,h[t+16>>2]=n,h[t+20>>2]=i,c)break e}t:if(Er(1,r+28|0,t))r:{if(n=h[r+28>>2]){if(nt(e+60|0,n),h[(i=r+8|0)>>2]=0,h[i+4>>2]=0,s[i+5|0]=0,s[i+6|0]=0,s[i+7|0]=0,s[i+8|0]=0,s[i+9|0]=0,s[i+10|0]=0,s[i+11|0]=0,s[i+12|0]=0,!ze(i,t))break r;for(;c=1<<o,a=Br(i),l=h[e+60>>2]+(o>>>3&536870908)|0,a=a?c|h[l>>2]:h[l>>2]&(-1^c),h[l>>2]=a,(0|n)!=(0|(o=o+1|0)););}if(!Er(1,r+28|0,t))break t;if(n=h[r+28>>2]){if(o=0,nt(e+72|0,n),h[(i=r+8|0)>>2]=0,h[i+4>>2]=0,s[i+5|0]=0,s[i+6|0]=0,s[i+7|0]=0,s[i+8|0]=0,s[i+9|0]=0,s[i+10|0]=0,s[i+11|0]=0,s[i+12|0]=0,!ze(i,t))break r;for(;c=1<<o,a=Br(i),l=h[e+72>>2]+(o>>>3&536870908)|0,a=a?c|h[l>>2]:h[l>>2]&(-1^c),h[l>>2]=a,(0|n)!=(0|(o=o+1|0)););}if(!Er(1,r+28|0,t))break t;if(n=h[r+28>>2]){if(o=0,nt(e+84|0,n),h[(i=r+8|0)>>2]=0,h[i+4>>2]=0,s[i+5|0]=0,s[i+6|0]=0,s[i+7|0]=0,s[i+8|0]=0,s[i+9|0]=0,s[i+10|0]=0,s[i+11|0]=0,s[i+12|0]=0,!ze(i,t))break r;for(;c=1<<o,a=Br(i),l=h[e+84>>2]+(o>>>3&536870908)|0,a=a?c|h[l>>2]:h[l>>2]&(-1^c),h[l>>2]=a,(0|n)!=(0|(o=o+1|0)););}if(!Er(1,r+28|0,t))break t;if(n=h[r+28>>2]){if(o=0,nt(e+96|0,n),h[(i=r+8|0)>>2]=0,h[i+4>>2]=0,s[i+5|0]=0,s[i+6|0]=0,s[i+7|0]=0,s[i+8|0]=0,s[i+9|0]=0,s[i+10|0]=0,s[i+11|0]=0,s[i+12|0]=0,!ze(i,t))break r;for(;c=1<<o,a=Br(i),l=h[e+96>>2]+(o>>>3&536870908)|0,a=a?c|h[l>>2]:h[l>>2]&(-1^c),h[l>>2]=a,(0|n)!=(0|(o=o+1|0)););}if(o=0,c=n=h[t+12>>2],l=i=h[t+20>>2],i=(u=(a=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(m=h[t+8>>2])>>>0<u>>>0&(0|i)>=(0|n)|(0|i)>(0|n))break e;if(g=h[t>>2],n=d[0|(n=g+a|0)]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[t+16>>2]=u,h[t+20>>2]=i,i=l,a=l=a+8|0,l=i=l>>>0<8?i+1|0:i,a>>>0>m>>>0&(0|i)>=(0|c)|(0|i)>(0|c))break e;if(i=d[0|(i=u+g|0)]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[t+16>>2]=a,h[t+20>>2]=l,(0|i)<(0|n))break e;if(h[e+16>>2]=i,h[e+12>>2]=n,!(t=(i>>31)-((n>>31)+(i>>>0<n>>>0)|0)|0)&(i=i-n|0)>>>0>2147483646|t)break e;if(o=1,t=i+1|0,h[e+20>>2]=t,i=t>>>1|0,h[e+24>>2]=i,h[e+28>>2]=0-i,1&t)break e;h[e+24>>2]=i-1;break e}o=0}return N=r+32|0,0|o}function Te(e,t,r){t|=0,r|=0;var i=0,n=0,o=0,a=0,l=0,c=0,u=0,f=0,p=0,m=0,g=0,_=0;e:if(!((0|(g=0|Cn[h[h[(e|=0)>>2]+44>>2]](e)))<=0)&&(n=h[t+4>>2]-h[t>>2]>>2,N=a=N+-64|0,i=ti(a),o=v(h[3408],g),di(i,h[h[e+8>>2]+56>>2],g<<24>>24,5,0,o,o>>31),i=Nt(o=mi(96),i),s[i+84|0]=1,h[i+72>>2]=h[i+68>>2],kt(i,n),h[i+60>>2]=h[h[e+8>>2]+60>>2],i=h[e+16>>2],h[e+16>>2]=o,i&&Wr(i),N=a- -64|0,a=h[e+16>>2],h[a+80>>2]&&(c=h[h[a>>2]>>2])&&!((0|(l=h[r+12>>2]))<=(0|(i=h[r+20>>2]))&(u=h[r+8>>2])>>>0<=(o=h[r+16>>2])>>>0|(0|i)>(0|l)))){f=v(n,g),c=c+h[a+48>>2]|0,p=h[r>>2],m=d[p+o|0],n=(a=o+1|0)?i:i+1|0,h[r+16>>2]=a,h[r+20>>2]=n;t:{r:{i:{if(m){if(U(f,g,r,c))break i;break e}if((0|n)>=(0|l)&a>>>0>=u>>>0|(0|n)>(0|l))break e;a=d[a+p|0],i=(n=o+2|0)>>>0<2?i+1|0:i,h[r+16>>2]=n,h[r+20>>2]=i,i=h[h[e+16>>2]+64>>2],i=h[i+4>>2]-h[i>>2]|0;n:{if((0|a)==h[3408]){if((n=i)>>>0<(i=f<<2)>>>0)break e;if(l=h[r+8>>2],a=h[r+12>>2],n=h[r+20>>2],(0|(n=(o=i+(u=h[r+16>>2])|0)>>>0<i>>>0?n+1|0:n))<=(0|a)&o>>>0<=l>>>0|(0|n)<(0|a))break n;break e}if(i>>>0<v(a,f)>>>0)break e;if(l=h[r+12>>2],n=h[r+20>>2],(o=p=h[r+8>>2])-(u=h[r+16>>2])>>>0<qr(i=a,0,f,0)>>>0&(0|(o=l-(n+(o>>>0<u>>>0)|0)|0))<=(0|(m=G))|(0|o)<(0|m))break e;if(o=1,!f)break r;if(o=0,(m=p)>>>0<(p=i+u|0)>>>0&(0|(n=p>>>0<i>>>0?n+1|0:n))>=(0|l)|(0|n)>(0|l))break t;for(;;){if(He(c+(_<<2)|0,u+h[r>>2]|0,a),n=h[r+20>>2],n=(l=i+h[r+16>>2]|0)>>>0<i>>>0?n+1|0:n,u=l,h[r+16>>2]=l,h[r+20>>2]=n,(0|f)==(0|(_=_+1|0)))break i;if(m=h[r+8>>2],!((0|(n=(p=i+u|0)>>>0<i>>>0?n+1|0:n))<=(0|(l=h[r+12>>2]))&p>>>0<=m>>>0|(0|n)<(0|l)))break}break t}He(c,u+h[r>>2]|0,i),n=i,a=i+h[r+16>>2]|0,i=h[r+20>>2],h[r+16>>2]=a,h[r+20>>2]=n>>>0>a>>>0?i+1|0:i}if(o=1,f&&!((i=h[e+20>>2])&&(o=0,0|Cn[h[h[i>>2]+32>>2]](i)))){if(i=0,o=0,!((0|f)<=0)){if(1!=(0|f))for(l=-2&f;a=h[(n=i<<2)+c>>2],h[n+c>>2]=0-(1&a)^a>>>1,n=h[(a=4|n)+c>>2],h[a+c>>2]=0-(1&n)^n>>>1,i=i+2|0,(0|l)!=(0|(o=o+2|0)););1&f&&(i=h[(n=i<<2)+c>>2],h[n+c>>2]=0-(1&i)^i>>>1)}o=0}}if(i=h[e+20>>2]){if(!(0|Cn[h[h[i>>2]+40>>2]](i,r)))break e;if(!(o||(o=0,e=h[e+20>>2],0|Cn[h[h[e>>2]+44>>2]](e,c,c,f,g,h[t>>2]))))break t}o=1}return 0|o}return 0}function Se(e,t){var r,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0,f=0;N=r=N-32|0;e:{if(!(h[e+8>>2]<<5>>>0>=t>>>0)){if(h[r+24>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,(0|t)<0)break e;i=mi((t=1+(t-1>>>5|0)|0)<<2),h[r+24>>2]=t,h[r+20>>2]=0,h[r+16>>2]=i,t=h[e>>2],h[r+12>>2]=0,h[r+8>>2]=t,i=h[e+4>>2],h[r+4>>2]=31&i,h[r>>2]=t+(i>>>3&536870908),N=o=N-32|0,a=(t=((c=h[r+4>>2])-(s=h[r+12>>2])|0)+((u=h[r>>2])-(l=h[r+8>>2])<<3)|0)+(n=h[r+20>>2])|0,h[r+20>>2]=a,!n|(a-1^n-1)>>>0>31?(i=h[r+16>>2],a>>>0<=32?h[i>>2]=0:h[(a-1>>>3&536870908)+i>>2]=0):i=h[r+16>>2],i=(n>>>3&536870908)+i|0;t:if((0|(n&=31))!=(0|s)){if(h[o+28>>2]=s,h[o+24>>2]=l,h[o+20>>2]=c,h[o+16>>2]=u,h[o+12>>2]=n,h[o+8>>2]=i,t=h[o+28>>2],i=h[o+24>>2],(0|(l=(h[o+20>>2]-t|0)+(h[o+16>>2]-i<<3)|0))<=0)t=h[o+12>>2];else{if(t?(a=(n=(0|l)<(0|(u=32-t|0))?l:u)>>>0>(c=32-(s=h[o+12>>2])|0)>>>0?c:n,d=h[o+8>>2],f=h[d>>2]&(-1<<s&-1>>>c-a^-1),c=h[i>>2]&-1<<t&-1>>>u-n,h[d>>2]=f|(t>>>0<s>>>0?c<<s-t:c>>>t-s|0),t=31&(i=s+a|0),h[o+12>>2]=t,s=d+(i>>>3&536870908)|0,h[o+8>>2]=s,(0|(i=n-a|0))>0&&(h[s>>2]=h[s>>2]&(-1>>>32-i^-1)|c>>>a+h[o+28>>2],h[o+12>>2]=i,t=i),l=l-n|0,i=h[o+24>>2]+4|0,h[o+24>>2]=i):t=h[o+12>>2],s=32-t|0,a=-1<<t,(0|l)>=32)for(c=-1^a;n=h[o+8>>2],i=h[i>>2],h[n>>2]=c&h[n>>2]|i<<t,h[o+8>>2]=n+4,h[n+4>>2]=a&h[n+4>>2]|i>>>s,i=h[o+24>>2]+4|0,h[o+24>>2]=i,n=l>>>0>63,l=l-32|0,n;);(0|l)<=0||(n=h[o+8>>2],c=s,s=(0|s)<(0|l)?s:l,c=h[n>>2]&(a&-1>>>c-s^-1),a=h[i>>2]&-1>>>32-l,h[n>>2]=c|a<<t,t=31&(i=t+s|0),h[o+12>>2]=t,n=n+(i>>>3&536870908)|0,h[o+8>>2]=n,(0|(i=l-s|0))<=0||(h[n>>2]=h[n>>2]&(-1>>>32-i^-1)|a>>>s,h[o+12>>2]=i,t=i))}i=h[o+8>>2],h[o+4>>2]=t,h[o>>2]=i}else{if((0|t)<=0)break t;if(s&&(a=-1<<s&-1>>>(a=32-s|0)-(n=(0|t)<(0|a)?t:a),h[i>>2]=h[i>>2]&(-1^a)|a&h[l>>2],t=t-n|0,l=l+4|0,i=i+(n+s>>>3&536870908)|0),n=Et(c=i,l,i=(s=(0|t)/32|0)<<2),(0|(t=t-(s<<5)|0))<=0)break t;t=-1>>>32-t|0,h[(s=i+n|0)>>2]=h[s>>2]&(-1^t)|t&h[i+l>>2]}N=o+32|0,t=h[e>>2],h[e>>2]=h[r+16>>2],h[r+16>>2]=t,i=h[e+4>>2],h[e+4>>2]=h[r+20>>2],h[r+20>>2]=i,i=h[e+8>>2],h[e+8>>2]=h[r+24>>2],h[r+24>>2]=i,t&&ve(t)}return void(N=r+32|0)}pn(),S()}function Me(e,t){t|=0;var r,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0;N=r=N-80|0;e:{if(d[h[28+(e|=0)>>2]+36|0]<=1){if(n=h[t+20>>2],n=(s=(i=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,(0|(u=h[t+12>>2]))<=(0|n)&s>>>0>p[t+8>>2]|(0|n)>(0|u))break e;i=i+h[t>>2]|0,l=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[t+16>>2]=s,h[t+20>>2]=n}else{if(!wr(1,r+76|0,t))break e;l=h[r+76>>2]}if(l&&!((n=qr((n=h[t+8>>2])-(i=h[t+16>>2])|0,h[t+12>>2]-(h[t+20>>2]+(i>>>0>n>>>0)|0)|0,5,0))>>>0<l>>>0&(0|(i=G))<=0|(0|i)<0)){for(i=h[e+4>>2],(n=h[e+8>>2]-i>>2)>>>0<l>>>0?er(e+4|0,l-n|0):n>>>0<=l>>>0||(h[e+8>>2]=i+(l<<2)),w=e+16|0,g=h[e+32>>2],o=1;;){t:if(!((0|(i=a=h[t+12>>2]))<=(0|(n=h[t+20>>2]))&(b=h[t+8>>2])>>>0<=(c=h[t+16>>2])>>>0|(0|i)<(0|n)||(y=h[t>>2],u=d[y+c|0],i=n,i=(s=c+1|0)?i:i+1|0,h[t+16>>2]=s,h[t+20>>2]=i,(0|i)>=(0|a)&s>>>0>=b>>>0|(0|i)>(0|a)||(s=d[s+y|0],i=n,i=(m=c+2|0)>>>0<2?i+1|0:i,h[t+16>>2]=m,h[t+20>>2]=i,(0|i)>=(0|a)&m>>>0>=b>>>0|(0|i)>(0|a)||(m=d[m+y|0],i=n,i=(E=c+3|0)>>>0<3?i+1|0:i,h[t+16>>2]=E,h[t+20>>2]=i,(0|i)>=(0|a)&E>>>0>=b>>>0|(0|i)>(0|a)||(a=d[E+y|0],i=n,i=(n=c+4|0)>>>0<4?i+1|0:i,h[t+16>>2]=n,h[t+20>>2]=i,!m|(s-12&255)>>>0<245|u>>>0>4)))))){if(c=ti(r+8|0),b=m<<24>>24,a=0!=(0|a),i=(n=s-1|0)>>>0<=10?h[13616+(n<<2)>>2]:-1,di(c,u,b,s,a,n=v(i,m),n>>31),(65535&((n=f[h[e+28>>2]+36>>1])<<8|n>>>8))>>>0<=258){if(i=h[t+20>>2],i=(s=(n=h[t+16>>2])+2|0)>>>0<2?i+1|0:i,(0|(u=h[t+12>>2]))<=(0|i)&s>>>0>p[t+8>>2]|(0|i)>(0|u))break t;n=n+h[t>>2]|0,o=d[0|n]|d[n+1|0]<<8,h[t+16>>2]=s,h[t+20>>2]=i}else{if(!wr(1,r+4|0,t))break t;o=h[r+4>>2]}if(h[r+68>>2]=o,n=Nt(mi(96),c),Cn[h[h[g>>2]+8>>2]](g,h[g+12>>2]-h[g+8>>2]>>2,n),n=(h[g+12>>2]-h[g+8>>2]>>2)-1|0,h[h[(s=n<<2)+h[g+8>>2]>>2]+60>>2]=o,h[h[e+4>>2]+(_<<2)>>2]=n,o=h[e+16>>2],(0|(i=h[e+20>>2]-o>>2))>(0|n)||(h[r>>2]=-1,(n=n+1|0)>>>0>i>>>0?($e(w,n-i|0,r),o=h[w>>2]):i>>>0<=n>>>0||(h[e+20>>2]=(n<<2)+o)),h[s+o>>2]=_,o=(_=_+1|0)>>>0<l>>>0,(0|l)!=(0|_))continue}break}_=!o}}return N=r+80|0,1&_}function Ce(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0,v=0,_=0;e:if(r=f[t+38>>1]){if(r>>>0<=511){if(i=h[t+12>>2],r=h[t+20>>2],r=(n=(o=h[t+16>>2])+4|0)>>>0<4?r+1|0:r,n>>>0>p[t+8>>2]&(0|r)>=(0|i)|(0|r)>(0|i))break e;r=o+h[t>>2]|0,s=d[0|r]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[e+12>>2]=s,r=h[t+20>>2],r=(i=h[t+16>>2]+4|0)>>>0<4?r+1|0:r,h[t+16>>2]=i,h[t+20>>2]=r}else{if(!yr(1,e+12|0,t))break e;s=h[e+12>>2]}if(i=h[e>>2],(r=h[e+4>>2]-i>>2)>>>0<s>>>0?(er(e,s-r|0),s=h[e+12>>2]):r>>>0<=s>>>0||(h[e+4>>2]=i+(s<<2)),!s)return 1;for(c=h[t+8>>2],l=h[t+12>>2],m=h[e>>2],o=0;;){if((0|l)<=(0|(r=h[t+20>>2]))&c>>>0<=(i=h[t+16>>2])>>>0|(0|r)>(0|l))return 0;g=h[t>>2],u=d[g+i|0],r=(i=i+1|0)?r:r+1|0,a=i,h[t+16>>2]=i,h[t+20>>2]=r,i=u>>>2|0,n=0;t:{r:{i:{n:switch(0|(v=3&u)){case 0:break r;case 3:break n;default:break i}if((r=i+o|0)>>>0>=s>>>0)return 0;St(m+(o<<2)|0,0,4+(252&u)|0),o=r;break t}for(;;){if((0|r)>=(0|l)&a>>>0>=c>>>0|(0|r)>(0|l))break e;if(s=d[a+g|0],r=(a=a+1|0)?r:r+1|0,h[t+16>>2]=a,h[t+20>>2]=r,i|=s<<(n<<3|6),(0|v)==(0|(n=n+1|0)))break}}h[m+(o<<2)>>2]=i}if(!((s=h[e+12>>2])>>>0>(o=o+1|0)>>>0))break}if(r=e+16|0,u=h[e>>2],i=h[e+16>>2],(t=h[e+20>>2]-i|0)>>>0<=16383?er(r,4096-(t>>>2|0)|0):16384!=(0|t)&&(h[e+20>>2]=i+16384),o=h[(t=e+28|0)>>2],(i=h[e+32>>2]-o>>3)>>>0<s>>>0)tr(t,s-i|0),o=h[t>>2];else if(i>>>0>s>>>0&&(h[e+32>>2]=(s<<3)+o),!s)break e;for(n=0,e=0;;){if(l=h[(t=u+(n<<2)|0)>>2],i=e,h[4+(a=(n<<3)+o|0)>>2]=i,h[a>>2]=l,(e=(l=h[t>>2])+i|0)>>>0>4096)break e;if(!(e>>>0<=i>>>0)){if(a=h[r>>2],t=0,c=7&l)for(;h[a+(i<<2)>>2]=n,i=i+1|0,(0|c)!=(0|(t=t+1|0)););if(!(l-1>>>0<=6))for(;h[(t=a+(i<<2)|0)>>2]=n,h[t+28>>2]=n,h[t+24>>2]=n,h[t+20>>2]=n,h[t+16>>2]=n,h[t+12>>2]=n,h[t+8>>2]=n,h[t+4>>2]=n,(0|(i=i+8|0))!=(0|e););}if((0|(n=n+1|0))==(0|s))break}_=4096==(0|e)}return _}function Re(e,t){var r,i=0,n=0,s=0,o=0,a=0,l=0;N=r=N-16|0,i=h[e+4>>2],h[e+40>>2]=h[e>>2],h[e+44>>2]=i,i=h[e+36>>2],h[e+72>>2]=h[e+32>>2],h[e+76>>2]=i,n=h[e+28>>2],h[(i=e- -64|0)>>2]=h[e+24>>2],h[i+4>>2]=n,i=h[e+20>>2],h[e+56>>2]=h[e+16>>2],h[e+60>>2]=i,i=h[e+12>>2],h[e+48>>2]=h[e+8>>2],h[e+52>>2]=i;e:if(Dt(e+40|0,1,r+8|0)&&(i=h[e+44>>2],h[e>>2]=h[e+40>>2],h[e+4>>2]=i,i=h[e+76>>2],h[e+32>>2]=h[e+72>>2],h[e+36>>2]=i,i=h[e+68>>2],h[e+24>>2]=h[e+64>>2],h[e+28>>2]=i,a=n=h[e+60>>2],i=h[e+56>>2],h[e+16>>2]=i,h[e+20>>2]=n,s=h[e+52>>2],n=h[e+48>>2],h[e+8>>2]=n,h[e+12>>2]=s,l=n-i|0,(0|(o=h[r+12>>2]))==(0|(s=s-((i>>>0>n>>>0)+a|0)|0))&l>>>0>=(n=h[r+8>>2])>>>0|s>>>0>o>>>0)){if(s=i+n|0,i=a+o|0,h[e+16>>2]=s,h[e+20>>2]=n>>>0>s>>>0?i+1|0:i,f[e+38>>1]<=513){if(i=h[e+4>>2],h[e+96>>2]=h[e>>2],h[e+100>>2]=i,i=h[e+36>>2],h[e+128>>2]=h[e+32>>2],h[e+132>>2]=i,i=h[e+28>>2],h[e+120>>2]=h[e+24>>2],h[e+124>>2]=i,i=h[e+20>>2],h[e+112>>2]=h[e+16>>2],h[e+116>>2]=i,i=h[e+12>>2],h[e+104>>2]=h[e+8>>2],h[e+108>>2]=i,!(Dt(e+96|0,1,r+8|0)&&(i=h[e+100>>2],h[e>>2]=h[e+96>>2],h[e+4>>2]=i,i=h[e+132>>2],h[e+32>>2]=h[e+128>>2],h[e+36>>2]=i,i=h[e+124>>2],h[e+24>>2]=h[e+120>>2],h[e+28>>2]=i,a=n=h[e+116>>2],i=h[e+112>>2],h[e+16>>2]=i,h[e+20>>2]=n,s=h[e+108>>2],n=h[e+104>>2],h[e+8>>2]=n,h[e+12>>2]=s,l=n-i|0,(0|(o=h[r+12>>2]))==(0|(s=s-((i>>>0>n>>>0)+a|0)|0))&l>>>0>=(n=h[r+8>>2])>>>0|s>>>0>o>>>0))){i=0;break e}s=i+n|0,i=a+o|0,h[e+16>>2]=s,h[e+20>>2]=n>>>0>s>>>0?i+1|0:i}else if(i=0,!ze(e+80|0,e))break e;i=0,Pt(e)&&(i=h[e+4>>2],h[t>>2]=h[e>>2],h[t+4>>2]=i,i=h[e+36>>2],h[t+32>>2]=h[e+32>>2],h[t+36>>2]=i,i=h[e+28>>2],h[t+24>>2]=h[e+24>>2],h[t+28>>2]=i,i=h[e+20>>2],h[t+16>>2]=h[e+16>>2],h[t+20>>2]=i,i=h[e+12>>2],h[t+8>>2]=h[e+8>>2],h[t+12>>2]=i,i=1)}else i=0;return N=r+16|0,i}function Ie(e,t,r){e|=0,t|=0,r|=0;var i,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0;N=i=N-16|0,h[i+8>>2]=r;e:if(!((0|(o=(s=h[e+12>>2])-(n=h[e+8>>2])>>2))>(0|t)))if((l=t+1|0)>>>0>o>>>0){if((o=l-o|0)>>>0<=(a=h[e+16>>2])-(n=h[e+12>>2])>>2>>>0){o&&(n=St(s=n,0,n=o<<2)+n|0),h[e+12>>2]=n;break e}t:{r:{i:{if((s=(c=n-(l=h[e+8>>2])>>2)+o|0)>>>0<1073741824){if(d=(a=a-l|0)>>1,a=a>>>0<2147483644?s>>>0>d>>>0?s:d:1073741823){if(a>>>0>=1073741824)break i;u=mi(a<<2)}if(c=(o=St(s=(c<<2)+u|0,0,c=o<<2))+c|0,a=(a<<2)+u|0,(0|n)==(0|l))break r;for(;o=h[(n=n-4|0)>>2],h[n>>2]=0,h[(s=s-4|0)>>2]=o,(0|n)!=(0|l););if(h[e+16>>2]=a,o=h[e+12>>2],h[e+12>>2]=c,n=h[e+8>>2],h[e+8>>2]=s,(0|n)==(0|o))break t;for(;s=h[(o=o-4|0)>>2],h[o>>2]=0,s&&Wr(s),(0|n)!=(0|o););break t}vn(),S()}Zr(1336),S()}h[e+16>>2]=a,h[e+12>>2]=c,h[e+8>>2]=o}n&&ve(n)}else if(!(o>>>0<=l>>>0)){if((0|(n=n+(l<<2)|0))!=(0|s)){for(;r=h[(s=s-4|0)>>2],h[s>>2]=0,r&&Wr(r),(0|n)!=(0|s););r=h[i+8>>2]}h[e+12>>2]=n}e:{t:{if(!((0|(n=h[r+56>>2]))>4))if(s=v(n,12)+e|0,(0|(n=h[s+24>>2]))==h[s+28>>2]){if((n=1+(u=(o=n-(l=h[s+20>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(a=o>>1,a=o>>>0<2147483644?n>>>0>a>>>0?n:a:1073741823){if(a>>>0>=1073741824)break e;n=mi(a<<2)}else n=0;h[(u=n+(u<<2)|0)>>2]=t,(0|o)>0&&He(n,l,o),h[s+20>>2]=n,h[s+24>>2]=u+4,h[s+28>>2]=n+(a<<2),l&&ve(l)}else h[n>>2]=t,h[s+24>>2]=n+4;return h[r+60>>2]=t,e=h[e+8>>2],h[i+8>>2]=0,e=h[(t=e+(t<<2)|0)>>2],h[t>>2]=r,e&&Wr(e),e=h[i+8>>2],h[i+8>>2]=0,e&&Wr(e),void(N=i+16|0)}vn(),S()}Zr(1336),S()}function Oe(e,t){var r,i,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0,f=0;N=r=N-16|0,h[r>>2]=t,l=-1,-1!=(0|t)?(n=t+1|0,h[r+4>>2]=(n>>>0)%3|0?n:t-2|0,l=(t>>>0)%3|0?t-1|0:t+2|0):h[r+4>>2]=-1,h[r+8>>2]=l,i=-1==(0|t)?-1:(t>>>0)/3|0;e:{t:{r:{i:{for(;;){n:if(-1!=(0|t)&&-1!=(0|(n=h[h[h[e+8>>2]+12>>2]+(t<<2)>>2]))){if(!((n>>>0)/3>>>0<i>>>0)&&(l=0,h[e+220>>2]!=h[e+216>>2]))for(;;){if(Br(h[e+368>>2]+(l<<4)|0))if(a=h[e+216>>2]+v(l,144)|0,(n=h[a+136>>2])>>>0<(s=h[a+140>>2])>>>0)h[n>>2]=t,h[a+136>>2]=n+4;else{if((n=1+(o=(u=n-(c=h[a+132>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(d=o<<2,o=(s=s-c|0)>>1,s=s>>>0<2147483644?n>>>0>o>>>0?n:o:1073741823){if(s>>>0>=1073741824)break e;n=mi(s<<2)}else n=0;h[(o=d+n|0)>>2]=t,(0|u)>0&&He(n,c,u),h[a+132>>2]=n,h[a+136>>2]=o+4,h[a+140>>2]=n+(s<<2),c&&ve(c)}if(!((l=l+1|0)>>>0<(h[e+220>>2]-h[e+216>>2]|0)/144>>>0))break}}else{if(l=0,(0|(n=h[e+216>>2]))==h[e+220>>2])break n;for(;;){if(a=v(l,144)+n|0,(n=h[a+136>>2])>>>0<(s=h[a+140>>2])>>>0)h[n>>2]=t,h[a+136>>2]=n+4;else{if((n=1+(o=(u=n-(c=h[a+132>>2])|0)>>2)|0)>>>0>=1073741824)break i;if(d=o<<2,o=(s=s-c|0)>>1,s=s>>>0<2147483644?n>>>0>o>>>0?n:o:1073741823){if(s>>>0>=1073741824)break r;n=mi(s<<2)}else n=0;h[(o=d+n|0)>>2]=t,(0|u)>0&&He(n,c,u),h[a+132>>2]=n,h[a+136>>2]=o+4,h[a+140>>2]=n+(s<<2),c&&ve(c)}if(l=l+1|0,n=h[e+216>>2],!(l>>>0<(h[e+220>>2]-n|0)/144>>>0))break}}if(3==(0|(f=f+1|0)))break;t=h[(f<<2)+r>>2]}return N=r+16|0,1}vn(),S()}Zr(1336),S()}vn(),S()}Zr(1336),S()}function Pe(e,t){var r,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0;N=r=N-16|0,h[r>>2]=t,a=-1,-1!=(0|t)?(i=t+1|0,h[r+4>>2]=(i>>>0)%3|0?i:t-2|0,a=(t>>>0)%3|0?t-1|0:t+2|0):h[r+4>>2]=-1,h[r+8>>2]=a;e:{t:{for(;;){r:{if(!(-1==(0|t)|-1==h[h[h[e+8>>2]+12>>2]+(t<<2)>>2])){if(a=0,h[e+220>>2]==h[e+216>>2])break r;i:{for(;;){n:{if(Br(h[e+368>>2]+(a<<4)|0))if(o=h[e+216>>2]+v(a,144)|0,(i=h[o+136>>2])>>>0<(n=h[o+140>>2])>>>0)h[i>>2]=t,h[o+136>>2]=i+4;else{if((i=1+(s=(c=i-(l=h[o+132>>2])|0)>>2)|0)>>>0>=1073741824)break n;if(u=s<<2,s=(n=n-l|0)>>1,n=n>>>0<2147483644?i>>>0>s>>>0?i:s:1073741823){if(n>>>0>=1073741824)break i;i=mi(n<<2)}else i=0;h[(s=u+i|0)>>2]=t,(0|c)>0&&He(i,l,c),h[o+132>>2]=i,h[o+136>>2]=s+4,h[o+140>>2]=i+(n<<2),l&&ve(l)}if((a=a+1|0)>>>0<(h[e+220>>2]-h[e+216>>2]|0)/144>>>0)continue;break r}break}vn(),S()}Zr(1336),S()}if(a=0,(0|(i=h[e+216>>2]))!=h[e+220>>2])for(;;){if(o=v(a,144)+i|0,(i=h[o+136>>2])>>>0<(n=h[o+140>>2])>>>0)h[i>>2]=t,h[o+136>>2]=i+4;else{if((i=1+(s=(c=i-(l=h[o+132>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(u=s<<2,s=(n=n-l|0)>>1,n=n>>>0<2147483644?i>>>0>s>>>0?i:s:1073741823){if(n>>>0>=1073741824)break e;i=mi(n<<2)}else i=0;h[(s=u+i|0)>>2]=t,(0|c)>0&&He(i,l,c),h[o+132>>2]=i,h[o+136>>2]=s+4,h[o+140>>2]=i+(n<<2),l&&ve(l)}if(a=a+1|0,i=h[e+216>>2],!(a>>>0<(h[e+220>>2]-i|0)/144>>>0))break}}if(3==(0|(d=d+1|0)))break;t=h[(d<<2)+r>>2]}return N=r+16|0,1}vn(),S()}Zr(1336),S()}function ke(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0;if(((n=h[e+8>>2])-(o=h[e+4>>2])|0)/12>>>0>=t>>>0){if(t){if(i=o,s=1+(((n=v(t,12)-12|0)>>>0)/12|0)&3)for(;c=h[r+4>>2],h[i>>2]=h[r>>2],h[i+4>>2]=c,h[i+8>>2]=h[r+8>>2],i=i+12|0,(0|s)!=(0|(a=a+1|0)););if(o=v(t,12)+o|0,!(n>>>0<36))for(;t=h[r+4>>2],h[i>>2]=h[r>>2],h[i+4>>2]=t,h[i+8>>2]=h[r+8>>2],h[i+20>>2]=h[r+8>>2],t=h[r+4>>2],h[i+12>>2]=h[r>>2],h[i+16>>2]=t,h[i+32>>2]=h[r+8>>2],t=h[r+4>>2],h[i+24>>2]=h[r>>2],h[i+28>>2]=t,t=h[r+4>>2],h[i+36>>2]=h[r>>2],h[i+40>>2]=t,h[i+44>>2]=h[r+8>>2],(0|o)!=(0|(i=i+48|0)););}h[e+4>>2]=o}else{e:{if((i=(l=(o-(s=h[e>>2])|0)/12|0)+t|0)>>>0<357913942){if(s=(n=(n-s|0)/12|0)<<1,s=n>>>0<178956970?i>>>0>s>>>0?i:s:357913941){if(s>>>0>=357913942)break e;c=mi(v(s,12))}if(i=n=v(l,12)+c|0,u=1+(((l=(t=v(t,12))-12|0)>>>0)/12|0)&3)for(i=n;d=h[r+4>>2],h[i>>2]=h[r>>2],h[i+4>>2]=d,h[i+8>>2]=h[r+8>>2],i=i+12|0,(0|u)!=(0|(a=a+1|0)););if(a=t+n|0,l>>>0>=36)for(;t=h[r+4>>2],h[i>>2]=h[r>>2],h[i+4>>2]=t,h[i+8>>2]=h[r+8>>2],h[i+20>>2]=h[r+8>>2],t=h[r+4>>2],h[i+12>>2]=h[r>>2],h[i+16>>2]=t,h[i+32>>2]=h[r+8>>2],t=h[r+4>>2],h[i+24>>2]=h[r>>2],h[i+28>>2]=t,t=h[r+4>>2],h[i+36>>2]=h[r>>2],h[i+40>>2]=t,h[i+44>>2]=h[r+8>>2],(0|a)!=(0|(i=i+48|0)););return t=h[e>>2],i=n+v((0|(r=o-t|0))/-12|0,12)|0,(0|r)>0&&He(i,t,r),h[e+8>>2]=v(s,12)+c,h[e+4>>2]=a,h[e>>2]=i,void(t&&ve(t))}vn(),S()}Zr(1336),S()}}function Le(e,t,r,i){var n,s,o=0,a=0,l=0,c=0,u=0,d=0;if(n=h[t+16>>2],o=l=h[r+4>>2]-n|0,a=h[r>>2]-n|0,h[r>>2]=a,h[r+4>>2]=o,s=(0|(d=h[t+16>>2]))>=((c=(o>>=31)+l^o)+((o=a>>31)+a^o)|0))o=l;else{e:{t:{if((0|a)>=0){if(u=1,c=1,(0|l)>=0)break e;if(o=1,u=-1,c=-1,a)break t;break e}if(o=-1,u=-1,c=-1,(0|l)<=0)break e}u=(0|l)<=0?-1:1,c=o}o=(o=a<<1)-(a=v(c,d))|0,o=(((c=(0|v(u,c))>=0)?0-o|0:o)+(u=v(u,d))|0)/2|0,h[r+4>>2]=o,d=a,a=(l<<1)-u|0,a=(d+(c?0-a|0:a)|0)/2|0,h[r>>2]=a}e:{t:{r:{i:{n:{s:{o:{if(a){if((0|a)<0)break o;if((0|o)>=0)break s;break r}if(o)break n;u=1,l=0,o=0,c=0;break e}if(u=1,(0|o)>0)break i;c=(0|o)>0?253:0,l=o,o=a;break e}l=0-o|0,o=0-a|0,c=254;break t}if((0|o)<=0)break r}o=0-o|0,l=a,c=253;break t}l=0-a|0,c=255}h[r>>2]=o,h[r+4>>2]=l,u=0}r=h[i+4>>2]+l|0,(0|(a=h[i>>2]+o|0))>(0|(l=h[t+16>>2]))?a=a-h[t+4>>2]|0:(0-l|0)<=(0|a)||(a=h[t+4>>2]+a|0),(0|r)>(0|l)?r=r-h[t+4>>2]|0:(0-l|0)<=(0|r)||(r=h[t+4>>2]+r|0);e:if(u)t=r;else{t=r;t:switch((3&c)-1|0){case 0:t=0-a|0,a=r;break e;case 1:t=0-r|0,a=0-a|0;break e;case 2:break t;default:break e}t=a,a=0-r|0}if(s)r=t;else{e:{t:{if((0|a)>=0){if(r=1,o=1,(0|t)>=0)break e;if(i=1,r=-1,o=-1,a)break t;break e}if(i=-1,r=-1,o=-1,(0|t)<=0)break e}r=(0|t)<=0?-1:1,o=i}i=(i=a<<1)-(a=v(o,l))|0,h[e>>2]=i,d=0-i|0,c=i,r=(((i=(0|v(r,o))>=0)?d:c)+(o=v(r,l))|0)/2|0,t=(t<<1)-o|0,a=(a+(i?0-t|0:t)|0)/2|0}h[e>>2]=a+n,h[e+4>>2]=r+n}function Ne(e,t){var r=0,i=0,n=0,o=0;h[e+64>>2]||(r=mi(32),h[r+16>>2]=0,h[r+20>>2]=0,h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,i=h[e+64>>2],h[e+64>>2]=r,i&&((r=h[i>>2])&&(h[i+4>>2]=r,ve(r)),ve(i),r=h[e+64>>2]),h[e>>2]=r,i=h[r+20>>2],h[e+8>>2]=h[r+16>>2],h[e+12>>2]=i,i=h[r+24>>2],r=h[r+28>>2],h[e+48>>2]=0,h[e+52>>2]=0,h[e+40>>2]=0,h[e+44>>2]=0,h[e+16>>2]=i,h[e+20>>2]=r);e:{s[e+24|0]=d[t+24|0],h[e+28>>2]=h[t+28>>2],s[e+32|0]=d[t+32|0],r=h[t+44>>2],h[e+40>>2]=h[t+40>>2],h[e+44>>2]=r,r=h[t+52>>2],h[e+48>>2]=h[t+48>>2],h[e+52>>2]=r,h[e+56>>2]=h[t+56>>2],r=h[t+12>>2],h[e+8>>2]=h[t+8>>2],h[e+12>>2]=r,r=h[t+20>>2],h[e+16>>2]=h[t+16>>2],h[e+20>>2]=r,h[e+60>>2]=h[t+60>>2],(i=h[t>>2])?(r=0,(n=h[e>>2])&&(jr(n,r=h[i>>2],h[i+4>>2]-r|0,0),r=1)):(h[e>>2]=0,r=1);t:if(r){s[e+84|0]=d[t+84|0],h[e+80>>2]=h[t+80>>2],(0|e)!=(0|t)&&Ot(e+68|0,h[t+68>>2],h[t+72>>2]);r:{if(i=h[t+88>>2]){if(t=mi(40),r=h[i>>2],h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,h[t>>2]=r,n=h[i+12>>2]-h[i+8>>2]|0){if((0|n)<0)break e;r=mi(n),h[t+8>>2]=r,h[t+12>>2]=r,h[t+16>>2]=r+n,o=h[i+8>>2],(0|(n=h[i+12>>2]-o|0))>0&&(r=He(r,o,n)+n|0),h[t+12>>2]=r}if(r=h[i+36>>2],h[t+32>>2]=h[i+32>>2],h[t+36>>2]=r,r=h[i+28>>2],h[t+24>>2]=h[i+24>>2],h[t+28>>2]=r,r=h[e+88>>2],h[e+88>>2]=t,r)break r;break t}if(r=h[e+88>>2],h[e+88>>2]=0,!r)break t}(e=h[r+8>>2])&&(h[r+12>>2]=e,ve(e)),ve(r)}return}vn(),S()}function Ge(e,t,r,i){var n=0,o=0,a=0,l=0,c=0,u=0;if(!((0|(l=i-r|0))<=0)){e:{if((0|l)<=((o=h[e+8>>2])-(c=h[e+4>>2])|0)){if((0|(u=c-t|0))>=(0|l)){a=c,o=i;break e}if(a=c,(0|(o=r+u|0))!=(0|i))for(n=o;s[0|a]=d[0|n],a=a+1|0,(0|(n=n+1|0))!=(0|i););if(h[e+4>>2]=a,(0|u)>0)break e;return}if((0|(i=l+(c-(n=h[e>>2])|0)|0))>=0){if(u=(o=o-n|0)<<1,r=He((a=t-n|0)+(i=(o=o>>>0<1073741823?i>>>0>u>>>0?i:u:2147483647)?mi(o):0)|0,r,l),(0|a)>0&&He(i,n,a),r=r+l|0,(0|t)!=(0|c)){if(a=(-1^t)+c|0,l=c-t&7)for(n=0;s[0|r]=d[0|t],r=r+1|0,t=t+1|0,(0|l)!=(0|(n=n+1|0)););if(a>>>0>=7)for(;s[0|r]=d[0|t],s[r+1|0]=d[t+1|0],s[r+2|0]=d[t+2|0],s[r+3|0]=d[t+3|0],s[r+4|0]=d[t+4|0],s[r+5|0]=d[t+5|0],s[r+6|0]=d[t+6|0],s[r+7|0]=d[t+7|0],r=r+8|0,(0|c)!=(0|(t=t+8|0)););n=h[e>>2]}return h[e+8>>2]=i+o,h[e+4>>2]=r,h[e>>2]=i,void(n&&ve(n))}vn(),S()}if(c>>>0>(i=(n=a)-l|0)>>>0)for(;s[0|n]=d[0|i],n=n+1|0,c>>>0>(i=i+1|0)>>>0;);if(h[e+4>>2]=n,(e=a-(t+l|0)|0)&&Et(a-e|0,t,e),(0|r)!=(0|o)){if(e=(-1^r)+o|0,a=o-r&7)for(i=0,n=t;s[0|n]=d[0|r],n=n+1|0,r=r+1|0,(0|a)!=(0|(i=i+1|0)););else n=t;if(!(e>>>0<7))for(;s[0|n]=d[0|r],s[n+1|0]=d[r+1|0],s[n+2|0]=d[r+2|0],s[n+3|0]=d[r+3|0],s[n+4|0]=d[r+4|0],s[n+5|0]=d[r+5|0],s[n+6|0]=d[r+6|0],s[n+7|0]=d[r+7|0],n=n+8|0,(0|o)!=(0|(r=r+8|0)););}}}function De(e,t,r,i){e|=0,r|=0,i|=0;var n,o=0,a=0,l=0,c=0,u=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0;N=n=N-16|0,c=h[80+(t|=0)>>2],e=s[r+24|0],o=v(c,e);e:{t:{if(t=h[r+28>>2],!d[r+84|0]|5!=(0|t)&6!=(0|t)){if(h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,e){if((0|e)<0)break t;l=mi(t=e<<2),h[n>>2]=l,a=t+l|0,h[n+8>>2]=a,St(l,0,t),h[n+4>>2]=a}a=h[i>>2],(t=h[i+4>>2]-a>>2)>>>0<o>>>0?er(i,o-t|0):t>>>0<=o>>>0||(h[i+4>>2]=a+(o<<2));r:if(c)if(e){for(b=-4&e,g=3&e,y=e-1>>>0<3,t=1,o=0;;){if(he(r,d[r+84|0]?o:h[h[r+68>>2]+(o<<2)>>2],s[r+24|0],l)){if(_=h[i>>2],m=0,a=h[n>>2],e=0,t=0,!y)for(;p=e<<2,h[(f=(u<<2)+_|0)>>2]=h[a+p>>2],h[f+4>>2]=h[a+(4|p)>>2],h[f+8>>2]=h[a+(8|p)>>2],h[f+12>>2]=h[a+(12|p)>>2],e=e+4|0,u=u+4|0,(0|b)!=(0|(t=t+4|0)););if(g)for(;h[(u<<2)+_>>2]=h[a+(e<<2)>>2],e=e+1|0,u=u+1|0,(0|(m=m+1|0))!=(0|g););if(t=c>>>0>(o=o+1|0)>>>0,(0|o)!=(0|c))continue}break}l=h[n>>2]}else for(e=0,t=1;;){if(!he(r,d[r+84|0]?e:h[h[r+68>>2]+(e<<2)>>2],s[r+24|0],l))break r;if(t=c>>>0>(e=e+1|0)>>>0,(0|e)==(0|c))break}else t=0;l&&ve(l),e=1^t}else{if(l=h[r+48>>2],c=h[h[r>>2]>>2],t=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,r=0,e=o<<2){if((0|e)<0)break t;u=(t=He(r=mi(e),l+c|0,e))+e|0,t=t+(e>>2<<2)|0}(e=h[i>>2])&&(h[i+4>>2]=e,ve(e)),h[i+8>>2]=t,h[i+4>>2]=u,h[i>>2]=r,e=1}N=n+16|0,e&=1;break e}vn(),S()}return 0|e}function Ue(e,t){e|=0,t|=0;var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0;N=r=N-32|0,h[r+28>>2]=0;e:{if(f[t+38>>1]<=513){if(i=h[t+20>>2],i=(l=(n=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(0|(o=h[t+12>>2]))<=(0|i)&l>>>0>p[t+8>>2]|(0|i)>(0|o))break e;n=n+h[t>>2]|0,n=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[t+16>>2]=l,h[t+20>>2]=i}else{if(!Er(1,r+28|0,t))break e;n=h[r+28>>2]}if(n&&(nt(e+76|0,n),h[(i=r+8|0)>>2]=0,h[i+4>>2]=0,s[i+5|0]=0,s[i+6|0]=0,s[i+7|0]=0,s[i+8|0]=0,s[i+9|0]=0,s[i+10|0]=0,s[i+11|0]=0,s[i+12|0]=0,ze(i,t))){for(o=1;a=1<<c,u=Br(i),l=h[e+76>>2]+(c>>>3&536870908)|0,1&(o^=u)?a=h[l>>2]&(-1^a):a|=h[l>>2],o^=1,h[l>>2]=a,(0|(c=c+1|0))!=(0|n););c=0,l=n=h[t+12>>2],o=i=h[t+20>>2],i=(u=(a=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(m=h[t+8>>2])>>>0<u>>>0&(0|i)>=(0|n)|(0|i)>(0|n)||(g=h[t>>2],n=d[0|(n=g+a|0)]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[t+16>>2]=u,h[t+20>>2]=i,i=o,a=o=a+8|0,o=i=o>>>0<8?i+1|0:i,a>>>0>m>>>0&(0|i)>=(0|l)|(0|i)>(0|l)||(i=d[0|(i=u+g|0)]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[t+16>>2]=a,h[t+20>>2]=o,(0|i)<(0|n)||(h[e+16>>2]=i,h[e+12>>2]=n,!(t=(i>>31)-((n>>31)+(i>>>0<n>>>0)|0)|0)&(i=i-n|0)>>>0>2147483646|t||(c=1,t=i+1|0,h[e+20>>2]=t,i=t>>>1|0,h[e+24>>2]=i,h[e+28>>2]=0-i,1&t||(h[e+24>>2]=i-1)))))}}return N=r+32|0,0|c}function Ve(e,t){var r=0,i=0,n=0,s=0,o=0;i=-1,s=-1,-1!=(0|t)&&(i=((r=t+1|0)>>>0)%3|0?r:t-2|0,s=t-1|0,(t>>>0)%3|0||(s=t+2|0));e:{t:{r:{i:{n:{s:switch(0|(n=h[e+184>>2])){case 7:break r;case 3:break i;case 5:break n;case 0:case 1:break s;default:break e}o=h[e+148>>2],r=-1,n=1,i=(-1!=(0|i)?h[h[o>>2]+(i<<2)>>2]:r)<<2,r=h[e+156>>2],h[(i=i+r|0)>>2]=h[i>>2]+1,r=((-1!=(0|s)?h[h[o>>2]+(s<<2)>>2]:-1)<<2)+r|0;break t}o=h[e+148>>2],n=(r=h[e+156>>2])+((-1!=(0|t)?h[h[o>>2]+(t<<2)>>2]:-1)<<2)|0,h[n>>2]=h[n>>2]+1,i=((-1!=(0|i)?h[h[o>>2]+(i<<2)>>2]:-1)<<2)+r|0,h[i>>2]=h[i>>2]+1,n=2,r=((-1!=(0|s)?h[h[o>>2]+(s<<2)>>2]:-1)<<2)+r|0;break t}o=h[e+148>>2],n=(r=h[e+156>>2])+((-1!=(0|t)?h[h[o>>2]+(t<<2)>>2]:-1)<<2)|0,h[n>>2]=h[n>>2]+1,i=((-1!=(0|i)?h[h[o>>2]+(i<<2)>>2]:-1)<<2)+r|0,h[i>>2]=h[i>>2]+2,n=1,r=((-1!=(0|s)?h[h[o>>2]+(s<<2)>>2]:-1)<<2)+r|0;break t}o=h[e+148>>2],n=(r=h[e+156>>2])+((-1!=(0|t)?h[h[o>>2]+(t<<2)>>2]:-1)<<2)|0,h[n>>2]=h[n>>2]+2,i=((-1!=(0|i)?h[h[o>>2]+(i<<2)>>2]:-1)<<2)+r|0,h[i>>2]=h[i>>2]+2,n=2,r=((-1!=(0|s)?h[h[o>>2]+(s<<2)>>2]:-1)<<2)+r|0}h[r>>2]=h[r>>2]+n,n=h[e+184>>2]}switch(0|n){case 0:case 5:return s=h[e+156>>2],r=-1,-1!=(0|t)&&(r=-1,-1!=(0|(t=((i=t+1|0)>>>0)%3|0?i:t-2|0))&&(r=h[h[h[e+148>>2]>>2]+(t<<2)>>2])),h[s+(r<<2)>>2]<=5?void(h[e+188>>2]=5):void(h[e+188>>2]=0)}h[e+188>>2]=-1}function Be(e,t){e|=0;var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0;if(N=r=N-16|0,i=h[20+(t|=0)>>2],i=(l=(n=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,!((0|(o=h[t+12>>2]))<=(0|i)&l>>>0>p[t+8>>2]|(0|i)>(0|o))&&(n=n+h[t>>2]|0,n=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[t+16>>2]=l,h[t+20>>2]=i,!((0|n)<0)&&(nt(e+76|0,n),h[(i=r)>>2]=0,h[i+4>>2]=0,s[i+5|0]=0,s[i+6|0]=0,s[i+7|0]=0,s[i+8|0]=0,s[i+9|0]=0,s[i+10|0]=0,s[i+11|0]=0,s[i+12|0]=0,ze(i,t)))){if(n)for(o=1;a=1<<c,u=Br(i),l=h[e+76>>2]+(c>>>3&536870908)|0,1&(o^=u)?a=h[l>>2]&(-1^a):a|=h[l>>2],o^=1,h[l>>2]=a,(0|n)!=(0|(c=c+1|0)););c=0,l=n=h[t+12>>2],o=i=h[t+20>>2],i=(u=(a=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(f=h[t+8>>2])>>>0<u>>>0&(0|i)>=(0|n)|(0|i)>(0|n)||(m=h[t>>2],n=d[0|(n=m+a|0)]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[t+16>>2]=u,h[t+20>>2]=i,i=o,a=o=a+8|0,o=i=o>>>0<8?i+1|0:i,a>>>0>f>>>0&(0|i)>=(0|l)|(0|i)>(0|l)||(i=d[0|(i=u+m|0)]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[t+16>>2]=a,h[t+20>>2]=o,(0|i)<(0|n)||(h[e+16>>2]=i,h[e+12>>2]=n,!(t=(i>>31)-((n>>31)+(i>>>0<n>>>0)|0)|0)&(i=i-n|0)>>>0>2147483646|t||(c=1,t=i+1|0,h[e+20>>2]=t,i=t>>>1|0,h[e+24>>2]=i,h[e+28>>2]=0-i,1&t||(h[e+24>>2]=i-1)))))}return N=r+16|0,0|c}function Fe(e,t){var r=0,i=0,n=0,s=0,o=0;s=-1,i=-1,-1!=(0|t)&&(s=((i=t+1|0)>>>0)%3|0?i:t-2|0,i=t-1|0,(t>>>0)%3|0||(i=t+2|0));e:{t:{r:switch(h[e+168>>2]){case 0:case 1:n=h[e+148>>2],r=1,o=(t=h[e+156>>2])+((-1!=(0|s)?h[h[n>>2]+(s<<2)>>2]:-1)<<2)|0,h[o>>2]=h[o>>2]+1,t=((-1!=(0|i)?h[h[n>>2]+(i<<2)>>2]:-1)<<2)+t|0;break t;case 5:n=h[e+148>>2],r=-1,r=(-1!=(0|t)?h[h[n>>2]+(t<<2)>>2]:r)<<2,t=h[e+156>>2],h[(r=r+t|0)>>2]=h[r>>2]+1,r=((-1!=(0|s)?h[h[n>>2]+(s<<2)>>2]:-1)<<2)+t|0,h[r>>2]=h[r>>2]+1,r=2,t=((-1!=(0|i)?h[h[n>>2]+(i<<2)>>2]:-1)<<2)+t|0;break t;case 3:n=h[e+148>>2],r=-1,r=(-1!=(0|t)?h[h[n>>2]+(t<<2)>>2]:r)<<2,t=h[e+156>>2],h[(r=r+t|0)>>2]=h[r>>2]+1,r=((-1!=(0|s)?h[h[n>>2]+(s<<2)>>2]:-1)<<2)+t|0,h[r>>2]=h[r>>2]+2,r=1,t=((-1!=(0|i)?h[h[n>>2]+(i<<2)>>2]:-1)<<2)+t|0;break t;case 7:break r;default:break e}n=h[e+148>>2],r=-1,r=(-1!=(0|t)?h[h[n>>2]+(t<<2)>>2]:r)<<2,t=h[e+156>>2],h[(r=r+t|0)>>2]=h[r>>2]+2,r=((-1!=(0|s)?h[h[n>>2]+(s<<2)>>2]:-1)<<2)+t|0,h[r>>2]=h[r>>2]+2,r=2,t=((-1!=(0|i)?h[h[n>>2]+(i<<2)>>2]:-1)<<2)+t|0}h[t>>2]=h[t>>2]+r}r=e,i=h[e+180>>2],t=h[h[e+156>>2]+((-1!=(0|s)?h[h[h[e+148>>2]>>2]+(s<<2)>>2]:-1)<<2)>>2],e=h[e+176>>2],h[r+172>>2]=(0|e)>(0|t)?0:((0|t)>(0|i)?i:t)-e|0}function je(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;if((i=h[e+8>>2])-(n=h[e>>2])>>2>>>0>=t>>>0){if(s=t>>>0>(a=(o=h[e+4>>2])-n>>2)>>>0?a:t){if(u=s-1|0,l=7&s)for(i=n;h[i>>2]=h[r>>2],s=s-1|0,i=i+4|0,(0|(c=c+1|0))!=(0|l););else i=n;if(!(u>>>0<7))for(;h[i>>2]=h[r>>2],h[i+4>>2]=h[r>>2],h[i+8>>2]=h[r>>2],h[i+12>>2]=h[r>>2],h[i+16>>2]=h[r>>2],h[i+20>>2]=h[r>>2],h[i+24>>2]=h[r>>2],h[i+28>>2]=h[r>>2],i=i+32|0,s=s-8|0;);}if(t>>>0>a>>>0){if(i=e,e=t-a|0)for(e=(e<<2)+o|0;h[o>>2]=h[r>>2],(0|e)!=(0|(o=o+4|0)););else e=o;return void(h[i+4>>2]=e)}h[e+4>>2]=n+(t<<2)}else if(n&&(h[e+4>>2]=n,ve(n),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,i=0),t>>>0>=1073741824||(n=i>>1,(i=i>>>0<2147483644?t>>>0>n>>>0?t:n:1073741823)>>>0>=1073741824))vn(),S();else{if(n=mi(i<<=2),h[e>>2]=n,h[e+8>>2]=i+n,r=h[r>>2],i=n,o=7&t)for(;h[i>>2]=r,i=i+4|0,(0|o)!=(0|(s=s+1|0)););if(n=n+(t<<2)|0,(t-1&1073741823)>>>0>=7)for(;h[i+28>>2]=r,h[i+24>>2]=r,h[i+20>>2]=r,h[i+16>>2]=r,h[i+12>>2]=r,h[i+8>>2]=r,h[i+4>>2]=r,h[i>>2]=r,(0|n)!=(0|(i=i+32|0)););h[e+4>>2]=n}}function ze(e,t){var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0;N=r=N-16|0;e:if(!((0|(o=h[t+20>>2]))>=(0|(i=h[t+12>>2]))&(a=h[t+16>>2])>>>0>=p[t+8>>2]|(0|i)<(0|o))){if(s[e+12|0]=d[a+h[t>>2]|0],i=o=h[t+20>>2],o=(n=(a=h[t+16>>2])+1|0)?i:i+1|0,c=n,h[t+16>>2]=n,h[t+20>>2]=o,f[t+38>>1]<=513){if(l=h[t+12>>2],o=i,o=(i=a+5|0)>>>0<5?o+1|0:o,a=i,(n=h[t+8>>2])>>>0<i>>>0&(0|o)>=(0|l)|(0|o)>(0|l))break e;i=c+h[t>>2]|0,i=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[t+16>>2]=a,h[t+20>>2]=o}else{if(!xr(1,r+12|0,t))break e;a=h[t+16>>2],o=h[t+20>>2],n=h[t+8>>2],l=h[t+12>>2],i=h[r+12>>2]}if(c=n-a|0,!((0|(n=l-(o+(n>>>0<a>>>0)|0)|0))<=0&i>>>0>c>>>0|(0|n)<0|(0|i)<=0)){n=a+h[t>>2]|0,h[e>>2]=n,m=e;t:if((u=d[0|(c=(l=i-1|0)+n|0)])>>>0<=63)h[e+4>>2]=l,e=63&d[0|c];else{r:switch((u>>>6|0)-1|0){case 0:if(i>>>0<2)break e;h[e+4>>2]=i-2,e=d[1+(n=(i+n|0)-2|0)|0]<<8&16128|d[0|n];break t;case 1:break r;default:break e}if(i>>>0<3)break e;h[e+4>>2]=i-3,e=d[2+(n=(i+n|0)-3|0)|0]<<16&4128768|d[n+1|0]<<8|d[0|n]}e=e+4096|0,h[m+8>>2]=e,e>>>0>1048575||(o=(e=i+a|0)>>>0<i>>>0?o+1|0:o,h[t+16>>2]=e,h[t+20>>2]=o,g=1)}}return N=r+16|0,g}function We(e,t){var r,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;N=r=N-16|0;e:{if(f[t+38>>1]<=511){if(l=a=h[t+12>>2],i=h[t+20>>2],i=(o=(n=h[t+16>>2])+8|0)>>>0<8?i+1|0:i,(s=h[t+8>>2])>>>0<o>>>0&(0|i)>=(0|a)|(0|i)>(0|a))break e;n=n+h[t>>2]|0,a=d[0|n]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,n=d[n+4|0]|d[n+5|0]<<8|d[n+6|0]<<16|d[n+7|0]<<24,h[t+16>>2]=o,h[t+20>>2]=i}else{if(!hr(1,r+8|0,t))break e;o=h[t+16>>2],i=h[t+20>>2],s=h[t+8>>2],l=h[t+12>>2],a=h[r+8>>2],n=h[r+12>>2]}if(c=s-o|0,!((0|(s=l-(i+(o>>>0>s>>>0)|0)|0))==(0|n)&a>>>0>c>>>0|n>>>0>s>>>0||(i=i+n|0,i=(s=o+a|0)>>>0<o>>>0?i+1|0:i,h[t+16>>2]=s,h[t+20>>2]=i,(0|(i=a))<=0))){t=o+h[t>>2]|0,h[e+40>>2]=t,l=e;t:if((s=d[0|(a=t+(o=i-1|0)|0)])>>>0<=63)h[e+44>>2]=o,e=63&d[0|a];else{switch((s>>>6|0)-1|0){case 0:if(i>>>0<2)break e;h[e+44>>2]=i-2,e=d[1+(t=(t+i|0)-2|0)|0]<<8&16128|d[0|t];break t;case 1:if(i>>>0<3)break e;h[e+44>>2]=i-3,e=d[2+(t=(t+i|0)-3|0)|0]<<16&4128768|d[t+1|0]<<8|d[0|t];break t}h[e+44>>2]=i-4,e=d[2+(t=(t+i|0)-4|0)|0]<<16|d[t+3|0]<<24&1056964608|d[t+1|0]<<8|d[0|t]}e=e+16384|0,h[l+48>>2]=e,u=e>>>0<4194304}}return N=r+16|0,u}function He(e,t,r){var i,n=0,o=0;if(r>>>0>=512)return P(0|e,0|t,0|r),e;i=e+r|0;e:if(3&(e^t))if(i>>>0<4)r=e;else if((n=i-4|0)>>>0<e>>>0)r=e;else for(r=e;s[0|r]=d[0|t],s[r+1|0]=d[t+1|0],s[r+2|0]=d[t+2|0],s[r+3|0]=d[t+3|0],t=t+4|0,n>>>0>=(r=r+4|0)>>>0;);else{t:if(3&e)if(r)for(r=e;;){if(s[0|r]=d[0|t],t=t+1|0,!(3&(r=r+1|0)))break t;if(!(r>>>0<i>>>0))break}else r=e;else r=e;if(!((n=-4&i)>>>0<64||(o=n+-64|0)>>>0<r>>>0))for(;h[r>>2]=h[t>>2],h[r+4>>2]=h[t+4>>2],h[r+8>>2]=h[t+8>>2],h[r+12>>2]=h[t+12>>2],h[r+16>>2]=h[t+16>>2],h[r+20>>2]=h[t+20>>2],h[r+24>>2]=h[t+24>>2],h[r+28>>2]=h[t+28>>2],h[r+32>>2]=h[t+32>>2],h[r+36>>2]=h[t+36>>2],h[r+40>>2]=h[t+40>>2],h[r+44>>2]=h[t+44>>2],h[r+48>>2]=h[t+48>>2],h[r+52>>2]=h[t+52>>2],h[r+56>>2]=h[t+56>>2],h[r+60>>2]=h[t+60>>2],t=t- -64|0,o>>>0>=(r=r- -64|0)>>>0;);if(r>>>0>=n>>>0)break e;for(;h[r>>2]=h[t>>2],t=t+4|0,n>>>0>(r=r+4|0)>>>0;);}if(r>>>0<i>>>0)for(;s[0|r]=d[0|t],t=t+1|0,(0|i)!=(0|(r=r+1|0)););return e}function $e(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;if((s=h[e+8>>2])-(n=h[e+4>>2])>>2>>>0>=t>>>0){if(t){if(i=n,o=7&t)for(;h[i>>2]=h[r>>2],i=i+4|0,(0|o)!=(0|(a=a+1|0)););if(n=(t<<2)+n|0,!((t-1&1073741823)>>>0<7))for(;h[i>>2]=h[r>>2],h[i+4>>2]=h[r>>2],h[i+8>>2]=h[r>>2],h[i+12>>2]=h[r>>2],h[i+16>>2]=h[r>>2],h[i+20>>2]=h[r>>2],h[i+24>>2]=h[r>>2],h[i+28>>2]=h[r>>2],(0|n)!=(0|(i=i+32|0)););}h[e+4>>2]=n}else{e:{if((i=(n=(u=n-(o=h[e>>2])|0)>>2)+t|0)>>>0<1073741824){if(l=(s=s-o|0)>>1,s=s>>>0<2147483644?i>>>0>l>>>0?i:l:1073741823){if(s>>>0>=1073741824)break e;c=mi(s<<2)}if(i=n=(n<<2)+c|0,l=7&t)for(i=n;h[i>>2]=h[r>>2],i=i+4|0,(0|l)!=(0|(a=a+1|0)););if(n=n+(t<<2)|0,(t-1&1073741823)>>>0>=7)for(;h[i>>2]=h[r>>2],h[i+4>>2]=h[r>>2],h[i+8>>2]=h[r>>2],h[i+12>>2]=h[r>>2],h[i+16>>2]=h[r>>2],h[i+20>>2]=h[r>>2],h[i+24>>2]=h[r>>2],h[i+28>>2]=h[r>>2],(0|n)!=(0|(i=i+32|0)););return(0|u)>0&&He(c,o,u),h[e+8>>2]=(s<<2)+c,h[e+4>>2]=n,h[e>>2]=c,void(o&&ve(o))}vn(),S()}Zr(1336),S()}}function Ye(e){var t,r=0,i=0,n=0,s=0;if(h[(e|=0)>>2]=11512,(r=h[196+(t=e+232|0)>>2])&&(h[t+200>>2]=r,ve(r)),i=h[t+184>>2]){if((0|i)==(0|(r=h[t+188>>2])))r=i;else{for(;(s=h[(n=r-12|0)>>2])&&(h[r-8>>2]=s,ve(s)),(0|i)!=(0|(r=n)););r=h[t+184>>2]}h[t+188>>2]=i,ve(r)}if((r=h[t+156>>2])&&(h[t+160>>2]=r,ve(r)),i=h[t+136>>2],h[t+136>>2]=0,i){if(r=h[(n=i-4|0)>>2])for(r=i+(r<<4)|0;(0|i)!=(0|(r=r-16|0)););ve(n)}if(Cr(e+216|0),(r=h[e+196>>2])&&(h[e+200>>2]=r,ve(r)),(r=h[e+184>>2])&&(h[e+188>>2]=r,ve(r)),(r=h[e+172>>2])&&(h[e+176>>2]=r,ve(r)),(r=h[e+160>>2])&&(h[e+164>>2]=r,ve(r)),r=h[e+144>>2])for(;i=h[r>>2],ve(r),r=i;);return r=h[e+136>>2],h[e+136>>2]=0,r&&ve(r),(r=h[e+120>>2])&&ve(r),(r=h[e+108>>2])&&ve(r),(r=h[e+96>>2])&&ve(r),(r=h[e+72>>2])&&(h[e+76>>2]=r,ve(r)),(r=h[e+60>>2])&&ve(r),(r=h[e+48>>2])&&(h[e+52>>2]=r,ve(r)),(r=h[e+36>>2])&&(h[e+40>>2]=r,ve(r)),(r=h[e+24>>2])&&(h[e+28>>2]=r,ve(r)),(r=h[e+12>>2])&&(h[e+16>>2]=r,ve(r)),r=h[e+8>>2],h[e+8>>2]=0,r&&Lr(r),0|e}function qe(e,t){var r,i,n=0,o=0,a=0;N=r=N-16|0,h[e+12>>2]=t,h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,h[(n=e+16|0)>>2]=0,h[n+4>>2]=0,s[n+5|0]=0,s[n+6|0]=0,s[n+7|0]=0,s[n+8|0]=0,s[n+9|0]=0,s[n+10|0]=0,s[n+11|0]=0,s[n+12|0]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+48>>2]=0,h[e+40>>2]=0,h[e+44>>2]=0,h[e+52>>2]=0,h[e+56>>2]=0,h[e+68>>2]=0,h[e+60>>2]=0,h[e+64>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,h[e+88>>2]=0,h[e+80>>2]=0,h[e+84>>2]=0,h[e+100>>2]=0,h[e+92>>2]=0,h[e+96>>2]=0,i=e+116|0;e:{t:{if(t){if(t>>>0<1073741824)break t;vn(),S()}h[e+104>>2]=0,h[e+108>>2]=0,h[e+112>>2]=0,h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,n=1;break e}o=mi(n=t<<2),h[e+92>>2]=o,a=n+o|0,h[e+100>>2]=a,St(o,0,n),h[e+112>>2]=0,h[e+104>>2]=0,h[e+108>>2]=0,h[e+96>>2]=a,o=mi(n),h[e+104>>2]=o,a=n+o|0,h[e+112>>2]=a,St(o,0,n),h[e+108>>2]=a,o=mi(n),h[r>>2]=o,a=n+o|0,h[r+8>>2]=a,St(o,0,n),h[r+4>>2]=a,n=t<<5|1}return Ut(i,n,r),(o=h[r>>2])&&(h[r+4>>2]=o,ve(o)),h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,t&&(o=mi(t<<=2),h[r>>2]=o,a=t+o|0,h[r+8>>2]=a,St(o,0,t),h[r+4>>2]=a),Ut(e+128|0,n,r),(t=h[r>>2])&&(h[r+4>>2]=t,ve(t)),N=r+16|0,e}function Xe(e,t,r,i){var n,s=0,o=0,a=0,l=0,c=0,u=0,h=0,d=0;n=r;e:{t:{r:{i:{n:{s:{o:{a:{l:{c:{u:{if(t){if(!n)break u;if(!i)break c;if((r=y(i)-y(t)|0)>>>0<=31)break l;break r}if(1==(0|i)|i>>>0>1)break r;e=(e>>>0)/(n>>>0)|0,G=0;break e}if(!e)break a;if(!i)break o;if(i-1&i)break o;e=t>>>Ui(i)|0,G=0;break e}if(!(n-1&n))break s;s=0-(a=(y(n)+33|0)-y(t)|0)|0;break i}a=r+1|0,s=63-r|0;break i}e=(t>>>0)/(i>>>0)|0,G=0;break e}if((r=y(i)-y(t)|0)>>>0<31)break n;break r}if(1==(0|n))break t;i=31&(r=Ui(n)),(63&r)>>>0>=32?(r=0,e=t>>>i|0):(r=t>>>i|0,e=((1<<i)-1&t)<<32-i|e>>>i),G=r;break e}a=r+1|0,s=63-r|0}if(o=31&(r=63&a),r>>>0>=32?(r=0,l=t>>>o|0):(r=t>>>o|0,l=((1<<o)-1&t)<<32-o|e>>>o),o=r,s=31&(r=63&s),r>>>0>=32?(r=e<<s,e=0):(r=(1<<s)-1&e>>>32-s|t<<s,e<<=s),t=r,a)for(r=i-1|0,d=-1!=(0|(s=n-1|0))?r+1|0:r;l=(r=l<<1|t>>>31)-(u=n&(c=d-((o=o<<1|l>>>31)+(r>>>0>s>>>0)|0)>>31))|0,o=o-((i&c)+(r>>>0<u>>>0)|0)|0,t=t<<1|e>>>31,e=h|e<<1,h=1&c,a=a-1|0;);G=t<<1|e>>>31,e=h|e<<1;break e}e=0,t=0}G=t}return e}function Ze(e,t){var r,i,n=0,s=0,o=0;N=r=N-16|0,h[e+12>>2]=t,h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e+32>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,h[e+36>>2]=0,h[e+40>>2]=0,h[e+52>>2]=0,h[e+44>>2]=0,h[e+48>>2]=0,h[e+56>>2]=0,h[e+60>>2]=0,h[e+72>>2]=0,h[e+64>>2]=0,h[e+68>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+92>>2]=0,h[e+84>>2]=0,h[e+88>>2]=0,h[e+104>>2]=0,h[e+96>>2]=0,h[e+100>>2]=0,i=e+120|0;e:{t:{if(t){if(t>>>0<1073741824)break t;vn(),S()}h[e+108>>2]=0,h[e+112>>2]=0,h[e+116>>2]=0,h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,s=1;break e}n=mi(s=t<<2),h[e+96>>2]=n,o=n+s|0,h[e+104>>2]=o,St(n,0,s),h[e+116>>2]=0,h[e+108>>2]=0,h[e+112>>2]=0,h[e+100>>2]=o,n=mi(s),h[e+108>>2]=n,o=n+s|0,h[e+116>>2]=o,St(n,0,s),h[e+112>>2]=o,n=mi(s),h[r>>2]=n,o=n+s|0,h[r+8>>2]=o,St(n,0,s),h[r+4>>2]=o,s=t<<5|1}return Ut(i,s,r),(n=h[r>>2])&&(h[r+4>>2]=n,ve(n)),h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,t&&(n=mi(t<<=2),h[r>>2]=n,o=t+n|0,h[r+8>>2]=o,St(n,0,t),h[r+4>>2]=o),Ut(e+132|0,s,r),(t=h[r>>2])&&(h[r+4>>2]=t,ve(t)),N=r+16|0,e}function Je(e,t){var r=0,i=0,n=0;r=(0|e)==(0|t),s[t+12|0]=r;e:if(!r)for(;;){if(i=h[t+8>>2],d[i+12|0])break e;t:{if(r=h[i+8>>2],(0|i)!=(0|(n=h[r>>2]))){if(!(d[n+12|0]|!n))break t;h[i>>2]==(0|t)?(e=h[t+4>>2],h[i>>2]=e,e&&(h[e+8>>2]=i,r=h[i+8>>2]),h[t+8>>2]=r,e=h[i+8>>2],h[(((0|i)!=h[e>>2])<<2)+e>>2]=t,h[t+4>>2]=i,h[i+8>>2]=t,r=h[t+8>>2]):t=i,s[t+12|0]=1,s[r+12|0]=0,e=h[r+4>>2],t=h[e>>2],h[r+4>>2]=t,t&&(h[t+8>>2]=r),h[e+8>>2]=h[r+8>>2],t=h[r+8>>2],h[((h[t>>2]!=(0|r))<<2)+t>>2]=e,h[e>>2]=r,t=r+8|0}else{if(!(!(n=h[r+4>>2])|d[n+12|0]))break t;h[i>>2]!=(0|t)?(t=h[i+4>>2],e=h[t>>2],h[i+4>>2]=e,e&&(h[e+8>>2]=i,r=h[i+8>>2]),h[t+8>>2]=r,e=h[i+8>>2],h[(((0|i)!=h[e>>2])<<2)+e>>2]=t,h[t>>2]=i,h[i+8>>2]=t,r=h[t+8>>2]):t=i,s[t+12|0]=1,s[r+12|0]=0,e=h[r>>2],t=h[e+4>>2],h[r>>2]=t,t&&(h[t+8>>2]=r),h[e+8>>2]=h[r+8>>2],t=h[r+8>>2],h[((h[t>>2]!=(0|r))<<2)+t>>2]=e,h[e+4>>2]=r,t=r+8|0}h[t>>2]=e;break e}if(s[i+12|0]=1,i=(0|e)==(0|r),s[r+12|0]=i,s[n+12|0]=1,t=r,i)break}}function Ke(e,t,r,i){var n,s,o=0,a=0,l=0,c=0,u=0,d=0,f=0;if(n=h[t+16>>2],o=u=h[r+4>>2]-n|0,a=h[r>>2]-n|0,h[r>>2]=a,h[r+4>>2]=o,s=(0|(l=h[t+16>>2]))>=((c=(o>>=31)+u^o)+((o=a>>31)+a^o)|0))o=u;else{e:{t:{if((0|a)>=0){if(o=1,c=1,(0|u)>=0)break e;if(d=1,o=-1,c=-1,a)break t;break e}if(d=-1,o=-1,c=-1,(0|u)<=0)break e}o=(0|u)<=0?-1:1,c=d}a=(a<<1)-(d=v(l,c))|0,o=(((c=(0|v(o,c))>=0)?0-a|0:a)+(l=v(o,l))|0)/2|0,h[r+4>>2]=o,f=r,r=(u<<1)-l|0,a=(d+(c?0-r|0:r)|0)/2|0,h[f>>2]=a,l=h[t+16>>2]}if(r=h[i+4>>2]+o|0,(0|l)<(0|(a=h[i>>2]+a|0))?a=a-h[t+4>>2]|0:(0-l|0)<=(0|a)||(a=h[t+4>>2]+a|0),(0|r)>(0|l)?r=r-h[t+4>>2]|0:(0-l|0)<=(0|r)||(r=h[t+4>>2]+r|0),s)l=r;else{e:{t:{if((0|a)>=0){if(t=1,o=1,(0|r)>=0)break e;if(i=1,t=-1,o=-1,a)break t;break e}if(i=-1,t=-1,o=-1,(0|r)<=0)break e}t=(0|r)<=0?-1:1,o=i}i=(a<<1)-(u=v(o,l))|0,h[e>>2]=i,d=0-i|0,c=i,l=(((i=(0|v(t,o))>=0)?d:c)+(t=v(t,l))|0)/2|0,t=(r<<1)-t|0,a=(u+(i?0-t|0:t)|0)/2|0}h[e>>2]=a+n,h[e+4>>2]=l+n}function Qe(e){var t,r=0,i=0,n=0,s=0,o=0,a=0;N=t=N-32|0;e:if((r=h[e+16>>2])>>>0>=341)h[e+16>>2]=r-341,r=h[e+4>>2],h[t+8>>2]=h[r>>2],h[e+4>>2]=r+4,at(e,t+8|0);else{t:{r:{i:{n:{if((s=(n=h[e+8>>2])-h[e+4>>2]>>2)>>>0<(r=(i=h[e+12>>2])-h[e>>2]|0)>>2>>>0){if((0|i)==(0|n))break n;o=t,a=mi(4092),h[o+8>>2]=a,at(e,t+8|0);break e}if(h[t+24>>2]=e+12,(r=r?r>>1:1)>>>0>=1073741824)break i;if(r=mi(i=r<<2),h[t+8>>2]=r,n=r+(s<<2)|0,h[t+16>>2]=n,h[t+20>>2]=r+i,h[t+12>>2]=n,o=t,a=mi(4092),h[o+4>>2]=a,at(t+8|0,t+4|0),(0|(i=h[e+8>>2]))==h[e+4>>2]){r=i;break t}for(;ct(t+8|0,i=i-4|0),h[e+4>>2]!=(0|i););break r}o=t,a=mi(4092),h[o+8>>2]=a,ct(e,r=t+8|0),i=h[e+4>>2],h[t+8>>2]=h[i>>2],h[e+4>>2]=i+4,at(e,r);break e}Zr(1336),S()}r=h[e+8>>2]}n=h[e>>2],h[e>>2]=h[t+8>>2],h[t+8>>2]=n,h[e+4>>2]=h[t+12>>2],h[t+12>>2]=i,h[e+8>>2]=h[t+16>>2],h[t+16>>2]=r,s=h[e+12>>2],h[e+12>>2]=h[t+20>>2],h[t+20>>2]=s,(0|r)!=(0|i)&&(h[t+16>>2]=r+(((r-i|0)-4>>>2^-1)<<2)),n&&ve(n)}N=t+32|0}function et(e,t,r){e|=0,t|=0,r|=0;var i,n=0,o=0,a=0,l=0,c=0,u=_(0),d=0,f=0,p=0,g=0,v=0,b=0,y=0,E=0,w=0,x=0,A=0;if(N=i=N-16|0,9==h[r+28>>2]){n=h[e+4>>2],o=(l=s[r+24|0])<<2,a=mi((1073741823&l)!=(0|l)?-1:o),h[(f=i+8|0)>>2]=1065353216,u=m[e+20>>2],(0|(n=-1<<n^-1))>0&&(m[f>>2]=u/_(0|n));e:if((v=(0|n)>0)&&(d=h[r+80>>2]))if(n=0,(0|l)<=0){if(1!=(0|d))for(e=-2&d,t=0;He(h[h[r+64>>2]>>2]+n|0,a,o),He((n=n+o|0)+h[h[r+64>>2]>>2]|0,a,o),n=n+o|0,(0|e)!=(0|(t=t+2|0)););if(!(1&d))break e;He(h[h[r+64>>2]>>2]+n|0,a,o)}else for(b=h[h[t>>2]>>2]+h[t+48>>2]|0,x=-2&l,A=1&l;;){if(p=h[e+8>>2],u=m[f>>2],t=0,g=0,1!=(0|l))for(;y=(n<<2)+b|0,m[(c=t<<2)+a>>2]=_(u*_(h[y>>2]))+m[c+p>>2],m[(c|=4)+a>>2]=_(u*_(h[y+4>>2]))+m[c+p>>2],t=t+2|0,n=n+2|0,(0|x)!=(0|(g=g+2|0)););if(A&&(m[(t<<=2)+a>>2]=_(u*_(h[(n<<2)+b>>2]))+m[t+p>>2],n=n+1|0),He(h[h[r+64>>2]>>2]+E|0,a,o),E=o+E|0,(0|(w=w+1|0))==(0|d))break}ve(a)}return N=i+16|0,0|v}function tt(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0;i=(r>>>0)/3|0,l=h[(h[h[e+8>>2]+96>>2]+v(i,12)|0)+(r-v(i,3)<<2)>>2],n=h[h[e+12>>2]+4>>2];e:if((0|(i=h[n+4>>2]))==h[n+8>>2]){t:{if((i=1+(c=(o=i-(a=h[n>>2])|0)>>2)|0)>>>0<1073741824){if(s=o>>1,s=o>>>0<2147483644?i>>>0>s>>>0?i:s:1073741823){if(s>>>0>=1073741824)break t;i=mi(s<<2)}else i=0;h[(c=i+(c<<2)|0)>>2]=l,(0|o)>0&&He(i,a,o),h[n+8>>2]=i+(s<<2),h[n+4>>2]=c+4,h[n>>2]=i,a&&ve(a);break e}vn(),S()}Zr(1336),S()}else h[i>>2]=l,h[n+4>>2]=i+4;n=h[e+4>>2];e:{t:{if((0|(i=h[n+4>>2]))==h[n+8>>2]){if((i=1+(l=(o=i-(a=h[n>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(s=o>>1,s=o>>>0<2147483644?i>>>0>s>>>0?i:s:1073741823){if(s>>>0>=1073741824)break e;i=mi(s<<2)}else i=0;h[(l=i+(l<<2)|0)>>2]=r,(0|o)>0&&He(i,a,o),h[n+8>>2]=i+(s<<2),h[n+4>>2]=l+4,h[n>>2]=i,a&&ve(a)}else h[i>>2]=r,h[n+4>>2]=i+4;return e=h[e+4>>2],h[h[e+12>>2]+(t<<2)>>2]=h[e+24>>2],void(h[e+24>>2]=h[e+24>>2]+1)}vn(),S()}Zr(1336),S()}function rt(e,t){var r=0,i=0,n=0,o=0,a=0,l=0,c=0,u=0;if((i=d[e+11|0]>>>7|0?h[e+4>>2]:d[e+11|0])>>>0<t>>>0)return N=l=N-16|0,(o=t-i|0)&&(c=(a=(t=d[e+11|0]>>>7|0)?h[e+4>>2]:d[e+11|0])+o|0,(t=t?(2147483647&h[e+8>>2])-1|0:10)-a>>>0<o>>>0&&(N=i=N-16|0,(r=c-t|0)>>>0<=-17-t>>>0?(u=d[e+11|0]>>>7|0?h[e>>2]:e,t>>>0<2147483623?(h[i+8>>2]=t<<1,h[i+12>>2]=t+r,N=r=N-16|0,N=r+16|0,r=i+8|0,r=(r=h[(p[(n=i+12|0)>>2]<p[r>>2]?r:n)>>2])>>>0>=11?11==(0|(r=(n=r+16&-16)-1|0))?n:r:10):r=-18,r=mi(n=r+1|0),a&&rn(r,u,a),10!=(0|t)&&ve(u),h[e>>2]=r,h[e+8>>2]=-2147483648|n,N=i+16|0):(mn(),S())),i=a+(t=d[e+11|0]>>>7|0?h[e>>2]:e)|0,o&&St(i,0,o),d[e+11|0]>>>7|0?h[e+4>>2]=c:s[e+11|0]=c,s[l+15|0]=0,s[t+c|0]=d[l+15|0]),void(N=l+16|0);N=i=N-16|0,d[e+11|0]>>>7|0?(o=h[e>>2],s[i+15|0]=0,s[t+o|0]=d[i+15|0],h[e+4>>2]=t):(s[i+14|0]=0,s[e+t|0]=d[i+14|0],s[e+11|0]=t),N=i+16|0}function it(e,t){e|=0;var r,i,n,s=0,o=0,a=0,l=0,c=0,u=0,p=0,m=0;s=r=h[12+(t|=0)>>2],l=o=h[t+20>>2],o=(a=(i=h[t+16>>2])+4|0)>>>0<4?o+1|0:o;e:if(!((n=h[t+8>>2])>>>0<a>>>0&(0|s)<=(0|o)|(0|s)<(0|o)||(u=h[t>>2],s=d[0|(s=i+u|0)]|d[s+1|0]<<8|d[s+2|0]<<16|d[s+3|0]<<24,h[t+16>>2]=a,h[t+20>>2]=o,o=l,(c=i+8|0)>>>0>n>>>0&(0|(o=c>>>0<8?o+1|0:o))>=(0|r)|(0|o)>(0|r)||(a=d[0|(a=a+u|0)]|d[a+1|0]<<8|d[a+2|0]<<16|d[a+3|0]<<24,h[t+16>>2]=c,h[t+20>>2]=o,(0|s)>(0|a)||(h[e+16>>2]=a,h[e+12>>2]=s,!(m=(a>>31)-((s>>31)+(s>>>0>a>>>0)|0)|0)&(s=a-s|0)>>>0>2147483646|m))))){if(s=s+1|0,h[e+20>>2]=s,a=s>>>1|0,h[e+24>>2]=a,h[e+28>>2]=0-a,1&s||(h[e+24>>2]=a-1),f[t+38>>1]<=513){if((0|o)>=(0|r)&c>>>0>=n>>>0|(0|o)>(0|r))break e;s=d[c+u|0],o=l,o=(l=i+9|0)>>>0<9?o+1|0:o,h[t+16>>2]=l,h[t+20>>2]=o;t:switch(0|s){case 1:p=1;break;case 0:break t;default:break e}h[e+88>>2]=p}p=ze(e+112|0,t)}return 0|p}function nt(e,t){var r,i=0,n=0,s=0,o=0,a=0,l=0;N=r=N-16|0;e:{t:if((n=h[e+4>>2])>>>0<t>>>0){if((s=t-n|0)>>>0>(i=(a=h[e+8>>2])<<5)>>>0|n>>>0>i-s>>>0){if(h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,(0|t)<0)break e;i>>>0<=1073741822?(i=t+31&-32,t=(t=a<<6)>>>0<i>>>0?i:t):t=2147483647,Se(r,t),n=h[e+4>>2],h[r+4>>2]=n+s,l=h[e>>2],t=h[r>>2],(0|n)<=0||(t=Et(t,l,a=(i=n>>>5|0)<<2)+a|0,(0|(o=n-(i<<5)|0))<=0?o=0:(i=-1>>>32-o|0,h[t>>2]=h[t>>2]&(-1^i)|i&h[l+a>>2]),l=h[e>>2]),h[e>>2]=h[r>>2],h[r>>2]=l,i=h[e+4>>2],h[e+4>>2]=h[r+4>>2],h[r+4>>2]=i,i=h[e+8>>2],h[e+8>>2]=h[r+8>>2],h[r+8>>2]=i,l&&ve(l)}else h[e+4>>2]=t,o=31&n,t=h[e>>2]+(n>>>3&536870908)|0;if(!s)break t;if(o&&(e=(i=32-o|0)>>>0>s>>>0?s:i,h[t>>2]=h[t>>2]&(-1<<o&-1>>>i-e^-1),s=s-e|0,t=t+4|0),e=St(t,0,i=s>>>5<<2),!(t=31&s))break t;h[(e=e+i|0)>>2]=h[e>>2]&(-1>>>32-t^-1)}else h[e+4>>2]=t;return void(N=r+16|0)}pn(),S()}function st(e,t,r){t|=0,r|=0;var i=0,n=0,o=0,a=0,l=0,c=0,u=0;return(i=(o=h[12+(e|=0)>>2])-(l=h[e+8>>2])>>2)>>>0<(t=s[t+24|0])>>>0?(er(e+8|0,t-i|0),l=h[e+8>>2],o=h[e+12>>2]):t>>>0>=i>>>0||(o=(t<<2)+l|0,h[e+12>>2]=o),t=0,c=h[r+20>>2],o=i=o-l|0,a=(n=h[r+16>>2])+i|0,u=h[r+12>>2],c=i>>>0>a>>>0?c+1|0:c,a>>>0>p[r+8>>2]&(0|u)<=(0|c)|(0|c)>(0|u)||(He(l,n+h[r>>2]|0,i),i=h[r+20>>2],i=(n=o+h[r+16>>2]|0)>>>0<o>>>0?i+1|0:i,a=n,h[r+16>>2]=n,h[r+20>>2]=i,n=h[r+12>>2],i=(o=a+4|0)>>>0<4?i+1|0:i,o>>>0>p[r+8>>2]&(0|i)>=(0|n)|(0|i)>(0|n)||(i=a+h[r>>2]|0,h[e+20>>2]=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,i=h[r+20>>2],o=(n=(a=h[r+16>>2])+4|0)>>>0<4?i+1|0:i,u=n,h[r+16>>2]=n,h[r+20>>2]=o,(0|o)>=(0|(n=h[r+12>>2]))&u>>>0>=p[r+8>>2]|(0|o)>(0|n)||(n=d[u+h[r>>2]|0],i=(o=a+5|0)>>>0<5?i+1|0:i,h[r+16>>2]=o,h[r+20>>2]=i,n-1>>>0>29||(h[e+4>>2]=n,t=1)))),0|t}function ot(e,t){var r=0;return ze(e,t)&&ze(e+16|0,t)&&ze(e+32|0,t)&&ze(e+48|0,t)&&ze(e- -64|0,t)&&ze(e+80|0,t)&&ze(e+96|0,t)&&ze(e+112|0,t)&&ze(e+128|0,t)&&ze(e+144|0,t)&&ze(e+160|0,t)&&ze(e+176|0,t)&&ze(e+192|0,t)&&ze(e+208|0,t)&&ze(e+224|0,t)&&ze(e+240|0,t)&&ze(e+256|0,t)&&ze(e+272|0,t)&&ze(e+288|0,t)&&ze(e+304|0,t)&&ze(e+320|0,t)&&ze(e+336|0,t)&&ze(e+352|0,t)&&ze(e+368|0,t)&&ze(e+384|0,t)&&ze(e+400|0,t)&&ze(e+416|0,t)&&ze(e+432|0,t)&&ze(e+448|0,t)&&ze(e+464|0,t)&&ze(e+480|0,t)&&ze(e+496|0,t)&&(r=ze(e+512|0,t)),r}function at(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0;e:{if((0|(n=h[e+8>>2]))==h[e+12>>2])if((i=h[e+4>>2])>>>0>(o=h[e>>2])>>>0)r=(o=(1+(i-o>>2)|0)/-2<<2)+i|0,(s=n-i|0)&&(Et(r,i,s),i=h[e+4>>2]),n=r+s|0,h[e+8>>2]=n,h[e+4>>2]=i+o;else{if((s=(r=n-o|0)?r>>1:1)>>>0>=1073741824)break e;if(u=(a=mi(r=s<<2))+r|0,r=n-i|0,n=s=(-4&s)+a|0,r){if(d=-4&r,c=1+((l=r-4|0)>>>2|0)&7)for(n=0,r=s;h[r>>2]=h[i>>2],i=i+4|0,r=r+4|0,(0|c)!=(0|(n=n+1|0)););else r=s;if(n=s+d|0,!(l>>>0<28))for(;h[r>>2]=h[i>>2],h[r+4>>2]=h[i+4>>2],h[r+8>>2]=h[i+8>>2],h[r+12>>2]=h[i+12>>2],h[r+16>>2]=h[i+16>>2],h[r+20>>2]=h[i+20>>2],h[r+24>>2]=h[i+24>>2],h[r+28>>2]=h[i+28>>2],i=i+32|0,(0|n)!=(0|(r=r+32|0)););}h[e+12>>2]=u,h[e+8>>2]=n,h[e+4>>2]=s,h[e>>2]=a,o&&(ve(o),n=h[e+8>>2])}return h[n>>2]=h[t>>2],void(h[e+8>>2]=h[e+8>>2]+4)}Zr(1336),S()}function lt(e,t){var r,i=0,n=0,o=0,a=0,l=0;N=r=N-16|0;e:{t:{if(t){if(h[e+88>>2]=0,h[e+92>>2]=0,i=h[e+84>>2],h[e+84>>2]=0,i&&ve(i),h[e+76>>2]=0,h[e+80>>2]=0,i=h[e+72>>2],h[e+72>>2]=0,i&&ve(i),i=h[t>>2],n=h[t+4>>2],s[r+15|0]=0,Rt(e,n-i>>2,r+15|0),i=h[t+28>>2],n=h[t+24>>2],s[r+14|0]=0,Rt(e+12|0,i-n>>2,r+14|0),je(e+28|0,h[t+4>>2]-h[t>>2]>>2,13740),o=(n=h[t+28>>2]-h[t+24>>2]|0)>>2,i=h[e+52>>2],!(o>>>0<=h[e+60>>2]-i>>2>>>0)){if((0|n)<0)break t;a=h[e+56>>2],l=(n=mi(n))+(o<<2)|0,a=(o=a-i|0)+n|0,(0|o)>0&&He(n,i,o),h[e+60>>2]=l,h[e+56>>2]=a,h[e+52>>2]=n,i&&ve(i)}if(o=(n=h[t+28>>2]-h[t+24>>2]|0)>>2,i=h[e+40>>2],!(o>>>0<=h[e+48>>2]-i>>2>>>0)){if((0|n)<0)break e;a=h[e+44>>2],l=(n=mi(n))+(o<<2)|0,a=(o=a-i|0)+n|0,(0|o)>0&&He(n,i,o),h[e+48>>2]=l,h[e+44>>2]=a,h[e+40>>2]=n,i&&ve(i)}s[e+24|0]=1,h[e+64>>2]=t}return void(N=r+16|0)}Zr(1336),S()}Zr(1336),S()}function ct(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,d=0;e:{if((0|(o=h[e+4>>2]))==h[e>>2])if((i=h[e+8>>2])>>>0<(r=h[e+12>>2])>>>0)r=(s=(1+(r-i>>2)|0)/2<<2)+i|0,(n=i-o|0)&&(Et(r=r-n|0,o,n),i=h[e+8>>2]),h[e+4>>2]=r,h[e+8>>2]=i+s;else{if((r=(r=r-o|0)?r>>1:1)>>>0>=1073741824)break e;if(d=(a=mi(n=r<<2))+n|0,s=r=(r+3&-4)+a|0,l=i-o|0){if(i=r,n=o,u=1+((c=l-4|0)>>>2|0)&7)for(s=0;h[i>>2]=h[n>>2],n=n+4|0,i=i+4|0,(0|u)!=(0|(s=s+1|0)););if(s=(-4&l)+r|0,!(c>>>0<28))for(;h[i>>2]=h[n>>2],h[i+4>>2]=h[n+4>>2],h[i+8>>2]=h[n+8>>2],h[i+12>>2]=h[n+12>>2],h[i+16>>2]=h[n+16>>2],h[i+20>>2]=h[n+20>>2],h[i+24>>2]=h[n+24>>2],h[i+28>>2]=h[n+28>>2],n=n+32|0,(0|s)!=(0|(i=i+32|0)););}h[e+12>>2]=d,h[e+8>>2]=s,h[e+4>>2]=r,h[e>>2]=a,o&&(ve(o),r=h[e+4>>2])}else r=o;return h[r-4>>2]=h[t>>2],void(h[e+4>>2]=h[e+4>>2]-4)}Zr(1336),S()}function ut(e,t,r,i){var n,s=0,o=0,a=0,l=0,c=0,u=0,d=0,f=0;c=+m[t>>2],u=+m[t+4>>2],d=+m[t+8>>2],(a=b(c)+b(u)+b(d))>1e-6?(u*=a=1/a,c*=a,s=a*d<0):(c=1,u=0,s=0),n=h[e+16>>2],a=x(c*(d=+(0|n))+.5),l=(o=(f=b(a)<2147483648?~~a:-2147483648)>>31)+f^o,a=x(u*d+.5),l=(0|(t=n-(l+((o=b(a)<2147483648?~~a:-2147483648)+(t=o>>31)^t)|0)|0))<0?0:t,s=s?0-l|0:l,o=o+(t>>31&((0|o)>0?t:0-t|0))|0,(0|f)>=0?(t=s+n|0,e=h[e+8>>2],s=n+o|0):(t=o>>31,t^=t+o,e=h[e+8>>2],t=(0|s)<0?t:e-t|0,s=(0|o)<0?l:e-l|0),t|s&&(0|e)!=(0|t)|s&&(0|e)!=(0|s)|t?(0|t)<=(0|n)|s?(0|e)!=(0|s)|(0|t)>=(0|n)?(0|e)!=(0|t)|(0|s)>=(0|n)?t?e=s:(t=0,e=(0|s)<=(0|n)?s:(n<<1)-s|0):(t=e,e=(n<<1)-s|0):t=(n<<1)-t|0:(t=(n<<1)-t|0,e=0):t=e,h[r>>2]=e,h[i>>2]=t}function ht(e,t,r){e|=0,t|=0,r|=0;var i=0,n=_(0),o=_(0),a=_(0),u=_(0),f=_(0),p=0,m=_(0),g=_(0),v=_(0),y=_(0),E=0;if(!(9!=h[r+28>>2]|3!=d[r+24|0])&&!((e=h[e+4>>2])-31>>>0<4294967267)&&(E=1,p=h[r+80>>2]))for(m=_(_(2)/_((1<<e)-2|0)),r=h[h[r>>2]>>2]+h[r+48>>2]|0,e=h[h[t>>2]>>2]+h[t+48>>2]|0,t=0;a=_(0),g=_(0),v=_(0),n=_(_(_(h[e>>2])*m)+_(-1)),o=_(_(_(h[e+4>>2])*m)+_(-1)),f=_(_(_(1)-_(b(n)))-_(b(o))),u=_(w(_(-f),_(0))),y=_(-u),o=_(o+(o<_(0)?u:y)),n=_(n+(n<_(0)?u:y)),+(u=_(_(o*o)+_(_(f*f)+_(n*n))))<1e-6||(a=_(_(1)/_(T(u))),v=_(o*a),g=_(n*a),a=_(f*a)),e=e+8|0,l(v),i=c(2),s[r+8|0]=i,s[r+9|0]=i>>>8,s[r+10|0]=i>>>16,s[r+11|0]=i>>>24,l(g),i=c(2),s[r+4|0]=i,s[r+5|0]=i>>>8,s[r+6|0]=i>>>16,s[r+7|0]=i>>>24,l(a),i=c(2),s[0|r]=i,s[r+1|0]=i>>>8,s[r+2|0]=i>>>16,s[r+3|0]=i>>>24,r=r+12|0,(0|p)!=(0|(t=t+1|0)););return 0|E}function dt(e,t){var r,i,n,o=0,a=0,l=0;i=h[e>>2],h[(o=i+(t>>>3&536870908)|0)>>2]=h[o>>2]|1<<t,r=h[e+64>>2],a=-1,(l=-1==(0|t))||(a=-1,-1!=(0|(o=((o=t+1|0)>>>0)%3|0?o:t-2|0))&&(a=h[h[r>>2]+(o<<2)>>2])),o=h[e+12>>2],h[(n=(a>>>3&536870908)+o|0)>>2]=h[n>>2]|1<<a;e:{if(l)e=o+536870908|0,t=h[o+536870908>>2],o=-2147483648;else{t:{if((t>>>0)%3|0)l=t-1|0;else if(a=-1,-1==(0|(l=t+2|0)))break t;a=h[h[r>>2]+(l<<2)>>2]}if(h[(l=(a>>>3&536870908)+o|0)>>2]=h[l>>2]|1<<a,a=-1,-1==(0|(t=h[h[r+12>>2]+(t<<2)>>2])))break e;s[e+24|0]=0,h[(e=(t>>>3&536870908)+i|0)>>2]=h[e>>2]|1<<t,-1!=(0|(e=((e=t+1|0)>>>0)%3|0?e:t-2|0))&&(a=h[h[r>>2]+(e<<2)>>2]),h[(e=o+(a>>>3&536870908)|0)>>2]=h[e>>2]|1<<a;t:{if((t>>>0)%3|0)t=t-1|0;else if(e=-1,-1==(0|(t=t+2|0)))break t;e=h[h[r>>2]+(t<<2)>>2]}t=1<<e,o=h[(e=o+(e>>>3&536870908)|0)>>2]}h[e>>2]=t|o}}function ft(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0;e:if(t>>>0<=63){if(t=0,(e=h[e+12>>2])>>>0<2)break e;if(i=h[r>>2],n=3&(t=e-1|0),r=0,e-2>>>0<3)e=1,t=0;else for(s=-4&t,t=0,e=1;o=e+3|0,a=e+2|0,l=e+1|0,t=p[i+(t<<2)>>2]>p[i+(e<<2)>>2]?e:t,t=p[i+(t<<2)>>2]>p[i+(l<<2)>>2]?l:t,t=p[i+(t<<2)>>2]>p[i+(a<<2)>>2]?a:t,t=p[i+(t<<2)>>2]>p[i+(o<<2)>>2]?o:t,e=e+4|0,(0|s)!=(0|(c=c+4|0)););if(!n)break e;for(;t=p[i+(t<<2)>>2]>p[i+(e<<2)>>2]?e:t,e=e+1|0,(0|n)!=(0|(r=r+1|0)););}else{if((0|(i=32-(t=h[e+580>>2])|0))>=4){if((0|(r=h[e+576>>2]))==h[e+568>>2])return 0;if(i=h[r>>2],n=t+4|0,h[e+580>>2]=n,t=i<<t>>>28|0,32!=(0|n))break e;return h[e+580>>2]=0,h[e+576>>2]=r+4,t}if((0|(n=(r=h[e+576>>2])+4|0))==h[e+568>>2])return 0;s=h[r>>2],h[e+576>>2]=n,h[e+580>>2]=t-28,e=60-t|0,t=h[r+4>>2]>>>e|s<<t>>>e-i}return t}function pt(e){var t,r=0,i=0,n=0;if(h[(e|=0)>>2]=11464,(r=h[e+388>>2])&&(h[e+392>>2]=r,ve(r)),t=h[e+368>>2],h[e+368>>2]=0,t){if(r=h[(n=t-4|0)>>2])for(i=(r<<4)+t|0;(0|t)!=(0|(i=i-16|0)););ve(n)}if(Cr(e+216|0),(r=h[e+196>>2])&&(h[e+200>>2]=r,ve(r)),(r=h[e+184>>2])&&(h[e+188>>2]=r,ve(r)),(r=h[e+172>>2])&&(h[e+176>>2]=r,ve(r)),(r=h[e+160>>2])&&(h[e+164>>2]=r,ve(r)),i=h[e+144>>2])for(;r=h[i>>2],ve(i),i=r,r;);return r=h[e+136>>2],h[e+136>>2]=0,r&&ve(r),(r=h[e+120>>2])&&ve(r),(r=h[e+108>>2])&&ve(r),(r=h[e+96>>2])&&ve(r),(r=h[e+72>>2])&&(h[e+76>>2]=r,ve(r)),(r=h[e+60>>2])&&ve(r),(r=h[e+48>>2])&&(h[e+52>>2]=r,ve(r)),(r=h[e+36>>2])&&(h[e+40>>2]=r,ve(r)),(r=h[e+24>>2])&&(h[e+28>>2]=r,ve(r)),(r=h[e+12>>2])&&(h[e+16>>2]=r,ve(r)),r=h[e+8>>2],h[e+8>>2]=0,r&&Lr(r),0|e}function mt(e,t){var r=0,i=0;r=h[t+8>>2],h[e+4>>2]=h[t+4>>2],h[e+8>>2]=r,h[e+20>>2]=h[t+20>>2],r=h[t+16>>2],h[e+12>>2]=h[t+12>>2],h[e+16>>2]=r;e:{t:{if((0|e)!=(0|t)){if(r=h[t+28>>2]){if(h[e+32>>2]<<5>>>0>=r>>>0)i=h[e+24>>2];else{if((i=h[e+24>>2])&&(ve(i),h[e+32>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,r=h[t+28>>2]),(0|r)<0)break t;i=mi((r=1+(r-1>>>5|0)|0)<<2),h[e+32>>2]=r,h[e+28>>2]=0,h[e+24>>2]=i,r=h[t+28>>2]}Et(i,h[t+24>>2],4+(r-1>>>3&536870908)|0),r=h[t+28>>2]}else r=0;if(h[e+28>>2]=r,r=h[t+40>>2]){if(h[e+44>>2]<<5>>>0>=r>>>0)i=h[e+36>>2];else{if((i=h[e+36>>2])&&(ve(i),h[e+44>>2]=0,h[e+36>>2]=0,h[e+40>>2]=0,r=h[t+40>>2]),(0|r)<0)break e;i=mi((r=1+(r-1>>>5|0)|0)<<2),h[e+44>>2]=r,h[e+40>>2]=0,h[e+36>>2]=i,r=h[t+40>>2]}Et(i,h[t+36>>2],4+(r-1>>>3&536870908)|0),t=h[t+40>>2]}else t=0;h[e+40>>2]=t}return}pn(),S()}pn(),S()}function gt(e,t){e|=0;var r,i,n=0,s=0,o=0,a=0,l=0,c=0,u=0,p=0;a=h[12+(t|=0)>>2],s=n=h[t+20>>2],n=(o=(r=h[t+16>>2])+4|0)>>>0<4?n+1|0:n,l=o;e:if(!((i=h[t+8>>2])>>>0<o>>>0&(0|n)>=(0|a)|(0|n)>(0|a))){if(p=h[t>>2],c=d[0|(o=r+p|0)]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+16>>2]=l,h[t+20>>2]=n,(o=f[t+38>>1])>>>0<=513){if(n=s,l=s=r+8|0,s>>>0>i>>>0&(0|(n=s>>>0<8?n+1|0:n))>=(0|a)|(0|n)>(0|a))break e;h[t+16>>2]=l,h[t+20>>2]=n}if(1&c&&!((s=31^y(c))-30>>>0<4294967267)){if(h[e+8>>2]=s+1,c=-2-(s=-2<<s)|0,h[e+16>>2]=c,h[e+12>>2]=-1^s,h[e+24>>2]=(0|c)/2,m[e+20>>2]=_(2)/_(0|c),o>>>0<=513){if((0|n)>=(0|a)&l>>>0>=i>>>0|(0|n)>(0|a))break e;a=d[l+p|0],n=(s=l+1|0)?n:n+1|0,h[t+16>>2]=s,h[t+20>>2]=n;t:switch(0|a){case 1:u=1;break;case 0:break t;default:break e}h[e+72>>2]=u}u=ze(e+96|0,t)}}return 0|u}function vt(e,t){e|=0;var r,i,n=0,s=0,o=0,a=0,l=0,c=0,u=0,p=0;a=h[12+(t|=0)>>2],l=n=h[t+20>>2],n=(s=(r=h[t+16>>2])+4|0)>>>0<4?n+1|0:n;e:if(!((i=h[t+8>>2])>>>0<s>>>0&(0|n)>=(0|a)|(0|n)>(0|a))&&(p=h[t>>2],o=d[0|(o=r+p|0)]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+16>>2]=s,h[t+20>>2]=n,n=l,c=s=r+8|0,!(s>>>0>i>>>0&(0|(n=s>>>0<8?n+1|0:n))>=(0|a)|(0|n)>(0|a))&&(h[t+16>>2]=c,h[t+20>>2]=n,1&o&&!((s=31^y(o))-30>>>0<4294967267)))){if(h[e+8>>2]=s+1,o=-2-(s=-2<<s)|0,h[e+16>>2]=o,h[e+12>>2]=-1^s,h[e+24>>2]=(0|o)/2,m[e+20>>2]=_(2)/_(0|o),f[t+38>>1]<=513){if((0|n)>=(0|a)&c>>>0>=i>>>0|(0|n)>(0|a))break e;a=d[c+p|0],l=(n=r+9|0)>>>0<9?l+1|0:l,h[t+16>>2]=n,h[t+20>>2]=l;t:switch(0|a){case 1:u=1;break;case 0:break t;default:break e}h[e+72>>2]=u}u=ze(e+96|0,t)}return 0|u}function _t(e){var t,r=0,i=0,n=0;if(h[(e|=0)>>2]=11412,t=h[e+368>>2],h[e+368>>2]=0,t){if(r=h[(n=t-4|0)>>2])for(i=(r<<4)+t|0;(0|t)!=(0|(i=i-16|0)););ve(n)}if(Cr(e+216|0),(r=h[e+196>>2])&&(h[e+200>>2]=r,ve(r)),(r=h[e+184>>2])&&(h[e+188>>2]=r,ve(r)),(r=h[e+172>>2])&&(h[e+176>>2]=r,ve(r)),(r=h[e+160>>2])&&(h[e+164>>2]=r,ve(r)),i=h[e+144>>2])for(;r=h[i>>2],ve(i),i=r,r;);return r=h[e+136>>2],h[e+136>>2]=0,r&&ve(r),(r=h[e+120>>2])&&ve(r),(r=h[e+108>>2])&&ve(r),(r=h[e+96>>2])&&ve(r),(r=h[e+72>>2])&&(h[e+76>>2]=r,ve(r)),(r=h[e+60>>2])&&ve(r),(r=h[e+48>>2])&&(h[e+52>>2]=r,ve(r)),(r=h[e+36>>2])&&(h[e+40>>2]=r,ve(r)),(r=h[e+24>>2])&&(h[e+28>>2]=r,ve(r)),(r=h[e+12>>2])&&(h[e+16>>2]=r,ve(r)),r=h[e+8>>2],h[e+8>>2]=0,r&&Lr(r),0|e}function bt(e){var t,r=0,i=0;r=h[e+8>>2],t=h[e>>2];e:{if(d[e+12|0]){t:{if(-1!=(0|r)&&-1!=(0|(r=((i=r+1|0)>>>0)%3|0?i:r-2|0))&&-1!=(0|(r=h[h[t+12>>2]+(r<<2)>>2]))){if(r=((i=r+1|0)>>>0)%3|0?i:r-2|0,h[e+8>>2]=r,-1!=(0|r))break t}else h[e+8>>2]=-1;r=-1;r:if(-1!=(0|(i=h[e+4>>2]))){if((i>>>0)%3|0)i=i-1|0;else if(r=-1,-1==(0|(i=i+2|0)))break r;r=-1,-1!=(0|(i=h[h[t+12>>2]+(i<<2)>>2]))&&(r=i-1|0,(i>>>0)%3|0||(r=i+2|0))}return s[e+12|0]=0,void(h[e+8>>2]=r)}if((0|r)!=h[e+4>>2])break e;return void(h[e+8>>2]=-1)}i=-1;t:if(-1!=(0|r)){if((r>>>0)%3|0)r=r-1|0;else if(i=-1,-1==(0|(r=r+2|0)))break t;i=-1,-1!=(0|(r=h[h[t+12>>2]+(r<<2)>>2]))&&(i=r-1|0,(r>>>0)%3|0||(i=r+2|0))}h[e+8>>2]=i}}function yt(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0;h[e+16>>2]=0,h[e+20>>2]=0,h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,h[e+24>>2]=0,l=(0|(s=h[t+4>>2]-h[t>>2]|0))/20|0;e:{t:{r:{if(s){if(l>>>0>=214748365)break r;i=mi(s),h[e+16>>2]=i,h[e+20>>2]=i,h[e+24>>2]=v(l,20)+i,r=h[t>>2],r=t=(0|(t=h[t+4>>2]-r|0))<=0?i:He(i,r,t)+v((t>>>0)/20|0,20)|0,h[e+20>>2]=r}if(h[e+28>>2]=0,!(t=r-i|0))break e;if(s=1&(r=(t=(0|t)/20|0)>>>0>1?t:1),t>>>0<2){t=0;break t}for(l=-2&r,t=0,r=0;o=v(1|t,20)+i|0,o=v(h[o+16>>2],h[o+12>>2]),a=v(t,20)+i|0,n=(n=n>>>0<(a=v(h[a+16>>2],h[a+12>>2]))>>>0?a:n)>>>0<o>>>0?o:n,t=t+2|0,(0|l)!=(0|(r=r+2|0)););break t}vn(),S()}s&&(t=v(t,20)+i|0,n=(t=v(h[t+16>>2],h[t+12>>2]))>>>0>n>>>0?t:n)}return sr(e,n),h[e+12>>2]=h[e>>2],e}function Et(e,t,r){var i=0,n=0;e:if((0|e)!=(0|t)){if(t-(n=e+r|0)>>>0<=0-(r<<1)>>>0)return He(e,t,r);if(i=3&(e^t),e>>>0<t>>>0){if(i)i=e;else{if(3&e)for(i=e;;){if(!r)break e;if(s[0|i]=d[0|t],t=t+1|0,r=r-1|0,!(3&(i=i+1|0)))break}else i=e;if(!(r>>>0<=3))for(;h[i>>2]=h[t>>2],t=t+4|0,i=i+4|0,(r=r-4|0)>>>0>3;);}if(r)for(;s[0|i]=d[0|t],i=i+1|0,t=t+1|0,r=r-1|0;);}else{if(!i){if(3&n)for(;;){if(!r)break e;if(s[0|(i=(r=r-1|0)+e|0)]=d[t+r|0],!(3&i))break}if(!(r>>>0<=3))for(;h[(r=r-4|0)+e>>2]=h[t+r>>2],r>>>0>3;);}if(!r)break e;for(;s[(r=r-1|0)+e|0]=d[t+r|0],r;);}}return e}function wt(e,t,r){var i,n,s=0,o=0,a=0,l=0,c=0,u=0,f=0,p=0;N=i=N-16|0;e:{if((0|(a=h[e+24>>2]))!=(0|(n=h[e+28>>2])))for(;;){h[i+8>>2]=0,h[i>>2]=0,h[i+4>>2]=0,s=Kr(h[a>>2],t,i),c=(e=d[i+11|0])<<24>>24,u=3;t:{r:{i:{n:if(s&&(u=0,o=(s=d[r+11|0])<<24>>24,(0|(f=(0|c)<0?h[i+4>>2]:e))==(0|((0|o)<0?h[r+4>>2]:s)))){l=(0|o)<0?h[r>>2]:r,o=h[i>>2];s:{if(!(s=(0|c)<0)){if(!c)break s;if(s=i,d[0|l]!=(255&o))break t;for(;;){if(!(e=e-1|0))break s;if(o=d[l+1|0],l=l+1|0,(0|o)!=d[0|(s=s+1|0)])break}break n}if(f&&Sr(s?o:i,l,f))break i}p=h[a>>2],u=1}if((0|c)>=0)break r}ve(h[i>>2])}switch(0|u){case 0:case 3:break t;default:break e}}if((0|n)==(0|(a=a+4|0)))break}p=0}return N=i+16|0,p}function xt(e,t,r){switch(t-9|0){case 0:return t=h[r>>2],h[r>>2]=t+4,void(h[e>>2]=h[t>>2]);case 6:return t=h[r>>2],h[r>>2]=t+4,t=u[t>>1],h[e>>2]=t,void(h[e+4>>2]=t>>31);case 7:return t=h[r>>2],h[r>>2]=t+4,h[e>>2]=f[t>>1],void(h[e+4>>2]=0);case 8:return t=h[r>>2],h[r>>2]=t+4,t=s[0|t],h[e>>2]=t,void(h[e+4>>2]=t>>31);case 9:return t=h[r>>2],h[r>>2]=t+4,h[e>>2]=d[0|t],void(h[e+4>>2]=0);case 16:return t=h[r>>2]+7&-8,h[r>>2]=t+8,void(g[e>>3]=g[t>>3]);case 17:Cn[0](e,r);default:return;case 1:case 4:case 14:return t=h[r>>2],h[r>>2]=t+4,t=h[t>>2],h[e>>2]=t,void(h[e+4>>2]=t>>31);case 2:case 5:case 11:case 15:return t=h[r>>2],h[r>>2]=t+4,h[e>>2]=h[t>>2],void(h[e+4>>2]=0);case 3:case 10:case 12:case 13:}t=h[r>>2]+7&-8,h[r>>2]=t+8,r=h[t+4>>2],h[e>>2]=h[t>>2],h[e+4>>2]=r}function At(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0;if((i=h[e+8>>2])-(r=h[e+4>>2])>>2>>>0>=t>>>0)return t&&(r=St(r,0,t<<=2)+t|0),void(h[e+4>>2]=r);e:{t:{r:{if((n=(s=r-(o=h[e>>2])>>2)+t|0)>>>0<1073741824){if(a=(i=i-o|0)>>1,n=i>>>0<2147483644?n>>>0>a>>>0?n:a:1073741823){if(n>>>0>=1073741824)break r;l=mi(n<<2)}if(s=(t=St(i=(s<<2)+l|0,0,s=t<<2))+s|0,n=(n<<2)+l|0,(0|r)==(0|o))break t;for(;t=h[(r=r-4|0)>>2],h[r>>2]=0,h[(i=i-4|0)>>2]=t,(0|r)!=(0|o););if(h[e+8>>2]=n,t=h[e+4>>2],h[e+4>>2]=s,r=h[e>>2],h[e>>2]=i,(0|t)==(0|r))break e;for(;e=h[(t=t-4|0)>>2],h[t>>2]=0,e&&Cn[h[h[e>>2]+4>>2]](e),(0|t)!=(0|r););break e}vn(),S()}Zr(1336),S()}h[e+8>>2]=n,h[e+4>>2]=s,h[e>>2]=t}r&&ve(r)}function Tt(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0;return h[e+16>>2]=0,r=h[e>>2],h[e+4>>2]=r,h[e+12>>2]=r,r=o=h[t+12>>2],i=h[t+20>>2],i=(n=(s=h[t+16>>2])+4|0)>>>0<4?i+1|0:i,(a=h[t+8>>2])>>>0<n>>>0&(0|r)<=(0|i)|(0|r)<(0|i)||(r=s+h[t>>2]|0,r=d[0|r]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[t+16>>2]=n,h[t+20>>2]=i,!r|3&r||a-n>>>0<r>>>0&(0|(s=o-(i+(n>>>0>a>>>0)|0)|0))<=0|(0|s)<0||(r>>>0>=4&&(er(e,r>>>2|0),a=h[t+8>>2],o=h[t+12>>2],n=h[t+16>>2],i=h[t+20>>2]),(s=r+n|0)>>>0>a>>>0&(0|(i=r>>>0>s>>>0?i+1|0:i))>=(0|o)|(0|i)>(0|o)||(He(h[e>>2],n+h[t>>2]|0,r),i=h[t+20>>2],i=(n=r+h[t+16>>2]|0)>>>0<r>>>0?i+1|0:i,h[t+16>>2]=n,h[t+20>>2]=i,h[e+16>>2]=0,h[e+12>>2]=h[e>>2],l=1))),l}function St(e,t,r){var i=0,n=0,o=0;if(r&&(s[0|e]=t,s[(n=e+r|0)-1|0]=t,!(r>>>0<3||(s[e+2|0]=t,s[e+1|0]=t,s[n-3|0]=t,s[n-2|0]=t,r>>>0<7||(s[e+3|0]=t,s[n-4|0]=t,r>>>0<9||(o=(n=0-e&3)+e|0,i=v(255&t,16843009),h[o>>2]=i,h[(r=(t=r-n&-4)+o|0)-4>>2]=i,t>>>0<9||(h[o+8>>2]=i,h[o+4>>2]=i,h[r-8>>2]=i,h[r-12>>2]=i,t>>>0<25||(h[o+24>>2]=i,h[o+20>>2]=i,h[o+16>>2]=i,h[o+12>>2]=i,h[r-16>>2]=i,h[r-20>>2]=i,h[r-24>>2]=i,h[r-28>>2]=i,(r=(r=t)-(t=4&o|24)|0)>>>0<32))))))))for(i=qr(i,0,1,1),n=G,t=t+o|0;h[t+24>>2]=i,h[t+28>>2]=n,h[t+16>>2]=i,h[t+20>>2]=n,h[t+8>>2]=i,h[t+12>>2]=n,h[t>>2]=i,h[t+4>>2]=n,t=t+32|0,(r=r-32|0)>>>0>31;);return e}function Mt(e,t){var r=0,i=0,n=0,s=0,o=0;i=-1,s=-1,n=-1;e:{t:if(-1!=(0|t)){if(o=1,s=h[h[h[e+4>>2]+12>>2]+(t<<2)>>2],(0|(r=((r=t+1|0)>>>0)%3|0?r:t-2|0))>=0&&(n=(r>>>0)/3|0,n=h[(h[h[e>>2]+96>>2]+v(n,12)|0)+(r-v(n,3)<<2)>>2]),-1!=(0|s)&&(o=0,(0|(r=((s>>>0)%3|0?-1:2)+s|0))<0||(i=(r>>>0)/3|0,i=h[(h[h[e>>2]+96>>2]+v(i,12)|0)+(r-v(i,3)<<2)>>2])),r=-1,(0|i)!=(0|n))break e;if(n=-1,(0|(t=((t>>>0)%3|0?-1:2)+t|0))>=0){if(i=(t>>>0)/3|0,i=h[(h[h[e>>2]+96>>2]+v(i,12)|0)+(t-v(i,3)<<2)>>2],o)break t}else if(i=-1,o)break t;(0|(t=((t=s+1|0)>>>0)%3|0?t:s-2|0))<0||(r=h[h[e>>2]+96>>2],n=h[(r+v(e=(t>>>0)/3|0,12)|0)+(t-v(e,3)<<2)>>2])}r=(0|i)==(0|n)?s:-1}return r}function Ct(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;if(i=h[(n=e+16|0)>>2]){for(o=h[t>>2],t=n;t=(s=(0|o)>h[i+16>>2])?t:i,i=h[(s<<2)+i>>2];);if(!((0|t)==(0|n)|(0|o)<h[t+16>>2])&&(i=h[t+24>>2]))for(o=(s=(n=d[r+11|0])<<24>>24<0)?h[r>>2]:r,n=s?h[r+4>>2]:n,s=t+20|0;;){e:{t:{r:{if(c=(u=(t=(a=(t=d[i+27|0])<<24>>24<0)?h[i+20>>2]:t)>>>0<n>>>0)?t:n){l=i+16|0;i:{if(!(l=Sr(o,a=a?h[l>>2]:l,c))){if(t>>>0<=n>>>0)break i;break e}if((0|l)<0)break e}if(!(t=Sr(a,o,c)))break r;if((0|t)<0)break t;return ir(s,r)}if(t>>>0>n>>>0)break e}if(!u)return ir(s,r)}i=i+4|0}if(!(i=h[i>>2]))break}}return ir(e,r)}function Rt(e,t,r){var i,n=0,s=0,o=0;N=i=N-16|0,h[e+4>>2]=0;e:{t:if(t){if((n=(o=h[e+8>>2])<<5)>>>0>=t>>>0)h[e+4>>2]=t;else{if(h[i+8>>2]=0,h[i>>2]=0,h[i+4>>2]=0,(0|t)<0)break e;Se(i,n=n>>>0<=1073741822?(n=o<<6)>>>0<(s=t+31&-32)>>>0?s:n:2147483647),s=h[e>>2],h[e>>2]=h[i>>2],h[i>>2]=s,n=h[e+4>>2],h[e+4>>2]=t,h[i+4>>2]=n,n=h[e+8>>2],h[e+8>>2]=h[i+8>>2],h[i+8>>2]=n,s&&ve(s)}if(n=(s=t>>>5|0)<<2,e=h[e>>2],d[0|r]){if(e=St(e,255,n),!(t&=31))break t;h[(e=e+(s<<2)|0)>>2]=h[e>>2]|-1>>>32-t}else e=St(e,0,n),(t&=31)&&(h[(e=e+(s<<2)|0)>>2]=h[e>>2]&(-1>>>32-t^-1))}return void(N=i+16|0)}pn(),S()}function It(e,t){var r=0,i=0,n=0,s=0,o=0,a=0;if((i=h[e+4>>2])>>>0<(n=h[e+8>>2])>>>0)return h[i>>2]=h[t>>2],h[i+4>>2]=h[t+4>>2],h[i+8>>2]=h[t+8>>2],void(h[e+4>>2]=i+12);e:{if((r=1+(o=(i-(s=h[e>>2])|0)/12|0)|0)>>>0<357913942){if(a=(n=(n-s|0)/12|0)<<1,(r=n>>>0<178956970?r>>>0>a>>>0?r:a:357913941)>>>0>=357913942)break e;if(a=v(o,12),o=mi(n=v(r,12)),h[(r=a+o|0)>>2]=h[t>>2],h[r+4>>2]=h[t+4>>2],h[r+8>>2]=h[t+8>>2],t=r+12|0,(0|i)!=(0|s))for(;i=i-12|0,h[(r=r-12|0)>>2]=h[i>>2],h[r+4>>2]=h[i+4>>2],h[r+8>>2]=h[i+8>>2],(0|i)!=(0|s););return h[e+8>>2]=n+o,h[e+4>>2]=t,h[e>>2]=r,void(s&&ve(s))}vn(),S()}Zr(1336),S()}function Ot(e,t,r){var i,n=0,s=0,o=0,a=0;if((i=(o=r-t|0)>>2)>>>0<=(n=h[e+8>>2])-(s=h[e>>2])>>2>>>0){if((0|(n=i>>>0>(a=(n=(o=h[e+4>>2])-s|0)>>2)>>>0?t+n|0:r))!=(0|t))for(;h[s>>2]=h[t>>2],s=s+4|0,(0|n)!=(0|(t=t+4|0)););return i>>>0>a>>>0?((0|(t=r-n|0))>0&&(o=He(o,n,t)+t|0),void(h[e+4>>2]=o)):void(h[e+4>>2]=s)}if(s&&(h[e+4>>2]=s,ve(s),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,n=0),!((0|o)<0||(r=n>>1,(r=n>>>0<2147483644?r>>>0<i>>>0?i:r:1073741823)>>>0>=1073741824)))return r=mi(s=r<<2),h[e>>2]=r,h[e+4>>2]=r,h[e+8>>2]=r+s,o&&(r=He(r,t,o)+o|0),void(h[e+4>>2]=r);vn(),S()}function Pt(e){var t=0,r=0,i=0,n=0;r=1;e:if(!((0|(i=h[e+140>>2]))<=0)){for(t=i<<4,r=mi((0|i)!=(268435455&i)?-1:4|t),h[r>>2]=i,i=(r=r+4|0)+t|0,t=r;h[t>>2]=0,h[t+4>>2]=0,s[t+5|0]=0,s[t+6|0]=0,s[t+7|0]=0,s[t+8|0]=0,s[t+9|0]=0,s[t+10|0]=0,s[t+11|0]=0,s[t+12|0]=0,(0|i)!=(0|(t=t+16|0)););if(n=h[e+136>>2],h[e+136>>2]=r,n){if(r=h[(i=n-4|0)>>2])for(t=(r<<4)+n|0;(0|n)!=(0|(t=t-16|0)););ve(i)}if(r=1,!(h[e+140>>2]<=0))for(t=0;;){if(!(r=ze(h[e+136>>2]+(t<<4)|0,e)))break e;if(!((0|(t=t+1|0))<h[e+140>>2]))break}}return r}function kt(e,t){var r,i=0,n=0,o=0,a=0;return h[e+64>>2]||(i=mi(32),h[i+16>>2]=0,h[i+20>>2]=0,h[i+8>>2]=0,h[i>>2]=0,h[i+4>>2]=0,h[i+24>>2]=0,h[i+28>>2]=0,n=h[e+64>>2],h[e+64>>2]=i,n&&((i=h[n>>2])&&(h[n+4>>2]=i,ve(i)),ve(n))),o=h[e+64>>2],n=(i=h[e+28>>2]-1|0)>>>0<=10?h[13616+(i<<2)>>2]:-1,n=i=v(n,s[e+24|0]),(o=jr(o,0,qr(i,r=i>>31,t,0),G))&&(i=h[e+64>>2],h[e>>2]=i,a=h[i+20>>2],h[e+8>>2]=h[i+16>>2],h[e+12>>2]=a,a=h[i+24>>2],i=h[i+28>>2],h[e+48>>2]=0,h[e+52>>2]=0,h[e+40>>2]=n,h[e+44>>2]=r,h[e+16>>2]=a,h[e+20>>2]=i,h[e+80>>2]=t),o}function Lt(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0;s=e+4|0;e:{if(e=h[e+4>>2])for(l=(i=(n=d[r+11|0])<<24>>24<0)?h[r>>2]:r,n=i?h[r+4>>2]:n;;){t:{r:{i:{n:{s:{o:if(a=(c=(r=(i=(r=d[e+27|0])<<24>>24<0)?h[e+20>>2]:r)>>>0<n>>>0)?r:n){if(o=e+16|0,!(o=Sr(l,i=i?h[o>>2]:o,a))){if(r>>>0>n>>>0)break o;break s}if((0|o)>=0)break s}else if(r>>>0<=n>>>0)break n;if(r=h[e>>2])break t;return h[t>>2]=e,e}if(r=Sr(i,l,a))break i}if(c)break r;break e}if((0|r)>=0)break e}if(s=e+4|0,!(r=h[e+4>>2]))break e;e=s}s=e,e=r}return h[t>>2]=s,s}return h[t>>2]=e,s}function Nt(e,t){var r=0;return r=h[t+4>>2],h[e>>2]=h[t>>2],h[e+4>>2]=r,r=h[t+60>>2],h[e+56>>2]=h[t+56>>2],h[e+60>>2]=r,r=h[t+52>>2],h[e+48>>2]=h[t+48>>2],h[e+52>>2]=r,r=h[t+44>>2],h[e+40>>2]=h[t+40>>2],h[e+44>>2]=r,r=h[t+36>>2],h[e+32>>2]=h[t+32>>2],h[e+36>>2]=r,r=h[t+28>>2],h[e+24>>2]=h[t+24>>2],h[e+28>>2]=r,r=h[t+20>>2],h[e+16>>2]=h[t+16>>2],h[e+20>>2]=r,r=h[t+12>>2],h[e+8>>2]=h[t+8>>2],h[e+12>>2]=r,h[e+88>>2]=0,h[e+64>>2]=0,h[e+68>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,s[e+77|0]=0,s[e+78|0]=0,s[e+79|0]=0,s[e+80|0]=0,s[e+81|0]=0,s[e+82|0]=0,s[e+83|0]=0,s[e+84|0]=0,e}function Gt(e,t){var r,i=0,n=0,s=0,o=0,a=0,l=0,c=0;r=e+4|0;e:{t:if(e=h[e+4>>2]){for(l=(i=(n=d[t+11|0])<<24>>24<0)?h[t>>2]:t,s=i?h[t+4>>2]:n,i=r;(n=(o=(a=(c=(t=d[e+27|0])<<24>>24<0)?h[e+20>>2]:t)>>>0>s>>>0)?s:a)&&(t=e+16|0,t=Sr(c?h[t>>2]:t,l,n))||(t=s>>>0>a>>>0?-1:o),i=(0|t)<0?i:e,e=h[(t>>>29&4)+e>>2];);if((0|i)!=(0|r)){if(!((t=(n=(o=(e=d[i+27|0])<<24>>24<0)?h[i+20>>2]:e)>>>0<s>>>0?n:s)&&(e=i+16|0,e=Sr(l,o?h[e>>2]:e,t)))){if(n>>>0>s>>>0)break t;break e}if((0|e)>=0)break e}}i=r}return i}function Dt(e,t,r){var i=0,n=0,o=0,a=0;e:{if(t)if(f[e+38>>1]<=513){if(n=h[e+12>>2],t=h[e+20>>2],t=(a=(o=h[e+16>>2])+8|0)>>>0<8?t+1|0:t,a>>>0>p[e+8>>2]&(0|t)>=(0|n)|(0|t)>(0|n))break e;t=o+h[e>>2]|0,i=d[t+4|0]|d[t+5|0]<<8|d[t+6|0]<<16|d[t+7|0]<<24,h[r>>2]=d[0|t]|d[t+1|0]<<8|d[t+2|0]<<16|d[t+3|0]<<24,h[r+4>>2]=i,t=h[e+20>>2],t=(r=h[e+16>>2]+8|0)>>>0<8?t+1|0:t,h[e+16>>2]=r,h[e+20>>2]=t}else if(!ur(1,r,e))break e;s[e+36|0]=1,h[e+32>>2]=0,r=(t=h[e+16>>2])+h[e>>2]|0,h[e+24>>2]=r,i=e,e=h[e+8>>2],h[i+28>>2]=r+(e-t|0),i=1}return i}function Ut(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0;h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0;e:{t:{if(t){if(t>>>0>=357913942)break t;if(t=mi(i=v(t,12)),h[e>>2]=t,h[e+4>>2]=t,n=t+i|0,h[e+8>>2]=n,s=h[r>>2],r=h[r+4>>2]-s|0){if((0|r)<0)break e;for(o=r>>2<<2,a=r>>>2<<2;h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,i=mi(r),h[t>>2]=i,h[t+4>>2]=i,h[t+8>>2]=i+o,l=t,c=He(i,s,r)+a|0,h[l+4>>2]=c,(0|n)!=(0|(t=t+12|0)););}else St(r=t,0,12+((t=i-12|0)-((t>>>0)%12|0)|0)|0);h[e+4>>2]=n}return}vn(),S()}h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,vn(),S()}function Vt(e,t){e|=0,t|=0;var r=0,i=0,n=0,s=0,o=0,a=0;s=mi(64),r=mi(12),h[r+8>>2]=h[h[e+4>>2]+80>>2],h[r>>2]=13248,h[r+4>>2]=0,s=Fr(s,r);e:{if((0|t)<0)r=s;else{if(a=e+8|0,!((0|(o=(r=h[e+12>>2])-(n=h[e+8>>2])>>2))>(0|t)))if(i=t+1|0,t>>>0>=o>>>0)At(a,i-o|0);else if(!(i>>>0>=o>>>0)){if((0|(n=n+(i<<2)|0))!=(0|r))for(;i=h[(r=r-4|0)>>2],h[r>>2]=0,i&&Cn[h[h[i>>2]+4>>2]](i),(0|r)!=(0|n););h[e+12>>2]=n}if(e=h[a>>2]+(t<<2)|0,r=h[e>>2],h[e>>2]=s,!r)break e}Cn[h[h[r>>2]+4>>2]](r)}return(-1^t)>>>31|0}function Bt(e,t){var r,i,n=0;if(N=i=N-16|0,h[i+12>>2]=t,N=r=N-208|0,h[r+204>>2]=t,St(t=r+160|0,0,40),h[r+200>>2]=h[r+204>>2],!((0|X(0,e,r+200|0,r+80|0,t))<0)){h[3885],t=h[3866],h[3884]<=0&&(h[3866]=-33&t);e:{t:{if(h[3878]){if(h[3870])break t}else h[3878]=80,h[3873]=0,h[3870]=0,h[3871]=0,n=h[3877],h[3877]=r;if(ei(15464))break e}X(15464,e,r+200|0,r+80|0,r+160|0)}n&&(Cn[h[3875]](15464,0,0),h[3878]=0,h[3877]=n,h[3873]=0,h[3870]=0,h[3871]=0),h[3866]=h[3866]|32&t}N=r+208|0,N=i+16|0}function Ft(e,t,r){var i,n=0,s=0,o=0,a=0;return(i=(o=r-t|0)>>2)>>>0<=(n=h[e+8>>2])-(s=h[e>>2])>>2>>>0?((a=(n=(o=(n=h[e+4>>2]-s|0)>>2)>>>0<i>>>0?t+n|0:r)-t|0)&&Et(s,t,a),o>>>0<i>>>0?(t=h[e+4>>2],(0|(r=r-n|0))>0&&(t=He(t,n,r)+r|0),void(h[e+4>>2]=t)):void(h[e+4>>2]=s+a)):(s&&(h[e+4>>2]=s,ve(s),h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,n=0),(0|o)<0||(r=n>>1,(r=n>>>0<2147483644?r>>>0<i>>>0?i:r:1073741823)>>>0>=1073741824)?(vn(),void S()):(r=mi(s=r<<2),h[e>>2]=r,h[e+4>>2]=r,h[e+8>>2]=r+s,o&&(r=He(r,t,o)+o|0),void(h[e+4>>2]=r)))}function jt(e,t,r){var i=0,n=0,s=0,o=0;e:{if((t|r)>=0){if(!(t>>>0>1431655765)){if(je(e,i=v(t,3),13680),je(e+12|0,i,13684),i=h[e+24>>2],!(h[e+32>>2]-i>>2>>>0>=r>>>0)){if(r>>>0>=1073741824)break e;n=h[e+28>>2],s=(r=mi(s=r<<2))+s|0,o=(n=n-i|0)+r|0,(0|n)>0&&He(r,i,n),h[e+32>>2]=s,h[e+28>>2]=o,h[e+24>>2]=r,i&&ve(i)}h[e+80>>2]=0,h[e+84>>2]=0,r=h[e+76>>2],h[e+76>>2]=0,r&&ve(r),h[e+68>>2]=0,h[e+72>>2]=0,e=h[(r=e- -64|0)>>2],h[r>>2]=0,e&&ve(e)}e=t>>>0<1431655766}else e=0;return e}Zr(1336),S()}function zt(e){var t=0,r=0,i=0,n=0,o=0;if(i=h[e+8>>2],!d[i+84|0]&&!(!(t=h[e+16>>2])|!d[t+84|0]||(r=h[i+72>>2],n=h[i+68>>2],s[t+84|0]=0,r=r-n>>2,o=h[t+68>>2],r>>>0>(n=h[t+72>>2]-o>>2)>>>0?($e(t+68|0,r-n|0,2344),i=h[e+8>>2]):r>>>0>=n>>>0||(h[t+72>>2]=o+(r<<2)),(t=d[i+84|0])||(0|(r=h[i+68>>2]))==h[i+72>>2])))if(n=h[h[e+16>>2]+68>>2],t)h[n>>2]=0;else for(t=0;h[(o=t<<2)+n>>2]=h[r+o>>2],t=t+1|0,r=h[i+68>>2],t>>>0<h[i+72>>2]-r>>2>>>0;);return h[e+16>>2]}function Wt(e,t){t|=0;var r=0,i=0,n=0,s=0;e:if((0|(r=h[216+(e|=0)>>2]))!=h[e+220>>2]){for(;;){t:if(!((0|(r=h[v(n,144)+r>>2]))<0||(i=h[e+4>>2],s=h[i+8>>2],(0|r)>=h[i+12>>2]-s>>2||(i=0,r=h[(r<<2)+s>>2],(0|Cn[h[h[r>>2]+24>>2]](r))<=0)))){for(;;){if((0|Cn[h[h[r>>2]+20>>2]](r,i))!=(0|t)){if(i=i+1|0,(0|Cn[h[h[r>>2]+24>>2]](r))>(0|i))continue;break t}break}e=h[e+216>>2]+v(n,144)|0,n=d[e+100|0]?e+4|0:0;break e}if(n=n+1|0,r=h[e+216>>2],!(n>>>0<(h[e+220>>2]-r|0)/144>>>0))break}return 0}return 0|n}function Ht(e,t){var r=0,i=0,n=0,s=0,o=0,a=0;if((0|(r=h[e+4>>2]))!=h[e+8>>2])return i=h[t+4>>2],h[r>>2]=h[t>>2],h[r+4>>2]=i,h[r+8>>2]=h[t+8>>2],void(h[e+4>>2]=r+12);e:{if((r=1+(i=(0|(o=r-(s=h[e>>2])|0))/12|0)|0)>>>0<357913942){if(n=i<<1,n=i>>>0<178956970?r>>>0>n>>>0?r:n:357913941){if(n>>>0>=357913942)break e;r=mi(v(n,12))}else r=0;return i=r+v(i,12)|0,a=h[t+4>>2],h[i>>2]=h[t>>2],h[i+4>>2]=a,h[i+8>>2]=h[t+8>>2],t=i+v((0|o)/-12|0,12)|0,(0|o)>0&&He(t,s,o),h[e+8>>2]=r+v(n,12),h[e+4>>2]=i+12,h[e>>2]=t,void(s&&ve(s))}vn(),S()}Zr(1336),S()}function $t(e){var t=0,r=0,i=0;if(h[(e|=0)>>2]=2156,t=h[e+60>>2]){if((0|t)==(0|(r=h[e- -64>>2])))r=t;else{for(;i=h[(r=r-4|0)>>2],h[r>>2]=0,i&&Wr(i),(0|t)!=(0|r););r=h[e+60>>2]}h[e+64>>2]=t,ve(r)}if((t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),t=h[e+36>>2]){if((0|t)==(0|(r=h[e+40>>2])))r=t;else{for(;Cn[h[h[(r=r-24|0)>>2]>>2]](r),(0|t)!=(0|r););r=h[e+36>>2]}h[e+40>>2]=t,ve(r)}return h[e>>2]=2012,(t=h[e+16>>2])&&(h[e+20>>2]=t,ve(t)),(t=h[e+4>>2])&&(h[e+8>>2]=t,ve(t)),0|e}function Yt(e){var t=0,r=0,i=0,n=0;if(r=h[e+132>>2]){if((0|r)==(0|(t=h[e+136>>2])))t=r;else{for(;(i=h[(n=t-12|0)>>2])&&(h[t-8>>2]=i,ve(i)),(0|r)!=(0|(t=n)););t=h[e+132>>2]}h[e+136>>2]=r,ve(t)}if(r=h[e+120>>2]){if((0|r)==(0|(t=h[e+124>>2])))t=r;else{for(;(i=h[(n=t-12|0)>>2])&&(h[t-8>>2]=i,ve(i)),(0|r)!=(0|(t=n)););t=h[e+120>>2]}h[e+124>>2]=r,ve(t)}(t=h[e+108>>2])&&(h[e+112>>2]=t,ve(t)),(t=h[e+96>>2])&&(h[e+100>>2]=t,ve(t)),Ci(e+76|0),Ci(e+56|0),Ci(e+36|0),Ci(e+16|0)}function qt(e,t,r,i,n,o,a){var l,c=0,u=0;if(N=l=N-16|0,(-1^t)-17>>>0>=r>>>0)return u=d[e+11|0]>>>7|0?h[e>>2]:e,t>>>0<2147483623?(h[l+8>>2]=t<<1,h[l+12>>2]=t+r,N=r=N-16|0,N=r+16|0,r=l+8|0,r=(r=h[(p[(c=l+12|0)>>2]<p[r>>2]?r:c)>>2])>>>0>=11?11==(0|(r=(c=r+16&-16)-1|0))?c:r:10):r=-18,r=mi(c=r+1|0),o&&rn(r,a,o),(i=i-n|0)&&rn(r+o|0,n+u|0,i),10!=(0|t)&&ve(u),h[e>>2]=r,h[e+8>>2]=-2147483648|c,t=e,e=i+o|0,h[t+4>>2]=e,s[l+7|0]=0,s[e+r|0]=d[l+7|0],void(N=l+16|0);mn(),S()}function Xt(e){var t=0,r=0,i=0,n=0;if(r=h[e+640>>2]){if((0|r)==(0|(t=h[e+644>>2])))t=r;else{for(;(i=h[(n=t-12|0)>>2])&&(h[t-8>>2]=i,ve(i)),(0|r)!=(0|(t=n)););t=h[e+640>>2]}h[e+644>>2]=r,ve(t)}if(r=h[e+628>>2]){if((0|r)==(0|(t=h[e+632>>2])))t=r;else{for(;(i=h[(n=t-12|0)>>2])&&(h[t-8>>2]=i,ve(i)),(0|r)!=(0|(t=n)););t=h[e+628>>2]}h[e+632>>2]=r,ve(t)}(t=h[e+616>>2])&&(h[e+620>>2]=t,ve(t)),(t=h[e+604>>2])&&(h[e+608>>2]=t,ve(t)),Ci(e+584|0),Ci(e+564|0),Ci(e+544|0)}function Zt(e){var t=0,r=0,i=0,n=0;if(r=h[e+128>>2]){if((0|r)==(0|(t=h[e+132>>2])))t=r;else{for(;(i=h[(n=t-12|0)>>2])&&(h[t-8>>2]=i,ve(i)),(0|r)!=(0|(t=n)););t=h[e+128>>2]}h[e+132>>2]=r,ve(t)}if(r=h[e+116>>2]){if((0|r)==(0|(t=h[e+120>>2])))t=r;else{for(;(i=h[(n=t-12|0)>>2])&&(h[t-8>>2]=i,ve(i)),(0|r)!=(0|(t=n)););t=h[e+116>>2]}h[e+120>>2]=r,ve(t)}(t=h[e+104>>2])&&(h[e+108>>2]=t,ve(t)),(t=h[e+92>>2])&&(h[e+96>>2]=t,ve(t)),Ci(e+72|0),Ci(e+52|0),Ci(e+32|0)}function Jt(e,t){t|=0;var r=0,i=0,n=0,s=0;if((0|(r=h[216+(e|=0)>>2]))!=h[e+220>>2])for(;;){e:if(!((0|(r=h[v(n,144)+r>>2]))<0||(i=h[e+4>>2],s=h[i+8>>2],(0|r)>=h[i+12>>2]-s>>2||(i=0,r=h[(r<<2)+s>>2],(0|Cn[h[h[r>>2]+24>>2]](r))<=0)))){for(;;){if((0|Cn[h[h[r>>2]+20>>2]](r,i))!=(0|t)){if(i=i+1|0,(0|Cn[h[h[r>>2]+24>>2]](r))>(0|i))continue;break e}break}return 104+(h[e+216>>2]+v(n,144)|0)|0}if(n=n+1|0,r=h[e+216>>2],!(n>>>0<(h[e+220>>2]-r|0)/144>>>0))break}return e+184|0}function Kt(e,t){if(!e)return 0;e:{t:{if(e){if(t>>>0<=127)break t;if(h[h[4227]>>2]){if(t>>>0<=2047){s[e+1|0]=63&t|128,s[0|e]=t>>>6|192,e=2;break e}if(!(57344!=(-8192&t)&t>>>0>=55296)){s[e+2|0]=63&t|128,s[0|e]=t>>>12|224,s[e+1|0]=t>>>6&63|128,e=3;break e}if(t-65536>>>0<=1048575){s[e+3|0]=63&t|128,s[0|e]=t>>>18|240,s[e+2|0]=t>>>6&63|128,s[e+1|0]=t>>>12&63|128,e=4;break e}}else if(57216==(-128&t))break t;h[4190]=25,e=-1}else e=1;break e}s[0|e]=t,e=1}return e}function Qt(e){var t,r=0,i=0;if(h[(e|=0)>>2]=13756,(r=h[e+68>>2])&&(h[e+72>>2]=r,ve(r)),(r=h[e+56>>2])&&(h[e+60>>2]=r,ve(r)),(r=h[e+44>>2])&&(h[e+48>>2]=r,ve(r)),(r=h[e+32>>2])&&(h[e+36>>2]=r,ve(r)),(r=h[e+20>>2])&&(h[e+24>>2]=r,ve(r)),t=h[e+8>>2]){if((0|(i=h[e+12>>2]))==(0|t))r=t;else{for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Wr(r),(0|t)!=(0|i););r=h[e+8>>2]}h[e+12>>2]=t,ve(r)}return r=h[e+4>>2],h[e+4>>2]=0,r&&Mr(r),0|e}function er(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0;if((n=h[e+8>>2])-(r=h[e+4>>2])>>2>>>0>=t>>>0)return t&&(r=St(r,0,t<<=2)+t|0),void(h[e+4>>2]=r);e:{if((i=(a=(o=r-(s=h[e>>2])|0)>>2)+t|0)>>>0<1073741824){if(r=0,l=(n=n-s|0)>>1,i=n>>>0<2147483644?i>>>0>l>>>0?i:l:1073741823){if(i>>>0>=1073741824)break e;r=mi(i<<2)}return t=St((a<<2)+r|0,0,t<<=2)+t|0,(0|o)>0&&He(r,s,o),h[e+8>>2]=(i<<2)+r,h[e+4>>2]=t,h[e>>2]=r,void(s&&ve(s))}vn(),S()}Zr(1336),S()}function tr(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0;if((n=h[e+8>>2])-(r=h[e+4>>2])>>3>>>0>=t>>>0)return t&&(r=St(r,0,t<<=3)+t|0),void(h[e+4>>2]=r);e:{if((i=(a=(o=r-(s=h[e>>2])|0)>>3)+t|0)>>>0<536870912){if(r=0,l=(n=n-s|0)>>2,i=n>>>0<2147483640?i>>>0>l>>>0?i:l:536870911){if(i>>>0>=536870912)break e;r=mi(i<<3)}return t=St((a<<3)+r|0,0,t<<=3)+t|0,(0|o)>0&&He(r,s,o),h[e+8>>2]=(i<<3)+r,h[e+4>>2]=t,h[e>>2]=r,void(s&&ve(s))}vn(),S()}Zr(1336),S()}function rr(e,t){var r,i=0,n=0,s=0,o=0,a=0;if(r=h[e>>2],(e=h[r+4>>2])>>>0<(i=h[r+8>>2])>>>0)return h[e>>2]=h[t>>2],void(h[r+4>>2]=e+4);e:{if((e=1+(n=(o=e-(s=h[r>>2])|0)>>2)|0)>>>0<1073741824){if(a=n<<2,n=(i=i-s|0)>>1,i=i>>>0<2147483644?e>>>0>n>>>0?e:n:1073741823){if(i>>>0>=1073741824)break e;e=mi(i<<2)}else e=0;return h[(n=a+e|0)>>2]=h[t>>2],(0|o)>0&&He(e,s,o),h[r+8>>2]=e+(i<<2),h[r+4>>2]=n+4,h[r>>2]=e,void(s&&ve(s))}vn(),S()}Zr(1336),S()}function ir(e,t){var r=0,i=0,n=0,o=0;if((0|(r=e+4|0))!=(0|(e=Gt(e,t)))){for(t=s[e+39|0]<0?h[e+28>>2]:e+28|0;t=(e=t)+1|0,32==(0|(r=s[0|e]))|r-9>>>0<5;);e:{t:{r:switch((r=s[0|e])-43|0){case 0:break t;case 2:break r;default:break e}n=1}r=s[0|t],e=t}if(r-48>>>0<10)for(;i=48+(v(i,10)-s[0|e]|0)|0,t=s[e+1|0],e=e+1|0,t-48>>>0<10;);-1!=(0|(e=n?i:0-i|0))&&(o=0!=(0|e))}return o}function nr(e,t){var r=0,i=0,n=0,s=0,o=0,a=0;if((n=h[e+8>>2])-(r=h[e+4>>2])>>1>>>0>=t>>>0)return t&&(r=St(r,0,t<<=1)+t|0),void(h[e+4>>2]=r);e:{if((0|(i=(a=(o=r-(s=h[e>>2])|0)>>1)+t|0))>=0){if(r=0,i=(n=n-s|0)>>>0<2147483646?i>>>0>n>>>0?i:n:2147483647){if((0|i)<0)break e;r=mi(i<<1)}return t=St((a<<1)+r|0,0,t<<=1)+t|0,(0|o)>0&&He(r,s,o),h[e+8>>2]=(i<<1)+r,h[e+4>>2]=t,h[e>>2]=r,void(s&&ve(s))}vn(),S()}Zr(1336),S()}function sr(e,t){var r=0,i=0,n=0,s=0,o=0;e:{t:{if((s=(r=h[e+4>>2])-(n=h[e>>2])|0)>>>0<t>>>0){if((o=t-s|0)>>>0<=(i=h[e+8>>2])-r>>>0)return o&&(r=St(r,0,o)+o|0),void(h[e+4>>2]=r);if((0|t)<0)break e;if(i=(r=i-n|0)<<1,St((r=mi(i=r>>>0<1073741823?t>>>0>i>>>0?t:i:2147483647))+s|0,0,o),(0|s)>0&&He(r,n,s),h[e+8>>2]=r+i,h[e+4>>2]=t+r,h[e>>2]=r,!n)break t;return void ve(n)}t>>>0>=s>>>0||(h[e+4>>2]=t+n)}return}vn(),S()}function or(e){var t=0,r=0,i=0,n=0,s=0;if((0|(t=h[e+4>>2]))!=h[e+8>>2])return h[t>>2]=h[2863],void(h[e+4>>2]=t+4);e:{if((t=1+(n=(i=t-(s=h[e>>2])|0)>>2)|0)>>>0<1073741824){if(r=i>>1,r=i>>>0<2147483644?t>>>0>r>>>0?t:r:1073741823){if(r>>>0>=1073741824)break e;t=mi(r<<2)}else t=0;return h[(n=t+(n<<2)|0)>>2]=h[2863],(0|i)>0&&He(t,s,i),h[e+8>>2]=t+(r<<2),h[e+4>>2]=n+4,h[e>>2]=t,void(s&&ve(s))}vn(),S()}Zr(1336),S()}function ar(e,t){var r=0,i=0,n=0,s=0;i=h[e+12>>2],(r=h[e+16>>2]-i>>2)>>>0<t>>>0?er(e+12|0,t-r|0):t>>>0>=r>>>0||(h[e+16>>2]=i+(t<<2));e:{if(r=h[e>>2],!(h[e+8>>2]-r>>2>>>0>=t>>>0)){if(t>>>0>=1073741824)break e;i=h[e+4>>2],n=(t=mi(n=t<<2))+n|0,s=(i=i-r|0)+t|0,(0|i)>0&&He(t,r,i),h[e+8>>2]=n,h[e+4>>2]=s,h[e>>2]=t,r&&ve(r)}return}Zr(1336),S()}function lr(e,t,r){var i=0,n=0,s=0;e:{if(!(i=h[r+16>>2])){if(ei(r))break e;i=h[r+16>>2]}if(i-(s=h[r+20>>2])>>>0<t>>>0)return 0|Cn[h[r+36>>2]](r,e,t);t:if(h[r+80>>2]<0)i=0;else{for(n=t;;){if(!(i=n)){i=0;break t}if(10==d[(n=i-1|0)+e|0])break}if((n=0|Cn[h[r+36>>2]](r,e,i))>>>0<i>>>0)break e;e=e+i|0,t=t-i|0,s=h[r+20>>2]}He(s,e,t),h[r+20>>2]=h[r+20>>2]+t,n=t+i|0}return n}function cr(e){var t=0,r=0,i=0,n=0;d[e+76|0]&&(s[e+76|0]=0,i=h[e+60>>2],n=(t=(r=h[e+72>>2]+7|0)>>>0<7?1:t)>>>3|0,t=(r=t<<29|r>>>3)+h[e+56>>2]|0,i=i+n|0,h[e+56>>2]=t,h[e+60>>2]=t>>>0<r>>>0?i+1|0:i),f[e+38>>1]<=513&&(s[e+132|0]=0,i=h[e+116>>2],t=0,n=(t=(r=h[e+128>>2]+7|0)>>>0<7?1:t)>>>3|0,t=(r=t<<29|r>>>3)+h[e+112>>2]|0,i=i+n|0,h[e+112>>2]=t,h[e+116>>2]=t>>>0<r>>>0?i+1|0:i)}function ur(e,t,r){var i=0,n=0,o=0,a=0;e:if(!(e>>>0>10||(0|(i=h[r+20>>2]))>=(0|(n=h[r+12>>2]))&(o=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|n))){if(n=s[o+h[r>>2]|0],i=(o=o+1|0)?i:i+1|0,h[r+16>>2]=o,h[r+20>>2]=i,(0|n)<0){if(!ur(e+1|0,t,r))break e;r=h[t>>2],e=h[t+4>>2]<<7|r>>>25,r=127&n|r<<7}else e=0,r=255&n;h[t>>2]=r,h[t+4>>2]=e,a=1}return a}function hr(e,t,r){var i=0,n=0,o=0,a=0;e:if(!(e>>>0>10||(0|(i=h[r+20>>2]))>=(0|(n=h[r+12>>2]))&(o=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|n))){if(n=s[o+h[r>>2]|0],i=(o=o+1|0)?i:i+1|0,h[r+16>>2]=o,h[r+20>>2]=i,(0|n)<0){if(!hr(e+1|0,t,r))break e;r=h[t>>2],e=h[t+4>>2]<<7|r>>>25,r=127&n|r<<7}else e=0,r=255&n;h[t>>2]=r,h[t+4>>2]=e,a=1}return a}function dr(e,t){var r,i=0,n=0,s=0,o=0;h[e+144>>2]=t,i=h[32+(0|Cn[h[h[t>>2]+32>>2]](t))>>2],r=h[i>>2]+h[i+16>>2]|0,n=h[32+(0|Cn[h[h[t>>2]+32>>2]](t))>>2],i=(i=h[n+8>>2])-(n=h[n+16>>2])|0,s=e,o=f[h[32+(0|Cn[h[h[t>>2]+32>>2]](t))>>2]+38>>1],u[s+38>>1]=o,h[e>>2]=r,h[e+16>>2]=0,h[e+20>>2]=0,h[e+8>>2]=i,h[e+12>>2]=0,s=e,o=0|Cn[h[h[t>>2]+36>>2]](t),h[s+148>>2]=o}function fr(e,t,r,i){s[e+53|0]=1;e:if(h[e+4>>2]==(0|r)){s[e+52|0]=1;t:{if(!(r=h[e+16>>2])){if(h[e+36>>2]=1,h[e+24>>2]=i,h[e+16>>2]=t,1!=(0|i))break e;if(1==h[e+48>>2])break t;break e}if((0|t)==(0|r)){if(2==(0|(r=h[e+24>>2]))&&(h[e+24>>2]=i,r=i),1!=h[e+48>>2])break e;if(1==(0|r))break t;break e}h[e+36>>2]=h[e+36>>2]+1}s[e+54|0]=1}}function pr(e,t,r){t|=0,r|=0;var i,n=0;N=i=N-16|0,h[4+(e|=0)>>2]=t,t=h[t+64>>2],n=h[t>>2],t=h[t+4>>2],s[i+15|0]=0,Rt(e+24|0,(t-n>>2>>>0)/3|0,i+15|0),t=h[e+4>>2],n=h[t+56>>2],t=h[t+52>>2],s[i+14|0]=0,Rt(e+36|0,n-t>>2,i+14|0),t=h[r+12>>2],h[e+16>>2]=h[r+8>>2],h[e+20>>2]=t,t=h[r+4>>2],h[e+8>>2]=h[r>>2],h[e+12>>2]=t,N=i+16|0}function mr(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0;if(t)for(o=0-d[e+12|0]&255,a=h[e>>2],n=h[e+8>>2];l=i<<1,n>>>0>4095||(0|(i=h[e+4>>2]))<=0||(i=i-1|0,h[e+4>>2]=i,n=d[i+a|0]|n<<8),i=(s=255&n)>>>0<o>>>0,c=s,s=v(n>>>8|0,o),n=i?c+s|0:n-(o+s|0)|0,h[e+8>>2]=n,i|=l,t=t-1|0;);h[r>>2]=i}function gr(e){h[e>>2]=0,h[e+4>>2]=0,h[e+28>>2]=0,h[e+32>>2]=0,s[e+24|0]=1,h[e+16>>2]=0,h[e+20>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0,h[e+36>>2]=0,h[e+40>>2]=0,h[e+44>>2]=0,h[e+48>>2]=0,h[e+52>>2]=0,h[e+56>>2]=0,h[e+60>>2]=0,h[e+64>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+84>>2]=0,h[e+88>>2]=0,h[e+92>>2]=0,h[e+68>>2]=e}function vr(e){var t;h[e>>2]=0,h[e+4>>2]=0,h[e+56>>2]=0,h[e+48>>2]=0,h[e+52>>2]=0,h[e+40>>2]=0,h[e+44>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0,h[(t=e- -64|0)>>2]=0,h[t+4>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+84>>2]=0,h[e+60>>2]=e}function _r(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!_r(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function br(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!br(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function yr(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!yr(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function Er(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!Er(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function wr(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!wr(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function xr(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!xr(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function Ar(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!Ar(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function Tr(e,t,r){var i=0,n=0,s=0,o=0,a=0;e:if(!(e>>>0>5||(0|(i=s=h[r+20>>2]))>=(0|(o=h[r+12>>2]))&(n=h[r+16>>2])>>>0>=p[r+8>>2]|(0|i)>(0|o))){if(i=d[n+h[r>>2]|0],s=(n=n+1|0)?s:s+1|0,h[r+16>>2]=n,h[r+20>>2]=s,128&i){if(!Tr(e+1|0,t,r))break e;i=127&i|h[t>>2]<<7}h[t>>2]=i,a=1}return a}function Sr(e,t,r){var i=0,n=0;e:{t:{if(r>>>0>=4){if(3&(e|t))break t;for(;;){if(h[e>>2]!=h[t>>2])break t;if(t=t+4|0,e=e+4|0,!((r=r-4|0)>>>0>3))break}}if(!r)break e}for(;;){if((0|(i=d[0|e]))==(0|(n=d[0|t]))){if(t=t+1|0,e=e+1|0,r=r-1|0)continue;break e}break}return i-n|0}return 0}function Mr(e){var t=0,r=0,i=0;if(e){if(i=h[e+24>>2]){if((0|(r=h[e+28>>2]))==(0|i))t=i;else{for(;t=h[(r=r-4|0)>>2],h[r>>2]=0,t&&(ni(t+12|0,h[t+16>>2]),fi(t,h[t+4>>2]),ve(t)),(0|i)!=(0|r););t=h[e+24>>2]}h[e+28>>2]=i,ve(t)}ni(e+12|0,h[e+16>>2]),fi(e,h[e+4>>2]),ve(e)}}function Cr(e){var t,r=0,i=0;if(t=h[e>>2]){if((0|t)==(0|(r=h[e+4>>2])))r=t;else{for(;(i=h[r-12>>2])&&(h[r-8>>2]=i,ve(i)),(i=h[r-28>>2])&&(h[r-24>>2]=i,ve(i)),(i=h[r-40>>2])&&(h[r-36>>2]=i,ve(i)),Nr(r-140|0),(0|t)!=(0|(r=r-144|0)););r=h[e>>2]}h[e+4>>2]=t,ve(r)}}function Rr(e){var t=0,r=0,i=0;e:{if(3&(t=e))for(;;){if(!d[0|t])break e;if(!(3&(t=t+1|0)))break}for(;r=t,t=t+4|0,!((-1^(i=h[r>>2]))&i-16843009&-2139062144););if(!(255&i))return r-e|0;for(;i=d[r+1|0],r=t=r+1|0,i;);}return t-e|0}function Ir(e){var t,r=0,i=0;if(h[(e|=0)>>2]=13312,(r=h[e+20>>2])&&(h[e+24>>2]=r,ve(r)),t=h[e+8>>2]){if((0|(i=h[e+12>>2]))==(0|t))r=t;else{for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(0|t)!=(0|i););r=h[e+8>>2]}h[e+12>>2]=t,ve(r)}ve(e)}function Or(e,t,r){e|=0,t|=0;var i,n,s,o,a=0,l=0;return(o=h[8+(r|=0)>>2])>>>0>(n=h[r+16>>2])>>>0&(0|(a=s=h[r+12>>2]))>=(0|(i=h[r+20>>2]))|(0|i)<(0|a)&&(t=d[n+h[r>>2]|0],a=(l=n+1|0)?i:i+1|0,h[r+16>>2]=l,h[r+20>>2]=a,h[e+4>>2]=t),n>>>0<o>>>0&(0|i)<=(0|s)|(0|i)<(0|s)}function Pr(e,t,r){var i=0;if(!r)return h[e+4>>2]==h[t+4>>2];if((0|e)==(0|t))return 1;i=h[e+4>>2],e=d[0|i],r=h[t+4>>2];e:if(!(!e|(0|(t=d[0|r]))!=(0|e)))for(;;){if(t=d[r+1|0],!(e=d[i+1|0]))break e;if(r=r+1|0,i=i+1|0,(0|e)!=(0|t))break}return(0|e)==(0|t)}function kr(e,t){var r=0,i=0,n=0,s=0;e:{if(r=h[e>>2],!(h[e+8>>2]-r>>2>>>0>=t>>>0)){if(t>>>0>=1073741824)break e;i=h[e+4>>2],n=(t=mi(n=t<<2))+n|0,s=(i=i-r|0)+t|0,(0|i)>0&&He(t,r,i),h[e+8>>2]=n,h[e+4>>2]=s,h[e>>2]=t,r&&ve(r)}return}Zr(1336),S()}function Lr(e){var t=0;e&&((t=h[e+76>>2])&&(h[e+80>>2]=t,ve(t)),(t=h[e- -64>>2])&&(h[e+68>>2]=t,ve(t)),(t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),(t=h[e+24>>2])&&(h[e+28>>2]=t,ve(t)),(t=h[e+12>>2])&&(h[e+16>>2]=t,ve(t)),(t=h[e>>2])&&(h[e+4>>2]=t,ve(t)),ve(e))}function Nr(e){var t=0;(t=h[e+84>>2])&&(h[e+88>>2]=t,ve(t)),(t=h[e+72>>2])&&(h[e+76>>2]=t,ve(t)),(t=h[e+52>>2])&&(h[e+56>>2]=t,ve(t)),(t=h[e+40>>2])&&(h[e+44>>2]=t,ve(t)),(t=h[e+28>>2])&&(h[e+32>>2]=t,ve(t)),(t=h[e+12>>2])&&ve(t),(e=h[e>>2])&&ve(e)}function Gr(e,t,r){var i,n,s=0,o=0,a=0;for(N=i=(N=n=N-16|0)-16|0,t=t-e>>2;t;)h[i+12>>2]=e,s=t>>>1|0,h[i+12>>2]=h[i+12>>2]+(s<<2),a=(-1^s)+t|0,t=s,s=h[i+12>>2],t=(o=p[s>>2]<p[r>>2])?a:t,e=o?s+4|0:e;return N=i+16|0,N=n+16|0,e}function Dr(e){var t,r=0,i=0;if((0|(r=h[e+4>>2]))!=(0|(t=h[e>>2])))for(;(i=h[r-12>>2])&&(h[r-8>>2]=i,ve(i)),(i=h[r-28>>2])&&(h[r-24>>2]=i,ve(i)),(i=h[r-40>>2])&&(h[r-36>>2]=i,ve(i)),Nr(r-140|0),(0|t)!=(0|(r=r-144|0)););h[e+4>>2]=t}function Ur(e,t,r){var i=0,n=0;e:{if(r>>>0<=10)s[(i=e)+11|0]=r;else{if(r>>>0>4294967279)break e;i=r>>>0>=11?11==(0|(i=(n=r+16&-16)-1|0))?n:i:10,i=mi(n=i+1|0),h[e>>2]=i,h[e+8>>2]=-2147483648|n,h[e+4>>2]=r}return void rn(i,t,r+1|0)}mn(),S()}function Vr(e,t){var r,i;return i=mi(40),h[i>>2]=-1,h[16+(r=i+8|0)>>2]=0,h[r+20>>2]=0,h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,Cn[h[h[e>>2]+16>>2]](e,i),e=h[t+88>>2],h[t+88>>2]=i,e&&((t=h[e+8>>2])&&(h[e+12>>2]=t,ve(t)),ve(e)),1}function Br(e){var t,r,i=0,n=0,s=0;return s=d[e+12|0],(n=h[e+8>>2])>>>0>4095||(0|(i=h[e+4>>2]))<=0||(i=i-1|0,h[e+4>>2]=i,n=d[i+h[e>>2]|0]|n<<8),i=v(s=0-s&255,n>>>8|0),r=(t=255&n)>>>0<s>>>0,h[e+8>>2]=r?i+t|0:n-(i+s|0)|0,r}function Fr(e,t){return h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=2012,h[e+12>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+40>>2]=0,h[e>>2]=2356,h[e+44>>2]=0,h[e+48>>2]=0,h[e+52>>2]=0,h[e+56>>2]=0,h[e+60>>2]=t,e}function jr(e,t,r,i){if(t){if((0|i)<0)return 0;!i&h[e+4>>2]-h[e>>2]>>>0>=r>>>0||sr(e,r),r&&Et(h[e>>2],t,r)}else{if((0|i)<0)return 0;sr(e,r)}return t=h[e+28>>2],t=(r=h[e+24>>2]+1|0)?t:t+1|0,h[e+24>>2]=r,h[e+28>>2]=t,1}function zr(e){var t=0,r=0,i=0;if(s[h[e>>2]]-48>>>0>=10)return 0;for(;i=h[e>>2],r=-1,t>>>0<=214748364&&(r=(0|(r=s[0|i]-48|0))>(2147483647-(t=v(t,10))|0)?-1:r+t|0),h[e>>2]=i+1,t=r,s[i+1|0]-48>>>0<10;);return t}function Wr(e){var t=0,r=0;(e|=0)&&(t=h[e+88>>2],h[e+88>>2]=0,t&&((r=h[t+8>>2])&&(h[t+12>>2]=r,ve(r)),ve(t)),(t=h[e+68>>2])&&(h[e+72>>2]=t,ve(t)),t=h[e+64>>2],h[e+64>>2]=0,t&&((r=h[t>>2])&&(h[t+4>>2]=r,ve(r)),ve(t)),ve(e))}function Hr(e,t){var r,i=0,n=0;if((r=Rr(t))>>>0<4294967280){e:{if(r>>>0>=11)i=mi(n=r+16&-16),h[e+8>>2]=-2147483648|n,h[e>>2]=i,h[e+4>>2]=r;else if(s[e+11|0]=r,i=e,!r)break e;He(i,t,r)}return s[r+i|0]=0,e}mn(),S()}function $r(e,t,r,i){var n,s=0,o=0;return n=(o=t^i)>>31,o>>=31,e=Xe((e^=s=t>>31)-s|0,s=(t^s)-((e>>>0<s>>>0)+s|0)|0,(t=r^(e=i>>31))-e|0,(e^i)-((e>>>0>t>>>0)+e|0)|0)^o,G=(n^G)-((e>>>0<o>>>0)+n|0)|0,t=e-o|0}function Yr(e,t,r){var i,n=0;N=i=N-16|0,(n=2147483647&h[e+8>>2])>>>0>r>>>0?(n=h[e>>2],h[e+4>>2]=r,rn(n,t,r),s[i+15|0]=0,s[r+n|0]=d[i+15|0]):qt(e,n-1|0,1+(r-n|0)|0,e=h[e+4>>2],e,r,t),N=i+16|0}function qr(e,t,r,i){var n,s,o,a,l=0,c=0;return a=v(l=r>>>16|0,c=e>>>16|0),l=(65535&(c=((o=v(n=65535&r,s=65535&e))>>>16|0)+v(c,n)|0))+v(l,s)|0,G=(v(t,r)+a|0)+v(e,i)+(c>>>16)+(l>>>16)|0,65535&o|l<<16}function Xr(e,t,r){var i;if(!(i=h[e+16>>2]))return h[e+36>>2]=1,h[e+24>>2]=r,void(h[e+16>>2]=t);e:{if((0|t)==(0|i)){if(2!=h[e+24>>2])break e;return void(h[e+24>>2]=r)}s[e+54|0]=1,h[e+24>>2]=2,h[e+36>>2]=h[e+36>>2]+1}}function Zr(e){var t,r,i,n,s;t=0|L(8),h[t>>2]=15156,h[t>>2]=15200,i=mi((r=Rr(e))+13|0),h[i+8>>2]=0,h[i+4>>2]=r,h[i>>2]=r,n=t,s=He(i+12|0,e,r+1|0),h[n+4>>2]=s,h[t>>2]=15248,k(0|t,15280,13),S()}function Jr(e,t,r,i,n){var s;if(N=s=N-256|0,!(73728&n|(0|r)<=(0|i))){if(St(s,255&t,(i=(r=r-i|0)>>>0<256)?r:256),!i)for(;$i(e,s,256),(r=r-256|0)>>>0>255;);$i(e,s,r)}N=s+256|0}function Kr(e,t,r){var i=0;return(0|(i=e+4|0))==(0|(e=Gt(e,t)))?0:((0|(t=h[e+32>>2]))!=(0|(i=h[e+28>>2]))&&(rt(r,t-i|0),He(pi(r),r=h[e+28>>2],h[e+32>>2]-r|0)),(0|t)!=(0|i))}function Qr(e,t){var r,i=0;if(r=h[e+8>>2],e=h[e+12>>2]-r|0)for(i=(e>>=2)>>>0>1?e:1,e=0;;){if(h[h[(e<<2)+r>>2]+60>>2]==(0|t))return e;if((0|i)==(0|(e=e+1|0)))break}return-1}function ei(e){var t=0;return t=h[e+72>>2],h[e+72>>2]=t-1|t,8&(t=h[e>>2])?(h[e>>2]=32|t,-1):(h[e+4>>2]=0,h[e+8>>2]=0,t=h[e+44>>2],h[e+28>>2]=t,h[e+20>>2]=t,h[e+16>>2]=t+h[e+48>>2],0)}function ti(e){return h[e+8>>2]=0,h[e+12>>2]=0,h[e>>2]=0,h[e+40>>2]=0,h[e+44>>2]=0,h[e+28>>2]=9,s[e+24|0]=1,h[e+56>>2]=-1,h[e+60>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e+48>>2]=0,h[e+52>>2]=0,e}function ri(e,t,r){var i;N=i=N-16|0,r>>>0<=10?(s[e+11|0]=r,rn(e,t,r),s[i+15|0]=0,s[e+r|0]=d[i+15|0]):qt(e,10,r-10|0,e=d[e+11|0],e,r,t),N=i+16|0}function ii(e){var t,r;return(e=(t=h[3902])+(r=e+3&-4)|0)>>>0<=t>>>0&&r||e>>>0>Rn()<<16>>>0&&!(0|I(0|e))?(h[4190]=48,-1):(h[3902]=e,t)}function ni(e,t){t&&(ni(e,h[t>>2]),ni(e,h[t+4>>2]),e=h[t+28>>2],h[t+28>>2]=0,e&&(ni(e+12|0,h[e+16>>2]),fi(e,h[e+4>>2]),ve(e)),s[t+27|0]<0&&ve(h[t+16>>2]),ve(t))}function si(e){return h[e+40>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=13312,h[e+12>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,h[e+32>>2]=0,u[e+36>>1]=0,e}function oi(e){var t=0;return!h[(e|=0)- -64>>2]|!h[e+68>>2]|!h[e+44>>2]|!h[e+48>>2]||!h[e+52>>2]|!h[e+56>>2]||(t=-1!=h[e+92>>2]),0|t}function ai(e){var t=0;return h[(e|=0)>>2]=2476,t=h[e+20>>2],h[e+20>>2]=0,t&&Cn[h[h[t>>2]+4>>2]](t),h[e>>2]=2260,t=h[e+16>>2],h[e+16>>2]=0,t&&Wr(t),0|e}function li(e){var t=0;return!h[48+(e|=0)>>2]|!h[e+52>>2]|!h[e+28>>2]|!h[e+32>>2]||!h[e+36>>2]|!h[e+40>>2]||(t=-1!=h[e+76>>2]),0|t}function ci(e){var t=0;return h[(e|=0)>>2]=11900,(t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),h[e>>2]=12152,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),0|e}function ui(e){var t=0;h[(e|=0)>>2]=2476,t=h[e+20>>2],h[e+20>>2]=0,t&&Cn[h[h[t>>2]+4>>2]](t),h[e>>2]=2260,t=h[e+16>>2],h[e+16>>2]=0,t&&Wr(t),ve(e)}function hi(e,t){var r=0;return r=-1,-1==(0|t)|(0|t)>4||(t=v(t,12)+e|0,e=h[t+20>>2],(h[t+24>>2]-e|0)<=0||(r=h[e>>2])),r}function di(e,t,r,i,n,o,a){h[e>>2]=0,h[e+56>>2]=t,h[e+48>>2]=0,h[e+52>>2]=0,h[e+40>>2]=o,h[e+44>>2]=a,s[e+32|0]=n,h[e+28>>2]=i,s[e+24|0]=r}function fi(e,t){t&&(fi(e,h[t>>2]),fi(e,h[t+4>>2]),(e=h[t+28>>2])&&(h[t+32>>2]=e,ve(e)),s[t+27|0]<0&&ve(h[t+16>>2]),ve(t))}function pi(e){return(d[e+11|0]>>>7|0?h[e+4>>2]:d[e+11|0])||(Tn(),S()),d[e+11|0]>>>7|0&&(e=h[e>>2]),e}function mi(e){var t=0;e=e||1;e:{for(;;){if(t=V(e))break e;if(!(t=h[4357]))break;Cn[0|t]()}M(),S()}return t}function gi(e,t){t&&(gi(e,h[t>>2]),gi(e,h[t+4>>2]),s[t+39|0]<0&&ve(h[t+28>>2]),s[t+27|0]<0&&ve(h[t+16>>2]),ve(t))}function vi(e,t){e|=0;var r=0;switch(0|(t|=0)){case 1:t=1;case 0:h[e+28>>2]=t,r=1}return 0|r}function _i(e){var t,r;return h[(e|=0)>>2]=15200,t=h[e+4>>2]-12|0,r=h[t+8>>2]-1|0,h[t+8>>2]=r,(0|r)<0&&ve(t),0|e}function bi(e,t,r){return t|=0,r|=0,h[4+(e|=0)>>2]=t,t=h[h[h[t+4>>2]+8>>2]+(r<<2)>>2],h[e+12>>2]=r,h[e+8>>2]=t,1}function yi(e){var t=0;return!h[60+(e|=0)>>2]|!h[e+44>>2]|!h[e+48>>2]|!h[e+52>>2]||(t=0!=h[e+56>>2]),0|t}function Ei(e,t){var r,i;sr(e,t),r=t=h[e+28>>2],i=t+1|0,t=h[e+24>>2]+1|0,h[e+24>>2]=t,h[e+28>>2]=t?r:i}function wi(e){var t=0;return!h[52+(e|=0)>>2]|!h[e+44>>2]|!h[e+48>>2]||(t=0!=h[e+56>>2]),0|t}function xi(e,t){e|=0;var r=0;return h[56+(t|=0)>>2]|!t|3!=d[t+24|0]||(h[e+60>>2]=t,r=1),0|r}function Ai(e,t){e|=0;var r=0;return h[56+(t|=0)>>2]|3!=d[t+24|0]||(h[e- -64>>2]=t,r=1),0|r}function Ti(e){var t=0;(t=h[e+16>>2])&&(h[e+20>>2]=t,ve(t)),(t=h[e>>2])&&(h[e+4>>2]=t,ve(t))}function Si(e,t){e|=0;var r=0;return h[56+(t|=0)>>2]|3!=d[t+24|0]||(h[e+48>>2]=t,r=1),0|r}function Mi(e){var t;h[(e|=0)>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)}function Ci(e){var t;h[e+16>>2]=0,t=h[e>>2],h[e+4>>2]=t,h[e+12>>2]=t,t&&ve(t)}function Ri(e,t){t&&(Ri(e,h[t>>2]),Ri(e,h[t+4>>2]),gi(t+20|0,h[t+24>>2]),ve(t))}function Ii(e){for(var t=0;e;)e&=e-1,t=t+1|0;return t}function Oi(){var e;return e=mi(12),h[e>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,0|e}function Pi(e){var t=0;(e|=0)&&((t=h[e>>2])&&(h[e+4>>2]=t,ve(t)),ve(e))}function ki(e){var t;return(-1>>>(t=31&e)&-2)<<t|(-1<<(e=0-e&31)&-2)>>>e}function Li(e,t,r){h[r+76>>2],e=lr(e,t,r)}function Ni(e,t){return t|=0,0|Cn[h[h[(e|=0)>>2]+12>>2]](e,t)}function Gi(e,t){return t|=0,h[h[(e|=0)>>2]+(t<<2)>>2]}function Di(e){return h[e>>2]=13756,St(e+4|0,0,80),e}function Ui(e){return e?31-y(e-1^e)|0:32}function Vi(e){return h[12+(e|=0)>>2]-h[e+8>>2]>>2}function Bi(e){(e|=0)&&Cn[h[h[e>>2]+4>>2]](e)}function Fi(e,t){return t|=0,h[4+(e|=0)>>2]=t,1}function ji(e){return h[4+(e|=0)>>2]-h[e>>2]>>1}function zi(e){return h[4+(e|=0)>>2]-h[e>>2]>>2}function Wi(e){return h[4+(e|=0)>>2]-h[e>>2]|0}function Hi(e){si(e),h[e+44>>2]=0,h[e>>2]=11208}function $i(e,t,r){32&d[0|e]||lr(t,r,e)}function Yi(e){return h[28+(e|=0)>>2]}function qi(e){return h[80+(e|=0)>>2]}function Xi(e,t){return-1}function Zi(e){return h[4+(e|=0)>>2]}function Ji(e){return h[8+(e|=0)>>2]}function Ki(e,t){return 6}function Qi(e,t){return 1}function en(e,t){return 0}function tn(e){return h[(e|=0)>>2]}function rn(e,t,r){r&&He(e,t,r)}function nn(e){(e|=0)&&ve(e)}function sn(e){return 0|(e|=0)}function on(e){return 3}function an(e){return 4}function ln(e){return 5}function cn(e){return 2}function un(e){return 6}function hn(e){return 1}function dn(e){return 0}function fn(e){ve(e|=0)}function pn(){Zr(1276),S()}function mn(){Zr(1323),S()}function gn(e){S()}function vn(){pn(),S()}function _n(){return 3}function bn(){return 4}function yn(){return-1}function En(){return 1}function wn(){return 0}function xn(){return 2}function An(){Tn(),S()}function Tn(){M(),S()}function Sn(e){}n(t=d,1028,"YAQAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAcAAAAIAAAACQAAAAoAAAALAAAADAAAAE41ZHJhY28yOEF0dHJpYnV0ZU9jdGFoZWRyb25UcmFuc2Zvcm1FAADYOgAAOAQAAMwHAAAAAAAA0AQAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAAAoAAAAXAAAAGAAAAE41ZHJhY28zMEF0dHJpYnV0ZVF1YW50aXphdGlvblRyYW5zZm9ybUUAAAAA2DoAAKQEAADMBwAALSsgICAwWDB4AF9fbmV4dF9wcmltZSBvdmVyZmxvdwB2ZWN0b3IAc3RkOjpleGNlcHRpb24Ac2tpcF9hdHRyaWJ1dGVfdHJhbnNmb3JtAGJhc2ljX3N0cmluZwBhbGxvY2F0b3I8VD46OmFsbG9jYXRlKHNpemVfdCBuKSAnbicgZXhjZWVkcyBtYXhpbXVtIHN1cHBvcnRlZCBzaXplAERSQUNPAFVzaW5nIGluY29tcGF0aWJsZSBkZWNvZGVyIGZvciB0aGUgaW5wdXQgZ2VvbWV0cnkuAEZhaWxlZCB0byBkZWNvZGUgcG9pbnQgYXR0cmlidXRlcy4ARmFpbGVkIHRvIGluaXRpYWxpemUgdGhlIGRlY29kZXIuAFVua25vd24gbWlub3IgdmVyc2lvbi4AVW5rbm93biBtYWpvciB2ZXJzaW9uLgBJbnB1dCBpcyBub3QgYSBtZXNoLgBVbnN1cHBvcnRlZCBnZW9tZXRyeSB0eXBlLgBOb3QgYSBEcmFjbyBmaWxlLgBJbnB1dCBpcyBub3QgYSBwb2ludCBjbG91ZC4AVW5zdXBwb3J0ZWQgZW5jb2RpbmcgbWV0aG9kLgBGYWlsZWQgdG8gZGVjb2RlIG1ldGFkYXRhLgBGYWlsZWQgdG8gZGVjb2RlIGdlb21ldHJ5IGRhdGEuAChudWxsKQBQdXJlIHZpcnR1YWwgZnVuY3Rpb24gY2FsbGVkIQBLZFRyZWVBdHRyaWJ1dGVzRGVjb2RlcjogY29tcHJlc3Npb24gbGV2ZWwgJWkgbm90IHN1cHBvcnRlZC4KAEZsb2F0UG9pbnRzVHJlZURlY29kZXI6IGNvbXByZXNzaW9uIGxldmVsICVpIG5vdCBzdXBwb3J0ZWQuCgBWZXJzaW9uIG5vdCBzdXBwb3J0ZWQuIAoATWV0aG9kIG5vdCBzdXBwb3J0ZWQuIAoATjVkcmFjbzE4QXR0cmlidXRlVHJhbnNmb3JtRQCwOgAArwcAAAAAAABYCAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAATjVkcmFjbzE3QXR0cmlidXRlc0RlY29kZXJFAE41ZHJhY28yNkF0dHJpYnV0ZXNEZWNvZGVySW50ZXJmYWNlRQAAAACwOgAAKAgAANg6AAAMCAAAUAgAAAAAAADACAAAJQAAACYAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAJwAAACgAAAApAAAATjVkcmFjbzIzS2RUcmVlQXR0cmlidXRlc0RlY29kZXJFAAAA2DoAAJwIAABYCAAAAAAAACAJAAAqAAAAKwAAACwAAAAtAAAALgAAAC8AAAAwAAAAMQAAADIAAABONWRyYWNvMjZTZXF1ZW50aWFsQXR0cmlidXRlRGVjb2RlckUAAAAAsDoAAPgIAAD/////AAAAAJgJAAAzAAAANAAAABsAAAA1AAAANgAAAB4AAAAfAAAAIAAAADcAAAA4AAAAOQAAADoAAAA7AAAATjVkcmFjbzM3U2VxdWVudGlhbEF0dHJpYnV0ZURlY29kZXJzQ29udHJvbGxlckUA2DoAAGgJAABYCAAAAAAAAAwKAAA8AAAAPQAAAD4AAAAtAAAALgAAAC8AAAA/AAAAMQAAAEAAAABBAAAAQgAAAEMAAABEAAAATjVkcmFjbzMzU2VxdWVudGlhbEludGVnZXJBdHRyaWJ1dGVEZWNvZGVyRQDYOgAA4AkAACAJAAAAAAAAmAwAAEUAAABGAAAARwAAAEgAAABJAAAASgAAAEsAAABMAAAATQAAAE4AAABPAAAAUAAAAE41ZHJhY280ME1lc2hQcmVkaWN0aW9uU2NoZW1lUGFyYWxsZWxvZ3JhbURlY29kZXJJaU5TXzM3UHJlZGljdGlvblNjaGVtZVdyYXBEZWNvZGluZ1RyYW5zZm9ybUlpaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvMjdNZXNoUHJlZGljdGlvblNjaGVtZURlY29kZXJJaU5TXzM3UHJlZGljdGlvblNjaGVtZVdyYXBEZWNvZGluZ1RyYW5zZm9ybUlpaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvMjNQcmVkaWN0aW9uU2NoZW1lRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVFRQBONWRyYWNvMzdQcmVkaWN0aW9uU2NoZW1lVHlwZWREZWNvZGVySW50ZXJmYWNlSWlpRUUATjVkcmFjbzMyUHJlZGljdGlvblNjaGVtZURlY29kZXJJbnRlcmZhY2VFAE41ZHJhY28yNVByZWRpY3Rpb25TY2hlbWVJbnRlcmZhY2VFALA6AAA8DAAA2DoAABEMAABgDAAA2DoAAN0LAABoDAAA2DoAAIkLAAB0DAAA2DoAAPMKAACADAAA2DoAAFAKAACMDAAAAAAAAIwMAABFAAAAUQAAACIAAABIAAAAIgAAAEoAAABLAAAATAAAAE0AAABOAAAATwAAACIAAAAAAAAAgAwAAEUAAABSAAAAIgAAAEgAAAAiAAAASgAAAEsAAABMAAAATQAAAE4AAABPAAAAIgAAAAAAAAD0DQAARQAAAFMAAABUAAAASAAAAFUAAABKAAAASwAAAEwAAABNAAAATgAAAE8AAABWAAAATjVkcmFjbzQ1TWVzaFByZWRpY3Rpb25TY2hlbWVNdWx0aVBhcmFsbGVsb2dyYW1EZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUA2DoAAEwNAACMDAAAAAAAAOwOAABXAAAAWAAAAFkAAABIAAAAWgAAAEoAAABLAAAATAAAAE0AAABOAAAAWwAAAFwAAABONWRyYWNvNTZNZXNoUHJlZGljdGlvblNjaGVtZUNvbnN0cmFpbmVkTXVsdGlQYXJhbGxlbG9ncmFtRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAADYOgAAOA4AAIwMAAAAAAAA0A8AAF0AAABeAAAAXwAAAEgAAABgAAAAYQAAAGIAAABjAAAATQAAAE4AAABkAAAAZQAAAE41ZHJhY28zNk1lc2hQcmVkaWN0aW9uU2NoZW1lVGV4Q29vcmRzRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAADYOgAAMA8AAIwMAAAAAAAAvBAAAGYAAABnAAAAaAAAAEgAAABpAAAAagAAAGsAAABsAAAATQAAAE4AAABtAAAAbgAAAE41ZHJhY280NE1lc2hQcmVkaWN0aW9uU2NoZW1lVGV4Q29vcmRzUG9ydGFibGVEZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUAANg6AAAUEAAAjAwAAAAAAACoEQAAbwAAAHAAAABxAAAASAAAAHIAAABzAAAAdAAAAHUAAABNAAAATgAAAHYAAAB3AAAATjVkcmFjbzQyTWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxEZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUAAAAA2DoAAAARAACMDAAAAAAAADATAAB4AAAAeQAAAHoAAAB7AAAAfAAAAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsUHJlZGljdG9yQXJlYUlpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsUHJlZGljdG9yQmFzZUlpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAAAAsDoAAHsSAADYOgAA0BEAACgTAAAAAAAAKBMAAHgAAAB9AAAAIgAAAHsAAAAiAAAAAAAAALwUAABFAAAAfgAAAH8AAABIAAAAgAAAAEoAAABLAAAATAAAAE0AAABOAAAATwAAAIEAAABONWRyYWNvNDBNZXNoUHJlZGljdGlvblNjaGVtZVBhcmFsbGVsb2dyYW1EZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvMjdNZXNoUHJlZGljdGlvblNjaGVtZURlY29kZXJJaU5TXzM3UHJlZGljdGlvblNjaGVtZVdyYXBEZWNvZGluZ1RyYW5zZm9ybUlpaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMTFDb3JuZXJUYWJsZUVFRUVFAADYOgAAJhQAAIAMAADYOgAAkBMAALAUAAAAAAAAsBQAAEUAAACCAAAAIgAAAEgAAAAiAAAASgAAAEsAAABMAAAATQAAAE4AAABPAAAAIgAAAAAAAADUFQAARQAAAIMAAACEAAAASAAAAIUAAABKAAAASwAAAEwAAABNAAAATgAAAE8AAACGAAAATjVkcmFjbzQ1TWVzaFByZWRpY3Rpb25TY2hlbWVNdWx0aVBhcmFsbGVsb2dyYW1EZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQAA2DoAADgVAACwFAAAAAAAAMAWAACHAAAAiAAAAIkAAABIAAAAigAAAEoAAABLAAAATAAAAE0AAABOAAAAiwAAAIwAAABONWRyYWNvNTZNZXNoUHJlZGljdGlvblNjaGVtZUNvbnN0cmFpbmVkTXVsdGlQYXJhbGxlbG9ncmFtRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18xMUNvcm5lclRhYmxlRUVFRUUAAADYOgAAGBYAALAUAAAAAAAAmBcAAI0AAACOAAAAjwAAAEgAAACQAAAAkQAAAJIAAACTAAAATQAAAE4AAACUAAAAlQAAAE41ZHJhY28zNk1lc2hQcmVkaWN0aW9uU2NoZW1lVGV4Q29vcmRzRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18xMUNvcm5lclRhYmxlRUVFRUUAAADYOgAABBcAALAUAAAAAAAAeBgAAJYAAACXAAAAmAAAAEgAAACZAAAAmgAAAJsAAACcAAAATQAAAE4AAACdAAAAngAAAE41ZHJhY280NE1lc2hQcmVkaWN0aW9uU2NoZW1lVGV4Q29vcmRzUG9ydGFibGVEZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQAAANg6AADcFwAAsBQAAAAAAABUGQAAnwAAAKAAAAChAAAASAAAAKIAAACjAAAApAAAAKUAAABNAAAATgAAAKYAAACnAAAATjVkcmFjbzQyTWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxEZWNvZGVySWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQDYOgAAvBgAALAUAAAAAAAAwBoAAKgAAACpAAAAqgAAAKsAAACsAAAATjVkcmFjbzQ4TWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxQcmVkaWN0b3JBcmVhSWlOU18zN1ByZWRpY3Rpb25TY2hlbWVXcmFwRGVjb2RpbmdUcmFuc2Zvcm1JaWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvNDhNZXNoUHJlZGljdGlvblNjaGVtZUdlb21ldHJpY05vcm1hbFByZWRpY3RvckJhc2VJaU5TXzM3UHJlZGljdGlvblNjaGVtZVdyYXBEZWNvZGluZ1RyYW5zZm9ybUlpaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMTFDb3JuZXJUYWJsZUVFRUVFALA6AAAaGgAA2DoAAHwZAAC4GgAAAAAAALgaAACoAAAArQAAACIAAACrAAAAIgAAAAAAAAB8GwAARQAAAK4AAACvAAAASAAAALAAAABKAAAASwAAAEwAAABNAAAATgAAAE8AAACxAAAATjVkcmFjbzI4UHJlZGljdGlvblNjaGVtZURlbHRhRGVjb2RlcklpTlNfMzdQcmVkaWN0aW9uU2NoZW1lV3JhcERlY29kaW5nVHJhbnNmb3JtSWlpRUVFRQAAAADYOgAAIBsAAIAMAAAAAAAA8BsAALIAAACzAAAAtAAAAC0AAAAuAAAAtQAAAD8AAAAxAAAAQAAAALYAAAC3AAAAuAAAALkAAABONWRyYWNvMzJTZXF1ZW50aWFsTm9ybWFsQXR0cmlidXRlRGVjb2RlckUAANg6AADEGwAADAoAAAAAAAD8HQAAugAAALsAAAC8AAAAvQAAAL4AAAC/AAAAwAAAAMEAAADCAAAAwwAAAMQAAADFAAAATjVkcmFjbzQyTWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxEZWNvZGVySWlOU180OVByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uRGVjb2RpbmdUcmFuc2Zvcm1JaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvMjdNZXNoUHJlZGljdGlvblNjaGVtZURlY29kZXJJaU5TXzQ5UHJlZGljdGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25EZWNvZGluZ1RyYW5zZm9ybUlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY28yM1ByZWRpY3Rpb25TY2hlbWVEZWNvZGVySWlOU180OVByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uRGVjb2RpbmdUcmFuc2Zvcm1JaUVFRUUA2DoAAIUdAAB0DAAA2DoAAOQcAADkHQAA2DoAADQcAADwHQAAAAAAAJgfAADGAAAAxwAAAMgAAADJAAAAygAAAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsUHJlZGljdG9yQXJlYUlpTlNfNDlQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkRlY29kaW5nVHJhbnNmb3JtSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUATjVkcmFjbzQ4TWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxQcmVkaWN0b3JCYXNlSWlOU180OVByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uRGVjb2RpbmdUcmFuc2Zvcm1JaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFRUVFRQCwOgAA2h4AANg6AAAkHgAAkB8AAAAAAAAgIQAAywAAAMwAAADNAAAAvQAAAM4AAADPAAAA0AAAANEAAADCAAAAwwAAANIAAADTAAAATjVkcmFjbzQyTWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxEZWNvZGVySWlOU180OVByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uRGVjb2RpbmdUcmFuc2Zvcm1JaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMTFDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY28yN01lc2hQcmVkaWN0aW9uU2NoZW1lRGVjb2RlcklpTlNfNDlQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkRlY29kaW5nVHJhbnNmb3JtSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQAA2DoAAH8gAADkHQAA2DoAANwfAAAUIQAAAAAAAKQiAADUAAAA1QAAANYAAADXAAAA2AAAAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsUHJlZGljdG9yQXJlYUlpTlNfNDlQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkRlY29kaW5nVHJhbnNmb3JtSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvNDhNZXNoUHJlZGljdGlvblNjaGVtZUdlb21ldHJpY05vcm1hbFByZWRpY3RvckJhc2VJaU5TXzQ5UHJlZGljdGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25EZWNvZGluZ1RyYW5zZm9ybUlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18xMUNvcm5lclRhYmxlRUVFRUUAAACwOgAA8SEAANg6AABIIQAAnCIAAAAAAABMIwAA2QAAANoAAADbAAAAvQAAANwAAADdAAAA3gAAAN8AAADCAAAAwwAAAOAAAADhAAAATjVkcmFjbzI4UHJlZGljdGlvblNjaGVtZURlbHRhRGVjb2RlcklpTlNfNDlQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkRlY29kaW5nVHJhbnNmb3JtSWlFRUVFANg6AADoIgAA5B0AAAAAAACAJQAA4gAAAOMAAADkAAAA5QAAAOYAAADnAAAA6AAAAOkAAADqAAAA6wAAAOwAAADtAAAATjVkcmFjbzQyTWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxEZWNvZGVySWlOU182MlByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uQ2Fub25pY2FsaXplZERlY29kaW5nVHJhbnNmb3JtSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUATjVkcmFjbzI3TWVzaFByZWRpY3Rpb25TY2hlbWVEZWNvZGVySWlOU182MlByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uQ2Fub25pY2FsaXplZERlY29kaW5nVHJhbnNmb3JtSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzI0TWVzaEF0dHJpYnV0ZUNvcm5lclRhYmxlRUVFRUUATjVkcmFjbzIzUHJlZGljdGlvblNjaGVtZURlY29kZXJJaU5TXzYyUHJlZGljdGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25DYW5vbmljYWxpemVkRGVjb2RpbmdUcmFuc2Zvcm1JaUVFRUUAANg6AAD7JAAAdAwAANg6AABNJAAAaCUAANg6AACQIwAAdCUAAAAAAAA4JwAA7gAAAO8AAADwAAAA8QAAAPIAAABONWRyYWNvNDhNZXNoUHJlZGljdGlvblNjaGVtZUdlb21ldHJpY05vcm1hbFByZWRpY3RvckFyZWFJaU5TXzYyUHJlZGljdGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25DYW5vbmljYWxpemVkRGVjb2RpbmdUcmFuc2Zvcm1JaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFRUVFRQBONWRyYWNvNDhNZXNoUHJlZGljdGlvblNjaGVtZUdlb21ldHJpY05vcm1hbFByZWRpY3RvckJhc2VJaU5TXzYyUHJlZGljdGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25DYW5vbmljYWxpemVkRGVjb2RpbmdUcmFuc2Zvcm1JaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFRUVFRQAAALA6AABrJgAA2DoAAKglAAAwJwAAAAAAANwoAADzAAAA9AAAAPUAAADlAAAA9gAAAPcAAAD4AAAA+QAAAOoAAADrAAAA+gAAAPsAAABONWRyYWNvNDJNZXNoUHJlZGljdGlvblNjaGVtZUdlb21ldHJpY05vcm1hbERlY29kZXJJaU5TXzYyUHJlZGljdGlvblNjaGVtZU5vcm1hbE9jdGFoZWRyb25DYW5vbmljYWxpemVkRGVjb2RpbmdUcmFuc2Zvcm1JaUVFTlNfMjRNZXNoUHJlZGljdGlvblNjaGVtZURhdGFJTlNfMTFDb3JuZXJUYWJsZUVFRUVFAE41ZHJhY28yN01lc2hQcmVkaWN0aW9uU2NoZW1lRGVjb2RlcklpTlNfNjJQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkNhbm9uaWNhbGl6ZWREZWNvZGluZ1RyYW5zZm9ybUlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18xMUNvcm5lclRhYmxlRUVFRUUAAAAA2DoAACwoAABoJQAA2DoAAHwnAADQKAAAAAAAAHgqAAD8AAAA/QAAAP4AAAD/AAAAAAEAAE41ZHJhY280OE1lc2hQcmVkaWN0aW9uU2NoZW1lR2VvbWV0cmljTm9ybWFsUHJlZGljdG9yQXJlYUlpTlNfNjJQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkNhbm9uaWNhbGl6ZWREZWNvZGluZ1RyYW5zZm9ybUlpRUVOU18yNE1lc2hQcmVkaWN0aW9uU2NoZW1lRGF0YUlOU18xMUNvcm5lclRhYmxlRUVFRUUATjVkcmFjbzQ4TWVzaFByZWRpY3Rpb25TY2hlbWVHZW9tZXRyaWNOb3JtYWxQcmVkaWN0b3JCYXNlSWlOU182MlByZWRpY3Rpb25TY2hlbWVOb3JtYWxPY3RhaGVkcm9uQ2Fub25pY2FsaXplZERlY29kaW5nVHJhbnNmb3JtSWlFRU5TXzI0TWVzaFByZWRpY3Rpb25TY2hlbWVEYXRhSU5TXzExQ29ybmVyVGFibGVFRUVFRQCwOgAAuikAANg6AAAEKQAAcCoAAAAAAAAwKwAA2QAAAAEBAAACAQAA5QAAAAMBAAAEAQAABQEAAAYBAADqAAAA6wAAAAcBAAAIAQAATjVkcmFjbzI4UHJlZGljdGlvblNjaGVtZURlbHRhRGVjb2RlcklpTlNfNjJQcmVkaWN0aW9uU2NoZW1lTm9ybWFsT2N0YWhlZHJvbkNhbm9uaWNhbGl6ZWREZWNvZGluZ1RyYW5zZm9ybUlpRUVFRQAAAADYOgAAvCoAAGglAAAAAAAAtCsAAAkBAAAKAQAACwEAAC0AAAAuAAAADAEAAD8AAAAxAAAAQAAAAA0BAABCAAAAQwAAAA4BAAAPAQAAEAEAAE41ZHJhY28zOFNlcXVlbnRpYWxRdWFudGl6YXRpb25BdHRyaWJ1dGVEZWNvZGVyRQAAAADYOgAAgCsAAAwKAAAAAAAAFCwAABEBAAASAQAAEwEAABQBAAAiAAAAFQEAABYBAAAXAQAAGAEAABkBAAAaAQAAGwEAACIAAABONWRyYWNvMTFNZXNoRGVjb2RlckUAAADYOgAA/CsAAGw0AAAAAAAAgCwAABwBAAAdAQAAEwEAAB4BAAAfAQAAFQEAABYBAAAXAQAAIAEAACEBAAAiAQAAIwEAACQBAABONWRyYWNvMjJNZXNoRWRnZWJyZWFrZXJEZWNvZGVyRQAAAADYOgAAXCwAABQsAAAAAAAApC0AACUBAAAmAQAAJwEAACgBAAApAQAAKgEAACsBAAAsAQAALQEAAC4BAAD/////AAAAAAguAAAvAQAAMAEAADEBAAAyAQAAMwEAADQBAAA1AQAANgEAADcBAAA4AQAAAAAAAGguAAA5AQAAOgEAADsBAAA8AQAAPQEAAD4BAAA/AQAAQAEAAEEBAABCAQAATjVkcmFjbzI2TWVzaEVkZ2VicmVha2VyRGVjb2RlckltcGxJTlNfMzFNZXNoRWRnZWJyZWFrZXJUcmF2ZXJzYWxEZWNvZGVyRUVFAE41ZHJhY28zNU1lc2hFZGdlYnJlYWtlckRlY29kZXJJbXBsSW50ZXJmYWNlRQAAALA6AABsLQAA2DoAACAtAACcLQAATjVkcmFjbzI2TWVzaEVkZ2VicmVha2VyRGVjb2RlckltcGxJTlNfNDFNZXNoRWRnZWJyZWFrZXJUcmF2ZXJzYWxQcmVkaWN0aXZlRGVjb2RlckVFRQAAANg6AACwLQAAnC0AAE41ZHJhY28yNk1lc2hFZGdlYnJlYWtlckRlY29kZXJJbXBsSU5TXzM4TWVzaEVkZ2VicmVha2VyVHJhdmVyc2FsVmFsZW5jZURlY29kZXJFRUUAANg6AAAULgAAnC0AAAAAAABkLwAAQwEAAEQBAABFAQAATjVkcmFjbzE5RGVwdGhGaXJzdFRyYXZlcnNlcklOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVOU18zNk1lc2hBdHRyaWJ1dGVJbmRpY2VzRW5jb2RpbmdPYnNlcnZlcklTMV9FRUVFAE41ZHJhY28xM1RyYXZlcnNlckJhc2VJTlNfMjRNZXNoQXR0cmlidXRlQ29ybmVyVGFibGVFTlNfMzZNZXNoQXR0cmlidXRlSW5kaWNlc0VuY29kaW5nT2JzZXJ2ZXJJUzFfRUVFRQCwOgAA9S4AANg6AACILgAAXC8AAAAAAABcLwAARgEAAEcBAABFAQ=="),n(t,12180,"AQAAAAMAAAAFAAAABwAAAAAAAABoMAAASAEAAEkBAABKAQAASwEAAE41ZHJhY28yMk1lc2hUcmF2ZXJzYWxTZXF1ZW5jZXJJTlNfMjhNYXhQcmVkaWN0aW9uRGVncmVlVHJhdmVyc2VySU5TXzExQ29ybmVyVGFibGVFTlNfMzZNZXNoQXR0cmlidXRlSW5kaWNlc0VuY29kaW5nT2JzZXJ2ZXJJUzJfRUVFRUVFAE41ZHJhY28xNVBvaW50c1NlcXVlbmNlckUAAAAAsDoAAEMwAADYOgAAvC8AAGAwAAD/////AAAAAFgxAABMAQAATQEAAE4BAABONWRyYWNvMjhNYXhQcmVkaWN0aW9uRGVncmVlVHJhdmVyc2VySU5TXzExQ29ybmVyVGFibGVFTlNfMzZNZXNoQXR0cmlidXRlSW5kaWNlc0VuY29kaW5nT2JzZXJ2ZXJJUzFfRUVFRQBONWRyYWNvMTNUcmF2ZXJzZXJCYXNlSU5TXzExQ29ybmVyVGFibGVFTlNfMzZNZXNoQXR0cmlidXRlSW5kaWNlc0VuY29kaW5nT2JzZXJ2ZXJJUzFfRUVFRQAAsDoAAPUwAADYOgAAjDAAAFAxAAAAAAAAUDEAAE8BAABQAQAATgEAAAAAAAAQMgAAUQEAAFIBAABTAQAAVAEAAE41ZHJhY28yMk1lc2hUcmF2ZXJzYWxTZXF1ZW5jZXJJTlNfMTlEZXB0aEZpcnN0VHJhdmVyc2VySU5TXzExQ29ybmVyVGFibGVFTlNfMzZNZXNoQXR0cmlidXRlSW5kaWNlc0VuY29kaW5nT2JzZXJ2ZXJJUzJfRUVFRUVFAAAA2DoAAJAxAABgMAAAAAAAAJAyAABVAQAAVgEAAE4BAABONWRyYWNvMTlEZXB0aEZpcnN0VHJhdmVyc2VySU5TXzExQ29ybmVyVGFibGVFTlNfMzZNZXNoQXR0cmlidXRlSW5kaWNlc0VuY29kaW5nT2JzZXJ2ZXJJUzFfRUVFRQDYOgAAMDIAAFAxAAAAAAAAQDMAAFcBAABYAQAAWQEAAFoBAABONWRyYWNvMjJNZXNoVHJhdmVyc2FsU2VxdWVuY2VySU5TXzE5RGVwdGhGaXJzdFRyYXZlcnNlcklOU18yNE1lc2hBdHRyaWJ1dGVDb3JuZXJUYWJsZUVOU18zNk1lc2hBdHRyaWJ1dGVJbmRpY2VzRW5jb2RpbmdPYnNlcnZlcklTMl9FRUVFRUUAANg6AAC0MgAAYDA="),n(t,13140,"rDMAABEBAABbAQAAEwEAABQBAABcAQAAFQEAABYBAAAXAQAAGAEAABkBAAAaAQAAGwEAAF0BAABONWRyYWNvMjFNZXNoU2VxdWVudGlhbERlY29kZXJFANg6AACMMwAAFCwAAAAAAADsMwAAXgEAAF8BAABgAQAAYQEAAE41ZHJhY28xNUxpbmVhclNlcXVlbmNlckUAAADYOgAA0DMAAGAwAAAAAAAAbDQAABEBAABiAQAAYwEAABQBAAAiAAAAZAEAABYBAAAXAQAAGAE="),n(t,13360,"RmFpbGVkIHRvIHBhcnNlIERyYWNvIGhlYWRlci4ATjVkcmFjbzE3UG9pbnRDbG91ZERlY29kZXJFAAAAsDoAAE40AAAAAAAAxDQAABEBAABlAQAAYwEAABQBAABmAQAAZwEAABYBAAAXAQAAGAEAAE41ZHJhY28yM1BvaW50Q2xvdWRLZFRyZWVEZWNvZGVyRQAAANg6AACgNAAAbDQAAAAAAAAkNQAAEQEAAGgBAABjAQAAFAEAAGkBAABqAQAAFgEAABcBAAAYAQAATjVkcmFjbzI3UG9pbnRDbG91ZFNlcXVlbnRpYWxEZWNvZGVyRQAAANg6AAD8NAAAbDQAAAEAAAABAAAAAgAAAAIAAAAEAAAABAAAAAgAAAAIAAAABAAAAAgAAAAB"),n(t,13667,"wAAAAMAAAADAAAAAwP//////////AAAAAKA1AABrAQAAbAEAAG0BAABuAQAATjVkcmFjbzRNZXNoRQAAANg6AACQNQAA5DUAAP////8AAAAAAAAAAOQ1AABvAQAAcAEAAHEBAAByAQAATjVkcmFjbzEwUG9pbnRDbG91ZEUAAAAAsDoAAMw1AADYOwAAGQAKABkZGQAAAAAFAAAAAAAACQAAAAALAAAAAAAAAAAZABEKGRkZAwoHAAEACQsYAAAJBgsAAAsABhkAAAAZGRk="),n(t,13889,"DgAAAAAAAAAAGQAKDRkZGQANAAACAAkOAAAACQAOAAAO"),n(t,13947,"DA=="),n(t,13959,"EwAAAAATAAAAAAkMAAAAAAAMAAAM"),n(t,14005,"EA=="),n(t,14017,"DwAAAAQPAAAAAAkQAAAAAAAQAAAQ"),n(t,14063,"Eg=="),n(t,14075,"EQAAAAARAAAAAAkSAAAAAAASAAASAAAaAAAAGhoa"),n(t,14130,"GgAAABoaGgAAAAAAAAk="),n(t,14179,"FA=="),n(t,14191,"FwAAAAAXAAAAAAkUAAAAAAAUAAAU"),n(t,14237,"Fg=="),n(t,14249,"FQAAAAAVAAAAAAkWAAAAAAAWAAAWAAAwMTIzNDU2Nzg5QUJDREVGAAAAAAIAAAADAAAABQAAAAcAAAALAAAADQAAABEAAAATAAAAFwAAAB0AAAAfAAAAJQAAACkAAAArAAAALwAAADUAAAA7AAAAPQAAAEMAAABHAAAASQAAAE8AAABTAAAAWQAAAGEAAABlAAAAZwAAAGsAAABtAAAAcQAAAH8AAACDAAAAiQAAAIsAAACVAAAAlwAAAJ0AAACjAAAApwAAAK0AAACzAAAAtQAAAL8AAADBAAAAxQAAAMcAAADTAAAAAQAAAAsAAAANAAAAEQAAABMAAAAXAAAAHQAAAB8AAAAlAAAAKQAAACsAAAAvAAAANQAAADsAAAA9AAAAQwAAAEcAAABJAAAATwAAAFMAAABZAAAAYQAAAGUAAABnAAAAawAAAG0AAABxAAAAeQAAAH8AAACDAAAAiQAAAIsAAACPAAAAlQAAAJcAAACdAAAAowAAAKcAAACpAAAArQAAALMAAAC1AAAAuwAAAL8AAADBAAAAxQAAAMcAAADRAAAAMDAwMTAyMDMwNDA1MDYwNzA4MDkxMDExMTIxMzE0MTUxNjE3MTgxOTIwMjEyMjIzMjQyNTI2MjcyODI5MzAzMTMyMzMzNDM1MzYzNzM4Mzk0MDQxNDI0MzQ0NDU0NjQ3NDg0OTUwNTE1MjUzNTQ1NTU2NTc1ODU5NjA2MTYyNjM2NDY1NjY2NzY4Njk3MDcxNzI3Mzc0NzU3Njc3Nzg3OTgwODE4MjgzODQ4NTg2ODc4ODg5OTA5MTkyOTM5NDk1OTY5Nzk4OTk="),n(t,14884,"CgAAAGQAAADoAwAAECcAAKCGAQBAQg8AgJaYAADh9QUAypo7TjEwX19jeHhhYml2MTE2X19zaGltX3R5cGVfaW5mb0UAAAAA2DoAAEg6AADMOwAATjEwX19jeHhhYml2MTE3X19jbGFzc190eXBlX2luZm9FAAAA2DoAAHg6AABsOgAAAAAAAJw6AAB4AQAAeQEAAHoBAAB7AQAAfAEAAH0BAAB+AQAAfwEAAAAAAAAgOwAAeAEAAIABAAB6AQAAewEAAHwBAACBAQAAggEAAIMBAABOMTBfX2N4eGFiaXYxMjBfX3NpX2NsYXNzX3R5cGVfaW5mb0UAAAAA2DoAAPg6AACcOgAAAAAAAFA7AACEAQAAhQEAAIYBAABTdDlleGNlcHRpb24AAAAAsDoAAEA7AAAAAAAAfDsAAA0AAACHAQAAiAEAAFN0MTFsb2dpY19lcnJvcgDYOgAAbDsAAFA7AAAAAAAAsDsAAA0AAACJAQAAiAEAAFN0MTJsZW5ndGhfZXJyb3IAAAAA2DoAAJw7AAB8OwAAU3Q5dHlwZV9pbmZvAAAAALA6AAC8Ow=="),n(t,15320,"BQ=="),n(t,15332,"cwE="),n(t,15356,"dAEAAHUBAABoPQ=="),n(t,15380,"Ag=="),n(t,15396,"//////////8="),n(t,15464,"BQ=="),n(t,15476,"dgE="),n(t,15500,"dAEAAHcBAAB4PQAAAAQ="),n(t,15524,"AQ=="),n(t,15540,"/////wo="),n(t,15608,"IERQ");var Mn,Cn=((Mn=[null,sn,fn,cn,function(e,t){e|=0;var r=0;return!(t=h[88+(t|=0)>>2])|2!=h[t>>2]||(r=e,e=h[t+8>>2],h[r+4>>2]=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,r=1),0|r},function(e,t){e|=0;var r,i=0;h[(t|=0)>>2]=2,i=h[t+8>>2],(r=h[t+12>>2]-i|0)>>>0<=4294967291&&(Ei(t+8|0,r+4|0),i=h[t+8>>2]),t=i+r|0,e=h[e+4>>2],s[0|t]=e,s[t+1|0]=e>>>8,s[t+2|0]=e>>>16,s[t+3|0]=e>>>24},function(e,t,r,i){e|=0,t|=0,r|=0;var n,s=0,o=0,a=0,l=0,c=0,u=0,f=0;if(a=h[80+(i|=0)>>2],N=n=N-48|0,!((e=h[e+4>>2])-31>>>0<4294967267))if(l=h[h[i>>2]>>2]+h[i+48>>2]|0,h[n+16>>2]=e,e=-1<<e,h[n+20>>2]=-1^e,e=-2-e|0,h[n+24>>2]=e,h[n+32>>2]=(0|e)/2,m[n+28>>2]=_(2)/_(0|e),(0|(o=h[r>>2]))==h[r+4>>2])if(a)for(i=0,e=0;c=n+36|0,r=h[h[t>>2]>>2],s=h[t+40>>2],He(c,r+(o=h[t+48>>2]+qr(s,h[t+44>>2],d[t+84|0]?e:h[h[t+68>>2]+(e<<2)>>2],0)|0)|0,s),ut(n+16|0,c,n+12|0,n+8|0),h[(r=i<<2)+l>>2]=h[n+12>>2],h[(4|r)+l>>2]=h[n+8>>2],i=i+2|0,s=1,(0|a)!=(0|(e=e+1|0)););else s=1;else for(e=0,i=0;s=h[(i<<2)+o>>2],a=n+36|0,c=h[h[t>>2]>>2],f=h[t+48>>2],o=h[t+44>>2],u=h[t+40>>2],d[t+84|0]||(s=h[h[t+68>>2]+(s<<2)>>2]),He(a,(s=qr(u,o,s,0)+f|0)+c|0,u),ut(n+16|0,a,n+12|0,n+8|0),h[(o=e<<2)+l>>2]=h[n+12>>2],h[(4|o)+l>>2]=h[n+8>>2],s=1,e=e+2|0,i=i+1|0,o=h[r>>2],i>>>0<h[r+4>>2]-o>>2>>>0;);return N=n+48|0,0|s},ht,function(e,t){t|=0;var r,i=0;return N=r=N-16|0,-1!=(0|(e=h[4+(e|=0)>>2]))&&(s[r+15|0]=e,i=h[t+20>>2],!!h[t+16>>2]&(0|i)>=0|(0|i)>0||Ge(t,h[t+4>>2],r+15|0,r+16|0)),N=r+16|0,-1!=(0|e)|0},Or,function(e,t,r){var i,n,o,a,l,c;return t|=0,r|=0,N=i=N+-64|0,n=0|Cn[h[h[(e|=0)>>2]+44>>2]](e,t),e=0|Cn[h[h[e>>2]+40>>2]](e,t),o=ti(i),a=h[t+56>>2],l=n<<24>>24,c=e,e=(e=e-1|0)>>>0<=10?h[13616+(e<<2)>>2]:-1,di(o,a,l,c,0,e=v(e,n),e>>31),kt(e=Nt(mi(96),o),r),s[e+84|0]=1,h[e+72>>2]=h[e+68>>2],h[e+60>>2]=h[t+60>>2],N=i- -64|0,0|e},Ki,function(e,t){return 2},_i,function(e){var t;return h[(e|=0)>>2]=1140,(t=h[e+8>>2])&&(h[e+12>>2]=t,ve(t)),0|e},function(e){var t;h[(e|=0)>>2]=1140,(t=h[e+8>>2])&&(h[e+12>>2]=t,ve(t)),ve(e)},hn,function(e,t){e|=0;var r=0,i=0,n=0,o=0,a=0,l=0,c=0,u=0,f=0,p=0;if(!(!(r=h[88+(t|=0)>>2])|1!=h[r>>2])){if(i=h[r+8>>2],h[e+4>>2]=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,i=s[t+24|0],n=h[e+8>>2],i>>>0>(o=h[e+12>>2]-n>>2)>>>0?(er(e+8|0,i-o|0),i=s[t+24|0],n=h[e+8>>2]):i>>>0>=o>>>0||(h[e+12>>2]=(i<<2)+n),f=1,o=h[r+8>>2],(0|i)<=0)t=4;else{if(l=3&i,i-1>>>0<3)t=4,i=0;else for(p=-4&i,i=0,t=4;r=t+o|0,h[(a=i<<2)+n>>2]=d[0|r]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[(4|a)+n>>2]=d[r+4|0]|d[r+5|0]<<8|d[r+6|0]<<16|d[r+7|0]<<24,h[(8|a)+n>>2]=d[r+8|0]|d[r+9|0]<<8|d[r+10|0]<<16|d[r+11|0]<<24,h[(12|a)+n>>2]=d[r+12|0]|d[r+13|0]<<8|d[r+14|0]<<16|d[r+15|0]<<24,i=i+4|0,t=t+16|0,(0|p)!=(0|(c=c+4|0)););if(l)for(;r=t+o|0,h[(i<<2)+n>>2]=d[0|r]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,i=i+1|0,t=t+4|0,(0|(u=u+1|0))!=(0|l););}r=e,e=t+o|0,h[r+20>>2]=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24}return 0|f},function(e,t){e|=0;var r,i=0,n=0,o=0,a=0;if(h[(t|=0)>>2]=1,r=t+8|0,i=h[t+8>>2],(n=h[t+12>>2]-i|0)>>>0<=4294967291&&(Ei(r,n+4|0),i=h[r>>2]),i=i+n|0,n=h[e+4>>2],s[0|i]=n,s[i+1|0]=n>>>8,s[i+2|0]=n>>>16,s[i+3|0]=n>>>24,(0|(i=h[e+8>>2]))!=h[e+12>>2])for(n=0;a=(n<<2)+i|0,i=h[t+8>>2],(o=h[t+12>>2]-i|0)>>>0<=4294967291&&(Ei(r,o+4|0),i=h[r>>2]),i=i+o|0,o=h[a>>2],s[0|i]=o,s[i+1|0]=o>>>8,s[i+2|0]=o>>>16,s[i+3|0]=o>>>24,n=n+1|0,i=h[e+8>>2],n>>>0<h[e+12>>2]-i>>2>>>0;);(i=(i=h[t+12>>2])-(t=h[t+8>>2])|0)>>>0<=4294967291&&(Ei(r,i+4|0),t=h[r>>2]),t=t+i|0,e=h[e+20>>2],s[0|t]=e,s[t+1|0]=e>>>8,s[t+2|0]=e>>>16,s[t+3|0]=e>>>24},function(e,t,r,i){e|=0,t|=0,r|=0,i|=0;var n,o=_(0),a=0,l=0,c=0,u=0,f=0,p=_(0),g=0,v=0,y=0,E=0,w=0,A=0,T=0,S=0,M=0,C=0,R=0,I=0,O=0,P=0;if(h[r>>2]==h[r+4>>2]){if(l=h[i+80>>2],N=C=N-16|0,f=h[e+4>>2],c=h[i+48>>2],i=h[h[i>>2]>>2],u=s[t+24|0],h[(r=C+8|0)>>2]=1065353216,M=r,m[r>>2]=_(-1<<f^-1)/m[e+20>>2],R=mi((0|u)!=(1073741823&u)?-1:u<<2),!(!l|(0|u)<=0))if(T=i+c|0,O=h[t>>2],r=h[t+48>>2],P=h[t+44>>2],I=h[t+40>>2],d[t+84|0])for(y=-2&u,S=1&u,t=0;;){if(w=He(R,(c=h[O>>2])+(i=qr(I,P,E,a)+r|0)|0,I),p=m[M>>2],g=h[e+8>>2],i=0,v=0,1!=(0|u))for(;c=T+(t<<2)|0,o=_(x(_(_(p*_(m[(A=i<<2)+w>>2]-m[g+A>>2]))+_(.5)))),f=_(b(o))<_(2147483648)?~~o:-2147483648,h[c>>2]=f,o=_(x(_(_(p*_(m[(f=4|A)+w>>2]-m[g+f>>2]))+_(.5)))),f=_(b(o))<_(2147483648)?~~o:-2147483648,h[c+4>>2]=f,i=i+2|0,t=t+2|0,(0|y)!=(0|(v=v+2|0)););if(S&&(c=T+(t<<2)|0,o=_(x(_(_(p*_(m[(i<<=2)+w>>2]-m[i+g>>2]))+_(.5)))),i=_(b(o))<_(2147483648)?~~o:-2147483648,h[c>>2]=i,t=t+1|0),E=i=E+1|0,!((0|l)!=(0|i)|(a=i?a:a+1|0)))break}else for(y=h[t+68>>2],S=-2&u,f=1&u,t=0;;){if(w=He(R,(a=h[O>>2])+(i=qr(I,P,h[y+(E<<2)>>2],0)+r|0)|0,I),p=m[M>>2],g=h[e+8>>2],i=0,v=0,1!=(0|u))for(;a=T+(t<<2)|0,o=_(x(_(_(p*_(m[(A=i<<2)+w>>2]-m[g+A>>2]))+_(.5)))),c=_(b(o))<_(2147483648)?~~o:-2147483648,h[a>>2]=c,o=_(x(_(_(p*_(m[(c=4|A)+w>>2]-m[g+c>>2]))+_(.5)))),c=_(b(o))<_(2147483648)?~~o:-2147483648,h[a+4>>2]=c,i=i+2|0,t=t+2|0,(0|S)!=(0|(v=v+2|0)););if(f&&(a=T+(t<<2)|0,o=_(x(_(_(p*_(m[(i<<=2)+w>>2]-m[i+g>>2]))+_(.5)))),i=_(b(o))<_(2147483648)?~~o:-2147483648,h[a>>2]=i,t=t+1|0),(0|l)==(0|(E=E+1|0)))break}return ve(R),N=C+16|0,1}if(N=C=N-16|0,M=h[e+4>>2],l=h[i+48>>2],a=h[h[i>>2]>>2],n=s[t+24|0],h[(i=C+8|0)>>2]=1065353216,c=i,m[i>>2]=_(-1<<M^-1)/m[e+20>>2],R=mi((0|n)!=(1073741823&n)?-1:n<<2),O=h[r>>2],!(!(r=h[r+4>>2]-O|0)|(0|n)<=0))if(T=a+l|0,P=h[t>>2],i=h[t+48>>2],I=h[t+44>>2],E=h[t+40>>2],A=(r>>=2)>>>0>1?r:1,d[t+84|0])for(f=-2&n,M=1&n,t=0;;){if(g=He(R,(a=h[P>>2])+(r=qr(E,I,h[O+(v<<2)>>2],0)+i|0)|0,E),p=m[c>>2],y=h[e+8>>2],r=0,u=0,1!=(0|n))for(;a=T+(t<<2)|0,o=_(x(_(_(p*_(m[(S=r<<2)+g>>2]-m[y+S>>2]))+_(.5)))),l=_(b(o))<_(2147483648)?~~o:-2147483648,h[a>>2]=l,o=_(x(_(_(p*_(m[(l=4|S)+g>>2]-m[y+l>>2]))+_(.5)))),l=_(b(o))<_(2147483648)?~~o:-2147483648,h[a+4>>2]=l,r=r+2|0,t=t+2|0,(0|f)!=(0|(u=u+2|0)););if(M&&(a=T+(t<<2)|0,o=_(x(_(_(p*_(m[(r<<=2)+g>>2]-m[r+y>>2]))+_(.5)))),r=_(b(o))<_(2147483648)?~~o:-2147483648,h[a>>2]=r,t=t+1|0),(0|A)==(0|(v=v+1|0)))break}else for(S=h[t+68>>2],f=-2&n,M=1&n,t=0;;){if(w=He(R,(a=h[P>>2])+(r=qr(E,I,h[S+(h[O+(v<<2)>>2]<<2)>>2],0)+i|0)|0,E),p=m[c>>2],g=h[e+8>>2],r=0,u=0,1!=(0|n))for(;a=T+(t<<2)|0,o=_(x(_(_(p*_(m[(y=r<<2)+w>>2]-m[g+y>>2]))+_(.5)))),l=_(b(o))<_(2147483648)?~~o:-2147483648,h[a>>2]=l,o=_(x(_(_(p*_(m[(l=4|y)+w>>2]-m[g+l>>2]))+_(.5)))),l=_(b(o))<_(2147483648)?~~o:-2147483648,h[a+4>>2]=l,r=r+2|0,t=t+2|0,(0|f)!=(0|(u=u+2|0)););if(M&&(a=T+(t<<2)|0,o=_(x(_(_(p*_(m[(r<<=2)+w>>2]-m[r+g>>2]))+_(.5)))),r=_(b(o))<_(2147483648)?~~o:-2147483648,h[a>>2]=r,t=t+1|0),(0|A)==(0|(v=v+1|0)))break}return ve(R),N=C+16|0,1},et,function(e,t){t|=0;var r,i,n=0,o=0;return N=r=N-16|0,-1!=(0|(i=h[4+(e|=0)>>2]))&&(n=h[t+20>>2],!!h[t+16>>2]&(0|n)>=0|(0|n)>0||(Ge(t,h[t+4>>2],h[e+8>>2],h[e+12>>2]),n=h[t+20>>2],!!h[t+16>>2]&(0|n)>=0|(0|n)>0||(n=e+20|0,Ge(t,h[t+4>>2],n,n+4|0),n=h[t+20>>2],o=h[t+16>>2],s[r+15|0]=h[e+4>>2],!!o&(0|n)>=0|(0|n)>0||Ge(t,h[t+4>>2],r+15|0,r+16|0)))),N=r+16|0,-1!=(0|i)|0},st,Ki,function(e,t){return s[24+(t|=0)|0]},function(e){var t=0;return h[(e|=0)>>2]=2012,(t=h[e+16>>2])&&(h[e+20>>2]=t,ve(t)),(t=h[e+4>>2])&&(h[e+8>>2]=t,ve(t)),0|e},gn,function(e,t,r){return t|=0,r|=0,h[32+(e|=0)>>2]=r,h[e+28>>2]=t,1},Me,function(e,t){t|=0;var r=0;return 0|Cn[h[h[(e|=0)>>2]+36>>2]](e,t)&&0|Cn[h[h[e>>2]+40>>2]](e,t)&&(r=0|Cn[h[h[e>>2]+44>>2]](e)),0|r},function(e,t){return t|=0,h[h[4+(e|=0)>>2]+(t<<2)>>2]},function(e){return h[8+(e|=0)>>2]-h[e+4>>2]>>2},Yi,en,Tn,Qi,hn,$t,function(e){ve($t(e|=0))},function(e,t){e|=0;var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0;N=r=N-704|0,_=1;e:{t:{r:{if(!(f[38+(t|=0)>>1]<515||(_=0,(0|(i=h[t+20>>2]))>=(0|(o=h[t+12>>2]))&(n=h[t+16>>2])>>>0>=p[t+8>>2]|(0|i)>(0|o)))){if(y=d[n+h[t>>2]|0],i=(n=n+1|0)?i:i+1|0,h[t+16>>2]=n,h[t+20>>2]=i,b=h[h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]+80>>2],i=0|Cn[h[h[e>>2]+24>>2]](e),h[r+696>>2]=0,h[r+688>>2]=0,h[r+692>>2]=0,i){if(i>>>0>=214748365)break r;n=mi(i=v(i,20)),h[r+688>>2]=n,h[r+696>>2]=i+n,w=r,x=St(n,0,i=v((i-20>>>0)/20|0,20)+20|0)+i|0,h[w+692>>2]=x}i:{if((0|Cn[h[h[e>>2]+24>>2]](e))>0)for(;;){if(i=0|Cn[h[h[e>>2]+20>>2]](e,g),kt(o=h[h[h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]+8>>2]+(i<<2)>>2],b),s[o+84|0]=1,h[o+72>>2]=h[o+68>>2],(i=h[o+28>>2])>>>0>9)break i;n:{s:{o:{if(!(42&(n=1<<i))){if(84&n)break n;if(9!=(0|i))break i;if(i=s[o+24|0],n=ti(r),a=i,i=v(i,h[3409]),di(n,h[o+56>>2],a,6,0,i,i>>31),i=Nt(o=mi(96),n),h[r+656>>2]=o,s[i+84|0]=1,h[i+72>>2]=h[i+68>>2],kt(i,b),(i=h[e+64>>2])>>>0>=p[e+68>>2])break o;n=h[r+656>>2],h[r+656>>2]=0,h[i>>2]=n,n=i+4|0,h[e+64>>2]=n;break s}if(n=0,s[o+24|0]<=0)break n;for(;;){if((i=h[e+52>>2])>>>0<(a=h[e+56>>2])>>>0)h[i>>2]=0,h[e+52>>2]=i+4;else{if((i=1+(u=(m=i-(l=h[e+48>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(E=u<<2,u=(a=a-l|0)>>1,a=a>>>0<2147483644?i>>>0>u>>>0?i:u:1073741823){if(a>>>0>=1073741824)break e;i=mi(a<<2)}else i=0;h[(u=E+i|0)>>2]=0,(0|m)>0&&He(i,l,m),h[e+56>>2]=i+(a<<2),h[e+52>>2]=u+4,h[e+48>>2]=i,l&&ve(l)}if(!((0|(n=n+1|0))<s[o+24|0]))break}break n}n=0;o:{a:{l:{if(o=h[e+60>>2],(i=1+(l=h[e+64>>2]-o>>2)|0)>>>0<1073741824){if(a=(o=h[e+68>>2]-o|0)>>1,o=o>>>0<2147483644?i>>>0>a>>>0?i:a:1073741823){if(o>>>0>=1073741824)break l;n=mi(o<<2)}if(a=h[r+656>>2],h[r+656>>2]=0,h[(i=(l<<2)+n|0)>>2]=a,l=(o<<2)+n|0,a=i+4|0,(0|(n=h[e+64>>2]))==(0|(o=h[e+60>>2])))break a;for(;m=h[(n=n-4|0)>>2],h[n>>2]=0,h[(i=i-4|0)>>2]=m,(0|n)!=(0|o););if(h[e+68>>2]=l,n=h[e+64>>2],h[e+64>>2]=a,o=h[e+60>>2],h[e+60>>2]=i,(0|n)==(0|o))break o;for(;i=h[(n=n-4|0)>>2],h[n>>2]=0,i&&Wr(i),(0|n)!=(0|o););break o}vn(),S()}Zr(1336),S()}h[e+68>>2]=l,h[e+64>>2]=a,h[e+60>>2]=i}o&&ve(o),n=h[e+64>>2]}o=h[n-4>>2],i=h[r+656>>2],h[r+656>>2]=0,i&&Wr(i)}if(n=(i=(l=h[o+28>>2])-1|0)>>>0<=10?h[13616+(i<<2)>>2]:-1,i=h[r+688>>2]+v(g,20)|0,a=s[o+24|0],h[i+16>>2]=a,h[i+12>>2]=(0|n)>0?n:0,h[i+8>>2]=l,h[i+4>>2]=c,h[i>>2]=o,c=a+c|0,g=g+1|0,!((0|Cn[h[h[e>>2]+24>>2]](e))>(0|g)))break}e=yt(r+656|0,r+688|0);n:{s:{o:switch(0|y){case 0:if(t=j(i=Ze(r,c),t,e),Yt(i),t)break s;break n;case 1:if(t=z(i=Ze(r,c),t,e),Yt(i),t)break s;break n;case 2:if(t=W(i=qe(r,c),t,e),Zt(i),t)break s;break n;case 3:if(t=$(i=qe(r,c),t,e),Zt(i),t)break s;break n;case 4:if(t=H(i=J(r,c),t,e),Xt(i),t)break s;break n;case 5:if(t=Y(i=J(r,c),t,e),Xt(i),t)break s;break n;case 6:break o;default:break n}if(t=q(i=J(r,c),t,e),Xt(i),!t)break n}_=1}(t=h[e+16>>2])&&(h[e+20>>2]=t,ve(t)),(t=h[e>>2])&&(h[e+4>>2]=t,ve(t))}(e=h[r+688>>2])&&(h[r+692>>2]=e,ve(e))}return N=r+704|0,0|_}vn(),S()}vn(),S()}Zr(1336),S()},function(e,t){e|=0,t|=0;var r,i,n=0,l=0,c=0,u=0,g=0,b=0,y=0,E=0,w=0,x=0,A=0,T=_(0),M=0,C=0,R=0;N=r=N-720|0;e:{t:{r:{i:{n:{s:{o:{a:{if(f[t+38>>1]>=515){if(h[r+680>>2]=0,h[r+672>>2]=0,h[r+676>>2]=0,(0|Cn[h[h[e>>2]+24>>2]](e))<=0)break i;for(;;){if(n=0|Cn[h[h[e>>2]+20>>2]](e,E),l=h[h[h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]+8>>2]+(n<<2)>>2],9==h[l+28>>2]){if(c=h[r+672>>2],(n=h[r+676>>2]-c>>2)>>>0<(u=s[l+24|0])>>>0?er(r+672|0,u-n|0):n>>>0<=u>>>0||(h[r+676>>2]=c+(u<<2)),g=0,n=h[t+20>>2],b=(y=h[t+16>>2])+(l=u<<2)|0,c=h[t+12>>2],n=l>>>0>b>>>0?n+1|0:n,b>>>0>p[t+8>>2]&(0|c)<=(0|n)|(0|n)>(0|c))break t;if(He(h[r+672>>2],y+h[t>>2]|0,l),n=h[t+20>>2],n=(c=l+h[t+16>>2]|0)>>>0<l>>>0?n+1|0:n,h[t+16>>2]=c,h[t+20>>2]=n,y=w=h[t+12>>2],l=(b=c+4|0)>>>0<4?n+1|0:n,(x=h[t+8>>2])>>>0<b>>>0&(0|l)>=(0|y)|(0|l)>(0|y))break t;if(A=h[t>>2],y=d[0|(y=A+c|0)]|d[y+1|0]<<8|d[y+2|0]<<16|d[y+3|0]<<24,h[t+16>>2]=b,h[t+20>>2]=l,(0|l)>=(0|w)&b>>>0>=x>>>0|(0|l)>(0|w))break t;if(l=d[b+A|0],n=(c=c+5|0)>>>0<5?n+1|0:n,h[t+16>>2]=c,h[t+20>>2]=n,l>>>0>31)break t;if(i=y,o[2]=i,T=a[2],h[r+20>>2]=-1,h[r+16>>2]=1140,h[r+32>>2]=0,h[r+36>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,n=r+16|0,c=h[r+672>>2],(b=l-1|0)>>>0<=29&&(h[n+4>>2]=l,Ft(n+8|0,c,c+(u<<2)|0),m[n+20>>2]=T),!(b>>>0>=30)&&Vr(r+16|0,h[h[e+60>>2]+((h[e+40>>2]-h[e+36>>2]|0)/24<<2)>>2])){if((0|(n=h[e+40>>2]))==h[e+44>>2]){n=0;l:{c:{u:{h:{if((l=1+(c=((u=h[e+40>>2])-(g=h[e+36>>2])|0)/24|0)|0)>>>0<178956971){if(y=(b=(h[e+44>>2]-g|0)/24|0)<<1,b=b>>>0<89478485?l>>>0>y>>>0?l:y:178956970){if(b>>>0>=178956971)break h;n=mi(v(b,24))}if(c=v(c,24)+n|0,h[c>>2]=1140,l=h[r+20>>2],h[c+16>>2]=0,h[c+8>>2]=0,h[c+12>>2]=0,h[c+4>>2]=l,w=h[r+24>>2],l=h[r+28>>2]-w|0){if((0|l)<0)break u;y=mi(l),h[c+8>>2]=y,h[c+16>>2]=y+(l>>2<<2),C=c,R=He(y,w,l)+l|0,h[C+12>>2]=R}if(n=v(b,24)+n|0,m[c+20>>2]=m[r+36>>2],l=c+24|0,(0|u)==(0|g))break c;for(;h[(c=c-24|0)>>2]=1140,h[c+4>>2]=h[u-20>>2],b=u-16|0,h[c+8>>2]=h[b>>2],h[c+12>>2]=h[u-12>>2],y=u-8|0,h[c+16>>2]=h[y>>2],h[y>>2]=0,h[b>>2]=0,h[b+4>>2]=0,m[c+20>>2]=m[u-4>>2],(0|g)!=(0|(u=u-24|0)););if(h[e+44>>2]=n,g=h[e+40>>2],h[e+40>>2]=l,u=h[e+36>>2],h[e+36>>2]=c,(0|u)==(0|g))break l;for(;Cn[h[h[(g=g-24|0)>>2]>>2]](g),(0|u)!=(0|g););break l}vn(),S()}Zr(1336),S()}vn(),S()}h[e+44>>2]=n,h[e+40>>2]=l,h[e+36>>2]=c}u&&ve(u)}else{if(h[n>>2]=1140,l=h[r+20>>2],h[n+16>>2]=0,h[n+8>>2]=0,h[n+12>>2]=0,h[n+4>>2]=l,u=h[r+28>>2]-h[r+24>>2]|0){if((0|u)<0)break a;l=mi(u),h[n+8>>2]=l,h[n+12>>2]=l,h[n+16>>2]=l+(u>>2<<2),c=h[r+24>>2],(0|(u=h[r+28>>2]-c|0))>0&&(l=He(l,c,u)+u|0),h[n+12>>2]=l}m[n+20>>2]=m[r+36>>2],h[e+40>>2]=n+24}g=1}if(h[r+16>>2]=1140,(n=h[r+24>>2])&&(h[r+28>>2]=n,ve(n)),!g)break r}if(E=E+1|0,!((0|Cn[h[h[e>>2]+24>>2]](e))>(0|E)))break}break i}if(b=0|Cn[h[h[e>>2]+24>>2]](e),h[r+712>>2]=0,h[r+704>>2]=0,h[r+708>>2]=0,b){if(b>>>0>=214748365)break o;for(l=mi(n=v(b,20)),h[r+704>>2]=l,h[r+712>>2]=n+l,C=r,R=St(l,0,n=v((n-20>>>0)/20|0,20)+20|0)+n|0,h[C+708>>2]=R;;){if(n=0|Cn[h[h[e>>2]+20>>2]](e,E),l=h[h[h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]+8>>2]+(n<<2)>>2],(y=(0|(n=(n=(u=h[l+28>>2])-1|0)>>>0<=10?h[13616+(n<<2)>>2]:-1))>0?n:0)>>>0>4)break n;if(n=h[r+704>>2]+v(E,20)|0,w=s[l+24|0],h[n+16>>2]=w,h[n+12>>2]=y,h[n+8>>2]=u,h[n+4>>2]=c,h[n>>2]=l,c=c+w|0,(0|b)==(0|(E=E+1|0)))break}}if(n=0|Cn[h[h[e>>2]+20>>2]](e,0),x=h[h[h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]+8>>2]+(n<<2)>>2],s[x+84|0]=1,h[x+72>>2]=h[x+68>>2],(0|(n=u=h[t+12>>2]))<=(0|(l=h[t+20>>2]))&(y=h[t+8>>2])>>>0<=(E=h[t+16>>2])>>>0|(0|n)<(0|l))break n;A=h[t>>2],M=d[A+E|0],n=l,n=(w=E+1|0)?n:n+1|0,h[t+16>>2]=w,h[t+20>>2]=n;l:switch(0|M){case 0:if(!(y>>>0<=w>>>0&(0|n)>=(0|u)|(0|n)>(0|u)||(n=l,n=(e=E+2|0)>>>0<2?n+1|0:n,h[t+16>>2]=e,h[t+20>>2]=n,n=l,(l=E+6|0)>>>0>y>>>0&(0|(n=l>>>0<6?n+1|0:n))>=(0|u)|(0|n)>(0|u)))){e=d[0|(e=e+A|0)]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,h[t+16>>2]=l,h[t+20>>2]=n,kt(x,e),h[20+(g=r+672|0)>>2]=0,h[g+12>>2]=0,h[g+16>>2]=0,h[g>>2]=0,h[g+4>>2]=0,h[g+20>>2]=e,E=yt(r+16|0,r+704|0),u=0,N=c=N-32|0,h[c+24>>2]=0,h[c+16>>2]=0,h[c+20>>2]=0,y=e=h[t+12>>2],l=n=h[t+20>>2],n=(b=(w=h[t+16>>2])+4|0)>>>0<4?n+1|0:n;c:if(!((x=h[t+8>>2])>>>0<b>>>0&(0|e)<=(0|n)|(0|e)<(0|n))){A=h[t>>2],e=d[0|(e=A+w|0)]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24,h[t+16>>2]=b,h[t+20>>2]=n;u:{switch(e-2|0){case 1:if((0|n)>=(0|y)&b>>>0>=x>>>0|(0|n)>(0|y))break c;if(e=s[b+A|0],n=l,n=(l=w+5|0)>>>0<5?n+1|0:n,h[t+16>>2]=l,h[t+20>>2]=n,h[g+8>>2]=e,1==(0|e)){if(D(g,t,c+16|0))break u;break c}Li(1943,23,h[3451]);break c;default:Li(1918,24,h[3451]);break c;case 0:}if(!D(g,t,c+16|0))break c}if(h[c+8>>2]=h[c+16>>2],h[c>>2]=h[c+20>>2],N=e=N-32|0,t=h[g>>2],T=m[g+4>>2],h[(u=e+24|0)>>2]=1065353216,(0|(t=-1<<t^-1))>0&&(m[u>>2]=T/_(0|t)),(0|(g=h[c+8>>2]))!=h[c>>2])for(n=h[E+28>>2];l=h[g>>2],b=h[g+4>>2],T=m[u>>2],m[e+16>>2]=T*_(h[g+8>>2]-t|0),m[e+12>>2]=T*_(b-t|0),m[e+8>>2]=T*_(l-t|0),b=h[E+16>>2],l=h[b>>2],d[l+84|0]||(n=h[h[l+68>>2]+(n<<2)>>2]),y=n,n=h[l+40>>2],He(h[h[l>>2]>>2]+v(y,n)|0,(e+8|0)+(h[b+4>>2]<<2)|0,n),n=h[E+28>>2]+1|0,h[E+28>>2]=n,(0|(g=g+12|0))!=h[c>>2];);N=e+32|0,u=1}if((e=h[c+16>>2])&&(h[c+20>>2]=e,ve(e)),N=c+32|0,Ti(E),g=1,u)break n}g=0;break n;case 1:break l;default:break n}if(y>>>0<=w>>>0&(0|n)>=(0|u)|(0|n)>(0|u))break n;if(w=d[w+A|0],n=l,n=(x=E+2|0)>>>0<2?n+1|0:n,h[t+16>>2]=x,h[t+20>>2]=n,w>>>0>=7){h[r>>2]=w,Bt(1795,r);break n}if(n=l,E=l=E+6|0,l>>>0>y>>>0&(0|(n=l>>>0<6?n+1|0:n))>=(0|u)|(0|n)>(0|u))break n;if(l=d[0|(l=x+A|0)]|d[l+1|0]<<8|d[l+2|0]<<16|d[l+3|0]<<24,h[t+16>>2]=E,h[t+20>>2]=n,b)for(E=0;n=0|Cn[h[h[e>>2]+20>>2]](e,E),kt(n=h[h[h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]+8>>2]+(n<<2)>>2],l),s[n+84|0]=1,h[n+72>>2]=h[n+68>>2],(0|b)!=(0|(E=E+1|0)););e=yt(r+672|0,r+704|0);l:{c:switch(0|w){case 1:if(t=z(n=Ze(r+16|0,c),t,e),Yt(n),!t)break s;break l;case 2:if(t=W(n=qe(r+16|0,c),t,e),Zt(n),!t)break s;break l;case 3:if(t=$(n=qe(r+16|0,c),t,e),Zt(n),!t)break s;break l;case 4:if(t=H(n=J(r+16|0,c),t,e),Xt(n),!t)break s;break l;case 5:if(t=Y(n=J(r+16|0,c),t,e),Xt(n),!t)break s;break l;case 6:if(t=q(n=J(r+16|0,c),t,e),Xt(n),t)break l;break s;case 0:break c;default:break s}if(t=j(n=Ze(r+16|0,c),t,e),Yt(n),!t)break s}Ti(e),g=1;break n}vn(),S()}vn(),S()}Ti(e)}if(!(e=h[r+704>>2]))break e;h[r+708>>2]=e,ve(e);break e}if(h[e+52>>2]==h[e+48>>2]){g=1;break t}for(E=0;;){if(!_r(1,r+16|0,t))break r;if(g=1,n=h[e+48>>2],l=h[r+16>>2],h[n+(E<<2)>>2]=l>>>1^0-(1&l),!((E=E+1|0)>>>0<h[e+52>>2]-n>>2>>>0))break}break t}g=0}(e=h[r+672>>2])&&(h[r+676>>2]=e,ve(e))}return N=r+720|0,0|g},function(e){e|=0;var t,r=0,i=0,n=0,o=0,a=0,l=0,c=0,g=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=_(0),k=0;N=t=N-32|0;e:if(h[e+60>>2]!=h[e- -64>>2]|h[e+48>>2]!=h[e+52>>2]){if(b=1,!((0|Cn[h[h[e>>2]+24>>2]](e))<=0)){t:{r:{for(;;){i:{i=0|Cn[h[h[e>>2]+20>>2]](e,k);n:{s:{o:switch(a=h[h[h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]+8>>2]+(i<<2)>>2],h[a+28>>2]-1|0){case 8:break s;case 0:case 2:case 4:break o;default:break n}if(i=s[a+24|0],h[t+24>>2]=0,h[t+16>>2]=0,h[t+20>>2]=0,i){if((0|i)<0)break i;if(b=mi(i<<=2),h[t+16>>2]=b,r=i+b|0,h[t+24>>2]=r,E=0,St(b,0,i),h[t+20>>2]=r,i=s[a+24|0],h[t+8>>2]=0,h[t>>2]=0,h[t+4>>2]=0,i){if((0|i)<0)break r;E=mi(i<<=2),h[t>>2]=E,St(E,0,i)}}else b=0,h[t>>2]=0,E=0;o:{a:switch(h[a+28>>2]-1|0){case 4:o=0,c=0,w=0,i=0,N=g=N-16|0,n=s[a+24|0],h[g+8>>2]=0,h[g>>2]=0,h[g+4>>2]=0;l:{c:{if(n){if((0|n)<0)break c;c=mi(r=n<<2),h[g>>2]=c,h[g+8>>2]=r+c,St(c,0,r),St(o=mi(r),0,r)}if(!h[a+80>>2])break l;for(;;){if(I=h[a>>2],M=h[I>>2],r=h[a+40>>2],y=He(c,M+(y=h[a+48>>2]+qr(r,h[a+44>>2],w,i)|0)|0,r),!((0|(x=n<<24>>24))<=0)){if(A=h[e+48>>2],l=0,1!=(255&n))for(O=-2&x,n=0;h[(T=l<<2)+o>>2]=h[A+(l+R<<2)>>2]+h[y+T>>2],h[(M=(T=1|l)<<2)+o>>2]=h[A+(R+T<<2)>>2]+h[y+M>>2],l=l+2|0,(0|O)!=(0|(n=n+2|0)););1&x&&(h[(n=l<<2)+o>>2]=h[A+(l+R<<2)>>2]+h[n+y>>2])}if(He(h[I>>2]+v(r,w)|0,o,r),w=r=w+1|0,!(i=r?i:i+1|0)&p[a+80>>2]<=r>>>0|i)break l;n=d[a+24|0]}}vn(),S()}o&&ve(o),c&&ve(c),N=g+16|0;break o;case 2:o=0,c=0,w=0,i=0,N=g=N-16|0,n=s[a+24|0],h[g+8>>2]=0,h[g>>2]=0,h[g+4>>2]=0;l:{c:{if(n){if((0|n)<0)break c;c=mi(r=n<<1),h[g>>2]=c,h[g+8>>2]=r+c,St(c,0,r),St(o=mi(r),0,r)}if(!h[a+80>>2])break l;for(;;){if(I=h[a>>2],M=h[I>>2],r=h[a+40>>2],y=He(c,M+(y=h[a+48>>2]+qr(r,h[a+44>>2],w,i)|0)|0,r),!((0|(x=n<<24>>24))<=0)){if(A=h[e+48>>2],l=0,1!=(255&n))for(O=-2&x,n=0;u[(T=l<<1)+o>>1]=f[y+T>>1]+f[A+(l+R<<2)>>1],u[(M=(T=1|l)<<1)+o>>1]=f[y+M>>1]+f[A+(R+T<<2)>>1],l=l+2|0,(0|O)!=(0|(n=n+2|0)););1&x&&(u[(n=l<<1)+o>>1]=f[n+y>>1]+f[A+(l+R<<2)>>1])}if(He(h[I>>2]+v(r,w)|0,o,r),w=r=w+1|0,!(i=r?i:i+1|0)&p[a+80>>2]<=r>>>0|i)break l;n=d[a+24|0]}}vn(),S()}o&&ve(o),c&&ve(c),N=g+16|0;break o;case 0:break a;default:break o}o=0,l=0,w=0,i=0,N=c=N-16|0,r=s[a+24|0],h[c+8>>2]=0,h[c>>2]=0,h[c+4>>2]=0;a:{l:{if(r){if((0|r)<0)break l;l=mi(r),h[c>>2]=l,h[c+8>>2]=r+l,St(l,0,r),St(o=mi(r),0,r)}if(h[a+80>>2])for(;;){if(M=h[h[a>>2]>>2],g=h[a+40>>2],r=He(l,M+(r=h[a+48>>2]+qr(g,h[a+44>>2],w,i)|0)|0,g),!((0|(y=s[a+24|0]))<=0)){if(A=h[e+48>>2],n=0,1!=(0|y))for(I=-2&y,g=0;s[n+o|0]=d[r+n|0]+d[A+(n+R<<2)|0],s[(x=1|n)+o|0]=d[r+x|0]+d[A+(x+R<<2)|0],n=n+2|0,(0|I)!=(0|(g=g+2|0)););1&y&&(s[n+o|0]=d[r+n|0]+d[A+(n+R<<2)|0])}if(r=h[a+40>>2],He(h[h[a>>2]>>2]+v(r,w)|0,o,r),w=r=w+1|0,!(!(i=r?i:i+1|0)&p[a+80>>2]>r>>>0))break}o&&ve(o),l&&ve(l),N=c+16|0;break a}vn(),S()}}if(R=s[a+24|0]+R|0,i=1,E&&ve(E),b&&ve(b),i)break n;b=0;break e}if(l=h[h[e+60>>2]+(C<<2)>>2],o=h[e+36>>2],b=h[40+(0|Cn[h[h[e>>2]+28>>2]](e))>>2],h[t>>2]=h[a+56>>2],i=mi(32),h[t+16>>2]=i,h[t+20>>2]=24,h[t+24>>2]=-2147483616,s[i+24|0]=0,r=d[1318]|d[1319]<<8|d[1320]<<16|d[1321]<<24,n=d[1314]|d[1315]<<8|d[1316]<<16|d[1317]<<24,s[i+16|0]=n,s[i+17|0]=n>>>8,s[i+18|0]=n>>>16,s[i+19|0]=n>>>24,s[i+20|0]=r,s[i+21|0]=r>>>8,s[i+22|0]=r>>>16,s[i+23|0]=r>>>24,r=d[1310]|d[1311]<<8|d[1312]<<16|d[1313]<<24,n=d[1306]|d[1307]<<8|d[1308]<<16|d[1309]<<24,s[i+8|0]=n,s[i+9|0]=n>>>8,s[i+10|0]=n>>>16,s[i+11|0]=n>>>24,s[i+12|0]=r,s[i+13|0]=r>>>8,s[i+14|0]=r>>>16,s[i+15|0]=r>>>24,r=d[1302]|d[1303]<<8|d[1304]<<16|d[1305]<<24,n=d[1298]|d[1299]<<8|d[1300]<<16|d[1301]<<24,s[0|i]=n,s[i+1|0]=n>>>8,s[i+2|0]=n>>>16,s[i+3|0]=n>>>24,s[i+4|0]=r,s[i+5|0]=r>>>8,s[i+6|0]=r>>>16,s[i+7|0]=r>>>24,r=Ct(b,t,t+16|0),s[t+27|0]<0&&ve(h[t+16>>2]),i=C+1|0,r)Ne(a,l);else{if(c=o+v(C,24)|0,o=h[c+4>>2],n=(C=s[a+24|0])<<2,r=mi((0|C)!=(1073741823&C)?-1:n),h[t+16>>2]=1065353216,P=m[c+20>>2],(0|(o=-1<<o^-1))>0&&(m[t+16>>2]=P/_(0|o)),(0|o)<=0)break t;if(h[l+80>>2])if((0|C)<=0)for(E=0,b=0;He(h[h[a+64>>2]>>2]+b|0,r,n),b=n+b|0,(E=E+1|0)>>>0<p[l+80>>2];);else for(y=h[h[l>>2]>>2]+h[l+48>>2]|0,I=-2&C,O=1&C,g=0,o=0,b=0;;){if(w=h[c+8>>2],P=m[t+16>>2],E=0,A=0,1!=(0|C))for(;T=y+(b<<2)|0,m[(x=E<<2)+r>>2]=_(P*_(h[T>>2]))+m[w+x>>2],m[(x|=4)+r>>2]=_(P*_(h[T+4>>2]))+m[w+x>>2],E=E+2|0,b=b+2|0,(0|I)!=(0|(A=A+2|0)););if(O&&(m[(E<<=2)+r>>2]=_(P*_(h[y+(b<<2)>>2]))+m[w+E>>2],b=b+1|0),He(h[h[a+64>>2]>>2]+o|0,r,n),o=n+o|0,!((g=g+1|0)>>>0<p[l+80>>2]))break}ve(r)}C=i}if(b=1,k=k+1|0,(0|Cn[h[h[e>>2]+24>>2]](e))>(0|k))continue;break e}break}vn(),S()}vn(),S()}ve(r),b=0}}else b=1;return N=t+32|0,0|b},function(e){var t;return h[(e|=0)>>2]=2260,t=h[e+16>>2],h[e+16>>2]=0,t&&Wr(t),0|e},function(e){var t;h[(e|=0)>>2]=2260,t=h[e+16>>2],h[e+16>>2]=0,t&&Wr(t),ve(e)},bi,function(e,t){return t|=0,h[12+(e|=0)>>2]=-1,h[e+8>>2]=t,1},function(e,t,r){t|=0,r|=0;var i,n=0;return i=h[8+(e|=0)>>2],s[i+24|0]<=0||kt(i,h[t+4>>2]-h[t>>2]>>2)&&(n=0|Cn[h[h[e>>2]+32>>2]](e,t,r)),0|n},function(e,t,r){return 1},Qi,function(e,t){e|=0;var r=0,i=0,n=0,s=0,o=0,a=0;s=1;e:if(!((0|Cn[h[h[(t|=0)>>2]+20>>2]](t))<=0))for(;;){if(s=0,-1==(0|(r=hi(h[h[e+4>>2]+4>>2],0|Cn[h[h[t>>2]+24>>2]](t,o)))))break e;n=h[e+4>>2];t:{if(d[n+36|0]<=1){if(0|Cn[h[h[t>>2]+28>>2]](t,h[h[h[n+4>>2]+8>>2]+(r<<2)>>2]))break t;break e}if(i=0,(0|r)<0||(a=h[n+4>>2],h[a+12>>2]-h[a+8>>2]>>2<=(0|r)||(i=h[h[n+8>>2]+(h[h[n+20>>2]+(r<<2)>>2]<<2)>>2],i=0|Cn[h[h[i>>2]+32>>2]](i,r))),!i)break e;if(!(0|Cn[h[h[t>>2]+28>>2]](t,i)))break e}if(s=1,o=o+1|0,!((0|Cn[h[h[t>>2]+20>>2]](t))>(0|o)))break}return 0|s},function(e,t,r){e|=0,r|=0;var i,n,s=0,o=0,a=0,l=0,c=0,u=0,d=0,f=0;if(s=h[(t|=0)>>2],t=h[t+4>>2],n=mi((0|(i=h[h[e+8>>2]+40>>2]))>=0?i:-1),a=1,!((0|(l=t-s|0))<=0||(t=0,a=0,s=0+h[r+20>>2]|0,s=(o=i+(c=h[r+16>>2])|0)>>>0<i>>>0?s+1|0:s,u=o,o=h[r+12>>2],u>>>0>p[r+8>>2]&(0|o)<=(0|s)|(0|s)>(0|o)))){for(a=(0|(d=l>>2))>1?d:1;o=He(n,c+h[r>>2]|0,i),h[r+16>>2]=u,h[r+20>>2]=s,He(h[h[h[e+8>>2]+64>>2]>>2]+t|0,o,i),(0|a)!=(0|(f=f+1|0))&&(t=t+i|0,s=0+h[r+20>>2]|0,s=(o=i+(c=h[r+16>>2])|0)>>>0<i>>>0?s+1|0:s,u=o,l=o,(0|(o=h[r+12>>2]))>=(0|s)&p[r+8>>2]>=l>>>0|(0|s)<(0|o)););a=(0|f)>=(0|d)}return ve(n),0|a},function(e){var t,r=0,i=0;if(h[(e|=0)>>2]=2356,r=h[e+60>>2],h[e+60>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(r=h[e+48>>2])&&(h[e+52>>2]=r,ve(r)),t=h[e+36>>2]){if((0|(i=h[e+40>>2]))==(0|t))r=t;else{for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(0|t)!=(0|i););r=h[e+36>>2]}h[e+40>>2]=t,ve(r)}return h[e>>2]=2012,(r=h[e+16>>2])&&(h[e+20>>2]=r,ve(r)),(r=h[e+4>>2])&&(h[e+8>>2]=r,ve(r)),0|e},function(e){var t,r=0,i=0;if(h[(e|=0)>>2]=2356,r=h[e+60>>2],h[e+60>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(r=h[e+48>>2])&&(h[e+52>>2]=r,ve(r)),t=h[e+36>>2]){if((0|(i=h[e+40>>2]))==(0|t))r=t;else{for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(0|t)!=(0|i););r=h[e+36>>2]}h[e+40>>2]=t,ve(r)}h[e>>2]=2012,(r=h[e+16>>2])&&(h[e+20>>2]=r,ve(r)),(r=h[e+4>>2])&&(h[e+8>>2]=r,ve(r)),ve(e)},function(e,t){var r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0;if(Me(e|=0,t|=0)){if(l=e+36|0,(o=0|Cn[h[h[e>>2]+24>>2]](e))>>>0>(r=(i=h[e+40>>2])-(n=h[e+36>>2])>>2)>>>0)At(l,o-r|0);else if(!(r>>>0<=o>>>0)){if((0|(n=n+(o<<2)|0))!=(0|i))for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(0|i)!=(0|n););h[e+40>>2]=n}e:if((0|o)<=0)n=0;else if(n=1,!((0|(r=h[t+20>>2]))>=(0|(i=h[t+12>>2]))&(s=h[t+16>>2])>>>0>=p[t+8>>2]|(0|r)>(0|i)))for(i=0;;){if(a=d[s+h[t>>2]|0],r=(s=s+1|0)?r:r+1|0,h[t+16>>2]=s,h[t+20>>2]=r,s=0|Cn[h[h[e>>2]+48>>2]](e,a),c=(a=i<<2)+h[e+36>>2]|0,r=h[c>>2],h[c>>2]=s,r&&Cn[h[h[r>>2]+4>>2]](r),!(r=h[h[l>>2]+a>>2]))break e;if(f=r,m=0|Cn[h[h[e>>2]+28>>2]](e),g=0|Cn[h[h[e>>2]+20>>2]](e,i),u=h[h[r>>2]+8>>2],!(0|Cn[u](0|f,0|m,0|g)))break e;if(n=(0|o)>(0|(i=i+1|0)),(0|i)==(0|o))break e;if(s=h[t+16>>2],r=h[t+20>>2],a=h[t+12>>2],!(s>>>0<p[t+8>>2]&(0|r)<=(0|a)|(0|r)<(0|a)))break}e=!n}else e=0;return 0|e},function(e,t){t|=0;var r=0,i=0,n=0,s=0,o=0;if((r=h[60+(e|=0)>>2])&&(h[r+4>>2]=e+48,0|Cn[h[h[r>>2]+12>>2]](r))){e:if(!((0|(r=0|Cn[h[h[e>>2]+24>>2]](e)))<=0)){for(;;){if(s=h[4+(0|Cn[h[h[e>>2]+28>>2]](e))>>2],o=0|Cn[h[h[e>>2]+20>>2]](e,i),n=h[e+60>>2],0|Cn[h[h[n>>2]+8>>2]](n,h[h[s+8>>2]+(o<<2)>>2])){if((0|r)!=(0|(i=i+1|0)))continue;break e}break}return 0}i=0,0|Cn[h[h[e>>2]+36>>2]](e,t)&&0|Cn[h[h[e>>2]+40>>2]](e,t)&&(i=0|Cn[h[h[e>>2]+44>>2]](e))}return 0|i},function(e,t){t|=0;var r,i=0;return r=h[16+(e|=0)>>2],i=0,h[e+20>>2]-r>>2<=(0|t)||(i=0,(0|(t=h[(t<<2)+r>>2]))<0||(i=zt(h[h[e+36>>2]+(t<<2)>>2]))),0|i},function(e,t){t|=0;var r,i=0,n=0,s=0,o=0;if(i=1,!((0|(r=0|Cn[h[h[(e|=0)>>2]+24>>2]](e)))<=0)&&(n=h[h[e+36>>2]>>2],s=e+48|0,i=0,0|Cn[h[h[n>>2]+16>>2]](n,s,t))){for(n=1;(0|r)!=(0|(i=n))&&(n=i+1|0,o=h[h[e+36>>2]+(i<<2)>>2],0|Cn[h[h[o>>2]+16>>2]](o,s,t)););i=(0|i)>=(0|r)}return 0|i},function(e,t){t|=0;var r,i=0,n=0,s=0,o=0;if(i=1,!((0|(r=0|Cn[h[h[(e|=0)>>2]+24>>2]](e)))<=0)&&(n=h[h[e+36>>2]>>2],s=e+48|0,i=0,0|Cn[h[h[n>>2]+20>>2]](n,s,t))){for(n=1;(0|r)!=(0|(i=n))&&(n=i+1|0,o=h[h[e+36>>2]+(i<<2)>>2],0|Cn[h[h[o>>2]+20>>2]](o,s,t)););i=(0|i)>=(0|r)}return 0|i},function(e){var t,r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,f=0,p=0;N=t=N-16|0,c=1;e:if((0|(r=0|Cn[h[h[(e|=0)>>2]+24>>2]](e)))<=0)c=0;else for(p=e+48|0;;){if(h[40+(0|Cn[h[h[e>>2]+28>>2]](e))>>2]&&(l=h[(u=a<<2)+h[e+36>>2]>>2],i=h[l+8>>2],(f=zt(l))&&(l=h[40+(0|Cn[h[h[e>>2]+28>>2]](e))>>2],h[t+12>>2]=h[i+56>>2],i=mi(32),h[t>>2]=i,h[t+4>>2]=24,h[t+8>>2]=-2147483616,s[i+24|0]=0,n=d[1318]|d[1319]<<8|d[1320]<<16|d[1321]<<24,o=d[1314]|d[1315]<<8|d[1316]<<16|d[1317]<<24,s[i+16|0]=o,s[i+17|0]=o>>>8,s[i+18|0]=o>>>16,s[i+19|0]=o>>>24,s[i+20|0]=n,s[i+21|0]=n>>>8,s[i+22|0]=n>>>16,s[i+23|0]=n>>>24,n=d[1310]|d[1311]<<8|d[1312]<<16|d[1313]<<24,o=d[1306]|d[1307]<<8|d[1308]<<16|d[1309]<<24,s[i+8|0]=o,s[i+9|0]=o>>>8,s[i+10|0]=o>>>16,s[i+11|0]=o>>>24,s[i+12|0]=n,s[i+13|0]=n>>>8,s[i+14|0]=n>>>16,s[i+15|0]=n>>>24,n=d[1302]|d[1303]<<8|d[1304]<<16|d[1305]<<24,o=d[1298]|d[1299]<<8|d[1300]<<16|d[1301]<<24,s[0|i]=o,s[i+1|0]=o>>>8,s[i+2|0]=o>>>16,s[i+3|0]=o>>>24,s[i+4|0]=n,s[i+5|0]=n>>>8,s[i+6|0]=n>>>16,s[i+7|0]=n>>>24,i=Ct(l,t+12|0,t),s[t+11|0]<0&&ve(h[t>>2]),i)))Ne(h[h[h[e+36>>2]+u>>2]+8>>2],f);else if(i=h[h[e+36>>2]+(a<<2)>>2],!(0|Cn[h[h[i>>2]+24>>2]](i,p)))break e;if(c=(0|r)>(0|(a=a+1|0)),(0|a)==(0|r))break}return N=t+16|0,1&(-1^c)},function(e,t){switch(e|=0,e=0,0|(t|=0)){case 0:return e=mi(20),h[e+12>>2]=-1,h[e+16>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=2260,0|e;case 1:return e=mi(24),h[e+12>>2]=-1,h[e+16>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=2260,h[e+20>>2]=0,h[e>>2]=2476,0|e;case 2:return e=mi(48),h[e+12>>2]=-1,h[e+16>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=2260,h[e+20>>2]=0,h[e>>2]=2476,h[e+32>>2]=0,h[e+36>>2]=0,h[e+28>>2]=-1,h[e+24>>2]=1140,h[e>>2]=11076,h[e+40>>2]=0,h[e+44>>2]=0,0|e;case 3:e=mi(32),h[e+12>>2]=-1,h[e+16>>2]=0,h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=2260,h[e+20>>2]=0,h[e>>2]=2476,h[e+28>>2]=-1,h[e+24>>2]=1032,h[e>>2]=7056}return 0|e},ai,ui,bi,function(e,t){t|=0;var r,i=0;return(r=h[4+(e|=0)>>2])&&(i=1,d[r+36|0]<2)||(i=0|Cn[h[h[e>>2]+48>>2]](e,h[t+4>>2]-h[t>>2]>>2)),0|i},function(e,t,r){e|=0,t|=0;var i,n,o=0,a=0,l=0,c=0,u=0,f=0,p=0;e:if(!((0|(o=i=h[12+(r|=0)>>2]))<=(0|(a=h[r+20>>2]))&(n=h[r+8>>2])>>>0<=(l=h[r+16>>2])>>>0|(0|o)<(0|a))){if(u=h[r>>2],f=s[u+l|0],o=a,o=(c=l+1|0)?o:o+1|0,h[r+16>>2]=c,h[r+20>>2]=o,-2!=(0|f)){if((0|o)>=(0|i)&c>>>0>=n>>>0|(0|o)>(0|i))break e;if(o=s[c+u|0],a=(l=l+2|0)>>>0<2?a+1|0:a,h[r+16>>2]=l,h[r+20>>2]=a,(o-4&255)>>>0<251)break e;a=0|Cn[h[h[e>>2]+40>>2]](e,f,o),o=h[e+20>>2],h[e+20>>2]=a,o&&Cn[h[h[o>>2]+4>>2]](o)}(!(o=h[e+20>>2])||0|Cn[h[h[e>>2]+28>>2]](e,o))&&0|Cn[h[h[e>>2]+36>>2]](e,t,r)&&(!(r=h[e+4>>2])|d[r+36|0]>1||0|Cn[h[h[e>>2]+48>>2]](e,h[t+4>>2]-h[t>>2]>>2))&&(p=1)}return 0|p},Te,function(e,t,r){e|=0,t|=0;var i,n=0,o=0,a=0,l=0,c=0,u=0,d=0,p=0,m=0,g=0,v=0;if(N=i=N-48|0,1==(0|(r|=0))){a=h[e+4>>2],u=h[e+12>>2],h[i+40>>2]=0,h[i+32>>2]=0,h[i+36>>2]=0,h[i+24>>2]=0,h[i+28>>2]=0,h[i+16>>2]=0,h[i+20>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0,o=i+8|0;e:if(-2!=(0|t)){if(m=h[h[h[a+4>>2]+8>>2]+(u<<2)>>2],1==(0|Cn[h[h[a>>2]+8>>2]](a))){if(p=65535&((e=f[a+36>>1])<<8|e>>>8),e=0,N=d=N-32|0,l=h[h[h[a+4>>2]+8>>2]+(u<<2)>>2],!(1!=(0|Cn[h[h[a>>2]+8>>2]](a))|t-1>>>0>5||!(n=0|Cn[h[h[a>>2]+36>>2]](a))|!(c=0|Cn[h[h[a>>2]+44>>2]](a,u))))if(r=0|Cn[h[h[a>>2]+40>>2]](a,u)){e=h[a+44>>2],h[d+12>>2]=r,h[d+8>>2]=e,h[d+20>>2]=c,h[d+16>>2]=c+12,a=d+8|0,e=0;t:{r:{i:switch(t-1|0){case 0:if(e=mi(60),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e>>2]=2592;break t;case 1:if(e=mi(60),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e>>2]=3356;break t;case 3:if(e=mi(112),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e+60>>2]=0,h[e+64>>2]=0,h[e>>2]=3592,h[e+68>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+84>>2]=0,h[e+88>>2]=0,h[e+92>>2]=0,h[e+96>>2]=0,h[e+100>>2]=0,h[e+104>>2]=0,h[e+108>>2]=0;break t;case 2:if(e=mi(92),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e+60>>2]=0,h[e+64>>2]=0,h[e>>2]=3840,h[e+68>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+84>>2]=0,h[e+88>>2]=p;break t;case 4:if(e=mi(104),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,r=h[a+8>>2],t=h[a+12>>2],h[e+84>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+60>>2]=0,h[e+64>>2]=0,h[e>>2]=4068,h[e+52>>2]=r,h[e+56>>2]=t,t=h[a+4>>2],h[e+88>>2]=h[a>>2],h[e+92>>2]=t,t=h[a+12>>2],h[e+96>>2]=h[a+8>>2],h[e+100>>2]=t;break t;case 5:break i;default:break t}e=mi(128),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t;i:{n:{if(r=h[o+28>>2]-h[o+24>>2]|0){if((0|r)<0)break n;t=mi(r),h[e+32>>2]=t,h[e+36>>2]=t,h[e+40>>2]=t+(r>>2<<2),r=h[o+24>>2],(0|(n=h[o+28>>2]-r|0))>0&&(t=He(t,r,n)+n|0),h[e+36>>2]=t}h[e>>2]=3244,t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[(t=e- -64|0)>>2]=0,h[t+4>>2]=0,h[e+60>>2]=4932,h[e>>2]=4304,t=h[a+4>>2],h[e+72>>2]=h[a>>2],h[e+76>>2]=t,t=h[a+12>>2],h[e+80>>2]=h[a+8>>2],h[e+84>>2]=t,h[e+104>>2]=1065353216,h[e+108>>2]=-1,h[e+96>>2]=-1,h[e+100>>2]=-1,h[e+88>>2]=1,h[e+92>>2]=-1,h[e+60>>2]=4540,h[e+112>>2]=0,h[e+116>>2]=0,s[e+117|0]=0,s[e+118|0]=0,s[e+119|0]=0,s[e+120|0]=0,s[e+121|0]=0,s[e+122|0]=0,s[e+123|0]=0,s[e+124|0]=0;break i}vn(),S()}break t}vn(),S()}}else{e=h[a+44>>2],h[d+12>>2]=n,h[d+8>>2]=e,h[d+20>>2]=c,h[d+16>>2]=c+12,a=d+8|0,e=0;t:{r:{i:switch(t-1|0){case 0:if(e=mi(60),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e>>2]=4960;break t;case 1:if(e=mi(60),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e>>2]=5384;break t;case 3:if(e=mi(112),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e+60>>2]=0,h[e+64>>2]=0,h[e>>2]=5608,h[e+68>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+84>>2]=0,h[e+88>>2]=0,h[e+92>>2]=0,h[e+96>>2]=0,h[e+100>>2]=0,h[e+104>>2]=0,h[e+108>>2]=0;break t;case 2:if(e=mi(92),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[e+60>>2]=0,h[e+64>>2]=0,h[e>>2]=5844,h[e+68>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+84>>2]=0,h[e+88>>2]=p;break t;case 4:if(e=mi(104),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t,t=h[o+24>>2],n=h[o+28>>2]-t|0){if((0|n)<0)break r;r=mi(n),h[e+32>>2]=r,h[e+40>>2]=r+(n>>2<<2),g=e,v=He(r,t,n)+n|0,h[g+36>>2]=v}t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,r=h[a+8>>2],t=h[a+12>>2],h[e+84>>2]=0,h[e+76>>2]=0,h[e+80>>2]=0,h[e+60>>2]=0,h[e+64>>2]=0,h[e>>2]=6060,h[e+52>>2]=r,h[e+56>>2]=t,t=h[a+4>>2],h[e+88>>2]=h[a>>2],h[e+92>>2]=t,t=h[a+12>>2],h[e+96>>2]=h[a+8>>2],h[e+100>>2]=t;break t;case 5:break i;default:break t}e=mi(128),h[e+4>>2]=l,h[e>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],n=h[o+20>>2],r=h[o>>2],t=h[o+4>>2],h[e+40>>2]=0,h[e+32>>2]=0,h[e+36>>2]=0,h[e+24>>2]=u,h[e+28>>2]=n,h[e+16>>2]=l,h[e+20>>2]=c,h[e+8>>2]=r,h[e+12>>2]=t;i:{n:{if(r=h[o+28>>2]-h[o+24>>2]|0){if((0|r)<0)break n;t=mi(r),h[e+32>>2]=t,h[e+36>>2]=t,h[e+40>>2]=t+(r>>2<<2),r=h[o+24>>2],(0|(n=h[o+28>>2]-r|0))>0&&(t=He(t,r,n)+n|0),h[e+36>>2]=t}h[e>>2]=5328,t=h[a+4>>2],h[e+44>>2]=h[a>>2],h[e+48>>2]=t,t=h[a+12>>2],h[e+52>>2]=h[a+8>>2],h[e+56>>2]=t,h[(t=e- -64|0)>>2]=0,h[t+4>>2]=0,h[e+60>>2]=6868,h[e>>2]=6284,t=h[a+4>>2],h[e+72>>2]=h[a>>2],h[e+76>>2]=t,t=h[a+12>>2],h[e+80>>2]=h[a+8>>2],h[e+84>>2]=t,h[e+104>>2]=1065353216,h[e+108>>2]=-1,h[e+96>>2]=-1,h[e+100>>2]=-1,h[e+88>>2]=1,h[e+92>>2]=-1,h[e+60>>2]=6504,h[e+112>>2]=0,h[e+116>>2]=0,s[e+117|0]=0,s[e+118|0]=0,s[e+119|0]=0,s[e+120|0]=0,s[e+121|0]=0,s[e+122|0]=0,s[e+123|0]=0,s[e+124|0]=0;break i}vn(),S()}break t}vn(),S()}}if(N=d+32|0,n=e,e)break e}n=mi(44),h[n+4>>2]=m,h[n>>2]=3300,l=h[o+8>>2],c=h[o+12>>2],u=h[o+16>>2],r=h[o+20>>2],t=h[o>>2],e=h[o+4>>2],h[n+40>>2]=0,h[n+32>>2]=0,h[n+36>>2]=0,h[n+24>>2]=u,h[n+28>>2]=r,h[n+16>>2]=l,h[n+20>>2]=c,h[n+8>>2]=t,h[n+12>>2]=e;t:{if(e=h[o+24>>2],r=h[o+28>>2]-e|0){if((0|r)<0)break t;t=mi(r),h[n+32>>2]=t,h[n+40>>2]=t+(r>>2<<2),g=n,v=He(t,e,r)+r|0,h[g+36>>2]=v}h[n>>2]=6896;break e}vn(),S()}(e=h[i+32>>2])&&(h[i+36>>2]=e,ve(e))}return N=i+48|0,0|n},function(e){return s[h[8+(e|=0)>>2]+24|0]},function(e,t){t|=0;var r,i=0,n=0,o=0,a=0,l=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0;r=e|=0;e:{t:{r:{i:{n:{s:{o:{a:switch(f=h[e+8>>2],h[f+28>>2]-1|0){case 4:break r;case 5:break i;case 2:break n;case 3:break s;case 0:break o;case 1:break a;default:break e}if(n=mi((0|(i=s[f+24|0]))>=0?i:-1),e=h[r+16>>2],c=h[e+80>>2]?h[h[e>>2]>>2]+h[e+48>>2]|0:0,!t)break t;if((0|i)>0){for(f=-4&i,m=3&i,o=i-1>>>0<3;;){if(e=0,l=0,!o)for(;d=c+(a<<2)|0,s[e+n|0]=h[d>>2],s[(1|e)+n|0]=h[d+4>>2],s[(2|e)+n|0]=h[d+8>>2],s[(3|e)+n|0]=h[d+12>>2],e=e+4|0,a=a+4|0,(0|f)!=(0|(l=l+4|0)););if(l=0,m)for(;s[e+n|0]=h[c+(a<<2)>>2],e=e+1|0,a=a+1|0,(0|m)!=(0|(l=l+1|0)););if(He(h[h[h[r+8>>2]+64>>2]>>2]+g|0,n,i),g=i+g|0,(0|(p=p+1|0))==(0|t))break}break t}if(He(h[h[f+64>>2]>>2],n,i),1==(0|t))break t;if(c=1&(o=t-1|0),e=0,2!=(0|t))for(t=-2&o;He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),(0|t)!=(0|(a=a+2|0)););if(!c)break t;He(h[h[h[r+8>>2]+64>>2]>>2]+(e+i|0)|0,n,i);break t}if(n=mi((0|(i=s[f+24|0]))>=0?i:-1),e=h[r+16>>2],c=h[e+80>>2]?h[h[e>>2]>>2]+h[e+48>>2]|0:0,!t)break t;if((0|i)>0){for(f=-4&i,m=3&i,o=i-1>>>0<3;;){if(e=0,l=0,!o)for(;d=c+(a<<2)|0,s[e+n|0]=h[d>>2],s[(1|e)+n|0]=h[d+4>>2],s[(2|e)+n|0]=h[d+8>>2],s[(3|e)+n|0]=h[d+12>>2],e=e+4|0,a=a+4|0,(0|f)!=(0|(l=l+4|0)););if(l=0,m)for(;s[e+n|0]=h[c+(a<<2)>>2],e=e+1|0,a=a+1|0,(0|m)!=(0|(l=l+1|0)););if(He(h[h[h[r+8>>2]+64>>2]>>2]+g|0,n,i),g=i+g|0,(0|(p=p+1|0))==(0|t))break}break t}if(He(h[h[f+64>>2]>>2],n,i),1==(0|t))break t;if(c=1&(o=t-1|0),e=0,2!=(0|t))for(t=-2&o;He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),(0|t)!=(0|(a=a+2|0)););if(!c)break t;He(h[h[h[r+8>>2]+64>>2]>>2]+(e+i|0)|0,n,i);break t}if(n=mi((e=(o=s[f+24|0])+o|0)>>>0<o>>>0?-1:e),e=h[r+16>>2],c=h[e+80>>2]?h[h[e>>2]>>2]+h[e+48>>2]|0:0,!t)break t;if(i=o<<1,(0|o)>0){for(f=-4&o,m=3&o,o=o-1>>>0<3;;){if(e=0,l=0,!o)for(;d=c+(a<<2)|0,u[(p=e<<1)+n>>1]=h[d>>2],u[(2|p)+n>>1]=h[d+4>>2],u[(4|p)+n>>1]=h[d+8>>2],u[(6|p)+n>>1]=h[d+12>>2],e=e+4|0,a=a+4|0,(0|f)!=(0|(l=l+4|0)););if(l=0,m)for(;u[(e<<1)+n>>1]=h[c+(a<<2)>>2],e=e+1|0,a=a+1|0,(0|m)!=(0|(l=l+1|0)););if(He(h[h[h[r+8>>2]+64>>2]>>2]+v|0,n,i),v=i+v|0,(0|(g=g+1|0))==(0|t))break}break t}if(He(h[h[f+64>>2]>>2],n,i),1==(0|t))break t;if(c=1&(o=t-1|0),e=0,2!=(0|t))for(t=-2&o;He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),(0|t)!=(0|(a=a+2|0)););if(!c)break t;He(h[h[h[r+8>>2]+64>>2]>>2]+(e+i|0)|0,n,i);break t}if(n=mi((e=(o=s[f+24|0])+o|0)>>>0<o>>>0?-1:e),e=h[r+16>>2],c=h[e+80>>2]?h[h[e>>2]>>2]+h[e+48>>2]|0:0,!t)break t;if(i=o<<1,(0|o)>0){for(f=-4&o,m=3&o,o=o-1>>>0<3;;){if(e=0,l=0,!o)for(;d=c+(a<<2)|0,u[(p=e<<1)+n>>1]=h[d>>2],u[(2|p)+n>>1]=h[d+4>>2],u[(4|p)+n>>1]=h[d+8>>2],u[(6|p)+n>>1]=h[d+12>>2],e=e+4|0,a=a+4|0,(0|f)!=(0|(l=l+4|0)););if(l=0,m)for(;u[(e<<1)+n>>1]=h[c+(a<<2)>>2],e=e+1|0,a=a+1|0,(0|m)!=(0|(l=l+1|0)););if(He(h[h[h[r+8>>2]+64>>2]>>2]+v|0,n,i),v=i+v|0,(0|(g=g+1|0))==(0|t))break}break t}if(He(h[h[f+64>>2]>>2],n,i),1==(0|t))break t;if(c=1&(o=t-1|0),e=0,2!=(0|t))for(t=-2&o;He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),(0|t)!=(0|(a=a+2|0)););if(!c)break t;He(h[h[h[r+8>>2]+64>>2]>>2]+(e+i|0)|0,n,i);break t}if(i=(o=s[f+24|0])<<2,n=mi((0|o)!=(1073741823&o)?-1:i),e=h[r+16>>2],c=h[e+80>>2]?h[h[e>>2]>>2]+h[e+48>>2]|0:0,!t)break t;if((0|o)>0){for(f=-4&o,m=3&o,o=o-1>>>0<3;;){if(e=0,l=0,!o)for(;d=c+(a<<2)|0,h[(p=e<<2)+n>>2]=h[d>>2],h[(4|p)+n>>2]=h[d+4>>2],h[(8|p)+n>>2]=h[d+8>>2],h[(12|p)+n>>2]=h[d+12>>2],e=e+4|0,a=a+4|0,(0|f)!=(0|(l=l+4|0)););if(l=0,m)for(;h[(e<<2)+n>>2]=h[c+(a<<2)>>2],e=e+1|0,a=a+1|0,(0|m)!=(0|(l=l+1|0)););if(He(h[h[h[r+8>>2]+64>>2]>>2]+v|0,n,i),v=i+v|0,(0|(g=g+1|0))==(0|t))break}break t}if(He(h[h[f+64>>2]>>2],n,i),1==(0|t))break t;if(c=1&(o=t-1|0),e=0,2!=(0|t))for(t=-2&o;He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),(0|t)!=(0|(a=a+2|0)););if(!c)break t;He(h[h[h[r+8>>2]+64>>2]>>2]+(e+i|0)|0,n,i);break t}if(i=(o=s[f+24|0])<<2,n=mi((0|o)!=(1073741823&o)?-1:i),e=h[r+16>>2],c=h[e+80>>2]?h[h[e>>2]>>2]+h[e+48>>2]|0:0,t)if((0|o)>0)for(f=-4&o,m=3&o,o=o-1>>>0<3;;){if(e=0,l=0,!o)for(;d=c+(a<<2)|0,h[(p=e<<2)+n>>2]=h[d>>2],h[(4|p)+n>>2]=h[d+4>>2],h[(8|p)+n>>2]=h[d+8>>2],h[(12|p)+n>>2]=h[d+12>>2],e=e+4|0,a=a+4|0,(0|f)!=(0|(l=l+4|0)););if(l=0,m)for(;h[(e<<2)+n>>2]=h[c+(a<<2)>>2],e=e+1|0,a=a+1|0,(0|m)!=(0|(l=l+1|0)););if(He(h[h[h[r+8>>2]+64>>2]>>2]+v|0,n,i),v=i+v|0,(0|(g=g+1|0))==(0|t))break}else if(He(h[h[f+64>>2]>>2],n,i),1!=(0|t)){if(c=1&(o=t-1|0),e=0,2!=(0|t))for(t=-2&o;He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),He((e=e+i|0)+h[h[h[r+8>>2]+64>>2]>>2]|0,n,i),(0|t)!=(0|(a=a+2|0)););c&&He(h[h[h[r+8>>2]+64>>2]>>2]+(e+i|0)|0,n,i)}}ve(n),n=1}return 0|n},function(e){var t;return h[(e|=0)>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},Mi,hn,Zi,wi,dn,Xi,en,dn,hn,function(e,t){e|=0;var r,i,n,s=0,o=0,a=0,l=0,c=0,u=0;return i=o=h[12+(t|=0)>>2],a=s=h[t+20>>2],s=(r=(l=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,(n=h[t+8>>2])>>>0<r>>>0&(0|s)>=(0|o)|(0|s)>(0|o)||(c=h[t>>2],o=d[0|(o=c+l|0)]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+16>>2]=r,h[t+20>>2]=s,s=a,l=a=l+8|0,a=s=a>>>0<8?s+1|0:s,l>>>0>n>>>0&(0|s)>=(0|i)|(0|s)>(0|i)||(s=d[0|(s=r+c|0)]|d[s+1|0]<<8|d[s+2|0]<<16|d[s+3|0]<<24,h[t+16>>2]=l,h[t+20>>2]=a,(0|s)<(0|o)||(h[e+16>>2]=s,h[e+12>>2]=o,!(t=(s>>31)-((o>>31)+(s>>>0<o>>>0)|0)|0)&(s=s-o|0)>>>0>2147483646|t||(u=1,t=s+1|0,h[e+20>>2]=t,s=t>>>1|0,h[e+24>>2]=s,h[e+28>>2]=0-s,1&t||(h[e+24>>2]=s-1))))),0|u},function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a,l,c=0,u=0,d=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0;if(h[8+(e|=0)>>2]=n,p=h[(i=e+32|0)>>2],(s=h[e+36>>2]-p>>2)>>>0<n>>>0?(er(i,n-s|0),p=h[i>>2],i=h[e+8>>2]):(n>>>0<s>>>0&&(h[e+36>>2]=(n<<2)+p),i=n),l=h[e+52>>2],o=h[e+48>>2],s=0,m=St(mi(m=(1073741823&n)!=(0|n)?-1:n<<2),0,m),!((0|i)<=0)){for(;(0|(c=h[(i=s<<2)+m>>2]))>(0|(u=h[e+16>>2]))?h[i+p>>2]=u:(i=i+p|0,u=h[e+12>>2],h[i>>2]=(0|u)>(0|c)?u:c),(0|(i=h[e+8>>2]))>(0|(s=s+1|0)););if(!((0|i)<=0))for(s=0;;){i=(c=s<<2)+r|0,c=h[t+c>>2]+h[c+p>>2]|0,h[i>>2]=c;e:{if((0|c)>h[e+16>>2])c=c-h[e+20>>2]|0;else{if((0|c)>=h[e+12>>2])break e;c=c+h[e+20>>2]|0}h[i>>2]=c}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}if(s=h[e+56>>2],a=h[s>>2],(0|(s=h[s+4>>2]-a|0))>=5)for(b=(0|(s>>=2))>2?s:2,y=s>>>0>1?s:1,E=-2&n,w=1&n,p=1;;){e:{t:{if((0|p)!=(0|y)){if(_=v(n,p),-1==(0|(s=h[(p<<2)+a>>2]))|h[h[o>>2]+(s>>>3&536870908)>>2]>>>s&1)break t;if(-1==(0|(s=h[h[h[o+64>>2]+12>>2]+(s<<2)>>2])))break t;if(u=h[l>>2],c=h[o+28>>2],(0|(f=h[u+(h[c+(s<<2)>>2]<<2)>>2]))>=(0|p))break t;if((0|(d=h[u+(h[c+((((d=s+1|0)>>>0)%3|0?d:s-2|0)<<2)>>2]<<2)>>2]))>=(0|p))break t;if((0|(s=h[u+(h[c+(s+((s>>>0)%3|0?-1:2)<<2)>>2]<<2)>>2]))>=(0|p))break t;if(!((0|n)<=0)){if(c=v(n,s),u=v(n,d),f=v(n,f),s=0,g=0,1!=(0|n))for(;h[m+(s<<2)>>2]=(h[(s+c<<2)+r>>2]+h[(s+u<<2)+r>>2]|0)-h[(s+f<<2)+r>>2],h[m+((d=1|s)<<2)>>2]=(h[(c+d<<2)+r>>2]+h[(u+d<<2)+r>>2]|0)-h[(f+d<<2)+r>>2],s=s+2|0,(0|E)!=(0|(g=g+2|0)););w&&(h[m+(s<<2)>>2]=(h[(s+c<<2)+r>>2]+h[(s+u<<2)+r>>2]|0)-h[(s+f<<2)+r>>2])}if((0|i)<=0)break e;for(u=h[e+32>>2],s=0;(0|(c=h[(i=s<<2)+m>>2]))>(0|(f=h[e+16>>2]))?h[i+u>>2]=f:(i=i+u|0,f=h[e+12>>2],h[i>>2]=(0|f)>(0|c)?f:c),(0|(i=h[e+8>>2]))>(0|(s=s+1|0)););if(s=0,(0|i)<=0)break e;for(f=(i=_<<2)+r|0,d=t+i|0;;){i=(c=s<<2)+f|0,c=h[c+d>>2]+h[c+u>>2]|0,h[i>>2]=c;r:{if((0|c)>h[e+16>>2])c=c-h[e+20>>2]|0;else{if((0|c)>=h[e+12>>2])break r;c=c+h[e+20>>2]|0}h[i>>2]=c}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}break e}An(),S()}if(!((0|i)<=0)){for(f=(v(p-1|0,n)<<2)+r|0,u=h[e+32>>2],s=0;(0|(c=h[(i=s<<2)+f>>2]))>(0|(d=h[e+16>>2]))?h[i+u>>2]=d:(i=i+u|0,d=h[e+12>>2],h[i>>2]=(0|d)>(0|c)?d:c),(0|(i=h[e+8>>2]))>(0|(s=s+1|0)););if(s=0,!((0|i)<=0))for(f=(i=_<<2)+r|0,d=t+i|0;;){i=(c=s<<2)+f|0,c=h[c+d>>2]+h[c+u>>2]|0,h[i>>2]=c;t:{if((0|c)>h[e+16>>2])c=c-h[e+20>>2]|0;else{if((0|c)>=h[e+12>>2])break t;c=c+h[e+20>>2]|0}h[i>>2]=c}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}}if((0|b)==(0|(p=p+1|0)))break}return ve(m),1},gn,gn,Mi,cn,wi,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a,l,c=0,u=0,d=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0;if(h[8+(e|=0)>>2]=n,d=h[(i=e+32|0)>>2],(s=h[e+36>>2]-d>>2)>>>0<n>>>0?(er(i,n-s|0),d=h[i>>2],i=h[e+8>>2]):(n>>>0<s>>>0&&(h[e+36>>2]=(n<<2)+d),i=n),o=St(mi(s=(1073741823&n)!=(0|n)?-1:n<<2),0,s),a=St(mi(s),0,s),!((0|i)<=0)){for(;(0|(s=h[(i=c<<2)+o>>2]))>(0|(u=h[e+16>>2]))?h[i+d>>2]=u:(i=i+d|0,u=h[e+12>>2],h[i>>2]=(0|u)>(0|s)?u:s),(0|(i=h[e+8>>2]))>(0|(c=c+1|0)););if(!((0|i)<=0))for(s=0;;){i=(u=s<<2)+r|0,u=h[t+u>>2]+h[u+d>>2]|0,h[i>>2]=u;e:{if((0|u)>h[e+16>>2])c=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break e;c=u+h[e+20>>2]|0}h[i>>2]=c}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}if(s=h[e+56>>2],l=h[s>>2],(0|(s=h[s+4>>2]-l|0))>=5)for(M=h[e+52>>2],y=h[e+48>>2],C=(0|(s>>=2))>2?s:2,R=s>>>0>1?s:1,x=-2&n,A=1&n,I=-4&n,T=3&n,w=n-1|0,O=n<<2,_=1;;){e:{t:{r:{i:if((0|_)==(0|R))An(),S();else{if(u=h[(_<<2)+l>>2],(E=(0|n)<=0)||St(o,0,O),-1==(0|u)){f=v(n,_);break t}for(P=h[y>>2],g=0,s=u;;){if(!(h[(s>>>3&536870908)+P>>2]>>>s&1||-1==(0|(c=h[h[h[y+64>>2]+12>>2]+(s<<2)>>2]))||(f=h[M>>2],d=h[y+28>>2],(0|(m=h[f+(h[d+(c<<2)>>2]<<2)>>2]))>=(0|_)||(0|(p=h[f+(h[d+((((p=c+1|0)>>>0)%3|0?p:c-2|0)<<2)>>2]<<2)>>2]))>=(0|_)||(0|(c=h[f+(h[d+(c+((c>>>0)%3|0?-1:2)<<2)>>2]<<2)>>2]))>=(0|_)))){if(!E){if(d=v(n,c),f=v(n,p),m=v(n,m),c=0,b=0,w)for(;h[(c<<2)+a>>2]=(h[(c+d<<2)+r>>2]+h[(c+f<<2)+r>>2]|0)-h[(c+m<<2)+r>>2],h[((p=1|c)<<2)+a>>2]=(h[(d+p<<2)+r>>2]+h[(f+p<<2)+r>>2]|0)-h[(p+m<<2)+r>>2],c=c+2|0,(0|x)!=(0|(b=b+2|0)););if(A&&(h[(c<<2)+a>>2]=(h[(c+d<<2)+r>>2]+h[(c+f<<2)+r>>2]|0)-h[(c+m<<2)+r>>2]),!E){if(d=0,c=0,f=0,w>>>0>2)for(;h[(p=(m=c<<2)+o|0)>>2]=h[p>>2]+h[m+a>>2],h[(b=(p=4|m)+o|0)>>2]=h[b>>2]+h[p+a>>2],h[(b=(p=8|m)+o|0)>>2]=h[b>>2]+h[p+a>>2],h[(p=(m|=12)+o|0)>>2]=h[p>>2]+h[m+a>>2],c=c+4|0,(0|I)!=(0|(f=f+4|0)););if(T)for(;h[(m=(f=c<<2)+o|0)>>2]=h[m>>2]+h[f+a>>2],c=c+1|0,(0|T)!=(0|(d=d+1|0)););}}g=g+1|0}n:{if((s>>>0)%3|0)s=s-1|0;else if(c=-1,-1==(0|(s=s+2|0)))break n;c=-1,h[h[y>>2]+(s>>>3&536870908)>>2]>>>s&1||(c=-1,-1!=(0|(s=h[h[h[y+64>>2]+12>>2]+(s<<2)>>2]))&&(c=s-1|0,(s>>>0)%3|0||(c=s+2|0)))}if(-1==(0|(s=(0|c)==(0|u)?-1:c)))break}if(f=v(n,_),!g)break t;if(E)break r;if(c=0,s=0,!w)break i;for(;h[(d=(u=c<<2)+o|0)>>2]=h[d>>2]/(0|g),h[(u=(4|u)+o|0)>>2]=h[u>>2]/(0|g),c=c+2|0,(0|x)!=(0|(s=s+2|0)););}A&&(h[(s=(c<<2)+o|0)>>2]=h[s>>2]/(0|g))}if((0|i)<=0)break e;for(d=h[e+32>>2],c=0;(0|(s=h[(i=c<<2)+o>>2]))>(0|(u=h[e+16>>2]))?h[i+d>>2]=u:(i=i+d|0,u=h[e+12>>2],h[i>>2]=(0|u)>(0|s)?u:s),(0|(i=h[e+8>>2]))>(0|(c=c+1|0)););if(s=0,(0|i)<=0)break e;for(c=(i=f<<2)+r|0,f=t+i|0;;){i=(u=s<<2)+c|0,u=h[u+f>>2]+h[u+d>>2]|0,h[i>>2]=u;r:{if((0|u)>h[e+16>>2])u=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break r;u=u+h[e+20>>2]|0}h[i>>2]=u}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}break e}if(!((0|i)<=0)){for(u=(v(_-1|0,n)<<2)+r|0,d=h[e+32>>2],c=0;(0|(s=h[(i=c<<2)+u>>2]))>(0|(g=h[e+16>>2]))?h[i+d>>2]=g:(i=i+d|0,g=h[e+12>>2],h[i>>2]=(0|g)>(0|s)?g:s),(0|(i=h[e+8>>2]))>(0|(c=c+1|0)););if(s=0,!((0|i)<=0))for(c=(i=f<<2)+r|0,f=t+i|0;;){i=(u=s<<2)+c|0,u=h[u+f>>2]+h[u+d>>2]|0,h[i>>2]=u;t:{if((0|u)>h[e+16>>2])u=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break t;u=u+h[e+20>>2]|0}h[i>>2]=u}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}}if((0|C)==(0|(_=_+1|0)))break}return ve(a),ve(o),1},function(e){var t=0;return h[(e|=0)>>2]=3592,(t=h[e+96>>2])&&ve(t),(t=h[e+84>>2])&&ve(t),(t=h[e+72>>2])&&ve(t),(t=h[e+60>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t=0;h[(e|=0)>>2]=3592,(t=h[e+96>>2])&&ve(t),(t=h[e+84>>2])&&ve(t),(t=h[e+72>>2])&&ve(t),(t=h[e+60>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},an,wi,Ae,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a,l,c,u=0,d=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,G=0,D=0,U=0;N=o=N+-64|0,h[8+(e|=0)>>2]=n,u=h[(s=e+32|0)>>2];e:{if((i=h[e+36>>2]-u>>2)>>>0<n>>>0)er(s,n-i|0),h[o+56>>2]=0,h[o+60>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o>>2]=0;else if(i>>>0>n>>>0&&(h[e+36>>2]=u+(n<<2)),h[o+56>>2]=0,h[o+60>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o>>2]=0,i=0,!n)break e;$e(o+16|0,n,o),d=h[o+28>>2],i=h[o+32>>2]}h[o>>2]=0;e:if((i=i-d>>2)>>>0>=n>>>0){if(i>>>0<=n>>>0)break e;h[o+32>>2]=(n<<2)+d}else $e(o+16|12,n-i|0,o);h[o>>2]=0,s=h[o+40>>2];e:if((i=h[o+44>>2]-s>>2)>>>0>=n>>>0){if(i>>>0<=n>>>0)break e;h[o+44>>2]=s+(n<<2)}else $e(o+40|0,n-i|0,o);h[o>>2]=0,s=h[o+52>>2];e:if((i=h[o+56>>2]-s>>2)>>>0>=n>>>0){if(i>>>0<=n>>>0)break e;h[o+56>>2]=s+(n<<2)}else $e(o+52|0,n-i|0,o);if(d=0,!(h[e+8>>2]<=0)){for(f=h[e+32>>2],u=h[o+16>>2];(0|(s=h[(i=d<<2)+u>>2]))>(0|(g=h[e+16>>2]))?h[i+f>>2]=g:(i=i+f|0,g=h[e+12>>2],h[i>>2]=(0|g)>(0|s)?g:s),(0|(d=d+1|0))<(0|(i=h[e+8>>2])););if(!((0|i)<=0))for(i=0;;){s=(u=i<<2)+r|0,u=h[t+u>>2]+h[u+f>>2]|0,h[s>>2]=u;e:{if((0|u)>h[e+16>>2])u=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break e;u=u+h[e+20>>2]|0}h[s>>2]=u}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}c=h[e+52>>2],a=h[e+48>>2],l=mi(16),h[(i=l)>>2]=0,h[i+4>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0,h[o+8>>2]=0,h[o>>2]=0,h[o+4>>2]=0;e:{if(n){if(n>>>0>=1073741824)break e;T=mi(i=n<<2),h[o>>2]=T,h[o+8>>2]=i+T,St(T,0,i)}y=1,i=h[e+56>>2],R=h[i>>2];t:if(!((0|(i=h[i+4>>2]-R|0))<5))for(k=(0|(i>>=2))>2?i:2,L=i>>>0>1?i:1,I=-2&n,O=1&n,G=-4&n,P=3&n,M=n-1|0,D=n<<2,g=1;;){r:{i:{n:{s:{if((0|g)!=(0|L)){i=((s=h[(g<<2)+R>>2])>>>0)%3|0;o:{a:if(-1!=(0|s)){f=0,C=0!=(0|i)|-1!=(0|(u=s+2|0)),_=1,b=1<<(E=i?s-1|0:u),w=E>>>5|0,U=h[a>>2],i=s;l:{for(;;){if(!(h[(i>>>3&536870908)+U>>2]>>>i&1||-1==(0|(u=h[h[h[a+64>>2]+12>>2]+(i<<2)>>2]))||(p=h[c>>2],d=h[a+28>>2],(0|(y=h[p+(h[d+(u<<2)>>2]<<2)>>2]))>=(0|g)||(0|(m=h[p+(h[d+((((m=u+1|0)>>>0)%3|0?m:u-2|0)<<2)>>2]<<2)>>2]))>=(0|g)||(0|(d=h[p+(h[d+(u+((u>>>0)%3|0?-1:2)<<2)>>2]<<2)>>2]))>=(0|g)))){if(n){if(u=h[(o+16|0)+v(f,12)>>2],p=v(n,d),m=v(n,m),y=v(n,y),d=0,A=0,M)for(;h[u+(d<<2)>>2]=(h[(d+p<<2)+r>>2]+h[(d+m<<2)+r>>2]|0)-h[(d+y<<2)+r>>2],h[u+((x=1|d)<<2)>>2]=(h[(p+x<<2)+r>>2]+h[(m+x<<2)+r>>2]|0)-h[(y+x<<2)+r>>2],d=d+2|0,(0|I)!=(0|(A=A+2|0)););O&&(h[u+(d<<2)>>2]=(h[(d+p<<2)+r>>2]+h[(d+m<<2)+r>>2]|0)-h[(d+y<<2)+r>>2])}if(u=4,4==(0|(f=f+1|0)))break l}c:if(1&_){if(d=i-2|0,u=i+1|0,i=-1,-1==(0|(u=(u>>>0)%3|0?u:d))|h[h[a>>2]+(u>>>3&536870908)>>2]>>>u&1)break c;if(-1==(0|(u=h[h[h[a+64>>2]+12>>2]+(u<<2)>>2])))break c;i=((i=u+1|0)>>>0)%3|0?i:u-2|0}else{if((i>>>0)%3|0)d=i-1|0;else if(d=i+2|0,i=-1,-1==(0|d))break c;i=-1,h[h[a>>2]+(d>>>3&536870908)>>2]>>>d&1||-1!=(0|(u=h[h[h[a+64>>2]+12>>2]+(d<<2)>>2]))&&(i=(u>>>0)%3|0?u-1|0:u+2|0)}c:if((0|i)!=(0|s)){if(!(1&(1^_)|-1!=(0|i))){if(!C|b&h[h[a>>2]+(w<<2)>>2])break c;if(-1==(0|(i=h[h[h[a+64>>2]+12>>2]+(E<<2)>>2])))break c;_=0,i=(i>>>0)%3|0?i-1|0:i+2|0}if(-1!=(0|i))continue}break}if((0|(u=f))<=0)break a}for(n&&St(h[o>>2],0,D),x=((i=u-1|0)<<2)+l|0,A=i=v(i,12)+e|0,C=h[i- -64>>2],y=0,_=0,i=0;;){if(s=h[x>>2],h[x>>2]=s+1,s>>>0>=C>>>0)break t;if(!(h[h[A+60>>2]+(s>>>3&536870908)>>2]>>>s&1)&&(i=i+1|0,n)){if(f=h[o>>2],p=h[(o+16|0)+v(_,12)>>2],E=0,d=0,s=0,M>>>0>=3)for(;h[(b=(m=d<<2)+f|0)>>2]=h[b>>2]+h[p+m>>2],h[(w=(b=4|m)+f|0)>>2]=h[w>>2]+h[p+b>>2],h[(w=(b=8|m)+f|0)>>2]=h[w>>2]+h[p+b>>2],h[(b=(m|=12)+f|0)>>2]=h[b>>2]+h[p+m>>2],d=d+4|0,(0|G)!=(0|(s=s+4|0)););if(P)for(;h[(m=(s=d<<2)+f|0)>>2]=h[m>>2]+h[s+p>>2],d=d+1|0,(0|P)!=(0|(E=E+1|0)););}if((0|(_=_+1|0))==(0|u))break}if(s=_=v(n,g),!i)break o;if(!n)break i;if(s=h[o>>2],d=0,u=0,M)break s;break n}s=v(n,g)}if(h[e+8>>2]<=0)break r;for(_=(v(g-1|0,n)<<2)+r|0,f=h[e+32>>2],d=0;(0|(u=h[(i=d<<2)+_>>2]))>(0|(p=h[e+16>>2]))?h[i+f>>2]=p:(i=i+f|0,p=h[e+12>>2],h[i>>2]=(0|p)>(0|u)?p:u),(0|(d=d+1|0))<(0|(u=h[e+8>>2])););if(i=0,(0|u)<=0)break r;for(d=(s<<=2)+r|0,_=t+s|0;;){s=(u=i<<2)+d|0,u=h[u+_>>2]+h[u+f>>2]|0,h[s>>2]=u;o:{if((0|u)>h[e+16>>2])u=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break o;u=u+h[e+20>>2]|0}h[s>>2]=u}if(!((0|(i=i+1|0))<h[e+8>>2]))break}break r}An(),S()}for(;h[(p=(f=d<<2)+s|0)>>2]=h[p>>2]/(0|i),h[(f=s+(4|f)|0)>>2]=h[f>>2]/(0|i),d=d+2|0,(0|I)!=(0|(u=u+2|0)););}O&&(h[(s=s+(d<<2)|0)>>2]=h[s>>2]/(0|i))}if(!(h[e+8>>2]<=0)){for(f=h[e+32>>2],d=0;(0|(s=h[(i=d<<2)+T>>2]))>(0|(u=h[e+16>>2]))?h[i+f>>2]=u:(i=i+f|0,u=h[e+12>>2],h[i>>2]=(0|u)>(0|s)?u:s),(0|(d=d+1|0))<(0|(s=h[e+8>>2])););if(i=0,!((0|s)<=0))for(d=(s=_<<2)+r|0,_=t+s|0;;){s=(u=i<<2)+d|0,u=h[u+_>>2]+h[u+f>>2]|0,h[s>>2]=u;i:{if((0|u)>h[e+16>>2])u=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break i;u=u+h[e+20>>2]|0}h[s>>2]=u}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}}if(y=1,(0|k)==(0|(g=g+1|0)))break}return(e=h[o>>2])&&ve(e),ve(l),(e=h[o+52>>2])&&(h[o+56>>2]=e,ve(e)),(e=h[o+40>>2])&&(h[o+44>>2]=e,ve(e)),(e=h[o+28>>2])&&(h[o+32>>2]=e,ve(e)),(e=h[o+16>>2])&&(h[o+20>>2]=e,ve(e)),N=o- -64|0,0|y}vn(),S()},function(e){var t=0;return h[(e|=0)>>2]=3840,(t=h[e+76>>2])&&ve(t),t=h[e+68>>2],h[e+68>>2]=0,t&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t=0;h[(e|=0)>>2]=3840,(t=h[e+76>>2])&&ve(t),t=h[e+68>>2],h[e+68>>2]=0,t&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},on,yi,hn,en,xi,Ue,function(e,t,r,i,n,o){e|=0,t|=0,r|=0,i|=0,n|=0,o|=0;var a=0,l=0,c=_(0),u=_(0),f=0,p=0,g=0,y=_(0),E=_(0),w=_(0),A=_(0),M=0,C=_(0),R=_(0),I=_(0),O=_(0),P=_(0),k=_(0),L=_(0),G=_(0),D=_(0),U=0,V=_(0);h[e+64>>2]=o,h[e+72>>2]=n,o=mi((1073741823&n)!=(0|n)?-1:n<<2),i=h[e+68>>2],h[e+68>>2]=o,i&&ve(i),h[e+8>>2]=n,a=h[(o=e+32|0)>>2],(i=h[e+36>>2]-a>>2)>>>0<n>>>0?er(o,n-i|0):i>>>0<=n>>>0||(h[e+36>>2]=a+(n<<2));e:if(i=h[e+56>>2],!((0|(i=(a=h[i+4>>2])-(o=h[i>>2])|0))<=0)){if((0|o)!=(0|a))for(U=(i=i>>>2|0)>>>0>1?i:1;;){if(l=h[(g<<2)+o>>2],u=_(0),N=a=N-48|0,o=-1,i=-1,-1!=(0|l)&&(o=((i=l+1|0)>>>0)%3|0?i:l-2|0,i=l-1|0,(l>>>0)%3|0||(i=l+2|0)),f=h[e+52>>2],l=h[f>>2],f=h[f+4>>2]-l>>2,p=o<<2,o=h[h[e+48>>2]+28>>2],f>>>0<=(p=h[p+o>>2])>>>0||(o=h[o+(i<<2)>>2])>>>0>=f>>>0)An(),S();else{t:if((0|(f=h[l+(o<<2)>>2]))>=(0|g)|(0|(i=h[l+(p<<2)>>2]))>=(0|g)){if((0|i)<(0|g))o=h[e+72>>2],i=v(i,o);else{if(o=0,(0|g)<=0){if(h[e+72>>2]<=0)break t;for(i=h[e+68>>2];h[i+(o<<2)>>2]=0,(0|(o=o+1|0))<h[e+72>>2];);break t}o=h[e+72>>2],i=v(o,g-1|0)}if(!((0|o)<=0))for(l=h[e+68>>2],o=0;h[l+(o<<2)>>2]=h[(i+o<<2)+r>>2],(0|(o=o+1|0))<h[e+72>>2];);}else{if(o=h[e+72>>2],l=(v(o,f)<<2)+r|0,y=_(h[l+4>>2]),o=(v(i,o)<<2)+r|0,A=_(h[o+4>>2]),!((C=_(h[l>>2]))!=(k=_(h[o>>2]))|y!=A)){if(i=h[e+68>>2],o=_(b(y))<_(2147483648)?~~y:-2147483648,h[i+4>>2]=o,_(b(C))<_(2147483648)){h[i>>2]=~~C;break t}h[i>>2]=-2147483648;break t}o=h[h[e+64>>2]+(g<<2)>>2],h[a+40>>2]=0,h[a+32>>2]=0,h[a+36>>2]=0,l=h[e+60>>2],d[l+84|0]||(o=h[h[l+68>>2]+(o<<2)>>2]),Z(l,o,s[l+24|0],a+32|0),o=h[h[e+64>>2]+(i<<2)>>2],h[a+24>>2]=0,h[a+16>>2]=0,h[a+20>>2]=0,i=h[e+60>>2],d[i+84|0]||(o=h[h[i+68>>2]+(o<<2)>>2]),Z(i,o,s[i+24|0],a+16|0),o=h[h[e+64>>2]+(f<<2)>>2],h[a+8>>2]=0,h[a>>2]=0,h[a+4>>2]=0,i=h[e+60>>2],d[i+84|0]||(o=h[h[i+68>>2]+(o<<2)>>2]),Z(i,o,s[i+24|0],a),R=m[a+40>>2],I=m[a+36>>2],V=m[a+32>>2],E=m[a+24>>2],c=_(m[a+8>>2]-E),G=m[a+20>>2],O=_(m[a+4>>2]-G),D=m[a+16>>2],P=_(m[a>>2]-D),!((L=_(_(c*c)+_(_(O*O)+_(_(P*P)+_(0)))))>_(0))&&(w=_(0),h[e+88>>2]>257)||(E=_(R-E),R=_(I-G),I=_(V-D),u=_(_(_(c*E)+_(_(O*R)+_(_(P*I)+_(0))))/L),c=_(E-_(c*u)),E=_(c*c),c=_(R-_(O*u)),w=_(c*c),c=_(I-_(P*u)),w=_(T(_(_(E+_(w+_(_(c*c)+_(0))))/L)))),E=w,i=h[e+80>>2]-1|0,o=h[h[e+76>>2]+(i>>>3&536870908)>>2],h[e+80>>2]=i,c=_(y-A),w=_(_(c*u)+A),A=_(C-k),y=_(A*E),y=_(w+((i=o>>>i&1)?y:_(-y))),w=_(_(A*u)+k),u=_(c*E),(u=_(w+(i?_(-u):u)))==u?(o=h[e+68>>2],M=x(+u+.5),i=b(M)<2147483648?~~M:-2147483648,h[o>>2]=i):(o=h[e+68>>2],h[o>>2]=-2147483648),M=x(+y+.5),i=b(M)<2147483648?~~M:-2147483648,h[o+4>>2]=y!=y?-2147483648:i}N=a+48|0}if(!(h[e+8>>2]<=0)){for(l=h[e+32>>2],f=h[e+68>>2],o=0;(0|(a=h[(i=o<<2)+f>>2]))>(0|(p=h[e+16>>2]))?h[i+l>>2]=p:(i=i+l|0,p=h[e+12>>2],h[i>>2]=(0|p)>(0|a)?p:a),(0|(o=o+1|0))<(0|(a=h[e+8>>2])););if(i=0,!((0|a)<=0))for(f=(o=v(n,g)<<2)+r|0,p=t+o|0;;){o=(a=i<<2)+f|0,a=h[a+p>>2]+h[a+l>>2]|0,h[o>>2]=a;t:{if((0|a)>h[e+16>>2])a=a-h[e+20>>2]|0;else{if((0|a)>=h[e+12>>2])break t;a=a+h[e+20>>2]|0}h[o>>2]=a}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}if((0|U)==(0|(g=g+1|0)))break e;if(i=h[e+56>>2],o=h[i>>2],!(h[i+4>>2]-o>>2>>>0>g>>>0))break}An(),S()}return 1},function(e){var t=0;return h[(e|=0)>>2]=4068,(t=h[e+76>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t=0;h[(e|=0)>>2]=4068,(t=h[e+76>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},ln,yi,hn,en,xi,Be,function(e,t,r,i,n,o){e|=0,t|=0,r|=0,i|=0,o|=0;var a=0,l=0,c=0,u=0,f=0,p=0,m=0,g=0,v=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,D=0,U=0,V=0,B=0,F=0,j=0,z=0,W=0,H=0,$=0,Y=0,q=0,X=0,Z=0,J=0;if(2==(0|(n|=0))){h[e+8>>2]=2,h[e- -64>>2]=o,o=h[(n=e+32|0)>>2],(i=h[e+36>>2]-o|0)>>>0<=7?er(n,2-(i>>>2|0)|0):8!=(0|i)&&(h[e+36>>2]=o+8);e:if(i=h[e+56>>2],(0|(o=(n=h[i+4>>2])-(i=h[i>>2])|0))<=0)o=0;else{if((0|i)!=(0|n))for(m=e+60|0,q=(0|(U=o>>2))>1?U:1,o=1;;){N=u=N-80|0,n=-1,a=-1,-1!=(0|(i=h[(b<<2)+i>>2]))&&(n=((n=i+1|0)>>>0)%3|0?n:i-2|0,a=i-1|0,(i>>>0)%3|0||(a=i+2|0)),c=h[m+36>>2],i=h[c>>2];t:{r:{i:{n:{if(c=h[c+4>>2]-i>>2,l=n<<2,n=h[h[m+32>>2]+28>>2],!(c>>>0<=(f=h[l+n>>2])>>>0||(n=h[n+(a<<2)>>2])>>>0>=c>>>0)){s:{if(!((0|(a=h[i+(n<<2)>>2]))>=(0|b)|(0|(c=h[i+(f<<2)>>2]))>=(0|b))){if(A=h[4+(i=(a<<3)+r|0)>>2],E=h[4+(n=(c<<3)+r|0)>>2],!((0|(M=h[i>>2]))!=(0|(P=h[n>>2]))|(0|E)!=(0|A))){h[m+8>>2]=P,h[m+12>>2]=E;break s}if(i=h[h[m+4>>2]+(b<<2)>>2],h[u+72>>2]=0,h[u+76>>2]=0,h[(n=u- -64|0)>>2]=0,h[n+4>>2]=0,h[u+56>>2]=0,h[u+60>>2]=0,n=h[m>>2],d[n+84|0]||(i=h[h[n+68>>2]+(i<<2)>>2]),se(n,i,s[n+24|0],u+56|0),i=h[h[m+4>>2]+(c<<2)>>2],h[u+48>>2]=0,h[u+52>>2]=0,h[u+40>>2]=0,h[u+44>>2]=0,h[u+32>>2]=0,h[u+36>>2]=0,n=h[m>>2],d[n+84|0]||(i=h[h[n+68>>2]+(i<<2)>>2]),se(n,i,s[n+24|0],u+32|0),i=h[h[m+4>>2]+(a<<2)>>2],h[u+24>>2]=0,h[u+28>>2]=0,h[u+16>>2]=0,h[u+20>>2]=0,h[u+8>>2]=0,h[u+12>>2]=0,n=h[m>>2],d[n+84|0]||(i=h[h[n+68>>2]+(i<<2)>>2]),se(n,i,s[n+24|0],u+8|0),V=h[u+44>>2],i=qr(v=(i=h[u+16>>2])-(n=k=h[u+40>>2])|0,f=h[u+20>>2]-(V+(i>>>0<n>>>0)|0)|0,v,f),n=G,g=i,B=h[u+36>>2],a=qr(w=(i=h[u+8>>2])-(a=L=h[u+32>>2])|0,l=h[u+12>>2]-(B+(i>>>0<a>>>0)|0)|0,w,l),n=G+n|0,n=(i=g+a|0)>>>0<a>>>0?n+1|0:n,g=i,F=h[u+52>>2],y=qr(_=(i=h[u+24>>2])-(a=D=h[u+48>>2])|0,p=h[u+28>>2]-(F+(i>>>0<a>>>0)|0)|0,_,p),a=G+n|0,x=i=g+y|0,i|(y=i>>>0<y>>>0?a+1|0:a)){if(i=qr((i=g=h[u+64>>2])-k|0,(z=h[u+68>>2])-((i>>>0<k>>>0)+V|0)|0,v,f),n=G,i=(a=i)+(c=qr((i=W=h[u+56>>2])-L|0,(H=h[u+60>>2])-((i>>>0<L>>>0)+B|0)|0,w,l))|0,a=G+n|0,a=i>>>0<c>>>0?a+1|0:a,i=(n=i)+(c=qr((i=$=h[u+72>>2])-D|0,(Y=h[u+76>>2])-((i>>>0<D>>>0)+F|0)|0,_,p))|0,n=G+a|0,C=i,T=i>>>0<c>>>0?n+1|0:n,a=(i=p>>31)+p|0,a=(n=i+_|0)>>>0<i>>>0?a+1|0:a,n^=i,c=i^=a,a=(i=f>>31)+f|0,I=i^(R=i+v|0),R=i^=i>>>0>R>>>0?a+1|0:a,j=0,a=(i=l>>31)+l|0,a=(O=i+w|0)>>>0<i>>>0?a+1|0:a,X=n,O^=i,(n=Xe(-1,2147483647,(n=(0|c)==(0|(i=(a=(0|R)==(0|(i^=a))&I>>>0>O>>>0|i>>>0<R>>>0)?R:i))&n>>>0>(I=a?I:O)>>>0|i>>>0<c>>>0)?X:I,n?c:i)>>>0<C>>>0)&(0|(i=G))<=(0|T)|(0|i)<(0|T))break t;if(c=1,i=0,n=g,v=$r(qr(v,f,C,T),G,x,y),a=G+V|0,a=z-((n>>>0<(f=v+k|0)>>>0)+(a=f>>>0<v>>>0?a+1|0:a)|0)|0,a=qr(n=n-f|0,a,n,a),v=G,n=W,g=a,l=$r(qr(w,l,C,T),G,x,y),a=G+B|0,a=H-((n>>>0<(f=l+L|0)>>>0)+(a=l>>>0>f>>>0?a+1|0:a)|0)|0,f=qr(n=n-f|0,a,n,a),n=G+v|0,f=n=(a=g+f|0)>>>0<f>>>0?n+1|0:n,n=$,g=a,p=$r(qr(_,p,C,T),G,x,y),a=G+F|0,a=Y-((n>>>0<(l=p+D|0)>>>0)+(a=l>>>0<p>>>0?a+1|0:a)|0)|0,l=qr(n=n-l|0,a,n,a),a=G+f|0,f=qr(n=g+l|0,n>>>0<l>>>0?a+1|0:a,x,y),l=n=G,!n&f>>>0<=1)break n;for(p=f,n=l;a=i<<1|c>>>31,c<<=1,i=a,v=!n&p>>>0>7|0!=(0|n),p=(3&n)<<30|p>>>2,n=n>>>2|0,v;);break i}}if((0|c)<(0|b))i=c<<1;else{if((0|b)<=0){h[m+8>>2]=0,h[m+12>>2]=0;break s}i=(b<<1)-2|0}i=(i<<2)+r|0,h[m+8>>2]=h[i>>2],h[m+12>>2]=h[i+4>>2]}j=1;break t}An(),S()}if(i=l,(c=f)-1|0)break r}for(;n=Xe(f,l,c,i)+c|0,a=i+G|0,n=qr(c=(1&(a=n>>>0<c>>>0?a+1|0:a))<<31|n>>>1,i=a>>>1|0,c,i),(0|l)==(0|(a=G))&n>>>0>f>>>0|a>>>0>l>>>0;);}(f=h[m+20>>2])&&(n=f-1|0,p=h[h[m+16>>2]+(n>>>3&536870908)>>2],h[m+20>>2]=n,a=qr(C,T,v=A-(a=E)|0,w=(A>>31)-((l=a>>31)+(a>>>0>A>>>0)|0)|0),_=G,l=(E=qr(E,l,x,y))+a|0,a=G+_|0,a=l>>>0<E>>>0?a+1|0:a,g=l,M=l=qr(c,i,_=M-(l=P)|0,A=(M>>31)-((E=l>>31)+(l>>>0>M>>>0)|0)|0),l=g+(p=(n=p>>>n&1)?0-l|0:l)|0,g=a,a=G,a=g+(n?0-(a+(0!=(0|M))|0)|0:a)|0,Z=m,J=$r(l,l>>>0<p>>>0?a+1|0:a,x,y),h[Z+12>>2]=J,a=qr(_,A,C,T),p=G,l=(_=qr(x,y,P,E))+a|0,a=G+p|0,a=l>>>0<_>>>0?a+1|0:a,g=l,i=qr(c,i,v,w),c=g+(l=n?i:0-i|0)|0,g=a,a=G,n=g+(n?a:0-((0!=(0|i))+a|0)|0)|0,Z=m,J=$r(c,c>>>0<l>>>0?n+1|0:n,x,y),h[Z+8>>2]=J),j=0!=(0|f)}if(N=u+80|0,!j)break e;if(!(h[e+8>>2]<=0)){for(a=h[e+32>>2],i=0;(0|(o=h[68+((n=i<<2)+e|0)>>2]))>(0|(c=h[e+16>>2]))?h[n+a>>2]=c:(n=n+a|0,c=h[e+12>>2],h[n>>2]=(0|c)>(0|o)?c:o),(0|(i=i+1|0))<(0|(o=h[e+8>>2])););if(n=0,!((0|o)<=0))for(c=(i=b<<3)+r|0,f=t+i|0;;){i=(o=n<<2)+c|0,o=h[o+f>>2]+h[o+a>>2]|0,h[i>>2]=o;t:{if((0|o)>h[e+16>>2])o=o-h[e+20>>2]|0;else{if((0|o)>=h[e+12>>2])break t;o=o+h[e+20>>2]|0}h[i>>2]=o}if(!((0|(n=n+1|0))<h[e+8>>2]))break}}if(o=(0|U)>(0|(b=b+1|0)),(0|b)==(0|q))break e;if(n=h[e+56>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>b>>>0))break}An(),S()}e=1^o}else e=0;return 1&e},function(e){var t;return h[(e|=0)>>2]=4304,h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t;h[(e|=0)>>2]=4304,h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},un,oi,hn,en,Ai,it,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0;N=o=N-32|0,h[68+(e|=0)>>2]=s,n=h[e+56>>2],i=h[n>>2],s=h[n+4>>2],h[o+24>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0;e:if(!((0|(s=s-i|0))<=0)){if((0|(i=h[n>>2]))!=h[n+4>>2])for(f=e+112|0,p=e+60|0,m=(n=s>>>2|0)>>>0>1?n:1;;){if(oe(p,h[(u<<2)+i>>2],o+16|0),i=(n=h[o+20>>2])>>31,a=(s=h[o+16>>2])>>31,l=(c=h[o+24>>2])>>31,a=(l^=l+c)+((i^i+n)+(a^s+a)|0)|0,i=0,(i=a>>>0<l>>>0?1:i)|a?(s=$r(qr(l=h[e+108>>2],d=l>>31,s,s>>31),G,a,i),h[o+16>>2]=s,i=$r(qr(l,d,n,n>>31),G,a,i),h[o+20>>2]=i,i=(n=(n=i)+(i>>=31)^i)+((i=s>>31)+s^i)|0,h[o+24>>2]=(0|c)>=0?l-i:i-l):h[o+16>>2]=h[e+108>>2],i=Br(f),s=h[o+16>>2],i?(h[o+24>>2]=0-h[o+24>>2],n=0-h[o+20>>2]|0,h[o+20>>2]=n,s=0-s|0,h[o+16>>2]=s):n=h[o+20>>2],(0|s)>=0?(s=(i=h[e+108>>2])+h[o+24>>2]|0,i=i+n|0):((0|n)<0?(i=(s=h[o+24>>2])>>31,i^=i+s):(i=(s=h[o+24>>2])>>31,i=h[e+100>>2]-(i^i+s)|0),(0|s)<0?s=(s=n)+(n>>=31)^n:(s=n,n>>=31,s=h[e+100>>2]-(s+n^n)|0)),n=h[e+100>>2],i|s?(0|n)!=(0|s)|i?(0|i)!=(0|n)|s?i||(0|(a=h[e+108>>2]))>=(0|s)?(0|i)!=(0|n)||(0|(a=h[e+108>>2]))<=(0|s)?(0|n)!=(0|s)||(0|(n=h[e+108>>2]))<=(0|i)?s||(s=0,(0|(n=h[e+108>>2]))>=(0|i)||(i=(n<<1)-i|0)):i=(n<<1)-i|0:s=(a<<1)-s|0:(s=(a<<1)-s|0,i=0):s=i:i=s:i=s=n,h[o+12>>2]=s,h[o+8>>2]=i,!(h[e+8>>2]<=0)){for(a=h[e+32>>2],s=0;(0|(n=h[e+16>>2]))<(0|i)?h[a+(s<<2)>>2]=n:(n=a+(s<<2)|0,c=h[e+12>>2],h[n>>2]=(0|c)>(0|i)?c:i),(0|(s=s+1|0))<(0|(n=h[e+8>>2]));)i=h[(o+8|0)+(s<<2)>>2];if(i=0,!((0|n)<=0))for(c=(n=u<<3)+r|0,l=t+n|0;;){n=(s=i<<2)+c|0,s=h[s+l>>2]+h[s+a>>2]|0,h[n>>2]=s;t:{if((0|s)>h[e+16>>2])s=s-h[e+20>>2]|0;else{if((0|s)>=h[e+12>>2])break t;s=s+h[e+20>>2]|0}h[n>>2]=s}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}if((0|m)==(0|(u=u+1|0)))break e;if(n=h[e+56>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>u>>>0))break}An(),S()}return N=o+32|0,1},sn,fn,vi,Yi,oe,gn,Mi,hn,wi,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a,l,c=0,u=0,d=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0;if(h[8+(e|=0)>>2]=n,p=h[(i=e+32|0)>>2],(s=h[e+36>>2]-p>>2)>>>0<n>>>0?(er(i,n-s|0),p=h[i>>2],i=h[e+8>>2]):(n>>>0<s>>>0&&(h[e+36>>2]=(n<<2)+p),i=n),l=h[e+52>>2],o=h[e+48>>2],s=0,g=St(mi(g=(1073741823&n)!=(0|n)?-1:n<<2),0,g),!((0|i)<=0)){for(;(0|(c=h[(i=s<<2)+g>>2]))>(0|(d=h[e+16>>2]))?h[i+p>>2]=d:(i=i+p|0,d=h[e+12>>2],h[i>>2]=(0|d)>(0|c)?d:c),(0|(i=h[e+8>>2]))>(0|(s=s+1|0)););if(!((0|i)<=0))for(s=0;;){i=(c=s<<2)+r|0,c=h[t+c>>2]+h[c+p>>2]|0,h[i>>2]=c;e:{if((0|c)>h[e+16>>2])u=c-h[e+20>>2]|0;else{if((0|c)>=h[e+12>>2])break e;u=c+h[e+20>>2]|0}h[i>>2]=u}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}if(s=h[e+56>>2],a=h[s>>2],(0|(s=h[s+4>>2]-a|0))>=5)for(b=(0|(s>>=2))>2?s:2,y=s>>>0>1?s:1,E=-2&n,w=1&n,p=1;;){e:{t:{if((0|p)!=(0|y)){if(_=v(n,p),-1==(0|(s=h[(p<<2)+a>>2])))break t;if(-1==(0|(s=h[h[o+12>>2]+(s<<2)>>2])))break t;d=h[l>>2],c=h[o>>2],f=h[d+(h[c+(s<<2)>>2]<<2)>>2],u=-1!=(0|(u=((u=s+1|0)>>>0)%3|0?u:s-2|0))?h[c+(u<<2)>>2]:-1;r:{if((s>>>0)%3|0)s=s-1|0;else if(m=-1,-1==(0|(s=s+2|0)))break r;m=h[c+(s<<2)>>2]}if((0|f)>=(0|p))break t;if((0|(s=h[(u<<2)+d>>2]))>=(0|p))break t;if((0|(c=h[d+(m<<2)>>2]))>=(0|p))break t;if(!((0|n)<=0)){if(c=v(n,c),d=v(n,s),f=v(n,f),s=0,m=0,1!=(0|n))for(;h[g+(s<<2)>>2]=(h[(s+c<<2)+r>>2]+h[(s+d<<2)+r>>2]|0)-h[(s+f<<2)+r>>2],h[g+((u=1|s)<<2)>>2]=(h[(c+u<<2)+r>>2]+h[(d+u<<2)+r>>2]|0)-h[(u+f<<2)+r>>2],s=s+2|0,(0|E)!=(0|(m=m+2|0)););w&&(h[g+(s<<2)>>2]=(h[(s+c<<2)+r>>2]+h[(s+d<<2)+r>>2]|0)-h[(s+f<<2)+r>>2])}if((0|i)<=0)break e;for(d=h[e+32>>2],s=0;(0|(c=h[(i=s<<2)+g>>2]))>(0|(f=h[e+16>>2]))?h[i+d>>2]=f:(i=i+d|0,f=h[e+12>>2],h[i>>2]=(0|f)>(0|c)?f:c),(0|(i=h[e+8>>2]))>(0|(s=s+1|0)););if(s=0,(0|i)<=0)break e;for(f=(i=_<<2)+r|0,u=t+i|0;;){i=(c=s<<2)+f|0,c=h[c+u>>2]+h[c+d>>2]|0,h[i>>2]=c;r:{if((0|c)>h[e+16>>2])m=c-h[e+20>>2]|0;else{if((0|c)>=h[e+12>>2])break r;m=c+h[e+20>>2]|0}h[i>>2]=m}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}break e}An(),S()}if(!((0|i)<=0)){for(f=(v(p-1|0,n)<<2)+r|0,d=h[e+32>>2],s=0;(0|(c=h[(i=s<<2)+f>>2]))>(0|(u=h[e+16>>2]))?h[i+d>>2]=u:(i=i+d|0,u=h[e+12>>2],h[i>>2]=(0|u)>(0|c)?u:c),(0|(i=h[e+8>>2]))>(0|(s=s+1|0)););if(s=0,!((0|i)<=0))for(f=(i=_<<2)+r|0,u=t+i|0;;){i=(c=s<<2)+f|0,c=h[c+u>>2]+h[c+d>>2]|0,h[i>>2]=c;t:{if((0|c)>h[e+16>>2])m=c-h[e+20>>2]|0;else{if((0|c)>=h[e+12>>2])break t;m=c+h[e+20>>2]|0}h[i>>2]=m}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}}if((0|b)==(0|(p=p+1|0)))break}return ve(g),1},gn,Mi,cn,wi,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a,l,c=0,u=0,d=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0;if(h[8+(e|=0)>>2]=n,d=h[(i=e+32|0)>>2],(s=h[e+36>>2]-d>>2)>>>0<n>>>0?(er(i,n-s|0),d=h[i>>2],i=h[e+8>>2]):(n>>>0<s>>>0&&(h[e+36>>2]=(n<<2)+d),i=n),o=St(mi(s=(1073741823&n)!=(0|n)?-1:n<<2),0,s),a=St(mi(s),0,s),!((0|i)<=0)){for(;(0|(s=h[(i=c<<2)+o>>2]))>(0|(u=h[e+16>>2]))?h[i+d>>2]=u:(i=i+d|0,u=h[e+12>>2],h[i>>2]=(0|u)>(0|s)?u:s),(0|(i=h[e+8>>2]))>(0|(c=c+1|0)););if(!((0|i)<=0))for(s=0;;){i=(u=s<<2)+r|0,u=h[t+u>>2]+h[u+d>>2]|0,h[i>>2]=u;e:{if((0|u)>h[e+16>>2])c=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break e;c=u+h[e+20>>2]|0}h[i>>2]=c}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}if(s=h[e+56>>2],l=h[s>>2],(0|(s=h[s+4>>2]-l|0))>=5)for(C=h[e+52>>2],w=h[e+48>>2],R=(0|(s>>=2))>2?s:2,I=s>>>0>1?s:1,x=-2&n,A=1&n,O=-4&n,T=3&n,E=n-1|0,P=n<<2,_=1;;){e:{t:{r:{i:if((0|_)==(0|I))An(),S();else{if(u=h[(_<<2)+l>>2],(y=(0|n)<=0)||St(o,0,P),-1==(0|u)){u=v(n,_);break t}for(M=h[w+12>>2],m=0,s=u;;){if(-1!=(0|(c=h[(s<<2)+M>>2]))){f=h[C>>2],d=h[w>>2],b=h[f+(h[d+(c<<2)>>2]<<2)>>2],p=-1!=(0|(p=((p=c+1|0)>>>0)%3|0?p:c-2|0))?h[d+(p<<2)>>2]:-1;n:{if((c>>>0)%3|0)c=c-1|0;else if(g=-1,-1==(0|(c=c+2|0)))break n;g=h[d+(c<<2)>>2]}if(!((0|_)<=(0|b)||(0|(c=h[(p<<2)+f>>2]))>=(0|_)||(0|(d=h[f+(g<<2)>>2]))>=(0|_))){if(!y){if(d=v(n,d),f=v(n,c),b=v(n,b),c=0,g=0,E)for(;h[(c<<2)+a>>2]=(h[(c+d<<2)+r>>2]+h[(c+f<<2)+r>>2]|0)-h[(c+b<<2)+r>>2],h[((p=1|c)<<2)+a>>2]=(h[(d+p<<2)+r>>2]+h[(f+p<<2)+r>>2]|0)-h[(p+b<<2)+r>>2],c=c+2|0,(0|x)!=(0|(g=g+2|0)););if(A&&(h[(c<<2)+a>>2]=(h[(c+d<<2)+r>>2]+h[(c+f<<2)+r>>2]|0)-h[(c+b<<2)+r>>2]),!y){if(b=0,c=0,d=0,E>>>0>2)for(;h[(p=(f=c<<2)+o|0)>>2]=h[p>>2]+h[f+a>>2],h[(g=(p=4|f)+o|0)>>2]=h[g>>2]+h[p+a>>2],h[(g=(p=8|f)+o|0)>>2]=h[g>>2]+h[p+a>>2],h[(p=(f|=12)+o|0)>>2]=h[p>>2]+h[f+a>>2],c=c+4|0,(0|O)!=(0|(d=d+4|0)););if(T)for(;h[(f=(d=c<<2)+o|0)>>2]=h[f>>2]+h[d+a>>2],c=c+1|0,(0|T)!=(0|(b=b+1|0)););}}m=m+1|0}}n:{if((s>>>0)%3|0)s=s-1|0;else if(c=-1,-1==(0|(s=s+2|0)))break n;c=-1,-1!=(0|(s=h[(s<<2)+M>>2]))&&(c=s-1|0,(s>>>0)%3|0||(c=s+2|0))}if(-1==(0|(s=(0|c)==(0|u)?-1:c)))break}if(u=v(n,_),!m)break t;if(y)break r;if(c=0,s=0,!E)break i;for(;h[(f=(d=c<<2)+o|0)>>2]=h[f>>2]/(0|m),h[(d=(4|d)+o|0)>>2]=h[d>>2]/(0|m),c=c+2|0,(0|x)!=(0|(s=s+2|0)););}A&&(h[(s=(c<<2)+o|0)>>2]=h[s>>2]/(0|m))}if((0|i)<=0)break e;for(d=h[e+32>>2],c=0;(0|(s=h[(i=c<<2)+o>>2]))>(0|(m=h[e+16>>2]))?h[i+d>>2]=m:(i=i+d|0,m=h[e+12>>2],h[i>>2]=(0|m)>(0|s)?m:s),(0|(i=h[e+8>>2]))>(0|(c=c+1|0)););if(s=0,(0|i)<=0)break e;for(c=(i=u<<2)+r|0,m=t+i|0;;){i=(u=s<<2)+c|0,u=h[u+m>>2]+h[u+d>>2]|0,h[i>>2]=u;r:{if((0|u)>h[e+16>>2])u=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break r;u=u+h[e+20>>2]|0}h[i>>2]=u}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}break e}if(!((0|i)<=0)){for(m=(v(_-1|0,n)<<2)+r|0,d=h[e+32>>2],c=0;(0|(s=h[(i=c<<2)+m>>2]))>(0|(f=h[e+16>>2]))?h[i+d>>2]=f:(i=i+d|0,f=h[e+12>>2],h[i>>2]=(0|f)>(0|s)?f:s),(0|(i=h[e+8>>2]))>(0|(c=c+1|0)););if(s=0,!((0|i)<=0))for(c=(i=u<<2)+r|0,m=t+i|0;;){i=(u=s<<2)+c|0,u=h[u+m>>2]+h[u+d>>2]|0,h[i>>2]=u;t:{if((0|u)>h[e+16>>2])u=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break t;u=u+h[e+20>>2]|0}h[i>>2]=u}if(!((0|(i=h[e+8>>2]))>(0|(s=s+1|0))))break}}}if((0|R)==(0|(_=_+1|0)))break}return ve(a),ve(o),1},function(e){var t=0;return h[(e|=0)>>2]=5608,(t=h[e+96>>2])&&ve(t),(t=h[e+84>>2])&&ve(t),(t=h[e+72>>2])&&ve(t),(t=h[e+60>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t=0;h[(e|=0)>>2]=5608,(t=h[e+96>>2])&&ve(t),(t=h[e+84>>2])&&ve(t),(t=h[e+72>>2])&&ve(t),(t=h[e+60>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},an,wi,Ae,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a,l,c,u=0,d=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,G=0,D=0;N=o=N+-64|0,h[8+(e|=0)>>2]=n,u=h[(s=e+32|0)>>2];e:{if((i=h[e+36>>2]-u>>2)>>>0<n>>>0)er(s,n-i|0),h[o+56>>2]=0,h[o+60>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o>>2]=0;else if(i>>>0>n>>>0&&(h[e+36>>2]=u+(n<<2)),h[o+56>>2]=0,h[o+60>>2]=0,h[o+48>>2]=0,h[o+52>>2]=0,h[o+40>>2]=0,h[o+44>>2]=0,h[o+32>>2]=0,h[o+36>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o>>2]=0,i=0,!n)break e;$e(o+16|0,n,o),d=h[o+28>>2],i=h[o+32>>2]}h[o>>2]=0;e:if((i=i-d>>2)>>>0>=n>>>0){if(i>>>0<=n>>>0)break e;h[o+32>>2]=(n<<2)+d}else $e(o+16|12,n-i|0,o);h[o>>2]=0,s=h[o+40>>2];e:if((i=h[o+44>>2]-s>>2)>>>0>=n>>>0){if(i>>>0<=n>>>0)break e;h[o+44>>2]=s+(n<<2)}else $e(o+40|0,n-i|0,o);h[o>>2]=0,s=h[o+52>>2];e:if((i=h[o+56>>2]-s>>2)>>>0>=n>>>0){if(i>>>0<=n>>>0)break e;h[o+56>>2]=s+(n<<2)}else $e(o+52|0,n-i|0,o);if(d=0,!(h[e+8>>2]<=0)){for(p=h[e+32>>2],u=h[o+16>>2];(0|(s=h[(i=d<<2)+u>>2]))>(0|(_=h[e+16>>2]))?h[i+p>>2]=_:(i=i+p|0,_=h[e+12>>2],h[i>>2]=(0|_)>(0|s)?_:s),(0|(d=d+1|0))<(0|(i=h[e+8>>2])););if(!((0|i)<=0))for(i=0;;){s=(u=i<<2)+r|0,u=h[t+u>>2]+h[u+p>>2]|0,h[s>>2]=u;e:{if((0|u)>h[e+16>>2])f=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break e;f=u+h[e+20>>2]|0}h[s>>2]=f}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}c=h[e+52>>2],l=h[e+48>>2],a=mi(16),h[(i=a)>>2]=0,h[i+4>>2]=0,h[i+8>>2]=0,h[i+12>>2]=0,h[o+8>>2]=0,h[o>>2]=0,h[o+4>>2]=0;e:{if(n){if(n>>>0>=1073741824)break e;T=mi(i=n<<2),h[o>>2]=T,h[o+8>>2]=i+T,St(T,0,i)}w=1,i=h[e+56>>2],R=h[i>>2];t:if(!((0|(i=h[i+4>>2]-R|0))<5))for(k=(0|(i>>=2))>2?i:2,L=i>>>0>1?i:1,I=-2&n,O=1&n,G=-4&n,P=3&n,M=n-1|0,D=n<<2,_=1;;){r:{i:{n:{s:{if((0|_)!=(0|L)){i=((s=h[(_<<2)+R>>2])>>>0)%3|0;o:{a:if(-1!=(0|s)){p=0,C=0!=(0|i)|-1!=(0|(u=s+2|0)),E=(x=h[l+12>>2])+((i?s-1|0:u)<<2)|0,b=1,i=s;l:{for(;;){if(-1!=(0|(u=h[x+(i<<2)>>2]))){m=-1,w=h[c>>2],g=h[l>>2],d=w+(h[g+(u<<2)>>2]<<2)|0,-1!=(0|(y=((y=u+1|0)>>>0)%3|0?y:u-2|0))&&(m=h[g+(y<<2)>>2]),y=h[d>>2];c:{if((u>>>0)%3|0)d=u-1|0;else if(f=-1,-1==(0|(d=u+2|0)))break c;f=h[g+(d<<2)>>2]}if(!((0|_)<=(0|y)||(0|(d=h[w+(m<<2)>>2]))>=(0|_)||(0|(m=h[w+(f<<2)>>2]))>=(0|_))){if(u=h[(o+16|0)+v(p,12)>>2],n){if(m=v(n,m),g=v(n,d),w=v(n,y),d=0,f=0,M)for(;h[u+(d<<2)>>2]=(h[(d+m<<2)+r>>2]+h[(d+g<<2)+r>>2]|0)-h[(d+w<<2)+r>>2],h[u+((y=1|d)<<2)>>2]=(h[(m+y<<2)+r>>2]+h[(g+y<<2)+r>>2]|0)-h[(y+w<<2)+r>>2],d=d+2|0,(0|I)!=(0|(f=f+2|0)););O&&(h[u+(d<<2)>>2]=(h[(d+m<<2)+r>>2]+h[(d+g<<2)+r>>2]|0)-h[(d+w<<2)+r>>2])}if(u=4,4==(0|(p=p+1|0)))break l}}c:if(1&b){if(f=-1,-1==(0|(i=((d=i+1|0)>>>0)%3|0?d:i-2|0)))break c;if(f=-1,-1==(0|(i=h[x+(i<<2)>>2])))break c;f=((u=i+1|0)>>>0)%3|0?u:i-2|0}else{if((i>>>0)%3|0)d=i-1|0;else if(f=-1,-1==(0|(d=i+2|0)))break c;f=-1,-1!=(0|(i=h[x+(d<<2)>>2]))&&(f=i-1|0,(i>>>0)%3|0||(f=i+2|0))}c:if((0|s)!=(0|(i=f))){if(!(1&(1^b)|-1!=(0|i))){if(!C)break c;if(-1==(0|(i=h[E>>2])))break c;b=0,i=(i>>>0)%3|0?i-1|0:i+2|0}if(-1!=(0|i))continue}break}if((0|(u=p))<=0)break a}for(n&&St(h[o>>2],0,D),y=((i=u-1|0)<<2)+a|0,f=i=v(i,12)+e|0,C=h[i- -64>>2],w=0,b=0,i=0;;){if(s=h[y>>2],h[y>>2]=s+1,s>>>0>=C>>>0)break t;if(!(h[h[f+60>>2]+(s>>>3&536870908)>>2]>>>s&1)&&(i=i+1|0,n)){if(p=h[o>>2],x=h[(o+16|0)+v(b,12)>>2],m=0,d=0,s=0,M>>>0>=3)for(;h[(E=(g=d<<2)+p|0)>>2]=h[E>>2]+h[g+x>>2],h[(A=(E=4|g)+p|0)>>2]=h[A>>2]+h[x+E>>2],h[(A=(E=8|g)+p|0)>>2]=h[A>>2]+h[x+E>>2],h[(E=(g|=12)+p|0)>>2]=h[E>>2]+h[g+x>>2],d=d+4|0,(0|G)!=(0|(s=s+4|0)););if(P)for(;h[(g=(s=d<<2)+p|0)>>2]=h[g>>2]+h[s+x>>2],d=d+1|0,(0|P)!=(0|(m=m+1|0)););}if((0|(b=b+1|0))==(0|u))break}if(s=b=v(n,_),!i)break o;if(!n)break i;if(s=h[o>>2],d=0,u=0,M)break s;break n}s=v(n,_)}if(h[e+8>>2]<=0)break r;for(b=(v(_-1|0,n)<<2)+r|0,p=h[e+32>>2],d=0;(0|(u=h[(i=d<<2)+b>>2]))>(0|(m=h[e+16>>2]))?h[i+p>>2]=m:(i=i+p|0,m=h[e+12>>2],h[i>>2]=(0|m)>(0|u)?m:u),(0|(d=d+1|0))<(0|(u=h[e+8>>2])););if(i=0,(0|u)<=0)break r;for(d=(s<<=2)+r|0,b=t+s|0;;){s=(u=i<<2)+d|0,u=h[u+b>>2]+h[u+p>>2]|0,h[s>>2]=u;o:{if((0|u)>h[e+16>>2])f=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break o;f=u+h[e+20>>2]|0}h[s>>2]=f}if(!((0|(i=i+1|0))<h[e+8>>2]))break}break r}An(),S()}for(;h[(m=(p=d<<2)+s|0)>>2]=h[m>>2]/(0|i),h[(p=s+(4|p)|0)>>2]=h[p>>2]/(0|i),d=d+2|0,(0|I)!=(0|(u=u+2|0)););}O&&(h[(s=s+(d<<2)|0)>>2]=h[s>>2]/(0|i))}if(!(h[e+8>>2]<=0)){for(p=h[e+32>>2],d=0;(0|(s=h[(i=d<<2)+T>>2]))>(0|(u=h[e+16>>2]))?h[i+p>>2]=u:(i=i+p|0,u=h[e+12>>2],h[i>>2]=(0|u)>(0|s)?u:s),(0|(d=d+1|0))<(0|(s=h[e+8>>2])););if(i=0,!((0|s)<=0))for(d=(s=b<<2)+r|0,b=t+s|0;;){s=(u=i<<2)+d|0,u=h[u+b>>2]+h[u+p>>2]|0,h[s>>2]=u;i:{if((0|u)>h[e+16>>2])f=u-h[e+20>>2]|0;else{if((0|u)>=h[e+12>>2])break i;f=u+h[e+20>>2]|0}h[s>>2]=f}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}}if(w=1,(0|k)==(0|(_=_+1|0)))break}return(e=h[o>>2])&&ve(e),ve(a),(e=h[o+52>>2])&&(h[o+56>>2]=e,ve(e)),(e=h[o+40>>2])&&(h[o+44>>2]=e,ve(e)),(e=h[o+28>>2])&&(h[o+32>>2]=e,ve(e)),(e=h[o+16>>2])&&(h[o+20>>2]=e,ve(e)),N=o- -64|0,0|w}vn(),S()},function(e){var t=0;return h[(e|=0)>>2]=5844,(t=h[e+76>>2])&&ve(t),t=h[e+68>>2],h[e+68>>2]=0,t&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t=0;h[(e|=0)>>2]=5844,(t=h[e+76>>2])&&ve(t),t=h[e+68>>2],h[e+68>>2]=0,t&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},on,yi,hn,en,xi,Ue,function(e,t,r,i,n,o){e|=0,t|=0,r|=0,i|=0,n|=0,o|=0;var a=0,l=0,c=_(0),u=0,f=_(0),p=0,g=_(0),y=_(0),E=_(0),w=0,A=_(0),M=0,C=_(0),R=_(0),I=_(0),O=_(0),P=_(0),k=_(0),L=_(0),G=_(0),D=_(0),U=0,V=_(0);h[e+64>>2]=o,h[e+72>>2]=n,o=mi((1073741823&n)!=(0|n)?-1:n<<2),i=h[e+68>>2],h[e+68>>2]=o,i&&ve(i),h[e+8>>2]=n,a=h[(o=e+32|0)>>2],(i=h[e+36>>2]-a>>2)>>>0<n>>>0?er(o,n-i|0):i>>>0<=n>>>0||(h[e+36>>2]=a+(n<<2));e:if(i=h[e+56>>2],!((0|(i=(a=h[i+4>>2])-(o=h[i>>2])|0))<=0)){if((0|o)!=(0|a))for(U=(i=i>>>2|0)>>>0>1?i:1;;){if(f=_(0),N=a=N-48|0,l=-1,-1==(0|(i=h[(p<<2)+o>>2]))||(u=h[e+48>>2],-1!=(0|(o=((o=i+1|0)>>>0)%3|0?o:i-2|0))&&(l=h[h[u>>2]+(o<<2)>>2]),o=-1,-1!=(0|(i=i+((i>>>0)%3|0?-1:2)|0))&&(o=h[h[u>>2]+(i<<2)>>2]),i=h[e+52>>2],u=h[i>>2],(i=h[i+4>>2]-u>>2)>>>0<=l>>>0|i>>>0<=o>>>0))An(),S();else{i=h[u+(l<<2)>>2];t:if((0|(u=h[u+(o<<2)>>2]))>=(0|p)|(0|i)>=(0|p)){if((0|i)<(0|p))o=h[e+72>>2],i=v(i,o);else{if(o=0,(0|p)<=0){if(h[e+72>>2]<=0)break t;for(i=h[e+68>>2];h[i+(o<<2)>>2]=0,(0|(o=o+1|0))<h[e+72>>2];);break t}o=h[e+72>>2],i=v(o,p-1|0)}if(!((0|o)<=0))for(l=h[e+68>>2],o=0;h[l+(o<<2)>>2]=h[(i+o<<2)+r>>2],(0|(o=o+1|0))<h[e+72>>2];);}else{if(o=h[e+72>>2],l=(v(o,u)<<2)+r|0,g=_(h[l+4>>2]),o=(v(i,o)<<2)+r|0,A=_(h[o+4>>2]),!((C=_(h[l>>2]))!=(k=_(h[o>>2]))|g!=A)){if(i=h[e+68>>2],o=_(b(g))<_(2147483648)?~~g:-2147483648,h[i+4>>2]=o,_(b(C))<_(2147483648)){h[i>>2]=~~C;break t}h[i>>2]=-2147483648;break t}o=h[h[e+64>>2]+(p<<2)>>2],h[a+40>>2]=0,h[a+32>>2]=0,h[a+36>>2]=0,l=h[e+60>>2],d[l+84|0]||(o=h[h[l+68>>2]+(o<<2)>>2]),Z(l,o,s[l+24|0],a+32|0),o=h[h[e+64>>2]+(i<<2)>>2],h[a+24>>2]=0,h[a+16>>2]=0,h[a+20>>2]=0,i=h[e+60>>2],d[i+84|0]||(o=h[h[i+68>>2]+(o<<2)>>2]),Z(i,o,s[i+24|0],a+16|0),o=h[h[e+64>>2]+(u<<2)>>2],h[a+8>>2]=0,h[a>>2]=0,h[a+4>>2]=0,i=h[e+60>>2],d[i+84|0]||(o=h[h[i+68>>2]+(o<<2)>>2]),Z(i,o,s[i+24|0],a),R=m[a+40>>2],I=m[a+36>>2],V=m[a+32>>2],y=m[a+24>>2],c=_(m[a+8>>2]-y),G=m[a+20>>2],O=_(m[a+4>>2]-G),D=m[a+16>>2],P=_(m[a>>2]-D),!((L=_(_(c*c)+_(_(O*O)+_(_(P*P)+_(0)))))>_(0))&&(E=_(0),h[e+88>>2]>257)||(y=_(R-y),R=_(I-G),I=_(V-D),f=_(_(_(c*y)+_(_(O*R)+_(_(P*I)+_(0))))/L),c=_(y-_(c*f)),y=_(c*c),c=_(R-_(O*f)),E=_(c*c),c=_(I-_(P*f)),E=_(T(_(_(y+_(E+_(_(c*c)+_(0))))/L)))),y=E,i=h[e+80>>2]-1|0,o=h[h[e+76>>2]+(i>>>3&536870908)>>2],h[e+80>>2]=i,c=_(g-A),E=_(_(c*f)+A),A=_(C-k),g=_(A*y),g=_(E+((i=o>>>i&1)?g:_(-g))),E=_(_(A*f)+k),f=_(c*y),(f=_(E+(i?_(-f):f)))==f?(o=h[e+68>>2],M=x(+f+.5),i=b(M)<2147483648?~~M:-2147483648,h[o>>2]=i):(o=h[e+68>>2],h[o>>2]=-2147483648),M=x(+g+.5),i=b(M)<2147483648?~~M:-2147483648,h[o+4>>2]=g!=g?-2147483648:i}N=a+48|0}if(!(h[e+8>>2]<=0)){for(l=h[e+32>>2],u=h[e+68>>2],o=0;(0|(a=h[(i=o<<2)+u>>2]))>(0|(w=h[e+16>>2]))?h[i+l>>2]=w:(i=i+l|0,w=h[e+12>>2],h[i>>2]=(0|w)>(0|a)?w:a),(0|(o=o+1|0))<(0|(a=h[e+8>>2])););if(i=0,!((0|a)<=0))for(u=(o=v(n,p)<<2)+r|0,w=t+o|0;;){o=(a=i<<2)+u|0,a=h[a+w>>2]+h[a+l>>2]|0,h[o>>2]=a;t:{if((0|a)>h[e+16>>2])a=a-h[e+20>>2]|0;else{if((0|a)>=h[e+12>>2])break t;a=a+h[e+20>>2]|0}h[o>>2]=a}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}if((0|U)==(0|(p=p+1|0)))break e;if(i=h[e+56>>2],o=h[i>>2],!(h[i+4>>2]-o>>2>>>0>p>>>0))break}An(),S()}return 1},function(e){var t=0;return h[(e|=0)>>2]=6060,(t=h[e+76>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t=0;h[(e|=0)>>2]=6060,(t=h[e+76>>2])&&ve(t),h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},ln,yi,hn,en,xi,Be,function(e,t,r,i,n,o){e|=0,t|=0,r|=0,i|=0,o|=0;var a=0,l=0,c=0,u=0,f=0,p=0,m=0,g=0,v=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,D=0,U=0,V=0,B=0,F=0,j=0,z=0,W=0,H=0,$=0,Y=0,q=0,X=0,Z=0;if(2==(0|(n|=0))){h[e+8>>2]=2,h[e- -64>>2]=o,o=h[(n=e+32|0)>>2],(i=h[e+36>>2]-o|0)>>>0<=7?er(n,2-(i>>>2|0)|0):8!=(0|i)&&(h[e+36>>2]=o+8);e:if(i=h[e+56>>2],(0|(o=(n=h[i+4>>2])-(i=h[i>>2])|0))<=0)o=0;else{if((0|i)!=(0|n))for(m=e+60|0,q=(0|(D=o>>2))>1?D:1,o=1;;){if(N=c=N-80|0,n=-1,-1==(0|(a=h[(_<<2)+i>>2]))||(l=h[m+32>>2],-1!=(0|(i=((i=a+1|0)>>>0)%3|0?i:a-2|0))&&(n=h[h[l>>2]+(i<<2)>>2]),i=-1,-1!=(0|(a=a+((a>>>0)%3|0?-1:2)|0))&&(i=h[h[l>>2]+(a<<2)>>2]),l=h[m+36>>2],a=h[l>>2],(l=h[l+4>>2]-a>>2)>>>0<=n>>>0|i>>>0>=l>>>0))An(),S();else{l=h[a+(n<<2)>>2];t:{r:{i:{n:{s:{if(!((0|(a=h[a+(i<<2)>>2]))>=(0|_)|(0|l)>=(0|_))){if(T=h[4+(i=(a<<3)+r|0)>>2],y=h[4+(n=(l<<3)+r|0)>>2],!((0|(w=h[i>>2]))!=(0|(P=h[n>>2]))|(0|y)!=(0|T))){h[m+8>>2]=P,h[m+12>>2]=y;break s}if(i=h[h[m+4>>2]+(_<<2)>>2],h[c+72>>2]=0,h[c+76>>2]=0,h[(n=c- -64|0)>>2]=0,h[n+4>>2]=0,h[c+56>>2]=0,h[c+60>>2]=0,n=h[m>>2],d[n+84|0]||(i=h[h[n+68>>2]+(i<<2)>>2]),se(n,i,s[n+24|0],c+56|0),i=h[h[m+4>>2]+(l<<2)>>2],h[c+48>>2]=0,h[c+52>>2]=0,h[c+40>>2]=0,h[c+44>>2]=0,h[c+32>>2]=0,h[c+36>>2]=0,n=h[m>>2],d[n+84|0]||(i=h[h[n+68>>2]+(i<<2)>>2]),se(n,i,s[n+24|0],c+32|0),n=h[h[m+4>>2]+(a<<2)>>2],h[c+24>>2]=0,h[c+28>>2]=0,h[c+16>>2]=0,h[c+20>>2]=0,h[c+8>>2]=0,h[c+12>>2]=0,i=h[m>>2],d[i+84|0]||(n=h[h[i+68>>2]+(n<<2)>>2]),se(i,n,s[i+24|0],c+8|0),U=h[c+44>>2],i=qr(g=(i=h[c+16>>2])-(n=M=h[c+40>>2])|0,f=h[c+20>>2]-(U+(i>>>0<n>>>0)|0)|0,g,f),n=G,v=i,V=h[c+36>>2],a=qr(x=(i=h[c+8>>2])-(a=k=h[c+32>>2])|0,u=h[c+12>>2]-(V+(i>>>0<a>>>0)|0)|0,x,u),n=G+n|0,n=(i=v+a|0)>>>0<a>>>0?n+1|0:n,v=i,B=h[c+52>>2],b=qr(E=(i=h[c+24>>2])-(a=L=h[c+48>>2])|0,p=h[c+28>>2]-(B+(i>>>0<a>>>0)|0)|0,E,p),a=G+n|0,A=i=v+b|0,i|(b=i>>>0<b>>>0?a+1|0:a)){if(i=qr((i=j=h[c+64>>2])-M|0,(z=h[c+68>>2])-((i>>>0<M>>>0)+U|0)|0,g,f),n=G,i=(a=i)+(l=qr((i=W=h[c+56>>2])-k|0,(H=h[c+60>>2])-((i>>>0<k>>>0)+V|0)|0,x,u))|0,a=G+n|0,a=i>>>0<l>>>0?a+1|0:a,i=(n=i)+(l=qr((i=$=h[c+72>>2])-L|0,(Y=h[c+76>>2])-((i>>>0<L>>>0)+B|0)|0,E,p))|0,n=G+a|0,R=i,C=i>>>0<l>>>0?n+1|0:n,a=(i=p>>31)+p|0,l=(n=i+E|0)^i,F=i^=a=n>>>0<i>>>0?a+1|0:a,n=(i=f>>31)+f|0,I=(a=i+g|0)^i,v=i^=a>>>0<i>>>0?n+1|0:n,n=0,a=(i=u>>31)+u|0,a=(O=i+x|0)>>>0<i>>>0?a+1|0:a,O^=i,(a=Xe(-1,2147483647,(a=(0|F)==(0|(i=(a=(0|v)==(0|(i^=a))&I>>>0>O>>>0|i>>>0<v>>>0)?v:i))&l>>>0>(I=a?I:O)>>>0|i>>>0<F>>>0)?l:I,a?F:i)>>>0<R>>>0)&(0|(i=G))<=(0|C)|(0|i)<(0|C))break t;if(l=1,i=0,n=j,g=$r(qr(g,f,R,C),G,A,b),a=G+U|0,a=z-((n>>>0<(f=g+M|0)>>>0)+(a=f>>>0<g>>>0?a+1|0:a)|0)|0,a=qr(n=n-f|0,a,n,a),g=G,n=W,v=a,u=$r(qr(x,u,R,C),G,A,b),a=G+V|0,a=H-((n>>>0<(f=u+k|0)>>>0)+(a=u>>>0>f>>>0?a+1|0:a)|0)|0,f=qr(n=n-f|0,a,n,a),n=G+g|0,f=n=(a=v+f|0)>>>0<f>>>0?n+1|0:n,n=$,v=a,p=$r(qr(E,p,R,C),G,A,b),a=G+B|0,a=Y-((n>>>0<(u=p+L|0)>>>0)+(a=u>>>0<p>>>0?a+1|0:a)|0)|0,u=qr(n=n-u|0,a,n,a),a=G+f|0,f=qr(n=v+u|0,n>>>0<u>>>0?a+1|0:a,A,b),u=n=G,!n&f>>>0<=1)break n;for(p=f,n=u;a=i<<1|l>>>31,l<<=1,i=a,g=!n&p>>>0>7|0!=(0|n),p=(3&n)<<30|p>>>2,n=n>>>2|0,g;);break i}}if((0|l)<(0|_))i=l<<1;else{if((0|_)<=0){h[m+8>>2]=0,h[m+12>>2]=0;break s}i=(_<<1)-2|0}i=(i<<2)+r|0,h[m+8>>2]=h[i>>2],h[m+12>>2]=h[i+4>>2]}n=1;break t}if(i=u,(l=f)-1|0)break r}for(;a=Xe(f,u,l,i)+l|0,n=i+G|0,n=qr(l=(1&(n=a>>>0<l>>>0?n+1|0:n))<<31|a>>>1,i=n>>>1|0,l,i),(0|u)==(0|(a=G))&n>>>0>f>>>0|a>>>0>u>>>0;);}(f=h[m+20>>2])&&(n=f-1|0,p=h[h[m+16>>2]+(n>>>3&536870908)>>2],h[m+20>>2]=n,a=qr(R,C,g=T-(a=y)|0,x=(T>>31)-((u=a>>31)+(a>>>0>T>>>0)|0)|0),E=G,u=(y=qr(y,u,A,b))+a|0,a=G+E|0,a=u>>>0<y>>>0?a+1|0:a,v=u,w=u=qr(l,i,E=w-(u=P)|0,T=(w>>31)-((y=u>>31)+(u>>>0>w>>>0)|0)|0),p=v+(M=(n=u=p>>>n&1)?0-w|0:w)|0,v=a,a=G,n=v+(n?0-(a+(0!=(0|w))|0)|0:a)|0,X=m,Z=$r(p,p>>>0<M>>>0?n+1|0:n,A,b),h[X+12>>2]=Z,n=qr(E,T,R,C),a=G,p=qr(A,b,P,y),a=G+a|0,a=(n=p+n|0)>>>0<p>>>0?a+1|0:a,i=qr(l,i,g,x),l=(p=u?i:0-i|0)+n|0,n=G,n=(u?n:0-((0!=(0|i))+n|0)|0)+a|0,X=m,Z=$r(l,l>>>0<p>>>0?n+1|0:n,A,b),h[X+8>>2]=Z),n=0!=(0|f)}N=c+80|0}if(!n)break e;if(!(h[e+8>>2]<=0)){for(a=h[e+32>>2],i=0;(0|(o=h[68+((n=i<<2)+e|0)>>2]))>(0|(l=h[e+16>>2]))?h[n+a>>2]=l:(n=n+a|0,l=h[e+12>>2],h[n>>2]=(0|l)>(0|o)?l:o),(0|(i=i+1|0))<(0|(o=h[e+8>>2])););if(n=0,!((0|o)<=0))for(l=(i=_<<3)+r|0,f=t+i|0;;){i=(o=n<<2)+l|0,o=h[o+f>>2]+h[o+a>>2]|0,h[i>>2]=o;t:{if((0|o)>h[e+16>>2])o=o-h[e+20>>2]|0;else{if((0|o)>=h[e+12>>2])break t;o=o+h[e+20>>2]|0}h[i>>2]=o}if(!((0|(n=n+1|0))<h[e+8>>2]))break}}if(o=(0|D)>(0|(_=_+1|0)),(0|_)==(0|q))break e;if(n=h[e+56>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>_>>>0))break}An(),S()}e=1^o}else e=0;return 1&e},function(e){var t;return h[(e|=0)>>2]=6284,h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),0|e},function(e){var t;h[(e|=0)>>2]=6284,h[e>>2]=3300,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),ve(e)},un,oi,hn,en,Ai,it,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0;N=o=N-32|0,h[68+(e|=0)>>2]=s,n=h[e+56>>2],i=h[n>>2],s=h[n+4>>2],h[o+24>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0;e:if(!((0|(s=s-i|0))<=0)){if((0|(i=h[n>>2]))!=h[n+4>>2])for(f=e+112|0,p=e+60|0,m=(n=s>>>2|0)>>>0>1?n:1;;){if(me(p,h[(u<<2)+i>>2],o+16|0),i=(n=h[o+20>>2])>>31,a=(s=h[o+16>>2])>>31,l=(c=h[o+24>>2])>>31,a=(l^=l+c)+((i^i+n)+(a^s+a)|0)|0,i=0,(i=a>>>0<l>>>0?1:i)|a?(s=$r(qr(l=h[e+108>>2],d=l>>31,s,s>>31),G,a,i),h[o+16>>2]=s,i=$r(qr(l,d,n,n>>31),G,a,i),h[o+20>>2]=i,i=(n=(n=i)+(i>>=31)^i)+((i=s>>31)+s^i)|0,h[o+24>>2]=(0|c)>=0?l-i:i-l):h[o+16>>2]=h[e+108>>2],i=Br(f),s=h[o+16>>2],i?(h[o+24>>2]=0-h[o+24>>2],n=0-h[o+20>>2]|0,h[o+20>>2]=n,s=0-s|0,h[o+16>>2]=s):n=h[o+20>>2],(0|s)>=0?(s=(i=h[e+108>>2])+h[o+24>>2]|0,i=i+n|0):((0|n)<0?(i=(s=h[o+24>>2])>>31,i^=i+s):(i=(s=h[o+24>>2])>>31,i=h[e+100>>2]-(i^i+s)|0),(0|s)<0?s=(s=n)+(n>>=31)^n:(s=n,n>>=31,s=h[e+100>>2]-(s+n^n)|0)),n=h[e+100>>2],i|s?(0|n)!=(0|s)|i?(0|i)!=(0|n)|s?i||(0|(a=h[e+108>>2]))>=(0|s)?(0|i)!=(0|n)||(0|(a=h[e+108>>2]))<=(0|s)?(0|n)!=(0|s)||(0|(n=h[e+108>>2]))<=(0|i)?s||(s=0,(0|(n=h[e+108>>2]))>=(0|i)||(i=(n<<1)-i|0)):i=(n<<1)-i|0:s=(a<<1)-s|0:(s=(a<<1)-s|0,i=0):s=i:i=s:i=s=n,h[o+12>>2]=s,h[o+8>>2]=i,!(h[e+8>>2]<=0)){for(a=h[e+32>>2],s=0;(0|(n=h[e+16>>2]))<(0|i)?h[a+(s<<2)>>2]=n:(n=a+(s<<2)|0,c=h[e+12>>2],h[n>>2]=(0|c)>(0|i)?c:i),(0|(s=s+1|0))<(0|(n=h[e+8>>2]));)i=h[(o+8|0)+(s<<2)>>2];if(i=0,!((0|n)<=0))for(c=(n=u<<3)+r|0,l=t+n|0;;){n=(s=i<<2)+c|0,s=h[s+l>>2]+h[s+a>>2]|0,h[n>>2]=s;t:{if((0|s)>h[e+16>>2])s=s-h[e+20>>2]|0;else{if((0|s)>=h[e+12>>2])break t;s=s+h[e+20>>2]|0}h[n>>2]=s}if(!((0|(i=i+1|0))<h[e+8>>2]))break}}if((0|m)==(0|(u=u+1|0)))break e;if(n=h[e+56>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>u>>>0))break}An(),S()}return N=o+32|0,1},sn,fn,vi,Yi,me,gn,Mi,dn,hn,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0,m=0,g=0;if(h[8+(e|=0)>>2]=n,c=h[(s=e+32|0)>>2],(l=h[e+36>>2]-c>>2)>>>0<n>>>0?(er(s,n-l|0),c=h[s>>2],s=h[e+8>>2]):(n>>>0<l>>>0&&(h[e+36>>2]=(n<<2)+c),s=n),l=0,o=St(mi(a=(1073741823&n)!=(0|n)?-1:n<<2),0,a),!((0|s)<=0)){for(;(0|(a=h[(s=l<<2)+o>>2]))>(0|(u=h[e+16>>2]))?h[s+c>>2]=u:(s=s+c|0,u=h[e+12>>2],h[s>>2]=(0|u)>(0|a)?u:a),(0|(s=h[e+8>>2]))>(0|(l=l+1|0)););if(!((0|s)<=0))for(l=0;;){s=(a=l<<2)+r|0,a=h[t+a>>2]+h[a+c>>2]|0,h[s>>2]=a;e:{if((0|a)>h[e+16>>2])a=a-h[e+20>>2]|0;else{if((0|a)>=h[e+12>>2])break e;a=a+h[e+20>>2]|0}h[s>>2]=a}if(!((0|(s=h[e+8>>2]))>(0|(l=l+1|0))))break}}if(!((0|i)<=(0|n)|(0|s)<=0))for(m=0-n<<2,c=n;;){if(!((0|s)<=0)){for(g=(p=(f=c<<2)+r|0)+m|0,u=h[e+32>>2],l=0;(0|(a=h[(s=l<<2)+g>>2]))>(0|(d=h[e+16>>2]))?h[s+u>>2]=d:(s=s+u|0,d=h[e+12>>2],h[s>>2]=(0|d)>(0|a)?d:a),(0|(s=h[e+8>>2]))>(0|(l=l+1|0)););if(l=0,!((0|s)<=0))for(f=t+f|0;;){s=(a=l<<2)+p|0,a=h[a+f>>2]+h[a+u>>2]|0,h[s>>2]=a;e:{if((0|a)>h[e+16>>2])a=a-h[e+20>>2]|0;else{if((0|a)>=h[e+12>>2])break e;a=a+h[e+20>>2]|0}h[s>>2]=a}if(!((0|(s=h[e+8>>2]))>(0|(l=l+1|0))))break}}if(!((0|(c=n+c|0))<(0|i)))break}return ve(o),1},ai,ui,function(e,t,r){t|=0,r|=0;var i=0;return h[4+(e|=0)>>2]=t,t=h[h[h[t+4>>2]+8>>2]+(r<<2)>>2],h[e+12>>2]=r,h[e+8>>2]=t,e=h[e+8>>2],3==d[e+24|0]&&(i=9==h[e+28>>2]),0|i},function(e,t,r){return t|=0,r|=0,d[h[4+(e|=0)>>2]+36|0]>=2&&(t=0,!Or(e+24|0,zt(e),r))||(t=Vr(e+24|0,h[e+16>>2])),0|t},function(e,t,r){t|=0,r|=0;var i=0;return d[h[4+(e|=0)>>2]+36|0]<=1&&(i=0,!Or(e+24|0,h[e+8>>2],r))||(i=Te(e,t,r)),0|i},function(e,t,r){e|=0,t|=0;var i,n=0,o=0,a=0,l=0,c=0,u=0;N=i=N-32|0;e:{t:switch((r|=0)-2|0){case 0:if(r=h[e+4>>2],o=h[e+12>>2],h[i+24>>2]=-1,h[i+16>>2]=-1,h[i+20>>2]=1065353216,h[i+8>>2]=-1,h[i+12>>2]=-1,-2==(0|t))break e;if(u=h[h[h[r+4>>2]+8>>2]+(o<<2)>>2],1==(0|Cn[h[h[r>>2]+8>>2]](r))){c=h[h[h[r+4>>2]+8>>2]+(o<<2)>>2];r:if(!(1!=(0|Cn[h[h[r>>2]+8>>2]](r))|t-1>>>0>5||!(l=0|Cn[h[h[r>>2]+36>>2]](r))|!(e=0|Cn[h[h[r>>2]+44>>2]](r,o))))if(a=e+12|0,o=0|Cn[h[h[r>>2]+40>>2]](r,o),r=h[r+44>>2],o){if(6!=(0|t))break r;n=mi(112),h[n+4>>2]=c,t=h[i+12>>2],h[n+8>>2]=h[i+8>>2],h[n+12>>2]=t,t=h[i+20>>2],h[n+16>>2]=h[i+16>>2],h[n+20>>2]=t,h[n+24>>2]=h[i+24>>2],h[n+40>>2]=e,h[n+36>>2]=a,h[n+32>>2]=o,h[n+28>>2]=r,h[n+68>>2]=e,h[n- -64>>2]=a,h[n+60>>2]=o,h[n+56>>2]=r,h[n+48>>2]=0,h[n+52>>2]=0,h[n>>2]=7172,h[n+88>>2]=1065353216,h[n+92>>2]=-1,h[n+80>>2]=-1,h[n+84>>2]=-1,h[n+72>>2]=1,h[n+76>>2]=-1,h[n+44>>2]=7696,h[(e=n+96|0)>>2]=0,h[e+4>>2]=0,s[e+5|0]=0,s[e+6|0]=0,s[e+7|0]=0,s[e+8|0]=0,s[e+9|0]=0,s[e+10|0]=0,s[e+11|0]=0,s[e+12|0]=0}else 6==(0|t)&&(n=mi(112),h[n+4>>2]=c,t=h[i+12>>2],h[n+8>>2]=h[i+8>>2],h[n+12>>2]=t,t=h[i+20>>2],h[n+16>>2]=h[i+16>>2],h[n+20>>2]=t,h[n+24>>2]=h[i+24>>2],h[n+40>>2]=e,h[n+36>>2]=a,h[n+32>>2]=l,h[n+28>>2]=r,h[n+68>>2]=e,h[n- -64>>2]=a,h[n+60>>2]=l,h[n+56>>2]=r,h[n+48>>2]=0,h[n+52>>2]=0,h[n>>2]=8108,h[n+88>>2]=1065353216,h[n+92>>2]=-1,h[n+80>>2]=-1,h[n+84>>2]=-1,h[n+72>>2]=1,h[n+76>>2]=-1,h[n+44>>2]=8500,h[(e=n+96|0)>>2]=0,h[e+4>>2]=0,s[e+5|0]=0,s[e+6|0]=0,s[e+7|0]=0,s[e+8|0]=0,s[e+9|0]=0,s[e+10|0]=0,s[e+11|0]=0,s[e+12|0]=0);if(n)break e}n=mi(28),h[n+4>>2]=u,e=h[i+12>>2],h[n+8>>2]=h[i+8>>2],h[n+12>>2]=e,e=h[i+20>>2],h[n+16>>2]=h[i+16>>2],h[n+20>>2]=e,h[n+24>>2]=h[i+24>>2],h[n>>2]=8888;break e;case 1:break t;default:break e}if(r=h[e+4>>2],o=h[e+12>>2],h[i+24>>2]=-1,h[i+16>>2]=-1,h[i+20>>2]=1065353216,h[i+8>>2]=-1,h[i+12>>2]=-1,-2!=(0|t)){if(u=h[h[h[r+4>>2]+8>>2]+(o<<2)>>2],1==(0|Cn[h[h[r>>2]+8>>2]](r))){c=h[h[h[r+4>>2]+8>>2]+(o<<2)>>2];t:if(!(1!=(0|Cn[h[h[r>>2]+8>>2]](r))|t-1>>>0>5||!(l=0|Cn[h[h[r>>2]+36>>2]](r))|!(e=0|Cn[h[h[r>>2]+44>>2]](r,o))))if(a=e+12|0,o=0|Cn[h[h[r>>2]+40>>2]](r,o),r=h[r+44>>2],o){if(6!=(0|t))break t;n=mi(112),h[n+4>>2]=c,t=h[i+12>>2],h[n+8>>2]=h[i+8>>2],h[n+12>>2]=t,t=h[i+20>>2],h[n+16>>2]=h[i+16>>2],h[n+20>>2]=t,h[n+24>>2]=h[i+24>>2],h[n+40>>2]=e,h[n+36>>2]=a,h[n+32>>2]=o,h[n+28>>2]=r,h[n+68>>2]=e,h[n- -64>>2]=a,h[n+60>>2]=o,h[n+56>>2]=r,h[n+48>>2]=0,h[n+52>>2]=0,h[n>>2]=9056,h[n+88>>2]=1065353216,h[n+92>>2]=-1,h[n+80>>2]=-1,h[n+84>>2]=-1,h[n+72>>2]=1,h[n+76>>2]=-1,h[n+44>>2]=9620,h[(e=n+96|0)>>2]=0,h[e+4>>2]=0,s[e+5|0]=0,s[e+6|0]=0,s[e+7|0]=0,s[e+8|0]=0,s[e+9|0]=0,s[e+10|0]=0,s[e+11|0]=0,s[e+12|0]=0}else 6==(0|t)&&(n=mi(112),h[n+4>>2]=c,t=h[i+12>>2],h[n+8>>2]=h[i+8>>2],h[n+12>>2]=t,t=h[i+20>>2],h[n+16>>2]=h[i+16>>2],h[n+20>>2]=t,h[n+24>>2]=h[i+24>>2],h[n+40>>2]=e,h[n+36>>2]=a,h[n+32>>2]=l,h[n+28>>2]=r,h[n+68>>2]=e,h[n- -64>>2]=a,h[n+60>>2]=l,h[n+56>>2]=r,h[n+48>>2]=0,h[n+52>>2]=0,h[n>>2]=10060,h[n+88>>2]=1065353216,h[n+92>>2]=-1,h[n+80>>2]=-1,h[n+84>>2]=-1,h[n+72>>2]=1,h[n+76>>2]=-1,h[n+44>>2]=10480,h[(e=n+96|0)>>2]=0,h[e+4>>2]=0,s[e+5|0]=0,s[e+6|0]=0,s[e+7|0]=0,s[e+8|0]=0,s[e+9|0]=0,s[e+10|0]=0,s[e+11|0]=0,s[e+12|0]=0);if(n)break e}n=mi(28),h[n+4>>2]=u,e=h[i+12>>2],h[n+8>>2]=h[i+8>>2],h[n+12>>2]=e,e=h[i+20>>2],h[n+16>>2]=h[i+16>>2],h[n+20>>2]=e,h[n+24>>2]=h[i+24>>2],h[n>>2]=10892}}return N=i+32|0,0|n},cn,function(e,t){return 0|ht(24+(e|=0)|0,zt(e),h[e+8>>2])},function(e){return h[(e|=0)>>2]=7172,0|e},function(e){h[(e|=0)>>2]=7172,ve(e)},un,Zi,li,hn,en,Si,hn,cn,gt,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0,g=0,v=0;N=o=N-48|0,(i=h[8+(e|=0)>>2])-31>>>0>=4294967267&&(h[e+76>>2]=i,i=-2-(n=-1<<i)|0,h[e+84>>2]=i,h[e+80>>2]=-1^n,h[e+92>>2]=(0|i)/2,m[e+88>>2]=_(2)/_(0|i)),h[e+52>>2]=s,n=h[e+40>>2],i=h[n>>2],s=h[n+4>>2],h[o+16>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0;e:if(!((0|(s=s-i|0))<=0)){if((0|(i=h[n>>2]))!=h[n+4>>2])for(f=e+8|0,p=e+96|0,g=e+44|0,v=(n=s>>>2|0)>>>0>1?n:1;;){if(oe(g,h[(c<<2)+i>>2],o+8|0),i=(n=h[o+12>>2])>>31,a=(s=h[o+8>>2])>>31,l=(u=h[o+16>>2])>>31,a=(l^=l+u)+((i^i+n)+(a^s+a)|0)|0,i=0,(i=a>>>0<l>>>0?1:i)|a?(s=$r(qr(l=h[e+92>>2],d=l>>31,s,s>>31),G,a,i),h[o+8>>2]=s,i=$r(qr(l,d,n,n>>31),G,a,i),h[o+12>>2]=i,n=i>>31,i=(n^=i+n)+((i=s>>31)+s^i)|0,h[o+16>>2]=(0|u)>=0?l-i:i-l):h[o+8>>2]=h[e+92>>2],i=Br(p),s=h[o+8>>2],i?(h[o+16>>2]=0-h[o+16>>2],n=0-h[o+12>>2]|0,h[o+12>>2]=n,s=0-s|0,h[o+8>>2]=s):n=h[o+12>>2],(0|s)>=0?(i=(s=h[e+92>>2])+h[o+16>>2]|0,s=n+s|0):((0|n)<0?(s=(i=h[o+16>>2])>>31,s^=i+s):(s=(i=h[o+16>>2])>>31,s=h[e+84>>2]-(s^i+s)|0),(0|i)<0?(i=n>>31,i^=i+n):(i=n>>31,i=h[e+84>>2]-(i+n^i)|0)),n=h[e+84>>2],i|s?(0|i)!=(0|n)|s?(0|n)!=(0|s)|i?s||(0|(a=h[e+92>>2]))>=(0|i)?(0|n)!=(0|s)||(0|(a=h[e+92>>2]))<=(0|i)?(0|i)!=(0|n)||(0|(n=h[e+92>>2]))<=(0|s)?i||(i=0,(0|(n=h[e+92>>2]))>=(0|s)||(s=(n<<1)-s|0)):s=(n<<1)-s|0:i=(a<<1)-i|0:(i=(a<<1)-i|0,s=0):i=s:s=i:s=i=n,u=h[4+(a=(n=c<<3)+t|0)>>2],h[o+40>>2]=h[a>>2],h[o+44>>2]=u,h[o+28>>2]=i,h[o+24>>2]=s,Ke(o+32|0,f,o+24|0,o+40|0),h[(i=r+n|0)>>2]=h[o+32>>2],h[i+4>>2]=h[o+36>>2],(0|v)==(0|(c=c+1|0)))break e;if(n=h[e+40>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>c>>>0))break}An(),S()}return N=o+48|0,1},sn,fn,vi,Yi,oe,function(e){return h[(e|=0)>>2]=8108,0|e},function(e){h[(e|=0)>>2]=8108,ve(e)},un,li,hn,en,Si,gt,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0,g=0,v=0;N=o=N-48|0,(i=h[8+(e|=0)>>2])-31>>>0>=4294967267&&(h[e+76>>2]=i,i=-2-(n=-1<<i)|0,h[e+84>>2]=i,h[e+80>>2]=-1^n,h[e+92>>2]=(0|i)/2,m[e+88>>2]=_(2)/_(0|i)),h[e+52>>2]=s,n=h[e+40>>2],i=h[n>>2],s=h[n+4>>2],h[o+16>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0;e:if(!((0|(s=s-i|0))<=0)){if((0|(i=h[n>>2]))!=h[n+4>>2])for(f=e+8|0,p=e+96|0,g=e+44|0,v=(n=s>>>2|0)>>>0>1?n:1;;){if(me(g,h[(c<<2)+i>>2],o+8|0),i=(n=h[o+12>>2])>>31,a=(s=h[o+8>>2])>>31,l=(u=h[o+16>>2])>>31,a=(l^=l+u)+((i^i+n)+(a^s+a)|0)|0,i=0,(i=a>>>0<l>>>0?1:i)|a?(s=$r(qr(l=h[e+92>>2],d=l>>31,s,s>>31),G,a,i),h[o+8>>2]=s,i=$r(qr(l,d,n,n>>31),G,a,i),h[o+12>>2]=i,n=i>>31,i=(n^=i+n)+((i=s>>31)+s^i)|0,h[o+16>>2]=(0|u)>=0?l-i:i-l):h[o+8>>2]=h[e+92>>2],i=Br(p),s=h[o+8>>2],i?(h[o+16>>2]=0-h[o+16>>2],n=0-h[o+12>>2]|0,h[o+12>>2]=n,s=0-s|0,h[o+8>>2]=s):n=h[o+12>>2],(0|s)>=0?(i=(s=h[e+92>>2])+h[o+16>>2]|0,s=n+s|0):((0|n)<0?(s=(i=h[o+16>>2])>>31,s^=i+s):(s=(i=h[o+16>>2])>>31,s=h[e+84>>2]-(s^i+s)|0),(0|i)<0?(i=n>>31,i^=i+n):(i=n>>31,i=h[e+84>>2]-(i+n^i)|0)),n=h[e+84>>2],i|s?(0|i)!=(0|n)|s?(0|n)!=(0|s)|i?s||(0|(a=h[e+92>>2]))>=(0|i)?(0|n)!=(0|s)||(0|(a=h[e+92>>2]))<=(0|i)?(0|i)!=(0|n)||(0|(n=h[e+92>>2]))<=(0|s)?i||(i=0,(0|(n=h[e+92>>2]))>=(0|s)||(s=(n<<1)-s|0)):s=(n<<1)-s|0:i=(a<<1)-i|0:(i=(a<<1)-i|0,s=0):i=s:s=i:s=i=n,u=h[4+(a=(n=c<<3)+t|0)>>2],h[o+40>>2]=h[a>>2],h[o+44>>2]=u,h[o+28>>2]=i,h[o+24>>2]=s,Ke(o+32|0,f,o+24|0,o+40|0),h[(i=r+n|0)>>2]=h[o+32>>2],h[i+4>>2]=h[o+36>>2],(0|v)==(0|(c=c+1|0)))break e;if(n=h[e+40>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>c>>>0))break}An(),S()}return N=o+48|0,1},sn,fn,vi,Yi,me,sn,fn,dn,hn,dn,Xi,en,function(e,t){e|=0;var r,i,n,s=0,o=0,a=0,l=0,c=0;a=h[12+(t|=0)>>2],l=s=h[t+20>>2],s=(o=(r=h[t+16>>2])+4|0)>>>0<4?s+1|0:s,n=o;e:if(!((i=h[t+8>>2])>>>0<o>>>0&(0|s)>=(0|a)|(0|s)>(0|a))){if(o=r+h[t>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+16>>2]=n,h[t+20>>2]=s,f[t+38>>1]<=513){if(s=l,(l=r+8|0)>>>0>i>>>0&(0|(s=l>>>0<8?s+1|0:s))>=(0|a)|(0|s)>(0|a))break e;h[t+16>>2]=l,h[t+20>>2]=s}1&o&&((s=(t=31^y(o))-30|0)>>>0>=4294967267&&(h[e+8>>2]=t+1,t=-2-(a=-2<<t)|0,h[e+16>>2]=t,h[e+12>>2]=-1^a,h[e+24>>2]=(0|t)/2,m[e+20>>2]=_(2)/_(0|t)),c=s>>>0>4294967266)}return 0|c},function(e,t,r,i,n,s){e|=0,t|=0,r|=0,i|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0;if(N=s=N-32|0,o=St(mi(a=(1073741823&(n|=0))!=(0|n)?-1:n<<2),0,a),c=h[(a=o)>>2],a=h[a+4>>2],d=h[t+4>>2],h[s+24>>2]=h[t>>2],h[s+28>>2]=d,h[s+8>>2]=c,h[s+12>>2]=a,Ke(s+16|0,c=e+8|0,s+8|0,s+24|0),h[r>>2]=h[s+16>>2],h[r+4>>2]=h[s+20>>2],(0|i)>(0|n))for(d=0-n<<2,e=n;f=h[(u=(a=(l=e<<2)+r|0)+d|0)>>2],u=h[u+4>>2],p=h[4+(l=t+l|0)>>2],h[s+24>>2]=h[l>>2],h[s+28>>2]=p,h[s+8>>2]=f,h[s+12>>2]=u,Ke(s+16|0,c,s+8|0,s+24|0),h[a>>2]=h[s+16>>2],h[a+4>>2]=h[s+20>>2],(0|i)>(0|(e=e+n|0)););return ve(o),N=s+32|0,1},function(e){return h[(e|=0)>>2]=9056,0|e},function(e){h[(e|=0)>>2]=9056,ve(e)},un,Zi,li,hn,en,Si,hn,on,vt,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0,g=0,v=0;N=o=N-48|0,(i=h[8+(e|=0)>>2])-31>>>0>=4294967267&&(h[e+76>>2]=i,i=-2-(n=-1<<i)|0,h[e+84>>2]=i,h[e+80>>2]=-1^n,h[e+92>>2]=(0|i)/2,m[e+88>>2]=_(2)/_(0|i)),h[e+52>>2]=s,n=h[e+40>>2],i=h[n>>2],s=h[n+4>>2],h[o+16>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0;e:if(!((0|(s=s-i|0))<=0)){if((0|(i=h[n>>2]))!=h[n+4>>2])for(f=e+8|0,p=e+96|0,g=e+44|0,v=(n=s>>>2|0)>>>0>1?n:1;;){if(oe(g,h[(c<<2)+i>>2],o+8|0),i=(n=h[o+12>>2])>>31,a=(s=h[o+8>>2])>>31,l=(u=h[o+16>>2])>>31,a=(l^=l+u)+((i^i+n)+(a^s+a)|0)|0,i=0,(i=a>>>0<l>>>0?1:i)|a?(s=$r(qr(l=h[e+92>>2],d=l>>31,s,s>>31),G,a,i),h[o+8>>2]=s,i=$r(qr(l,d,n,n>>31),G,a,i),h[o+12>>2]=i,n=i>>31,i=(n^=i+n)+((i=s>>31)+s^i)|0,h[o+16>>2]=(0|u)>=0?l-i:i-l):h[o+8>>2]=h[e+92>>2],i=Br(p),s=h[o+8>>2],i?(h[o+16>>2]=0-h[o+16>>2],n=0-h[o+12>>2]|0,h[o+12>>2]=n,s=0-s|0,h[o+8>>2]=s):n=h[o+12>>2],(0|s)>=0?(i=(s=h[e+92>>2])+h[o+16>>2]|0,s=n+s|0):((0|n)<0?(s=(i=h[o+16>>2])>>31,s^=i+s):(s=(i=h[o+16>>2])>>31,s=h[e+84>>2]-(s^i+s)|0),(0|i)<0?(i=n>>31,i^=i+n):(i=n>>31,i=h[e+84>>2]-(i+n^i)|0)),n=h[e+84>>2],i|s?(0|i)!=(0|n)|s?(0|n)!=(0|s)|i?s||(0|(a=h[e+92>>2]))>=(0|i)?(0|n)!=(0|s)||(0|(a=h[e+92>>2]))<=(0|i)?(0|i)!=(0|n)||(0|(n=h[e+92>>2]))<=(0|s)?i||(i=0,(0|(n=h[e+92>>2]))>=(0|s)||(s=(n<<1)-s|0)):s=(n<<1)-s|0:i=(a<<1)-i|0:(i=(a<<1)-i|0,s=0):i=s:s=i:s=i=n,u=h[4+(a=(n=c<<3)+t|0)>>2],a=h[a>>2],h[o+36>>2]=i,h[o+32>>2]=s,h[o+24>>2]=a,h[o+28>>2]=u,Le(o+40|0,f,o+32|0,o+24|0),h[(i=r+n|0)>>2]=h[o+40>>2],h[i+4>>2]=h[o+44>>2],(0|v)==(0|(c=c+1|0)))break e;if(n=h[e+40>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>c>>>0))break}An(),S()}return N=o+48|0,1},sn,fn,vi,Yi,oe,function(e){return h[(e|=0)>>2]=10060,0|e},function(e){h[(e|=0)>>2]=10060,ve(e)},un,li,hn,en,Si,vt,function(e,t,r,i,n,s){t|=0,r|=0,i|=0,n|=0,s|=0;var o,a=0,l=0,c=0,u=0,d=0,f=0,p=0,g=0,v=0;N=o=N-48|0,(i=h[8+(e|=0)>>2])-31>>>0>=4294967267&&(h[e+76>>2]=i,i=-2-(n=-1<<i)|0,h[e+84>>2]=i,h[e+80>>2]=-1^n,h[e+92>>2]=(0|i)/2,m[e+88>>2]=_(2)/_(0|i)),h[e+52>>2]=s,n=h[e+40>>2],i=h[n>>2],s=h[n+4>>2],h[o+16>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0;e:if(!((0|(s=s-i|0))<=0)){if((0|(i=h[n>>2]))!=h[n+4>>2])for(f=e+8|0,p=e+96|0,g=e+44|0,v=(n=s>>>2|0)>>>0>1?n:1;;){if(me(g,h[(c<<2)+i>>2],o+8|0),i=(n=h[o+12>>2])>>31,a=(s=h[o+8>>2])>>31,l=(u=h[o+16>>2])>>31,a=(l^=l+u)+((i^i+n)+(a^s+a)|0)|0,i=0,(i=a>>>0<l>>>0?1:i)|a?(s=$r(qr(l=h[e+92>>2],d=l>>31,s,s>>31),G,a,i),h[o+8>>2]=s,i=$r(qr(l,d,n,n>>31),G,a,i),h[o+12>>2]=i,n=i>>31,i=(n^=i+n)+((i=s>>31)+s^i)|0,h[o+16>>2]=(0|u)>=0?l-i:i-l):h[o+8>>2]=h[e+92>>2],i=Br(p),s=h[o+8>>2],i?(h[o+16>>2]=0-h[o+16>>2],n=0-h[o+12>>2]|0,h[o+12>>2]=n,s=0-s|0,h[o+8>>2]=s):n=h[o+12>>2],(0|s)>=0?(i=(s=h[e+92>>2])+h[o+16>>2]|0,s=n+s|0):((0|n)<0?(s=(i=h[o+16>>2])>>31,s^=i+s):(s=(i=h[o+16>>2])>>31,s=h[e+84>>2]-(s^i+s)|0),(0|i)<0?(i=n>>31,i^=i+n):(i=n>>31,i=h[e+84>>2]-(i+n^i)|0)),n=h[e+84>>2],i|s?(0|i)!=(0|n)|s?(0|n)!=(0|s)|i?s||(0|(a=h[e+92>>2]))>=(0|i)?(0|n)!=(0|s)||(0|(a=h[e+92>>2]))<=(0|i)?(0|i)!=(0|n)||(0|(n=h[e+92>>2]))<=(0|s)?i||(i=0,(0|(n=h[e+92>>2]))>=(0|s)||(s=(n<<1)-s|0)):s=(n<<1)-s|0:i=(a<<1)-i|0:(i=(a<<1)-i|0,s=0):i=s:s=i:s=i=n,u=h[4+(a=(n=c<<3)+t|0)>>2],a=h[a>>2],h[o+36>>2]=i,h[o+32>>2]=s,h[o+24>>2]=a,h[o+28>>2]=u,Le(o+40|0,f,o+32|0,o+24|0),h[(i=r+n|0)>>2]=h[o+40>>2],h[i+4>>2]=h[o+44>>2],(0|v)==(0|(c=c+1|0)))break e;if(n=h[e+40>>2],i=h[n>>2],!(h[n+4>>2]-i>>2>>>0>c>>>0))break}An(),S()}return N=o+48|0,1},sn,fn,vi,Yi,me,fn,dn,hn,dn,Xi,en,function(e,t){e|=0;var r,i,n,s,o=0,a=0,l=0,c=0;return r=h[12+(t|=0)>>2],l=o=h[t+20>>2],o=(a=(i=h[t+16>>2])+4|0)>>>0<4?o+1|0:o,s=a,(n=h[t+8>>2])>>>0<a>>>0&(0|o)>=(0|r)|(0|o)>(0|r)||(a=i+h[t>>2]|0,a=d[0|a]|d[a+1|0]<<8|d[a+2|0]<<16|d[a+3|0]<<24,h[t+16>>2]=s,h[t+20>>2]=o,o=l,(l=i+8|0)>>>0>n>>>0&(0|(o=l>>>0<8?o+1|0:o))>=(0|r)|(0|o)>(0|r)||(h[t+16>>2]=l,h[t+20>>2]=o,1&a&&((t=31^y(a))-30>>>0<4294967267||(c=1,h[e+8>>2]=t+1,t=-2-(o=-2<<t)|0,h[e+16>>2]=t,h[e+12>>2]=-1^o,h[e+24>>2]=(0|t)/2,m[e+20>>2]=_(2)/_(0|t))))),0|c},function(e,t,r,i,n,s){e|=0,t|=0,r|=0,i|=0,s|=0;var o=0,a=0,l=0,c=0,u=0,d=0,f=0,p=0;if(N=s=N-32|0,a=St(mi(a=(1073741823&(n|=0))!=(0|n)?-1:n<<2),0,a),o=h[t>>2],l=h[t+4>>2],u=h[a+4>>2],h[s+16>>2]=h[a>>2],h[s+20>>2]=u,h[s+8>>2]=o,h[s+12>>2]=l,Le(s+24|0,l=e+8|0,s+16|0,s+8|0),h[r>>2]=h[s+24>>2],h[r+4>>2]=h[s+28>>2],(0|i)>(0|n))for(u=0-n<<2,e=n;f=h[(c=(o=e<<2)+t|0)>>2],c=h[c+4>>2],p=h[4+(d=(o=r+o|0)+u|0)>>2],h[s+16>>2]=h[d>>2],h[s+20>>2]=p,h[s+8>>2]=f,h[s+12>>2]=c,Le(s+24|0,l,s+16|0,s+8|0),h[o>>2]=h[s+24>>2],h[o+4>>2]=h[s+28>>2],(0|i)>(0|(e=e+n|0)););return ve(a),N=s+32|0,1},function(e){var t=0;return h[24+(e|=0)>>2]=1140,h[e>>2]=11076,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),h[e>>2]=2476,t=h[e+20>>2],h[e+20>>2]=0,t&&Cn[h[h[t>>2]+4>>2]](t),h[e>>2]=2260,t=h[e+16>>2],h[e+16>>2]=0,t&&Wr(t),0|e},function(e){var t=0;h[24+(e|=0)>>2]=1140,h[e>>2]=11076,(t=h[e+32>>2])&&(h[e+36>>2]=t,ve(t)),h[e>>2]=2476,t=h[e+20>>2],h[e+20>>2]=0,t&&Cn[h[h[t>>2]+4>>2]](t),h[e>>2]=2260,t=h[e+16>>2],h[e+16>>2]=0,t&&Wr(t),ve(e)},function(e,t,r){var i;return t|=0,r|=0,h[4+(e|=0)>>2]=t,i=h[h[h[t+4>>2]+8>>2]+(r<<2)>>2],h[e+12>>2]=r,h[e+8>>2]=i,9==h[h[h[h[t+4>>2]+8>>2]+(r<<2)>>2]+28>>2]|0},function(e,t,r){return t|=0,d[h[4+(e|=0)>>2]+36|0]>=2&&(t=0,!(0|Cn[h[h[e>>2]+52>>2]](e)))||(t=Vr(e+24|0,h[e+16>>2])),0|t},function(e,t,r){t|=0,r|=0;var i=0;return d[h[4+(e|=0)>>2]+36|0]<=1&&(i=0,!(0|Cn[h[h[e>>2]+52>>2]](e)))||(i=Te(e,t,r)),0|i},function(e,t){return t|=0,0|Cn[h[h[(e|=0)>>2]+56>>2]](e,t)},function(e){return 0|st(24+(e|=0)|0,zt(e)||h[e+8>>2],h[h[e+4>>2]+32>>2])},function(e,t){return 0|et(24+(e|=0)|0,zt(e),h[e+8>>2])},function(e){var t,r=0,i=0;if(h[(e|=0)>>2]=13312,(r=h[e+20>>2])&&(h[e+24>>2]=r,ve(r)),t=h[e+8>>2]){if((0|(i=h[e+12>>2]))==(0|t))r=t;else{for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(0|t)!=(0|i););r=h[e+8>>2]}h[e+12>>2]=t,ve(r)}return 0|e},gn,hn,hn,function(e){return h[44+(e|=0)>>2]?0|Cn[h[h[e>>2]+48>>2]](e):0},function(e){var t=0,r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0;e:{if(r=h[32+(e|=0)>>2],n=h[r+8>>2],t=0,!((0|(s=h[r+12>>2]))<=(0|(i=h[r+20>>2]))&(o=n)>>>0<=(n=h[r+16>>2])>>>0|(0|i)>(0|s))){o=d[n+h[r>>2]|0],i=(s=n+1|0)?i:i+1|0,h[r+16>>2]=s,h[r+20>>2]=i;t:if(o){for(;;){if(0|Cn[h[h[e>>2]+16>>2]](e,t)){if((0|o)!=(0|(t=t+1|0)))continue;break t}break}return 0}if((0|(t=h[e+8>>2]))!=(0|(i=h[e+12>>2])))for(;;){if(r=h[t>>2],!(0|Cn[h[h[r>>2]+8>>2]](r,e,h[e+4>>2])))break e;if((0|i)==(0|(t=t+4|0)))break}if(o){for(t=0;;){if(r=h[h[e+8>>2]+(t<<2)>>2],!(0|Cn[h[h[r>>2]+12>>2]](r,h[e+32>>2])))break e;if((0|o)==(0|(t=t+1|0)))break}if(o)for(n=e+20|0;;){if(t=0,r=h[(s=a<<2)+h[e+8>>2]>>2],(0|(i=0|Cn[h[h[r>>2]+24>>2]](r)))>0)for(;r=h[h[e+8>>2]+s>>2],u=0|Cn[h[h[r>>2]+20>>2]](r,t),l=h[e+20>>2],u>>>0<(c=h[e+24>>2]-l>>2)>>>0||((r=u+1|0)>>>0>c>>>0?(er(n,r-c|0),l=h[n>>2]):r>>>0>=c>>>0||(h[e+24>>2]=(r<<2)+l)),h[(u<<2)+l>>2]=a,(0|i)!=(0|(t=t+1|0)););if((0|o)==(0|(a=a+1|0)))break}}t=0,0|Cn[h[h[e>>2]+28>>2]](e)&&(t=0|Cn[h[h[e>>2]+32>>2]](e))}return 0|t}return 0},function(e){var t,r=0,i=0;if((0|(r=h[8+(e|=0)>>2]))==(0|(t=h[e+12>>2])))return 1;for(;i=h[r>>2],(i=0|Cn[h[h[i>>2]+16>>2]](i,h[e+32>>2]))&&(0|t)!=(0|(r=r+4|0)););return 0|i},hn,dn,en,en,function(e){var t,r=0,i=0;if(h[(e|=0)>>2]=11304,r=h[e+48>>2],h[e+48>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),h[e>>2]=13312,(r=h[e+20>>2])&&(h[e+24>>2]=r,ve(r)),t=h[e+8>>2]){if((0|(i=h[e+12>>2]))==(0|t))r=t;else{for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(0|t)!=(0|i););r=h[e+8>>2]}h[e+12>>2]=t,ve(r)}return 0|e},function(e){var t,r=0,i=0;if(h[(e|=0)>>2]=11304,r=h[e+48>>2],h[e+48>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),h[e>>2]=13312,(r=h[e+20>>2])&&(h[e+24>>2]=r,ve(r)),t=h[e+8>>2]){if((0|(i=h[e+12>>2]))==(0|t))r=t;else{for(;r=h[(i=i-4|0)>>2],h[i>>2]=0,r&&Cn[h[h[r>>2]+4>>2]](r),(0|t)!=(0|i););r=h[e+8>>2]}h[e+12>>2]=t,ve(r)}ve(e)},function(e){var t,r=0,i=0,n=0,o=0;if(i=h[32+(e|=0)>>2],t=h[i+16>>2],n=h[i+12>>2],r=h[i+20>>2],p[i+8>>2]>t>>>0&(0|n)>=(0|r)|(0|r)<(0|n)){o=d[t+h[i>>2]|0],r=(n=t+1|0)?r:r+1|0,h[i+16>>2]=n,h[i+20>>2]=r,i=h[e+48>>2],h[e+48>>2]=0,i&&Cn[h[h[i>>2]+4>>2]](i);e:{t:{r:{i:switch(0|o){case 0:i=mi(384),h[i>>2]=11412,St(i+4|0,0,80),h[i+96>>2]=0,h[i+100>>2]=0,h[i+92>>2]=-1,h[i+84>>2]=-1,h[i+88>>2]=-1,h[i+104>>2]=0,h[i+108>>2]=0,h[i+112>>2]=0,h[i+116>>2]=0,h[i+120>>2]=0,h[i+124>>2]=0,h[i+128>>2]=0,h[i+132>>2]=0,h[i+136>>2]=0,h[i+140>>2]=0,h[i+144>>2]=0,h[i+148>>2]=0,h[i+156>>2]=0,h[i+160>>2]=0,h[i+152>>2]=1065353216,h[i+164>>2]=0,h[i+168>>2]=0,h[i+172>>2]=0,h[i+176>>2]=0,h[i+180>>2]=0,h[i+184>>2]=0,h[i+188>>2]=0,h[i+192>>2]=0,h[i+196>>2]=0,h[i+200>>2]=0,h[i+204>>2]=0,h[i+208>>2]=0,h[i+212>>2]=-1,h[i+216>>2]=0,h[i+220>>2]=0,h[i+224>>2]=0,u[38+(r=i+232|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,u[38+(r=i+272|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,h[(r=i+312|0)>>2]=0,h[r+4>>2]=0,s[r+5|0]=0,s[r+6|0]=0,s[r+7|0]=0,s[r+8|0]=0,s[r+9|0]=0,s[r+10|0]=0,s[r+11|0]=0,s[r+12|0]=0,u[38+(r=i+328|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,h[i+376>>2]=0,h[i+368>>2]=0,h[i+372>>2]=0;break r;case 1:i=mi(424),h[i>>2]=11464,St(i+4|0,0,80),h[i+96>>2]=0,h[i+100>>2]=0,h[i+92>>2]=-1,h[i+84>>2]=-1,h[i+88>>2]=-1,h[i+104>>2]=0,h[i+108>>2]=0,h[i+112>>2]=0,h[i+116>>2]=0,h[i+120>>2]=0,h[i+124>>2]=0,h[i+128>>2]=0,h[i+132>>2]=0,h[i+136>>2]=0,h[i+140>>2]=0,h[i+144>>2]=0,h[i+148>>2]=0,h[i+156>>2]=0,h[i+160>>2]=0,h[i+152>>2]=1065353216,h[i+164>>2]=0,h[i+168>>2]=0,h[i+172>>2]=0,h[i+176>>2]=0,h[i+180>>2]=0,h[i+184>>2]=0,h[i+188>>2]=0,h[i+192>>2]=0,h[i+196>>2]=0,h[i+200>>2]=0,h[i+204>>2]=0,h[i+208>>2]=0,h[i+212>>2]=-1,h[i+216>>2]=0,h[i+220>>2]=0,h[i+224>>2]=0,u[38+(r=i+232|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,u[38+(r=i+272|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,h[(r=i+312|0)>>2]=0,h[r+4>>2]=0,s[r+5|0]=0,s[r+6|0]=0,s[r+7|0]=0,s[r+8|0]=0,s[r+9|0]=0,s[r+10|0]=0,s[r+11|0]=0,s[r+12|0]=0,u[38+(r=i+328|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,h[i+392>>2]=0,h[i+396>>2]=0,h[i+384>>2]=0,h[i+388>>2]=0,h[i+376>>2]=0,h[i+380>>2]=0,h[i+368>>2]=0,h[i+372>>2]=0,h[(r=i+400|0)>>2]=0,h[r+4>>2]=0,s[r+5|0]=0,s[r+6|0]=0,s[r+7|0]=0,s[r+8|0]=0,s[r+9|0]=0,s[r+10|0]=0,s[r+11|0]=0,s[r+12|0]=0,h[i+416>>2]=-1,h[i+420>>2]=-1;break r;case 2:break i;default:break t}i=mi(440),h[i>>2]=11512,St(i+4|0,0,80),h[i+96>>2]=0,h[i+100>>2]=0,h[i+92>>2]=-1,h[i+84>>2]=-1,h[i+88>>2]=-1,h[i+104>>2]=0,h[i+108>>2]=0,h[i+112>>2]=0,h[i+116>>2]=0,h[i+120>>2]=0,h[i+124>>2]=0,h[i+128>>2]=0,h[i+132>>2]=0,h[i+136>>2]=0,h[i+140>>2]=0,h[i+144>>2]=0,h[i+148>>2]=0,h[i+156>>2]=0,h[i+160>>2]=0,h[i+152>>2]=1065353216,h[i+164>>2]=0,h[i+168>>2]=0,h[i+172>>2]=0,h[i+176>>2]=0,h[i+180>>2]=0,h[i+184>>2]=0,h[i+188>>2]=0,h[i+192>>2]=0,h[i+196>>2]=0,h[i+200>>2]=0,h[i+204>>2]=0,h[i+208>>2]=0,h[i+212>>2]=-1,h[i+216>>2]=0,h[i+220>>2]=0,h[i+224>>2]=0,u[38+(r=i+232|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,u[38+(r=i+272|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,h[(r=i+312|0)>>2]=0,h[r+4>>2]=0,s[r+5|0]=0,s[r+6|0]=0,s[r+7|0]=0,s[r+8|0]=0,s[r+9|0]=0,s[r+10|0]=0,s[r+11|0]=0,s[r+12|0]=0,u[38+(r=i+328|0)>>1]=0,h[r>>2]=0,h[r+8>>2]=0,h[r+12>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0,h[r+24>>2]=0,h[r+28>>2]=0,s[r+29|0]=0,s[r+30|0]=0,s[r+31|0]=0,s[r+32|0]=0,s[r+33|0]=0,s[r+34|0]=0,s[r+35|0]=0,s[r+36|0]=0,h[i+392>>2]=0,h[i+396>>2]=0,h[i+384>>2]=0,h[i+388>>2]=0,h[i+376>>2]=0,h[i+380>>2]=0,h[i+368>>2]=0,h[i+372>>2]=0,h[i+416>>2]=0,h[i+420>>2]=0,h[i+408>>2]=2,h[i+412>>2]=7,h[i+400>>2]=-1,h[i+404>>2]=-1,h[i+424>>2]=0,h[i+428>>2]=0,h[i+432>>2]=0,h[i+436>>2]=0}if(r=h[e+48>>2],h[e+48>>2]=i,!r)break e;Cn[h[h[r>>2]+4>>2]](r)}if(!(i=h[e+48>>2]))return 0}e=0|Cn[h[h[i>>2]+8>>2]](i,e)}else e=0;return 0|e},function(e,t){return t|=0,e=h[48+(e|=0)>>2],0|Cn[h[h[e>>2]+20>>2]](e,t)},function(e){return e=h[48+(e|=0)>>2],0|Cn[h[h[e>>2]+28>>2]](e)},function(e){return e=h[48+(e|=0)>>2],0|Cn[h[h[e>>2]+36>>2]](e)},function(e,t){return t|=0,e=h[48+(e|=0)>>2],0|Cn[h[h[e>>2]+12>>2]](e,t)},function(e,t){return t|=0,e=h[48+(e|=0)>>2],0|Cn[h[h[e>>2]+16>>2]](e,t)},function(e){return e=h[48+(e|=0)>>2],0|Cn[h[h[e>>2]+24>>2]](e)},_t,function(e){ve(_t(e|=0))},Fi,Wt,Jt,K,function(e){var t,r=0,i=0,n=0,o=0,a=0,l=0,c=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,G=0,D=0,U=0,V=0,B=0,F=0,j=0,z=0;if(N=t=N+-64|0,h[132+(e|=0)>>2]=0,h[e+148>>2]){if(i=h[e+144>>2])for(;r=h[i>>2],ve(i),i=r,r;);if(i=0,h[e+144>>2]=0,n=h[e+140>>2]){if(n-1>>>0>=3)for(r=-4&n;h[(m=i<<2)+h[e+136>>2]>>2]=0,h[h[e+136>>2]+(4|m)>>2]=0,h[h[e+136>>2]+(8|m)>>2]=0,h[h[e+136>>2]+(12|m)>>2]=0,i=i+4|0,(0|r)!=(0|(o=o+4|0)););if(r=3&n)for(;h[h[e+136>>2]+(i<<2)>>2]=0,i=i+1|0,(0|r)!=(0|(O=O+1|0)););}h[e+148>>2]=0}e:{t:{if(i=h[e+4>>2],!((r=(O=d[i+36|0])<<8|d[i+37|0])>>>0>513))if(E=h[i+32>>2],r>>>0<=511){if(r=h[E+20>>2],r=(o=(n=h[E+16>>2])+4|0)>>>0<4?r+1|0:r,m=o,o=h[E+12>>2],m>>>0>p[E+8>>2]&(0|o)<=(0|r)|(0|r)>(0|o))break t;o=n+h[E>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[E+16>>2]=m,h[E+20>>2]=r,h[e+132>>2]=o}else{if(!Ar(1,t,E))break t;i=h[e+4>>2],O=d[i+36|0],h[e+132>>2]=h[t>>2]}E=h[i+32>>2];r:{i:{if((255&O)>>>0<=1){if(O=0,r=h[E+20>>2],r=(o=(n=h[E+16>>2])+4|0)>>>0<4?r+1|0:r,m=o,o=h[E+12>>2],m>>>0>p[E+8>>2]&(0|o)<=(0|r)|(0|r)>(0|o))break e;o=n+h[E>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+60>>2]=o,h[E+16>>2]=m,h[E+20>>2]=r,h[e+156>>2]=o,g=e+156|0}else{if(O=0,!Ar(1,t+60|0,E))break e;if(i=h[e+4>>2],r=d[i+36|0],h[e+156>>2]=h[t+60>>2],g=e+156|0,r>>>0>1)break i}if(n=h[i+32>>2],i=h[n+8>>2],m=h[n+12>>2],c=i,i=h[n+20>>2],c>>>0<(r=(o=h[n+16>>2])+4|0)>>>0&(0|(i=r>>>0<4?i+1|0:i))>=(0|m)|(0|i)>(0|m))break e;o=o+h[n>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+56>>2]=o,h[n+16>>2]=r,h[n+20>>2]=i;break r}if(!Ar(1,t+56|0,h[i+32>>2]))break e;o=h[t+56>>2]}if(o>>>0>1431655765|p[g>>2]>v(o,3)>>>0)break e;if(a=h[e+4>>2],r=h[a+32>>2],n=R=h[r+8>>2],(0|(m=h[r+12>>2]))<=(0|(i=h[r+20>>2]))&(g=h[r+16>>2])>>>0>=n>>>0|(0|i)>(0|m))break e;if(c=h[r>>2],l=d[c+g|0],n=(E=g+1|0)?i:i+1|0,h[r+16>>2]=E,h[r+20>>2]=n,d[a+36|0]<=1){if((n=g+5|0)>>>0>R>>>0&(0|(i=n>>>0<5?i+1|0:i))>=(0|m)|(0|i)>(0|m))break e;g=d[0|(m=c+E|0)]|d[m+1|0]<<8|d[m+2|0]<<16|d[m+3|0]<<24,h[t+52>>2]=g,h[r+16>>2]=n,h[r+20>>2]=i}else{if(!Ar(1,t+52|0,r))break e;g=h[t+52>>2]}if(o>>>0<g>>>0|((g>>>0)/3|0)+g>>>0<o>>>0)break e;if(i=h[e+4>>2],E=h[i+32>>2],d[i+36|0]<=1){if(i=h[E+20>>2],i=(r=(n=h[E+16>>2])+4|0)>>>0<4?i+1|0:i,m=r,r=h[E+12>>2],m>>>0>p[E+8>>2]&(0|r)<=(0|i)|(0|r)<(0|i))break e;r=n+h[E>>2]|0,r=d[0|r]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[t+48>>2]=r,h[E+16>>2]=m,h[E+20>>2]=i}else{if(!Ar(1,t+48|0,E))break e;r=h[t+48>>2]}if(r>>>0>g>>>0)break e;if(h[e+28>>2]=h[e+24>>2],vr(i=mi(88)),m=h[e+8>>2],h[e+8>>2]=i,m&&(Lr(m),!h[e+8>>2]))break e;if(h[e+164>>2]=h[e+160>>2],kr(e+160|0,o),h[e+176>>2]=h[e+172>>2],kr(e+172|0,o),h[e- -64>>2]=0,h[e+92>>2]=-1,h[e+84>>2]=-1,h[e+88>>2]=-1,h[e+40>>2]=h[e+36>>2],h[e+52>>2]=h[e+48>>2],h[e+76>>2]=h[e+72>>2],Dr(U=e+216|0),pe(U,l),!jt(h[e+8>>2],o,h[e+156>>2]+r|0))break e;if(i=h[e+156>>2],s[0|t]=1,Rt(e+120|0,r+i|0,t),r=h[e+4>>2],(i=65535&((i=f[r+36>>1])<<8|i>>>8))>>>0<=513){if(n=h[r+32>>2],i>>>0<=511){if(r=h[n+20>>2],r=(i=(o=h[n+16>>2])+4|0)>>>0<4?r+1|0:r,m=i,i=h[n+12>>2],m>>>0>p[n+8>>2]&(0|i)<=(0|r)|(0|r)>(0|i))break e;i=o+h[n>>2]|0,o=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[n+16>>2]=m,h[n+20>>2]=r}else{if(!Ar(1,t+44|0,n))break e;o=h[t+44>>2]}if(!o)break e;if(n=h[h[e+4>>2]+32>>2],(r=(m=h[n+8>>2])-(i=h[n+16>>2])|0)>>>0<o>>>0&(0|(i=h[n+12>>2]-(h[n+20>>2]+(i>>>0>m>>>0)|0)|0))<=0|(0|i)<0)break e;if(u[t+38>>1]=0,h[t>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,h[t+16>>2]=0,h[t+20>>2]=0,h[t+24>>2]=0,h[t+28>>2]=0,s[t+29|0]=0,s[t+30|0]=0,s[t+31|0]=0,s[t+32|0]=0,s[t+33|0]=0,s[t+34|0]=0,s[t+35|0]=0,s[t+36|0]=0,n=h[h[e+4>>2]+32>>2],m=((i=h[n+16>>2])+h[n>>2]|0)+o|0,i=((r=h[n+8>>2])-i|0)-o|0,u[t+38>>1]=f[n+38>>1],h[t>>2]=m,h[t+16>>2]=0,h[t+20>>2]=0,h[t+8>>2]=i,h[t+12>>2]=0,-1==(0|(E=ee(e,t))))break e;B=E>>31}else if(E=-1,B=-1,-1==(0|ee(e,h[r+32>>2])))break e;h[144+(m=F=e+232|0)>>2]=e,i=h[32+(0|Cn[h[h[e>>2]+32>>2]](e))>>2],o=h[i>>2]+h[i+16>>2]|0,r=h[32+(0|Cn[h[h[e>>2]+32>>2]](e))>>2],i=(i=h[r+8>>2])-(r=h[r+16>>2])|0,j=m,z=f[h[32+(0|Cn[h[h[e>>2]+32>>2]](e))>>2]+38>>1],u[j+38>>1]=z,h[m>>2]=o,h[m+16>>2]=0,h[m+20>>2]=0,h[m+8>>2]=i,h[m+12>>2]=0,h[e+372>>2]=l,u[t+38>>1]=0,h[t>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,h[t+16>>2]=0,h[t+20>>2]=0,h[t+24>>2]=0,h[t+28>>2]=0,s[t+29|0]=0,s[t+30|0]=0,s[t+31|0]=0,s[t+32|0]=0,s[t+33|0]=0,s[t+34|0]=0,s[t+35|0]=0,s[t+36|0]=0;r:if(Re(m,t)){r=0,o=0,i=0,R=0,m=0,N=b=N-96|0,h[b+72>>2]=0,h[b+64>>2]=0,h[b+68>>2]=0,h[b+48>>2]=0,h[b+52>>2]=0,h[b+40>>2]=0,h[b+44>>2]=0,h[b+56>>2]=1065353216,h[b+32>>2]=0,h[b+24>>2]=0,h[b+28>>2]=0,y=1,l=e,V=h[e+124>>2];i:{n:{s:{o:{a:{l:{c:{u:if(!((0|g)<=0)){for(k=h[l+216>>2]!=h[l+220>>2];;){R=(c=R)+1|0;h:{d:{f:{p:{m:{g:{v:{_:{b:{y:{E:if(d[l+308|0]){w:{if(!((e=(M=h[l+296>>2])+((w=h[l+304>>2])>>>3|0)|0)>>>0>=(_=h[l+300>>2])>>>0)&&(n=d[0|e],e=w+1|0,h[l+304>>2]=e,n>>>(7&w)&1))switch((n=M+(A=e>>>3|0)|0)>>>0>=_>>>0?(n=e,e=0):(a=d[0|n],n=w+2|0,h[l+304>>2]=n,A=n>>>3|0,e=a>>>(7&e)&1),(a=A+M|0)>>>0<_>>>0?(a=d[0|a],h[l+304>>2]=n+1,n=a>>>(7&n)<<1&2):n=0,(e=(e|n)<<1)-1|0){case 0:case 2:case 4:break s;case 5:break y;case 1:case 3:break w;default:break E}if((0|i)==(0|o)){n=-1;break c}A=-1,T=h[l+8>>2],M=h[T+24>>2],e=-1,-1!=(0|(P=h[(_=i-4|0)>>2]))&&(e=-1,-1!=(0|(r=((r=P+1|0)>>>0)%3|0?r:P-2|0))&&(e=h[h[T>>2]+(r<<2)>>2])),-1!=(0|(n=h[M+((r=e)<<2)>>2]))&&(A=((e=n+1|0)>>>0)%3|0?e:n-2|0),n=h[T+12>>2],e=(x=v(c,3))+1|0,h[n+(P<<2)>>2]=e,h[(a=e<<2)+n>>2]=P,w=x+2|0,h[n+(A<<2)>>2]=w,h[(c=w<<2)+n>>2]=A,C=-1,e=-1;x:if(-1!=(0|P)){if((P>>>0)%3|0)n=P-1|0;else if(e=-1,-1==(0|(n=P+2|0)))break x;e=h[h[T>>2]+(n<<2)>>2]}if(-1!=(0|A)&&-1!=(0|(n=((n=A+1|0)>>>0)%3|0?n:A-2|0))&&(C=h[h[T>>2]+(n<<2)>>2]),n=-1,(0|e)==(0|r)|(0|r)==(0|C))break c;n=h[T>>2],h[n+(x<<2)>>2]=r,h[n+a>>2]=C,h[n+c>>2]=e,-1!=(0|e)&&(h[M+(e<<2)>>2]=w),n=h[l+120>>2]+(r>>>3&536870908)|0,e=h[n>>2],j=n,z=ki(r)&e,h[j>>2]=z,h[_>>2]=x,r=o;break h}if((0|i)==(0|o)){n=-1;break c}if(C=h[l+8>>2],r=h[C+12>>2],e=(_=(x=v(c,3))+((M=5==(1|e))?2:1)|0)<<2,P=h[(a=i-4|0)>>2],h[r+e>>2]=P,h[r+(P<<2)>>2]=_,or(C+24|0),n=-1,r=h[l+8>>2],w=h[r+24>>2],(0|V)<h[r+28>>2]-w>>2)break c;if(n=(T=h[r>>2])+e|0,e=((r=h[C+28>>2]-h[C+24>>2]|0)>>2)-1|0,h[n>>2]=e,r&&(h[w+(e<<2)>>2]=_),_=M?x:x+2|0,n=T+(x+M<<2)|0,-1!=(0|P)){w:{x:{if((P>>>0)%3|0)r=P-1|0;else if(-1==(0|(r=P+2|0)))break x;if(e=h[T+(r<<2)>>2],h[T+(_<<2)>>2]=e,-1==(0|e))break w;h[w+(e<<2)>>2]=_;break w}h[T+(_<<2)>>2]=-1}r=-1,-1!=(0|(e=((e=P+1|0)>>>0)%3|0?e:P-2|0))&&(r=h[T+(e<<2)>>2])}else h[T+(_<<2)>>2]=-1,r=-1;h[n>>2]=r,h[a>>2]=x,r=o;break b}if((0|i)==(0|o)){n=-1;break c}T=h[(e=i-4|0)>>2],h[b+68>>2]=e;E:if(_=h[b+44>>2])if((a=Ii(_)>>>0>1)?_>>>0>(r=c)>>>0||(r=(c>>>0)%(_>>>0)|0):r=c&_+2147483647,n=h[h[b+40>>2]+(r<<2)>>2])if(n=h[n>>2]){w:{if(!a){for(_=_-1|0;;){x:{if((0|(a=h[n+4>>2]))!=(0|c)){if((a&_)==(0|r))break x;i=e;break E}if((0|c)==h[n+8>>2])break w}if(!(n=h[n>>2]))break}i=e;break E}for(;;){x:{if((0|(a=h[n+4>>2]))!=(0|c)){if(a>>>0>=_>>>0&&(a=(a>>>0)%(_>>>0)|0),(0|r)==(0|a))break x;i=e;break E}if((0|c)==h[n+8>>2])break w}if(!(n=h[n>>2]))break}i=e;break E}if((0|e)==(0|D)){if((r=1+(i=(a=D-o|0)>>2)|0)>>>0>=1073741824)break v;if(e=a>>1,r=a>>>0<2147483644?e>>>0<r>>>0?r:e:1073741823){if(r>>>0>=1073741824)break n;I=mi(r<<2)}else I=0;h[(e=I+(i<<2)|0)>>2]=h[n+12>>2],D=(r<<2)+I|0,i=e+4|0,(0|a)>0&&He(I,o,a),h[b+72>>2]=D,h[b+68>>2]=i,h[b+64>>2]=I,o&&ve(o)}else h[e>>2]=h[n+12>>2],h[b+68>>2]=i}else i=e;else i=e;else i=e;if((0|i)==(0|I))break _;if(r=-1==(0|(x=h[(a=i-4|0)>>2])),C=h[l+8>>2],!r&-1!=h[h[C+12>>2]+(x<<2)>>2])break _;if(w=h[C+12>>2],-1!=(0|T)&-1!=h[w+(T<<2)>>2])break _;if(c=(M=v(c,3))+2|0,h[w+(x<<2)>>2]=c,h[(_=c<<2)+w>>2]=x,e=M+1|0,h[w+(T<<2)>>2]=e,h[(o=e<<2)+w>>2]=T,r)break g;if((x>>>0)%3|0){y=x-1|0;break p}if(-1!=(0|(y=x+2|0)))break p;A=h[C>>2],r=-1;break f}if(or((e=h[l+8>>2])+24|0),n=-1,a=h[l+8>>2],T=v(c,3),_=(C=(w=h[e+28>>2]-h[e+24>>2]|0)>>2)-1|0,h[h[a>>2]+(T<<2)>>2]=_,or(a+24|0),M=T+1|0,h[h[a>>2]+(M<<2)>>2]=(h[a+28>>2]-h[a+24>>2]>>2)-1,or((e=h[l+8>>2])+24|0),a=T+2|0,h[h[e>>2]+(a<<2)>>2]=(h[e+28>>2]-h[e+24>>2]>>2)-1,e=h[l+8>>2],x=h[e+24>>2],(0|V)<h[e+28>>2]-x>>2)break c;y:{if(w){if(h[x+(_<<2)>>2]=T,n=0,-4!=(0|w)&&(h[x+(C<<2)>>2]=M,-1==(0|(n=C+1|0))))break y}else h[x+(C<<2)>>2]=M,n=1;h[x+(n<<2)>>2]=a}if((0|i)==(0|D)){if((I=1+(i=(n=i-r|0)>>2)|0)>>>0>=1073741824)break m;if(e=n>>1,o=n>>>0<2147483644?e>>>0<I>>>0?I:e:1073741823){if(o>>>0>=1073741824)break n;I=mi(o<<2)}else I=0;h[(e=I+(i<<2)|0)>>2]=T,D=(o<<2)+I|0,i=e+4|0,(0|n)>0&&He(I,r,n),h[b+72>>2]=D,h[b+68>>2]=i,h[b+64>>2]=I,r&&ve(r),r=o=I}else h[i>>2]=T,i=i+4|0,h[b+68>>2]=i}if((0|(n=h[l+40>>2]))==h[l+36>>2])break h;for(_=(-1^c)+g|0,a=i-4|0;;){if((e=h[n-8>>2])>>>0>_>>>0)break _;if((0|e)!=(0|_))break h;if(c=d[n-4|0],n=h[(e=n-12|0)>>2],h[l+40>>2]=e,(0|n)<0)break _;M=h[a>>2],h[b+20>>2]=(-1^n)+g,e=b+20|0,h[b+88>>2]=e,_e(b,b+40|0,e,b+88|0),n=h[b>>2];b:if(1&c){if(e=-1,-1==(0|M))break b;e=((e=M+1|0)>>>0)%3|0?e:M-2|0}else e=-1,-1!=(0|M)&&(e=M-1|0,(M>>>0)%3|0||(e=M+2|0));if(h[n+12>>2]=e,(0|(n=h[l+40>>2]))==h[l+36>>2])break}break h}if(n=-1,1&y)break c;break u}vn(),S()}r=-1,A=h[C>>2],h[A+(M<<2)>>2]=-1,n=-1;break d}vn(),S()}A=h[C>>2],r=h[A+(y<<2)>>2]}h[(M<<2)+A>>2]=r,n=-1,-1!=(0|(e=((e=x+1|0)>>>0)%3|0?e:x-2|0))&&(n=h[(e<<2)+A>>2])}if(h[o+A>>2]=n,-1!=(0|T)){d:{f:{if((T>>>0)%3|0)n=T-1|0;else if(-1==(0|(n=T+2|0)))break f;if(e=h[(n<<2)+A>>2],h[_+A>>2]=e,-1==(0|e))break d;h[h[C+24>>2]+(e<<2)>>2]=c;break d}h[_+A>>2]=-1}y=-1,n=-1,-1!=(0|(e=((e=T+1|0)>>>0)%3|0?e:T-2|0))&&(y=h[(e<<2)+A>>2],n=e)}else h[_+A>>2]=-1,y=-1,n=-1;c=(e=h[C+24>>2])+(y<<2)|0,-1!=(0|r)&&(h[e+(r<<2)>>2]=h[c>>2]);d:if(-1!=(0|n))for(;;){if(h[(n<<2)+A>>2]=r,-1==(0|(e=((e=n+1|0)>>>0)%3|0?e:n-2|0)))break d;if(-1==(0|(o=h[w+(e<<2)>>2])))break d;if(-1==(0|(n=((e=o+1|0)>>>0)%3|0?e:o-2|0)))break}h[c>>2]=-1;d:if(!k){if((0|L)==(0|G)){f:{if((o=1+(r=(n=L-m|0)>>2)|0)>>>0<1073741824){if(e=n>>1,o=n>>>0<2147483644?e>>>0<o>>>0?o:e:1073741823){if(o>>>0>=1073741824)break f;e=mi(o<<2)}else e=0;h[(r=e+(r<<2)|0)>>2]=y,L=e+(o<<2)|0,G=r+4|0,(0|n)>0&&He(e,m,n),h[b+32>>2]=L,h[b+28>>2]=G,h[b+24>>2]=e,m&&ve(m),m=e;break d}vn(),S()}break n}h[G>>2]=y,G=G+4|0,h[b+28>>2]=G}h[a>>2]=M,r=o=I}if(y=(0|g)>(0|R),(0|g)==(0|R))break}R=g}if(n=-1,y=h[l+8>>2],!((0|V)<h[y+28>>2]-h[y+24>>2]>>2)){if((0|i)!=(0|I)){for(o=l+60|0,M=l+312|0;;){w=h[(i=i-4|0)>>2],h[b+68>>2]=i;u:{h:{d:{if(f[l+270>>1]<=513){if(!d[l+364|0])break d;if(r=h[l+360>>2],(e=h[l+352>>2]+(r>>>3|0)|0)>>>0>=p[l+356>>2])break h;e=d[0|e],h[l+360>>2]=r+1,e=e>>>(7&r)&1}else e=Br(M);if(!e)break h}if(k=h[l+8>>2],x=h[k>>2],((h[k+4>>2]-x>>2>>>0)/3|0)<=(0|R))break c;if(e=-1,r=-1,_=h[k+24>>2],c=-1,-1!=(0|w)&&(c=-1,-1!=(0|(a=((a=w+1|0)>>>0)%3|0?a:w-2|0))&&(c=h[x+(a<<2)>>2])),-1!=(0|(g=h[_+(c<<2)>>2]))&&-1!=(0|(a=((a=g+1|0)>>>0)%3|0?a:g-2|0))&&(-1!=(0|(e=((e=a+1|0)>>>0)%3|0?e:a-2|0))&&(r=h[x+(e<<2)>>2]),e=a),y=-1,A=-1,g=-1,-1!=(0|(_=h[_+(r<<2)>>2]))&&(g=-1,-1!=(0|(a=((a=_+1|0)>>>0)%3|0?a:_-2|0))&&(-1!=(0|(g=((g=a+1|0)>>>0)%3|0?g:a-2|0))&&(A=h[x+(g<<2)>>2]),g=a)),L=h[k+12>>2],C=v(R,3),h[L+(_=C<<2)>>2]=w,h[L+(w<<2)>>2]=C,h[(a=(w=C+1|0)<<2)+L>>2]=e,h[L+(e<<2)>>2]=w,h[(e=(k=C+2|0)<<2)+L>>2]=g,h[L+(g<<2)>>2]=k,h[_+x>>2]=r,h[(g=a+x|0)>>2]=A,h[(a=e+x|0)>>2]=c,_=h[l+120>>2],e=h[(r=_+((c=w>>>0<C>>>0?-1:r)>>>3&536870908)|0)>>2],j=r,z=ki(c)&e,h[j>>2]=z,y=-1!=(0|w)?h[g>>2]:y,e=h[(r=_+(y>>>3&536870908)|0)>>2],j=r,z=ki(y)&e,h[j>>2]=z,y=-1,y=-1!=(0|k)?h[a>>2]:y,e=h[(r=_+(y>>>3&536870908)|0)>>2],j=r,z=ki(y)&e,h[j>>2]=z,(0|(y=h[l+64>>2]))==(e=h[l+68>>2])<<5){if((y+1|0)<0)break l;Se(o,e=y>>>0<=1073741822?(e<<=6)>>>0<(r=y+32&-32)>>>0?r:e:2147483647),y=h[l+64>>2]}if(R=R+1|0,h[l+64>>2]=y+1,e=h[l+60>>2]+(y>>>3&536870908)|0,h[e>>2]=h[e>>2]|1<<y,(0|(e=h[l+76>>2]))!=h[l+80>>2]){h[e>>2]=C,h[l+76>>2]=e+4;break u}if((c=1+(r=(g=e-(a=h[l+72>>2])|0)>>2)|0)>>>0>=1073741824)break a;if(e=g>>1,c=g>>>0<2147483644?e>>>0<c>>>0?c:e:1073741823){if(c>>>0>=1073741824)break n;e=mi(c<<2)}else e=0;if(h[(r=e+(r<<2)|0)>>2]=C,(0|g)>0&&He(e,a,g),h[l+80>>2]=e+(c<<2),h[l+76>>2]=r+4,h[l+72>>2]=e,!a)break u;ve(a);break u}if((0|(e=h[l+64>>2]))==(c=h[l+68>>2])<<5){if((e+1|0)<0)break l;e>>>0<=1073741822?(r=e+32&-32,e=(e=c<<6)>>>0<r>>>0?r:e):e=2147483647,Se(o,e),e=h[l+64>>2]}if(h[l+64>>2]=e+1,c=h[l+60>>2]+(e>>>3&536870908)|0,r=h[c>>2],j=c,z=ki(e)&r,h[j>>2]=z,(0|(e=h[l+76>>2]))==h[l+80>>2]){if((c=1+(r=(g=e-(a=h[l+72>>2])|0)>>2)|0)>>>0>=1073741824)break a;if(e=g>>1,c=g>>>0<2147483644?e>>>0<c>>>0?c:e:1073741823){if(c>>>0>=1073741824)break o;e=mi(c<<2)}else e=0;h[(r=e+(r<<2)|0)>>2]=w,(0|g)>0&&He(e,a,g),h[l+80>>2]=e+(c<<2),h[l+76>>2]=r+4,h[l+72>>2]=e,a&&ve(a)}else h[e>>2]=w,h[l+76>>2]=e+4}if((0|i)==(0|I))break}y=h[l+8>>2]}if(((h[y+4>>2]-h[y>>2]>>2>>>0)/3|0)==(0|R))if(R=h[y+24>>2],n=h[y+28>>2]-R>>2,(0|m)!=(0|G))for(r=m;;){if(o=h[r>>2],-1==h[(A=((i=n-1|0)<<2)+R|0)>>2])for(;i=n-2|0,n=n-1|0,-1==h[(A=(i<<2)+R|0)>>2];);if(i>>>0>=o>>>0){if(h[b>>2]=y,R=h[A>>2],s[b+12|0]=1,h[b+8>>2]=R,h[b+4>>2]=R,-1!=(0|R))for(;h[h[y>>2]+(R<<2)>>2]=o,bt(b),y=h[l+8>>2],-1!=(0|(R=h[b+8>>2])););e=(R=h[y+24>>2])+(i<<2)|0,-1!=(0|o)&&(h[(o<<2)+R>>2]=h[e>>2]),h[e>>2]=-1,a=1<<o,o=(e=h[l+120>>2])+(o>>>3&536870908)|0,c=e+(i>>>3&536870908)|0,e=1<<i,i=h[c>>2]&e?a|h[o>>2]:h[o>>2]&(-1^a),h[o>>2]=i,h[c>>2]=h[c>>2]&(-1^e),n=n-1|0}if((0|G)==(0|(r=r+4|0)))break}else m=G}}if(m&&ve(m),e=h[b+48>>2])for(;i=h[e>>2],ve(e),e=i;);e=h[b+40>>2],h[b+40>>2]=0,e&&ve(e),I&&(h[b+68>>2]=I,ve(I)),N=b+96|0;break i}pn(),S()}vn(),S()}Zr(1336)}S()}Zr(1336),S()}if(-1!=(0|n)){r=(e=h[t+16>>2])+h[t>>2]|0,e=(i=h[t+8>>2])-e|0,i=h[h[l+4>>2]+32>>2],u[i+38>>1]=f[i+38>>1],h[i>>2]=r,h[i+16>>2]=0,h[i+20>>2]=0,h[i+8>>2]=e,h[i+12>>2]=0,r=h[l+4>>2],(65535&(i=(e=f[r+36>>1])<<8|e>>>8))>>>0<=513&&(e=h[r+32>>2],r=B+h[e+20>>2]|0,r=(I=E+h[e+16>>2]|0)>>>0<E>>>0?r+1|0:r,h[e+16>>2]=I,h[e+20>>2]=r);i:if(h[l+216>>2]!=h[l+220>>2]){if(e=h[l+8>>2],r=h[e>>2],e=h[e+4>>2],!((65535&i)>>>0>=513)){if((0|e)==(0|r))break i;for(i=0;;){if(Pe(l,i)){if(i=i+3|0,e=h[l+8>>2],i>>>0<h[e+4>>2]-h[e>>2]>>2>>>0)continue;break i}break}break r}if((0|e)!=(0|r)){for(i=0;;){if(Oe(l,i)){if(i=i+3|0,e=h[l+8>>2],i>>>0<h[e+4>>2]-h[e>>2]>>2>>>0)continue;break i}break}break r}}if(cr(F),(0|(i=h[l+216>>2]))!=h[l+220>>2])for(o=0;;){if(lt(4+((r=v(o,144))+i|0)|0,h[l+8>>2]),O=h[U>>2],(0|(i=h[132+(e=r+O|0)>>2]))!=(0|(e=h[e+136>>2])))for(;dt(4+(r+O|0)|0,h[i>>2]),O=h[U>>2],(0|e)!=(0|(i=i+4|0)););if(be(4+(r+O|0)|0),o=o+1|0,i=h[l+216>>2],!(o>>>0<(h[l+220>>2]-i|0)/144>>>0))break}if(e=h[l+8>>2],ar(l+184|0,h[e+28>>2]-h[e+24>>2]>>2),(0|(O=h[l+216>>2]))!=h[l+220>>2])for(i=0;e=v(i,144)+O|0,r=h[e+60>>2]-h[e+56>>2]>>2,o=e+104|0,e=h[l+8>>2],ar(o,(0|(e=h[e+28>>2]-h[e+24>>2]>>2))>(0|r)?e:r),i=i+1|0,O=h[l+216>>2],i>>>0<(h[l+220>>2]-O|0)/144>>>0;);O=ne(l,n)}}break e}O=0}return N=t- -64|0,0|O},hn,Zi,Ji,pt,function(e){ve(pt(e|=0))},Fi,Wt,Jt,K,function(e){var t,r=0,i=0,n=0,o=0,a=0,l=0,c=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,G=0,D=0,U=0,V=0,B=0,F=0,j=0,z=0,W=0,H=0,$=0;if(N=t=N+-64|0,h[132+(e|=0)>>2]=0,h[e+148>>2]){if(o=h[e+144>>2])for(;n=h[o>>2],ve(o),o=n,n;);if(o=0,h[e+144>>2]=0,a=h[e+140>>2]){if(a-1>>>0>=3)for(n=-4&a;h[(r=o<<2)+h[e+136>>2]>>2]=0,h[h[e+136>>2]+(4|r)>>2]=0,h[h[e+136>>2]+(8|r)>>2]=0,h[h[e+136>>2]+(12|r)>>2]=0,o=o+4|0,(0|n)!=(0|(l=l+4|0)););if(n=3&a)for(;h[h[e+136>>2]+(o<<2)>>2]=0,o=o+1|0,(0|n)!=(0|(R=R+1|0)););}h[e+148>>2]=0}e:{t:{if(o=h[e+4>>2],!((n=(R=d[o+36|0])<<8|d[o+37|0])>>>0>513))if(i=h[o+32>>2],n>>>0<=511){if(n=h[i+20>>2],n=(l=(a=h[i+16>>2])+4|0)>>>0<4?n+1|0:n,r=l,l=h[i+12>>2],r>>>0>p[i+8>>2]&(0|l)<=(0|n)|(0|n)>(0|l))break t;l=a+h[i>>2]|0,l=d[0|l]|d[l+1|0]<<8|d[l+2|0]<<16|d[l+3|0]<<24,h[i+16>>2]=r,h[i+20>>2]=n,h[e+132>>2]=l}else{if(!Ar(1,t,i))break t;o=h[e+4>>2],R=d[o+36|0],h[e+132>>2]=h[t>>2]}i=h[o+32>>2];r:{i:{if((255&R)>>>0<=1){if(R=0,n=h[i+20>>2],n=(l=(a=h[i+16>>2])+4|0)>>>0<4?n+1|0:n,r=l,l=h[i+12>>2],r>>>0>p[i+8>>2]&(0|l)<=(0|n)|(0|n)>(0|l))break e;l=a+h[i>>2]|0,l=d[0|l]|d[l+1|0]<<8|d[l+2|0]<<16|d[l+3|0]<<24,h[t+60>>2]=l,h[i+16>>2]=r,h[i+20>>2]=n,h[e+156>>2]=l,i=e+156|0}else{if(R=0,!Ar(1,t+60|0,i))break e;if(o=h[e+4>>2],n=d[o+36|0],h[e+156>>2]=h[t+60>>2],i=e+156|0,n>>>0>1)break i}if(E=h[o+32>>2],n=h[E+8>>2],a=h[E+12>>2],g=n,n=h[E+20>>2],g>>>0<(o=l=(r=h[E+16>>2])+4|0)>>>0&(0|(n=l>>>0<4?n+1|0:n))>=(0|a)|(0|n)>(0|a))break e;l=r+h[E>>2]|0,l=d[0|l]|d[l+1|0]<<8|d[l+2|0]<<16|d[l+3|0]<<24,h[t+56>>2]=l,h[E+16>>2]=o,h[E+20>>2]=n;break r}if(!Ar(1,t+56|0,h[o+32>>2]))break e;l=h[t+56>>2]}if(l>>>0>1431655765|p[i>>2]>v(l,3)>>>0)break e;if(O=h[e+4>>2],o=h[O+32>>2],a=g=h[o+8>>2],(0|(r=h[o+12>>2]))<=(0|(n=h[o+20>>2]))&(b=h[o+16>>2])>>>0>=a>>>0|(0|n)>(0|r))break e;if(E=h[o>>2],m=d[E+b|0],a=(i=b+1|0)?n:n+1|0,h[o+16>>2]=i,h[o+20>>2]=a,d[O+36|0]<=1){if((a=b+5|0)>>>0>g>>>0&(0|(n=a>>>0<5?n+1|0:n))>=(0|r)|(0|n)>(0|r))break e;i=d[0|(r=i+E|0)]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[t+52>>2]=i,h[o+16>>2]=a,h[o+20>>2]=n}else{if(!Ar(1,t+52|0,o))break e;i=h[t+52>>2]}if(((i>>>0)/3|0)+i>>>0<l>>>0|i>>>0>l>>>0)break e;if(n=h[e+4>>2],E=h[n+32>>2],d[n+36|0]<=1){if(n=h[E+20>>2],n=(o=(r=h[E+16>>2])+4|0)>>>0<4?n+1|0:n,a=o,o=h[E+12>>2],a>>>0>p[E+8>>2]&(0|o)<=(0|n)|(0|n)>(0|o))break e;o=r+h[E>>2]|0,r=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+48>>2]=r,h[E+16>>2]=a,h[E+20>>2]=n}else{if(!Ar(1,t+48|0,E))break e;r=h[t+48>>2]}if(i>>>0<r>>>0)break e;if(h[e+28>>2]=h[e+24>>2],vr(n=mi(88)),o=h[e+8>>2],h[e+8>>2]=n,o&&(Lr(o),!h[e+8>>2]))break e;if(h[e+164>>2]=h[e+160>>2],kr(e+160|0,l),h[e+176>>2]=h[e+172>>2],kr(e+172|0,l),h[e- -64>>2]=0,h[e+92>>2]=-1,h[e+84>>2]=-1,h[e+88>>2]=-1,h[e+40>>2]=h[e+36>>2],h[e+52>>2]=h[e+48>>2],h[e+76>>2]=h[e+72>>2],Dr(F=e+216|0),pe(F,m),!jt(h[e+8>>2],l,h[e+156>>2]+r|0))break e;if(n=h[e+156>>2],s[0|t]=1,Rt(e+120|0,n+r|0,t),l=h[e+4>>2],(n=65535&((n=f[l+36>>1])<<8|n>>>8))>>>0<=513){if(E=h[l+32>>2],n>>>0<=511){if(n=h[E+20>>2],n=(l=(a=h[E+16>>2])+4|0)>>>0<4?n+1|0:n,o=l,l=h[E+12>>2],o>>>0>p[E+8>>2]&(0|l)<=(0|n)|(0|n)>(0|l))break e;l=a+h[E>>2]|0,l=d[0|l]|d[l+1|0]<<8|d[l+2|0]<<16|d[l+3|0]<<24,h[E+16>>2]=o,h[E+20>>2]=n}else{if(!Ar(1,t+44|0,E))break e;l=h[t+44>>2]}if(!l)break e;if(E=h[h[e+4>>2]+32>>2],(o=(a=h[E+8>>2])-(n=h[E+16>>2])|0)>>>0<l>>>0&(0|(n=h[E+12>>2]-(h[E+20>>2]+(n>>>0>a>>>0)|0)|0))<=0|(0|n)<0)break e;if(u[t+38>>1]=0,h[t>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,h[t+16>>2]=0,h[t+20>>2]=0,h[t+24>>2]=0,h[t+28>>2]=0,s[t+29|0]=0,s[t+30|0]=0,s[t+31|0]=0,s[t+32|0]=0,s[t+33|0]=0,s[t+34|0]=0,s[t+35|0]=0,s[t+36|0]=0,E=h[h[e+4>>2]+32>>2],a=((n=h[(o=E)+16>>2])+h[o>>2]|0)+l|0,n=((o=h[o+8>>2])-n|0)-l|0,u[t+38>>1]=f[E+38>>1],h[t>>2]=a,h[t+16>>2]=0,h[t+20>>2]=0,h[t+8>>2]=n,h[t+12>>2]=0,-1==(0|(E=ee(e,t))))break e;W=E>>31}else if(E=-1,W=-1,-1==(0|ee(e,h[l+32>>2])))break e;dr(D=e+232|0,e),h[e+372>>2]=m,h[e+384>>2]=h[e+156>>2]+r,u[t+38>>1]=0,h[t>>2]=0,h[(n=t)+8>>2]=0,h[n+12>>2]=0,h[n+16>>2]=0,h[n+20>>2]=0,h[n+24>>2]=0,h[n+28>>2]=0,s[n+29|0]=0,s[n+30|0]=0,s[n+31|0]=0,s[n+32|0]=0,s[n+33|0]=0,s[n+34|0]=0,s[n+35|0]=0,s[n+36|0]=0,b=0,N=g=N-16|0,Re(D,n)&&(l=n,n=h[n+20>>2],n=(o=(a=h[l+16>>2])+4|0)>>>0<4?n+1|0:n,r=o,o=h[l+12>>2],r>>>0>p[l+8>>2]&(0|o)<=(0|n)|(0|n)>(0|o)||(o=a+h[l>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[l+16>>2]=r,h[l+20>>2]=n,(0|o)<0||(0|(r=h[D+152>>2]))<=(0|o)||(h[g+12>>2]=0,n=h[D+156>>2],(o=h[D+160>>2]-n>>2)>>>0<r>>>0?$e(D+156|0,r-o|0,g+12|0):r>>>0>=o>>>0||(h[D+160>>2]=n+(r<<2)),b=ze(D+168|0,l)))),N=g+16|0;r:if(b){r=0,b=0,o=0,n=0,l=0,O=0,N=y=N-96|0,h[y+72>>2]=0,h[y+64>>2]=0,h[y+68>>2]=0,h[y+48>>2]=0,h[y+52>>2]=0,h[y+40>>2]=0,h[y+44>>2]=0,h[y+56>>2]=1065353216,h[y+32>>2]=0,h[y+24>>2]=0,h[y+28>>2]=0,w=1,c=e,j=h[e+124>>2];i:{n:{s:{o:{g=i;a:{l:if(!((0|i)<=0)){for(V=c+400|0,z=c+232|0,k=h[c+216>>2]!=h[c+220>>2];;){O=(m=O)+1|0;c:{u:{h:{d:{if(-1==h[c+420>>2]||!Br(V)){if(d[c+308|0]){if((e=(x=h[c+296>>2])+((A=h[c+304>>2])>>>3|0)|0)>>>0>=(T=h[c+300>>2])>>>0)break d;if(a=d[0|e],e=A+1|0,h[c+304>>2]=e,!(a>>>(7&A)&1))break d;(a=x+(_=e>>>3|0)|0)>>>0>=T>>>0?(a=e,e=0):(i=d[0|a],a=A+2|0,h[c+304>>2]=a,_=a>>>3|0,e=i>>>(7&e)&1),(i=_+x|0)>>>0<T>>>0?(i=d[0|i],h[c+304>>2]=a+1,a=i>>>(7&a)<<1&2):a=0,i=(e|a)<<1|1}else i=1;h[c+416>>2]=i;break u}if(i=h[c+420>>2],h[c+416>>2]=i,i)break u;break h}h[c+416>>2]=0}if((0|r)==(0|b)){a=-1;break a}T=-1,P=h[c+8>>2],e=A=h[P+24>>2],i=-1,-1!=(0|(L=h[(x=r-4|0)>>2]))&&(i=-1,-1!=(0|(a=((a=L+1|0)>>>0)%3|0?a:L-2|0))&&(i=h[h[P>>2]+(a<<2)>>2])),-1!=(0|(a=h[e+(i<<2)>>2]))&&(T=((e=a+1|0)>>>0)%3|0?e:a-2|0),a=h[P+12>>2],e=(C=v(m,3))+1|0,h[a+(L<<2)>>2]=e,h[(_=e<<2)+a>>2]=L,M=C+2|0,h[a+(T<<2)>>2]=M,h[(m=M<<2)+a>>2]=T,w=-1,e=-1;h:if(-1!=(0|L)){if((L>>>0)%3|0)a=L-1|0;else if(e=-1,-1==(0|(a=L+2|0)))break h;e=h[h[P>>2]+(a<<2)>>2]}if(-1!=(0|T)&&-1!=(0|(a=((a=T+1|0)>>>0)%3|0?a:T-2|0))&&(w=h[h[P>>2]+(a<<2)>>2]),a=-1,(0|e)==(0|i)|(0|i)==(0|w))break a;a=h[P>>2],h[a+(C<<2)>>2]=i,h[a+_>>2]=w,h[a+m>>2]=e,-1!=(0|e)&&(h[A+(e<<2)>>2]=M),a=h[c+120>>2]+(i>>>3&536870908)|0,e=h[a>>2],H=a,$=ki(i)&e,h[H>>2]=$,h[x>>2]=C,Ve(z,C);break c}a=-1;u:{h:{d:{f:{p:{m:{g:{v:{_:{b:switch(i-1|0){case 2:case 4:if((0|n)==(0|r))break a;if(x=h[c+8>>2],_=h[x+12>>2],e=(i=(A=v(m,3))+((T=5==(0|i))?2:1)|0)<<2,C=h[(b=r-4|0)>>2],h[_+e>>2]=C,h[_+(C<<2)>>2]=i,or(x+24|0),r=h[c+8>>2],_=h[r+24>>2],h[r+28>>2]-_>>2>(0|j))break a;if(L=(M=h[r>>2])+e|0,e=((r=h[x+28>>2]-h[x+24>>2]|0)>>2)-1|0,h[L>>2]=e,r&&(h[_+(e<<2)>>2]=i),x=T?A:A+2|0,r=M+(T+A<<2)|0,-1!=(0|C)){y:{E:{if((C>>>0)%3|0)i=C-1|0;else if(-1==(0|(i=C+2|0)))break E;if(e=h[M+(i<<2)>>2],h[M+(x<<2)>>2]=e,-1==(0|e))break y;h[_+(e<<2)>>2]=x;break y}h[M+(x<<2)>>2]=-1}i=-1,-1!=(0|(e=((e=C+1|0)>>>0)%3|0?e:C-2|0))&&(i=h[M+(e<<2)>>2])}else h[M+(x<<2)>>2]=-1,i=-1;h[r>>2]=i,h[b>>2]=A;break _;case 0:if((0|r)==(0|b))break a;P=h[(o=r-4|0)>>2],h[y+68>>2]=o;y:if((x=h[y+44>>2])&&(i=h[y+40>>2],e=m&x+2147483647,(T=Ii(x)>>>0>1)&&((e=m)>>>0<x>>>0||(e=(m>>>0)%(x>>>0)|0)),(e=h[i+((_=e)<<2)>>2])&&(i=h[e>>2]))){E:{if(!T){for(T=x-1|0;;){w:{if((0|(e=h[i+4>>2]))!=(0|m)){if((0|_)==(e&T))break w;break y}if((0|m)==h[i+8>>2])break E}if(!(i=h[i>>2]))break}break y}for(;;){w:{if((0|(e=h[i+4>>2]))!=(0|m)){if(e>>>0>=x>>>0&&(e=(e>>>0)%(x>>>0)|0),(0|e)==(0|_))break w;break y}if((0|m)==h[i+8>>2])break E}if(!(i=h[i>>2]))break}break y}if((0|o)==(0|B)){if((n=1+(o=(_=B-b|0)>>2)|0)>>>0>=1073741824)break m;if(e=_>>1,r=_>>>0<2147483644?e>>>0<n>>>0?n:e:1073741823){if(r>>>0>=1073741824)break n;n=mi(r<<2)}else n=0;h[(e=n+(o<<2)|0)>>2]=h[i+12>>2],B=(r<<2)+n|0,o=e+4|0,(0|_)>0&&He(n,b,_),h[y+72>>2]=B,h[y+68>>2]=o,h[y+64>>2]=n,b&&ve(b)}else h[o>>2]=h[i+12>>2],h[y+68>>2]=r,o=r}if((0|n)==(0|o))break g;if(i=-1==(0|(C=h[(_=o-4|0)>>2])),M=h[c+8>>2],!i&-1!=h[h[M+12>>2]+(C<<2)>>2])break g;if(A=h[M+12>>2],-1!=(0|P)&-1!=h[A+(P<<2)>>2])break g;if(m=(x=v(m,3))+2|0,h[A+(C<<2)>>2]=m,h[(b=m<<2)+A>>2]=C,e=x+1|0,h[A+(P<<2)>>2]=e,h[(r=e<<2)+A>>2]=P,i)break p;if((C>>>0)%3|0){a=C-1|0;break d}if(-1!=(0|(a=C+2|0)))break d;w=h[M>>2],e=-1;break h;case 6:break b;default:break a}if(or((e=h[c+8>>2])+24|0),o=h[c+8>>2],M=v(m,3),i=(x=(T=h[e+28>>2]-h[e+24>>2]|0)>>2)-1|0,h[h[o>>2]+(M<<2)>>2]=i,or(o+24|0),_=M+1|0,h[h[o>>2]+(_<<2)>>2]=(h[o+28>>2]-h[o+24>>2]>>2)-1,or((e=h[c+8>>2])+24|0),o=M+2|0,h[h[e>>2]+(o<<2)>>2]=(h[e+28>>2]-h[e+24>>2]>>2)-1,e=h[c+8>>2],A=h[e+24>>2],h[e+28>>2]-A>>2>(0|j))break a;b:{if(T){if(h[A+(i<<2)>>2]=M,i=0,-4!=(0|T)&&(h[A+(x<<2)>>2]=_,-1==(0|(i=x+1|0))))break b}else h[A+(x<<2)>>2]=_,i=1;h[A+(i<<2)>>2]=o}if((0|r)!=(0|B)){h[r>>2]=M,o=r+4|0,h[y+68>>2]=o;break v}if((n=1+(o=(i=B-b|0)>>2)|0)>>>0>=1073741824)break f;if(e=i>>1,r=i>>>0<2147483644?e>>>0<n>>>0?n:e:1073741823){if(r>>>0>=1073741824)break n;n=mi(r<<2)}else n=0;h[(e=n+(o<<2)|0)>>2]=M,B=(r<<2)+n|0,o=e+4|0,(0|i)>0&&He(n,b,i),h[y+72>>2]=B,h[y+68>>2]=o,h[y+64>>2]=n,b&&ve(b)}b=n}Ve(z,h[o-4>>2]);v:if((0|(i=h[c+40>>2]))!=h[c+36>>2])for(T=g+(-1^m)|0,_=o-4|0;;){if((e=h[i-8>>2])>>>0>T>>>0)break g;if((0|e)!=(0|T))break v;if(m=d[i-4|0],r=h[(e=i-12|0)>>2],h[c+40>>2]=e,(0|r)<0)break g;i=h[_>>2],h[y+20>>2]=g+(-1^r),e=y+20|0,h[y+88>>2]=e,_e(y,y+40|0,e,y+88|0),r=h[y>>2];_:if(1&m){if(e=-1,-1==(0|i))break _;e=((e=i+1|0)>>>0)%3|0?e:i-2|0}else e=-1,-1!=(0|i)&&(e=i-1|0,(i>>>0)%3|0||(e=i+2|0));if(h[r+12>>2]=e,(0|(i=h[c+40>>2]))==h[c+36>>2])break}r=o;break c}if(w)break a;break l}vn(),S()}T=-1,w=h[M>>2],h[w+(x<<2)>>2]=-1,a=-1;break u}vn(),S()}w=h[M>>2],e=h[w+(a<<2)>>2]}T=e,h[(x<<2)+w>>2]=e,a=-1,-1!=(0|(e=((e=C+1|0)>>>0)%3|0?e:C-2|0))&&(a=h[(e<<2)+w>>2])}if(h[r+w>>2]=a,-1!=(0|P)){u:{h:{if((P>>>0)%3|0)a=P-1|0;else if(-1==(0|(a=P+2|0)))break h;if(e=h[(a<<2)+w>>2],h[b+w>>2]=e,-1==(0|e))break u;h[h[M+24>>2]+(e<<2)>>2]=m;break u}h[b+w>>2]=-1}b=-1,a=-1,-1!=(0|(e=((e=P+1|0)>>>0)%3|0?e:P-2|0))&&(b=h[(e<<2)+w>>2],a=e)}else h[b+w>>2]=-1,b=-1,a=-1;m=e=(i=h[c+388>>2])+(r=T<<2)|0,L=h[e>>2],e=b<<2,h[m>>2]=L+h[e+i>>2],i=(m=e)+(e=h[M+24>>2])|0,-1!=(0|T)&&(h[e+r>>2]=h[i>>2]);u:if(-1!=(0|a))for(;;){if(h[(a<<2)+w>>2]=T,-1==(0|(e=((e=a+1|0)>>>0)%3|0?e:a-2|0)))break u;if(-1==(0|(r=h[A+(e<<2)>>2])))break u;if(-1==(0|(a=((e=r+1|0)>>>0)%3|0?e:r-2|0)))break}h[i>>2]=-1;u:if(!k){if((0|G)==(0|U)){h:{if((l=1+(r=(i=G-I|0)>>2)|0)>>>0<1073741824){if(e=i>>1,a=i>>>0<2147483644?e>>>0<l>>>0?l:e:1073741823){if(a>>>0>=1073741824)break h;l=mi(a<<2)}else l=0;h[(e=l+(r<<2)|0)>>2]=b,G=(a<<2)+l|0,U=e+4|0,(0|i)>0&&He(l,I,i),h[y+32>>2]=G,h[y+28>>2]=U,h[y+24>>2]=l,I&&ve(I),I=l;break u}vn(),S()}break n}h[U>>2]=b,U=U+4|0,h[y+28>>2]=U}h[_>>2]=x,r=o,b=n,Ve(z,x)}if(w=(0|g)>(0|O),(0|g)==(0|O))break}O=g}if(a=-1,w=h[c+8>>2],!(h[w+28>>2]-h[w+24>>2]>>2>(0|j))){if((0|n)!=(0|o)){for(e=c+60|0,x=c+312|0;;){k=h[(o=o-4|0)>>2],h[y+68>>2]=o;l:{c:{u:{if(f[c+270>>1]<=513){if(!d[c+364|0])break u;if(i=h[c+360>>2],(r=h[c+352>>2]+(i>>>3|0)|0)>>>0>=p[c+356>>2])break c;r=d[0|r],h[c+360>>2]=i+1,r=r>>>(7&i)&1}else r=Br(x);if(!r)break c}if(A=h[c+8>>2],G=h[A>>2],((h[A+4>>2]-G>>2>>>0)/3|0)<=(0|O))break a;if(i=-1,b=-1,T=-1,m=I=h[A+24>>2],g=-1,-1!=(0|k)&&(g=-1,-1!=(0|(r=((r=k+1|0)>>>0)%3|0?r:k-2|0))&&(g=h[G+(r<<2)>>2])),r=-1,-1!=(0|(_=h[(g<<2)+m>>2]))&&(r=-1,-1!=(0|(m=((m=_+1|0)>>>0)%3|0?m:_-2|0))&&(i=m,r=-1!=(0|(r=((r=m+1|0)>>>0)%3|0?r:i-2|0))?h[G+(r<<2)>>2]:-1)),_=-1,-1!=(0|(I=h[I+(r<<2)>>2]))&&(_=-1,-1!=(0|(m=((m=I+1|0)>>>0)%3|0?m:I-2|0))&&(-1!=(0|(_=((_=m+1|0)>>>0)%3|0?_:m-2|0))&&(T=h[G+(_<<2)>>2]),_=m)),V=h[A+12>>2],M=v(O,3),h[V+(I=M<<2)>>2]=k,h[V+(k<<2)>>2]=M,h[(m=(k=M+1|0)<<2)+V>>2]=i,h[V+(i<<2)>>2]=k,h[(i=(A=M+2|0)<<2)+V>>2]=_,h[V+(_<<2)>>2]=A,h[I+G>>2]=r,h[(_=m+G|0)>>2]=T,h[(m=i+G|0)>>2]=g,I=h[c+120>>2],r=h[(i=I+((g=M>>>0>k>>>0?-1:r)>>>3&536870908)|0)>>2],H=i,$=ki(g)&r,h[H>>2]=$,b=-1!=(0|k)?h[_>>2]:b,r=h[(i=I+(b>>>3&536870908)|0)>>2],H=i,$=ki(b)&r,h[H>>2]=$,i=-1,i=-1!=(0|A)?h[m>>2]:i,r=h[(g=I+(i>>>3&536870908)|0)>>2],H=g,$=ki(i)&r,h[H>>2]=$,(0|(i=h[c+64>>2]))==(r=h[c+68>>2])<<5){if((i+1|0)<0)break o;Se(e,r=i>>>0<=1073741822?(i=i+32&-32)>>>0>(r<<=6)>>>0?i:r:2147483647),i=h[c+64>>2]}if(O=O+1|0,h[c+64>>2]=i+1,r=h[c+60>>2]+(i>>>3&536870908)|0,h[r>>2]=h[r>>2]|1<<i,(0|(r=h[c+76>>2]))!=h[c+80>>2]){h[r>>2]=M,h[c+76>>2]=r+4;break l}if((g=1+(i=(b=r-(m=h[c+72>>2])|0)>>2)|0)>>>0>=1073741824)break s;if(r=b>>1,g=b>>>0<2147483644?r>>>0<g>>>0?g:r:1073741823){if(g>>>0>=1073741824)break n;r=mi(g<<2)}else r=0;if(h[(i=r+(i<<2)|0)>>2]=M,(0|b)>0&&He(r,m,b),h[c+80>>2]=r+(g<<2),h[c+76>>2]=i+4,h[c+72>>2]=r,!m)break l;ve(m);break l}if((0|(w=h[c+64>>2]))==(r=h[c+68>>2])<<5){if((w+1|0)<0)break o;Se(e,r=w>>>0<=1073741822?(i=w+32&-32)>>>0>(r<<=6)>>>0?i:r:2147483647),w=h[c+64>>2]}if(h[c+64>>2]=w+1,i=h[c+60>>2]+(w>>>3&536870908)|0,r=h[i>>2],H=i,$=ki(w)&r,h[H>>2]=$,(0|(r=h[c+76>>2]))==h[c+80>>2]){if((g=1+(i=(b=r-(m=h[c+72>>2])|0)>>2)|0)>>>0>=1073741824)break s;if(r=b>>1,g=b>>>0<2147483644?r>>>0<g>>>0?g:r:1073741823){if(g>>>0>=1073741824)break n;r=mi(g<<2)}else r=0;h[(i=r+(i<<2)|0)>>2]=k,(0|b)>0&&He(r,m,b),h[c+80>>2]=r+(g<<2),h[c+76>>2]=i+4,h[c+72>>2]=r,m&&ve(m)}else h[r>>2]=k,h[c+76>>2]=r+4}if((0|n)==(0|o))break}w=h[c+8>>2]}if(((h[w+4>>2]-h[w>>2]>>2>>>0)/3|0)==(0|O))if(o=h[w+24>>2],a=h[w+28>>2]-o>>2,(0|l)!=(0|U))for(e=l;;){if(g=h[e>>2],-1==h[(r=((i=a-1|0)<<2)+o|0)>>2])for(;i=a-2|0,a=a-1|0,-1==h[(r=(i<<2)+o|0)>>2];);if(i>>>0>=g>>>0){if(h[y>>2]=w,o=h[r>>2],s[y+12|0]=1,h[y+8>>2]=o,h[y+4>>2]=o,-1!=(0|o))for(;h[h[w>>2]+(o<<2)>>2]=g,bt(y),w=h[c+8>>2],-1!=(0|(o=h[y+8>>2])););r=(o=h[w+24>>2])+(i<<2)|0,-1!=(0|g)&&(h[(g<<2)+o>>2]=h[r>>2]),h[r>>2]=-1,m=1<<g,g=(r=h[c+120>>2])+(g>>>3&536870908)|0,O=r+(i>>>3&536870908)|0,r=1<<i,h[O>>2]&r?m|=h[g>>2]:m=h[g>>2]&(-1^m),h[g>>2]=m,h[O>>2]=h[O>>2]&(-1^r),a=a-1|0}if((0|U)==(0|(e=e+4|0)))break}else l=U}}if(l&&ve(l),e=h[y+48>>2])for(;l=h[e>>2],ve(e),e=l;);e=h[y+40>>2],h[y+40>>2]=0,e&&ve(e),n&&(h[y+68>>2]=n,ve(n)),N=y+96|0;break i}pn(),S()}vn(),S()}Zr(1336),S()}if(-1!=(0|a)){l=(e=h[t+16>>2])+h[t>>2]|0,e=(n=h[t+8>>2])-e|0,n=h[h[c+4>>2]+32>>2],u[n+38>>1]=f[n+38>>1],h[n>>2]=l,h[n+16>>2]=0,h[n+20>>2]=0,h[n+8>>2]=e,h[n+12>>2]=0,n=h[c+4>>2],(65535&(l=(e=f[n+36>>1])<<8|e>>>8))>>>0<=513&&(e=h[n+32>>2],n=W+h[e+20>>2]|0,n=(o=E+h[e+16>>2]|0)>>>0<E>>>0?n+1|0:n,h[e+16>>2]=o,h[e+20>>2]=n);i:if(h[c+216>>2]!=h[c+220>>2]){if(e=h[c+8>>2],n=h[e>>2],e=h[e+4>>2],!((65535&l)>>>0>=513)){if((0|e)==(0|n))break i;for(o=0;;){if(Pe(c,o)){if(o=o+3|0,e=h[c+8>>2],o>>>0<h[e+4>>2]-h[e>>2]>>2>>>0)continue;break i}break}break r}if((0|e)!=(0|n)){for(o=0;;){if(Oe(c,o)){if(o=o+3|0,e=h[c+8>>2],o>>>0<h[e+4>>2]-h[e>>2]>>2>>>0)continue;break i}break}break r}}if(cr(D),(0|(o=h[c+216>>2]))!=h[c+220>>2])for(l=0;;){if(lt(4+((n=v(l,144))+o|0)|0,h[c+8>>2]),R=h[F>>2],(0|(o=h[132+(e=n+R|0)>>2]))!=(0|(e=h[e+136>>2])))for(;dt(4+(n+R|0)|0,h[o>>2]),R=h[F>>2],(0|e)!=(0|(o=o+4|0)););if(be(4+(n+R|0)|0),l=l+1|0,o=h[c+216>>2],!(l>>>0<(h[c+220>>2]-o|0)/144>>>0))break}if(e=h[c+8>>2],ar(c+184|0,h[e+28>>2]-h[e+24>>2]>>2),(0|(R=h[c+216>>2]))!=h[c+220>>2])for(o=0;e=v(o,144)+R|0,n=h[e+60>>2]-h[e+56>>2]>>2,l=e+104|0,e=h[c+8>>2],ar(l,(0|(e=h[e+28>>2]-h[e+24>>2]>>2))>(0|n)?e:n),o=o+1|0,R=h[c+216>>2],o>>>0<(h[c+220>>2]-R|0)/144>>>0;);R=ne(c,a)}}break e}R=0}return N=t- -64|0,0|R},hn,Zi,Ji,Ye,function(e){ve(Ye(e|=0))},Fi,Wt,Jt,K,function(e){var t,r=0,i=0,n=0,o=0,a=0,l=0,c=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,G=0,D=0,V=0,B=0,F=0,j=0,z=0,W=0,H=0;if(N=t=N+-64|0,h[132+(e|=0)>>2]=0,h[e+148>>2]){if(r=h[e+144>>2])for(;o=h[r>>2],ve(r),r=o;);if(r=0,h[e+144>>2]=0,o=h[e+140>>2]){if(o-1>>>0>=3)for(n=-4&o;h[(l=r<<2)+h[e+136>>2]>>2]=0,h[h[e+136>>2]+(4|l)>>2]=0,h[h[e+136>>2]+(8|l)>>2]=0,h[h[e+136>>2]+(12|l)>>2]=0,r=r+4|0,(0|n)!=(0|(c=c+4|0)););if(o&=3)for(;h[h[e+136>>2]+(r<<2)>>2]=0,r=r+1|0,(0|o)!=(0|(R=R+1|0)););}h[e+148>>2]=0}e:{t:{if(r=h[e+4>>2],!((c=(R=d[r+36|0])<<8|d[r+37|0])>>>0>513))if(o=h[r+32>>2],c>>>0<=511){if(c=h[o+20>>2],c=(n=(l=h[o+16>>2])+4|0)>>>0<4?c+1|0:c,(0|(i=h[o+12>>2]))<=(0|c)&n>>>0>p[o+8>>2]|(0|i)<(0|c))break t;l=l+h[o>>2]|0,l=d[0|l]|d[l+1|0]<<8|d[l+2|0]<<16|d[l+3|0]<<24,h[o+16>>2]=n,h[o+20>>2]=c,h[e+132>>2]=l}else{if(!Ar(1,t,o))break t;r=h[e+4>>2],R=d[r+36|0],h[e+132>>2]=h[t>>2]}c=h[r+32>>2];r:{i:{if((255&R)>>>0<=1){if(R=0,o=h[c+20>>2],o=(n=(l=h[c+16>>2])+4|0)>>>0<4?o+1|0:o,(0|(i=h[c+12>>2]))<=(0|o)&n>>>0>p[c+8>>2]|(0|i)<(0|o))break e;l=l+h[c>>2]|0,l=d[0|l]|d[l+1|0]<<8|d[l+2|0]<<16|d[l+3|0]<<24,h[t+60>>2]=l,h[c+16>>2]=n,h[c+20>>2]=o,h[e+156>>2]=l,n=e+156|0}else{if(R=0,!Ar(1,t+60|0,c))break e;if(r=h[e+4>>2],o=d[r+36|0],h[e+156>>2]=h[t+60>>2],n=e+156|0,o>>>0>1)break i}if(o=h[r+32>>2],r=h[o+8>>2],c=h[o+12>>2],m=r,r=h[o+20>>2],m>>>0<(i=(l=h[o+16>>2])+4|0)>>>0&(0|(r=i>>>0<4?r+1|0:r))>=(0|c)|(0|r)>(0|c))break e;c=l+h[o>>2]|0,c=d[0|c]|d[c+1|0]<<8|d[c+2|0]<<16|d[c+3|0]<<24,h[t+56>>2]=c,h[o+16>>2]=i,h[o+20>>2]=r;break r}if(!Ar(1,t+56|0,h[r+32>>2]))break e;c=h[t+56>>2]}if(c>>>0>1431655765|p[n>>2]>v(c,3)>>>0)break e;if(a=h[e+4>>2],l=h[a+32>>2],g=h[(r=l)+8>>2],(0|(n=h[r+12>>2]))<=(0|(o=h[r+20>>2]))&g>>>0<=(i=h[r+16>>2])>>>0|(0|o)>(0|n))break e;if(b=h[l>>2],m=d[b+i|0],r=o,r=(P=i+1|0)?r:r+1|0,h[l+16>>2]=P,h[l+20>>2]=r,d[a+36|0]<=1){if((0|(r=n))<=(0|(o=(n=i+5|0)>>>0<5?o+1|0:o))&(i=n)>>>0>g>>>0|(0|r)<(0|o))break e;n=d[0|(r=b+P|0)]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[t+52>>2]=n,h[l+16>>2]=i,h[l+20>>2]=o}else{if(!Ar(1,t+52|0,l))break e;n=h[t+52>>2]}if(((n>>>0)/3|0)+n>>>0<c>>>0|n>>>0>c>>>0)break e;if(r=h[e+4>>2],l=h[r+32>>2],d[r+36|0]<=1){if(r=h[l+20>>2],r=(i=(o=h[l+16>>2])+4|0)>>>0<4?r+1|0:r,(0|(a=h[l+12>>2]))<=(0|r)&i>>>0>p[l+8>>2]|(0|r)>(0|a))break e;o=o+h[l>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+48>>2]=o,h[l+16>>2]=i,h[l+20>>2]=r}else{if(!Ar(1,t+48|0,l))break e;o=h[t+48>>2]}if(o>>>0>n>>>0)break e;if(h[e+28>>2]=h[e+24>>2],vr(l=mi(88)),r=h[e+8>>2],h[e+8>>2]=l,r&&(Lr(r),!h[e+8>>2]))break e;if(h[e+164>>2]=h[e+160>>2],kr(e+160|0,c),h[e+176>>2]=h[e+172>>2],kr(e+172|0,c),h[e- -64>>2]=0,h[e+92>>2]=-1,h[e+84>>2]=-1,h[e+88>>2]=-1,h[e+40>>2]=h[e+36>>2],h[e+52>>2]=h[e+48>>2],h[e+76>>2]=h[e+72>>2],Dr(F=e+216|0),pe(F,m),!jt(h[e+8>>2],c,h[e+156>>2]+o|0))break e;if(r=h[e+156>>2],s[0|t]=1,Rt(e+120|0,r+o|0,t),r=h[e+4>>2],(c=65535&((c=f[r+36>>1])<<8|c>>>8))>>>0<=513){if(l=h[r+32>>2],c>>>0<=511){if(c=h[l+20>>2],a=r=(i=h[l+16>>2])+4|0,r=c=r>>>0<4?c+1|0:c,g=h[l+12>>2],a>>>0>p[l+8>>2]&(0|r)>=(0|g)|(0|r)>(0|g))break e;c=i+h[l>>2]|0,c=d[0|c]|d[c+1|0]<<8|d[c+2|0]<<16|d[c+3|0]<<24,h[l+16>>2]=a,h[l+20>>2]=r}else{if(!Ar(1,t+44|0,l))break e;c=h[t+44>>2]}if(!c)break e;if(r=h[h[e+4>>2]+32>>2],(a=(l=h[r+8>>2])-(i=h[r+16>>2])|0)>>>0<c>>>0&(0|(r=h[r+12>>2]-(h[r+20>>2]+(i>>>0>l>>>0)|0)|0))<=0|(0|r)<0)break e;if(u[t+38>>1]=0,h[t>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,h[t+16>>2]=0,h[t+20>>2]=0,h[t+24>>2]=0,h[t+28>>2]=0,s[t+29|0]=0,s[t+30|0]=0,s[t+31|0]=0,s[t+32|0]=0,s[t+33|0]=0,s[t+34|0]=0,s[t+35|0]=0,s[t+36|0]=0,l=h[h[e+4>>2]+32>>2],i=((r=h[l+16>>2])+h[l>>2]|0)+c|0,r=((a=h[l+8>>2])-r|0)-c|0,u[t+38>>1]=f[l+38>>1],h[t>>2]=i,h[t+16>>2]=0,h[t+20>>2]=0,h[t+8>>2]=r,h[t+12>>2]=0,-1==(0|(P=ee(e,t))))break e;j=P>>31}else if(P=-1,j=-1,-1==(0|ee(e,h[r+32>>2])))break e;dr(a=e+232|0,e),h[e+372>>2]=m,h[e+384>>2]=h[e+156>>2]+o,u[t+38>>1]=0,h[t>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,h[t+16>>2]=0,h[t+20>>2]=0,h[t+24>>2]=0,h[t+28>>2]=0,s[t+29|0]=0,s[t+30|0]=0,s[t+31|0]=0,s[t+32|0]=0,s[t+33|0]=0,s[t+34|0]=0,s[t+35|0]=0,s[t+36|0]=0,c=0,N=m=N-16|0;r:{i:{if(r=h[a+144>>2],(65535&((r=f[36+(0|Cn[h[h[r>>2]+32>>2]](r))>>1])<<8|r>>>8))>>>0<=513){if(r=h[a+4>>2],h[a+40>>2]=h[a>>2],h[a+44>>2]=r,r=h[a+36>>2],h[a+72>>2]=h[a+32>>2],h[a+76>>2]=r,o=h[a+28>>2],h[(r=a- -64|0)>>2]=h[a+24>>2],h[r+4>>2]=o,r=h[a+20>>2],h[a+56>>2]=h[a+16>>2],h[a+60>>2]=r,r=h[a+12>>2],h[a+48>>2]=h[a+8>>2],h[a+52>>2]=r,!Dt(a+40|0,1,m+8|0))break i;if(r=h[a+44>>2],h[a>>2]=h[a+40>>2],h[a+4>>2]=r,r=h[a+76>>2],h[a+32>>2]=h[a+72>>2],h[a+36>>2]=r,r=h[a+68>>2],h[a+24>>2]=h[a+64>>2],h[a+28>>2]=r,l=o=h[a+60>>2],r=h[a+56>>2],h[a+16>>2]=r,h[a+20>>2]=o,i=h[a+52>>2],o=h[a+48>>2],h[a+8>>2]=o,h[a+12>>2]=i,g=o-r|0,(0|(b=h[m+12>>2]))==(0|(o=i-((r>>>0>o>>>0)+l|0)|0))&g>>>0<(i=h[m+8>>2])>>>0|o>>>0<b>>>0)break i;o=r,i=r+i|0,r=l+b|0,h[a+16>>2]=i,h[a+20>>2]=i>>>0<o>>>0?r+1|0:r}if(f[a+38>>1]<=513){if(r=h[a+4>>2],h[a+96>>2]=h[a>>2],h[a+100>>2]=r,r=h[a+36>>2],h[a+128>>2]=h[a+32>>2],h[a+132>>2]=r,r=h[a+28>>2],h[a+120>>2]=h[a+24>>2],h[a+124>>2]=r,r=h[a+20>>2],h[a+112>>2]=h[a+16>>2],h[a+116>>2]=r,r=h[a+12>>2],h[a+104>>2]=h[a+8>>2],h[a+108>>2]=r,!Dt(a+96|0,1,m+8|0))break i;if(r=h[a+100>>2],h[a>>2]=h[a+96>>2],h[a+4>>2]=r,r=h[a+132>>2],h[a+32>>2]=h[a+128>>2],h[a+36>>2]=r,r=h[a+124>>2],h[a+24>>2]=h[a+120>>2],h[a+28>>2]=r,l=o=h[a+116>>2],r=h[a+112>>2],h[a+16>>2]=r,h[a+20>>2]=o,i=h[a+108>>2],o=h[a+104>>2],h[a+8>>2]=o,h[a+12>>2]=i,g=o-r|0,(0|(b=h[m+12>>2]))==(0|(o=i-((r>>>0>o>>>0)+l|0)|0))&g>>>0<(i=h[m+8>>2])>>>0|o>>>0<b>>>0)break i;o=l+b|0,o=(i=r+i|0)>>>0<r>>>0?o+1|0:o,h[a+16>>2]=i,h[a+20>>2]=o}else if(!ze(a+80|0,a))break r;if(!Pt(a))break r;if(r=h[a+4>>2],h[t>>2]=h[a>>2],h[t+4>>2]=r,r=h[a+36>>2],h[t+32>>2]=h[a+32>>2],h[t+36>>2]=r,r=h[a+28>>2],h[t+24>>2]=h[a+24>>2],h[t+28>>2]=r,r=h[a+20>>2],h[t+16>>2]=h[a+16>>2],h[t+20>>2]=r,r=h[a+12>>2],h[t+8>>2]=h[a+8>>2],h[t+12>>2]=r,r=h[a+144>>2],(65535&((r=f[36+(0|Cn[h[h[r>>2]+32>>2]](r))>>1])<<8|r>>>8))>>>0<=513){if(r=h[a+144>>2],d[36+(0|Cn[h[h[r>>2]+32>>2]](r))|0]<=1){if(r=h[t+20>>2],r=(l=(o=h[t+16>>2])+4|0)>>>0<4?r+1|0:r,(0|(i=h[t+12>>2]))<=(0|r)&l>>>0>p[t+8>>2]|(0|r)>(0|i))break r;o=o+h[t>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+16>>2]=l,h[t+20>>2]=r}else{if(!Ar(1,m+8|0,t))break r;o=h[m+8>>2]}if(o>>>0>=(r=h[a+152>>2])>>>0)break r;if((0|(o=h[t+20>>2]))>=(0|(i=h[t+12>>2]))&(l=h[t+16>>2])>>>0>=p[t+8>>2]|(0|i)<(0|o))break r;if(i=d[l+h[t>>2]|0],o=(l=l+1|0)?o:o+1|0,h[t+16>>2]=l,h[t+20>>2]=o,i)break r;h[a+176>>2]=2,h[a+180>>2]=7}else h[a+176>>2]=2,h[a+180>>2]=7,r=h[a+152>>2];if((0|r)<0)break r;if(h[m+8>>2]=0,c=2,i=h[a+156>>2],(l=h[a+160>>2]-i>>2)>>>0<r>>>0?($e(a+156|0,r-l|0,m+8|0),c=h[a+176>>2],o=h[a+180>>2]):(o=7,r>>>0>=l>>>0||(h[a+160>>2]=i+(r<<2))),l=a+184|0,(o=1+(o-c|0)|0)>>>0>(c=((r=h[a+188>>2])-(i=h[a+184>>2])|0)/12|0)>>>0){if((o=o-c|0)>>>0<=((g=h[l+8>>2])-(r=h[l+4>>2])|0)/12>>>0)o&&(r=St(c=r,0,r=v((v(o,12)-12>>>0)/12|0,12)+12|0)+r|0),h[l+4>>2]=r;else{n:{s:{o:{if((i=(b=(r-(c=h[l>>2])|0)/12|0)+o|0)>>>0<357913942){if(_=(g=(g-c|0)/12|0)<<1,g=g>>>0<178956970?i>>>0>_>>>0?i:_:357913941){if(g>>>0>=357913942)break o;T=mi(v(g,12))}if(b=(o=St(i=v(b,12)+T|0,0,b=v((v(o,12)-12>>>0)/12|0,12)+12|0))+b|0,g=v(g,12)+T|0,(0|r)==(0|c))break s;for(;r=r-12|0,h[(i=i-12|0)>>2]=h[r>>2],h[i+4>>2]=h[r+4>>2],h[i+8>>2]=h[r+8>>2],h[r+8>>2]=0,h[r>>2]=0,h[r+4>>2]=0,(0|r)!=(0|c););if(h[l+8>>2]=g,o=h[l+4>>2],h[l+4>>2]=b,r=h[l>>2],h[l>>2]=i,(0|r)==(0|o))break n;for(;(i=h[(c=o-12|0)>>2])&&(h[o-8>>2]=i,ve(i)),(0|(o=c))!=(0|r););break n}vn(),S()}Zr(1336),S()}h[l+8>>2]=g,h[l+4>>2]=b,h[l>>2]=o}r&&ve(r)}o=h[a+188>>2]}else if(o>>>0>=c>>>0)o=r;else{if((0|(o=i+v(o,12)|0))!=(0|r))for(;(i=h[(c=r-12|0)>>2])&&(h[r-8>>2]=i,ve(i)),(0|o)!=(0|(r=c)););h[a+188>>2]=o}if(g=a+196|0,r=(o-(c=h[a+184>>2])|0)/12|0,T=h[a+196>>2],r>>>0>(i=h[a+200>>2]-T>>2)>>>0?(er(g,r-i|0),c=h[a+184>>2],o=h[a+188>>2]):r>>>0>=i>>>0||(h[a+200>>2]=T+(r<<2)),(0|o)==(0|c)){c=1;break r}for(r=0;;){if(!Ar(1,m+8|0,t))break i;if(c=h[m+8>>2],o=h[a+148>>2],c>>>0>(h[o+4>>2]-h[o>>2]>>2>>>0)/3>>>0)break i;if(c&&(o=h[l>>2],_=v(r,12),T=h[(i=o+_|0)>>2],(b=h[i+4>>2]-T>>2)>>>0<c>>>0?(er(i,c-b|0),o=h[l>>2]):c>>>0>=b>>>0||(h[i+4>>2]=T+(c<<2)),U(c,1,t,h[o+_>>2]),h[h[g>>2]+(r<<2)>>2]=c),c=1,!((r=r+1|0)>>>0<(h[a+188>>2]-h[a+184>>2]|0)/12>>>0))break}break r}c=0}N=m+16|0;r:if(c){r=0,m=0,o=0,l=0,T=0,c=0,N=E=N-96|0,h[E+72>>2]=0,h[E+64>>2]=0,h[E+68>>2]=0,h[E+48>>2]=0,h[E+52>>2]=0,h[E+40>>2]=0,h[E+44>>2]=0,h[E+56>>2]=1065353216,h[E+32>>2]=0,h[E+24>>2]=0,h[E+28>>2]=0,M=1,_=e,G=h[e+124>>2];i:{n:{s:{o:{b=n;a:{l:if(!((0|n)<=0)){for(A=_+232|0,z=h[_+216>>2]!=h[_+220>>2];;){T=(e=T)+1|0;c:if(-1==(0|(n=h[A+172>>2]))){if(i=7,n=h[A+144>>2],!((65535&((n=f[36+(0|Cn[h[h[n>>2]+32>>2]](n))>>1])<<8|n>>>8))>>>0>513)){if(!d[A+76|0]){h[A+168>>2]=1,i=1;break c}i=0,(n=(y=h[A- -64>>2])+((g=h[A+72>>2])>>>3|0)|0)>>>0>=(x=h[A+68>>2])>>>0||(w=d[0|n],n=g+1|0,h[A+72>>2]=n,w>>>(7&g)&1&&((i=y+(w=n>>>3|0)|0)>>>0>=x>>>0?(i=n,n=0):(I=d[0|i],i=g+2|0,h[A+72>>2]=i,w=i>>>3|0,n=I>>>(7&n)&1),(g=y+w|0)>>>0<x>>>0?(g=d[0|g],h[A+72>>2]=i+1,i=g>>>(7&i)<<1&2):i=0,i=(n|i)<<1|1))}h[A+168>>2]=i}else{if(i=h[A+196>>2]+(n<<2)|0,n=(g=h[i>>2])-1|0,h[i>>2]=n,i=9,(0|g)<=0)break c;i=h[12176+(h[h[h[A+184>>2]+v(h[A+172>>2],12)>>2]+(n<<2)>>2]<<2)>>2],h[A+168>>2]=i}c:{if(i){g=-1;u:{h:{d:{f:{p:{m:{g:{v:{_:{b:switch(i-1|0){case 2:case 4:if((0|r)==(0|l))break a;if(n=h[_+8>>2],m=h[n+12>>2],O=(w=(y=v(e,3))+((I=5==(0|i))?2:1)|0)<<2,i=h[(V=r-4|0)>>2],h[m+O>>2]=i,h[m+(i<<2)>>2]=w,or(n+24|0),m=h[_+8>>2],x=h[m+24>>2],h[m+28>>2]-x>>2>(0|G))break a;if(B=(m=h[m>>2])+O|0,O=((n=h[n+28>>2]-h[n+24>>2]|0)>>2)-1|0,h[B>>2]=O,n&&(h[x+(O<<2)>>2]=w),w=I?y:y+2|0,B=m+(y+I<<2)|0,-1!=(0|i)){y:{E:{if((i>>>0)%3|0)n=i-1|0;else if(-1==(0|(n=i+2|0)))break E;if(n=h[m+(n<<2)>>2],h[m+(w<<2)>>2]=n,-1==(0|n))break y;h[x+(n<<2)>>2]=w;break y}h[m+(w<<2)>>2]=-1}n=-1,-1!=(0|(i=((w=i+1|0)>>>0)%3|0?w:i-2|0))&&(n=h[m+(i<<2)>>2])}else h[m+(w<<2)>>2]=-1,n=-1;h[B>>2]=n,h[V>>2]=y;break _;case 0:if((0|r)==(0|m))break a;w=h[(o=r-4|0)>>2],h[E+68>>2]=o;y:if((x=h[E+44>>2])&&(i=h[E+40>>2],n=e&x+2147483647,(I=Ii(x)>>>0>1)&&(n=e,e>>>0<x>>>0||(n=(e>>>0)%(x>>>0)|0)),(n=h[i+((y=n)<<2)>>2])&&(n=h[n>>2]))){E:{if(!I){for(i=x-1|0;;){w:{if((0|(x=h[n+4>>2]))!=(0|e)){if((0|y)==(i&x))break w;break y}if((0|e)==h[n+8>>2])break E}if(!(n=h[n>>2]))break}break y}for(;;){w:{if((0|(i=h[n+4>>2]))!=(0|e)){if(i>>>0>=x>>>0&&(i=(i>>>0)%(x>>>0)|0),(0|i)==(0|y))break w;break y}if((0|e)==h[n+8>>2])break E}if(!(n=h[n>>2]))break}break y}if((0|o)==(0|L)){if((o=1+(i=(r=L-m|0)>>2)|0)>>>0>=1073741824)break m;if(l=r>>1,o=r>>>0<2147483644?o>>>0>l>>>0?o:l:1073741823){if(o>>>0>=1073741824)break n;l=mi(o<<2)}else l=0;h[(i=l+(i<<2)|0)>>2]=h[n+12>>2],L=(o<<2)+l|0,o=i+4|0,(0|r)>0&&He(l,m,r),h[E+72>>2]=L,h[E+68>>2]=o,h[E+64>>2]=l,m&&ve(m)}else h[o>>2]=h[n+12>>2],h[E+68>>2]=r,o=r}if((0|o)==(0|l))break g;if(n=-1==(0|(i=h[(I=o-4|0)>>2])),y=h[_+8>>2],!n&-1!=h[h[y+12>>2]+(i<<2)>>2])break g;if(x=h[y+12>>2],-1!=(0|w)&-1!=h[x+(w<<2)>>2])break g;if(M=(r=v(e,3))+2|0,h[x+(i<<2)>>2]=M,h[(e=M<<2)+x>>2]=i,m=r+1|0,h[x+(w<<2)>>2]=m,h[(O=m<<2)+x>>2]=w,n)break p;if((i>>>0)%3|0){g=i-1|0;break d}if(-1!=(0|(g=i+2|0)))break d;m=h[y>>2],n=-1;break h;case 6:break b;default:break a}if(or((i=h[_+8>>2])+24|0),n=h[_+8>>2],o=v(e,3),I=(y=(w=h[i+28>>2]-h[i+24>>2]|0)>>2)-1|0,h[h[n>>2]+(o<<2)>>2]=I,or(n+24|0),x=o+1|0,h[h[n>>2]+(x<<2)>>2]=(h[n+28>>2]-h[n+24>>2]>>2)-1,or((n=h[_+8>>2])+24|0),O=o+2|0,h[h[n>>2]+(O<<2)>>2]=(h[n+28>>2]-h[n+24>>2]>>2)-1,n=h[_+8>>2],i=h[n+24>>2],h[n+28>>2]-i>>2>(0|G))break a;b:{if(w){if(h[i+(I<<2)>>2]=o,n=0,-4!=(0|w)&&(h[i+(y<<2)>>2]=x,-1==(0|(n=y+1|0))))break b}else h[i+(y<<2)>>2]=x,n=1;h[i+(n<<2)>>2]=O}if((0|r)!=(0|L)){h[r>>2]=o,o=r+4|0,h[E+68>>2]=o,r=o;break v}if((l=1+(i=(r=r-m|0)>>2)|0)>>>0>=1073741824)break f;if(n=r>>1,n=r>>>0<2147483644?n>>>0<l>>>0?l:n:1073741823){if(n>>>0>=1073741824)break n;l=mi(n<<2)}else l=0;h[(i=l+(i<<2)|0)>>2]=o,L=(n<<2)+l|0,o=i+4|0,(0|r)>0&&He(l,m,r),h[E+72>>2]=L,h[E+68>>2]=o,h[E+64>>2]=l,m&&ve(m),r=o}m=l}if(Fe(A,h[r-4>>2]),(0|(n=h[_+40>>2]))==h[_+36>>2])break c;for(i=b+(-1^e)|0,y=o-4|0;;){if((e=h[n-8>>2])>>>0>i>>>0)break g;if((0|e)!=(0|i))break c;if(w=d[n-4|0],r=h[(e=n-12|0)>>2],h[_+40>>2]=e,(0|r)<0)break g;e=h[y>>2],h[E+20>>2]=b+(-1^r),r=E+20|0,h[E+88>>2]=r,_e(E,E+40|0,r,E+88|0),n=h[E>>2];v:if(1&w){if(r=-1,-1==(0|e))break v;r=((r=e+1|0)>>>0)%3|0?r:e-2|0}else r=-1,-1!=(0|e)&&(r=e-1|0,(e>>>0)%3|0||(r=e+2|0));if(h[n+12>>2]=r,r=o,(0|(n=h[_+40>>2]))==h[_+36>>2])break}break c}if(1&M)break a;break l}vn(),S()}n=-1,m=h[y>>2],h[m+(r<<2)>>2]=-1,g=-1;break u}vn(),S()}m=h[y>>2],n=h[m+(g<<2)>>2]}h[(r<<2)+m>>2]=n,g=-1,-1!=(0|(i=((V=i+1|0)>>>0)%3|0?V:i-2|0))&&(g=h[(i<<2)+m>>2])}if(h[m+O>>2]=g,-1!=(0|w)){u:{h:{if((w>>>0)%3|0)g=w-1|0;else if(-1==(0|(g=w+2|0)))break h;if(i=e+m|0,e=h[(g<<2)+m>>2],h[i>>2]=e,-1==(0|e))break u;h[h[y+24>>2]+(e<<2)>>2]=M;break u}h[e+m>>2]=-1}M=-1,g=-1,-1!=(0|(e=((e=w+1|0)>>>0)%3|0?e:w-2|0))&&(M=h[(e<<2)+m>>2],g=e)}else h[e+m>>2]=-1,M=-1,g=-1;w=(e=h[_+388>>2])+(i=n<<2)|0,B=e,e=M<<2,h[w>>2]=h[w>>2]+h[B+e>>2],e=(y=h[y+24>>2])+e|0,-1!=(0|n)&&(h[i+y>>2]=h[e>>2]);u:if(-1!=(0|g))for(;;){if(h[(g<<2)+m>>2]=n,-1==(0|(i=((i=g+1|0)>>>0)%3|0?i:g-2|0)))break u;if(-1==(0|(i=h[x+(i<<2)>>2])))break u;if(-1==(0|(g=((g=i+1|0)>>>0)%3|0?g:i-2|0)))break}h[e>>2]=-1;u:if(!z){if((0|k)==(0|D)){h:{if((c=1+(i=(e=D-C|0)>>2)|0)>>>0<1073741824){if(n=e>>1,n=e>>>0<2147483644?n>>>0<c>>>0?c:n:1073741823){if(n>>>0>=1073741824)break h;c=mi(n<<2)}else c=0;h[(i=c+(i<<2)|0)>>2]=M,D=(n<<2)+c|0,k=i+4|0,(0|e)>0&&He(c,C,e),h[E+32>>2]=D,h[E+28>>2]=k,h[E+24>>2]=c,C&&ve(C),C=c;break u}vn(),S()}break n}h[k>>2]=M,k=k+4|0,h[E+28>>2]=k}h[I>>2]=r}else{if((0|o)==(0|l)){g=-1;break a}i=-1,y=h[_+8>>2],r=w=h[y+24>>2],n=-1,-1!=(0|(g=h[(x=o-4|0)>>2]))&&(n=-1,-1!=(0|(m=((m=g+1|0)>>>0)%3|0?m:g-2|0))&&(n=h[h[y>>2]+(m<<2)>>2])),-1!=(0|(r=h[r+(n<<2)>>2]))&&(i=((i=r+1|0)>>>0)%3|0?i:r-2|0),m=h[y+12>>2],e=(r=v(e,3))+1|0,h[m+(g<<2)>>2]=e,h[(I=e<<2)+m>>2]=g,M=r+2|0,h[m+(i<<2)>>2]=M,h[(O=M<<2)+m>>2]=i,m=-1,e=-1;u:if(-1!=(0|g)){if((g>>>0)%3|0)g=g-1|0;else if(e=-1,-1==(0|(g=g+2|0)))break u;e=h[h[y>>2]+(g<<2)>>2]}if(-1!=(0|i)&&-1!=(0|(i=((g=i+1|0)>>>0)%3|0?g:i-2|0))&&(m=h[h[y>>2]+(i<<2)>>2]),g=-1,(0|e)==(0|n)|(0|n)==(0|m))break a;i=h[y>>2],h[i+(r<<2)>>2]=n,h[i+I>>2]=m,h[i+O>>2]=e,-1!=(0|e)&&(h[w+(e<<2)>>2]=M),e=h[_+120>>2]+(n>>>3&536870908)|0,i=h[e>>2],W=e,H=ki(n)&i,h[W>>2]=H,h[x>>2]=r}Fe(A,r),r=o,m=l}if(M=(0|b)>(0|T),(0|b)==(0|T))break}T=b}if(g=-1,r=h[_+8>>2],!(h[r+28>>2]-h[r+24>>2]>>2>(0|G))){if((0|o)!=(0|l)){for(e=_+60|0,L=_+312|0;;){C=h[(o=o-4|0)>>2],h[E+68>>2]=o;l:{c:{u:{if(f[_+270>>1]<=513){if(!d[_+364|0])break u;if(r=h[_+360>>2],(n=h[_+352>>2]+(r>>>3|0)|0)>>>0>=p[_+356>>2])break c;n=d[0|n],h[_+360>>2]=r+1,r=n>>>(7&r)&1}else r=Br(L);if(!r)break c}if(A=h[_+8>>2],y=h[A>>2],((h[A+4>>2]-y>>2>>>0)/3|0)<=(0|T))break a;if(n=-1,i=-1,m=h[A+24>>2],r=-1,-1!=(0|C)&&(r=-1,-1!=(0|(b=((b=C+1|0)>>>0)%3|0?b:C-2|0))&&(r=h[y+(b<<2)>>2])),-1!=(0|(r=h[m+((b=r)<<2)>>2]))&&-1!=(0|(r=((M=r+1|0)>>>0)%3|0?M:r-2|0))&&(-1!=(0|(n=((n=r+1|0)>>>0)%3|0?n:r-2|0))&&(i=h[y+(n<<2)>>2]),n=r),M=-1,w=-1,r=-1,-1!=(0|(m=h[m+(i<<2)>>2]))&&(r=-1,-1!=(0|(m=((x=m+1|0)>>>0)%3|0?x:m-2|0))&&(-1!=(0|(r=((r=m+1|0)>>>0)%3|0?r:m-2|0))&&(w=h[y+(r<<2)>>2]),r=m)),A=h[A+12>>2],m=v(T,3),h[A+(G=m<<2)>>2]=C,h[A+(C<<2)>>2]=m,h[(D=(C=m+1|0)<<2)+A>>2]=n,h[A+(n<<2)>>2]=C,h[(n=(x=m+2|0)<<2)+A>>2]=r,h[A+(r<<2)>>2]=x,h[y+G>>2]=i,h[(A=y+D|0)>>2]=w,h[(y=n+y|0)>>2]=b,r=h[_+120>>2],b=h[(i=r+((n=m>>>0>C>>>0?-1:i)>>>3&536870908)|0)>>2],W=i,H=ki(n)&b,h[W>>2]=H,M=-1!=(0|C)?h[A>>2]:M,i=h[(n=r+(M>>>3&536870908)|0)>>2],W=n,H=ki(M)&i,h[W>>2]=H,n=-1,n=-1!=(0|x)?h[y>>2]:n,i=h[(r=r+(n>>>3&536870908)|0)>>2],W=r,H=ki(n)&i,h[W>>2]=H,(0|(n=h[_+64>>2]))==(r=h[_+68>>2])<<5){if((n+1|0)<0)break o;Se(e,r=n>>>0<=1073741822?(r<<=6)>>>0<(n=n+32&-32)>>>0?n:r:2147483647),n=h[_+64>>2]}if(T=T+1|0,h[_+64>>2]=n+1,r=h[_+60>>2]+(n>>>3&536870908)|0,h[r>>2]=h[r>>2]|1<<n,(0|(r=h[_+76>>2]))!=h[_+80>>2]){h[r>>2]=m,h[_+76>>2]=r+4;break l}if((r=1+(C=(n=r-(i=h[_+72>>2])|0)>>2)|0)>>>0>=1073741824)break s;if(b=n>>1,b=n>>>0<2147483644?r>>>0>b>>>0?r:b:1073741823){if(b>>>0>=1073741824)break n;r=mi(b<<2)}else r=0;if(h[(C=r+(C<<2)|0)>>2]=m,(0|n)>0&&He(r,i,n),h[_+80>>2]=r+(b<<2),h[_+76>>2]=C+4,h[_+72>>2]=r,!i)break l;ve(i);break l}if((0|(r=h[_+64>>2]))==(n=h[_+68>>2])<<5){if((r+1|0)<0)break o;Se(e,r=r>>>0<=1073741822?(r=r+32&-32)>>>0>(n<<=6)>>>0?r:n:2147483647),r=h[_+64>>2]}if(h[_+64>>2]=r+1,n=h[_+60>>2]+(r>>>3&536870908)|0,i=h[n>>2],W=n,H=ki(r)&i,h[W>>2]=H,(0|(r=h[_+76>>2]))==h[_+80>>2]){if((r=1+(b=(n=r-(i=h[_+72>>2])|0)>>2)|0)>>>0>=1073741824)break s;if(m=n>>1,m=n>>>0<2147483644?r>>>0>m>>>0?r:m:1073741823){if(m>>>0>=1073741824)break n;r=mi(m<<2)}else r=0;h[(b=r+(b<<2)|0)>>2]=C,(0|n)>0&&He(r,i,n),h[_+80>>2]=r+(m<<2),h[_+76>>2]=b+4,h[_+72>>2]=r,i&&ve(i)}else h[r>>2]=C,h[_+76>>2]=r+4}if((0|o)==(0|l))break}r=h[_+8>>2]}if(((h[r+4>>2]-h[r>>2]>>2>>>0)/3|0)==(0|T))if(n=h[r+24>>2],g=h[r+28>>2]-n>>2,(0|c)!=(0|k))for(i=c;;){if(e=h[i>>2],-1==h[(m=((o=g-1|0)<<2)+n|0)>>2])for(;o=g-2|0,g=g-1|0,-1==h[(m=(o<<2)+n|0)>>2];);if(e>>>0<=o>>>0){if(h[E>>2]=r,n=h[m>>2],s[E+12|0]=1,h[E+8>>2]=n,h[E+4>>2]=n,-1!=(0|n))for(;h[h[r>>2]+(n<<2)>>2]=e,bt(E),r=h[_+8>>2],-1!=(0|(n=h[E+8>>2])););m=(n=h[r+24>>2])+(o<<2)|0,-1!=(0|e)&&(h[(e<<2)+n>>2]=h[m>>2]),h[m>>2]=-1,m=1<<e,e=(T=h[_+120>>2])+(e>>>3&536870908)|0,T=T+(o>>>3&536870908)|0,o=1<<o,h[T>>2]&o?m|=h[e>>2]:m=h[e>>2]&(-1^m),h[e>>2]=m,h[T>>2]=h[T>>2]&(-1^o),g=g-1|0}if((0|k)==(0|(i=i+4|0)))break}else c=k}}if(c&&ve(c),e=h[E+48>>2])for(;r=h[e>>2],ve(e),e=r,r;);e=h[E+40>>2],h[E+40>>2]=0,e&&ve(e),l&&(h[E+68>>2]=l,ve(l)),N=E+96|0;break i}pn(),S()}vn(),S()}Zr(1336),S()}if(-1!=(0|g)){r=(e=h[t+16>>2])+h[t>>2]|0,o=(o=h[t+8>>2])-e|0,e=h[h[_+4>>2]+32>>2],u[e+38>>1]=f[e+38>>1],h[e>>2]=r,h[e+16>>2]=0,h[e+20>>2]=0,h[e+8>>2]=o,h[e+12>>2]=0,e=h[_+4>>2],(65535&(c=(r=f[e+36>>1])<<8|r>>>8))>>>0<=513&&(e=h[e+32>>2],o=j+h[e+20>>2]|0,o=(r=P+h[e+16>>2]|0)>>>0<P>>>0?o+1|0:o,h[e+16>>2]=r,h[e+20>>2]=o);i:if(h[_+216>>2]!=h[_+220>>2]){if(r=h[_+8>>2],e=h[r>>2],r=h[r+4>>2],!((65535&c)>>>0>=513)){if((0|e)==(0|r))break i;for(r=0;;){if(Pe(_,r)){if(r=r+3|0,e=h[_+8>>2],r>>>0<h[e+4>>2]-h[e>>2]>>2>>>0)continue;break i}break}break r}if((0|e)!=(0|r)){for(r=0;;){if(Oe(_,r)){if(r=r+3|0,e=h[_+8>>2],r>>>0<h[e+4>>2]-h[e>>2]>>2>>>0)continue;break i}break}break r}}if(cr(a),(0|(r=h[_+216>>2]))!=h[_+220>>2])for(c=0;;){if(lt(4+((e=v(c,144))+r|0)|0,h[_+8>>2]),R=h[F>>2],(0|(r=h[132+(o=e+R|0)>>2]))!=(0|(o=h[o+136>>2])))for(;dt(4+(e+R|0)|0,h[r>>2]),R=h[F>>2],(0|o)!=(0|(r=r+4|0)););if(be(4+(e+R|0)|0),c=c+1|0,r=h[_+216>>2],!(c>>>0<(h[_+220>>2]-r|0)/144>>>0))break}if(e=h[_+8>>2],ar(_+184|0,h[e+28>>2]-h[e+24>>2]>>2),(0|(R=h[_+216>>2]))!=h[_+220>>2])for(r=0;e=v(r,144)+R|0,o=h[e+60>>2]-h[e+56>>2]>>2,c=e+104|0,e=h[_+8>>2],ar(c,(0|(e=h[e+28>>2]-h[e+24>>2]>>2))>(0|o)?e:o),r=r+1|0,R=h[_+216>>2],r>>>0<(h[_+220>>2]-R|0)/144>>>0;);R=ne(_,g)}}break e}R=0}return N=t- -64|0,0|R},hn,Zi,Ji,ci,function(e){var t=0;h[(e|=0)>>2]=11900,(t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),h[e>>2]=12152,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),ve(e)},pr,function(e){var t=0;return h[(e|=0)>>2]=12152,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),0|e},function(e){var t=0;h[(e|=0)>>2]=12152,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),ve(e)},function(e){var t=0;return h[8+(e|=0)>>2]=12416,h[e>>2]=12204,(t=h[e+96>>2])&&(h[e+100>>2]=t,ve(t)),(t=h[e+80>>2])&&(h[e+84>>2]=t,ve(t)),(t=h[e+68>>2])&&(h[e+72>>2]=t,ve(t)),(t=h[e+56>>2])&&(h[e+60>>2]=t,ve(t)),h[e+8>>2]=12652,(t=h[e+44>>2])&&ve(t),(t=h[e+32>>2])&&ve(t),0|e},function(e){var t=0;h[8+(e|=0)>>2]=12416,h[e>>2]=12204,(t=h[e+96>>2])&&(h[e+100>>2]=t,ve(t)),(t=h[e+80>>2])&&(h[e+84>>2]=t,ve(t)),(t=h[e+68>>2])&&(h[e+72>>2]=t,ve(t)),(t=h[e+56>>2])&&(h[e+60>>2]=t,ve(t)),h[e+8>>2]=12652,(t=h[e+44>>2])&&ve(t),(t=h[e+32>>2])&&ve(t),ve(e)},function(e,t){t|=0;var r,i,n,o=0,a=0,l=0,c=0,u=0,d=0,f=0,p=0;if(i=h[12+(e|=0)>>2],o=h[e+108>>2],l=h[o+80>>2],s[t+84|0]=0,c=h[t+68>>2],(a=h[t+72>>2]-c>>2)>>>0<l>>>0?($e(t+68|0,l-a|0,12404),o=h[e+108>>2],l=h[o+80>>2]):l>>>0>=a>>>0||(h[t+72>>2]=c+(l<<2)),r=h[o+96>>2],!(o=h[o+100>>2]-r|0))return 1;n=(o=(0|o)/12|0)>>>0>1?o:1,o=0;e:{for(;;){if(1431655765==(0|o))break e;if(a=h[i>>2]+(v(o,3)<<2)|0,-1==(0|(d=h[a>>2])))break e;if(c=v(o,12)+r|0,(u=h[c>>2])>>>0>=l>>>0)break e;if(p=h[h[e+112>>2]+12>>2],(f=h[p+(d<<2)>>2])>>>0>=l>>>0)break e;if(d=h[t+68>>2],h[d+(u<<2)>>2]=f,-1==(0|(u=h[a+4>>2])))break e;if((f=h[c+4>>2])>>>0>=l>>>0)break e;if((u=h[(u<<2)+p>>2])>>>0>=l>>>0)break e;if(h[d+(f<<2)>>2]=u,-1==(0|(a=h[a+8>>2])))break e;if((c=h[c+8>>2])>>>0>=l>>>0)break e;if((a=h[(a<<2)+p>>2])>>>0>=l>>>0)break e;if(h[d+(c<<2)>>2]=a,(0|n)==(0|(o=o+1|0)))break}return 1}return 0},function(e){var t,r=0,i=0,n=0,s=0,o=0,a=0;N=t=N-16|0,r=h[4+(e|=0)>>2],n=h[r>>2];e:{if(i=h[e+12>>2],!((s=(i=h[i+28>>2]-h[i+24>>2]|0)>>2)>>>0<=h[r+8>>2]-n>>2>>>0)){if((0|i)<0)break e;o=h[r+4>>2],a=(i=mi(i))+(s<<2)|0,o=(s=o-n|0)+i|0,(0|s)>0&&He(i,n,s),h[r+8>>2]=a,h[r+4>>2]=o,h[r>>2]=i,n&&ve(n)}r=h[e+12>>2],n=h[r+28>>2],r=h[r+24>>2],h[t+12>>2]=0,r=n-r>>2,s=h[(i=e+96|0)>>2],r>>>0>(n=h[e+100>>2]-s>>2)>>>0?$e(i,r-n|0,t+12|0):r>>>0>=n>>>0||(h[e+100>>2]=s+(r<<2)),s=e+8|0;t:if(r=h[e+116>>2]){if((0|(i=h[r>>2]))==h[r+4>>2]){n=1;break t}for(r=0;;){if(!(n=ie(s,h[(r<<2)+i>>2])))break t;if(o=h[e+116>>2],i=h[o>>2],!((r=r+1|0)>>>0<h[o+4>>2]-i>>2>>>0))break}}else if(n=1,e=h[e+12>>2],!((e=h[e+4>>2]-h[e>>2]|0)>>>0<12))for(e=(e>>2>>>0)/3|0,r=0;;){if(!(n=ie(s,v(r,3))))break t;if((0|e)==(0|(r=r+1|0)))break}return N=t+16|0,0|n}Zr(1336),S()},function(e){var t=0;return h[(e|=0)>>2]=12416,(t=h[e+88>>2])&&(h[e+92>>2]=t,ve(t)),(t=h[e+72>>2])&&(h[e+76>>2]=t,ve(t)),(t=h[e+60>>2])&&(h[e- -64>>2]=t,ve(t)),(t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),h[e>>2]=12652,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),0|e},function(e){var t=0;h[(e|=0)>>2]=12416,(t=h[e+88>>2])&&(h[e+92>>2]=t,ve(t)),(t=h[e+72>>2])&&(h[e+76>>2]=t,ve(t)),(t=h[e+60>>2])&&(h[e- -64>>2]=t,ve(t)),(t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),h[e>>2]=12652,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),ve(e)},function(e,t,r){t|=0,r|=0;var i,n=0;N=i=N-16|0,h[4+(e|=0)>>2]=t,n=h[t>>2],t=h[t+4>>2],s[i+15|0]=0,Rt(e+24|0,(t-n>>2>>>0)/3|0,i+15|0),t=h[e+4>>2],n=h[t+28>>2],t=h[t+24>>2],s[i+14|0]=0,Rt(e+36|0,n-t>>2,i+14|0),t=h[r+12>>2],h[e+16>>2]=h[r+8>>2],h[e+20>>2]=t,t=h[r+4>>2],h[e+8>>2]=h[r>>2],h[e+12>>2]=t,N=i+16|0},function(e){var t=0;return h[(e|=0)>>2]=12652,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),0|e},function(e){var t=0;h[(e|=0)>>2]=12652,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),ve(e)},function(e){var t=0;return h[8+(e|=0)>>2]=12836,h[e>>2]=12672,(t=h[e+56>>2])&&(h[e+60>>2]=t,ve(t)),h[e+8>>2]=12652,(t=h[e+44>>2])&&ve(t),(t=h[e+32>>2])&&ve(t),0|e},function(e){var t=0;h[8+(e|=0)>>2]=12836,h[e>>2]=12672,(t=h[e+56>>2])&&(h[e+60>>2]=t,ve(t)),h[e+8>>2]=12652,(t=h[e+44>>2])&&ve(t),(t=h[e+32>>2])&&ve(t),ve(e)},function(e,t){t|=0;var r,i,n,o=0,a=0,l=0,c=0,u=0,d=0,f=0,p=0;if(i=h[12+(e|=0)>>2],o=h[e+68>>2],l=h[o+80>>2],s[t+84|0]=0,c=h[t+68>>2],(a=h[t+72>>2]-c>>2)>>>0<l>>>0?($e(t+68|0,l-a|0,12404),o=h[e+68>>2],l=h[o+80>>2]):l>>>0>=a>>>0||(h[t+72>>2]=c+(l<<2)),r=h[o+96>>2],!(o=h[o+100>>2]-r|0))return 1;n=(o=(0|o)/12|0)>>>0>1?o:1,o=0;e:{for(;;){if(1431655765==(0|o))break e;if(a=h[i>>2]+(v(o,3)<<2)|0,-1==(0|(d=h[a>>2])))break e;if(c=v(o,12)+r|0,(u=h[c>>2])>>>0>=l>>>0)break e;if(p=h[h[e+72>>2]+12>>2],(f=h[p+(d<<2)>>2])>>>0>=l>>>0)break e;if(d=h[t+68>>2],h[d+(u<<2)>>2]=f,-1==(0|(u=h[a+4>>2])))break e;if((f=h[c+4>>2])>>>0>=l>>>0)break e;if((u=h[(u<<2)+p>>2])>>>0>=l>>>0)break e;if(h[d+(f<<2)>>2]=u,-1==(0|(a=h[a+8>>2])))break e;if((c=h[c+8>>2])>>>0>=l>>>0)break e;if((a=h[(a<<2)+p>>2])>>>0>=l>>>0)break e;if(h[d+(c<<2)>>2]=a,(0|n)==(0|(o=o+1|0)))break}return 1}return 0},function(e){var t=0,r=0,i=0,n=0,s=0,o=0;t=h[4+(e|=0)>>2],i=h[t>>2];e:{if(r=h[e+12>>2],!((n=(r=h[r+28>>2]-h[r+24>>2]|0)>>2)>>>0<=h[t+8>>2]-i>>2>>>0)){if((0|r)<0)break e;s=h[t+4>>2],o=(r=mi(r))+(n<<2)|0,s=(n=s-i|0)+r|0,(0|n)>0&&He(r,i,n),h[t+8>>2]=o,h[t+4>>2]=s,h[t>>2]=r,i&&ve(i)}n=e+8|0;t:if(t=h[e+76>>2]){if((0|(i=h[t>>2]))==h[t+4>>2])return 1;for(t=0;;){if(!(r=xe(n,h[(t<<2)+i>>2])))break t;if(s=h[e+76>>2],i=h[s>>2],!((t=t+1|0)>>>0<h[s+4>>2]-i>>2>>>0))break}}else if(r=1,e=h[e+12>>2],!((e=h[e+4>>2]-h[e>>2]|0)>>>0<12))for(e=(e>>2>>>0)/3|0,t=0;;){if(!(r=xe(n,v(t,3))))break t;if((0|e)==(0|(t=t+1|0)))break}return 0|r}Zr(1336),S()},function(e){var t=0;return h[(e|=0)>>2]=12836,(t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),h[e>>2]=12652,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),0|e},function(e){var t=0;h[(e|=0)>>2]=12836,(t=h[e+48>>2])&&(h[e+52>>2]=t,ve(t)),h[e>>2]=12652,(t=h[e+36>>2])&&ve(t),(t=h[e+24>>2])&&ve(t),ve(e)},function(e){var t=0;return h[8+(e|=0)>>2]=11900,h[e>>2]=12964,(t=h[e+56>>2])&&(h[e+60>>2]=t,ve(t)),h[e+8>>2]=12152,(t=h[e+44>>2])&&ve(t),(t=h[e+32>>2])&&ve(t),0|e},function(e){var t=0;h[8+(e|=0)>>2]=11900,h[e>>2]=12964,(t=h[e+56>>2])&&(h[e+60>>2]=t,ve(t)),h[e+8>>2]=12152,(t=h[e+44>>2])&&ve(t),(t=h[e+32>>2])&&ve(t),ve(e)},function(e,t){t|=0;var r,i,n,o=0,a=0,l=0,c=0,u=0,d=0,f=0,p=0;if(d=h[12+(e|=0)>>2],o=h[e+68>>2],l=h[o+80>>2],s[t+84|0]=0,u=h[t+68>>2],(a=h[t+72>>2]-u>>2)>>>0<l>>>0?($e(t+68|0,l-a|0,12404),o=h[e+68>>2],l=h[o+80>>2]):l>>>0>=a>>>0||(h[t+72>>2]=u+(l<<2)),r=h[o+96>>2],!(o=h[o+100>>2]-r|0))return 1;i=(o=(0|o)/12|0)>>>0>1?o:1,n=h[d+28>>2],o=0;e:{for(;;){if(a=(v(o,3)<<2)+n|0,-1==(0|(u=h[a>>2])))break e;if(d=v(o,12)+r|0,(f=h[d>>2])>>>0>=l>>>0)break e;if(c=u<<2,u=h[h[e+72>>2]+12>>2],(c=h[c+u>>2])>>>0>=l>>>0)break e;if(p=f<<2,f=h[t+68>>2],h[p+f>>2]=c,-1==(0|(c=h[a+4>>2])))break e;if((p=h[d+4>>2])>>>0>=l>>>0)break e;if((c=h[u+(c<<2)>>2])>>>0>=l>>>0)break e;if(h[f+(p<<2)>>2]=c,-1==(0|(a=h[a+8>>2])))break e;if((d=h[d+8>>2])>>>0>=l>>>0)break e;if((a=h[u+(a<<2)>>2])>>>0>=l>>>0)break e;if(h[f+(d<<2)>>2]=a,(0|i)==(0|(o=o+1|0)))break}return 1}return 0},function(e){var t=0,r=0,i=0,n=0,s=0,o=0;t=h[4+(e|=0)>>2],i=h[t>>2];e:{if(r=h[e+12>>2],!((n=(r=h[r+56>>2]-h[r+52>>2]|0)>>2)>>>0<=h[t+8>>2]-i>>2>>>0)){if((0|r)<0)break e;s=h[t+4>>2],o=(r=mi(r))+(n<<2)|0,s=(n=s-i|0)+r|0,(0|n)>0&&He(r,i,n),h[t+8>>2]=o,h[t+4>>2]=s,h[t>>2]=r,i&&ve(i)}n=e+8|0;t:if(t=h[e+76>>2]){if((0|(i=h[t>>2]))==h[t+4>>2])return 1;for(t=0;;){if(!(r=ye(n,h[(t<<2)+i>>2])))break t;if(s=h[e+76>>2],i=h[s>>2],!((t=t+1|0)>>>0<h[s+4>>2]-i>>2>>>0))break}}else if(r=1,e=h[h[e+12>>2]+64>>2],!((e=h[e+4>>2]-h[e>>2]|0)>>>0<12))for(e=(e>>2>>>0)/3|0,t=0;;){if(!(r=ye(n,v(t,3))))break t;if((0|e)==(0|(t=t+1|0)))break}return 0|r}Zr(1336),S()},Ir,Vt,function(e){var t,r=0,i=0,n=0,s=0,o=0,a=0,l=0,c=0,u=0,p=0,m=0,g=0,_=0;N=t=N-32|0,i=h[32+(e|=0)>>2];e:{if((65535&((n=f[e+36>>1])<<8|n>>>8))>>>0<=513){if(r=h[i+12>>2],s=n=h[i+20>>2],n=(o=(l=h[i+16>>2])+4|0)>>>0<4?n+1|0:n,a=o,(c=h[i+8>>2])>>>0<o>>>0&(0|r)<=(0|n)|(0|r)<(0|n))break e;if(g=h[i>>2],p=d[0|(o=g+l|0)]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[i+16>>2]=a,h[i+20>>2]=n,n=r,r=s,(s=l+8|0)>>>0>c>>>0&(0|(r=s>>>0<8?r+1|0:r))>=(0|n)|(0|r)>(0|n))break e;g=d[0|(n=a+g|0)]|d[n+1|0]<<8|d[n+2|0]<<16|d[n+3|0]<<24,h[t+24>>2]=g,h[i+16>>2]=s,h[i+20>>2]=r}else{if(!br(1,t+28|0,i))break e;if(!br(1,t+24|0,h[e+32>>2]))break e;p=h[t+28>>2],g=h[t+24>>2]}if(!(p>>>0>1431655765||(s=h[e+32>>2],n=$r(a=(r=l=h[(n=s)+8>>2])-(i=h[n+16>>2])|0,(o=h[n+12>>2])-((_=r>>>0<i>>>0)+(r=h[n+20>>2])|0)|0,3,0),!G&n>>>0<p>>>0||(n=qr(p,0,3,0),!G&n>>>0<g>>>0|(0|r)>=(0|o)&i>>>0>=l>>>0|(0|r)>(0|o))))){o=d[i+h[s>>2]|0],n=(l=i+1|0)?r:r+1|0,h[s+16>>2]=l,h[s+20>>2]=n;t:{if(o){r:if(g>>>0<=255){if(!p)break t;if(h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,(0|n)>=(0|(r=i=h[s+12>>2]))&l>>>0>=(a=h[s+8>>2])>>>0|(0|r)<(0|n))break r;for(;;){if(o=h[s>>2],u=d[o+l|0],r=n,r=(c=l+1|0)?r:r+1|0,h[s+16>>2]=c,h[s+20>>2]=r,h[t+8>>2]=u,(0|r)>=(0|i)&c>>>0>=a>>>0|(0|r)>(0|i))break r;if(u=d[o+c|0],r=n,r=(c=l+2|0)>>>0<2?r+1|0:r,h[s+16>>2]=c,h[s+20>>2]=r,h[t+12>>2]=u,(0|r)>=(0|i)&c>>>0>=a>>>0|(0|r)>(0|i))break r;if(r=d[o+c|0],n=(i=l+3|0)>>>0<3?n+1|0:n,h[s+16>>2]=i,h[s+20>>2]=n,h[t+16>>2]=r,Ht(h[e+44>>2]+96|0,t+8|0),(0|(m=m+1|0))==(0|p))break t;if(s=h[e+32>>2],l=h[(r=s)+16>>2],n=h[r+20>>2],h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,!(l>>>0<(a=h[r+8>>2])>>>0&(0|n)<=(0|(r=i=h[r+12>>2]))|(0|r)>(0|n)))break}}else if(g>>>0<=65535){if(!p)break t;if(h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,o=h[s+12>>2],a=i=i+3|0,i=r=i>>>0<3?r+1|0:r,(c=h[s+8>>2])>>>0<a>>>0&(0|r)>=(0|o)|(0|r)>(0|o))break r;for(;;){if(u=h[s>>2],r=d[0|(r=u+l|0)]|d[r+1|0]<<8,h[s+16>>2]=a,h[s+20>>2]=i,h[t+8>>2]=r,r=n,(i=l+4|0)>>>0>c>>>0&(0|(r=i>>>0<4?r+1|0:r))>=(0|o)|(0|r)>(0|o))break r;if(a=d[0|(a=a+u|0)]|d[a+1|0]<<8,h[s+16>>2]=i,h[s+20>>2]=r,h[t+12>>2]=a,r=n,(n=l+6|0)>>>0>c>>>0&(0|(r=n>>>0<6?r+1|0:r))>=(0|o)|(0|r)>(0|o))break r;if(i=d[0|(i=i+u|0)]|d[i+1|0]<<8,h[s+16>>2]=n,h[s+20>>2]=r,h[t+16>>2]=i,Ht(h[e+44>>2]+96|0,t+8|0),(0|(m=m+1|0))==(0|p))break t;if(s=h[e+32>>2],l=h[(r=s)+16>>2],n=h[r+20>>2],h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,o=h[r+12>>2],c=h[r+8>>2],r=n,a=i=l+2|0,i=r=i>>>0<2?r+1|0:r,!((0|r)<=(0|o)&c>>>0>=a>>>0|(0|r)<(0|o)))break}}else if(g>>>0>2097151||(65535&((o=f[e+36>>1])<<8|o>>>8))>>>0<514){if(!p)break t;if(h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,o=h[s+12>>2],a=i=i+5|0,i=r=i>>>0<5?r+1|0:r,!((c=h[s+8>>2])>>>0<a>>>0&(0|r)>=(0|o)|(0|r)>(0|o)))for(;;){if(u=h[s>>2],r=d[0|(r=u+l|0)]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[s+16>>2]=a,h[s+20>>2]=i,h[t+8>>2]=r,r=n,_=i=l+8|0,i>>>0>c>>>0&(0|(r=i>>>0<8?r+1|0:r))>=(0|o)|(0|r)>(0|o))break r;if(i=d[0|(i=a+u|0)]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[s+16>>2]=_,h[s+20>>2]=r,h[t+12>>2]=i,i=r=l+12|0,r>>>0>c>>>0&(0|(n=r>>>0<12?n+1|0:n))>=(0|o)|(0|n)>(0|o))break r;if(r=d[0|(r=u+_|0)]|d[r+1|0]<<8|d[r+2|0]<<16|d[r+3|0]<<24,h[s+16>>2]=i,h[s+20>>2]=n,h[t+16>>2]=r,Ht(h[e+44>>2]+96|0,t+8|0),(0|(m=m+1|0))==(0|p))break t;if(s=h[e+32>>2],l=h[(r=s)+16>>2],n=h[r+20>>2],h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,o=h[r+12>>2],c=h[r+8>>2],r=n,a=i=l+4|0,i=r=i>>>0<4?r+1|0:r,!((0|r)<=(0|o)&c>>>0>=a>>>0|(0|r)<(0|o)))break}}else{if(!p)break t;if(h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,!br(1,t+4|0,s))break r;for(;;){if(h[t+8>>2]=h[t+4>>2],!br(1,t+4|0,h[e+32>>2]))break r;if(h[t+12>>2]=h[t+4>>2],!br(1,t+4|0,h[e+32>>2]))break r;if(h[t+16>>2]=h[t+4>>2],Ht(h[e+44>>2]+96|0,t+8|0),(0|(m=m+1|0))==(0|p))break t;if(n=h[e+32>>2],h[t+16>>2]=0,h[t+8>>2]=0,h[t+12>>2]=0,!br(1,t+4|0,n))break}}m=0;break e}s=0,N=r=N-32|0,h[r+24>>2]=0,h[r+16>>2]=0,h[r+20>>2]=0;r:{i:{if(n=v(p,3)){if(n>>>0>=1073741824)break i;s=mi(i=v(p,12)),h[r+16>>2]=s,St(s,0,i)}n:{if(!(n=U(n,1,h[e+32>>2],s))|!p){if(!s)break n}else for(o=0,i=0;c=(a=h[(l=(i<<2)+s|0)>>2])>>>1|0,a=(1&a?0-c|0:c)+u|0,h[r>>2]=a,u=(c=h[l+4>>2])>>>1|0,a=a+(1&c?0-u|0:u)|0,h[r+4>>2]=a,c=(l=h[l+8>>2])>>>1|0,u=a+(1&l?0-c|0:c)|0,h[r+8>>2]=u,Ht(h[e+44>>2]+96|0,r),i=i+3|0,(0|(o=o+1|0))!=(0|p););ve(s)}N=r+32|0;break r}vn(),S()}if(!n)break e}h[h[e+4>>2]+80>>2]=g,m=1}}return N=t+32|0,0|m},sn,fn,function(e,t){return s[84+(t|=0)|0]=1,h[t+72>>2]=h[t+68>>2],1},function(e){var t=0,r=0,i=0,n=0,s=0;e:{if(!((0|(t=h[8+(e|=0)>>2]))<0||(r=h[e+4>>2],n=h[r>>2],(i=h[r+4>>2]-n>>2)>>>0<t>>>0?(er(r,t-i|0),s=h[e+8>>2]):(s=t,t>>>0>=i>>>0||(h[r+4>>2]=n+(t<<2),s=t)),(0|(i=s))<=0)))for(e=h[e+4>>2],r=h[e>>2],n=h[e+4>>2]-r>>2,e=0;;){if((0|e)==(0|n))break e;if(h[r+(e<<2)>>2]=e,(0|i)==(0|(e=e+1|0)))break}return(-1^t)>>>31|0}An(),S()},gn,dn,hn,Ir,function(e,t){e|=0,t|=0;var r,i=0,n=0,s=0,o=0,a=0;i=mi(72),h[i+4>>2]=0,h[i+8>>2]=0,h[i>>2]=2012,h[i+12>>2]=0,h[i+16>>2]=0,h[i+20>>2]=0,h[i+24>>2]=0,h[i+28>>2]=0,h[i+32>>2]=0,h[i+36>>2]=0,h[i+40>>2]=0,h[i>>2]=2156,h[i+44>>2]=0,h[i+48>>2]=0,h[i+52>>2]=0,h[i+56>>2]=0,h[i+60>>2]=0,h[i+64>>2]=0,h[i+68>>2]=0,r=i;e:{if((0|t)>=0){if(a=e+8|0,!((0|(o=(i=h[e+12>>2])-(s=h[e+8>>2])>>2))>(0|t)))if(n=t+1|0,t>>>0>=o>>>0)At(a,n-o|0);else if(!(n>>>0>=o>>>0)){if((0|(s=(n<<2)+s|0))!=(0|i))for(;n=h[(i=i-4|0)>>2],h[i>>2]=0,n&&Cn[h[h[n>>2]+4>>2]](n),(0|i)!=(0|s););h[e+12>>2]=s}if(e=h[a>>2]+(t<<2)|0,i=h[e>>2],h[e>>2]=r,!i)break e}Cn[h[h[i>>2]+4>>2]](i)}return(-1^t)>>>31|0},function(e){var t,r,i=0,n=0,s=0,o=0;return t=h[32+(e|=0)>>2],o=h[t+8>>2],s=h[t+12>>2],n=h[t+20>>2],o>>>0<(r=(o=h[t+16>>2])+4|0)>>>0&(0|(n=r>>>0<4?n+1|0:n))>=(0|s)|(0|n)>(0|s)||(i=o+h[t>>2]|0,s=d[0|i]|d[i+1|0]<<8|d[i+2|0]<<16|d[i+3|0]<<24,h[t+16>>2]=r,h[t+20>>2]=n,i=0,(0|s)<0||(h[h[e+4>>2]+80>>2]=s,i=1)),0|i},Ir,Vt,function(e){var t,r,i,n,s,o=0,a=0;return t=h[32+(e|=0)>>2],r=h[t+12>>2],o=n=h[t+8>>2],a=h[t+20>>2],(0|(a=(i=(s=h[t+16>>2])+4|0)>>>0<4?a+1|0:a))<=(0|r)&o>>>0>=i>>>0|(0|a)<(0|r)&&(o=s+h[t>>2]|0,o=d[0|o]|d[o+1|0]<<8|d[o+2|0]<<16|d[o+3|0]<<24,h[t+16>>2]=i,h[t+20>>2]=a,h[h[e+4>>2]+80>>2]=o),(0|a)<=(0|r)&i>>>0<=n>>>0|(0|a)<(0|r)},function(e){var t=0;return h[(e|=0)>>2]=13696,(t=h[e+96>>2])&&(h[e+100>>2]=t,ve(t)),(t=h[e+84>>2])&&(h[e+88>>2]=t,ve(t)),Qt(e),0|e},function(e){var t=0;h[(e|=0)>>2]=13696,(t=h[e+96>>2])&&(h[e+100>>2]=t,ve(t)),(t=h[e+84>>2])&&(h[e+88>>2]=t,ve(t)),Qt(e),ve(e)},function(e,t,r){var i=0,n=0,s=0,o=0,a=0,l=0,c=0;if(Ie(e|=0,t|=0,r|=0),r=h[e+84>>2],!((0|(i=h[e+88>>2]-r>>2))>(0|t))){if((t=t+1|0)>>>0>i>>>0){e:if((i=t-i|0)>>>0<=(n=h[e+92>>2])-(r=h[e+88>>2])>>2>>>0){if(i){if(t=r,s=7&i)for(;h[t>>2]=1,t=t+4|0,(0|s)!=(0|(o=o+1|0)););if(r=(i<<2)+r|0,!((i-1&1073741823)>>>0<7))for(;h[t+24>>2]=1,h[t+28>>2]=1,h[t+16>>2]=1,h[t+20>>2]=1,h[t+8>>2]=1,h[t+12>>2]=1,h[t>>2]=1,h[t+4>>2]=1,(0|r)!=(0|(t=t+32|0)););}h[e+88>>2]=r}else{t:{if((t=(r=(c=r-(s=h[e+84>>2])|0)>>2)+i|0)>>>0<1073741824){if(a=(n=n-s|0)>>1,n=n>>>0<2147483644?t>>>0>a>>>0?t:a:1073741823){if(n>>>0>=1073741824)break t;l=mi(n<<2)}if(t=r=(r<<2)+l|0,a=7&i)for(t=r;h[t>>2]=1,t=t+4|0,(0|a)!=(0|(o=o+1|0)););if(r=r+(i<<2)|0,(i-1&1073741823)>>>0>=7)for(;h[t+24>>2]=1,h[t+28>>2]=1,h[t+16>>2]=1,h[t+20>>2]=1,h[t+8>>2]=1,h[t+12>>2]=1,h[t>>2]=1,h[t+4>>2]=1,(0|r)!=(0|(t=t+32|0)););(0|c)>0&&He(l,s,c),h[e+92>>2]=(n<<2)+l,h[e+88>>2]=r,h[e+84>>2]=l,s&&ve(s);break e}vn(),S()}Zr(1336),S()}return}t>>>0>=i>>>0||(h[e+88>>2]=r+(t<<2))}},function(e,t){var r=0,i=0;ge(e|=0,t|=0),(0|t)<0||(r=h[e+88>>2])-(i=h[e+84>>2])>>2<=(0|t)||((r=r-(i=4+(t=i+(t<<2)|0)|0)|0)&&Et(t,i,r),h[e+88>>2]=t+r)},Qt,function(e){ve(Qt(e|=0))},Ie,ge,function(e){return 0|O(h[60+(e|=0)>>2])},function(e,t,r){t|=0,r|=0;var i,n=0,s=0,o=0,a=0,l=0,c=0;N=i=N-32|0,s=h[28+(e|=0)>>2],h[i+16>>2]=s,n=h[e+20>>2],h[i+28>>2]=r,h[i+24>>2]=t,t=n-s|0,h[i+20>>2]=t,s=t+r|0,c=2;e:{t:{t=i+16|0,(n=0|C(h[e+60>>2],0|t,2,i+12|0))?(h[4190]=n,n=-1):n=0;r:{if(!n)for(;;){if((0|(n=h[i+12>>2]))==(0|s))break r;if((0|n)<0)break t;if(o=n-((a=(o=h[t+4>>2])>>>0<n>>>0)?o:0)|0,h[(l=(a<<3)+t|0)>>2]=o+h[l>>2],h[(l=(a?12:4)+t|0)>>2]=h[l>>2]-o,s=s-n|0,t=a?t+8|0:t,c=c-a|0,(n=0|C(h[e+60>>2],0|t,0|c,i+12|0))?(h[4190]=n,n=-1):n=0,n)break}if(-1!=(0|s))break t}t=h[e+44>>2],h[e+28>>2]=t,h[e+20>>2]=t,h[e+16>>2]=t+h[e+48>>2],e=r;break e}h[e+28>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e>>2]=32|h[e>>2],e=0,2!=(0|c)&&(e=r-h[t+4>>2]|0)}return N=i+32|0,0|e},function(e,t,r,i){var n;return t|=0,r|=0,i|=0,N=n=N-16|0,(e=0|R(h[60+(e|=0)>>2],0|t,0|r,255&i,n+8|0))?(h[4190]=e,e=-1):e=0,N=n+16|0,G=e?-1:h[n+12>>2],0|(e?-1:h[n+8>>2])},dn,function(e,t,r,i){return G=0,0},sn,fn,Sn,Sn,function(e,t,r){r|=0;var i,n=0,s=0,o=0,a=0;if(N=i=N+-64|0,n=1,!Pr(e|=0,t|=0,0)&&(n=0,t)){N=n=N+-64|0,s=h[t>>2],o=h[s-4>>2],a=h[s-8>>2],h[n+20>>2]=0,h[n+16>>2]=14956,h[n+12>>2]=t,h[n+8>>2]=15004,s=0,St(n+24|0,0,39),t=t+a|0;e:if(Pr(o,15004,0))h[n+56>>2]=1,Cn[h[h[o>>2]+20>>2]](o,n+8|0,t,t,1,0),s=1==h[n+32>>2]?t:0;else{Cn[h[h[o>>2]+24>>2]](o,n+8|0,t,1,0);t:switch(h[n+44>>2]){case 0:s=1==h[n+48>>2]&&1==h[n+36>>2]&&1==h[n+40>>2]?h[n+28>>2]:0;break e;case 1:break t;default:break e}1!=h[n+32>>2]&&h[n+48>>2]|1!=h[n+36>>2]|1!=h[n+40>>2]||(s=h[n+24>>2])}N=n- -64|0,n=0,s&&(St(4|(t=i+8|0),0,52),h[i+56>>2]=1,h[i+20>>2]=-1,h[i+16>>2]=e,h[i+8>>2]=s,Cn[h[h[s>>2]+28>>2]](s,t,h[r>>2],1),1==(0|(e=h[i+32>>2]))&&(h[r>>2]=h[i+24>>2]),n=1==(0|e))}return N=i- -64|0,0|n},function(e,t,r,i,n,s){r|=0,i|=0,n|=0,s|=0,Pr(e|=0,h[8+(t|=0)>>2],s)&&fr(t,r,i,n)},function(e,t,r,i,n){if(r|=0,i|=0,n|=0,Pr(e|=0,h[8+(t|=0)>>2],n))1==h[t+28>>2]|h[t+4>>2]!=(0|r)||(h[t+28>>2]=i);else e:if(Pr(e,h[t>>2],n)){if(!(h[t+16>>2]!=(0|r)&h[t+20>>2]!=(0|r))){if(1!=(0|i))break e;return void(h[t+32>>2]=1)}h[t+20>>2]=r,h[t+32>>2]=i,h[t+40>>2]=h[t+40>>2]+1,1!=h[t+36>>2]|2!=h[t+24>>2]||(s[t+54|0]=1),h[t+44>>2]=4}},function(e,t,r,i){r|=0,i|=0,Pr(e|=0,h[8+(t|=0)>>2],0)&&Xr(t,r,i)},fn,function(e,t,r,i,n,s){r|=0,i|=0,n|=0,s|=0,Pr(e|=0,h[8+(t|=0)>>2],s)?fr(t,r,i,n):(e=h[e+8>>2],Cn[h[h[e>>2]+20>>2]](e,t,r,i,n,s))},function(e,t,r,i,n){if(r|=0,i|=0,n|=0,Pr(e|=0,h[8+(t|=0)>>2],n))1==h[t+28>>2]|h[t+4>>2]!=(0|r)||(h[t+28>>2]=i);else e:{if(Pr(e,h[t>>2],n)){if(!(h[t+16>>2]!=(0|r)&h[t+20>>2]!=(0|r))){if(1!=(0|i))break e;return void(h[t+32>>2]=1)}h[t+32>>2]=i;t:if(4!=h[t+44>>2]){if(u[t+52>>1]=0,e=h[e+8>>2],Cn[h[h[e>>2]+20>>2]](e,t,r,r,1,n),d[t+53|0]){if(h[t+44>>2]=3,!d[t+52|0])break t;break e}h[t+44>>2]=4}if(h[t+20>>2]=r,h[t+40>>2]=h[t+40>>2]+1,1!=h[t+36>>2]|2!=h[t+24>>2])break e;return void(s[t+54|0]=1)}e=h[e+8>>2],Cn[h[h[e>>2]+24>>2]](e,t,r,i,n)}},function(e,t,r,i){r|=0,i|=0,Pr(e|=0,h[8+(t|=0)>>2],0)?Xr(t,r,i):(e=h[e+8>>2],Cn[h[h[e>>2]+28>>2]](e,t,r,i))},sn,fn,function(e){return 1283},function(e){ve(_i(e|=0))},Zi,function(e){_i(e|=0),ve(e)}]).set=function(e,t){this[e]=t},Mn.get=function(e){return this[e]},Mn);function Rn(){return i.byteLength/65536|0}return{j:function(){h[4227]=16796,h[4209]=42},k:Cn,l:nn,m:function(){var e;return e=mi(40),u[e+38>>1]=0,h[e>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,s[e+29|0]=0,s[e+30|0]=0,s[e+31|0]=0,s[e+32|0]=0,s[e+33|0]=0,s[e+34|0]=0,s[e+35|0]=0,s[e+36|0]=0,0|e},n:function(e,t,r){t|=0,r|=0,h[16+(e|=0)>>2]=0,h[e+20>>2]=0,h[e>>2]=t,h[e+8>>2]=r,h[e+12>>2]=0},o:nn,p:function(){var e,t;return t=mi(40),h[t>>2]=-1,h[16+(e=t+8|0)>>2]=0,h[e+20>>2]=0,h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,0|t},q:tn,r:function(e){var t=0;(e|=0)&&((t=h[e+8>>2])&&(h[e+12>>2]=t,ve(t)),ve(e))},s:function(){return 0|ti(mi(64))},t:nn,u:function(){var e;return ti(e=mi(96)),h[e+64>>2]=0,h[e+68>>2]=0,h[e+88>>2]=0,h[e+72>>2]=0,h[e+76>>2]=0,s[e+77|0]=0,s[e+78|0]=0,s[e+79|0]=0,s[e+80|0]=0,s[e+81|0]=0,s[e+82|0]=0,s[e+83|0]=0,s[e+84|0]=0,0|e},v:qi,w:function(e){return h[88+(e|=0)>>2]},x:function(e){return h[56+(e|=0)>>2]},y:Yi,z:function(e){return s[24+(e|=0)|0]},A:function(e){return d[32+(e|=0)|0]},B:function(e){return h[40+(e|=0)>>2]},C:function(e){return h[48+(e|=0)>>2]},D:function(e){return h[60+(e|=0)>>2]},E:Wr,F:function(){var e;return e=mi(24),h[e+8>>2]=0,h[e+12>>2]=0,h[e+4>>2]=-1,h[e>>2]=1140,h[e+16>>2]=0,h[e+20>>2]=0,0|e},G:Ni,H:Zi,I:function(e,t){return t|=0,_(m[h[8+(e|=0)>>2]+(t<<2)>>2])},J:function(e){return _(m[20+(e|=0)>>2])},K:Bi,L:function(){var e;return e=mi(8),h[e+4>>2]=-1,h[e>>2]=1032,0|e},M:Ni,N:Zi,O:Bi,P:function(){return 0|Di(mi(84))},Q:Vi,R:qi,S:Bi,T:function(){var e;return Di(e=mi(108)),h[e+84>>2]=0,h[e+88>>2]=0,h[e>>2]=13696,h[e+92>>2]=0,h[e+96>>2]=0,h[e+100>>2]=0,h[e+104>>2]=0,0|e},U:function(e){return(h[100+(e|=0)>>2]-h[e+96>>2]|0)/12|0},V:Vi,W:qi,X:Bi,Y:function(){var e,t;return e=mi(24),h[e+4>>2]=0,h[e+8>>2]=0,h[(t=e+16|0)>>2]=0,h[t+4>>2]=0,h[e>>2]=e+4,h[e+12>>2]=t,0|e},Z:function(e){(e|=0)&&(ni(e+12|0,h[e+16>>2]),fi(e,h[e+4>>2]),ve(e))},_:tn,$:function(e){return 0|!h[(e|=0)>>2]},aa:function(e){return 0|(s[15+(e|=0)|0]<0?h[e+4>>2]:e+4|0)},ba:function(e){(e|=0)&&(s[e+15|0]<0&&ve(h[e+4>>2]),ve(e))},ca:Oi,da:function(e,t){return t|=0,_(m[h[(e|=0)>>2]+(t<<2)>>2])},ea:zi,fa:Pi,ga:Oi,ha:function(e,t){return t|=0,s[h[(e|=0)>>2]+t|0]},ia:Wi,ja:Pi,ka:Oi,la:function(e,t){return t|=0,d[h[(e|=0)>>2]+t|0]},ma:Wi,na:Pi,oa:Oi,pa:function(e,t){return t|=0,u[h[(e|=0)>>2]+(t<<1)>>1]},qa:ji,ra:Pi,sa:Oi,ta:function(e,t){return t|=0,f[h[(e|=0)>>2]+(t<<1)>>1]},ua:ji,va:Pi,wa:Oi,xa:Gi,ya:zi,za:Pi,Aa:Oi,Ba:Gi,Ca:zi,Da:Pi,Ea:function(){var e;return e=mi(28),h[e>>2]=0,h[e+4>>2]=0,h[e+24>>2]=0,h[e+16>>2]=0,h[e+20>>2]=0,h[e+8>>2]=0,h[e+12>>2]=0,0|e},Fa:function(e,t,r){e|=0,t|=0;var i,n=0,o=0,a=0,l=0,c=0,u=0,f=0;if(N=i=N-16|0,(n=Rr(r|=0))>>>0<4294967280){e:{if(n>>>0>=11)e=mi(o=n+16&-16),h[i+8>>2]=-2147483648|o,h[i>>2]=e,h[i+4>>2]=n;else if(s[i+11|0]=n,e=i,!n)break e;He(e,r,n)}s[e+n|0]=0,n=(r=d[i+11|0])<<24>>24,o=h[i>>2],e=0;e:if(t=h[t+4>>2]){for(e=r,e=(r=(0|n)<0)?h[i+4>>2]:e,u=r?o:i;;){t:{r:{i:{if(c=(f=(r=(a=(r=d[t+27|0])<<24>>24<0)?h[t+20>>2]:r)>>>0<e>>>0)?r:e){l=t+16|0;n:{if(!(l=Sr(u,a=a?h[l>>2]:l,c))){if(e>>>0>=r>>>0)break n;break t}if((0|l)<0)break t}if(!(r=Sr(a,u,c)))break i;if((0|r)<0)break r;e=1;break e}if(e>>>0<r>>>0)break t}if(!f){e=1;break e}}t=t+4|0}if(!(t=h[t>>2]))break}e=0}(0|n)<0&&ve(o),N=i+16|0}else mn(),S();return 0|e},Ga:function(e,t,r){e|=0,t|=0,r|=0;var i,n=0,o=0;if(N=i=N-16|0,h[i+12>>2]=0,(n=Rr(r))>>>0<4294967280){e:{if(n>>>0>=11)e=mi(o=n+16&-16),h[i+8>>2]=-2147483648|o,h[i>>2]=e,h[i+4>>2]=n;else if(s[i+11|0]=n,e=i,!n)break e;He(e,r,n)}s[e+n|0]=0,(0|(e=Gt(t,i)))!=(t+4|0)&&4==((t=h[e+32>>2])-(e=h[e+28>>2])|0)&&(h[i+12>>2]=d[0|e]|d[e+1|0]<<8|d[e+2|0]<<16|d[e+3|0]<<24),e=h[i+12>>2],s[i+11|0]<0&&ve(h[i>>2]),N=i+16|0}else mn(),S();return 0|e},Ha:function(e,t,r,i){e|=0,t|=0,i|=0;var n=0,o=0,a=0;if(N=e=N-32|0,(n=Rr(r|=0))>>>0<4294967280){e:{if(n>>>0>=11)o=mi(a=n+16&-16),h[e+24>>2]=-2147483648|a,h[e+16>>2]=o,h[e+20>>2]=n;else if(s[e+27|0]=n,o=e+16|0,!n)break e;He(o,r,n)}s[n+o|0]=0,h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,(0|(r=Gt(t,e+16|0)))!=(t+4|0)&&(0|(t=h[r+28>>2]))!=(0|(o=h[r+32>>2]))&&(3&(t=o-t|0)||((n=t>>>2|0)>>>0>(a=(o=h[e+4>>2])-(t=h[e>>2])>>2)>>>0?(er(e,n-a|0),t=h[e>>2],o=h[e+4>>2]):n>>>0>=a>>>0||(o=(n<<2)+t|0,h[e+4>>2]=o),(0|t)==(0|o)?(An(),S()):He(n=t,t=h[r+28>>2],h[r+32>>2]-t|0))),(t=h[i>>2])&&(h[i+4>>2]=t,ve(t)),h[i>>2]=h[e>>2],h[i+4>>2]=h[e+4>>2],h[i+8>>2]=h[e+8>>2],s[e+27|0]<0&&ve(h[e+16>>2]),N=e+32|0}else mn(),S()},Ia:function(e,t,r){e|=0,t|=0,r|=0;var i=0,n=0,o=0,a=0;if(N=e=N-32|0,h[e+24>>2]=0,h[e+28>>2]=0,(i=Rr(r))>>>0<4294967280){e:{if(i>>>0>=11)n=mi(o=i+16&-16),h[e+16>>2]=-2147483648|o,h[e+8>>2]=n,h[e+12>>2]=i;else if(s[e+19|0]=i,n=e+8|0,!i)break e;He(n,r,i)}s[i+n|0]=0,(0|(r=t+4|0))!=(0|(t=Gt(t,e+8|0)))&&8==((r=h[t+32>>2])-(t=h[t+28>>2])|0)&&(r=d[t+4|0]|d[t+5|0]<<8|d[t+6|0]<<16|d[t+7|0]<<24,h[e+24>>2]=d[0|t]|d[t+1|0]<<8|d[t+2|0]<<16|d[t+3|0]<<24,h[e+28>>2]=r),a=g[e+24>>3],s[e+19|0]<0&&ve(h[e+8>>2]),N=e+32|0}else mn(),S();return+a},Ja:function(e,t,r){e|=0,t|=0;var i,n=0,o=0,a=0;if(N=i=N-16|0,(n=Rr(r|=0))>>>0<4294967280){e:{if(n>>>0>=11)o=mi(a=n+16&-16),h[i+8>>2]=-2147483648|a,h[i>>2]=o,h[i+4>>2]=n;else if(s[i+11|0]=n,o=i,!n)break e;He(o,r,n)}s[n+o|0]=0,r=Kr(t,i,o=e+16|0),t=s[e+27|0],e=h[e+16>>2],s[i+11|0]<0&&ve(h[i>>2]),N=i+16|0,e=r?(0|t)<0?e:o:0}else mn(),S();return 0|e},Ka:function(e,t){return h[8+(t|=0)>>2]},La:function(e,t,r){t|=0;var i,n=0,o=0,a=0,l=0,c=0,u=0,d=0;i=r|=0;e:if(h[12+(n=e|=0)>>2]!=(0|t)){if(e=t,(0|(t=h[n+4>>2]))!=(0|(r=h[n>>2])))for(;o=t-12|0,s[t-1|0]<0&&ve(h[o>>2]),(0|r)!=(0|(t=o)););if(h[n+12>>2]=e,h[n+4>>2]=r,(0|(t=h[e>>2]))!=(0|(u=e+4|0)))for(;;){if(h[n+8>>2]==(0|r)){l=0;t:{r:{i:{if((r=1+(a=((o=h[n+4>>2])-(e=h[n>>2])|0)/12|0)|0)>>>0<357913942){if(d=(c=(h[n+8>>2]-e|0)/12|0)<<1,r=c>>>0<178956970?r>>>0>d>>>0?r:d:357913941){if(r>>>0>=357913942)break i;l=mi(v(r,12))}if(c=v(r,12),r=v(a,12)+l|0,s[t+27|0]>=0?(a=h[t+20>>2],h[r>>2]=h[t+16>>2],h[r+4>>2]=a,h[r+8>>2]=h[t+24>>2]):(Ur(r,h[t+16>>2],h[t+20>>2]),o=h[n+4>>2],e=h[n>>2]),l=l+c|0,a=r+12|0,(0|e)==(0|o))break r;for(;c=h[4+(o=o-12|0)>>2],h[(r=r-12|0)>>2]=h[o>>2],h[r+4>>2]=c,h[r+8>>2]=h[o+8>>2],h[o>>2]=0,h[o+4>>2]=0,h[o+8>>2]=0,(0|e)!=(0|o););if(h[n+8>>2]=l,e=h[n+4>>2],h[n+4>>2]=a,o=h[n>>2],h[n>>2]=r,(0|e)==(0|o))break t;for(;r=e-12|0,s[e-1|0]<0&&ve(h[r>>2]),e=r,(0|r)!=(0|o););break t}vn(),S()}Zr(1336),S()}h[n+8>>2]=l,h[n+4>>2]=a,h[n>>2]=r}o&&ve(o)}else s[t+27|0]>=0?(e=h[t+20>>2],h[r>>2]=h[t+16>>2],h[r+4>>2]=e,h[r+8>>2]=h[t+24>>2]):Ur(r,h[t+16>>2],h[t+20>>2]),h[n+4>>2]=r+12;t:if(r=h[t+4>>2])for(;e=r,r=h[r>>2];);else{if(e=h[t+8>>2],h[e>>2]==(0|t))break t;for(t=t+8|0;t=(r=h[t>>2])+8|0,e=h[r+8>>2],(0|r)!=h[e>>2];);}if((0|e)==(0|u))break e;r=h[n+4>>2],t=e}}return r=0,(0|i)<0||(e=h[n>>2],(h[n+4>>2]-e|0)/12>>>0<=i>>>0||(e=e+v(i,12)|0,r=s[e+11|0]<0?h[e>>2]:e)),0|r},Ma:function(e){var t=0,r=0,i=0;if(e|=0){if(s[e+27|0]<0&&ve(h[e+16>>2]),t=h[e>>2]){if((0|(r=h[e+4>>2]))==(0|t))i=t;else{for(;i=r-12|0,s[r-1|0]<0&&ve(h[i>>2]),(0|(r=i))!=(0|t););i=h[e>>2]}h[e+4>>2]=t,ve(i)}ve(e)}},Na:function(){var e,t;return e=mi(40),h[e+4>>2]=0,h[e+8>>2]=0,h[e>>2]=e+4,h[(t=e+16|0)>>2]=0,h[t+4>>2]=0,h[e+24>>2]=0,h[e+28>>2]=0,h[e+12>>2]=t,h[e+32>>2]=0,h[e+36>>2]=0,0|e},Oa:function(e,t,r,i){e|=0,t|=0,r|=0,i|=0;var n,o=0,a=0;N=n=N+-64|0,u[38+(o=n+8|0)>>1]=0,h[o>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,s[o+29|0]=0,s[o+30|0]=0,s[o+31|0]=0,s[o+32|0]=0,s[o+33|0]=0,s[o+34|0]=0,s[o+35|0]=0,s[o+36|0]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o>>2]=t,h[o+8>>2]=r,h[o+12>>2]=0,fe(t=n+48|0,e,o,i),h[e+24>>2]=h[n+48>>2];e:if((0|(r=e+24|0))!=(0|t))if(o=n+48|4,i=(t=d[n+63|0])<<24>>24,s[11+(a=e+28|0)|0]>=0){if((0|i)>=0){e=h[o+4>>2],h[a>>2]=h[o>>2],h[a+4>>2]=e,h[a+8>>2]=h[o+8>>2];break e}ri(a,h[n+52>>2],h[n+56>>2])}else Yr(a,(e=(0|i)<0)?h[n+52>>2]:o,e?h[n+56>>2]:t);return s[n+63|0]<0&&ve(h[n+52>>2]),N=n- -64|0,0|r},Pa:function(e,t,r,i){e|=0,t|=0,r|=0,i|=0;var n,o=0,a=0;N=n=N+-64|0,u[38+(o=n+8|0)>>1]=0,h[o>>2]=0,h[o+8>>2]=0,h[o+12>>2]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o+24>>2]=0,h[o+28>>2]=0,s[o+29|0]=0,s[o+30|0]=0,s[o+31|0]=0,s[o+32|0]=0,s[o+33|0]=0,s[o+34|0]=0,s[o+35|0]=0,s[o+36|0]=0,h[o+16>>2]=0,h[o+20>>2]=0,h[o>>2]=t,h[o+8>>2]=r,h[o+12>>2]=0,Ee(t=n+48|0,e,o,i),h[e+24>>2]=h[n+48>>2];e:if((0|(r=e+24|0))!=(0|t))if(o=n+48|4,i=(t=d[n+63|0])<<24>>24,s[11+(a=e+28|0)|0]>=0){if((0|i)>=0){e=h[o+4>>2],h[a>>2]=h[o>>2],h[a+4>>2]=e,h[a+8>>2]=h[o+8>>2];break e}ri(a,h[n+52>>2],h[n+56>>2])}else Yr(a,(e=(0|i)<0)?h[n+52>>2]:o,e?h[n+56>>2]:t);return s[n+63|0]<0&&ve(h[n+52>>2]),N=n- -64|0,0|r},Qa:function(e,t,r){return 0|hi(t|=0,r|=0)},Ra:function(e,t,r){e|=0,t|=0;var i=0,n=0,o=0;if(N=e=N-32|0,(i=Rr(r|=0))>>>0<4294967280){e:{if(i>>>0>=11)n=mi(o=i+16&-16),h[e+24>>2]=-2147483648|o,h[e+16>>2]=n,h[e+20>>2]=i;else if(s[e+27|0]=i,n=e+16|0,!i)break e;He(n,r,i)}s[i+n|0]=0,s[e+4|0]=0,h[e>>2]=1701667182,s[e+11|0]=4,r=-1,(i=h[t+4>>2])&&(r=-1,(i=wt(i,e,e+16|0))&&(r=Qr(t,h[i+24>>2]))),t=r,s[e+11|0]<0&&ve(h[e>>2]),s[e+27|0]<0&&ve(h[e+16>>2]),N=e+32|0}else mn(),S();return 0|t},Sa:function(e,t,r,i){e|=0,t|=0,i|=0;var n,o=0,a=0;N=n=N-32|0;e:{t:{if((o=Rr(r|=0))>>>0<4294967280){r:{if(o>>>0>=11)e=mi(a=o+16&-16),h[n+24>>2]=-2147483648|a,h[n+16>>2]=e,h[n+20>>2]=o;else if(s[n+27|0]=o,e=n+16|0,!o)break r;He(e,r,o)}if(s[e+o|0]=0,(r=Rr(i))>>>0>=4294967280)break t;r:{if(r>>>0>=11)e=mi(o=r+16&-16),h[n+8>>2]=-2147483648|o,h[n>>2]=e,h[n+4>>2]=r;else if(s[n+11|0]=r,e=n,!r)break r;He(e,i,r)}s[e+r|0]=0,e=-1,(r=h[t+4>>2])&&(e=-1,(r=wt(r,n+16|0,n))&&(e=Qr(t,h[r+24>>2]))),s[n+11|0]<0&&ve(h[n>>2]),s[n+27|0]<0&&ve(h[n+16>>2]),N=n+32|0;break e}mn(),S()}mn(),S()}return 0|e},Ta:function(e,t,r){return r|=0,h[h[8+(t|=0)>>2]+(r<<2)>>2]},Ua:function(e,t,r){e|=0,r|=0;var i=0,n=0;i=(e=h[12+(t|=0)>>2])-(t=h[t+8>>2])|0,e=0;e:if(i){i=(e=i>>2)>>>0>1?e:1,e=0;t:{for(;;){if(n=h[t+(e<<2)>>2],h[n+60>>2]==(0|r))break t;if((0|i)==(0|(e=e+1|0)))break}e=0;break e}e=-1==(0|e)?0:n}return 0|e},Va:function(e,t){return h[4+(t|=0)>>2]},Wa:function(e,t,r){e|=0,r|=0;var i,n=0;if((i=h[4+(t|=0)>>2])&&!((0|(t=h[h[h[t+8>>2]+(r<<2)>>2]+60>>2]))<0)&&(0|(e=h[i+24>>2]))!=(0|(r=h[i+28>>2])))e:{for(;;){if(n=h[e>>2],(0|t)==h[n+24>>2])break e;if((0|r)==(0|(e=e+4|0)))break}n=0}return 0|n},Xa:function(e,t,r,i){var n,s;return e|=0,r|=0,i|=0,N=e=N-16|0,t=h[96+(t|=0)>>2],h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,s=(r=He(n=mi(12),t+v(r,12)|0,12))+12|0,(t=h[i>>2])&&(h[i+4>>2]=t,ve(t)),h[i+8>>2]=r+12,h[i+4>>2]=s,h[i>>2]=n,N=e+16|0,1},Ya:function(e,t,r){e|=0,t|=0;var i,n,o,a,l,c,u=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0,I=0,O=0,P=0,k=0,L=0,G=0,D=0,U=0,V=0,B=0,F=0;c=r|=0,r=0,N=n=N-96|0,St(i=n+16|0,0,76),h[n+92>>2]=-1,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,N=o=N-16|0,h[i+68>>2]=0,h[i+72>>2]=0,h[i>>2]=t,N=a=N-16|0,l=t,e=h[t+20>>2],(h[t+24>>2]-e|0)<=0||-1!=(0|(e=h[e>>2]))&&(r=h[h[l+8>>2]+(e<<2)>>2]);e:{t:{if(r){e=h[l+100>>2],f=h[l+96>>2],h[a+8>>2]=0,h[a>>2]=0,h[a+4>>2]=0,t=(0|(u=e-f|0))/12|0;r:if(u){if(t>>>0>=357913942)break t;if(p=mi(u),h[a>>2]=p,h[a+8>>2]=p+v(t,12),e=0,u=St(m=p,0,p=v((u-12>>>0)/12|0,12)+12|0),h[a+4>>2]=u+p,d[r+84|0]){if(m=1&(r=t>>>0>1?t:1),t>>>0>=2)for(b=-2&r,r=0;p=v(e,12),E=h[4+(t=p+f|0)>>2],w=h[t>>2],h[8+(p=u+p|0)>>2]=h[t+8>>2],h[p>>2]=w,h[p+4>>2]=E,p=v(1|e,12),E=h[8+(t=p+f|0)>>2],w=h[t+4>>2],h[(p=u+p|0)>>2]=h[t>>2],h[p+4>>2]=w,h[p+8>>2]=E,e=e+2|0,(0|b)!=(0|(r=r+2|0)););if(!m)break r;t=v(e,12),r=h[4+(e=t+f|0)>>2],f=h[e>>2],h[8+(t=t+u|0)>>2]=h[e+8>>2],h[t>>2]=f,h[t+4>>2]=r}else for(m=t>>>0>1?t:1,e=h[r+68>>2],r=0;p=v(r,12),b=h[e+(h[(t=p+f|0)>>2]<<2)>>2],E=h[e+(h[t+4>>2]<<2)>>2],h[8+(p=u+p|0)>>2]=h[e+(h[t+8>>2]<<2)>>2],h[p+4>>2]=E,h[p>>2]=b,(0|m)!=(0|(r=r+1|0)););}if(N=k=N-16|0,m=mi(88),h[m>>2]=0,h[m+4>>2]=0,h[m+56>>2]=0,h[m+48>>2]=0,h[m+52>>2]=0,h[m+40>>2]=0,h[m+44>>2]=0,h[m+32>>2]=0,h[m+36>>2]=0,h[m+24>>2]=0,h[m+28>>2]=0,h[m+16>>2]=0,h[m+20>>2]=0,h[m+8>>2]=0,h[m+12>>2]=0,h[(e=m- -64|0)>>2]=0,h[e+4>>2]=0,h[m+72>>2]=0,h[m+76>>2]=0,h[m+80>>2]=0,h[m+84>>2]=0,h[m+60>>2]=m,N=O=N-16|0,h[m+80>>2]=0,h[m+84>>2]=0,e=h[m+76>>2],h[m+76>>2]=0,e&&ve(e),h[m+68>>2]=0,h[m+72>>2]=0,e=h[(t=m- -64|0)>>2],h[t>>2]=0,e&&ve(e),t=h[a>>2],r=h[a+4>>2]-t|0,e=v(b=(0|r)/12|0,3),u=h[m>>2],e>>>0>(f=h[m+4>>2]-u>>2)>>>0?(er(m,e-f|0),t=h[a>>2],b=(0|(r=h[a+4>>2]-t|0))/12|0,u=h[m>>2]):e>>>0>=f>>>0||(h[m+4>>2]=(e<<2)+u),r)for(p=b>>>0>1?b:1,e=0;r=(f=v(e,12))+u|0,f=t+f|0,h[r>>2]=h[f>>2],h[r+4>>2]=h[f+4>>2],h[r+8>>2]=h[f+8>>2],(0|p)!=(0|(e=e+1|0)););h[O+12>>2]=-1,N=p=N-48|0;r:{i:{if(R=O+12|0){if(w=(r=(u=h[m+4>>2])-(E=h[m>>2])|0)>>2,t=h[m+12>>2],w>>>0>(e=h[m+16>>2]-t>>2)>>>0?($e(m+12|0,w-e|0,13684),w=(r=(u=h[m+4>>2])-(E=h[m>>2])|0)>>2):e>>>0<=w>>>0||(h[m+16>>2]=t+(w<<2)),t=0,h[p+40>>2]=0,h[p+32>>2]=0,h[p+36>>2]=0,r){n:{if((0|r)>=0)for(t=mi(r),h[p+36>>2]=t,h[p+32>>2]=t,h[p+40>>2]=(w<<2)+t,e=t,r=0;;){if((b=h[(r<<2)+E>>2])>>>0<(e=e-t>>2)>>>0||(h[p+16>>2]=0,(f=b+1|0)>>>0>e>>>0?($e(p+32|0,f-e|0,p+16|0),E=h[m>>2],u=h[m+4>>2],t=h[p+32>>2]):e>>>0<=f>>>0||(h[p+36>>2]=(f<<2)+t)),h[(e=(b<<2)+t|0)>>2]=h[e>>2]+1,(r=r+1|0)>>>0>=(w=(e=u-E|0)>>2)>>>0)break n;e=h[p+36>>2]}break i}if(h[p+24>>2]=0,h[p+16>>2]=0,h[p+20>>2]=0,e){if(e>>>0>=2147483645)break t;e=mi(r=e<<1),h[p+16>>2]=e,f=e+(w<<3)|0,h[p+24>>2]=f,St(e,255,r),h[p+20>>2]=f}}else h[p+24>>2]=0,h[p+16>>2]=0,h[p+20>>2]=0;if(u=0,h[p+8>>2]=0,h[p>>2]=0,h[p+4>>2]=0,b=(e=h[p+36>>2]-t|0)>>2,e){if((0|e)<0)break t;if(y=mi(e),h[p>>2]=y,r=(e=b<<2)+y|0,h[p+8>>2]=r,e=St(y,0,e),h[p+4>>2]=r,A=3&(f=b>>>0>1?b:1),r=0,f-1>>>0>=3)for(T=-4&f;h[(f=_<<2)+e>>2]=r,I=4|f,r=h[t+f>>2]+r|0,h[I+e>>2]=r,C=8|f,r=r+h[t+I>>2]|0,h[C+e>>2]=r,f|=12,r=r+h[t+C>>2]|0,h[f+e>>2]=r,r=r+h[t+f>>2]|0,_=_+4|0,(0|T)!=(0|(g=g+4|0)););if(A)for(;h[(f=_<<2)+e>>2]=r,_=_+1|0,r=h[t+f>>2]+r|0,(0|A)!=(0|(x=x+1|0)););}if(w)for(I=h[m+12>>2];;){r=(L=u<<2)+E|0,g=-1,-1!=(0|(e=((f=u+1|0)>>>0)%3|0?f:u-2|0))&&(g=h[(e<<2)+E>>2]),e=h[r>>2];n:{s:{if(!((u>>>0)%3|0)){if(x=-1,-1!=(0|(r=u+2|0))&&(x=h[(r<<2)+E>>2]),!((0|e)==(0|g)|(0|e)==(0|x))&(0|g)!=(0|x))break s;h[m+40>>2]=h[m+40>>2]+1,f=u+3|0;break n}x=h[r-4>>2]}s:{o:if(!((0|(C=h[(r=x<<2)+t>>2]))<=0))for(A=h[p+16>>2],r=h[r+y>>2],_=0;;){if(-1==(0|(M=h[(T=A+(r<<3)|0)>>2])))break o;if((0|g)==(0|M)&&(0|(M=-1!=(0|(T=h[T+4>>2]))?h[(T<<2)+E>>2]:-1))!=(0|e)){for(;e=r,!((0|C)<=(0|(_=_+1|0))||(M=A+(e<<3)|0,D=h[(G=A+((r=e+1|0)<<3)|0)>>2],h[M>>2]=D,h[M+4>>2]=h[G+4>>2],-1==(0|D))););if(h[A+(e<<3)>>2]=-1,-1==(0|T))break o;h[I+L>>2]=T,h[I+(T<<2)>>2]=u;break s}if(r=r+1|0,(0|C)==(0|(_=_+1|0)))break}if(!((0|(g=h[(e=g<<2)+t>>2]))<=0))for(A=h[p+16>>2],r=h[e+y>>2],_=0;;){if(-1==h[(e=A+(r<<3)|0)>>2]){h[e>>2]=x,h[e+4>>2]=u;break s}if(r=r+1|0,(0|g)==(0|(_=_+1|0)))break}}}if(!(w>>>0>(u=f)>>>0))break}h[R>>2]=b,y&&ve(y),(e=h[p+16>>2])&&(h[p+20>>2]=e,ve(e)),(e=h[p+32>>2])&&(h[p+36>>2]=e,ve(e))}if(N=p+48|0,I=0!=(0|R)){N=g=N-32|0,w=h[m>>2],e=h[m+4>>2],h[g+24>>2]=0,h[g+16>>2]=0,h[g+20>>2]=0;n:{s:{if(t=e-w|0){if((0|t)<0)break s;f=mi((p=1+(u=(r=t>>2)-1>>>5|0)|0)<<2),h[g+24>>2]=p,h[g+16>>2]=f,h[g+20>>2]=r,h[f+((t>>>0<132?0:u)<<2)>>2]=0,f=St(f,0,t=r>>>5<<2),(r&=31)&&(h[(t=t+f|0)>>2]=h[t>>2]&(-1>>>32-r^-1))}for(h[g+8>>2]=0,h[g>>2]=0;;){if(A=0,t=0,(0|e)!=(0|w)){for(;;){u=h[g+16>>2];o:if(!(h[u+(t>>>3&536870908)>>2]>>>t&1)){for(f=h[g>>2],h[g+4>>2]=f,r=h[m+12>>2],e=t;_=e,!(-1==(0|(e=((p=e+1|0)>>>0)%3|0?p:e-2|0))||-1==(0|(e=h[r+(e<<2)>>2]))||(0|t)==(0|(e=((p=e+1|0)>>>0)%3|0?p:e-2|0))|-1==(0|e)||h[(e>>>3&536870908)+u>>2]>>>e&1););r=f,b=_;a:{l:{for(;;){if(h[(e=(b>>>3&536870908)+u|0)>>2]=h[e>>2]|1<<b,p=((e=b+1|0)>>>0)%3|0?e:b-2|0,T=(E=((C=(b>>>0)%3|0)?-1:2)+b|0)<<2,(0|r)!=(0|f))if(R=h[(p<<2)+w>>2],y=h[m+12>>2],e=r,-1==(0|E))for(;;){if((0|R)==h[e>>2]&&(x=-1,E=-1,-1!=(0|(u=h[e+4>>2]))))break l;if((0|f)==(0|(e=e+8|0)))break}else for(M=y+T|0;;){if((0|R)==h[e>>2]&&(0|(u=h[e+4>>2]))!=(0|(x=h[M>>2]))){if(f=-1,e=-1,-1==(0|u))break a;break l}if((0|f)==(0|(e=e+8|0)))break}if(E=h[w+T>>2],h[g+8>>2]==(0|f)){if((e=1+(f=(u=f-r|0)>>3)|0)>>>0>=536870912)break t;if(y=u>>2,y=u>>>0<2147483640?e>>>0>y>>>0?e:y:536870911){if(y>>>0>=536870912)break i;e=mi(y<<3)}else e=0;h[(f=e+(f<<3)|0)>>2]=E,h[f+4>>2]=p,f=f+8|0,(0|u)>0&&He(e,r,u),h[g+8>>2]=e+(y<<3),h[g+4>>2]=f,h[g>>2]=e,r&&ve(r)}else h[f>>2]=E,h[f+4>>2]=p,f=f+8|0,h[g+4>>2]=f;c:{if(C)e=b-1|0;else if(-1==(0|(e=b+2|0)))break c;if(-1!=(0|(e=h[h[m+12>>2]+(e<<2)>>2]))&&!((0|_)==(0|(b=e+((e>>>0)%3|0?-1:2)|0))|-1==(0|b))){w=h[m>>2],r=h[g>>2],u=h[g+16>>2];continue}}break}w=h[m>>2];break o}e=h[y+((f=u)<<2)>>2]}-1!=(0|x)&&(h[y+(x<<2)>>2]=-1),-1!=(0|e)&&(h[h[m+12>>2]+(e<<2)>>2]=-1),e=h[m+12>>2],h[e+(E<<2)>>2]=-1,h[e+(f<<2)>>2]=-1,A=1}if(!((t=t+1|0)>>>0<(e=h[m+4>>2])-w>>2>>>0))break}if(A)continue}break}(e=h[g>>2])&&ve(e),(e=h[g+16>>2])&&ve(e),N=g+32|0;break n}pn(),S()}E=0,N=_=N-32|0,e=h[O+12>>2],h[m+36>>2]=e,w=m+24|0;n:{s:{o:{a:{l:{r=h[m+24>>2];c:{if((t=h[m+28>>2]-r>>2)>>>0<e>>>0)$e(w,e-t|0,13684),h[_+24>>2]=0,h[_+16>>2]=0,h[_+20>>2]=0;else if(e>>>0<t>>>0&&(h[m+28>>2]=r+(e<<2)),t=0,h[_+24>>2]=0,h[_+16>>2]=0,h[_+20>>2]=0,!e)break c;if((0|e)<0)break l;t=mi((f=1+(r=e-1>>>5|0)|0)<<2),h[_+24>>2]=f,h[_+16>>2]=t,h[_+20>>2]=e,h[((e>>>0<33?0:r)<<2)+t>>2]=0,f=St(t,0,r=e>>>5<<2),(u=31&e)&&(h[(r=r+f|0)>>2]=h[r>>2]&(-1>>>32-u^-1))}if(y=h[m>>2],b=h[m+4>>2],h[_+8>>2]=0,h[_>>2]=0,h[_+4>>2]=0,!(r=b-y|0))break n;if((0|r)<0)break a;if(g=mi((p=1+(u=(f=r>>2)-1>>>5|0)|0)<<2),h[_+8>>2]=p,h[_>>2]=g,h[_+4>>2]=f,x=0,h[((r>>>0<132?0:u)<<2)+g>>2]=0,p=St(g,0,u=f>>>5<<2),(f&=31)&&(h[(u=u+p|0)>>2]=h[u>>2]&(-1>>>32-f^-1)),r>>>0<12)break n;for(;;){if(T=v(x,3),r=h[(f=(T<<2)+y|0)>>2],u=-1,-1!=(0|(p=T+1|0))&&(u=h[(p<<2)+y>>2]),(0|r)!=(0|u)&&(0|(p=r))!=(0|(r=h[f+8>>2]))&&(A=0,(0|r)!=(0|u))){for(;;){if(!(h[((f=A+T|0)>>>3&536870908)+g>>2]>>>f&1)){if(R=(u=1<<(r=h[(f<<2)+y>>2]))&h[((g=r>>>5|0)<<2)+t>>2]){if((0|(t=h[m+28>>2]))==h[m+32>>2]){if((t=1+(g=(u=t-(p=h[w>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(b=u>>1,b=u>>>0<2147483644?t>>>0>b>>>0?t:b:1073741823){if(b>>>0>=1073741824)break i;t=mi(b<<2)}else t=0;h[(g=t+(g<<2)|0)>>2]=-1,(0|u)>0&&He(t,p,u),h[m+32>>2]=t+(b<<2),h[m+28>>2]=g+4,h[m+24>>2]=t,p&&ve(p)}else h[t>>2]=-1,h[m+28>>2]=t+4;if((0|(t=h[m+52>>2]))==h[m+56>>2]){if((t=1+(g=(u=t-(p=h[m+48>>2])|0)>>2)|0)>>>0>=1073741824)break t;if(b=u>>1,b=u>>>0<2147483644?t>>>0>b>>>0?t:b:1073741823){if(b>>>0>=1073741824)break i;t=mi(b<<2)}else t=0;h[(g=t+(g<<2)|0)>>2]=r,(0|u)>0&&He(t,p,u),h[m+56>>2]=t+(b<<2),h[m+52>>2]=g+4,h[m+48>>2]=t,p&&ve(p)}else h[t>>2]=r,h[m+52>>2]=t+4;if((0|(u=h[_+20>>2]))==(t=h[_+24>>2])<<5){if((u+1|0)<0)break o;Se(r=_+16|0,t=u>>>0<=1073741822?(t<<=6)>>>0<(u=u+32&-32)>>>0?u:t:2147483647),u=h[_+20>>2]}h[_+20>>2]=u+1,t=h[_+16>>2]+(u>>>3&536870908)|0,r=h[t>>2],B=t,F=ki(u)&r,h[B>>2]=F,u=1<<e,g=e>>>5|0,r=e,e=e+1|0}p=e,t=h[_+16>>2],h[(e=t+(g<<2)|0)>>2]=h[e>>2]|u,C=h[m+24>>2]+(r<<2)|0,b=h[m+12>>2],y=h[m>>2],g=h[_>>2],e=f;c:{u:{h:{d:{f:{p:{for(;;){if(-1==(0|e))break p;if(h[(u=(e>>>3&536870908)+g|0)>>2]=h[u>>2]|1<<e,h[C>>2]=e,R&&(h[(e<<2)+y>>2]=r),u=-1,-1!=(0|(e=((M=e+1|0)>>>0)%3|0?M:e-2|0))&&(u=-1,-1!=(0|(e=h[b+(e<<2)>>2]))&&(u=((u=e+1|0)>>>0)%3|0?u:e-2|0)),(0|f)==(0|(e=u)))break}if(-1!=(0|f))break c;e=1;break f}if((f>>>0)%3|0)e=f-1|0;else if(-1==(0|(e=f+2|0)))break d}if(-1!=(0|(e=h[b+(e<<2)>>2]))){if(!((e>>>0)%3|0))break h;e=e-1|0,y=h[m>>2],g=h[_>>2];break u}}y=h[m>>2],g=h[_>>2];break c}if(y=h[m>>2],g=h[_>>2],-1==(0|(e=e+2|0)))break c}for(f=h[m+12>>2];;){if(h[(u=(e>>>3&536870908)+g|0)>>2]=h[u>>2]|1<<e,R&&(h[(e<<2)+y>>2]=r),(e>>>0)%3|0)e=e-1|0;else if(-1==(0|(e=e+2|0)))break c;if(-1==(0|(e=h[f+(e<<2)>>2])))break c;if(-1==(0|(e=e+((e>>>0)%3|0?-1:2)|0)))break}}e=p}if(3==(0|(A=A+1|0)))break}y=h[m>>2],b=h[m+4>>2]}if(!((x=x+1|0)>>>0<(b-y>>2>>>0)/3>>>0))break}break s}pn(),S()}pn(),S()}pn(),S()}t=h[_+16>>2]}if(h[m+44>>2]=0,e=h[_+20>>2])for(r=31&e,f=(e>>>3&536870908)+t|0,e=t,g=0;h[e>>2]>>>E&1||(g=g+1|0,h[m+44>>2]=g),(0|f)!=(0|(e=((u=31==(0|E))<<2)+e|0))|(0|r)!=(0|(E=u?0:E+1|0)););(e=h[_>>2])&&(ve(e),t=h[_+16>>2]),t&&ve(t),N=_+32|0}N=O+16|0,I||(h[k+8>>2]=0,Lr(m),m=0),N=k+16|0,e=m;break r}Zr(1336),S()}(t=h[a>>2])&&(h[a+4>>2]=t,ve(t))}else e=0;if(N=a+16|0,t=h[i+4>>2],h[i+4>>2]=e,t&&(Lr(t),e=h[i+4>>2]),e)if(e=h[l+100>>2],t=h[l+96>>2],s[o+12|0]=0,Rt(i+56|0,(e-t|0)/12|0,o+12|0),(0|(e=h[l+100>>2]))!=(0|(r=h[l+96>>2])))for(;;){if(!(h[h[i+56>>2]+(P>>>3&536870908)>>2]>>>P&1)){if(we(i,0,e=v(P,3)),t=h[i+8>>2],r=h[i+12>>2],we(i,1,e+1|0),f=h[i+20>>2],u=h[i+24>>2],we(i,2,e+2|0),e=(f=u-f>>2)>>>0>(r=(t=r-t|0)>>2)>>>0,r=h[i+36>>2]-h[i+32>>2]>>2>>>0>(e?f:r)>>>0?2:e?1:t?0:-1,h[i+68>>2]<=0||(h[o+12>>2]=h[i+76>>2],h[o+8>>2]=n,rr(o+8|0,o+12|0),(0|(e=h[44+((r<<2)+i|0)>>2]))<0?e=-1:(t=(e>>>0)/3|0,e=h[(h[h[i>>2]+96>>2]+v(t,12)|0)+(e-v(t,3)<<2)>>2]),h[o+12>>2]=e,h[o+8>>2]=n,rr(o+8|0,o+12|0),t=h[i+72>>2],h[i+72>>2]=t+2,1&t&&(h[o+12>>2]=e,h[o+8>>2]=n,rr(o+8|0,o+12|0),h[i+72>>2]=h[i+72>>2]+1)),N=t=N-16|0,h[i+68>>2]=h[i+68>>2]+1,e=v(r,12)+i|0,!((0|(f=h[e+12>>2]-h[e+8>>2]|0))<=0)){e=-1,u=((r=h[44+((r<<2)+i|0)>>2])>>>0)/3|0,p=(_=-1==(0|r))?-1:u,m=h[i+56>>2]+(p>>>3&536870908)|0,h[m>>2]=h[m>>2]|1<<p,h[i+72>>2]=h[i+72>>2]+1,h[t+12>>2]=(0|r)>=0?h[(h[h[i>>2]+96>>2]+v(u,12)|0)+((r>>>0)%3<<2)>>2]:-1,h[t+8>>2]=n,rr(t+8|0,t+12|0);r:if(_)h[t+12>>2]=-1,h[t+8>>2]=n,rr(t+8|0,t+12|0);else{if((0|(p=((p=r+1|0)>>>0)%3|0?p:r-2|0))>=0?(_=(p>>>0)/3|0,p=h[(h[h[i>>2]+96>>2]+v(_,12)|0)+(p-v(_,3)<<2)>>2]):p=-1,h[t+12>>2]=p,h[t+8>>2]=n,rr(t+8|0,t+12|0),(0|(u=r+(r-v(u,3)|0?-1:2)|0))<0)break r;e=(u>>>0)/3|0,e=h[(h[h[i>>2]+96>>2]+v(e,12)|0)+(u-v(e,3)<<2)>>2]}if(h[i+76>>2]=e,h[t+12>>2]=e,h[t+8>>2]=n,e=-1,rr(t+8|0,t+12|0),e=-1!=(0|r)?h[h[h[i+4>>2]+12>>2]+(r<<2)>>2]:e,!(f>>>0<=7))for(_=(r=f>>>2|0)>>>0>1?r:1,f=1;;){r=e,p=(e>>>0)/3|0,e=-1==(0|e)?-1:p,u=h[i+56>>2]+(e>>>3&536870908)|0,h[u>>2]=h[u>>2]|1<<e,h[i+72>>2]=h[i+72>>2]+1,e=-1,e=(0|r)>=0?h[(h[h[i>>2]+96>>2]+v(p,12)|0)+((r>>>0)%3<<2)>>2]:e,h[i+76>>2]=e,h[t+12>>2]=e,h[t+8>>2]=n,rr(t+8|0,t+12|0);r:{i:{if(1&f){if(u=-1,-1==(0|r))break r;if((0|r)!=(0|v(p,3))){e=r-1|0;break i}e=r+2|0}else{if(u=-1,-1==(0|r))break r;e=((e=r+1|0)>>>0)%3|0?e:r-2|0}if(u=-1,-1==(0|e))break r}u=h[h[h[i+4>>2]+12>>2]+(e<<2)>>2]}if(e=u,(0|_)==(0|(f=f+1|0)))break}}N=t+16|0,r=h[l+96>>2],e=h[l+100>>2]}if(U=1,!((P=P+1|0)>>>0<(e-r|0)/12>>>0))break}else U=1;N=o+16|0,U?((e=h[c>>2])&&(h[c+4>>2]=e,ve(e)),h[c>>2]=h[n>>2],h[c+4>>2]=h[n+4>>2],h[c+8>>2]=h[n+8>>2],V=h[n+84>>2]):(e=h[n>>2])&&(h[n+4>>2]=e,ve(e)),(e=h[n+72>>2])&&ve(e),(e=h[n+48>>2])&&(h[n+52>>2]=e,ve(e)),(e=h[n+36>>2])&&(h[n+40>>2]=e,ve(e)),(e=h[n+24>>2])&&(h[n+28>>2]=e,ve(e)),e=h[n+20>>2],h[n+20>>2]=0,e&&Lr(e),N=n+96|0;break e}vn(),S()}return 0|V},Za:function(e,t,r,i){e|=0,r|=0,i|=0;var n=0,s=0,o=0;if(!(p[80+(t|=0)>>2]>65535||(s=h[t+96>>2],t=h[t+100>>2]-s|0,o=(0|(n=v(e=(0|t)/12|0,6)))==(0|r),!t|(0|r)!=(0|n))))for(o=1,n=e>>>0>1?e:1,e=0;t=v(e,6)+i|0,r=v(e,12)+s|0,u[t>>1]=h[r>>2],u[t+2>>1]=h[r+4>>2],u[t+4>>1]=h[r+8>>2],(0|n)!=(0|(e=e+1|0)););return 0|o},_a:function(e,t,r,i){e|=0,r|=0,i|=0;var n,s=0,o=0,a=0;if(n=h[96+(t|=0)>>2],!((0|(t=h[t+100>>2]-n|0))!=(0|r)|!t))for(a=(e=(0|r)/12|0)>>>0>1?e:1,e=0;o=(s=v(e,12))+i|0,s=s+n|0,h[o>>2]=h[s>>2],h[o+4>>2]=h[s+4>>2],h[o+8>>2]=h[s+8>>2],(0|a)!=(0|(e=e+1|0)););return(0|t)==(0|r)|0},$a:function(e,t,r,i){e|=0,r|=0,i|=0;var n=0,o=0,a=0;N=e=N-32|0,n=s[24+(t|=0)|0],o=h[3419],h[e+24>>2]=h[3418],h[e+28>>2]=o,o=h[3417],h[e+16>>2]=h[3416],h[e+20>>2]=o;e:{t:{if(r=Z(t,r,n,e+16|0)){if(h[e+8>>2]=0,h[e>>2]=0,h[e+4>>2]=0,t=0,n){if((0|n)<0)break t;a=He(t=mi(n<<=2),e+16|0,n)+n|0}(n=h[i>>2])&&(h[i+4>>2]=n,ve(n)),h[i+8>>2]=a,h[i+4>>2]=a,h[i>>2]=t}N=e+32|0;break e}vn(),S()}return 0|r},ab:function(e,t,r,i){e|=0,r|=0,i|=0;var n,o,a=0,l=0,c=0,u=0,f=0,p=0,g=0,_=0,b=0,y=0,E=0;e=0,N=n=N-16|0,o=h[80+(t|=0)>>2],a=s[r+24|0],h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0;e:{t:{if(a){if((0|a)<0)break t;if(e=mi(t=a<<2),h[n>>2]=e,c=e+t|0,h[n+8>>2]=c,f=a-1&1073741823,p=7&a)for(t=e;h[t>>2]=-1073741824,t=t+4|0,(0|p)!=(0|(l=l+1|0)););else t=e;if(f>>>0>=7)for(;h[t+24>>2]=-1073741824,h[t+28>>2]=-1073741824,h[t+16>>2]=-1073741824,h[t+20>>2]=-1073741824,h[t+8>>2]=-1073741824,h[t+12>>2]=-1073741824,h[t>>2]=-1073741824,h[t+4>>2]=-1073741824,(0|c)!=(0|(t=t+32|0)););h[n+4>>2]=c}t=v(a,o),c=h[i>>2],t>>>0>(l=h[i+4>>2]-c>>2)>>>0?er(i,t-l|0):t>>>0>=l>>>0||(h[i+4>>2]=c+(t<<2));r:if(o)if(u=1,(0|a)<=0)for(t=0;;){if(!Z(r,d[r+84|0]?t:h[h[r+68>>2]+(t<<2)>>2],s[r+24|0],e))break r;if(u=o>>>0>(t=t+1|0)>>>0,(0|t)==(0|o))break}else{for(y=-4&a,p=3&a,l=0,E=a-1>>>0<3;;){if(Z(r,d[r+84|0]?g:h[h[r+68>>2]+(g<<2)>>2],s[r+24|0],e)){if(b=h[i>>2],_=0,a=h[n>>2],t=0,u=0,!E)for(;f=t<<2,m[(c=b+(l<<2)|0)>>2]=m[f+a>>2],m[c+4>>2]=m[(4|f)+a>>2],m[c+8>>2]=m[(8|f)+a>>2],m[c+12>>2]=m[(12|f)+a>>2],t=t+4|0,l=l+4|0,(0|y)!=(0|(u=u+4|0)););if(p)for(;m[b+(l<<2)>>2]=m[(t<<2)+a>>2],t=t+1|0,l=l+1|0,(0|p)!=(0|(_=_+1|0)););if(u=(g=g+1|0)>>>0<o>>>0,(0|o)!=(0|g))continue}break}e=h[n>>2]}e&&ve(e),N=n+16|0,e=1&(-1^u);break e}vn(),S()}return 0|e},bb:De,cb:function(e,t,r,i){e|=0,r|=0,i|=0;var n,o,a,l=0,c=0,u=0,f=0;N=n=N-16|0,o=h[80+(t|=0)>>2],a=d[r+24|0],t=v(o,l=a<<24>>24);e:{t:{e=h[r+28>>2];r:if(!d[r+84|0]|1!=(0|e)&2!=(0|e)){e=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0;i:{n:{if(l){if((0|l)<0)break t;if(c=mi(l),h[n>>2]=c,St(c,0,l),sr(i,t),o)break n;t=1;break i}if(sr(i,t),t=1,!o)break r;for(;te(r,d[r+84|0]?e:h[h[r+68>>2]+(e<<2)>>2],s[r+24|0],0)&&(t=o>>>0>(e=e+1|0)>>>0,(0|e)!=(0|o)););t^=1;break r}u=-2&(t=l-1|0),f=1&t,t=1,l=0;n:{for(;;){if(c=h[n>>2],!te(r,d[r+84|0]?l:h[h[r+68>>2]+(l<<2)>>2],s[r+24|0],c))break n;s[h[i>>2]+e|0]=d[0|c],t=1,e=e+1|0,c=0;s:{switch(a-1|0){default:for(;s[h[i>>2]+e|0]=d[h[n>>2]+t|0],s[1+(h[i>>2]+e|0)|0]=d[1+(h[n>>2]+t|0)|0],t=t+2|0,e=e+2|0,(0|u)!=(0|(c=c+2|0)););break;case 0:break s;case 1:}f&&(s[h[i>>2]+e|0]=d[h[n>>2]+t|0],e=e+1|0)}if(t=o>>>0>(l=l+1|0)>>>0,(0|l)==(0|o))break}c=h[n>>2]}if(t=!t,!c)break r}ve(c)}else{if(l=h[r+48>>2],r=h[h[r>>2]>>2],e=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,t){if((0|t)<0)break t;e=He(c=mi(t),r+l|0,t)+t|0}(t=h[i>>2])&&(h[i+4>>2]=t,ve(t)),h[i+8>>2]=e,h[i+4>>2]=e,h[i>>2]=c,t=1}N=n+16|0,e=1&t;break e}vn(),S()}return 0|e},db:function(e,t,r,i){e|=0,r|=0,i|=0;var n,o,a,l=0,c=0,u=0,f=0;N=n=N-16|0,o=h[80+(t|=0)>>2],a=d[r+24|0],t=v(o,l=a<<24>>24);e:{t:{e=h[r+28>>2];r:if(!d[r+84|0]|1!=(0|e)&2!=(0|e)){e=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0;i:{n:{if(l){if((0|l)<0)break t;if(c=mi(l),h[n>>2]=c,St(c,0,l),sr(i,t),o)break n;t=1;break i}if(sr(i,t),t=1,!o)break r;for(;re(r,d[r+84|0]?e:h[h[r+68>>2]+(e<<2)>>2],s[r+24|0],0)&&(t=o>>>0>(e=e+1|0)>>>0,(0|e)!=(0|o)););t^=1;break r}u=-2&(t=l-1|0),f=1&t,t=1,l=0;n:{for(;;){if(c=h[n>>2],!re(r,d[r+84|0]?l:h[h[r+68>>2]+(l<<2)>>2],s[r+24|0],c))break n;s[h[i>>2]+e|0]=d[0|c],t=1,e=e+1|0,c=0;s:{switch(a-1|0){default:for(;s[h[i>>2]+e|0]=d[h[n>>2]+t|0],s[1+(h[i>>2]+e|0)|0]=d[1+(h[n>>2]+t|0)|0],t=t+2|0,e=e+2|0,(0|u)!=(0|(c=c+2|0)););break;case 0:break s;case 1:}f&&(s[h[i>>2]+e|0]=d[h[n>>2]+t|0],e=e+1|0)}if(t=o>>>0>(l=l+1|0)>>>0,(0|l)==(0|o))break}c=h[n>>2]}if(t=!t,!c)break r}ve(c)}else{if(l=h[r+48>>2],r=h[h[r>>2]>>2],e=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,t){if((0|t)<0)break t;e=He(c=mi(t),r+l|0,t)+t|0}(t=h[i>>2])&&(h[i+4>>2]=t,ve(t)),h[i+8>>2]=e,h[i+4>>2]=e,h[i>>2]=c,t=1}N=n+16|0,e=1&t;break e}vn(),S()}return 0|e},eb:function(e,t,r,i){e|=0,r|=0,i|=0;var n,o=0,a=0,l=0,c=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0;N=n=N-16|0,c=h[80+(t|=0)>>2],e=s[r+24|0],o=v(c,e);e:{t:{if(t=h[r+28>>2],!d[r+84|0]|3!=(0|t)&4!=(0|t)){if(h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,e){if((0|e)<0)break t;l=mi(t=e<<1),h[n>>2]=l,a=t+l|0,h[n+8>>2]=a,St(l,0,t),h[n+4>>2]=a}a=h[i>>2],(t=h[i+4>>2]-a>>1)>>>0<o>>>0?nr(i,o-t|0):t>>>0<=o>>>0||(h[i+4>>2]=a+(o<<1));r:if(c)if(e){for(E=-4&e,b=3&e,w=e-1>>>0<3,t=1,o=0;;){if(le(r,d[r+84|0]?o:h[h[r+68>>2]+(o<<2)>>2],s[r+24|0],l)){if(y=h[i>>2],_=0,a=h[n>>2],e=0,t=0,!w)for(;g=e<<1,u[(m=(p<<1)+y|0)>>1]=f[a+g>>1],u[m+2>>1]=f[a+(2|g)>>1],u[m+4>>1]=f[a+(4|g)>>1],u[m+6>>1]=f[a+(6|g)>>1],e=e+4|0,p=p+4|0,(0|E)!=(0|(t=t+4|0)););if(b)for(;u[(p<<1)+y>>1]=f[a+(e<<1)>>1],e=e+1|0,p=p+1|0,(0|(_=_+1|0))!=(0|b););if(t=c>>>0>(o=o+1|0)>>>0,(0|o)!=(0|c))continue}break}l=h[n>>2]}else for(e=0,t=1;;){if(!le(r,d[r+84|0]?e:h[h[r+68>>2]+(e<<2)>>2],s[r+24|0],l))break r;if(t=c>>>0>(e=e+1|0)>>>0,(0|e)==(0|c))break}else t=0;l&&ve(l),e=1^t}else{if(l=h[r+48>>2],c=h[h[r>>2]>>2],t=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,r=0,e=o<<1){if((0|e)<0)break t;p=(t=He(r=mi(e),l+c|0,e))+e|0,t=t+(e>>1<<1)|0}(e=h[i>>2])&&(h[i+4>>2]=e,ve(e)),h[i+8>>2]=t,h[i+4>>2]=p,h[i>>2]=r,e=1}N=n+16|0,e&=1;break e}vn(),S()}return 0|e},fb:function(e,t,r,i){e|=0,r|=0,i|=0;var n,o=0,a=0,l=0,c=0,p=0,m=0,g=0,_=0,b=0,y=0,E=0,w=0;N=n=N-16|0,c=h[80+(t|=0)>>2],e=s[r+24|0],o=v(c,e);e:{t:{if(t=h[r+28>>2],!d[r+84|0]|3!=(0|t)&4!=(0|t)){if(h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,e){if((0|e)<0)break t;l=mi(t=e<<1),h[n>>2]=l,a=t+l|0,h[n+8>>2]=a,St(l,0,t),h[n+4>>2]=a}a=h[i>>2],(t=h[i+4>>2]-a>>1)>>>0<o>>>0?nr(i,o-t|0):t>>>0<=o>>>0||(h[i+4>>2]=a+(o<<1));r:if(c)if(e){for(E=-4&e,b=3&e,w=e-1>>>0<3,t=1,o=0;;){if(ce(r,d[r+84|0]?o:h[h[r+68>>2]+(o<<2)>>2],s[r+24|0],l)){if(y=h[i>>2],_=0,a=h[n>>2],e=0,t=0,!w)for(;g=e<<1,u[(m=(p<<1)+y|0)>>1]=f[a+g>>1],u[m+2>>1]=f[a+(2|g)>>1],u[m+4>>1]=f[a+(4|g)>>1],u[m+6>>1]=f[a+(6|g)>>1],e=e+4|0,p=p+4|0,(0|E)!=(0|(t=t+4|0)););if(b)for(;u[(p<<1)+y>>1]=f[a+(e<<1)>>1],e=e+1|0,p=p+1|0,(0|(_=_+1|0))!=(0|b););if(t=c>>>0>(o=o+1|0)>>>0,(0|o)!=(0|c))continue}break}l=h[n>>2]}else for(e=0,t=1;;){if(!ce(r,d[r+84|0]?e:h[h[r+68>>2]+(e<<2)>>2],s[r+24|0],l))break r;if(t=c>>>0>(e=e+1|0)>>>0,(0|e)==(0|c))break}else t=0;l&&ve(l),e=1^t}else{if(l=h[r+48>>2],c=h[h[r>>2]>>2],t=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,r=0,e=o<<1){if((0|e)<0)break t;p=(t=He(r=mi(e),l+c|0,e))+e|0,t=t+(e>>1<<1)|0}(e=h[i>>2])&&(h[i+4>>2]=e,ve(e)),h[i+8>>2]=t,h[i+4>>2]=p,h[i>>2]=r,e=1}N=n+16|0,e&=1;break e}vn(),S()}return 0|e},gb:De,hb:function(e,t,r,i){e|=0,r|=0,i|=0;var n,o=0,a=0,l=0,c=0,u=0,f=0,p=0,m=0,g=0,_=0,b=0,y=0;N=n=N-16|0,c=h[80+(t|=0)>>2],e=s[r+24|0],o=v(c,e);e:{t:{if(t=h[r+28>>2],!d[r+84|0]|5!=(0|t)&6!=(0|t)){if(h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,e){if((0|e)<0)break t;l=mi(t=e<<2),h[n>>2]=l,a=t+l|0,h[n+8>>2]=a,St(l,0,t),h[n+4>>2]=a}a=h[i>>2],(t=h[i+4>>2]-a>>2)>>>0<o>>>0?er(i,o-t|0):t>>>0<=o>>>0||(h[i+4>>2]=a+(o<<2));r:if(c)if(e){for(b=-4&e,g=3&e,y=e-1>>>0<3,t=1,o=0;;){if(de(r,d[r+84|0]?o:h[h[r+68>>2]+(o<<2)>>2],s[r+24|0],l)){if(_=h[i>>2],m=0,a=h[n>>2],e=0,t=0,!y)for(;p=e<<2,h[(f=(u<<2)+_|0)>>2]=h[a+p>>2],h[f+4>>2]=h[a+(4|p)>>2],h[f+8>>2]=h[a+(8|p)>>2],h[f+12>>2]=h[a+(12|p)>>2],e=e+4|0,u=u+4|0,(0|b)!=(0|(t=t+4|0)););if(g)for(;h[(u<<2)+_>>2]=h[a+(e<<2)>>2],e=e+1|0,u=u+1|0,(0|(m=m+1|0))!=(0|g););if(t=c>>>0>(o=o+1|0)>>>0,(0|o)!=(0|c))continue}break}l=h[n>>2]}else for(e=0,t=1;;){if(!de(r,d[r+84|0]?e:h[h[r+68>>2]+(e<<2)>>2],s[r+24|0],l))break r;if(t=c>>>0>(e=e+1|0)>>>0,(0|e)==(0|c))break}else t=0;l&&ve(l),e=1^t}else{if(l=h[r+48>>2],c=h[h[r>>2]>>2],t=0,h[n+8>>2]=0,h[n>>2]=0,h[n+4>>2]=0,r=0,e=o<<2){if((0|e)<0)break t;u=(t=He(r=mi(e),l+c|0,e))+e|0,t=t+(e>>2<<2)|0}(e=h[i>>2])&&(h[i+4>>2]=e,ve(e)),h[i+8>>2]=t,h[i+4>>2]=u,h[i>>2]=r,e=1}N=n+16|0,e&=1;break e}vn(),S()}return 0|e},ib:function(e,t,r,i,n,o){e|=0,t|=0,r|=0,n|=0,o|=0;var a=0,l=0,c=0,p=0,g=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0,M=0,C=0,R=0;e:{t:{r:{i:{n:switch((i|=0)-1|0){case 0:e=0,N=b=N-16|0,p=h[t+80>>2],a=s[r+24|0];s:if((0|v(p,a))==(0|n))if((t=1!=h[r+28>>2])|!(e=d[r+84|0])){if(i=0,h[b+8>>2]=0,h[b>>2]=0,h[b+4>>2]=0,a){if((0|a)<0)break i;l=mi(a),h[b>>2]=l,St(l,0,a)}o:{a:if(p){if(t){if(!a)for(t=0,i=1;;){if(!te(r,255&e?t:h[h[r+68>>2]+(t<<2)>>2],s[r+24|0],l))break a;if(i=p>>>0>(t=t+1|0)>>>0,(0|t)==(0|p))break a;e=d[r+84|0]}for(_=-4&a,g=3&a,t=0,y=a-1>>>0<3,i=1;;){if(!te(r,255&e?c:h[h[r+68>>2]+(c<<2)>>2],s[r+24|0],l))break a;if(i=0,e=0,n=0,!y)for(;s[0|(a=t+o|0)]=d[e+l|0],s[a+1|0]=d[(1|e)+l|0],s[a+2|0]=d[(2|e)+l|0],s[a+3|0]=d[(3|e)+l|0],e=e+4|0,t=t+4|0,(0|_)!=(0|(n=n+4|0)););if(g)for(;s[t+o|0]=d[e+l|0],e=e+1|0,t=t+1|0,(0|g)!=(0|(i=i+1|0)););if((0|p)==(0|(c=c+1|0)))break;i=c>>>0<p>>>0,e=d[r+84|0]}e=c>>>0>=p>>>0;break o}if(a)for(y=-4&a,_=3&a,t=0,E=a-1>>>0<3;;){if(n=h[h[r>>2]>>2],w=h[r+40>>2],a=He(l,n+(e=h[r+48>>2]+qr(w,h[r+44>>2],255&e?i:h[h[r+68>>2]+(i<<2)>>2],0)|0)|0,w),n=0,e=0,c=0,!E)for(;s[0|(g=t+o|0)]=d[e+a|0],s[g+1|0]=d[a+(1|e)|0],s[g+2|0]=d[a+(2|e)|0],s[g+3|0]=d[a+(3|e)|0],e=e+4|0,t=t+4|0,(0|y)!=(0|(c=c+4|0)););if(_)for(;s[t+o|0]=d[e+a|0],e=e+1|0,t=t+1|0,(0|_)!=(0|(n=n+1|0)););if(e=1,(0|p)==(0|(i=i+1|0)))break o;e=d[r+84|0]}if(_=h[r>>2],n=h[r+48>>2],E=h[r+68>>2],o=h[r+44>>2],w=r=h[r+40>>2],t=0,1!=(0|p))for(x=-2&p,T=255&e;a=1|t,g=He(l,(y=h[_>>2])+(g=qr(r,o,T?t:h[E+(t<<2)>>2],0)+n|0)|0,w),A=h[_>>2],T||(a=h[E+(a<<2)>>2]),He(g,(a=qr(r,o,a,0)+n|0)+A|0,w),t=t+2|0,(0|x)!=(0|(c=c+2|0)););if(!(1&p))break a;c=h[_>>2],255&e||(t=h[E+(t<<2)>>2]),He(l,(e=qr(r,o,t,0)+n|0)+c|0,w)}if(e=1^i,!l)break s}ve(l)}else He(o,h[h[r>>2]>>2]+h[r+48>>2]|0,n),e=1;break r;case 2:e=0,N=b=N-16|0,a=(i=s[r+24|0])<<1,p=h[t+80>>2];s:if((0|v(a,p))==(0|n))if((t=3!=h[r+28>>2])|!(e=d[r+84|0])){if(h[b+8>>2]=0,h[b>>2]=0,h[b+4>>2]=0,i){if((0|i)<0)break i;l=mi(a),h[b>>2]=l,St(l,0,i<<1)}o:{a:if(p){if(t){if(!i)for(t=0,c=1;;){if(!le(r,255&e?t:h[h[r+68>>2]+(t<<2)>>2],s[r+24|0],l))break a;if(c=p>>>0>(t=t+1|0)>>>0,(0|t)==(0|p))break a;e=d[r+84|0]}for(y=-4&i,_=3&i,t=0,E=i-1>>>0<3,c=1,i=0;;){if(!le(r,255&e?i:h[h[r+68>>2]+(i<<2)>>2],s[r+24|0],l))break a;if(n=0,e=0,c=0,!E)for(;g=e<<1,u[(a=(t<<1)+o|0)>>1]=f[g+l>>1],u[a+2>>1]=f[(2|g)+l>>1],u[a+4>>1]=f[(4|g)+l>>1],u[a+6>>1]=f[(6|g)+l>>1],e=e+4|0,t=t+4|0,(0|y)!=(0|(c=c+4|0)););if(_)for(;u[(t<<1)+o>>1]=f[(e<<1)+l>>1],e=e+1|0,t=t+1|0,(0|_)!=(0|(n=n+1|0)););if((0|p)==(0|(i=i+1|0)))break;c=i>>>0<p>>>0,e=d[r+84|0]}e=i>>>0>=p>>>0;break o}if(y=h[r>>2],n=h[r+48>>2],w=h[r+68>>2],a=h[r+44>>2],T=g=h[r+40>>2],i){for(M=-4&i,E=3&i,t=0,C=255&e,R=i-1>>>0<3,i=0;;){if(_=He(l,(r=h[y>>2])+(e=qr(g,a,C?i:h[w+(i<<2)>>2],0)+n|0)|0,T),c=0,e=0,r=0,!R)for(;A=e<<1,u[(x=(t<<1)+o|0)>>1]=f[A+_>>1],u[x+2>>1]=f[_+(2|A)>>1],u[x+4>>1]=f[_+(4|A)>>1],u[x+6>>1]=f[_+(6|A)>>1],e=e+4|0,t=t+4|0,(0|M)!=(0|(r=r+4|0)););if(E)for(;u[(t<<1)+o>>1]=f[_+(e<<1)>>1],e=e+1|0,t=t+1|0,(0|E)!=(0|(c=c+1|0)););if(e=1,(0|p)==(0|(i=i+1|0)))break}break o}if(t=0,1!=(0|p))for(x=-2&p,_=255&e,i=0;r=1|t,o=He(l,(E=h[y>>2])+(o=qr(g,a,_?t:h[w+(t<<2)>>2],0)+n|0)|0,T),A=h[y>>2],_||(r=h[w+(r<<2)>>2]),He(o,(r=qr(g,a,r,0)+n|0)+A|0,T),t=t+2|0,(0|x)!=(0|(i=i+2|0)););if(!(1&p))break a;r=h[y>>2],255&e||(t=h[w+(t<<2)>>2]),He(l,(e=qr(g,a,t,0)+n|0)+r|0,T)}if(e=!c,!l)break s}ve(l)}else He(o,h[h[r>>2]>>2]+h[r+48>>2]|0,n),e=1;break t;case 4:e=0,N=b=N-16|0,a=(i=s[r+24|0])<<2,p=h[t+80>>2];s:if((0|v(a,p))==(0|n))if((t=5!=h[r+28>>2])|!(e=d[r+84|0])){if(h[b+8>>2]=0,h[b>>2]=0,h[b+4>>2]=0,i){if((0|i)<0)break i;l=mi(a),h[b>>2]=l,St(l,0,i<<2)}o:{a:if(p){if(t){if(!i)for(t=0,c=1;;){if(!he(r,255&e?t:h[h[r+68>>2]+(t<<2)>>2],s[r+24|0],l))break a;if(c=p>>>0>(t=t+1|0)>>>0,(0|t)==(0|p))break a;e=d[r+84|0]}for(y=-4&i,_=3&i,t=0,E=i-1>>>0<3,c=1,i=0;;){if(!he(r,255&e?i:h[h[r+68>>2]+(i<<2)>>2],s[r+24|0],l))break a;if(n=0,e=0,c=0,!E)for(;g=e<<2,h[(a=(t<<2)+o|0)>>2]=h[g+l>>2],h[a+4>>2]=h[(4|g)+l>>2],h[a+8>>2]=h[(8|g)+l>>2],h[a+12>>2]=h[(12|g)+l>>2],e=e+4|0,t=t+4|0,(0|y)!=(0|(c=c+4|0)););if(_)for(;h[(t<<2)+o>>2]=h[(e<<2)+l>>2],e=e+1|0,t=t+1|0,(0|_)!=(0|(n=n+1|0)););if((0|p)==(0|(i=i+1|0)))break;c=i>>>0<p>>>0,e=d[r+84|0]}e=i>>>0>=p>>>0;break o}if(y=h[r>>2],n=h[r+48>>2],w=h[r+68>>2],a=h[r+44>>2],T=g=h[r+40>>2],i){for(M=-4&i,E=3&i,t=0,C=255&e,R=i-1>>>0<3,i=0;;){if(_=He(l,(r=h[y>>2])+(e=qr(g,a,C?i:h[w+(i<<2)>>2],0)+n|0)|0,T),c=0,e=0,r=0,!R)for(;A=e<<2,h[(x=(t<<2)+o|0)>>2]=h[A+_>>2],h[x+4>>2]=h[_+(4|A)>>2],h[x+8>>2]=h[_+(8|A)>>2],h[x+12>>2]=h[_+(12|A)>>2],e=e+4|0,t=t+4|0,(0|M)!=(0|(r=r+4|0)););if(E)for(;h[(t<<2)+o>>2]=h[_+(e<<2)>>2],e=e+1|0,t=t+1|0,(0|E)!=(0|(c=c+1|0)););if(e=1,(0|p)==(0|(i=i+1|0)))break}break o}if(t=0,1!=(0|p))for(x=-2&p,_=255&e,i=0;r=1|t,o=He(l,(E=h[y>>2])+(o=qr(g,a,_?t:h[w+(t<<2)>>2],0)+n|0)|0,T),A=h[y>>2],_||(r=h[w+(r<<2)>>2]),He(o,(r=qr(g,a,r,0)+n|0)+A|0,T),t=t+2|0,(0|x)!=(0|(i=i+2|0)););if(!(1&p))break a;r=h[y>>2],255&e||(t=h[w+(t<<2)>>2]),He(l,(e=qr(g,a,t,0)+n|0)+r|0,T)}if(e=!c,!l)break s}ve(l)}else He(o,h[h[r>>2]>>2]+h[r+48>>2]|0,n),e=1;break t;case 1:e=0,N=b=N-16|0,p=h[t+80>>2],a=s[r+24|0];s:if((0|v(p,a))==(0|n))if((t=2!=h[r+28>>2])|!(e=d[r+84|0])){if(i=0,h[b+8>>2]=0,h[b>>2]=0,h[b+4>>2]=0,a){if((0|a)<0)break i;l=mi(a),h[b>>2]=l,St(l,0,a)}o:{a:if(p){if(t){if(!a)for(t=0,i=1;;){if(!re(r,255&e?t:h[h[r+68>>2]+(t<<2)>>2],s[r+24|0],l))break a;if(i=p>>>0>(t=t+1|0)>>>0,(0|t)==(0|p))break a;e=d[r+84|0]}for(_=-4&a,g=3&a,t=0,y=a-1>>>0<3,i=1;;){if(!re(r,255&e?c:h[h[r+68>>2]+(c<<2)>>2],s[r+24|0],l))break a;if(i=0,e=0,n=0,!y)for(;s[0|(a=t+o|0)]=d[e+l|0],s[a+1|0]=d[(1|e)+l|0],s[a+2|0]=d[(2|e)+l|0],s[a+3|0]=d[(3|e)+l|0],e=e+4|0,t=t+4|0,(0|_)!=(0|(n=n+4|0)););if(g)for(;s[t+o|0]=d[e+l|0],e=e+1|0,t=t+1|0,(0|g)!=(0|(i=i+1|0)););if((0|p)==(0|(c=c+1|0)))break;i=c>>>0<p>>>0,e=d[r+84|0]}e=c>>>0>=p>>>0;break o}if(a)for(y=-4&a,_=3&a,t=0,E=a-1>>>0<3;;){if(n=h[h[r>>2]>>2],w=h[r+40>>2],a=He(l,n+(e=h[r+48>>2]+qr(w,h[r+44>>2],255&e?i:h[h[r+68>>2]+(i<<2)>>2],0)|0)|0,w),n=0,e=0,c=0,!E)for(;s[0|(g=t+o|0)]=d[e+a|0],s[g+1|0]=d[a+(1|e)|0],s[g+2|0]=d[a+(2|e)|0],s[g+3|0]=d[a+(3|e)|0],e=e+4|0,t=t+4|0,(0|y)!=(0|(c=c+4|0)););if(_)for(;s[t+o|0]=d[e+a|0],e=e+1|0,t=t+1|0,(0|_)!=(0|(n=n+1|0)););if(e=1,(0|p)==(0|(i=i+1|0)))break o;e=d[r+84|0]}if(_=h[r>>2],n=h[r+48>>2],E=h[r+68>>2],o=h[r+44>>2],w=r=h[r+40>>2],t=0,1!=(0|p))for(x=-2&p,T=255&e;a=1|t,g=He(l,(y=h[_>>2])+(g=qr(r,o,T?t:h[E+(t<<2)>>2],0)+n|0)|0,w),A=h[_>>2],T||(a=h[E+(a<<2)>>2]),He(g,(a=qr(r,o,a,0)+n|0)+A|0,w),t=t+2|0,(0|x)!=(0|(c=c+2|0)););if(!(1&p))break a;c=h[_>>2],255&e||(t=h[E+(t<<2)>>2]),He(l,(e=qr(r,o,t,0)+n|0)+c|0,w)}if(e=1^i,!l)break s}ve(l)}else He(o,h[h[r>>2]>>2]+h[r+48>>2]|0,n),e=1;break r;case 3:e=0,N=b=N-16|0,a=(i=s[r+24|0])<<1,p=h[t+80>>2];s:if((0|v(a,p))==(0|n))if((t=4!=h[r+28>>2])|!(e=d[r+84|0])){if(h[b+8>>2]=0,h[b>>2]=0,h[b+4>>2]=0,i){if((0|i)<0)break i;l=mi(a),h[b>>2]=l,St(l,0,i<<1)}o:{a:if(p){if(t){if(!i)for(t=0,c=1;;){if(!ce(r,255&e?t:h[h[r+68>>2]+(t<<2)>>2],s[r+24|0],l))break a;if(c=p>>>0>(t=t+1|0)>>>0,(0|t)==(0|p))break a;e=d[r+84|0]}for(y=-4&i,_=3&i,t=0,E=i-1>>>0<3,c=1,i=0;;){if(!ce(r,255&e?i:h[h[r+68>>2]+(i<<2)>>2],s[r+24|0],l))break a;if(n=0,e=0,c=0,!E)for(;g=e<<1,u[(a=(t<<1)+o|0)>>1]=f[g+l>>1],u[a+2>>1]=f[(2|g)+l>>1],u[a+4>>1]=f[(4|g)+l>>1],u[a+6>>1]=f[(6|g)+l>>1],e=e+4|0,t=t+4|0,(0|y)!=(0|(c=c+4|0)););if(_)for(;u[(t<<1)+o>>1]=f[(e<<1)+l>>1],e=e+1|0,t=t+1|0,(0|_)!=(0|(n=n+1|0)););if((0|p)==(0|(i=i+1|0)))break;c=i>>>0<p>>>0,e=d[r+84|0]}e=i>>>0>=p>>>0;break o}if(y=h[r>>2],n=h[r+48>>2],w=h[r+68>>2],a=h[r+44>>2],T=g=h[r+40>>2],i){for(M=-4&i,E=3&i,t=0,C=255&e,R=i-1>>>0<3,i=0;;){if(_=He(l,(r=h[y>>2])+(e=qr(g,a,C?i:h[w+(i<<2)>>2],0)+n|0)|0,T),c=0,e=0,r=0,!R)for(;A=e<<1,u[(x=(t<<1)+o|0)>>1]=f[A+_>>1],u[x+2>>1]=f[_+(2|A)>>1],u[x+4>>1]=f[_+(4|A)>>1],u[x+6>>1]=f[_+(6|A)>>1],e=e+4|0,t=t+4|0,(0|M)!=(0|(r=r+4|0)););if(E)for(;u[(t<<1)+o>>1]=f[_+(e<<1)>>1],e=e+1|0,t=t+1|0,(0|E)!=(0|(c=c+1|0)););if(e=1,(0|p)==(0|(i=i+1|0)))break}break o}if(t=0,1!=(0|p))for(x=-2&p,_=255&e,i=0;r=1|t,o=He(l,(E=h[y>>2])+(o=qr(g,a,_?t:h[w+(t<<2)>>2],0)+n|0)|0,T),A=h[y>>2],_||(r=h[w+(r<<2)>>2]),He(o,(r=qr(g,a,r,0)+n|0)+A|0,T),t=t+2|0,(0|x)!=(0|(i=i+2|0)););if(!(1&p))break a;r=h[y>>2],255&e||(t=h[w+(t<<2)>>2]),He(l,(e=qr(g,a,t,0)+n|0)+r|0,T)}if(e=!c,!l)break s}ve(l)}else He(o,h[h[r>>2]>>2]+h[r+48>>2]|0,n),e=1;break t;case 5:e=0,N=b=N-16|0,a=(i=s[r+24|0])<<2,p=h[t+80>>2];s:if((0|v(a,p))==(0|n))if((t=6!=h[r+28>>2])|!(e=d[r+84|0])){if(h[b+8>>2]=0,h[b>>2]=0,h[b+4>>2]=0,i){if((0|i)<0)break i;l=mi(a),h[b>>2]=l,St(l,0,i<<2)}o:{a:if(p){if(t){if(!i)for(t=0,c=1;;){if(!de(r,255&e?t:h[h[r+68>>2]+(t<<2)>>2],s[r+24|0],l))break a;if(c=p>>>0>(t=t+1|0)>>>0,(0|t)==(0|p))break a;e=d[r+84|0]}for(y=-4&i,_=3&i,t=0,E=i-1>>>0<3,c=1,i=0;;){if(!de(r,255&e?i:h[h[r+68>>2]+(i<<2)>>2],s[r+24|0],l))break a;if(n=0,e=0,c=0,!E)for(;g=e<<2,h[(a=(t<<2)+o|0)>>2]=h[g+l>>2],h[a+4>>2]=h[(4|g)+l>>2],h[a+8>>2]=h[(8|g)+l>>2],h[a+12>>2]=h[(12|g)+l>>2],e=e+4|0,t=t+4|0,(0|y)!=(0|(c=c+4|0)););if(_)for(;h[(t<<2)+o>>2]=h[(e<<2)+l>>2],e=e+1|0,t=t+1|0,(0|_)!=(0|(n=n+1|0)););if((0|p)==(0|(i=i+1|0)))break;c=i>>>0<p>>>0,e=d[r+84|0]}e=i>>>0>=p>>>0;break o}if(y=h[r>>2],n=h[r+48>>2],w=h[r+68>>2],a=h[r+44>>2],T=g=h[r+40>>2],i){for(M=-4&i,E=3&i,t=0,C=255&e,R=i-1>>>0<3,i=0;;){if(_=He(l,(r=h[y>>2])+(e=qr(g,a,C?i:h[w+(i<<2)>>2],0)+n|0)|0,T),c=0,e=0,r=0,!R)for(;A=e<<2,h[(x=(t<<2)+o|0)>>2]=h[A+_>>2],h[x+4>>2]=h[_+(4|A)>>2],h[x+8>>2]=h[_+(8|A)>>2],h[x+12>>2]=h[_+(12|A)>>2],e=e+4|0,t=t+4|0,(0|M)!=(0|(r=r+4|0)););if(E)for(;h[(t<<2)+o>>2]=h[_+(e<<2)>>2],e=e+1|0,t=t+1|0,(0|E)!=(0|(c=c+1|0)););if(e=1,(0|p)==(0|(i=i+1|0)))break}break o}if(t=0,1!=(0|p))for(x=-2&p,_=255&e,i=0;r=1|t,o=He(l,(E=h[y>>2])+(o=qr(g,a,_?t:h[w+(t<<2)>>2],0)+n|0)|0,T),A=h[y>>2],_||(r=h[w+(r<<2)>>2]),He(o,(r=qr(g,a,r,0)+n|0)+A|0,T),t=t+2|0,(0|x)!=(0|(i=i+2|0)););if(!(1&p))break a;r=h[y>>2],255&e||(t=h[w+(t<<2)>>2]),He(l,(e=qr(g,a,t,0)+n|0)+r|0,T)}if(e=!c,!l)break s}ve(l)}else He(o,h[h[r>>2]>>2]+h[r+48>>2]|0,n),e=1;break t;case 8:break n;default:break e}e=0,N=p=N-16|0,i=(c=s[r+24|0])<<2,g=h[t+80>>2];n:if((0|v(i,g))==(0|n)){n=h[r+28>>2],h[p+8>>2]=0,h[p>>2]=0,h[p+4>>2]=0,t=0;s:{o:{a:{if(c){if((0|c)<0)break a;if(t=mi(i),h[p>>2]=t,a=(c<<2)+t|0,h[p+8>>2]=a,b=1+((i=i-4|0)>>>2|0)&7)for(e=t;h[e>>2]=-1073741824,e=e+4|0,(0|b)!=(0|(l=l+1|0)););else e=t;if(!(i>>>0<28))for(;h[e+24>>2]=-1073741824,h[e+28>>2]=-1073741824,h[e+16>>2]=-1073741824,h[e+20>>2]=-1073741824,h[e+8>>2]=-1073741824,h[e+12>>2]=-1073741824,h[e>>2]=-1073741824,h[e+4>>2]=-1073741824,(0|a)!=(0|(e=e+32|0)););}if(!g)break o;if(9==(0|n)){if(e=0,y=h[r>>2],i=h[r+48>>2],w=h[r+68>>2],T=d[r+84|0],n=h[r+44>>2],x=a=h[r+40>>2],(0|c)<=0){if(1!=(0|g))for(c=-2&g,r=0;o=1|e,l=He(t,(b=h[y>>2])+(l=qr(a,n,T?e:h[w+(e<<2)>>2],0)+i|0)|0,x),b=h[y>>2],T||(o=h[w+(o<<2)>>2]),He(l,(o=qr(a,n,o,0)+i|0)+b|0,x),e=e+2|0,(0|c)!=(0|(r=r+2|0)););if(!(1&g))break o;r=h[y>>2],T||(e=h[w+(e<<2)>>2]),He(t,(e=qr(a,n,e,0)+i|0)+r|0,x);break o}for(C=-4&c,E=3&c,l=0,R=c-1>>>0<3,c=0;;){if(r=He(t,(r=h[y>>2])+(e=qr(a,n,T?c:h[w+(c<<2)>>2],0)+i|0)|0,x),b=0,e=0,M=0,!R)for(;A=e<<2,m[(_=(l<<2)+o|0)>>2]=m[A+r>>2],m[_+4>>2]=m[r+(4|A)>>2],m[_+8>>2]=m[r+(8|A)>>2],m[_+12>>2]=m[r+(12|A)>>2],e=e+4|0,l=l+4|0,(0|C)!=(0|(M=M+4|0)););if(E)for(;m[(l<<2)+o>>2]=m[r+(e<<2)>>2],e=e+1|0,l=l+1|0,(0|E)!=(0|(b=b+1|0)););if(e=1,(0|g)==(0|(c=c+1|0)))break}break s}if(_=1,(0|c)<=0){for(e=0;;){if(!Z(r,d[r+84|0]?e:h[h[r+68>>2]+(e<<2)>>2],s[r+24|0],t))break o;if(_=g>>>0>(e=e+1|0)>>>0,(0|e)==(0|g))break}break o}for(y=-4&c,a=3&c,l=0,E=c-1>>>0<3,c=0;;){if(!Z(r,d[r+84|0]?c:h[h[r+68>>2]+(c<<2)>>2],s[r+24|0],t))break o;if(_=0,e=0,b=0,!E)for(;n=e<<2,m[(i=(l<<2)+o|0)>>2]=m[n+t>>2],m[i+4>>2]=m[(4|n)+t>>2],m[i+8>>2]=m[(8|n)+t>>2],m[i+12>>2]=m[(12|n)+t>>2],e=e+4|0,l=l+4|0,(0|y)!=(0|(b=b+4|0)););if(a)for(;m[(l<<2)+o>>2]=m[(e<<2)+t>>2],e=e+1|0,l=l+1|0,(0|a)!=(0|(_=_+1|0)););if(_=g>>>0>(c=c+1|0)>>>0,(0|c)==(0|g))break}e=c>>>0>=g>>>0;break s}vn(),S()}if(e=1^_,!t)break n}ve(t)}N=p+16|0,l=1&e;break e}vn(),S()}N=b+16|0,l=1&e;break e}N=b+16|0,l=1&e}return 0|l},jb:function(e,t){e|=0,t|=0;var r,i=0,n=0,o=0,a=0,l=0,c=0,u=0,f=0,m=0,g=0,v=0,_=0,b=0,y=0,E=0,w=0,x=0,A=0,T=0;N=r=N-16|0,h[r+12>>2]=t,t=mi(32),h[r>>2]=t,h[r+4>>2]=24,h[r+8>>2]=-2147483616,s[t+24|0]=0,i=d[1318]|d[1319]<<8|d[1320]<<16|d[1321]<<24,n=d[1314]|d[1315]<<8|d[1316]<<16|d[1317]<<24,s[t+16|0]=n,s[t+17|0]=n>>>8,s[t+18|0]=n>>>16,s[t+19|0]=n>>>24,s[t+20|0]=i,s[t+21|0]=i>>>8,s[t+22|0]=i>>>16,s[t+23|0]=i>>>24,i=d[1310]|d[1311]<<8|d[1312]<<16|d[1313]<<24,n=d[1306]|d[1307]<<8|d[1308]<<16|d[1309]<<24,s[t+8|0]=n,s[t+9|0]=n>>>8,s[t+10|0]=n>>>16,s[t+11|0]=n>>>24,s[t+12|0]=i,s[t+13|0]=i>>>8,s[t+14|0]=i>>>16,s[t+15|0]=i>>>24,i=d[1302]|d[1303]<<8|d[1304]<<16|d[1305]<<24,n=d[1298]|d[1299]<<8|d[1300]<<16|d[1301]<<24,s[0|t]=n,s[t+1|0]=n>>>8,s[t+2|0]=n>>>16,s[t+3|0]=n>>>24,s[t+4|0]=i,s[t+5|0]=i>>>8,s[t+6|0]=i>>>16,s[t+7|0]=i>>>24,N=c=N-48|0,m=e;e:{if(e=h[(i=e+16|0)>>2]){for(n=h[r+12>>2],t=i;t=(a=(0|n)>h[e+16>>2])?t:e,e=h[(a<<2)+e>>2];);if((0|t)!=(0|i)&&(0|n)>=h[t+16>>2])break e}if(h[4+(e=x=c+24|0)>>2]=0,h[e+8>>2]=0,A=e+4|0,h[e>>2]=A,e=h[r+12>>2],h[(n=c+16|0)>>2]=0,h[n+4>>2]=0,h[c+8>>2]=e,h[c+12>>2]=n,(0|A)!=(0|(t=h[x>>2])))for(g=c+8|4;;){a=t,l=t+16|0,N=y=N-16|0,u=y+12|0,e=y+8|0;t:{r:{i:{n:{s:{o:{a:if((0|(E=g+4|0))!=(0|n))if(o=(t=d[n+27|0])<<24>>24<0,f=(0|(T=(v=d[l+11|0])<<24>>24))<0,b=(_=(t=o?h[n+20>>2]:t)>>>0<(v=f?h[l+4>>2]:v)>>>0)?t:v){if(w=n+16|0,!(w=Sr(f=f?h[l>>2]:l,o=o?h[w>>2]:w,b))){if(t>>>0>v>>>0)break a;break o}if((0|w)>=0)break o}else if(t>>>0<=v>>>0)break s;o=h[n>>2];a:{l:if((0|(e=n))!=h[g>>2]){if(o)for(t=o;e=t,t=h[t+4>>2];);else{if(e=n+8|0,(0|n)==h[h[n+8>>2]>>2])for(;e=(t=h[e>>2])+8|0,(0|t)==h[h[t+8>>2]>>2];);e=h[e>>2]}if(t=(f=d[l+11|0])<<24>>24<0,v=(_=d[e+27|0])<<24>>24<0,!((b=(f=t?h[l+4>>2]:f)>>>0<(_=v?h[e+20>>2]:_)>>>0?f:_)&&(E=e+16|0,t=Sr(v?h[E>>2]:E,t?h[l>>2]:l,b)))){if(f>>>0>_>>>0)break l;break a}if((0|t)>=0)break a}if(!o){h[u>>2]=n,e=n;break t}h[u>>2]=e,e=e+4|0;break t}e=Lt(g,u,l);break t}if(t=Sr(o,f,b))break n}if(_)break i;break r}if((0|t)>=0)break r}if(o=h[n+4>>2])for(t=o;e=t,t=h[t>>2];);else if(e=h[n+8>>2],(0|n)!=h[e>>2])for(t=n+8|0;t=(f=h[t>>2])+8|0,e=h[f+8>>2],(0|f)!=h[e>>2];);i:{n:if((0|e)!=(0|E)){if(!((_=(f=(t=(f=d[e+27|0])<<24>>24<0)?h[e+20>>2]:f)>>>0<v>>>0?f:v)&&(b=e+16|0,t=Sr((0|T)<0?h[l>>2]:l,t?h[b>>2]:b,_)))){if(f>>>0>v>>>0)break n;break i}if((0|t)>=0)break i}if(!o){h[u>>2]=n,e=n+4|0;break t}h[u>>2]=e;break t}e=Lt(g,u,l);break t}h[u>>2]=n,h[e>>2]=n}(e=h[(t=e)>>2])?t=0:(o=(e=mi(40))+16|0,s[l+11|0]>=0?(u=h[l+4>>2],h[o>>2]=h[l>>2],h[o+4>>2]=u,h[o+8>>2]=h[l+8>>2]):Ur(o,h[l>>2],h[l+4>>2]),o=e+28|0,s[l+23|0]>=0?(u=h[l+16>>2],h[o>>2]=h[l+12>>2],h[o+4>>2]=u,h[o+8>>2]=h[l+20>>2]):Ur(o,h[l+12>>2],h[l+16>>2]),h[e+8>>2]=h[y+12>>2],h[e>>2]=0,h[e+4>>2]=0,h[t>>2]=e,(o=h[h[g>>2]>>2])?(h[g>>2]=o,t=h[t>>2]):t=e,Je(h[g+4>>2],t),h[g+8>>2]=h[g+8>>2]+1,t=1),s[c+44|0]=t,h[c+40>>2]=e,N=y+16|0;t:if(e=h[a+4>>2])for(;e=h[(t=e)>>2];);else{if(t=h[a+8>>2],(0|a)==h[t>>2])break t;for(e=a+8|0;e=(a=h[e>>2])+8|0,t=h[a+8>>2],(0|a)!=h[t>>2];);}if((0|t)==(0|A))break}t:{if(e=h[i>>2])for(i=m+16|0,a=h[c+8>>2];;){r:{if((0|(t=h[e+16>>2]))>(0|a)){if(t=h[e>>2])break r;i=e;break t}if((0|t)>=(0|a))break t;if(i=e+4|0,!(t=h[e+4>>2]))break t;e=i}i=e,e=t}e=i}(t=h[i>>2])||(t=mi(32),h[t+16>>2]=h[c+8>>2],h[t+20>>2]=h[c+12>>2],a=t+24|0,o=h[c+16>>2],h[a>>2]=o,l=h[c+20>>2],h[t+28>>2]=l,l?(h[o+8>>2]=a,h[c+16>>2]=0,h[c+20>>2]=0,h[c+12>>2]=n):h[t+20>>2]=a,h[t+8>>2]=e,h[t>>2]=0,h[t+4>>2]=0,h[i>>2]=t,(e=h[h[m+12>>2]>>2])?(h[m+12>>2]=e,e=h[i>>2]):e=t,Je(h[m+16>>2],e),h[m+20>>2]=h[m+20>>2]+1),gi(c+8|4,h[c+16>>2]),gi(x,h[x+4>>2])}if(N=n=(N=m=(N=c+48|0)-48|0)-32|0,(0|(a=(i=l=n+32|0)-(e=n+21|0)|0))<=9&(0|a)<(1-(p[3720]>1)|0)?(h[n+8>>2]=i,i=61):(s[0|e]=49,h[n+8>>2]=e+1,i=0),h[n+12>>2]=i,i=m+8|0,N=o=(N=c=N-16|0)-16|0,(a=(g=h[n+8>>2])-e|0)>>>0<=4294967279){for(a>>>0<=10?(s[i+11|0]=a,n=i):(n=a>>>0>=11?11==(0|(n=(u=a+16&-16)-1|0))?u:n:10,n=mi(u=n+1|0),h[i>>2]=n,h[i+8>>2]=-2147483648|u,h[i+4>>2]=a);(0|e)!=(0|g);)s[0|n]=d[0|e],n=n+1|0,e=e+1|0;s[o+15|0]=0,s[0|n]=d[o+15|0],N=o+16|0}else mn(),S();N=c+16|0,N=l,h[m+32>>2]=r;e:{t:{if(e=h[4+(n=t+20|0)>>2])for(o=(i=(t=d[r+11|0])<<24>>24<0)?h[r>>2]:r,a=i?h[r+4>>2]:t,t=n+4|0;;){r:{i:{n:{s:{o:{a:if(g=(c=(i=(l=(i=d[e+27|0])<<24>>24<0)?h[e+20>>2]:i)>>>0<a>>>0)?i:a){if(u=e+16|0,!(u=Sr(o,l=l?h[u>>2]:u,g))){if(i>>>0>a>>>0)break a;break o}if((0|u)>=0)break o}else if(i>>>0<=a>>>0)break s;if(i=h[e>>2])break r;break t}if(i=Sr(l,o,g))break n}if(c)break i;break e}if((0|i)>=0)break e}if(t=e+4|0,!(i=h[e+4>>2]))break e;e=t}t=e,e=i}e=n+4|0}t=e}(i=h[t>>2])?e=0:(o=(i=mi(40))+16|0,a=h[m+32>>2],s[a+11|0]>=0?(l=h[a+4>>2],h[o>>2]=h[a>>2],h[o+4>>2]=l,h[o+8>>2]=h[a+8>>2]):Ur(o,h[a>>2],h[a+4>>2]),h[i+8>>2]=e,h[i>>2]=0,h[i+4>>2]=0,h[i+36>>2]=0,h[i+28>>2]=0,h[i+32>>2]=0,h[t>>2]=i,(e=h[h[n>>2]>>2])?(h[n>>2]=e,e=h[t>>2]):e=i,Je(h[n+4>>2],e),h[n+8>>2]=h[n+8>>2]+1,e=1),s[m+44|0]=e,h[m+40>>2]=i,e=h[m+40>>2],s[e+39|0]<0&&ve(h[e+28>>2]),t=h[m+12>>2],h[e+28>>2]=h[m+8>>2],h[e+32>>2]=t,h[e+36>>2]=h[m+16>>2],N=m+48|0,s[r+11|0]<0&&ve(h[r>>2]),N=r+16|0},kb:function(e,t){e|=0;var r,i,n=0,o=0;o=8+(i=N-32|0)|0,N=r=(N=i)-80|0,e=h[36+(t|=0)>>2],h[r+72>>2]=h[t+32>>2],h[r+76>>2]=e,n=h[t+28>>2],h[(e=r- -64|0)>>2]=h[t+24>>2],h[e+4>>2]=n,e=h[t+20>>2],h[r+56>>2]=h[t+16>>2],h[r+60>>2]=e,e=h[t+12>>2],h[r+48>>2]=h[t+8>>2],h[r+52>>2]=e,e=h[t+4>>2],h[r+40>>2]=h[t>>2],h[r+44>>2]=e,ue(r+8|0,r+40|0,r+24|0);e:if(e=h[r+8>>2]){if(h[o>>2]=e,e=o+4|0,s[r+23|0]>=0){o=h[4+(t=r+8|4)>>2],h[e>>2]=h[t>>2],h[e+4>>2]=o,h[e+8>>2]=h[t+8>>2];break e}if(Ur(e,h[r+12>>2],h[r+16>>2]),s[r+23|0]>=0)break e;ve(h[r+12>>2])}else s[r+23|0]<0&&ve(h[r+12>>2]),(e=d[r+31|0])>>>0>=2?(e=mi(32),t=d[1621]|d[1622]<<8,s[e+24|0]=t,s[e+25|0]=t>>>8,t=d[1617]|d[1618]<<8|d[1619]<<16|d[1620]<<24,n=d[1613]|d[1614]<<8|d[1615]<<16|d[1616]<<24,s[e+16|0]=n,s[e+17|0]=n>>>8,s[e+18|0]=n>>>16,s[e+19|0]=n>>>24,s[e+20|0]=t,s[e+21|0]=t>>>8,s[e+22|0]=t>>>16,s[e+23|0]=t>>>24,t=d[1609]|d[1610]<<8|d[1611]<<16|d[1612]<<24,n=d[1605]|d[1606]<<8|d[1607]<<16|d[1608]<<24,s[e+8|0]=n,s[e+9|0]=n>>>8,s[e+10|0]=n>>>16,s[e+11|0]=n>>>24,s[e+12|0]=t,s[e+13|0]=t>>>8,s[e+14|0]=t>>>16,s[e+15|0]=t>>>24,t=d[1601]|d[1602]<<8|d[1603]<<16|d[1604]<<24,n=d[1597]|d[1598]<<8|d[1599]<<16|d[1600]<<24,s[0|e]=n,s[e+1|0]=n>>>8,s[e+2|0]=n>>>16,s[e+3|0]=n>>>24,s[e+4|0]=t,s[e+5|0]=t>>>8,s[e+6|0]=t>>>16,s[e+7|0]=t>>>24,s[e+26|0]=0,h[r+8>>2]=-1,Ur(t=r+8|4,e,26),n=s[r+23|0],h[o>>2]=h[r+8>>2],o=o+4|0,(0|n)>=0?(n=h[t+4>>2],h[o>>2]=h[t>>2],h[o+4>>2]=n,h[o+8>>2]=h[t+8>>2]):Ur(o,h[r+12>>2],h[r+16>>2]),s[r+23|0]<0&&ve(h[r+12>>2]),ve(e)):(h[o>>2]=0,h[o+4>>2]=0,h[o+16>>2]=e,h[o+8>>2]=0,h[o+12>>2]=0);return N=r+80|0,e=h[i+24>>2],s[i+23|0]<0&&ve(h[i+12>>2]),N=i+32|0,0|e},lb:function(e,t,r){var i,n,o=0;N=i=N-16|0,fe(i,e|=0,t|=0,r|=0),h[e+24>>2]=h[i>>2];e:if((0|(n=e+24|0))!=(0|i))if(t=4|i,r=(o=d[i+15|0])<<24>>24,s[11+(e=e+28|0)|0]>=0){if((0|r)>=0){r=h[t+4>>2],h[e>>2]=h[t>>2],h[e+4>>2]=r,h[e+8>>2]=h[t+8>>2];break e}ri(e,h[i+4>>2],h[i+8>>2])}else Yr(e,(e=(0|r)<0)?h[i+4>>2]:t,e?h[i+8>>2]:o);return s[i+15|0]<0&&ve(h[i+4>>2]),N=i+16|0,0|n},mb:function(e,t,r){var i,n,o=0;N=i=N-16|0,Ee(i,e|=0,t|=0,r|=0),h[e+24>>2]=h[i>>2];e:if((0|(n=e+24|0))!=(0|i))if(t=4|i,r=(o=d[i+15|0])<<24>>24,s[11+(e=e+28|0)|0]>=0){if((0|r)>=0){r=h[t+4>>2],h[e>>2]=h[t>>2],h[e+4>>2]=r,h[e+8>>2]=h[t+8>>2];break e}ri(e,h[i+4>>2],h[i+8>>2])}else Yr(e,(e=(0|r)<0)?h[i+4>>2]:t,e?h[i+8>>2]:o);return s[i+15|0]<0&&ve(h[i+4>>2]),N=i+16|0,0|n},nb:function(e){(e|=0)&&(s[e+39|0]<0&&ve(h[e+28>>2]),Ri(e+12|0,h[e+16>>2]),gi(e,h[e+4>>2]),ve(e))},ob:yn,pb:wn,qb:En,rb:xn,sb:yn,tb:wn,ub:En,vb:xn,wb:_n,xb:bn,yb:yn,zb:wn,Ab:En,Bb:wn,Cb:En,Db:xn,Eb:_n,Fb:bn,Gb:function(){return 5},Hb:function(){return 6},Ib:function(){return 7},Jb:function(){return 8},Kb:function(){return 9},Lb:function(){return 10},Mb:function(){return 11},Nb:function(){return 12},Ob:wn,Pb:yn,Qb:function(){return-2},Rb:function(){return-3},Sb:function(){return-4},Tb:function(){return-5},Ub:V,Vb:ve}}(e)}(ue)},instantiate:function(e,t){return{then:function(t){var r=new M.Module(e);t({instance:new M.Instance(r)})}}},RuntimeError:Error};x=[],"object"!=typeof M&&q("no native wasm support detected");var C=!1;function R(e,t){e||q(t)}var I,O,P,k,L="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function N(e,t,r){for(var i=t+r,n=t;e[n]&&!(n>=i);)++n;if(n-t>16&&e.subarray&&L)return L.decode(e.subarray(t,n));for(var s="";t<n;){var o=e[t++];if(128&o){var a=63&e[t++];if(192!=(224&o)){var l=63&e[t++];if((o=224==(240&o)?(15&o)<<12|a<<6|l:(7&o)<<18|a<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(o);else{var c=o-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&o)<<6|a)}else s+=String.fromCharCode(o)}return s}function G(e,t){return e?N(P,e,t):""}function D(e){I=e,a.HEAP8=O=new Int8Array(e),a.HEAP16=new Int16Array(e),a.HEAP32=k=new Int32Array(e),a.HEAPU8=P=new Uint8Array(e),a.HEAPU16=new Uint16Array(e),a.HEAPU32=new Uint32Array(e),a.HEAPF32=new Float32Array(e),a.HEAPF64=new Float64Array(e)}var U,V=a.INITIAL_MEMORY||16777216;(S=a.wasmMemory?a.wasmMemory:new M.Memory({initial:V/65536,maximum:32768}))&&(I=S.buffer),V=I.byteLength,D(I);var B=[],F=[],j=[],z=!1;function W(e){F.unshift(e)}var H=0,$=null,Y=null;function q(e){a.onAbort&&a.onAbort(e),T(e="Aborted("+e+")"),C=!0,e+=". Build with -s ASSERTIONS=1 for more info.";var t=new M.RuntimeError(e);throw i(t),t}a.preloadedImages={},a.preloadedAudios={};var X,Z,J="data:application/octet-stream;base64,";function K(e){return e.startsWith(J)}function Q(e){return e.startsWith("file://")}function ee(e){try{if(e==X&&x)return new Uint8Array(x);var t=le(e);if(t)return t;if(f)return f(e);throw"both async and sync fetching of the wasm failed"}catch(e){q(e)}}function te(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var r=t.func;"number"==typeof r?void 0===t.arg?ie(r)():ie(r)(t.arg):r(void 0===t.arg?null:t.arg)}else t(a)}}K(X="draco_decoder.wasm")||(Z=X,X=a.locateFile?a.locateFile(Z,w):w+Z);var re=[];function ie(e){var t=re[e];return t||(e>=re.length&&(re.length=e+1),re[e]=t=U.get(e)),t}function ne(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(e){k[this.ptr+4>>2]=e},this.get_type=function(){return k[this.ptr+4>>2]},this.set_destructor=function(e){k[this.ptr+8>>2]=e},this.get_destructor=function(){return k[this.ptr+8>>2]},this.set_refcount=function(e){k[this.ptr>>2]=e},this.set_caught=function(e){e=e?1:0,O[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=O[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,O[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=O[this.ptr+13>>0]},this.init=function(e,t){this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=k[this.ptr>>2];k[this.ptr>>2]=e+1},this.release_ref=function(){var e=k[this.ptr>>2];return k[this.ptr>>2]=e-1,1===e}}function se(e){try{return S.grow(e-I.byteLength+65535>>>16),D(S.buffer),1}catch(e){}}var oe={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var r=oe.buffers[e];0===t||10===t?((1===e?A:T)(N(r,0)),r.length=0):r.push(t)},varargs:void 0,get:function(){return oe.varargs+=4,k[oe.varargs-4>>2]},getStr:function(e){return G(e)},get64:function(e,t){return e}},ae="function"==typeof atob?atob:function(e){var t,r,i,n,s,o,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",c=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{t=a.indexOf(e.charAt(c++))<<2|(n=a.indexOf(e.charAt(c++)))>>4,r=(15&n)<<4|(s=a.indexOf(e.charAt(c++)))>>2,i=(3&s)<<6|(o=a.indexOf(e.charAt(c++))),l+=String.fromCharCode(t),64!==s&&(l+=String.fromCharCode(r)),64!==o&&(l+=String.fromCharCode(i))}while(c<e.length);return l};function le(e){if(K(e))return function(e){if("boolean"==typeof E&&E){var t=o.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}try{for(var r=ae(e),i=new Uint8Array(r.length),n=0;n<r.length;++n)i[n]=r.charCodeAt(n);return i}catch(e){throw new Error("Converting base64 string to bytes failed.")}}(e.slice(J.length))}var ce,ue={i:function(e){return $r(e+16)+16},h:function(e,t,r){throw new ne(e).init(t,r),e},b:function(){q("")},g:function(e,t,r){P.copyWithin(e,t,t+r)},e:function(e){var t,r,i=P.length,n=2147483648;if((e>>>=0)>n)return!1;for(var s=1;s<=4;s*=2){var o=i*(1+.2/s);if(o=Math.min(o,e+100663296),se(Math.min(n,((t=Math.max(e,o))%(r=65536)>0&&(t+=r-t%r),t))))return!0}return!1},f:function(e){return 0},d:function(e,t,r,i,n){},c:function(e,t,r,i){for(var n=0,s=0;s<r;s++){var o=k[t>>2],a=k[t+4>>2];t+=8;for(var l=0;l<a;l++)oe.printChar(e,P[o+l]);n+=a}return k[i>>2]=n,0},a:S},he=(function(){var e={a:ue};function t(e,t){var r=e.exports;a.asm=r,U=a.asm.k,W(a.asm.j),function(e){if(H--,a.monitorRunDependencies&&a.monitorRunDependencies(H),0==H&&(null!==$&&(clearInterval($),$=null),Y)){var t=Y;Y=null,t()}}()}function r(e){t(e.instance)}function n(t){return function(){if(!x&&(b||y)){if("function"==typeof fetch&&!Q(X))return fetch(X,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+X+"'";return e.arrayBuffer()})).catch((function(){return ee(X)}));if(d)return new Promise((function(e,t){d(X,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ee(X)}))}().then((function(t){return M.instantiate(t,e)})).then((function(e){return e})).then(t,(function(e){T("failed to asynchronously prepare wasm: "+e),q(e)}))}if(H++,a.monitorRunDependencies&&a.monitorRunDependencies(H),a.instantiateWasm)try{return a.instantiateWasm(e,t)}catch(e){return T("Module.instantiateWasm callback failed with error: "+e),!1}(x||"function"!=typeof M.instantiateStreaming||K(X)||Q(X)||"function"!=typeof fetch?n(r):fetch(X,{credentials:"same-origin"}).then((function(t){return M.instantiateStreaming(t,e).then(r,(function(e){return T("wasm streaming compile failed: "+e),T("falling back to ArrayBuffer instantiation"),n(r)}))}))).catch(i)}(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.j).apply(null,arguments)},a._emscripten_bind_VoidPtr___destroy___0=function(){return(he=a._emscripten_bind_VoidPtr___destroy___0=a.asm.l).apply(null,arguments)}),de=a._emscripten_bind_DecoderBuffer_DecoderBuffer_0=function(){return(de=a._emscripten_bind_DecoderBuffer_DecoderBuffer_0=a.asm.m).apply(null,arguments)},fe=a._emscripten_bind_DecoderBuffer_Init_2=function(){return(fe=a._emscripten_bind_DecoderBuffer_Init_2=a.asm.n).apply(null,arguments)},pe=a._emscripten_bind_DecoderBuffer___destroy___0=function(){return(pe=a._emscripten_bind_DecoderBuffer___destroy___0=a.asm.o).apply(null,arguments)},me=a._emscripten_bind_AttributeTransformData_AttributeTransformData_0=function(){return(me=a._emscripten_bind_AttributeTransformData_AttributeTransformData_0=a.asm.p).apply(null,arguments)},ge=a._emscripten_bind_AttributeTransformData_transform_type_0=function(){return(ge=a._emscripten_bind_AttributeTransformData_transform_type_0=a.asm.q).apply(null,arguments)},ve=a._emscripten_bind_AttributeTransformData___destroy___0=function(){return(ve=a._emscripten_bind_AttributeTransformData___destroy___0=a.asm.r).apply(null,arguments)},_e=a._emscripten_bind_GeometryAttribute_GeometryAttribute_0=function(){return(_e=a._emscripten_bind_GeometryAttribute_GeometryAttribute_0=a.asm.s).apply(null,arguments)},be=a._emscripten_bind_GeometryAttribute___destroy___0=function(){return(be=a._emscripten_bind_GeometryAttribute___destroy___0=a.asm.t).apply(null,arguments)},ye=a._emscripten_bind_PointAttribute_PointAttribute_0=function(){return(ye=a._emscripten_bind_PointAttribute_PointAttribute_0=a.asm.u).apply(null,arguments)},Ee=a._emscripten_bind_PointAttribute_size_0=function(){return(Ee=a._emscripten_bind_PointAttribute_size_0=a.asm.v).apply(null,arguments)},we=a._emscripten_bind_PointAttribute_GetAttributeTransformData_0=function(){return(we=a._emscripten_bind_PointAttribute_GetAttributeTransformData_0=a.asm.w).apply(null,arguments)},xe=a._emscripten_bind_PointAttribute_attribute_type_0=function(){return(xe=a._emscripten_bind_PointAttribute_attribute_type_0=a.asm.x).apply(null,arguments)},Ae=a._emscripten_bind_PointAttribute_data_type_0=function(){return(Ae=a._emscripten_bind_PointAttribute_data_type_0=a.asm.y).apply(null,arguments)},Te=a._emscripten_bind_PointAttribute_num_components_0=function(){return(Te=a._emscripten_bind_PointAttribute_num_components_0=a.asm.z).apply(null,arguments)},Se=a._emscripten_bind_PointAttribute_normalized_0=function(){return(Se=a._emscripten_bind_PointAttribute_normalized_0=a.asm.A).apply(null,arguments)},Me=a._emscripten_bind_PointAttribute_byte_stride_0=function(){return(Me=a._emscripten_bind_PointAttribute_byte_stride_0=a.asm.B).apply(null,arguments)},Ce=a._emscripten_bind_PointAttribute_byte_offset_0=function(){return(Ce=a._emscripten_bind_PointAttribute_byte_offset_0=a.asm.C).apply(null,arguments)},Re=a._emscripten_bind_PointAttribute_unique_id_0=function(){return(Re=a._emscripten_bind_PointAttribute_unique_id_0=a.asm.D).apply(null,arguments)},Ie=a._emscripten_bind_PointAttribute___destroy___0=function(){return(Ie=a._emscripten_bind_PointAttribute___destroy___0=a.asm.E).apply(null,arguments)},Oe=a._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=function(){return(Oe=a._emscripten_bind_AttributeQuantizationTransform_AttributeQuantizationTransform_0=a.asm.F).apply(null,arguments)},Pe=a._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=function(){return(Pe=a._emscripten_bind_AttributeQuantizationTransform_InitFromAttribute_1=a.asm.G).apply(null,arguments)},ke=a._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=function(){return(ke=a._emscripten_bind_AttributeQuantizationTransform_quantization_bits_0=a.asm.H).apply(null,arguments)},Le=a._emscripten_bind_AttributeQuantizationTransform_min_value_1=function(){return(Le=a._emscripten_bind_AttributeQuantizationTransform_min_value_1=a.asm.I).apply(null,arguments)},Ne=a._emscripten_bind_AttributeQuantizationTransform_range_0=function(){return(Ne=a._emscripten_bind_AttributeQuantizationTransform_range_0=a.asm.J).apply(null,arguments)},Ge=a._emscripten_bind_AttributeQuantizationTransform___destroy___0=function(){return(Ge=a._emscripten_bind_AttributeQuantizationTransform___destroy___0=a.asm.K).apply(null,arguments)},De=a._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=function(){return(De=a._emscripten_bind_AttributeOctahedronTransform_AttributeOctahedronTransform_0=a.asm.L).apply(null,arguments)},Ue=a._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=function(){return(Ue=a._emscripten_bind_AttributeOctahedronTransform_InitFromAttribute_1=a.asm.M).apply(null,arguments)},Ve=a._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=function(){return(Ve=a._emscripten_bind_AttributeOctahedronTransform_quantization_bits_0=a.asm.N).apply(null,arguments)},Be=a._emscripten_bind_AttributeOctahedronTransform___destroy___0=function(){return(Be=a._emscripten_bind_AttributeOctahedronTransform___destroy___0=a.asm.O).apply(null,arguments)},Fe=a._emscripten_bind_PointCloud_PointCloud_0=function(){return(Fe=a._emscripten_bind_PointCloud_PointCloud_0=a.asm.P).apply(null,arguments)},je=a._emscripten_bind_PointCloud_num_attributes_0=function(){return(je=a._emscripten_bind_PointCloud_num_attributes_0=a.asm.Q).apply(null,arguments)},ze=a._emscripten_bind_PointCloud_num_points_0=function(){return(ze=a._emscripten_bind_PointCloud_num_points_0=a.asm.R).apply(null,arguments)},We=a._emscripten_bind_PointCloud___destroy___0=function(){return(We=a._emscripten_bind_PointCloud___destroy___0=a.asm.S).apply(null,arguments)},He=a._emscripten_bind_Mesh_Mesh_0=function(){return(He=a._emscripten_bind_Mesh_Mesh_0=a.asm.T).apply(null,arguments)},$e=a._emscripten_bind_Mesh_num_faces_0=function(){return($e=a._emscripten_bind_Mesh_num_faces_0=a.asm.U).apply(null,arguments)},Ye=a._emscripten_bind_Mesh_num_attributes_0=function(){return(Ye=a._emscripten_bind_Mesh_num_attributes_0=a.asm.V).apply(null,arguments)},qe=a._emscripten_bind_Mesh_num_points_0=function(){return(qe=a._emscripten_bind_Mesh_num_points_0=a.asm.W).apply(null,arguments)},Xe=a._emscripten_bind_Mesh___destroy___0=function(){return(Xe=a._emscripten_bind_Mesh___destroy___0=a.asm.X).apply(null,arguments)},Ze=a._emscripten_bind_Metadata_Metadata_0=function(){return(Ze=a._emscripten_bind_Metadata_Metadata_0=a.asm.Y).apply(null,arguments)},Je=a._emscripten_bind_Metadata___destroy___0=function(){return(Je=a._emscripten_bind_Metadata___destroy___0=a.asm.Z).apply(null,arguments)},Ke=a._emscripten_bind_Status_code_0=function(){return(Ke=a._emscripten_bind_Status_code_0=a.asm._).apply(null,arguments)},Qe=a._emscripten_bind_Status_ok_0=function(){return(Qe=a._emscripten_bind_Status_ok_0=a.asm.$).apply(null,arguments)},et=a._emscripten_bind_Status_error_msg_0=function(){return(et=a._emscripten_bind_Status_error_msg_0=a.asm.aa).apply(null,arguments)},tt=a._emscripten_bind_Status___destroy___0=function(){return(tt=a._emscripten_bind_Status___destroy___0=a.asm.ba).apply(null,arguments)},rt=a._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=function(){return(rt=a._emscripten_bind_DracoFloat32Array_DracoFloat32Array_0=a.asm.ca).apply(null,arguments)},it=a._emscripten_bind_DracoFloat32Array_GetValue_1=function(){return(it=a._emscripten_bind_DracoFloat32Array_GetValue_1=a.asm.da).apply(null,arguments)},nt=a._emscripten_bind_DracoFloat32Array_size_0=function(){return(nt=a._emscripten_bind_DracoFloat32Array_size_0=a.asm.ea).apply(null,arguments)},st=a._emscripten_bind_DracoFloat32Array___destroy___0=function(){return(st=a._emscripten_bind_DracoFloat32Array___destroy___0=a.asm.fa).apply(null,arguments)},ot=a._emscripten_bind_DracoInt8Array_DracoInt8Array_0=function(){return(ot=a._emscripten_bind_DracoInt8Array_DracoInt8Array_0=a.asm.ga).apply(null,arguments)},at=a._emscripten_bind_DracoInt8Array_GetValue_1=function(){return(at=a._emscripten_bind_DracoInt8Array_GetValue_1=a.asm.ha).apply(null,arguments)},lt=a._emscripten_bind_DracoInt8Array_size_0=function(){return(lt=a._emscripten_bind_DracoInt8Array_size_0=a.asm.ia).apply(null,arguments)},ct=a._emscripten_bind_DracoInt8Array___destroy___0=function(){return(ct=a._emscripten_bind_DracoInt8Array___destroy___0=a.asm.ja).apply(null,arguments)},ut=a._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=function(){return(ut=a._emscripten_bind_DracoUInt8Array_DracoUInt8Array_0=a.asm.ka).apply(null,arguments)},ht=a._emscripten_bind_DracoUInt8Array_GetValue_1=function(){return(ht=a._emscripten_bind_DracoUInt8Array_GetValue_1=a.asm.la).apply(null,arguments)},dt=a._emscripten_bind_DracoUInt8Array_size_0=function(){return(dt=a._emscripten_bind_DracoUInt8Array_size_0=a.asm.ma).apply(null,arguments)},ft=a._emscripten_bind_DracoUInt8Array___destroy___0=function(){return(ft=a._emscripten_bind_DracoUInt8Array___destroy___0=a.asm.na).apply(null,arguments)},pt=a._emscripten_bind_DracoInt16Array_DracoInt16Array_0=function(){return(pt=a._emscripten_bind_DracoInt16Array_DracoInt16Array_0=a.asm.oa).apply(null,arguments)},mt=a._emscripten_bind_DracoInt16Array_GetValue_1=function(){return(mt=a._emscripten_bind_DracoInt16Array_GetValue_1=a.asm.pa).apply(null,arguments)},gt=a._emscripten_bind_DracoInt16Array_size_0=function(){return(gt=a._emscripten_bind_DracoInt16Array_size_0=a.asm.qa).apply(null,arguments)},vt=a._emscripten_bind_DracoInt16Array___destroy___0=function(){return(vt=a._emscripten_bind_DracoInt16Array___destroy___0=a.asm.ra).apply(null,arguments)},_t=a._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=function(){return(_t=a._emscripten_bind_DracoUInt16Array_DracoUInt16Array_0=a.asm.sa).apply(null,arguments)},bt=a._emscripten_bind_DracoUInt16Array_GetValue_1=function(){return(bt=a._emscripten_bind_DracoUInt16Array_GetValue_1=a.asm.ta).apply(null,arguments)},yt=a._emscripten_bind_DracoUInt16Array_size_0=function(){return(yt=a._emscripten_bind_DracoUInt16Array_size_0=a.asm.ua).apply(null,arguments)},Et=a._emscripten_bind_DracoUInt16Array___destroy___0=function(){return(Et=a._emscripten_bind_DracoUInt16Array___destroy___0=a.asm.va).apply(null,arguments)},wt=a._emscripten_bind_DracoInt32Array_DracoInt32Array_0=function(){return(wt=a._emscripten_bind_DracoInt32Array_DracoInt32Array_0=a.asm.wa).apply(null,arguments)},xt=a._emscripten_bind_DracoInt32Array_GetValue_1=function(){return(xt=a._emscripten_bind_DracoInt32Array_GetValue_1=a.asm.xa).apply(null,arguments)},At=a._emscripten_bind_DracoInt32Array_size_0=function(){return(At=a._emscripten_bind_DracoInt32Array_size_0=a.asm.ya).apply(null,arguments)},Tt=a._emscripten_bind_DracoInt32Array___destroy___0=function(){return(Tt=a._emscripten_bind_DracoInt32Array___destroy___0=a.asm.za).apply(null,arguments)},St=a._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=function(){return(St=a._emscripten_bind_DracoUInt32Array_DracoUInt32Array_0=a.asm.Aa).apply(null,arguments)},Mt=a._emscripten_bind_DracoUInt32Array_GetValue_1=function(){return(Mt=a._emscripten_bind_DracoUInt32Array_GetValue_1=a.asm.Ba).apply(null,arguments)},Ct=a._emscripten_bind_DracoUInt32Array_size_0=function(){return(Ct=a._emscripten_bind_DracoUInt32Array_size_0=a.asm.Ca).apply(null,arguments)},Rt=a._emscripten_bind_DracoUInt32Array___destroy___0=function(){return(Rt=a._emscripten_bind_DracoUInt32Array___destroy___0=a.asm.Da).apply(null,arguments)},It=a._emscripten_bind_MetadataQuerier_MetadataQuerier_0=function(){return(It=a._emscripten_bind_MetadataQuerier_MetadataQuerier_0=a.asm.Ea).apply(null,arguments)},Ot=a._emscripten_bind_MetadataQuerier_HasEntry_2=function(){return(Ot=a._emscripten_bind_MetadataQuerier_HasEntry_2=a.asm.Fa).apply(null,arguments)},Pt=a._emscripten_bind_MetadataQuerier_GetIntEntry_2=function(){return(Pt=a._emscripten_bind_MetadataQuerier_GetIntEntry_2=a.asm.Ga).apply(null,arguments)},kt=a._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=function(){return(kt=a._emscripten_bind_MetadataQuerier_GetIntEntryArray_3=a.asm.Ha).apply(null,arguments)},Lt=a._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=function(){return(Lt=a._emscripten_bind_MetadataQuerier_GetDoubleEntry_2=a.asm.Ia).apply(null,arguments)},Nt=a._emscripten_bind_MetadataQuerier_GetStringEntry_2=function(){return(Nt=a._emscripten_bind_MetadataQuerier_GetStringEntry_2=a.asm.Ja).apply(null,arguments)},Gt=a._emscripten_bind_MetadataQuerier_NumEntries_1=function(){return(Gt=a._emscripten_bind_MetadataQuerier_NumEntries_1=a.asm.Ka).apply(null,arguments)},Dt=a._emscripten_bind_MetadataQuerier_GetEntryName_2=function(){return(Dt=a._emscripten_bind_MetadataQuerier_GetEntryName_2=a.asm.La).apply(null,arguments)},Ut=a._emscripten_bind_MetadataQuerier___destroy___0=function(){return(Ut=a._emscripten_bind_MetadataQuerier___destroy___0=a.asm.Ma).apply(null,arguments)},Vt=a._emscripten_bind_Decoder_Decoder_0=function(){return(Vt=a._emscripten_bind_Decoder_Decoder_0=a.asm.Na).apply(null,arguments)},Bt=a._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=function(){return(Bt=a._emscripten_bind_Decoder_DecodeArrayToPointCloud_3=a.asm.Oa).apply(null,arguments)},Ft=a._emscripten_bind_Decoder_DecodeArrayToMesh_3=function(){return(Ft=a._emscripten_bind_Decoder_DecodeArrayToMesh_3=a.asm.Pa).apply(null,arguments)},jt=a._emscripten_bind_Decoder_GetAttributeId_2=function(){return(jt=a._emscripten_bind_Decoder_GetAttributeId_2=a.asm.Qa).apply(null,arguments)},zt=a._emscripten_bind_Decoder_GetAttributeIdByName_2=function(){return(zt=a._emscripten_bind_Decoder_GetAttributeIdByName_2=a.asm.Ra).apply(null,arguments)},Wt=a._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=function(){return(Wt=a._emscripten_bind_Decoder_GetAttributeIdByMetadataEntry_3=a.asm.Sa).apply(null,arguments)},Ht=a._emscripten_bind_Decoder_GetAttribute_2=function(){return(Ht=a._emscripten_bind_Decoder_GetAttribute_2=a.asm.Ta).apply(null,arguments)},$t=a._emscripten_bind_Decoder_GetAttributeByUniqueId_2=function(){return($t=a._emscripten_bind_Decoder_GetAttributeByUniqueId_2=a.asm.Ua).apply(null,arguments)},Yt=a._emscripten_bind_Decoder_GetMetadata_1=function(){return(Yt=a._emscripten_bind_Decoder_GetMetadata_1=a.asm.Va).apply(null,arguments)},qt=a._emscripten_bind_Decoder_GetAttributeMetadata_2=function(){return(qt=a._emscripten_bind_Decoder_GetAttributeMetadata_2=a.asm.Wa).apply(null,arguments)},Xt=a._emscripten_bind_Decoder_GetFaceFromMesh_3=function(){return(Xt=a._emscripten_bind_Decoder_GetFaceFromMesh_3=a.asm.Xa).apply(null,arguments)},Zt=a._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=function(){return(Zt=a._emscripten_bind_Decoder_GetTriangleStripsFromMesh_2=a.asm.Ya).apply(null,arguments)},Jt=a._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=function(){return(Jt=a._emscripten_bind_Decoder_GetTrianglesUInt16Array_3=a.asm.Za).apply(null,arguments)},Kt=a._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=function(){return(Kt=a._emscripten_bind_Decoder_GetTrianglesUInt32Array_3=a.asm._a).apply(null,arguments)},Qt=a._emscripten_bind_Decoder_GetAttributeFloat_3=function(){return(Qt=a._emscripten_bind_Decoder_GetAttributeFloat_3=a.asm.$a).apply(null,arguments)},er=a._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=function(){return(er=a._emscripten_bind_Decoder_GetAttributeFloatForAllPoints_3=a.asm.ab).apply(null,arguments)},tr=a._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=function(){return(tr=a._emscripten_bind_Decoder_GetAttributeIntForAllPoints_3=a.asm.bb).apply(null,arguments)},rr=a._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=function(){return(rr=a._emscripten_bind_Decoder_GetAttributeInt8ForAllPoints_3=a.asm.cb).apply(null,arguments)},ir=a._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=function(){return(ir=a._emscripten_bind_Decoder_GetAttributeUInt8ForAllPoints_3=a.asm.db).apply(null,arguments)},nr=a._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=function(){return(nr=a._emscripten_bind_Decoder_GetAttributeInt16ForAllPoints_3=a.asm.eb).apply(null,arguments)},sr=a._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=function(){return(sr=a._emscripten_bind_Decoder_GetAttributeUInt16ForAllPoints_3=a.asm.fb).apply(null,arguments)},or=a._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=function(){return(or=a._emscripten_bind_Decoder_GetAttributeInt32ForAllPoints_3=a.asm.gb).apply(null,arguments)},ar=a._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=function(){return(ar=a._emscripten_bind_Decoder_GetAttributeUInt32ForAllPoints_3=a.asm.hb).apply(null,arguments)},lr=a._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=function(){return(lr=a._emscripten_bind_Decoder_GetAttributeDataArrayForAllPoints_5=a.asm.ib).apply(null,arguments)},cr=a._emscripten_bind_Decoder_SkipAttributeTransform_1=function(){return(cr=a._emscripten_bind_Decoder_SkipAttributeTransform_1=a.asm.jb).apply(null,arguments)},ur=a._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=function(){return(ur=a._emscripten_bind_Decoder_GetEncodedGeometryType_Deprecated_1=a.asm.kb).apply(null,arguments)},hr=a._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=function(){return(hr=a._emscripten_bind_Decoder_DecodeBufferToPointCloud_2=a.asm.lb).apply(null,arguments)},dr=a._emscripten_bind_Decoder_DecodeBufferToMesh_2=function(){return(dr=a._emscripten_bind_Decoder_DecodeBufferToMesh_2=a.asm.mb).apply(null,arguments)},fr=a._emscripten_bind_Decoder___destroy___0=function(){return(fr=a._emscripten_bind_Decoder___destroy___0=a.asm.nb).apply(null,arguments)},pr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=function(){return(pr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_INVALID_TRANSFORM=a.asm.ob).apply(null,arguments)},mr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=function(){return(mr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_NO_TRANSFORM=a.asm.pb).apply(null,arguments)},gr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=function(){return(gr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_QUANTIZATION_TRANSFORM=a.asm.qb).apply(null,arguments)},vr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=function(){return(vr=a._emscripten_enum_draco_AttributeTransformType_ATTRIBUTE_OCTAHEDRON_TRANSFORM=a.asm.rb).apply(null,arguments)},_r=a._emscripten_enum_draco_GeometryAttribute_Type_INVALID=function(){return(_r=a._emscripten_enum_draco_GeometryAttribute_Type_INVALID=a.asm.sb).apply(null,arguments)},br=a._emscripten_enum_draco_GeometryAttribute_Type_POSITION=function(){return(br=a._emscripten_enum_draco_GeometryAttribute_Type_POSITION=a.asm.tb).apply(null,arguments)},yr=a._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=function(){return(yr=a._emscripten_enum_draco_GeometryAttribute_Type_NORMAL=a.asm.ub).apply(null,arguments)},Er=a._emscripten_enum_draco_GeometryAttribute_Type_COLOR=function(){return(Er=a._emscripten_enum_draco_GeometryAttribute_Type_COLOR=a.asm.vb).apply(null,arguments)},wr=a._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=function(){return(wr=a._emscripten_enum_draco_GeometryAttribute_Type_TEX_COORD=a.asm.wb).apply(null,arguments)},xr=a._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=function(){return(xr=a._emscripten_enum_draco_GeometryAttribute_Type_GENERIC=a.asm.xb).apply(null,arguments)},Ar=a._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=function(){return(Ar=a._emscripten_enum_draco_EncodedGeometryType_INVALID_GEOMETRY_TYPE=a.asm.yb).apply(null,arguments)},Tr=a._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=function(){return(Tr=a._emscripten_enum_draco_EncodedGeometryType_POINT_CLOUD=a.asm.zb).apply(null,arguments)},Sr=a._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=function(){return(Sr=a._emscripten_enum_draco_EncodedGeometryType_TRIANGULAR_MESH=a.asm.Ab).apply(null,arguments)},Mr=a._emscripten_enum_draco_DataType_DT_INVALID=function(){return(Mr=a._emscripten_enum_draco_DataType_DT_INVALID=a.asm.Bb).apply(null,arguments)},Cr=a._emscripten_enum_draco_DataType_DT_INT8=function(){return(Cr=a._emscripten_enum_draco_DataType_DT_INT8=a.asm.Cb).apply(null,arguments)},Rr=a._emscripten_enum_draco_DataType_DT_UINT8=function(){return(Rr=a._emscripten_enum_draco_DataType_DT_UINT8=a.asm.Db).apply(null,arguments)},Ir=a._emscripten_enum_draco_DataType_DT_INT16=function(){return(Ir=a._emscripten_enum_draco_DataType_DT_INT16=a.asm.Eb).apply(null,arguments)},Or=a._emscripten_enum_draco_DataType_DT_UINT16=function(){return(Or=a._emscripten_enum_draco_DataType_DT_UINT16=a.asm.Fb).apply(null,arguments)},Pr=a._emscripten_enum_draco_DataType_DT_INT32=function(){return(Pr=a._emscripten_enum_draco_DataType_DT_INT32=a.asm.Gb).apply(null,arguments)},kr=a._emscripten_enum_draco_DataType_DT_UINT32=function(){return(kr=a._emscripten_enum_draco_DataType_DT_UINT32=a.asm.Hb).apply(null,arguments)},Lr=a._emscripten_enum_draco_DataType_DT_INT64=function(){return(Lr=a._emscripten_enum_draco_DataType_DT_INT64=a.asm.Ib).apply(null,arguments)},Nr=a._emscripten_enum_draco_DataType_DT_UINT64=function(){return(Nr=a._emscripten_enum_draco_DataType_DT_UINT64=a.asm.Jb).apply(null,arguments)},Gr=a._emscripten_enum_draco_DataType_DT_FLOAT32=function(){return(Gr=a._emscripten_enum_draco_DataType_DT_FLOAT32=a.asm.Kb).apply(null,arguments)},Dr=a._emscripten_enum_draco_DataType_DT_FLOAT64=function(){return(Dr=a._emscripten_enum_draco_DataType_DT_FLOAT64=a.asm.Lb).apply(null,arguments)},Ur=a._emscripten_enum_draco_DataType_DT_BOOL=function(){return(Ur=a._emscripten_enum_draco_DataType_DT_BOOL=a.asm.Mb).apply(null,arguments)},Vr=a._emscripten_enum_draco_DataType_DT_TYPES_COUNT=function(){return(Vr=a._emscripten_enum_draco_DataType_DT_TYPES_COUNT=a.asm.Nb).apply(null,arguments)},Br=a._emscripten_enum_draco_StatusCode_OK=function(){return(Br=a._emscripten_enum_draco_StatusCode_OK=a.asm.Ob).apply(null,arguments)},Fr=a._emscripten_enum_draco_StatusCode_DRACO_ERROR=function(){return(Fr=a._emscripten_enum_draco_StatusCode_DRACO_ERROR=a.asm.Pb).apply(null,arguments)},jr=a._emscripten_enum_draco_StatusCode_IO_ERROR=function(){return(jr=a._emscripten_enum_draco_StatusCode_IO_ERROR=a.asm.Qb).apply(null,arguments)},zr=a._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=function(){return(zr=a._emscripten_enum_draco_StatusCode_INVALID_PARAMETER=a.asm.Rb).apply(null,arguments)},Wr=a._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=function(){return(Wr=a._emscripten_enum_draco_StatusCode_UNSUPPORTED_VERSION=a.asm.Sb).apply(null,arguments)},Hr=a._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=function(){return(Hr=a._emscripten_enum_draco_StatusCode_UNKNOWN_VERSION=a.asm.Tb).apply(null,arguments)},$r=a._malloc=function(){return($r=a._malloc=a.asm.Ub).apply(null,arguments)};function Yr(e){function r(){ce||(ce=!0,a.calledRun=!0,C||(z=!0,te(F),t(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),function(){if(a.postRun)for("function"==typeof a.postRun&&(a.postRun=[a.postRun]);a.postRun.length;)e=a.postRun.shift(),j.unshift(e);var e;te(j)}()))}e=e||_,H>0||(function(){if(a.preRun)for("function"==typeof a.preRun&&(a.preRun=[a.preRun]);a.preRun.length;)e=a.preRun.shift(),B.unshift(e);var e;te(B)}(),H>0||(a.setStatus?(a.setStatus("Running..."),setTimeout((function(){setTimeout((function(){a.setStatus("")}),1),r()}),1)):r()))}if(a._free=function(){return(a._free=a.asm.Vb).apply(null,arguments)},Y=function e(){ce||Yr(),ce||(Y=e)},a.run=Yr,a.preInit)for("function"==typeof a.preInit&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();function qr(){}function Xr(e){return(e||qr).__cache__}function Zr(e,t){var r=Xr(t),i=r[e];return i||((i=Object.create((t||qr).prototype)).ptr=e,r[e]=i)}Yr(),qr.prototype=Object.create(qr.prototype),qr.prototype.constructor=qr,qr.prototype.__class__=qr,qr.__cache__={},a.WrapperObject=qr,a.getCache=Xr,a.wrapPointer=Zr,a.castObject=function(e,t){return Zr(e.ptr,t)},a.NULL=Zr(0),a.destroy=function(e){if(!e.__destroy__)throw"Error: Cannot destroy object. (Did you create it yourself?)";e.__destroy__(),delete Xr(e.__class__)[e.ptr]},a.compare=function(e,t){return e.ptr===t.ptr},a.getPointer=function(e){return e.ptr},a.getClass=function(e){return e.__class__};var Jr={buffer:0,size:0,pos:0,temps:[],needed:0,prepare:function(){if(Jr.needed){for(var e=0;e<Jr.temps.length;e++)a._free(Jr.temps[e]);Jr.temps.length=0,a._free(Jr.buffer),Jr.buffer=0,Jr.size+=Jr.needed,Jr.needed=0}Jr.buffer||(Jr.size+=128,Jr.buffer=a._malloc(Jr.size),R(Jr.buffer)),Jr.pos=0},alloc:function(e,t){R(Jr.buffer);var r,i=t.BYTES_PER_ELEMENT,n=e.length*i;return n=n+7&-8,Jr.pos+n>=Jr.size?(R(n>0),Jr.needed+=n,r=a._malloc(n),Jr.temps.push(r)):(r=Jr.buffer+Jr.pos,Jr.pos+=n),r},copy:function(e,t,r){switch(r>>>=0,t.BYTES_PER_ELEMENT){case 2:r>>>=1;break;case 4:r>>>=2;break;case 8:r>>>=3}for(var i=0;i<e.length;i++)t[r+i]=e[i]}};function Kr(e){if("string"==typeof e){var t=(i=e,o=s>0?s:function(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?++t:t+=i<=2047?2:i<=65535?3:4}return t}(i)+1,a=new Array(o),l=function(e,t,r,i){if(!(i>0))return 0;for(var n=r,s=r+i-1,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),a<=127){if(r>=s)break;t[r++]=a}else if(a<=2047){if(r+1>=s)break;t[r++]=192|a>>6,t[r++]=128|63&a}else if(a<=65535){if(r+2>=s)break;t[r++]=224|a>>12,t[r++]=128|a>>6&63,t[r++]=128|63&a}else{if(r+3>=s)break;t[r++]=240|a>>18,t[r++]=128|a>>12&63,t[r++]=128|a>>6&63,t[r++]=128|63&a}}return t[r]=0,r-n}(i,a,0,a.length),n&&(a.length=l),a),r=Jr.alloc(t,O);return Jr.copy(t,O,r),r}var i,n,s,o,a,l;return e}function Qr(e){if("object"==typeof e){var t=Jr.alloc(e,O);return Jr.copy(e,O,t),t}return e}function ei(){throw"cannot construct a VoidPtr, no constructor in IDL"}function ti(){this.ptr=de(),Xr(ti)[this.ptr]=this}function ri(){this.ptr=me(),Xr(ri)[this.ptr]=this}function ii(){this.ptr=_e(),Xr(ii)[this.ptr]=this}function ni(){this.ptr=ye(),Xr(ni)[this.ptr]=this}function si(){this.ptr=Oe(),Xr(si)[this.ptr]=this}function oi(){this.ptr=De(),Xr(oi)[this.ptr]=this}function ai(){this.ptr=Fe(),Xr(ai)[this.ptr]=this}function li(){this.ptr=He(),Xr(li)[this.ptr]=this}function ci(){this.ptr=Ze(),Xr(ci)[this.ptr]=this}function ui(){throw"cannot construct a Status, no constructor in IDL"}function hi(){this.ptr=rt(),Xr(hi)[this.ptr]=this}function di(){this.ptr=ot(),Xr(di)[this.ptr]=this}function fi(){this.ptr=ut(),Xr(fi)[this.ptr]=this}function pi(){this.ptr=pt(),Xr(pi)[this.ptr]=this}function mi(){this.ptr=_t(),Xr(mi)[this.ptr]=this}function gi(){this.ptr=wt(),Xr(gi)[this.ptr]=this}function vi(){this.ptr=St(),Xr(vi)[this.ptr]=this}function _i(){this.ptr=It(),Xr(_i)[this.ptr]=this}function bi(){this.ptr=Vt(),Xr(bi)[this.ptr]=this}return ei.prototype=Object.create(qr.prototype),ei.prototype.constructor=ei,ei.prototype.__class__=ei,ei.__cache__={},a.VoidPtr=ei,ei.prototype.__destroy__=ei.prototype.__destroy__=function(){var e=this.ptr;he(e)},ti.prototype=Object.create(qr.prototype),ti.prototype.constructor=ti,ti.prototype.__class__=ti,ti.__cache__={},a.DecoderBuffer=ti,ti.prototype.Init=ti.prototype.Init=function(e,t){var r=this.ptr;Jr.prepare(),"object"==typeof e&&(e=Qr(e)),t&&"object"==typeof t&&(t=t.ptr),fe(r,e,t)},ti.prototype.__destroy__=ti.prototype.__destroy__=function(){var e=this.ptr;pe(e)},ri.prototype=Object.create(qr.prototype),ri.prototype.constructor=ri,ri.prototype.__class__=ri,ri.__cache__={},a.AttributeTransformData=ri,ri.prototype.transform_type=ri.prototype.transform_type=function(){var e=this.ptr;return ge(e)},ri.prototype.__destroy__=ri.prototype.__destroy__=function(){var e=this.ptr;ve(e)},ii.prototype=Object.create(qr.prototype),ii.prototype.constructor=ii,ii.prototype.__class__=ii,ii.__cache__={},a.GeometryAttribute=ii,ii.prototype.__destroy__=ii.prototype.__destroy__=function(){var e=this.ptr;be(e)},ni.prototype=Object.create(qr.prototype),ni.prototype.constructor=ni,ni.prototype.__class__=ni,ni.__cache__={},a.PointAttribute=ni,ni.prototype.size=ni.prototype.size=function(){var e=this.ptr;return Ee(e)},ni.prototype.GetAttributeTransformData=ni.prototype.GetAttributeTransformData=function(){var e=this.ptr;return Zr(we(e),ri)},ni.prototype.attribute_type=ni.prototype.attribute_type=function(){var e=this.ptr;return xe(e)},ni.prototype.data_type=ni.prototype.data_type=function(){var e=this.ptr;return Ae(e)},ni.prototype.num_components=ni.prototype.num_components=function(){var e=this.ptr;return Te(e)},ni.prototype.normalized=ni.prototype.normalized=function(){var e=this.ptr;return!!Se(e)},ni.prototype.byte_stride=ni.prototype.byte_stride=function(){var e=this.ptr;return Me(e)},ni.prototype.byte_offset=ni.prototype.byte_offset=function(){var e=this.ptr;return Ce(e)},ni.prototype.unique_id=ni.prototype.unique_id=function(){var e=this.ptr;return Re(e)},ni.prototype.__destroy__=ni.prototype.__destroy__=function(){var e=this.ptr;Ie(e)},si.prototype=Object.create(qr.prototype),si.prototype.constructor=si,si.prototype.__class__=si,si.__cache__={},a.AttributeQuantizationTransform=si,si.prototype.InitFromAttribute=si.prototype.InitFromAttribute=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!Pe(t,e)},si.prototype.quantization_bits=si.prototype.quantization_bits=function(){var e=this.ptr;return ke(e)},si.prototype.min_value=si.prototype.min_value=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Le(t,e)},si.prototype.range=si.prototype.range=function(){var e=this.ptr;return Ne(e)},si.prototype.__destroy__=si.prototype.__destroy__=function(){var e=this.ptr;Ge(e)},oi.prototype=Object.create(qr.prototype),oi.prototype.constructor=oi,oi.prototype.__class__=oi,oi.__cache__={},a.AttributeOctahedronTransform=oi,oi.prototype.InitFromAttribute=oi.prototype.InitFromAttribute=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),!!Ue(t,e)},oi.prototype.quantization_bits=oi.prototype.quantization_bits=function(){var e=this.ptr;return Ve(e)},oi.prototype.__destroy__=oi.prototype.__destroy__=function(){var e=this.ptr;Be(e)},ai.prototype=Object.create(qr.prototype),ai.prototype.constructor=ai,ai.prototype.__class__=ai,ai.__cache__={},a.PointCloud=ai,ai.prototype.num_attributes=ai.prototype.num_attributes=function(){var e=this.ptr;return je(e)},ai.prototype.num_points=ai.prototype.num_points=function(){var e=this.ptr;return ze(e)},ai.prototype.__destroy__=ai.prototype.__destroy__=function(){var e=this.ptr;We(e)},li.prototype=Object.create(qr.prototype),li.prototype.constructor=li,li.prototype.__class__=li,li.__cache__={},a.Mesh=li,li.prototype.num_faces=li.prototype.num_faces=function(){var e=this.ptr;return $e(e)},li.prototype.num_attributes=li.prototype.num_attributes=function(){var e=this.ptr;return Ye(e)},li.prototype.num_points=li.prototype.num_points=function(){var e=this.ptr;return qe(e)},li.prototype.__destroy__=li.prototype.__destroy__=function(){var e=this.ptr;Xe(e)},ci.prototype=Object.create(qr.prototype),ci.prototype.constructor=ci,ci.prototype.__class__=ci,ci.__cache__={},a.Metadata=ci,ci.prototype.__destroy__=ci.prototype.__destroy__=function(){var e=this.ptr;Je(e)},ui.prototype=Object.create(qr.prototype),ui.prototype.constructor=ui,ui.prototype.__class__=ui,ui.__cache__={},a.Status=ui,ui.prototype.code=ui.prototype.code=function(){var e=this.ptr;return Ke(e)},ui.prototype.ok=ui.prototype.ok=function(){var e=this.ptr;return!!Qe(e)},ui.prototype.error_msg=ui.prototype.error_msg=function(){var e=this.ptr;return G(et(e))},ui.prototype.__destroy__=ui.prototype.__destroy__=function(){var e=this.ptr;tt(e)},hi.prototype=Object.create(qr.prototype),hi.prototype.constructor=hi,hi.prototype.__class__=hi,hi.__cache__={},a.DracoFloat32Array=hi,hi.prototype.GetValue=hi.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),it(t,e)},hi.prototype.size=hi.prototype.size=function(){var e=this.ptr;return nt(e)},hi.prototype.__destroy__=hi.prototype.__destroy__=function(){var e=this.ptr;st(e)},di.prototype=Object.create(qr.prototype),di.prototype.constructor=di,di.prototype.__class__=di,di.__cache__={},a.DracoInt8Array=di,di.prototype.GetValue=di.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),at(t,e)},di.prototype.size=di.prototype.size=function(){var e=this.ptr;return lt(e)},di.prototype.__destroy__=di.prototype.__destroy__=function(){var e=this.ptr;ct(e)},fi.prototype=Object.create(qr.prototype),fi.prototype.constructor=fi,fi.prototype.__class__=fi,fi.__cache__={},a.DracoUInt8Array=fi,fi.prototype.GetValue=fi.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),ht(t,e)},fi.prototype.size=fi.prototype.size=function(){var e=this.ptr;return dt(e)},fi.prototype.__destroy__=fi.prototype.__destroy__=function(){var e=this.ptr;ft(e)},pi.prototype=Object.create(qr.prototype),pi.prototype.constructor=pi,pi.prototype.__class__=pi,pi.__cache__={},a.DracoInt16Array=pi,pi.prototype.GetValue=pi.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),mt(t,e)},pi.prototype.size=pi.prototype.size=function(){var e=this.ptr;return gt(e)},pi.prototype.__destroy__=pi.prototype.__destroy__=function(){var e=this.ptr;vt(e)},mi.prototype=Object.create(qr.prototype),mi.prototype.constructor=mi,mi.prototype.__class__=mi,mi.__cache__={},a.DracoUInt16Array=mi,mi.prototype.GetValue=mi.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),bt(t,e)},mi.prototype.size=mi.prototype.size=function(){var e=this.ptr;return yt(e)},mi.prototype.__destroy__=mi.prototype.__destroy__=function(){var e=this.ptr;Et(e)},gi.prototype=Object.create(qr.prototype),gi.prototype.constructor=gi,gi.prototype.__class__=gi,gi.__cache__={},a.DracoInt32Array=gi,gi.prototype.GetValue=gi.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),xt(t,e)},gi.prototype.size=gi.prototype.size=function(){var e=this.ptr;return At(e)},gi.prototype.__destroy__=gi.prototype.__destroy__=function(){var e=this.ptr;Tt(e)},vi.prototype=Object.create(qr.prototype),vi.prototype.constructor=vi,vi.prototype.__class__=vi,vi.__cache__={},a.DracoUInt32Array=vi,vi.prototype.GetValue=vi.prototype.GetValue=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Mt(t,e)},vi.prototype.size=vi.prototype.size=function(){var e=this.ptr;return Ct(e)},vi.prototype.__destroy__=vi.prototype.__destroy__=function(){var e=this.ptr;Rt(e)},_i.prototype=Object.create(qr.prototype),_i.prototype.constructor=_i,_i.prototype.__class__=_i,_i.__cache__={},a.MetadataQuerier=_i,_i.prototype.HasEntry=_i.prototype.HasEntry=function(e,t){var r=this.ptr;return Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:Kr(t),!!Ot(r,e,t)},_i.prototype.GetIntEntry=_i.prototype.GetIntEntry=function(e,t){var r=this.ptr;return Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:Kr(t),Pt(r,e,t)},_i.prototype.GetIntEntryArray=_i.prototype.GetIntEntryArray=function(e,t,r){var i=this.ptr;Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:Kr(t),r&&"object"==typeof r&&(r=r.ptr),kt(i,e,t,r)},_i.prototype.GetDoubleEntry=_i.prototype.GetDoubleEntry=function(e,t){var r=this.ptr;return Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:Kr(t),Lt(r,e,t)},_i.prototype.GetStringEntry=_i.prototype.GetStringEntry=function(e,t){var r=this.ptr;return Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:Kr(t),G(Nt(r,e,t))},_i.prototype.NumEntries=_i.prototype.NumEntries=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Gt(t,e)},_i.prototype.GetEntryName=_i.prototype.GetEntryName=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),G(Dt(r,e,t))},_i.prototype.__destroy__=_i.prototype.__destroy__=function(){var e=this.ptr;Ut(e)},bi.prototype=Object.create(qr.prototype),bi.prototype.constructor=bi,bi.prototype.__class__=bi,bi.__cache__={},a.Decoder=bi,bi.prototype.DecodeArrayToPointCloud=bi.prototype.DecodeArrayToPointCloud=function(e,t,r){var i=this.ptr;return Jr.prepare(),"object"==typeof e&&(e=Qr(e)),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),Zr(Bt(i,e,t,r),ui)},bi.prototype.DecodeArrayToMesh=bi.prototype.DecodeArrayToMesh=function(e,t,r){var i=this.ptr;return Jr.prepare(),"object"==typeof e&&(e=Qr(e)),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),Zr(Ft(i,e,t,r),ui)},bi.prototype.GetAttributeId=bi.prototype.GetAttributeId=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),jt(r,e,t)},bi.prototype.GetAttributeIdByName=bi.prototype.GetAttributeIdByName=function(e,t){var r=this.ptr;return Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:Kr(t),zt(r,e,t)},bi.prototype.GetAttributeIdByMetadataEntry=bi.prototype.GetAttributeIdByMetadataEntry=function(e,t,r){var i=this.ptr;return Jr.prepare(),e&&"object"==typeof e&&(e=e.ptr),t=t&&"object"==typeof t?t.ptr:Kr(t),r=r&&"object"==typeof r?r.ptr:Kr(r),Wt(i,e,t,r)},bi.prototype.GetAttribute=bi.prototype.GetAttribute=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Zr(Ht(r,e,t),ni)},bi.prototype.GetAttributeByUniqueId=bi.prototype.GetAttributeByUniqueId=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Zr($t(r,e,t),ni)},bi.prototype.GetMetadata=bi.prototype.GetMetadata=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),Zr(Yt(t,e),ci)},bi.prototype.GetAttributeMetadata=bi.prototype.GetAttributeMetadata=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Zr(qt(r,e,t),ci)},bi.prototype.GetFaceFromMesh=bi.prototype.GetFaceFromMesh=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Xt(i,e,t,r)},bi.prototype.GetTriangleStripsFromMesh=bi.prototype.GetTriangleStripsFromMesh=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Zt(r,e,t)},bi.prototype.GetTrianglesUInt16Array=bi.prototype.GetTrianglesUInt16Array=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Jt(i,e,t,r)},bi.prototype.GetTrianglesUInt32Array=bi.prototype.GetTrianglesUInt32Array=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Kt(i,e,t,r)},bi.prototype.GetAttributeFloat=bi.prototype.GetAttributeFloat=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!Qt(i,e,t,r)},bi.prototype.GetAttributeFloatForAllPoints=bi.prototype.GetAttributeFloatForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!er(i,e,t,r)},bi.prototype.GetAttributeIntForAllPoints=bi.prototype.GetAttributeIntForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!tr(i,e,t,r)},bi.prototype.GetAttributeInt8ForAllPoints=bi.prototype.GetAttributeInt8ForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!rr(i,e,t,r)},bi.prototype.GetAttributeUInt8ForAllPoints=bi.prototype.GetAttributeUInt8ForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!ir(i,e,t,r)},bi.prototype.GetAttributeInt16ForAllPoints=bi.prototype.GetAttributeInt16ForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!nr(i,e,t,r)},bi.prototype.GetAttributeUInt16ForAllPoints=bi.prototype.GetAttributeUInt16ForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!sr(i,e,t,r)},bi.prototype.GetAttributeInt32ForAllPoints=bi.prototype.GetAttributeInt32ForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!or(i,e,t,r)},bi.prototype.GetAttributeUInt32ForAllPoints=bi.prototype.GetAttributeUInt32ForAllPoints=function(e,t,r){var i=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),!!ar(i,e,t,r)},bi.prototype.GetAttributeDataArrayForAllPoints=bi.prototype.GetAttributeDataArrayForAllPoints=function(e,t,r,i,n){var s=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),r&&"object"==typeof r&&(r=r.ptr),i&&"object"==typeof i&&(i=i.ptr),n&&"object"==typeof n&&(n=n.ptr),!!lr(s,e,t,r,i,n)},bi.prototype.SkipAttributeTransform=bi.prototype.SkipAttributeTransform=function(e){var t=this.ptr;e&&"object"==typeof e&&(e=e.ptr),cr(t,e)},bi.prototype.GetEncodedGeometryType_Deprecated=bi.prototype.GetEncodedGeometryType_Deprecated=function(e){var t=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),ur(t,e)},bi.prototype.DecodeBufferToPointCloud=bi.prototype.DecodeBufferToPointCloud=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Zr(hr(r,e,t),ui)},bi.prototype.DecodeBufferToMesh=bi.prototype.DecodeBufferToMesh=function(e,t){var r=this.ptr;return e&&"object"==typeof e&&(e=e.ptr),t&&"object"==typeof t&&(t=t.ptr),Zr(dr(r,e,t),ui)},bi.prototype.__destroy__=bi.prototype.__destroy__=function(){var e=this.ptr;fr(e)},function(){function e(){a.ATTRIBUTE_INVALID_TRANSFORM=pr(),a.ATTRIBUTE_NO_TRANSFORM=mr(),a.ATTRIBUTE_QUANTIZATION_TRANSFORM=gr(),a.ATTRIBUTE_OCTAHEDRON_TRANSFORM=vr(),a.INVALID=_r(),a.POSITION=br(),a.NORMAL=yr(),a.COLOR=Er(),a.TEX_COORD=wr(),a.GENERIC=xr(),a.INVALID_GEOMETRY_TYPE=Ar(),a.POINT_CLOUD=Tr(),a.TRIANGULAR_MESH=Sr(),a.DT_INVALID=Mr(),a.DT_INT8=Cr(),a.DT_UINT8=Rr(),a.DT_INT16=Ir(),a.DT_UINT16=Or(),a.DT_INT32=Pr(),a.DT_UINT32=kr(),a.DT_INT64=Lr(),a.DT_UINT64=Nr(),a.DT_FLOAT32=Gr(),a.DT_FLOAT64=Dr(),a.DT_BOOL=Ur(),a.DT_TYPES_COUNT=Vr(),a.OK=Br(),a.DRACO_ERROR=Fr(),a.IO_ERROR=jr(),a.INVALID_PARAMETER=zr(),a.UNSUPPORTED_VERSION=Wr(),a.UNKNOWN_VERSION=Hr()}z?e():W(e)}(),"function"==typeof a.onModuleParsed&&a.onModuleParsed(),a.Decoder.prototype.GetEncodedGeometryType=function(e){if(e.__class__&&e.__class__===a.DecoderBuffer)return a.Decoder.prototype.GetEncodedGeometryType_Deprecated(e);if(e.byteLength<8)return a.INVALID_GEOMETRY_TYPE;switch(e[7]){case 0:return a.POINT_CLOUD;case 1:return a.TRIANGULAR_MESH;default:return a.INVALID_GEOMETRY_TYPE}},e.ready});e.exports=a})),s.register("kjyEk",(function(e,t){})),s.register("fwEwy",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDTFEngine=void 0;var r=s("1zRCo");Object.defineProperty(e.exports,"SDTFEngine",{enumerable:!0,get:function(){return r.SDTFEngine}})})),s.register("1zRCo",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SDTFEngine=void 0;var o=s("eYU63");s("yoicn");var a=s("bJEmL"),l=s("crO5Z"),c=s("cTTbu"),u=s("12eGO");let h=class{constructor(){this.BINARY_EXTENSION_HEADER_LENGTH=20,this._httpClient=a.instance.resolve(c.HttpClient),this._logger=a.instance.resolve(c.Logger)}loadContent(e){var t,r;return n(this,void 0,void 0,(function*(){const i=new o.TreeNode("sdtf");if(!e||e&&!e.href){const e=new c.ShapeDiverViewerDataProcessingError("SDTFEngine.loadContent: Invalid content was provided to geometry engine.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"SDTFEngine.loadContent",e)}let n,s;try{n=yield this._httpClient.get(e.href,{responseType:"arraybuffer"})}catch(e){throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"SDTFEngine.loadContent",e)}if(!n.headers["content-type"]||"model/vnd.sdtf"!==n.headers["content-type"]){const e=new c.ShapeDiverViewerDataProcessingError("SDTFEngine.loadContent: Non-binary SDTF encoding not implemented.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"SDTFEngine.loadContent",e)}s=n.data instanceof ArrayBuffer?n.data:n.data.buffer;const a=new DataView(s,0,this.BINARY_EXTENSION_HEADER_LENGTH);if("sdtf"!==String.fromCharCode(a.getUint8(0))+String.fromCharCode(a.getUint8(1))+String.fromCharCode(a.getUint8(2))+String.fromCharCode(a.getUint8(3))){const e=new c.ShapeDiverViewerDataProcessingError("SDTFEngine.loadContent: Invalid data: sdtf magic wrong.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"SDTFEngine.loadContent",e)}const l=a.getUint32(4,!0);if(1!==l){const e=new c.ShapeDiverViewerDataProcessingError(`SDTFEngine.loadContent: Invalid version: sdtf loader does not support version ${l}.`);throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"SDTFEngine.loadContent",e)}const h=a.getUint32(8,!0),d=a.getUint32(12,!0);if(0!==a.getUint32(16,!0)){const e=new c.ShapeDiverViewerDataProcessingError("SDTFEngine.loadContent: Content format is not Json (0), content invalid.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"SDTFEngine.loadContent",e)}this._content=JSON.parse((new TextDecoder).decode(new DataView(s,this.BINARY_EXTENSION_HEADER_LENGTH,d))),this._body=s.slice(this.BINARY_EXTENSION_HEADER_LENGTH+d,h);try{const e={};for(let i=0;i<this._content.attributes.length;i++){const n=this._content.attributes[i];for(let i in n){const s=n[i],o=this._content.typeHints[s.typeHint].name,a=e[i]?e[i].filter((e=>e.typeHint===o)):[];if(e[i]&&a.length>0){const e=a[0];e.count++,o===u.PRIMITIVETYPEHINT.STRING&&((null===(t=e.values)||void 0===t?void 0:t.includes(s.value))||null===(r=e.values)||void 0===r||r.push(s.value)),o!==u.PRIMITIVETYPEHINT.DOUBLE&&o!==u.PRIMITIVETYPEHINT.FLOAT&&o!==u.PRIMITIVETYPEHINT.DECIMAL&&o!==u.PRIMITIVETYPEHINT.INT||(e.min=Math.min(s.value,e.min),e.max=Math.max(s.value,e.max))}else e[i]?e[i].push({typeHint:o,count:1}):e[i]=[{typeHint:o,count:1}],o===u.PRIMITIVETYPEHINT.STRING&&(e[i][e[i].length-1].values=[s.value]),o!==u.PRIMITIVETYPEHINT.DOUBLE&&o!==u.PRIMITIVETYPEHINT.FLOAT&&o!==u.PRIMITIVETYPEHINT.DECIMAL&&o!==u.PRIMITIVETYPEHINT.INT||(e[i][e[i].length-1].min=s.value,e[i][e[i].length-1].max=s.value)}}i.data.push(new u.SDTFAttributeOverview(e));for(let e=0;e<this._content.chunks.length;e++)i.children.push(yield this.loadChunk(e));return i}catch(e){throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"SDTFEngine.load",e)}}))}loadAttributes(e){if(!this._content.attributes)throw new Error("Attributes not available.");if(!this._content.attributes[e])throw new Error("Attributes not available.");const t=this._content.attributes[e],r=new u.SDTFAttributesData;for(let e in t)void 0===t[e].value||(r.attributes[e]=new u.SDTFAttributeData(this._content.typeHints[t[e].typeHint].name,t[e].value));return r}loadChunk(e){return n(this,void 0,void 0,(function*(){if(!this._content.chunks)throw new Error("Chunks not available.");if(!this._content.chunks[e])throw new Error("Chunks not available.");const t=this._content.chunks[e],r=new o.TreeNode(t.name||"chunk_"+e);if(void 0!==t.attributes&&r.data.push(this.loadAttributes(t.attributes)),void 0!==t.items&&t.items.length>0)for(let e=0,i=t.items.length;e<i;e++)r.addChild(yield this.loadItem(t.items[e],e));if(void 0!==t.nodes&&t.nodes.length>0)for(let e=0,i=t.nodes.length;e<i;e++)r.addChild(yield this.loadNode(t.nodes[e]));return r}))}loadItem(e,t){return n(this,void 0,void 0,(function*(){if(!this._content.items)throw new Error("Item not available.");if(!this._content.items[e])throw new Error("Item not available.");const r=this._content.items[e],i=new o.TreeNode(t+"");let n;void 0!==r.attributes&&(n=this.loadAttributes(r.attributes));const s=new u.SDTFItemData(this._content.typeHints[r.typeHint].name,r.value,null==n?void 0:n.attributes);return i.data.push(s),i}))}loadNode(e){return n(this,void 0,void 0,(function*(){if(!this._content.nodes)throw new Error("Node not available.");if(!this._content.nodes[e])throw new Error("Node not available.");const t=this._content.nodes[e],r=new o.TreeNode(t.name||"node_"+e);if(void 0!==t.attributes&&r.data.push(this.loadAttributes(t.attributes)),void 0!==t.items&&t.items.length>0)for(let e=0,i=t.items.length;e<i;e++)r.addChild(yield this.loadItem(t.items[e],e));if(void 0!==t.nodes&&t.nodes.length>0)for(let e=0,i=t.nodes.length;e<i;e++)r.addChild(yield this.loadNode(t.nodes[e]));return r}))}};h=r([l.default(),i("design:paramtypes",[])],h),e.exports.SDTFEngine=h})),s.register("57buV",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Tag3dEngine=void 0;var r=s("XT55y");Object.defineProperty(e.exports,"Tag3dEngine",{enumerable:!0,get:function(){return r.Tag3dEngine}})})),s.register("XT55y",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},o=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Tag3dEngine=void 0;const c=o(s("ilwiq"));var u=s("eYU63");s("yoicn");var h=s("bJEmL"),d=s("crO5Z"),f=s("cTTbu"),p=s("12eGO"),m=s("kdOHD"),g=s("k2x7E");let v=class{constructor(){this._converter=h.instance.resolve(f.Converter),this._httpClient=h.instance.resolve(f.HttpClient),this._logger=h.instance.resolve(f.Logger),this._stateEngine=h.instance.resolve(f.StateEngine)}loadContent(e){return l(this,void 0,void 0,(function*(){if(!this._font){const e=yield this._httpClient.loadData("https://viewer.shapediver.com/graphik_regular.typeface.json",{responseType:"json"});this._font=new g.Font(e.data),this._stateEngine.fontLoaded.resolve(!0)}const t=new u.TreeNode("tag3d");if(!1===this._stateEngine.fontLoaded.resolved&&(yield this._stateEngine.fontLoaded),!e){const e=new f.ShapeDiverViewerDataProcessingError("Tag3dEngine.loadContent: Invalid content was provided to tag3d engine.");throw this._logger.handleError(f.LOGGINGTOPIC.DATA_PROCESSING,"Tag3dEngine.loadContent",e)}if(!e.data||!Array.isArray(e.data)){const e=new f.ShapeDiverViewerDataProcessingError("Tag3dEngine.loadContent: No tag3d data was provided to tag3d engine.");throw this._logger.handleError(f.LOGGINGTOPIC.DATA_PROCESSING,"Tag3dEngine.loadContent",e)}for(let n=0;n<e.data.length;n++){const s=e.data[n];s.size=s.size?+s.size:1,s.text=s.text||"",s.color=this._converter.toColor(s.color);const o=s.text.split(/\r\n|\r|\n/g);let a=[];for(let e=0;e<o.length;++e){if(""===o[e])continue;let t=new m.TextGeometry(o[e],{size:s.size,height:s.size/10,font:this._font});a.push(t)}let l=new c.Object3D;for(let e of a)l.add(new c.Mesh(e,new c.MeshPhongMaterial));let h,d,f,g=0;g=0;for(let e of l.children)h=(new c.Box3).setFromObject(e),f=h.max.y-h.min.y,g=Math.max(g,f);g*=1.15,a.forEach(((e,t)=>{e.translate(0,(-t-1)*g,0)})),h=(new c.Box3).setFromObject(l),d=h.max.x-h.min.x,f=h.max.y-h.min.y;var r=new c.Vector3(0,0,0);switch(s.justification){case"TL":break;case"TC":r.x=.5*-d;break;case"TR":r.x=-d;break;case"ML":r.y=.5*f;break;case"MC":r.x=.5*-d,r.y=.5*f;break;case"MR":r.x=-d,r.y=.5*f;break;case"BL":r.y=f;break;case"BC":r.x=.5*-d,r.y=f;break;case"BR":r.x=-d,r.y=f}for(let e of a)e.translate(r.x,r.y,r.z);if(s.location.hasOwnProperty("xAxis")){var i=new c.Matrix4;i.set(s.location.xAxis.X,s.location.yAxis.X,s.location.normal.X,0,s.location.xAxis.Y,s.location.yAxis.Y,s.location.normal.Y,0,s.location.xAxis.Z,s.location.yAxis.Z,s.location.normal.Z,0,0,0,0,1);for(let e of a)e.applyMatrix4(i),e.translate(s.location.origin.X,s.location.origin.Y,s.location.origin.Z)}for(let e of a){const r={};for(let t in e.attributes){let i=t.toUpperCase();if(/\d/.test(i)&&!i.includes("_")){const e=i.search(/\d/);i=i.substring(0,e)+"_"+i.substring(e,i.length)}else"TEXCOORD"===i||"COLOR"===i||"JOINTS"===i||"WEIGHTS"===i?i+="_0":"UV"===i&&(i="TEXCOORD_0");r[i]=new p.AttributeData(e.attributes[t].array,e.attributes[t].itemSize,0,0,0,!1,e.attributes[t].array.length/e.attributes[t].itemSize)}const i=new u.TreeNode("tag3d_"+e);i.data.push(new p.GeometryData(new p.PrimitiveData(r,4,null,new p.MaterialStandardData({color:s.color,metalness:0,roughness:1})))),t.children.push(i)}}return t}))}};v=n([d.default(),a("design:paramtypes",[])],v),e.exports.Tag3dEngine=v})),s.register("kdOHD",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TextGeometry=void 0;var r=s("ilwiq");class i extends r.ExtrudeGeometry{constructor(e,t={}){const r=t.font;if(void 0===r)super();else{const i=r.generateShapes(e,t.size);t.depth=void 0!==t.height?t.height:50,void 0===t.bevelThickness&&(t.bevelThickness=10),void 0===t.bevelSize&&(t.bevelSize=8),void 0===t.bevelEnabled&&(t.bevelEnabled=!1),super(i,t)}this.type="TextGeometry"}}e.exports.TextGeometry=i})),s.register("k2x7E",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Font=e.exports.FontLoader=void 0;var r=s("ilwiq");class i extends r.Loader{constructor(e){super(e)}load(e,t,i,n){const s=this,o=new r.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,(function(e){let r;try{r=JSON.parse(e)}catch(t){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(e.substring(65,e.length-2))}const i=s.parse(r);t&&t(i)}),i,n)}parse(e){return new n(e)}}e.exports.FontLoader=i;class n{constructor(e){this.type="Font",this.data=e}generateShapes(e,t=100){const r=[],i=function(e,t,r){const i=Array.from(e),n=t/r.resolution,s=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*n,a=[];let l=0,c=0;for(let e=0;e<i.length;e++){const t=i[e];if("\n"===t)l=0,c-=s;else{const e=o(t,n,l,c,r);l+=e.offsetX,a.push(e.path)}}return a}(e,t,this.data);for(let e=0,t=i.length;e<t;e++)Array.prototype.push.apply(r,i[e].toShapes());return r}}function o(e,t,i,n,s){const o=s.glyphs[e]||s.glyphs["?"];if(!o)return void console.error('THREE.Font: character "'+e+'" does not exists in font family '+s.familyName+".");const a=new r.ShapePath;let l,c,u,h,d,f,p,m;if(o.o){const e=o._cachedOutline||(o._cachedOutline=o.o.split(" "));for(let r=0,s=e.length;r<s;){switch(e[r++]){case"m":l=e[r++]*t+i,c=e[r++]*t+n,a.moveTo(l,c);break;case"l":l=e[r++]*t+i,c=e[r++]*t+n,a.lineTo(l,c);break;case"q":u=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,f=e[r++]*t+n,a.quadraticCurveTo(d,f,u,h);break;case"b":u=e[r++]*t+i,h=e[r++]*t+n,d=e[r++]*t+i,f=e[r++]*t+n,p=e[r++]*t+i,m=e[r++]*t+n,a.bezierCurveTo(d,f,p,m,u,h)}}}return{offsetX:o.ha*t,path:a}}e.exports.Font=n,n.prototype.isFont=!0})),s.register("6bM2h",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HTMLElementAnchorEngine=void 0;var r=s("ebnWi");Object.defineProperty(e.exports,"HTMLElementAnchorEngine",{enumerable:!0,get:function(){return r.HTMLElementAnchorEngine}})})),s.register("ebnWi",(function(e,t){var r=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},i=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HTMLElementAnchorEngine=void 0,s("yoicn");var n=s("bJEmL"),o=s("crO5Z"),a=s("12eGO"),l=s("eYU63"),c=s("cTTbu"),u=s("6UMiq");let h=class{constructor(){this._converter=n.instance.resolve(c.Converter),this._inputValidator=n.instance.resolve(c.InputValidator),this._logger=n.instance.resolve(c.Logger)}loadContent(e){return i(this,void 0,void 0,(function*(){try{const t=new l.TreeNode("htmlElementAnchors");if("tag2d"===e.format){e.data.forEach((e=>{if(!e.location||!e.text)return void this._logger.warn(c.LOGGINGTOPIC.DATA_PROCESSING,"HTMLElementAnchorEngine.load: One of the specified Tag2D elements did not have all necessary properties.");const r=this._inputValidator.sanitize(e.text);t.data.push(new a.HTMLElementAnchorTextData({location:this._converter.toVec3(e.location),data:{color:this._converter.toColor(e.color,"#000000"),text:r}}))}))}else if("anchor"===e.format){e.data.forEach((e=>{if(!e.location||!e.data)return void this._logger.warn(c.LOGGINGTOPIC.DATA_PROCESSING,"HTMLElementAnchorEngine.load: One of the specified Anchor elements did not have all necessary properties.");let r,i;if(e.data.position&&(r={vertical:e.data.position.vertical,horizontal:e.data.position.horizontal}),e.intersectionTarget&&("string"==typeof e.intersectionTarget||Array.isArray(e.intersectionTarget)?i=e.intersectionTarget:e.intersectionTarget.min&&e.intersectionTarget.max&&(i=new u.Box(this._converter.toVec3(e.intersectionTarget.min),this._converter.toVec3(e.intersectionTarget.max)))),e.format&&"text"!==e.format){if("image"===e.format){if(!(e.data.src&&e.data.width&&e.data.height&&e.data.alt))return void this._logger.warn(c.LOGGINGTOPIC.DATA_PROCESSING,"HTMLElementAnchorEngine.load: One of the specified Anchor elements did not have all necessary properties.");const n=e.data;t.data.push(new a.HTMLElementAnchorImageData({location:this._converter.toVec3(e.location),data:{alt:n.alt,height:"string"==typeof n.height?+n.height:n.height,width:"string"==typeof n.width?+n.width:n.width,src:n.src,hidden:n.hidden,position:r},hideable:e.hideable,viewers:e.viewports,intersectionTarget:i}))}}else{if(!e.data.text)return void this._logger.warn(c.LOGGINGTOPIC.DATA_PROCESSING,"HTMLElementAnchorEngine.load: The text property for an Anchor element is missing.");const n=e.data,s=this._inputValidator.sanitize(n.text);t.data.push(new a.HTMLElementAnchorTextData({location:this._converter.toVec3(e.location),data:{color:this._converter.toColor(n.color,"#000000"),text:s,hidden:n.hidden,textAlign:n.textAlign,position:r},hideable:e.hideable,viewers:e.viewports,intersectionTarget:i}))}this._logger.warn(c.LOGGINGTOPIC.DATA_PROCESSING,`HTMLElementAnchorEngine.load: The Anchor does not have a recognized format: ${e.format}`)}))}return t}catch(e){const t=new c.ShapeDiverViewerDataProcessingError("HTMLElementAnchorEngine.load: Loading of anchors failed.");throw this._logger.handleError(c.LOGGINGTOPIC.DATA_PROCESSING,"HTMLElementAnchorEngine.load",t)}}))}};h=r([o.default()],h),e.exports.HTMLElementAnchorEngine=h})),s.register("jscMs",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SessionTreeNode=void 0;var n=s("eYU63");class o extends n.TreeNode{constructor(e,t,i,n,s){super(e,i,n,s),r.set(this,!0),t&&(this.id=t)}get sessionNode(){return i(this,r,"f")}}e.exports.SessionTreeNode=o,r=new WeakMap})),s.register("irHKn",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},n=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SessionOutputData=void 0;var o=s("eYU63");class a extends o.AbstractTreeNodeData{constructor(e,t){super(t),r.set(this,void 0),i(this,r,e,"f")}get responseOutput(){return n(this,r,"f")}set responseOutput(e){i(this,r,e,"f")}clone(){return new a(this.responseOutput,this.id)}}e.exports.SessionOutputData=a,r=new WeakMap})),s.register("7n1Em",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},n=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SessionData=void 0;var o=s("eYU63");class a extends o.AbstractTreeNodeData{constructor(e,t){super(t),r.set(this,void 0),i(this,r,e,"f")}get responseDto(){return n(this,r,"f")}set responseDto(e){i(this,r,e,"f")}clone(){return new a(this.responseDto,this.id)}}e.exports.SessionData=a,r=new WeakMap})),s.register("83NaM",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},p=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},m=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},g=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},v=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Api=void 0;var _=s("eYU63");s("yoicn");var b=s("bJEmL"),y=s("crO5Z"),E=s("kO6pq"),w=s("cTTbu"),x=s("iBhyF"),A=s("imozB"),T=s("jUi4u"),S=s("eIStk"),M=s("3iqbd"),C=s("12eGO"),R=s("l1HmL"),I=s("a83DK"),O=s("kp39A");let P=class{constructor(){r.set(this,"https://d2tuv7fwq0eipl.cloudfront.net/production/assets/img/icon_logo_white.png"),i.set(this,b.instance.resolve(w.EventEngine)),n.set(this,b.instance.resolve(E.GLTFConverter)),o.set(this,b.instance.resolve(w.InputValidator)),a.set(this,b.instance.resolve(w.Logger)),l.set(this,b.instance.resolve(w.SettingsEngine)),c.set(this,b.instance.resolve(w.StateEngine)),u.set(this,b.instance.resolve(w.SystemInfo)),h.set(this,b.instance.resolve(w.UuidGenerator)),this.sceneTree=b.instance.resolve(_.Tree),this.sessions={},this.viewers={},d.set(this,!0);try{g(this,c,"f").primarySessionAvailable.then((()=>{var e;null===(e=g(this,c,"f").primarySession)||void 0===e||e.settingsRegistered.then((()=>{this.showMessages=g(this,l,"f").general.showMessages}))})),console.log(`ShapeDiver-Viewer version: ${A.build_data.build_version}`),g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,"Api.constructor: Api created.")}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.constructor",e)}}get automaticUpdate(){return g(this,d,"f")}set automaticUpdate(e){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.automaticUpdate: Updating automaticUpdate to ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.GENERAL,"Api.automaticUpdate",e,"boolean"),v(this,d,e,"f");for(let e in this.sessions)g(this,d,"f")?this.sceneTree.addNode(this.sessions[e].node):this.sceneTree.removeNode(this.sessions[e].node);g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.automaticUpdate: automaticUpdate was set to: ${e}`)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.automaticUpdate",e)}}get enableAR(){return g(this,l,"f").ar.enable}set enableAR(e){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.enableAR: Updating enableAR to ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.GENERAL,"Api.enableAR",e,"boolean"),g(this,l,"f").ar.enable=e,g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.enableAR: enableAR was set to: ${e}`)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.enableAR",e)}}get globalRotation(){return S.fromValues(g(this,l,"f").general.transformation.rotation.x,g(this,l,"f").general.transformation.rotation.y,g(this,l,"f").general.transformation.rotation.z)}set globalRotation(e){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.globalRotation: Updating globalRotation to ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.GENERAL,"Api.globalRotation",e,"vec3"),g(this,l,"f").general.transformation.rotation={x:e[0],y:e[1],z:e[2]},g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.globalRotation: globalRotation was set to: ${e}`)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.globalRotation",e)}}get globalScale(){return S.fromValues(g(this,l,"f").general.transformation.scale.x,g(this,l,"f").general.transformation.scale.y,g(this,l,"f").general.transformation.scale.z)}set globalScale(e){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.globalScale: Updating globalScale to ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.GENERAL,"Api.globalScale",e,"vec3"),g(this,l,"f").general.transformation.scale={x:e[0],y:e[1],z:e[2]},g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.globalScale: globalScale was set to: ${e}`)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.globalScale",e)}}get globalTranslation(){return S.fromValues(g(this,l,"f").general.transformation.translation.x,g(this,l,"f").general.transformation.translation.y,g(this,l,"f").general.transformation.translation.z)}set globalTranslation(e){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.globalTranslation: Updating globalTranslation to ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.GENERAL,"Api.globalTranslation",e,"vec3"),g(this,l,"f").general.transformation.translation={x:e[0],y:e[1],z:e[2]},g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.globalTranslation: globalTranslation was set to: ${e}`)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.globalTranslation",e)}}get loggingLevel(){return g(this,a,"f").loggingLevel}set loggingLevel(e){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.loggingLevel: Updating LoggingLevel to ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.GENERAL,"Api.loggingLevel",e,"enum",!0,Object.values(w.LOGGINGLEVEL)),g(this,a,"f").loggingLevel=e,g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.loggingLevel: LoggingLevel was set to: ${e}`)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.loggingLevel",e)}}get showMessages(){return g(this,a,"f").showMessages}set showMessages(e){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.showMessages: Updating ShowMessages to ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.GENERAL,"Api.showMessages",e,"boolean"),g(this,a,"f").showMessages=e,g(this,l,"f").general.showMessages=g(this,a,"f").showMessages,g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.showMessages: ShowMessages was set to: ${e}`)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.showMessages",e)}}addListener(e,t){try{return g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.addListener: Event Listener was registered for ${e}.`),g(this,a,"f").debug(w.LOGGINGTOPIC.GENERAL,`Api.addListener: Event Listener was registered for ${e}.`),g(this,i,"f").addListener(e,t)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.addListener",e)}}applySettings(e,t={session:{parameter:{displayname:!1,order:!1,hidden:!1},export:{displayname:!1,order:!1,hidden:!1}},viewer:{scene:!1,camera:!1,light:!1,environment:!1}}){return m(this,void 0,void 0,(function*(){try{let r;if(void 0===t.session&&(t.session={parameter:{displayname:!1,order:!1,hidden:!1},export:{displayname:!1,order:!1,hidden:!1}}),void 0===t.session.parameter&&(t.session.parameter={displayname:!1,order:!1,hidden:!1}),void 0===t.session.export&&(t.session.export={displayname:!1,order:!1,hidden:!1}),void 0===t.viewer&&(t.viewer={scene:!1,camera:!1,light:!1,environment:!1}),void 0===e.viewer){const e=new w.ShapeDiverViewerSettingsError("Api.applySettings: No config object available.");throw g(this,a,"f").handleError(w.LOGGINGTOPIC.SETTINGS,"Api.applySettings",e)}r=e.viewer.config;try{T.validate(r)}catch(e){const t=new w.ShapeDiverViewerSettingsError("Api.applySettings: Was not able to validate config object.");throw g(this,a,"f").handleError(w.LOGGINGTOPIC.SETTINGS,"Api.applySettings",t)}const i=T.convert(r,"3.1"),n={};if((t.session.export.displayname||t.session.export.order||t.session.export.hidden)&&e.exports)for(let t in e.exports)void 0!==e.exports[t].uid&&(n[e.exports[t].uid]=t);const s=Object.values(this.sessions).filter((e=>e.primarySession))[0];if(!s){const e=new w.ShapeDiverViewerSettingsError("Api.applySettings: No primary session defined.");throw g(this,a,"f").handleError(w.LOGGINGTOPIC.SETTINGS,"Api.applySettings",e)}const o=g(this,l,"f").settings;if(t.session.parameter.displayname||t.session.parameter.order||t.session.parameter.hidden)for(let e in s.parameters)i.session[e]&&(t.session.parameter.displayname&&(s.parameters[e].displayname=i.session[e].displayname),t.session.parameter.order&&(s.parameters[e].order=i.session[e].order),t.session.parameter.hidden&&(s.parameters[e].hidden=i.session[e].hidden||!1));if(t.session.export.displayname||t.session.export.order||t.session.export.hidden)for(let e in s.exports){let r="";if(i.session[e])r=e;else{const t=s.exports[e].uid;if(!t)continue;if(!n[t])continue;r=n[t]}i.session[r]&&(t.session.parameter.displayname&&(s.exports[e].displayname=i.session[r].displayname),t.session.parameter.order&&(s.exports[e].order=i.session[r].order),t.session.parameter.hidden&&(s.exports[e].hidden=i.session[r].hidden||!1))}t.viewer.camera&&(o.camera=i.camera),t.viewer.light&&(o.light=i.light),t.viewer.scene&&(o.rendering.shadows=i.rendering.shadows,o.rendering.ambientOcclusion=i.rendering.ambientOcclusion,o.rendering.ambientOcclusionIntensity=i.rendering.ambientOcclusionIntensity,o.rendering.outputEncoding=i.rendering.outputEncoding,o.rendering.physicallyCorrectLights=i.rendering.physicallyCorrectLights,o.rendering.textureEncoding=i.rendering.textureEncoding,o.rendering.toneMapping=i.rendering.toneMapping,o.rendering.toneMappingExposure=i.rendering.toneMappingExposure,o.environmentGeometry.gridColor=i.environmentGeometry.gridColor,o.environmentGeometry.gridVisibility=i.environmentGeometry.gridVisibility,o.environmentGeometry.groundPlaneColor=i.environmentGeometry.groundPlaneColor,o.environmentGeometry.groundPlaneVisibility=i.environmentGeometry.groundPlaneVisibility,o.general.commitParameters=i.general.commitParameters,o.general.pointSize=i.general.pointSize),t.viewer.environment&&(o.environment.clearAlpha=i.environment.clearAlpha,o.environment.clearColor=i.environment.clearColor,o.environment.map=i.environment.map,o.environment.mapAsBackground=i.environment.mapAsBackground);const u=[];for(let e in this.viewers)g(this,c,"f").viewers[e].settingsLoaded.reset(),u.push(new Promise((t=>{g(this,c,"f").viewers[e].settingsLoaded.then((()=>{t()}))}))),this.viewers[e].applySettings(t.viewer);return new Promise((e=>Promise.all(u).then((()=>e()))))}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.applySettings",e)}}))}closeSession(e,t=!1){return m(this,void 0,void 0,(function*(){return this._closeSession(e,t)}))}closeViewer(e){return m(this,void 0,void 0,(function*(){return this._closeViewer(e)}))}convertSceneToGLTF(e=!1){return m(this,void 0,void 0,(function*(){try{let t=M.fromScaling(M.create(),this.globalScale);const r=g(this,h,"f").create();this.sceneTree.root.transformations.push({id:r,matrix:t});const i=yield g(this,n,"f").convert(this.sceneTree.root,e);for(let e=0;e<this.sceneTree.root.transformations.length;e++)this.sceneTree.root.transformations[e].id===r&&this.sceneTree.root.transformations.splice(e,1);return new Blob([i],{type:"application/octet-stream"})}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.convertSceneToGLTF",e)}}))}createSDTFOverview(e=this.sceneTree.root){try{const t=new C.SDTFAttributeOverview({});for(let r=0,i=e.data.length;r<i;r++)e.data[r]instanceof C.SDTFAttributeOverview&&t.merge(e.data[r]);for(let r=0,i=e.children.length;r<i;r++)t.merge(new C.SDTFAttributeOverview(this.createSDTFOverview(e.children[r])));return t.overview}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.createSDTFOverview",e)}}createSession(e){return m(this,void 0,void 0,(function*(){let t="";const r=g(this,h,"f").create();try{const n={type:C.TASKTYPE.SESSION_CREATION,id:r,progress:0,status:"Creating session"};if(g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_START,n),g(this,a,"f").info(w.LOGGINGTOPIC.SESSION,`Api.createSession: Creating and initializing session with properties ${JSON.stringify(e)}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e,"object"),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.ticket,"string"),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.modelViewUrl,"string"),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.bearerToken,"string",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.primarySession,"boolean",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.excludeViewers,"stringArray",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.id,"string",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.waitForOutputs,"boolean",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.loadOutputs,"boolean",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.initialParameters,"object",!1),e.initialParameters)for(let t in e.initialParameters)g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.createSession",e.initialParameters[t],"string");if(t=e.id||b.instance.resolve(w.UuidGenerator).create(),this.sessions[t]){const e={type:C.TASKTYPE.SESSION_CREATION,id:r,progress:.1,status:"Closing session with same id"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_PROCESS,e),g(this,a,"f").warn(w.LOGGINGTOPIC.SESSION,`Api.createSession: Session with this id (${t}) already exists. Closing initial instance.`),yield this._closeSession(t,!0)}let s=!0;for(let e in this.sessions)this.sessions[e].primarySession&&(s=!1);let l=!1!==e.primarySession;g(this,c,"f").sessions[t]={id:t,primary:!(!l||!s),initialized:new w.StatePromise,settingsRegistered:new w.StatePromise},l&&s&&g(this,c,"f").primarySessionAvailable.resolve(!0);const u=new I.Session(Object.assign({},e,{id:t}));this.sessions[t]=u;const h={type:C.TASKTYPE.SESSION_CREATION,id:r,progress:.25,status:"Initializing session"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_PROCESS,h),yield u.init(e.waitForOutputs,e.loadOutputs,e.initialParameters),g(this,i,"f").emitEvent(w.EVENTTYPE.SESSION.SESSION_CREATED,{sessionId:t}),g(this,c,"f").sessions[t].initialized.resolve(!0),g(this,a,"f").debug(w.LOGGINGTOPIC.SESSION,`Api.createSession: Session(${u.id}) created.`);const d={type:C.TASKTYPE.SESSION_CREATION,id:r,progress:1,status:"Session created"};return g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_END,d),u}catch(e){if((e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)&&(this.sessions[t]&&1===Object.values(this.sessions).length||!this.sessions[t]&&0===Object.values(this.sessions).length))for(let t in this.viewers)this.viewers[t].displayErrorMessage(e.message);const n={type:C.TASKTYPE.SESSION_CREATION,id:r,progress:.9,status:"Session created failed, closing session"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_PROCESS,n),yield this._closeSession(t,!0);const s={type:C.TASKTYPE.SESSION_CREATION,id:r,progress:1,status:"Session created failed"};if(g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_CANCEL,s),e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.createSession",e)}}))}createViewer(e){return m(this,void 0,void 0,(function*(){const t=g(this,h,"f").create();try{const n={type:C.TASKTYPE.VIEWER_CREATION,id:t,progress:0,status:"Creating viewer"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_START,n),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.createViewer",e,"object",!1);const s=Object.assign({},e);g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.createViewer",s.visibility,"enum",!1,Object.values(x.VISIBILITYMODE)),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.createViewer",s.canvas,"HTMLCanvasElement",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.createViewer",s.id,"string",!1),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.createViewer",s.branding,"object",!1);const l=Object.assign({},s.branding);g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.createViewer",l.backgroundColor,"string",!1);const u=s.id||b.instance.resolve(w.UuidGenerator).create();if(this.viewers[u]){const e={type:C.TASKTYPE.VIEWER_CREATION,id:t,progress:.1,status:"Closing viewer with same id"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_PROCESS,e),g(this,a,"f").warn(w.LOGGINGTOPIC.SESSION,`Api.createViewer: Viewer with this id (${u}) already exists. Closing initial instance.`),yield this._closeViewer(u,!0)}g(this,c,"f").viewers[u]={id:u,initialized:new w.StatePromise,environmentMapLoaded:new w.StatePromise,settingsLoaded:new w.StatePromise};let h=new O.Viewer({id:u,canvas:s.canvas,visibility:s.visibility||x.VISIBILITYMODE.SESSION,branding:{logo:void 0===l.logo?g(this,r,"f"):l.logo,backgroundColor:l.backgroundColor||"#030531FF"}});if((s.visibility||x.VISIBILITYMODE.SESSION)===x.VISIBILITYMODE.SESSION&&g(this,c,"f").primarySession&&!0===g(this,c,"f").primarySession.initialized.resolved){const e={type:C.TASKTYPE.VIEWER_CREATION,id:t,progress:.75,status:"Waiting for primary session settings"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_PROCESS,e),yield new Promise((e=>{g(this,c,"f").viewers[u].settingsLoaded.then((()=>e()))}))}this.viewers[u]=h,h.update(),g(this,i,"f").emitEvent(w.EVENTTYPE.VIEWER.VIEWER_CREATED,{viewerId:u}),g(this,c,"f").viewers[u].initialized.resolve(!0),g(this,a,"f").debug(w.LOGGINGTOPIC.VIEWER,`Api.createViewer: Viewer(${h.id}) created.`);const d={type:C.TASKTYPE.VIEWER_CREATION,id:t,progress:1,status:"Viewer created"};return g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_END,d),this.viewers[u]}catch(e){const r={type:C.TASKTYPE.VIEWER_CREATION,id:t,progress:.9,status:"Viewer created failed, closing viewer"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_PROCESS,r);try{yield this._closeViewer("",!0)}catch(e){}const n={type:C.TASKTYPE.VIEWER_CREATION,id:t,progress:1,status:"Viewer created failed, exiting"};if(g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_CANCEL,n),e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.createViewer",e)}}))}removeListener(e){try{return g(this,a,"f").debugLow(w.LOGGINGTOPIC.GENERAL,`Api.removeListener: Removing event listener with id ${e}.`),g(this,i,"f").removeListener(e)}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.removeListener",e)}}update(){try{g(this,a,"f").debugLow(w.LOGGINGTOPIC.VIEWER,"Api.update: Updating all viewers.");for(let e in this.viewers)this.viewers[e].update()}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.update",e)}}viewInAR(e={arScale:"auto",arPlacement:"floor",xrEnvironment:!1}){return m(this,void 0,void 0,(function*(){const t=g(this,h,"f").create(),n=g(this,h,"f").create();try{const s={type:C.TASKTYPE.AR_LOADING,id:t,progress:0,status:"Loading AR scene"};if(g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_START,s),!1===this.viewableInAR()){const e={type:C.TASKTYPE.AR_LOADING,id:t,progress:1,status:"Stopped AR loading due to an error"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_CANCEL,e);const r=new w.ShapeDiverViewerArError('Api.viewInAR: The device or browser is not supported for this functionality, please call "viewableInAR" for more information.');throw g(this,a,"f").handleError(w.LOGGINGTOPIC.AR,"Api.viewInAR",r,!1)}g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.viewInAR",e,"object",!1);const l="auto"!==e.arScale?"fixed":"auto";e.arPlacement,e.xrEnvironment;let c;for(let e in this.sessions)if(this.sessions[e].canUploadGLTF){c=this.sessions[e];break}if(!c){const e={type:C.TASKTYPE.AR_LOADING,id:t,progress:1,status:"Stopped AR loading due to an error"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_CANCEL,e);const r=new w.ShapeDiverViewerArError("Api.viewInAR: None of the sessions that are registered are capable of using the AR feature.");throw g(this,a,"f").handleError(w.LOGGINGTOPIC.AR,"Api.viewInAR",r,!1)}let h="";for(let e in this.viewers)if(!c.node.excludeViewers.includes(this.viewers[e].id)){const t=this.viewers[e].getEnvironmentMapImageUrl();""!==t&&(h=t.endsWith(".hdr")?"skybox-image="+t:"environment-image="+t);break}for(let e in this.viewers)this.viewers[e].registerBusyMode(n);const d=yield c.uploadGLTF(g(this,u,"f").isIOS?R.ShapeDiverRequestGltfUploadQueryConversion.USDZ:R.ShapeDiverRequestGltfUploadQueryConversion.NONE,t);if(g(this,u,"f").isIOS){const e=document.createElement("a");e.href=d+("fixed"===l?".usdz#allowsContentScaling=0":".usdz"),e.rel="ar";const t=document.createElement("img");t.src=g(this,r,"f"),e.appendChild(t),e.click()}else{const e=document.createElement("a");e.href=`intent://arvr.google.com/scene-viewer/1.0?resizable=${"fixed"===l?"false":"true"}&file=${d}&mode=ar_only#Intent;scheme=https;package=com.google.ar.core;action=android.intent.action.VIEW;end;`,e.click()}for(let e in this.viewers)this.viewers[e].deregisterBusyMode(n);const f={type:C.TASKTYPE.AR_LOADING,id:t,progress:1,status:"Done loading AR scene, launching AR"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_END,f)}catch(e){const r={type:C.TASKTYPE.AR_LOADING,id:t,progress:1,status:"Stopped AR loading due to an error"};g(this,i,"f").emitEvent(w.EVENTTYPE.TASK.TASK_CANCEL,r);for(let e in this.viewers)this.viewers[e].deregisterBusyMode(n);if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.viewInAR",e)}}))}viewableInAR(){try{return(!1!==g(this,u,"f").isIOS||!1!==g(this,u,"f").isAndroid)&&((!0!==g(this,u,"f").isAndroid||!0!==g(this,u,"f").isFirefox)&&(!0!==g(this,u,"f").isIOS||!0!==g(this,u,"f").isFirefox))}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.viewableInAR",e)}}_closeSession(e,t=!1){return m(this,void 0,void 0,(function*(){try{if(g(this,a,"f").debugLow(w.LOGGINGTOPIC.SESSION,`Api.closeSession: Closing session ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.SESSION,"Api.closeSession",e,"string"),!this.sessions[e])return g(this,a,"f").warn(w.LOGGINGTOPIC.SESSION,`Api.closeSession: Session with id ${e} was not registered.`),!1;!1===t&&!1===g(this,c,"f").sessions[e].initialized.resolved&&(yield new Promise((t=>{g(this,c,"f").sessions[e].initialized.then((()=>t()))})));let r=!1;if(!1===t)r=yield this.sessions[e].close();else try{r=yield this.sessions[e].close()}catch(e){}if(g(this,c,"f").sessions[e].settingsRegistered.reset(),this.sessions[e].primarySession){g(this,c,"f").primarySessionAvailable.reset(),g(this,c,"f").boundingBoxCreated.reset();for(let e in this.viewers)this.viewers[e].reset()}this.sessions[e]=void 0,delete this.sessions[e],delete g(this,c,"f").sessions[e],g(this,a,"f").debug(w.LOGGINGTOPIC.SESSION,`Session(${e}): Session closed.`);for(let e in this.sessions){if(this.sessions[e].primarySessionRequest){yield this.sessions[e].setAsPrimary(),g(this,c,"f").primarySessionAvailable.resolve(!0),g(this,a,"f").debug(w.LOGGINGTOPIC.SESSION,`Session(${e}): Initializing settings.`);break}}return r}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.closeSession",e)}}))}_closeViewer(e,t=!1){return m(this,void 0,void 0,(function*(){try{if(g(this,a,"f").debugLow(w.LOGGINGTOPIC.VIEWER,`Api.closeViewer: Closing viewer ${e}.`),g(this,o,"f").validateAndError(w.LOGGINGTOPIC.VIEWER,"Api.closeViewer",e,"string"),!this.viewers[e])return g(this,a,"f").warn(w.LOGGINGTOPIC.VIEWER,`Api.closeViewer: Viewer with id ${e} was not registered`),!1;!1===t&&!1===g(this,c,"f").viewers[e].initialized.resolved&&(yield new Promise((t=>{g(this,c,"f").viewers[e].initialized.then((()=>t()))}))),g(this,c,"f").viewers[e].settingsLoaded.reset();let r=!1;if(!1===t)r=yield this.viewers[e].close();else try{r=yield this.viewers[e].close()}catch(e){}return this.viewers[e]=void 0,delete this.viewers[e],delete g(this,c,"f").viewers[e],g(this,a,"f").debug(w.LOGGINGTOPIC.VIEWER,`Viewer(${e}): Viewer closed.`),r}catch(e){if(e instanceof w.ShapeDiverViewerError||e instanceof w.ShapeDiverBackendError)throw e;throw g(this,a,"f").handleError(w.LOGGINGTOPIC.GENERAL,"Api.closeViewer",e)}}))}};r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,P=f([y.default(),p("design:paramtypes",[])],P),e.exports.Api=P})),s.register("kO6pq",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GLTFConverter=void 0;var r=s("4Fpyw");Object.defineProperty(e.exports,"GLTFConverter",{enumerable:!0,get:function(){return r.GLTFConverter}})})),s.register("4Fpyw",(function(e,t){var r=e.exports&&e.exports.__createBinding||(Object.create?function(e,t,r,i){void 0===i&&(i=r),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}),i=e.exports&&e.exports.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),n=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},o=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GLTFConverter=e.exports.GLTF_EXTENSIONS=void 0;var c=s("imozB"),u=s("eYU63"),h=s("cTTbu");s("yoicn");var d=s("bJEmL"),f=s("crO5Z"),p=s("1BiQ9"),m=s("3iqbd"),g=s("eIStk"),v=s("12eGO");const _=o(s("ilwiq"));var b;(b=e.exports.GLTF_EXTENSIONS||(e.exports.GLTF_EXTENSIONS={})).KHR_BINARY_GLTF="KHR_binary_glTF",b.KHR_MATERIALS_PBRSPECULARGLOSSINESS="KHR_materials_pbrSpecularGlossiness",b.KHR_MATERIALS_UNLIT="KHR_materials_unlit";let y=class{constructor(){this._converter=d.instance.resolve(h.Converter),this._globalTransformationInverse=m.fromValues(1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1),this._uuidGenerator=d.instance.resolve(h.UuidGenerator),this._animations=[],this._buffers=[],this._byteOffset=0,this._content={asset:{copyright:"2021 (c) ShapeDiver",generator:"ShapeDiverViewer@"+c.build_data.build_version,version:"2.0",extensions:{}}},this._convertForAR=!1,this._extensionsRequired=[],this._extensionsUsed=[],this._imageCache={},this._nodes=[],this._promises=[],this._mergeShader=new _.ShaderMaterial({uniforms:{tRed:{value:null},activeRed:{value:!1},defaultRed:{value:1},tGreen:{value:null},activeGreen:{value:!1},defaultGreen:{value:1},tBlue:{value:null},activeBlue:{value:!1},defaultBlue:{value:1}},vertexShader:"// @author Michael Oppitz \n\n            uniform sampler2D tRed;\n            uniform bool activeRed;\n            uniform float defaultRed;\n            \n            uniform sampler2D tGreen;\t\t\n            uniform bool activeGreen;\n            uniform float defaultGreen;\n            \n            uniform sampler2D tBlue;\t\t\n            uniform bool activeBlue;\n            uniform float defaultBlue;\n\n            varying vec2 vUv;\n            \n            void main() {\n                vUv = uv;\n                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n            }",fragmentShader:"// @author Michael Oppitz \n\n            uniform sampler2D tRed;\n            uniform bool activeRed;\n            uniform float defaultRed;\n            \n            uniform sampler2D tGreen;\t\t\n            uniform bool activeGreen;\n            uniform float defaultGreen;\n            \n            uniform sampler2D tBlue;\t\t\n            uniform bool activeBlue;\n            uniform float defaultBlue;\n            \n            varying vec2 vUv;\n            \n            void main() {\n                vec4 outColor = vec4(0.0, 0.0, 0.0, 1.0);\n\n                if(activeRed == true) {\n                    outColor.r = texture2D(tRed, vUv).r;\n                } else {\n                    outColor.r = defaultRed;\n                }\n            \n                if(activeGreen == true) {\n                    outColor.g = texture2D(tGreen, vUv).g;\n                } else {\n                    outColor.g = defaultGreen;\n                }\n            \n                if(activeBlue == true) {\n                    outColor.b = texture2D(tBlue, vUv).b;\n                } else {\n                    outColor.b = defaultBlue;\n                }\n            \n                gl_FragColor = outColor;\n            }"}),this._quadCamera=new _.OrthographicCamera(-1,1,1,-1,0,1),this._quadScene=new _.Scene;const e=new _.Mesh(new _.PlaneGeometry(2,2),this._mergeShader);this._quadScene.add(e),this._renderer=new _.WebGLRenderer}convert(e,t=!1){var r;return l(this,void 0,void 0,(function*(){this.reset(),this._convertForAR=t;const i=new u.TreeNode("ShapeDiverRootNode");i.addChild(e);const n={name:i.name,nodes:[]},s=this._uuidGenerator.create();e.transformations.push({id:s,matrix:this._globalTransformationInverse});const o=this._uuidGenerator.create();if(t){const t=e.boundingBox.clone(),r=g.fromValues(-(t.max[0]+t.min[0])/2,-(t.max[1]+t.min[1])/2,-(t.max[2]+t.min[2])/2);let i=m.fromTranslation(m.create(),r);e.transformations.push({id:o,matrix:i})}null===(r=n.nodes)||void 0===r||r.push(this.convertNode(e));for(let t=0;t<e.transformations.length;t++)e.transformations[t].id===s&&e.transformations.splice(t,1);if(t)for(let t=0;t<e.transformations.length;t++)e.transformations[t].id===o&&e.transformations.splice(t,1);this._content.scenes=[],this._content.scenes.push(n),this.convertAnimations();const a=Object.keys(this._extensionsUsed);a.length>0&&(this._content.extensionsUsed=a);const l=Object.keys(this._extensionsRequired);l.length>0&&(this._content.extensionsRequired=l);let c=0;for(;c!==this._promises.length;)c=this._promises.length,yield Promise.all(this._promises),yield new Promise((e=>setTimeout(e,0)));const h=new Blob(this._buffers,{type:"application/octet-stream"});return this._content.buffers&&this._content.buffers.length>0&&(this._content.buffers[0].byteLength=h.size),new Promise((e=>{const t=new window.FileReader;t.readAsArrayBuffer(h),t.onloadend=()=>{const r=this.getPaddedArrayBuffer(t.result),i=new DataView(new ArrayBuffer(8));i.setUint32(0,r.byteLength,!0),i.setUint32(4,5130562,!0);const n=this.getPaddedArrayBuffer(this.stringToArrayBuffer(JSON.stringify(this._content)),32),s=new DataView(new ArrayBuffer(8));s.setUint32(0,n.byteLength,!0),s.setUint32(4,1313821514,!0);const o=new ArrayBuffer(12),a=new DataView(o);a.setUint32(0,1179937895,!0),a.setUint32(4,2,!0);const l=12+s.byteLength+n.byteLength+i.byteLength+r.byteLength;a.setUint32(8,l,!0);const c=new Blob([o,s,n,i,r],{type:"application/octet-stream"}),u=new window.FileReader;u.readAsArrayBuffer(c),u.onloadend=()=>{e(u.result)}}}))}))}combineTextures(e,t,r){return l(this,void 0,void 0,(function*(){if(!e&&!t&&!r)throw new Error("No maps supplied.");let i=0,n=0;const s=[e,t,r];for(let e of s)if(e)if(0===i&&0===n)i=e.image.width,n=e.image.height;else if(e.image.width!==i&&e.image.height!==n)throw new Error("Maps have different sizes. Combining not supported.");if(e){const t=new _.Texture(e.image);t.needsUpdate=!0,this._mergeShader.uniforms.tRed.value=t,this._mergeShader.uniforms.activeRed.value=!0}else this._mergeShader.uniforms.activeRed.value=!1;if(t){const e=new _.Texture(t.image);e.needsUpdate=!0,this._mergeShader.uniforms.tGreen.value=e,this._mergeShader.uniforms.activeGreen.value=!0}else this._mergeShader.uniforms.activeGreen.value=!1;if(r){const e=new _.Texture(r.image);e.needsUpdate=!0,this._mergeShader.uniforms.tBlue.value=e,this._mergeShader.uniforms.activeBlue.value=!0}else this._mergeShader.uniforms.activeBlue.value=!1;const o=new _.WebGLRenderTarget(i,n,{minFilter:_.LinearFilter,magFilter:_.LinearFilter,format:_.RGBAFormat});o.texture.name="target.rt",this._renderer.setRenderTarget(o),this._renderer.render(this._quadScene,this._quadCamera);const a=new Uint8ClampedArray(4*i*n);this._renderer.readRenderTargetPixels(o,0,0,i,n,a);let l=new ImageData(a,i,n);var c=document.createElement("canvas"),u=c.getContext("2d");c.width=l.width,c.height=l.height,u.putImageData(l,0,0);const h=new Image,d=new Promise((e=>{h.onload=()=>e()}));h.crossOrigin="anonymous",h.src=c.toDataURL("image/jpeg",1),yield d;const f=e||t||r;return new v.MapData(h,f.wrapS,f.wrapT,f.minFilter,f.magFilter,f.center,f.color,f.offset,f.repeat,f.rotation,f.flipY)}))}convertAccessor(e){this._content.accessors||(this._content.accessors=[]);const t=this.convertBufferView(e),r=this.getMinMax(e),i={bufferView:t,byteOffset:0,componentType:this.getComponentType(e.array),normalized:e.normalized,count:+e.count,max:r.max,min:r.min,type:this.getType(e.itemSize)};return this._content.accessors.push(i),this._content.accessors.length-1}convertAnimations(){var e;!this._content.animations&&this._animations.length>0&&(this._content.animations=[]);for(let t=0;t<this._animations.length;t++){const r=this._animations[t],i={name:r.name||"animation_"+t,channels:[],samplers:[]};for(let e=0;e<r.tracks.length;e++){const t=r.tracks[e],n=this._nodes.find((e=>e.node===t.node));if(!n)continue;const s=Math.min(...t.times),o=Math.max(...t.times),a=new v.AttributeData(new Float32Array(t.times),1,4,0,4,!1,t.times.length,[s],[o]),l=[];l.push(Math.min(...t.values.filter(((e,r)=>r%("rotation"===t.path?4:3)==0)))),l.push(Math.min(...t.values.filter(((e,r)=>r%("rotation"===t.path?4:3)==1)))),l.push(Math.min(...t.values.filter(((e,r)=>r%("rotation"===t.path?4:3)==2)))),"rotation"===t.path&&l.push(Math.min(...t.values.filter(((e,t)=>t%4==3))));const c=[];c.push(Math.max(...t.values.filter(((e,r)=>r%("rotation"===t.path?4:3)==0)))),c.push(Math.max(...t.values.filter(((e,r)=>r%("rotation"===t.path?4:3)==1)))),c.push(Math.max(...t.values.filter(((e,r)=>r%("rotation"===t.path?4:3)==2)))),"rotation"===t.path&&c.push(Math.max(...t.values.filter(((e,t)=>t%4==3))));const u=new v.AttributeData(new Float32Array(t.values),"rotation"===t.path?4:3,"rotation"===t.path?16:12,0,4,!1,t.times.length,l,c,"rotation"===t.path?16:12),h={input:this.convertAccessor(a),output:this.convertAccessor(u),interpolation:t.interpolation.toUpperCase()};i.samplers.push(h);const d={sampler:i.samplers.length-1,target:{node:n.id,path:t.path}};i.channels.push(d)}null===(e=this._content.animations)||void 0===e||e.push(i)}}convertBuffer(e){return this._content.buffers||(this._content.buffers=[]),0===this._content.buffers.length&&(this._content.buffers=[{byteLength:0}]),this._buffers.push(e),0}convertBufferView(e){this._content.bufferViews||(this._content.bufferViews=[]);let t=this.getComponentType(e.array),r=p.ACCESSORCOMPONENTSIZE_V2[t];const i=4*Math.ceil(e.count*e.itemSize*r/4),n=new DataView(new ArrayBuffer(i));let s=0;for(let t=0;t<e.count;t++)for(let i=0;i<e.itemSize;i++){let o=0;e.itemSize>4?o=e.array[t*e.itemSize+i]:0===i?o=e.array[t*e.itemSize]:1===i?o=e.array[t*e.itemSize+1]:2===i?o=e.array[t*e.itemSize+2]:3===i&&(o=e.array[t*e.itemSize+3]),e.array instanceof Float32Array?n.setFloat32(s,o,!0):e.array instanceof Uint32Array?n.setUint32(s,o,!0):e.array instanceof Uint16Array?n.setUint16(s,o,!0):e.array instanceof Int16Array?n.setInt16(s,o,!0):e.array instanceof Uint8Array?n.setUint8(s,o):e.array instanceof Int8Array&&n.setInt8(s,o),s+=r}const o={buffer:this.convertBuffer(n.buffer),byteOffset:this._byteOffset,byteLength:i};return this._byteOffset+=i,this._content.bufferViews.push(o),this._content.bufferViews.length-1}convertBufferViewImage(e){return l(this,void 0,void 0,(function*(){return this._content.bufferViews||(this._content.bufferViews=[]),new Promise((t=>{const r=new window.FileReader;r.readAsArrayBuffer(e),r.onloadend=()=>{const e=this.getPaddedArrayBuffer(r.result),i={buffer:this.convertBuffer(e),byteOffset:this._byteOffset,byteLength:e.byteLength};this._byteOffset+=e.byteLength,this._content.bufferViews.push(i),t(this._content.bufferViews.length-1)}}))}))}convertImage(e){if(this._content.images||(this._content.images=[]),this._imageCache[e.image.src])return this._imageCache[e.image.src];const t={},r=document.createElement("canvas");r.width=e.image.width,r.height=e.image.height;const i=r.getContext("2d");e.flipY&&(i.translate(0,r.height),i.scale(1,-1));let n="image/png";(e.image.src.endsWith(".jpg")||e.image.src.includes("image/jpeg"))&&(n="image/jpeg"),t.mimeType=n;if(/^data:(.*?)(;base64)?,(.*)$/.test(e.image.src)){const r=atob(e.image.src.split(",")[1]),i=e.image.src.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(r.length),s=new Uint8Array(n);for(let e=0;e<r.length;e++)s[e]=r.charCodeAt(e);const o=new Blob([n],{type:i});this._promises.push(new Promise((e=>l(this,void 0,void 0,(function*(){const r=yield this.convertBufferViewImage(o);t.bufferView=r,e()})))))}else i.drawImage(e.image,0,0,r.width,r.height),this._promises.push(new Promise((e=>{r.toBlob((r=>l(this,void 0,void 0,(function*(){const i=yield this.convertBufferViewImage(r);t.bufferView=i,e()}))),n)})));return this._content.images.push(t),this._imageCache[e.image.src]=this._content.images.length-1,this._content.images.length-1}convertMaterial(e,t=!0){this._content.materials||(this._content.materials=[]);const r={name:e.id,pbrMetallicRoughness:{}};if(e instanceof v.MaterialSpecularGlossinessData){this._extensionsUsed.includes("KHR_materials_pbrSpecularGlossiness")||this._extensionsUsed.push("KHR_materials_pbrSpecularGlossiness"),this._extensionsRequired.includes("KHR_materials_pbrSpecularGlossiness")||this._extensionsRequired.push("KHR_materials_pbrSpecularGlossiness");const i={};i.diffuseFactor=this._converter.toColorArray(e.color),i.diffuseFactor[3]=e.opacity,e.map&&t&&(i.diffuseTexture={index:this.convertTexture(e.map)}),i.specularFactor=this._converter.toColorArray(e.specular),i.glossinessFactor=e.glossiness,e.specularGlossinessMap&&t&&(i.specularGlossinessTexture={index:this.convertTexture(e.specularGlossinessMap)}),r.extensions={KHR_materials_pbrSpecularGlossiness:i}}else if(e instanceof v.MaterialUnlitData)this._extensionsUsed.includes("KHR_materials_unlit")||this._extensionsUsed.push("KHR_materials_unlit"),this._extensionsRequired.includes("KHR_materials_unlit")||this._extensionsRequired.push("KHR_materials_unlit"),r.pbrMetallicRoughness.baseColorFactor=this._converter.toColorArray(e.color),r.pbrMetallicRoughness.baseColorFactor[3]=e.opacity,e.map&&t&&(r.pbrMetallicRoughness.baseColorTexture={index:this.convertTexture(e.map)}),r.extensions={KHR_materials_unlit:{}};else{const i=e;r.pbrMetallicRoughness.baseColorFactor=this._converter.toColorArray(i.color),r.pbrMetallicRoughness.baseColorFactor[3]=i.opacity,i.map&&t&&(r.pbrMetallicRoughness.baseColorTexture={index:this.convertTexture(i.map)}),r.pbrMetallicRoughness.metallicFactor=i.metalnessMap?1:i.metalness,r.pbrMetallicRoughness.roughnessFactor=i.roughnessMap?1:i.roughness,i.metalnessRoughnessMap&&t?r.pbrMetallicRoughness.metallicRoughnessTexture={index:this.convertTexture(i.metalnessRoughnessMap)}:(i.metalnessMap||i.roughnessMap)&&t&&this._promises.push(new Promise((e=>l(this,void 0,void 0,(function*(){const t=yield this.combineTextures(void 0,i.roughnessMap,i.metalnessMap);r.pbrMetallicRoughness.metallicRoughnessTexture={index:this.convertTexture(t)},e()})))))}return e.normalMap&&t&&(r.normalTexture={index:this.convertTexture(e.normalMap)}),e.aoMap&&t&&(r.occlusionTexture={index:this.convertTexture(e.aoMap)}),e.emissiveMap&&t&&(r.emissiveTexture={index:this.convertTexture(e.emissiveMap)}),e.emissiveness&&(r.emissiveFactor=this._converter.toColorArray(e.emissiveness)),r.alphaMode=e.alphaMode.toUpperCase(),e.alphaMode===v.MATERIAL_ALPHA.MASK&&(r.alphaCutoff=e.alphaCutoff),r.doubleSided=e.side===v.MATERIAL_SIDE.DOUBLE,this._content.materials.push(r),this._content.materials.length-1}convertMesh(e){var t;this._content.meshes||(this._content.meshes=[]);const r={primitives:[],name:e.id};return null===(t=r.primitives)||void 0===t||t.push(this.convertPrimitive(e.primitive)),this._content.meshes.push(r),this._content.meshes.length-1}convertNode(e){var t;this._content.nodes||(this._content.nodes=[]);const r={name:e.name};e.transformations.length>0&&(r.matrix=[e.nodeMatrix[0],e.nodeMatrix[1],e.nodeMatrix[2],e.nodeMatrix[3],e.nodeMatrix[4],e.nodeMatrix[5],e.nodeMatrix[6],e.nodeMatrix[7],e.nodeMatrix[8],e.nodeMatrix[9],e.nodeMatrix[10],e.nodeMatrix[11],e.nodeMatrix[12],e.nodeMatrix[13],e.nodeMatrix[14],e.nodeMatrix[15]]);for(let t=0;t<e.data.length;t++)e.data[t]instanceof v.GeometryData&&(this._convertForAR?e.data[t].primitive.mode!==v.PRIMITIVE_MODE.POINTS&&e.data[t].primitive.mode!==v.PRIMITIVE_MODE.LINES&&e.data[t].primitive.mode!==v.PRIMITIVE_MODE.LINE_LOOP&&e.data[t].primitive.mode!==v.PRIMITIVE_MODE.LINE_STRIP&&(r.mesh=this.convertMesh(e.data[t])):r.mesh=this.convertMesh(e.data[t])),e.data[t]instanceof v.AnimationData&&this._animations.push(e.data[t]);e.children.length>0&&(r.children=[]);for(let i=0;i<e.children.length;i++)null===(t=r.children)||void 0===t||t.push(this.convertNode(e.children[i]));return this._content.nodes.push(r),this._nodes.push({node:e,id:this._content.nodes.length-1}),this._content.nodes.length-1}convertPrimitive(e){const t={attributes:{},mode:e.mode};for(let r in e.attributes)if(e.attributes[r].array.length>0)if(r.includes("COLOR")){if(e.attributes[r].itemSize%4==0)t.attributes[r]=this.convertAccessor(e.attributes[r]);else if(e.attributes[r].itemSize%3==0){const i=e.attributes[r],n=new Float32Array(i.array.length/3*4);let s=0;for(let e=0;e<n.length;e+=4)n[e]=i.array[s]/(1===i.elementBytes?255:1),n[e+1]=i.array[s+1]/(1===i.elementBytes?255:1),n[e+2]=i.array[s+2]/(1===i.elementBytes?255:1),n[e+3]=1,s+=3;t.attributes[r]=this.convertAccessor(new v.AttributeData(n,4,16,i.byteOffset,4,i.normalized,i.count,i.min,i.max,i.byteStride))}}else t.attributes[r]=this.convertAccessor(e.attributes[r]);if(e.indices&&(t.indices=this.convertAccessor(e.indices)),e.material){const r=Object.keys(t.attributes).find((e=>e.includes("TEXCOORD")));t.material=this.convertMaterial(e.material,!!r)}return t}convertTexture(e){this._content.textures||(this._content.textures=[]);const t={source:this.convertImage(e)};return this._content.textures.push(t),this._content.textures.length-1}getComponentType(e){switch(!0){case e instanceof Int8Array:return 5120;case e instanceof Uint8Array:return 5121;case e instanceof Int16Array:return 5122;case e instanceof Uint16Array:return 5123;case e instanceof Uint32Array:return 5125;default:return 5126}}getMinMax(e){const t={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let r=0;r<e.count;r++)for(let i=0;i<e.itemSize;i++){let n=0;e.itemSize>4?n=e.array[r*e.itemSize+i]:0===i?n=e.array[r*e.itemSize]:1===i?n=e.array[r*e.itemSize+1]:2===i?n=e.array[r*e.itemSize+2]:3===i&&(n=e.array[r*e.itemSize+3]),t.min[i]=Math.min(t.min[i],n),t.max[i]=Math.max(t.max[i],n)}return t}getPaddedArrayBuffer(e,t=0){const r=4*Math.ceil(e.byteLength/4);if(r!==e.byteLength){const i=new Uint8Array(r);if(i.set(new Uint8Array(e)),0!==t)for(let n=e.byteLength;n<r;n++)i[n]=t;return i.buffer}return e}getType(e){switch(e){case 1:return"SCALAR";case 2:return"VEC2";case 3:default:return"VEC3";case 4:return"VEC4";case 9:return"MAT3";case 18:return"MAT4"}}reset(){this._animations=[],this._buffers=[],this._byteOffset=0,this._content={asset:{copyright:"2021 (c) ShapeDiver",generator:"ShapeDiverViewer@"+c.build_data.build_version,version:"2.0",extensions:{}}},this._extensionsRequired=[],this._extensionsUsed=[],this._imageCache={},this._nodes=[],this._promises=[]}stringToArrayBuffer(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;const t=new Uint8Array(new ArrayBuffer(e.length));for(let r=0,i=e.length;r<i;r++){const i=e.charCodeAt(r);t[r]=i>255?32:i}return t.buffer}};y=n([f.default(),a("design:paramtypes",[])],y),e.exports.GLTFConverter=y})),s.register("a83DK",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E,w,x,A,T,S,M,C,R,I,O,P=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},k=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},L=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},N=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},G=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Session=void 0;var D=s("eYU63"),U=s("dxpc0");s("yoicn");var V=s("bJEmL"),B=s("1VbNx"),F=s("cTTbu"),j=s("imozB"),z=s("12eGO"),W=s("l1HmL"),H=s("76DG9"),$=s("83NaM"),Y=s("czgB9"),q=s("6OpRx"),X=s("7BRF7");let Z=class{constructor(e){r.set(this,V.instance.resolve($.Api)),i.set(this,V.instance.resolve(F.EventEngine)),n.set(this,{}),o.set(this,V.instance.resolve(F.HttpClient)),a.set(this,void 0),l.set(this,V.instance.resolve(F.InputValidator)),c.set(this,V.instance.resolve(F.Logger)),u.set(this,void 0),h.set(this,{}),d.set(this,{}),f.set(this,V.instance.resolve(F.PerformanceEvaluator)),p.set(this,!1),m.set(this,V.instance.resolve(D.Tree)),g.set(this,void 0),v.set(this,V.instance.resolve(F.SettingsEngine)),_.set(this,V.instance.resolve(F.StateEngine)),b.set(this,void 0),y.set(this,V.instance.resolve(F.UuidGenerator)),E.set(this,!1),w.set(this,!1),x.set(this,!1),A.set(this,void 0),T.set(this,[]),S.set(this,void 0),M.set(this,[]),C.set(this,!1),R.set(this,[]),I.set(this,!1),O.set(this,!0);try{N(this,S,new D.TreeNode(e.id),"f"),N(this,g,new U.Session(Object.assign({buildDate:j.build_data.build_date,buildVersion:j.build_data.build_version,closeOnFailure:()=>L(this,void 0,void 0,(function*(){this.bearerToken="";try{yield G(this,r,"f").closeSession(G(this,a,"f"),!0)}catch(e){}}))},e)),"f"),N(this,a,G(this,g,"f").id,"f"),N(this,b,G(this,g,"f").ticket,"f"),N(this,u,G(this,g,"f").modelViewUrl,"f"),N(this,T,e.excludeViewers||[],"f"),N(this,p,!1!==e.primarySession,"f"),G(this,_,"f").primarySession&&G(this,_,"f").primarySession.id===this.id&&(N(this,I,!0,"f"),G(this,o,"f").addDataLoading(G(this,g,"f").loadData.bind(G(this,g,"f"))),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}): This is now the primary session.`),G(this,_,"f").sessions[this.id].settingsRegistered.then((()=>{if(N(this,w,G(this,v,"f").general.commitParameters,"f"),N(this,x,G(this,v,"f").general.commitSettings,"f"),!0===G(this,O,"f"))for(let e in G(this,v,"f").session){const t=G(this,v,"f").session[e];this.parameters[e]&&(void 0!==t.displayname&&(this.parameters[e].displayname=t.displayname),void 0!==t.order&&(this.parameters[e].order=t.order),void 0!==t.hidden&&(this.parameters[e].hidden=t.hidden)),this.exports[e]&&(void 0!==t.displayname&&(this.exports[e].displayname=t.displayname),void 0!==t.order&&(this.exports[e].order=t.order),void 0!==t.hidden&&(this.exports[e].hidden=t.hidden))}}))),G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).constructor: Session api created.`)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,"Session.constructor",e)}}get automaticUpdate(){return G(this,E,"f")}set automaticUpdate(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).automaticUpdate: Updating automaticUpdate to ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).automaticUpdate`,e,"boolean"),N(this,E,e,"f"),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).automaticUpdate: automaticUpdate was set to: ${e}`)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).automaticUpdate`,e)}}get bearerToken(){return G(this,g,"f").bearerToken}set bearerToken(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).bearerToken: Updating BearerToken to ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).bearerToken`,e,"string",!1),G(this,g,"f").bearerToken=e,G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).bearerToken: bearerToken was set to: ${e}`)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).bearerToken`,e)}}get canUploadGLTF(){return G(this,g,"f").canUploadGLTF}get commitParameters(){return G(this,w,"f")}set commitParameters(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitParameters: Updating CommitParameters to ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitParameters`,e,"boolean"),N(this,w,e,"f"),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitParameters: commitParameters was set to: ${e}`)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitParameters`,e)}}get commitSettings(){return G(this,x,"f")}set commitSettings(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitSettings: Updating CommitSettings to ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitSettings`,e,"boolean"),N(this,x,e,"f"),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitSettings: commitSettings was set to: ${e}`)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).commitSettings`,e)}}get exports(){return G(this,n,"f")}get id(){return G(this,a,"f")}get initialized(){return G(this,g,"f").initialized}get modelViewUrl(){return G(this,u,"f")}get node(){return G(this,S,"f")}get outputs(){return G(this,h,"f")}get parameters(){return G(this,d,"f")}get primarySession(){return G(this,I,"f")}get primarySessionRequest(){return G(this,p,"f")}get refreshBearerToken(){return G(this,g,"f").refreshBearerToken}set refreshBearerToken(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).refreshBearerToken: Updating RefreshBearerToken to ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).refreshBearerToken`,e,"function"),G(this,g,"f").refreshBearerToken=e,G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).refreshBearerToken: refreshBearerToken was set to: ${e}`)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).refreshBearerToken`,e)}}get ticket(){return G(this,b,"f")}canGoBack(){return G(this,M,"f").length>1}canGoForward(){return G(this,R,"f").length>0}close(){return L(this,void 0,void 0,(function*(){try{const e=yield G(this,g,"f").close();return G(this,r,"f").automaticUpdate&&G(this,m,"f").removeNode(this.node),G(this,r,"f").update(),this.primarySession&&G(this,o,"f").removeDataLoading(),G(this,v,"f").reset(),G(this,i,"f").emitEvent(F.EVENTTYPE.SESSION.SESSION_CLOSED,{sessionId:this.id}),e||G(this,c,"f").warn(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).close: Was not able to close session completely, please disregard this session.`),e}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).close`,e)}}))}customize(){return L(this,void 0,void 0,(function*(){const e=G(this,y,"f").create(),t=G(this,y,"f").create();try{const n={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:0,data:{sessionId:this.id},status:"Customizing session"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_START,n);const s=G(this,S,"f").cloneInstance();N(this,A,t,"f"),G(this,f,"f").start(),G(this,f,"f").startSection("init"),G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize: Customizing session.`);for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].blurSceneWhenBusy&&G(this,r,"f").viewers[e].registerBusyMode(t);const o={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:.1,data:{sessionId:this.id},status:"Uploading file parameters"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,o);const a={};for(const n in this.parameters)if(this.parameters[n]instanceof Y.FileParameter&&(a[n]=yield this.parameters[n].upload(),G(this,A,"f")!==t)){G(this,f,"f").endSection("init"),G(this,f,"f").end();for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize: Session customization was exceeded by other customization request.`);const n={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:1,data:{sessionId:this.id},status:"Session customization was exceeded by other customization request"};return G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_CANCEL,n),new D.TreeNode}if(G(this,A,"f")!==t){G(this,f,"f").endSection("init"),G(this,f,"f").end();for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);const n={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:1,data:{sessionId:this.id},status:"Session customization was exceeded by other customization request"};return G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_CANCEL,n),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize: Session customization was exceeded by other customization request.`),new D.TreeNode}for(const e in a)this.parameters[e].value=a[e];const l={};for(const e in this.parameters)l[e]={value:this.parameters[e].value,valueString:this.parameters[e].stringify()};for(const e in this.parameters)G(this,g,"f").parameterValues[e]=l[e].valueString;G(this,c,"f").info(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize: Customizing session with parameters ${JSON.stringify(G(this,g,"f").parameterValues)}.`);const u={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:.25,data:{sessionId:this.id},status:"Sending customization request"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,u),G(this,f,"f").endSection("init"),G(this,f,"f").startSection("customize");const h=yield G(this,g,"f").customize((()=>G(this,A,"f")!==t));G(this,f,"f").endSection("customize");const d={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:.75,data:{sessionId:this.id},status:"Updating scene"};if(G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,d),G(this,A,"f")!==t){G(this,f,"f").end();for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);const n={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:1,data:{sessionId:this.id},status:"Session customization was exceeded by other customization request"};return G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_CANCEL,n),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize: Session customization was exceeded by other customization request.`),h}G(this,C,"f")||(G(this,M,"f").push(l),N(this,R,[],"f")),G(this,f,"f").startSection("finish"),G(this,r,"f").automaticUpdate&&G(this,m,"f").removeNode(this.node),N(this,S,h,"f"),G(this,r,"f").automaticUpdate&&G(this,m,"f").addNode(this.node),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize: Customization request finished, updating geometry.`);for(const e in this.parameters)this.parameters[e].sessionValue=l[e].value;for(const e in this.outputs)this.outputs[e].updateOutput(h.children.find((t=>t.name===e)),s.children.find((t=>t.name===e)));for(const e in this.exports)this.exports[e].updateExport();this._warningCreator(),this.node.excludeViewers=G(this,T,"f");for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize: Session customized.`),G(this,f,"f").endSection("finish"),G(this,f,"f").end(),G(this,i,"f").emitEvent(F.EVENTTYPE.SESSION.SESSION_CUSTOMIZED,{sessionId:this.id});const p={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:1,data:{sessionId:this.id},status:"Session customized"};return G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_END,p),this.node}catch(n){const s={type:z.TASKTYPE.SESSION_CUSTOMIZATION,id:e,progress:1,data:{sessionId:this.id},status:"Session customization failed"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_CANCEL,s);for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);if(n instanceof F.ShapeDiverViewerError||n instanceof F.ShapeDiverBackendError)throw n;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).customize`,n)}}))}getExportById(e){try{return G(this,c,"f").debugLow(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportById: Getting export with id ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportById`,e,"string"),this.exports[e]}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportById`,e)}}getExportByName(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportByName: Getting export(s) with name ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportByName`,e,"string");const t=[];for(let r in this.exports)e===this.exports[r].name&&t.push(this.exports[r]);return t}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportByName`,e)}}getExportByType(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportByType: Getting export(s) with type ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportByType`,e,"string");const t=[];for(let r in this.exports)e===this.exports[r].type&&t.push(this.exports[r]);return t}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.EXPORT,`Session(${this.id}).getExportByType`,e)}}getOutputById(e){try{return G(this,c,"f").debugLow(F.LOGGINGTOPIC.OUTPUT,`Session(${this.id}).getOutputById: Getting output with id ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.OUTPUT,`Session(${this.id}).getOutputById`,e,"string"),this.outputs[e]}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.OUTPUT,`Session(${this.id}).getOutputById`,e)}}getOutputByName(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.OUTPUT,`Session(${this.id}).getOutputByName: Getting output(s) with name ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.OUTPUT,`Session(${this.id}).getOutputByName`,e,"string");const t=[];for(let r in this.outputs)e===this.outputs[r].name&&t.push(this.outputs[r]);return t}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.OUTPUT,`Session(${this.id}).getOutputByName`,e)}}getParameterById(e){try{return G(this,c,"f").debugLow(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterById: Getting parameter with id ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterById`,e,"string"),this.parameters[e]}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterById`,e)}}getParameterByName(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterByName: Getting parameter(s) with name ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterByName`,e,"string");const t=[];for(let r in this.parameters)e===this.parameters[r].name&&t.push(this.parameters[r]);return t}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterByName`,e)}}getParameterByType(e){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterByType: Getting parameter(s) with type ${e}.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterByType`,e,"string");const t=[];for(let r in this.parameters)e===this.parameters[r].type&&t.push(this.parameters[r]);return t}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.PARAMETER,`Session(${this.id}).getParameterByType`,e)}}goBack(){return L(this,void 0,void 0,(function*(){try{if(!this.canGoBack())return G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).goBack: Cannot go further back.`),new D.TreeNode;const e=G(this,M,"f").pop(),t=G(this,M,"f")[G(this,M,"f").length-1];for(const e in t)this.parameters[e].value=t[e].value;N(this,C,!0,"f");const r=yield this.customize();return N(this,C,!1,"f"),G(this,R,"f").push(e),r}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).goBack`,e)}}))}goForward(){return L(this,void 0,void 0,(function*(){try{if(!this.canGoForward())return G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).goForward: Cannot go further forward.`),new D.TreeNode;const e=G(this,R,"f").pop();for(const t in e)this.parameters[t].value=e[t].value;N(this,C,!0,"f");const t=yield this.customize();return N(this,C,!1,"f"),G(this,M,"f").push(e),t}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).goForward`,e)}}))}init(e=!0,t=!0,n){return L(this,void 0,void 0,(function*(){try{const s=G(this,y,"f").create(),a={type:z.TASKTYPE.SESSION_INITIAL_OUTPUTS_LOADED,id:s,progress:0,status:"Initializing session"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_START,a),G(this,f,"f").start(),G(this,f,"f").startSection("init"),G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).init: Initializing Session.`),G(this,f,"f").endSection("init"),G(this,f,"f").startSection("customize"),yield G(this,g,"f").init(n);const l={type:z.TASKTYPE.SESSION_INITIAL_OUTPUTS_LOADED,id:s,progress:.5,status:"Loading outputs"};if(G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,l),this.primarySession&&G(this,o,"f").addDataLoading(G(this,g,"f").loadData.bind(G(this,g,"f"))),t)if(e){N(this,S,yield G(this,g,"f").loadOutputs(),"f"),G(this,r,"f").automaticUpdate&&G(this,m,"f").addNode(this.node),this.node.excludeViewers=G(this,T,"f"),G(this,r,"f").update(),G(this,i,"f").emitEvent(F.EVENTTYPE.SESSION.SESSION_INITIAL_OUTPUTS_LOADED,{sessionId:this.id});const e={type:z.TASKTYPE.SESSION_INITIAL_OUTPUTS_LOADED,id:s,progress:1,status:"Initial outputs loaded"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_END,e)}else G(this,g,"f").loadOutputs().then((e=>L(this,void 0,void 0,(function*(){N(this,S,e,"f"),G(this,r,"f").automaticUpdate&&G(this,m,"f").addNode(this.node),this.node.excludeViewers=G(this,T,"f"),G(this,r,"f").update(),G(this,i,"f").emitEvent(F.EVENTTYPE.SESSION.SESSION_INITIAL_OUTPUTS_LOADED,{sessionId:this.id});const t={type:z.TASKTYPE.SESSION_INITIAL_OUTPUTS_LOADED,id:s,progress:1,status:"Initial outputs loaded"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_END,t)}))));G(this,f,"f").endSection("customize"),G(this,f,"f").startSection("finish");const u={};for(let e in G(this,g,"f").parameters){const t=G(this,g,"f").parameters[e];switch(void 0===t.displayname&&void 0===t.order||N(this,O,!1,"f"),!0){case t.type===H.PARAMETERTYPE.BOOL||t.type===H.PARAMETERTYPE.SBOOL:case t.type===H.PARAMETERTYPE.COLOR||t.type===H.PARAMETERTYPE.SCOLOR:this.parameters[e]=new H.Parameter(this,G(this,g,"f"),G(this,g,"f").parameters[e]);break;case t.type===H.PARAMETERTYPE.FILE:this.parameters[e]=new Y.FileParameter(this,G(this,g,"f"),G(this,g,"f").parameters[e]);break;case t.type===H.PARAMETERTYPE.EVEN||t.type===H.PARAMETERTYPE.FLOAT||t.type===H.PARAMETERTYPE.INT||t.type===H.PARAMETERTYPE.ODD||t.type===H.PARAMETERTYPE.SINTEGER||t.type===H.PARAMETERTYPE.SNUMBER:default:this.parameters[e]=new H.Parameter(this,G(this,g,"f"),G(this,g,"f").parameters[e])}u[e]={value:this.parameters[e].value,valueString:this.parameters[e].stringify()},G(this,g,"f").parameterValues[e]=u[e].valueString}G(this,M,"f").push(u);for(let e in G(this,g,"f").exports)void 0===G(this,g,"f").exports[e].displayname&&void 0===G(this,g,"f").exports[e].order||N(this,O,!1,"f"),this.exports[e]=new q.Export(this,G(this,g,"f"),G(this,g,"f").exports[e]);for(let e in G(this,g,"f").outputs)void 0===G(this,g,"f").outputs[e].displayname&&void 0===G(this,g,"f").outputs[e].order||N(this,O,!1,"f"),this.outputs[e]=new X.Output(this,G(this,g,"f"),G(this,g,"f").outputs[e]);this._warningCreator();const h=[],d=Object.keys(G(this,r,"f").viewers);for(let e=0;e<d.length;e++)h.push(new Promise((t=>{const i=G(this,_,"f").viewers[G(this,r,"f").viewers[d[e]].id].settingsLoaded;!0===i.resolved?t():i.then((()=>t()))})));G(this,v,"f").loadSettings(G(this,g,"f").viewerSettings,this.id,this.primarySession),G(this,_,"f").sessions[this.id].settingsRegistered.resolve(!0),!1!==this.primarySession&&(yield Promise.all(h)),G(this,r,"f").update(),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).init: Session initialized.`),G(this,f,"f").endSection("finish"),G(this,f,"f").end()}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).init`,e)}}))}saveDefaultParameters(){return L(this,void 0,void 0,(function*(){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveDefaultParameters: Saving default parameters.`);const e=yield G(this,g,"f").saveDefaultParameters();if(!e){const e=new F.ShapeDiverViewerSessionError(`Session(${this.id}).saveDefaultParameters: Could not save default parameters.`);throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveDefaultParameters`,e)}return G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveDefaultParameters: Saved default parameters.`),e}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveDefaultParameters`,e)}}))}saveSessionProperties(e=!0){return L(this,void 0,void 0,(function*(){try{G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSessionProperties: Saving session properties.`),this._saveSessionSettings();let t={};for(let e in this.parameters)t[e]={displayname:void 0!==this.parameters[e].displayname?this.parameters[e].displayname:"",hidden:void 0!==this.parameters[e].hidden&&this.parameters[e].hidden,order:void 0!==this.parameters[e].order?this.parameters[e].order:0,tooltip:void 0!==this.parameters[e].tooltip?this.parameters[e].tooltip:""};const r=0===Object.values(t).length||(yield G(this,g,"f").saveParameterProperties(t));t={};for(let e in this.exports)t[e]={displayname:void 0!==this.exports[e].displayname?this.exports[e].displayname:"",hidden:void 0!==this.exports[e].hidden&&this.exports[e].hidden,order:void 0!==this.exports[e].order?this.exports[e].order:0,tooltip:void 0!==this.exports[e].tooltip?this.exports[e].tooltip:""};const i=0===Object.values(t).length||(yield G(this,g,"f").saveExportProperties(t));t={};for(let e in this.outputs)t[e]={displayname:void 0!==this.outputs[e].displayname?this.outputs[e].displayname:"",hidden:void 0!==this.outputs[e].hidden&&this.outputs[e].hidden,order:void 0!==this.outputs[e].order?this.outputs[e].order:0,tooltip:void 0!==this.outputs[e].tooltip?this.outputs[e].tooltip:""};const n=0===Object.values(t).length||(yield G(this,g,"f").saveOutputProperties(t)),s=!e||(yield G(this,g,"f").saveSettings(G(this,v,"f").convertToTargetVersion()));return s&&r&&n&&i?G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSessionProperties: Saved session properties.`):G(this,c,"f").warn(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSessionProperties: Could not save session properties.`),s&&r&&n&&i}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSessionProperties`,e)}}))}saveSettings(e){return L(this,void 0,void 0,(function*(){try{if(G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSettings: Saving settings.`),G(this,l,"f").validateAndError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSettings`,e,"boolean",!1),G(this,v,"f").general.commitParameters=this.commitParameters,G(this,v,"f").general.commitSettings=this.commitSettings,yield this.saveSessionProperties(!1),G(this,v,"f").settings.build_version=j.build_data.build_version,G(this,v,"f").settings.build_date=j.build_data.build_date,G(this,v,"f").settings.settings_version="3.1",0!==Object.values(G(this,r,"f").viewers).length){let t=e?G(this,r,"f").viewers[e]:null;t||(t=Object.values(G(this,r,"f").viewers)[0]);const i=V.instance.resolveAll("renderingEngine");let n;for(let e=0;e<i.length;e++)i[e].id===t.id&&(n=i[e]);n.saveSettings();const s=yield G(this,g,"f").saveSettings(G(this,v,"f").convertToTargetVersion());if(!s){const e=new F.ShapeDiverViewerSessionError(`Session(${this.id}).saveSettings: Could not save settings.`);throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSettings`,e)}return G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSettings: Saved settings.`),s}return!1}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).saveSettings`,e)}}))}setAsPrimary(){return L(this,void 0,void 0,(function*(){try{!1===G(this,_,"f").sessions[this.id].initialized.resolved&&(yield G(this,_,"f").sessions[this.id].initialized),N(this,I,!0,"f"),G(this,o,"f").addDataLoading(G(this,g,"f").loadData.bind(G(this,g,"f"))),G(this,_,"f").sessions[this.id].primary=!0,G(this,v,"f").loadSettings(G(this,g,"f").viewerSettings,this.id,this.primarySession),yield new Promise((e=>G(this,_,"f").sessions[this.id].settingsRegistered.then((()=>{e()})))),G(this,r,"f").update(),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).setAsPrimary: This is now the primary session.`)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).setAsPrimary`,e)}}))}updateOutputs(){return L(this,void 0,void 0,(function*(){const e=G(this,y,"f").create(),t=G(this,y,"f").create();try{const n={type:z.TASKTYPE.SESSION_OUTPUTS_UPDATE,id:e,progress:0,data:{sessionId:this.id},status:"Updating outputs"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_START,n);const s=G(this,S,"f").cloneInstance();N(this,A,t,"f"),G(this,f,"f").start(),G(this,f,"f").startSection("init"),G(this,c,"f").debugLow(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).updateOutputs: Updating Outputs.`);for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].blurSceneWhenBusy&&G(this,r,"f").viewers[e].registerBusyMode(t);const o={type:z.TASKTYPE.SESSION_OUTPUTS_UPDATE,id:e,progress:.25,data:{sessionId:this.id},status:"Loading outputs"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,o),G(this,f,"f").endSection("init"),G(this,f,"f").startSection("updateOutputs");const a=yield G(this,g,"f").loadOutputs((()=>G(this,A,"f")!==t));G(this,f,"f").endSection("updateOutputs");const l={type:z.TASKTYPE.SESSION_OUTPUTS_UPDATE,id:e,progress:.75,data:{sessionId:this.id},status:"Updating scene"};if(G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,l),G(this,A,"f")!==t){G(this,f,"f").end();for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);const n={type:z.TASKTYPE.SESSION_OUTPUTS_UPDATE,id:e,progress:1,data:{sessionId:this.id},status:"Output updating was exceeded by other customization request"};return G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_CANCEL,n),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).updateOutputs: Output updating was exceeded by other request.`),a}G(this,f,"f").startSection("finish"),G(this,r,"f").automaticUpdate&&G(this,m,"f").removeNode(this.node),N(this,S,a,"f"),G(this,r,"f").automaticUpdate&&G(this,m,"f").addNode(this.node),G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).updateOutputs: Updating outputs finished, updating geometry.`);for(const e in this.outputs)this.outputs[e].updateOutput(a.children.find((t=>t.name===e)),s.children.find((t=>t.name===e)));for(const e in this.exports)this.exports[e].updateExport();this._warningCreator(),this.node.excludeViewers=G(this,T,"f");for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);G(this,c,"f").debug(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).updateOutputs: Updated outputs.`),G(this,f,"f").endSection("finish"),G(this,f,"f").end();const u={type:z.TASKTYPE.SESSION_OUTPUTS_UPDATE,id:e,progress:1,data:{sessionId:this.id},status:"Outputs updated"};return G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_END,u),this.node}catch(n){const s={type:z.TASKTYPE.SESSION_OUTPUTS_UPDATE,id:e,progress:1,data:{sessionId:this.id},status:"Output updating failed"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_CANCEL,s);for(let e in G(this,r,"f").viewers)G(this,r,"f").viewers[e].deregisterBusyMode(t);if(n instanceof F.ShapeDiverViewerError||n instanceof F.ShapeDiverBackendError)throw n;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).updateOutputs`,n)}}))}uploadGLTF(e,t){return L(this,void 0,void 0,(function*(){try{const n={type:z.TASKTYPE.AR_LOADING,id:t,progress:.25,status:"Converting AR scene"};G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,n);const s=yield G(this,r,"f").convertSceneToGLTF(!0),o={type:z.TASKTYPE.AR_LOADING,id:t,progress:.75,status:"Uploading AR scene"};return G(this,i,"f").emitEvent(F.EVENTTYPE.TASK.TASK_PROCESS,o),yield G(this,g,"f").uploadGLTF(s,e)}catch(e){if(e instanceof F.ShapeDiverViewerError||e instanceof F.ShapeDiverBackendError)throw e;throw G(this,c,"f").handleError(F.LOGGINGTOPIC.SESSION,`Session(${this.id}).uploadGLTF`,e)}}))}_saveSessionSettings(){const e=this.parameters,t=this.exports,r={};for(let t in e)r[t]={order:e[t].order||0,displayname:e[t].displayname||"",hidden:e[t].hidden};for(let e in t)r[e]={order:t[e].order||0,displayname:t[e].displayname||"",hidden:t[e].hidden};G(this,v,"f").session=r;let i=[];for(let e in this.outputs)i.push(this.outputs[e]);i.sort(((e,t)=>(e.order||1/0)-(t.order||1/0)));let n=i.filter((e=>0===e.order));i=i.filter((e=>!n.includes(e))),i=n.concat(i);const s=i.map((e=>e.id));for(let e=0;e<s.length;e++)this.outputs[s[e]]&&this.outputs[s[e]].order!==e&&(this.outputs[s[e]].order=e)}_warningCreator(){for(const e in this.outputs){let t="";this.outputs[e].msg&&(t+=`\n\t- ${this.outputs[e].msg}`),this.outputs[e].status_collect&&this.outputs[e].status_collect!==W.ShapeDiverResponseModelComputationStatus.SUCCESS&&(t+=`\n\t- status_collect is ${this.outputs[e].status_collect}`),this.outputs[e].status_computation&&this.outputs[e].status_computation!==W.ShapeDiverResponseModelComputationStatus.SUCCESS&&(t+=`\n\t- status_computation is ${this.outputs[e].status_computation}`),t&&G(this,c,"f").warn(F.LOGGINGTOPIC.SESSION,`\nOutput(${e}):${t}`)}for(const e in this.exports){let t="";this.exports[e].msg&&(t+=`\n\t- ${this.exports[e].msg}`),this.exports[e].status_collect&&this.exports[e].status_collect!==W.ShapeDiverResponseModelComputationStatus.SUCCESS&&(t+=`\n\t- status_collect is ${this.exports[e].status_collect}`),this.exports[e].status_computation&&this.exports[e].status_computation!==W.ShapeDiverResponseModelComputationStatus.SUCCESS&&(t+=`\n\t- status_computation is ${this.exports[e].status_computation}`),t&&G(this,c,"f").warn(F.LOGGINGTOPIC.SESSION,`\nExport(${e}):${t}`)}}};r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,_=new WeakMap,b=new WeakMap,y=new WeakMap,E=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakMap,T=new WeakMap,S=new WeakMap,M=new WeakMap,C=new WeakMap,R=new WeakMap,I=new WeakMap,O=new WeakMap,Z=P([B.default(),k("design:paramtypes",[Object])],Z),e.exports.Session=Z})),s.register("76DG9",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E,w,x,A,T,S,M,C,R,I=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},O=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Parameter=e.exports.PARAMETERVISUALIZATION=e.exports.PARAMETERTYPE=void 0;var P=s("cTTbu");s("yoicn");var k,L,N,G,D=s("bJEmL");(L=k=e.exports.PARAMETERTYPE||(e.exports.PARAMETERTYPE={})).FLOAT="Float",L.INT="Int",L.EVEN="Even",L.ODD="Odd",L.STRING="String",L.COLOR="Color",L.STRINGLIST="StringList",L.BOOL="Bool",L.TIME="Time",L.FILE="File",L.SNUMBER="sNumber",L.SINTEGER="sInteger",L.SSTRING="sString",L.SCOLOR="sColor",L.SBOOL="sBool",L.STIME="sTime",L.SBITMAP="sBitmap",L.SDOMAIN="sDomain",L.SDOMAIN2D="sDomain2D",L.SPOINT="sPoint",L.SLINE="sLine",L.SVECTOR="sVector",L.SBOX="sBox",L.SPLANE="sPlane",L.SRECTANGLE="sRectangle",L.SCURVE="sCurve",L.SCIRCLE="sCircle",L.SMESH="sMesh",L.SSURFACE="sSurface",L.SBREP="sBrep",L.SSUBDIV="sSubdiv",(G=N=e.exports.PARAMETERVISUALIZATION||(e.exports.PARAMETERVISUALIZATION={})).SLIDER="slider",G.SEQUENCE="sequence",G.CYCLE="cycle",G.DROPDOWN="dropdown",G.CHECKLIST="checklist",G.CLOCK="color",G.CALENDAR="calendar",G.TOGGLE="toggle",G.SWATCH="swatch",G.BUTTON="button",G.DIAL="dial",G.TEXT="text";e.exports.Parameter=class{constructor(e,t,s){r.set(this,void 0),i.set(this,D.instance.resolve(P.Converter)),n.set(this,void 0),o.set(this,void 0),a.set(this,void 0),l.set(this,void 0),c.set(this,void 0),u.set(this,void 0),h.set(this,void 0),d.set(this,D.instance.resolve(P.InputValidator)),f.set(this,D.instance.resolve(P.Logger)),p.set(this,void 0),m.set(this,D.instance.resolve(P.MimeTypeUtils)),g.set(this,void 0),v.set(this,void 0),_.set(this,void 0),b.set(this,void 0),y.set(this,void 0),E.set(this,void 0),w.set(this,void 0),x.set(this,void 0),A.set(this,!1),T.set(this,void 0),S.set(this,void 0),M.set(this,void 0),C.set(this,void 0),R.set(this,void 0);try{if(I(this,_,e,"f"),I(this,b,t,"f"),I(this,h,s.id,"f"),I(this,a,s.defval,"f"),I(this,v,s.name,"f"),I(this,E,s.type,"f"),void 0!==s.choices&&I(this,r,s.choices,"f"),void 0!==s.decimalplaces&&I(this,n,+s.decimalplaces,"f"),void 0!==s.expression&&I(this,l,s.expression,"f"),void 0!==s.format){let e=s.format;O(this,m,"f").mapMimeTypeToFileEndings(e).forEach((t=>e=e.concat(O(this,m,"f").guessMimeTypeFromFilename(t)))),e=e.filter((function(t,r){return e.indexOf(t)==r})),I(this,c,e,"f")}void 0!==s.min&&I(this,g,+s.min,"f"),void 0!==s.max&&I(this,p,+s.max,"f"),void 0!==s.visualization&&I(this,w,s.visualization,"f"),void 0!==s.structure&&I(this,y,s.structure,"f"),void 0!==s.group&&I(this,u,s.group,"f"),void 0!==s.tooltip&&I(this,M,s.tooltip,"f"),void 0!==s.displayname&&I(this,x,s.displayname,"f"),void 0!==s.order&&I(this,S,s.order,"f"),void 0!==s.hidden&&I(this,A,s.hidden,"f"),O(this,E,"f")===k.BOOL||O(this,E,"f")===k.SBOOL?I(this,o,"true"===O(this,a,"f"),"f"):O(this,E,"f")===k.EVEN||O(this,E,"f")===k.FLOAT||O(this,E,"f")===k.INT||O(this,E,"f")===k.ODD||O(this,E,"f")===k.SINTEGER||O(this,E,"f")===k.SNUMBER?I(this,o,+O(this,a,"f"),"f"):I(this,o,O(this,a,"f"),"f"),O(this,E,"f")===k.COLOR&&(this.convertColor=e=>O(this,i,"f").toColor(e)),I(this,R,O(this,o,"f"),"f"),I(this,C,O(this,R,"f"),"f"),I(this,T,O(this,R,"f"),"f"),O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).constructor: Initialized parameter ${JSON.stringify(s)}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${s.id}).constructor`,e)}}get choices(){return O(this,r,"f")}get decimalplaces(){return O(this,n,"f")}get defval(){return O(this,a,"f")}get displayname(){return O(this,x,"f")}set displayname(e){try{O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).displayname: Updating DisplayName to ${e}.`),O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).displayname`,e,"string",!1),I(this,x,e,"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).displayname: DisplayName was updated to ${this.displayname}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).displayname`,e)}}get expression(){return O(this,l,"f")}get format(){return O(this,c,"f")}get group(){return O(this,u,"f")}get hidden(){return O(this,A,"f")}set hidden(e){try{O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).hidden: Updating Hidden to ${e}.`),O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).hidden`,e,"boolean"),I(this,A,e,"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).hidden: Hidden was updated to ${this.hidden}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).hidden`,e)}}get id(){return O(this,h,"f")}get lastValidatedValue(){return O(this,T,"f")}get max(){return O(this,p,"f")}get min(){return O(this,g,"f")}get name(){return O(this,v,"f")}get order(){return O(this,S,"f")}set order(e){try{O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).order: Updating Order to ${e}.`),O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).order`,e,"number",!1),I(this,S,e,"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).order: Order was updated to ${this.order}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).order`,e)}}get sessionValue(){return O(this,C,"f")}set sessionValue(e){try{if(O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).sessionValue: Updating SessionValue to ${e}.`),!this.isValid(e,!0)){const e=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).sessionValue: Could not validate value.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).sessionValue`,e)}I(this,C,e,"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).sessionValue: SessionValue was updated to ${this.value}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).sessionValue`,e)}}get structure(){return O(this,y,"f")}get tooltip(){return O(this,M,"f")}set tooltip(e){try{O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).tooltip: Updating tooltip to ${e}.`),O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).tooltip`,e,"string",!1),I(this,M,e,"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).tooltip: tooltip was updated to ${this.tooltip}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).tooltip`,e)}}get type(){return O(this,E,"f")}get value(){return O(this,R,"f")}set value(e){try{if(O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).value: Updating Value to ${e}.`),!this.isValid(e,!0)){const e=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).value: Could not validate value.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,e)}I(this,R,e,"f"),I(this,T,this.value,"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).value: Value was updated to ${this.value}.`),O(this,_,"f").automaticUpdate&&O(this,_,"f").customize()}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,e)}}get visualization(){return O(this,w,"f")}isValid(e,t=!1){try{O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid: Checking value ${e}.`);try{switch(!0){case this.type===k.BOOL||this.type===k.SBOOL:if("string"==typeof e){if("true"!==e&&"false"!==e){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} is a string that is neither true or false.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}}else O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,e,"boolean");break;case this.type===k.COLOR||this.type===k.SCOLOR:O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,e,"color");break;case this.type===k.FILE:O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,e,"file");break;case this.type===k.EVEN||this.type===k.FLOAT||this.type===k.INT||this.type===k.ODD||this.type===k.SINTEGER||this.type===k.SNUMBER:let t=e;if("string"==typeof e&&(t=+e),O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,t,"number"),this.type===k.EVEN){if(t%2!=0){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} is not even.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}}else if(this.type===k.ODD){if(t%2==0){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} is not odd.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}}else if((this.type===k.INT||this.type===k.SINTEGER)&&!Number.isInteger(t)){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} is not an integer.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}if((this.min||0===this.min)&&t<this.min){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} is smaller than the minimum ${this.min}.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}if((this.max||0===this.max)&&t>this.max){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} is larger than the maximum ${this.max}.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}if(this.decimalplaces||0===this.decimalplaces){const r=t+"";let i=0;if(r.includes(".")&&(i=r.split(".")[1].length),this.decimalplaces<i){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} has not the correct number of decimalplaces (${this.decimalplaces}).`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}}break;case this.type===k.STRINGLIST:O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,e,"string");const r=e=>{const t=+e;if(O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,t,"number"),t<0||t>this.choices.length-1){const t=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${e} is not within the range of the defined number choices.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,t,!1)}};if(this.visualization===N.CHECKLIST)if(e.includes(",")){const t=e.split(",");for(let e=0;e<t.length;e++){if(1!==t.filter((r=>r===t[e])).length){const r=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).isValid: The value ${t[e]} exists multiple times, but should only exist once.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,r,!1)}r(t[e])}}else{let t=e;"string"==typeof e&&(t=+e),O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,t,"number"),r(e)}else{let t=e;"string"==typeof e&&(t=+e),O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,t,"number"),r(e)}break;default:O(this,d,"f").validateAndError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).isValid`,e,"string")}}catch(e){if(t)throw e;return!1}return!0}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).isValid`,e)}}resetToDefaultValue(){try{O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).resetToDefaultValue: Resetting value ${this.value} to default value ${O(this,o,"f")}.`),I(this,R,O(this,o,"f"),"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).resetToDefaultValue: value was set to default value ${O(this,o,"f")}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).resetToDefaultValue`,e)}}resetToSessionValue(){try{O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).resetToSessionValue: Resetting value ${this.value} to last session value ${this.sessionValue}.`),I(this,R,this.sessionValue,"f"),O(this,f,"f").debug(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).resetToSessionValue: value was set to last session value ${this.sessionValue}.`)}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).resetToSessionValue`,e)}}stringify(){try{switch(O(this,f,"f").debugLow(P.LOGGINGTOPIC.PARAMETER,`Parameter(${O(this,h,"f")}).stringify: Stringifying value.`),!0){case this.type===k.BOOL||this.type===k.SBOOL:return"string"==typeof this.value?this.value:this.value+"";case this.type===k.COLOR||this.type===k.SCOLOR:return O(this,i,"f").toHex8Color(this.value);case this.type===k.FILE:if("string"!=typeof this.value){const e=new P.ShapeDiverViewerSessionError(`Parameter(${O(this,h,"f")}).stringify: Error in stringify. Cannot stringify FileParameter that has not been uploaded yet.`);throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).value`,e)}return this.value;case this.type===k.EVEN||this.type===k.FLOAT||this.type===k.INT||this.type===k.ODD||this.type===k.SINTEGER||this.type===k.SNUMBER:return"string"==typeof this.value?this.value:this.value+"";default:return this.value}}catch(e){if(e instanceof P.ShapeDiverViewerError||e instanceof P.ShapeDiverBackendError)throw e;throw O(this,f,"f").handleError(P.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).stringify`,e)}}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,_=new WeakMap,b=new WeakMap,y=new WeakMap,E=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakMap,T=new WeakMap,S=new WeakMap,M=new WeakMap,C=new WeakMap,R=new WeakMap})),s.register("czgB9",(function(e,t){var r,i,n,o,a,l=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},c=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},u=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.FileParameter=void 0;var h=s("cTTbu");s("yoicn");var d=s("bJEmL"),f=s("76DG9");class p extends f.Parameter{constructor(e,t,s){super(e,t,s),r.set(this,d.instance.resolve(h.Logger)),i.set(this,d.instance.resolve(h.MimeTypeUtils)),n.set(this,void 0),o.set(this,void 0),a.set(this,d.instance.resolve(h.UuidGenerator));try{c(this,n,e,"f"),c(this,o,t,"f")}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,r,"f").handleError(h.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).constructor`,e)}}upload(){var e;return l(this,void 0,void 0,(function*(){try{if(u(this,r,"f").debugLow(h.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).upload: Uploading FileParameter with value ${this.value}.`),!this.value)return this.defval;if("string"==typeof this.value&&36===this.value.length&&u(this,a,"f").validate(this.value))return this.value;const t=new File(["string"==typeof this.value?new Blob([this.value],{type:"text/plain"}):this.value],"upload",{type:this.value.type});if(0===t.size){const e=new h.ShapeDiverViewerSessionError(`Parameter(${this.id}).upload: Error uploading FileParameter, file size was 0.`);throw u(this,r,"f").handleError(h.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).upload`,e)}let n=[t.type];let s;u(this,i,"f").mapMimeTypeToFileEndings(n).forEach((e=>n=n.concat(u(this,i,"f").guessMimeTypeFromFilename(e))));let l=!1;for(let t=0;t<n.length;t++)if(null===(e=this.format)||void 0===e?void 0:e.includes(n[t])){l=!0,s=n[t];break}if(!l){const e=new h.ShapeDiverViewerSessionError(`Parameter(${this.id}).upload: Error uploading FileParameter, type of data (${t.type}) is not a valid type. Has to be ${this.format}.`);throw u(this,r,"f").handleError(h.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).upload`,e)}return u(this,r,"f").debug(h.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).upload: Uploading FileParameter.`),yield u(this,o,"f").uploadFile(this.id,t,s)}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,r,"f").handleError(h.LOGGINGTOPIC.PARAMETER,`Parameter(${this.id}).upload`,e)}}))}}e.exports.FileParameter=p,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap})),s.register("6OpRx",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E,w,x,A,T,S,M,C=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},R=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},I=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Export=void 0;var O=s("cTTbu");s("yoicn");var P=s("bJEmL"),k=s("12eGO");e.exports.Export=class{constructor(e,t,s){r.set(this,P.instance.resolve(O.EventEngine)),i.set(this,void 0),n.set(this,P.instance.resolve(O.InputValidator)),o.set(this,P.instance.resolve(O.Logger)),a.set(this,void 0),l.set(this,void 0),c.set(this,void 0),u.set(this,void 0),h.set(this,P.instance.resolve(O.UuidGenerator)),d.set(this,void 0),f.set(this,void 0),p.set(this,void 0),m.set(this,void 0),g.set(this,void 0),v.set(this,void 0),_.set(this,!1),b.set(this,3e5),y.set(this,void 0),E.set(this,void 0),w.set(this,void 0),x.set(this,void 0),A.set(this,void 0),T.set(this,void 0),S.set(this,void 0),M.set(this,void 0);try{R(this,l,e,"f"),R(this,c,t,"f"),R(this,i,s.id,"f"),R(this,a,s.name,"f"),R(this,u,s.type,"f"),this.updateExportDefinition(s),I(this,o,"f").debugLow(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).constructor: Initialized export ${JSON.stringify(s)}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw I(this,o,"f").handleError(O.LOGGINGTOPIC.EXPORT,`Export(${s.id}).constructor`,e)}}get content(){return I(this,d,"f")}get delay(){return I(this,f,"f")}get dependency(){return I(this,p,"f")}get displayname(){return I(this,m,"f")}set displayname(e){try{I(this,o,"f").debugLow(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).displayname: Updating DisplayName to ${e}.`),I(this,n,"f").validateAndError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).displayname`,e,"string",!1),R(this,m,e,"f"),I(this,o,"f").debug(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).displayname: DisplayName was updated to ${this.displayname}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw I(this,o,"f").handleError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).displayname`,e)}}get filename(){return I(this,g,"f")}get group(){return I(this,v,"f")}get hidden(){return I(this,_,"f")}set hidden(e){try{I(this,o,"f").debugLow(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).hidden: Updating Hidden to ${e}.`),I(this,n,"f").validateAndError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).hidden`,e,"boolean"),R(this,_,e,"f"),I(this,o,"f").debug(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).hidden: Hidden was updated to ${this.hidden}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw I(this,o,"f").handleError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).hidden`,e)}}get id(){return I(this,i,"f")}get maxWaitTime(){return I(this,b,"f")}set maxWaitTime(e){try{I(this,o,"f").debugLow(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).maxWaitTime: Updating maxWaitTime to ${e}.`),I(this,n,"f").validateAndError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).maxWaitTime`,e,"number"),R(this,b,e,"f"),I(this,o,"f").debug(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).maxWaitTime: maxWaitTime was updated to ${this.maxWaitTime}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw I(this,o,"f").handleError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).maxWaitTime`,e)}}get msg(){return I(this,y,"f")}get name(){return I(this,a,"f")}get order(){return I(this,E,"f")}set order(e){try{I(this,o,"f").debugLow(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).order: Updating Order to ${e}.`),I(this,n,"f").validateAndError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).order`,e,"number",!1),R(this,E,e,"f"),I(this,o,"f").debug(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).order: Order was updated to ${this.order}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw I(this,o,"f").handleError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).order`,e)}}get result(){return I(this,w,"f")}get status_collect(){return I(this,x,"f")}get status_computation(){return I(this,A,"f")}get tooltip(){return I(this,T,"f")}set tooltip(e){try{I(this,o,"f").debugLow(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).tooltip: Updating tooltip to ${e}.`),I(this,n,"f").validateAndError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).tooltip`,e,"string",!1),R(this,T,e,"f"),I(this,o,"f").debug(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).tooltip: tooltip was updated to ${this.tooltip}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw I(this,o,"f").handleError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).tooltip`,e)}}get type(){return I(this,u,"f")}get uid(){return I(this,S,"f")}get version(){return I(this,M,"f")}request(e={}){return C(this,void 0,void 0,(function*(){const t=I(this,h,"f").create();try{const n={type:k.TASKTYPE.EXPORT_REQUEST,id:t,progress:0,status:"Requesting export"};I(this,r,"f").emitEvent(O.EVENTTYPE.TASK.TASK_START,n),I(this,o,"f").debugLow(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).request: Sending export request.`);const s=I(this,c,"f").parameterValues,a={};for(let t in s)a[t]=e[t]||""===e[t]?e[t]:s[t];I(this,o,"f").info(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).request: Sending export request with parameters ${JSON.stringify(a)}.`);const l=yield I(this,c,"f").requestExport(this.id,a,I(this,b,"f"));this.updateExportDefinition(l);const u={type:k.TASKTYPE.EXPORT_REQUEST,id:t,progress:1,status:"Returning export"};return I(this,r,"f").emitEvent(O.EVENTTYPE.TASK.TASK_END,u),l}catch(e){const n={type:k.TASKTYPE.EXPORT_REQUEST,id:t,progress:1,status:"Export request failed"};if(I(this,r,"f").emitEvent(O.EVENTTYPE.TASK.TASK_CANCEL,n),e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw I(this,o,"f").handleError(O.LOGGINGTOPIC.EXPORT,`Export(${I(this,i,"f")}).request`,e)}}))}updateExport(){const e=I(this,c,"f").exports[this.id];R(this,p,e.dependency,"f"),R(this,S,e.uid,"f"),R(this,m,e.displayname,"f"),R(this,E,e.order,"f"),R(this,_,e.hidden,"f"),R(this,T,e.tooltip,"f"),R(this,M,e.version,"f"),R(this,f,e.delay,"f"),R(this,d,e.content,"f"),R(this,y,e.msg,"f"),R(this,g,e.filename,"f"),R(this,w,e.result,"f"),R(this,A,e.status_computation,"f"),R(this,x,e.status_collect,"f"),R(this,v,e.group,"f")}updateExportDefinition(e){R(this,p,e.dependency,"f"),R(this,S,e.uid,"f"),R(this,m,e.displayname,"f"),R(this,E,e.order,"f"),R(this,_,e.hidden,"f"),R(this,T,e.tooltip,"f"),R(this,M,e.version,"f"),R(this,f,e.delay,"f"),R(this,d,e.content,"f"),R(this,y,e.msg,"f"),R(this,g,e.filename,"f"),R(this,w,e.result,"f"),R(this,A,e.status_computation,"f"),R(this,x,e.status_collect,"f"),R(this,v,e.group,"f")}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,_=new WeakMap,b=new WeakMap,y=new WeakMap,E=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakMap,T=new WeakMap,S=new WeakMap,M=new WeakMap})),s.register("7BRF7",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_,b,y,E,w,x,A,T,S,M=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},C=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},R=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Output=void 0,s("yoicn");var I=s("bJEmL"),O=s("cTTbu");e.exports.Output=class{constructor(e,t,s){r.set(this,void 0),i.set(this,I.instance.resolve(O.InputValidator)),n.set(this,I.instance.resolve(O.Logger)),o.set(this,void 0),a.set(this,void 0),l.set(this,void 0),c.set(this,I.instance.resolve(O.UuidGenerator)),u.set(this,void 0),h.set(this,void 0),d.set(this,void 0),f.set(this,void 0),p.set(this,void 0),m.set(this,void 0),g.set(this,void 0),v.set(this,!1),_.set(this,void 0),b.set(this,void 0),y.set(this,void 0),E.set(this,void 0),w.set(this,void 0),x.set(this,void 0),A.set(this,void 0),T.set(this,null),S.set(this,void 0);try{C(this,a,e,"f"),C(this,l,t,"f"),C(this,r,s.id,"f"),C(this,o,s.name,"f"),C(this,S,s.version,"f"),this.updateOutputDefinition(s),R(this,n,"f").debugLow(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).constructor: Initialized output ${JSON.stringify(s)}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw R(this,n,"f").handleError(O.LOGGINGTOPIC.OUTPUT,`Output(${s.id}).constructor`,e)}}get bbmax(){return R(this,u,"f")}get bbmin(){return R(this,h,"f")}get chunks(){return R(this,d,"f")}get content(){return R(this,f,"f")}get delay(){return R(this,p,"f")}get dependency(){return R(this,m,"f")}get displayname(){return R(this,g,"f")}set displayname(e){try{R(this,n,"f").debugLow(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).displayname: Updating DisplayName to ${e}.`),R(this,i,"f").validateAndError(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).displayname`,e,"string",!1),C(this,g,e,"f"),R(this,n,"f").debug(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).displayname: DisplayName was updated to ${this.displayname}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw R(this,n,"f").handleError(O.LOGGINGTOPIC.OUTPUT,`Output(${this.id}).displayname`,e)}}get freeze(){return R(this,l,"f").outputsFreeze[R(this,r,"f")]}set freeze(e){try{R(this,n,"f").debugLow(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).freeze: Updating Freeze to ${e}.`),R(this,i,"f").validateAndError(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).freeze`,e,"boolean"),R(this,l,"f").outputsFreeze[R(this,r,"f")]=e,R(this,n,"f").debug(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).freeze: Freeze was updated to ${this.freeze}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw R(this,n,"f").handleError(O.LOGGINGTOPIC.OUTPUT,`Output(${this.id}).freeze`,e)}}get hidden(){return R(this,v,"f")}set hidden(e){try{R(this,n,"f").debugLow(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).hidden: Updating Hidden to ${e}.`),R(this,i,"f").validateAndError(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).hidden`,e,"boolean"),C(this,v,e,"f"),R(this,n,"f").debug(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).hidden: Hidden was updated to ${this.hidden}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw R(this,n,"f").handleError(O.LOGGINGTOPIC.OUTPUT,`Output(${this.id}).hidden`,e)}}get id(){return R(this,r,"f")}get material(){return R(this,_,"f")}get msg(){return R(this,b,"f")}get name(){return R(this,o,"f")}get node(){return R(this,a,"f").node.children.find((e=>e.name===this.id))}get order(){return R(this,y,"f")}set order(e){try{R(this,n,"f").debugLow(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).order: Updating Order to ${e}.`),R(this,i,"f").validateAndError(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).order`,e,"number",!1),C(this,y,e,"f"),R(this,n,"f").debug(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).order: Order was updated to ${this.order}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw R(this,n,"f").handleError(O.LOGGINGTOPIC.OUTPUT,`Output(${this.id}).order`,e)}}get status_collect(){return R(this,E,"f")}get status_computation(){return R(this,w,"f")}get tooltip(){return R(this,x,"f")}set tooltip(e){try{R(this,n,"f").debugLow(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).tooltip: Updating tooltip to ${e}.`),R(this,i,"f").validateAndError(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).tooltip`,e,"string",!1),C(this,x,e,"f"),R(this,n,"f").debug(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).tooltip: tooltip was updated to ${this.tooltip}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw R(this,n,"f").handleError(O.LOGGINGTOPIC.OUTPUT,`Output(${this.id}).tooltip`,e)}}get uid(){return R(this,A,"f")}get updateCallback(){return R(this,T,"f")}set updateCallback(e){try{R(this,n,"f").debugLow(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).updateCallback: Updating updateCallback to ${e}.`),R(this,i,"f").validateAndError(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).updateCallback`,e,"function",!1),C(this,T,e,"f"),R(this,n,"f").debug(O.LOGGINGTOPIC.OUTPUT,`Output(${R(this,r,"f")}).updateCallback: updateCallback was updated to ${this.updateCallback}.`)}catch(e){if(e instanceof O.ShapeDiverViewerError||e instanceof O.ShapeDiverBackendError)throw e;throw R(this,n,"f").handleError(O.LOGGINGTOPIC.OUTPUT,`Output(${this.id}).updateCallback`,e)}}get version(){return R(this,S,"f")}updateOutput(e,t){const r=R(this,l,"f").outputs[this.id];this.updateOutputDefinition(r),R(this,T,"f")&&R(this,T,"f").call(this,e,t)}updateOutputContent(e,t=!1){return M(this,void 0,void 0,(function*(){return R(this,l,"f").outputs[this.id].content=e,R(this,l,"f").outputs[this.id].version=R(this,c,"f").create(),t||(yield R(this,a,"f").updateOutputs()),this.node}))}updateOutputDefinition(e){C(this,m,e.dependency,"f"),C(this,A,e.uid,"f"),C(this,_,e.material,"f"),C(this,d,e.chunks,"f"),C(this,b,e.msg,"f"),C(this,h,e.bbmin,"f"),C(this,u,e.bbmax,"f"),C(this,w,e.status_computation,"f"),C(this,E,e.status_collect,"f"),C(this,f,e.content,"f"),C(this,p,e.delay,"f"),C(this,S,e.version,"f"),C(this,g,e.displayname,"f"),C(this,y,e.order,"f"),C(this,v,e.hidden,"f")}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,_=new WeakMap,b=new WeakMap,y=new WeakMap,E=new WeakMap,w=new WeakMap,x=new WeakMap,A=new WeakMap,T=new WeakMap,S=new WeakMap})),s.register("kp39A",(function(e,t){var r,i,n,o,a,l,c,u,h,d,f,p,m,g,v,_=e.exports&&e.exports.__decorate||function(e,t,r,i){var n,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o},b=e.exports&&e.exports.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},y=e.exports&&e.exports.__awaiter||function(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))},E=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},w=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Viewer=void 0;var x=s("iqwE1"),A=s("dk8Lz"),T=s("iBhyF"),S=s("cTTbu");s("yoicn");var M=s("bJEmL"),C=s("1VbNx"),R=s("eYU63"),I=s("5Ayxh"),O=s("gtDbi"),P=s("e1rbB");let k=class{constructor(e){r.set(this,{}),i.set(this,M.instance.resolve(S.Converter)),n.set(this,M.instance.resolve(S.EventEngine)),o.set(this,M.instance.resolve(S.InputValidator)),a.set(this,{}),l.set(this,M.instance.resolve(S.Logger)),c.set(this,M.instance.resolve(S.PerformanceEvaluator)),u.set(this,M.instance.resolve(R.Tree)),h.set(this,M.instance.resolve(S.StateEngine)),d.set(this,M.instance.resolve(S.UuidGenerator)),f.set(this,[]),p.set(this,[]),m.set(this,[]),g.set(this,[]),v.set(this,void 0);try{E(this,v,new x.RenderingEngine(e),"f"),M.instance.registerInstance("renderingEngine",w(this,v,"f")),this.camera||this.createCamera(A.CAMERATYPE.PERSPECTIVE),this.update(),w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${e.id}).constructor: Viewer created.`)}catch(t){if(t instanceof S.ShapeDiverViewerError||t instanceof S.ShapeDiverBackendError)throw t;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${e.id}).constructor`,t)}}get ambientOcclusion(){return w(this,v,"f").ambientOcclusion}set ambientOcclusion(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusion: Updating AmbientOcclusion to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusion`,e,"boolean"),w(this,v,"f").ambientOcclusion=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusion: ambientOcclusion was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusion`,e)}}get ambientOcclusionIntensity(){return w(this,v,"f").ambientOcclusionIntensity}set ambientOcclusionIntensity(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusionIntensity: Updating ambientOcclusionIntensity to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusionIntensity`,e,"factor"),w(this,v,"f").ambientOcclusionIntensity=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusionIntensity: ambientOcclusionIntensity was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).ambientOcclusionIntensity`,e)}}get animations(){return w(this,v,"f").animations}get automaticResizing(){return w(this,v,"f").automaticResizing}set automaticResizing(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).automaticResizing: Updating AutomaticResizing to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).automaticResizing`,e,"boolean"),w(this,v,"f").automaticResizing=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).automaticResizing: automaticResizing was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).automaticResizing`,e)}}get beautyRenderBlendingDuration(){return w(this,v,"f").beautyRenderBlendingDuration}set beautyRenderBlendingDuration(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderBlendingDuration: Updating RenderBlendingDuration to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderBlendingDuration`,e,"positive"),w(this,v,"f").beautyRenderBlendingDuration=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderBlendingDuration: beautyRenderBlendingDuration was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderBlendingDuration`,e)}}get beautyRenderDelay(){return w(this,v,"f").beautyRenderDelay}set beautyRenderDelay(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderDelay: Updating BeautyRenderDelay to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderDelay`,e,"positive"),w(this,v,"f").beautyRenderDelay=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderDelay: beautyRenderDelay was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).beautyRenderDelay`,e)}}get blur(){return w(this,v,"f").blur}set blur(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blur: Updating Blur to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blur`,e,"boolean"),w(this,v,"f").blur=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blur: blur was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blur`,e)}}get blurSceneWhenBusy(){return w(this,v,"f").blurSceneWhenBusy}set blurSceneWhenBusy(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy: Updating BlurSceneWhenBusy to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy`,e,"boolean"),w(this,v,"f").blurSceneWhenBusy=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy: blurSceneWhenBusy was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy`,e)}}get camera(){return w(this,v,"f").cameraEngine.camera?this.cameras[w(this,v,"f").cameraEngine.camera.id]:null}get cameras(){for(let e in w(this,v,"f").cameraEngine.cameras)w(this,r,"f")[e]||(w(this,r,"f")[e]=w(this,v,"f").cameraEngine.cameras[e].type===A.CAMERATYPE.ORTHOGRAPHIC?new I.OrthographicCamera(w(this,v,"f").cameraEngine.cameras[e],this):new O.PerspectiveCamera(w(this,v,"f").cameraEngine.cameras[e],this));for(let e in w(this,r,"f"))w(this,v,"f").cameraEngine.cameras[e]||delete w(this,r,"f")[e];return w(this,r,"f")}get canvas(){return w(this,v,"f").canvas}get clearAlpha(){return w(this,v,"f").clearAlpha}set clearAlpha(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearAlpha: Updating ClearAlpha to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearAlpha`,e,"factor"),w(this,v,"f").clearAlpha=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearAlpha: clearAlpha was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearAlpha`,e)}}get clearColor(){return w(this,v,"f").clearColor}set clearColor(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearColor: Updating ClearColor to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearColor`,e,"color"),w(this,v,"f").clearColor=w(this,i,"f").toColor(e),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearColor: clearColor was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).clearColor`,e)}}get convertSDTFItemToVisualizationData(){return w(this,v,"f").convertSDTFItemToVisualizationData}set convertSDTFItemToVisualizationData(e){w(this,v,"f").convertSDTFItemToVisualizationData=e}get domEventEngine(){return w(this,v,"f").domEventEngine}get environmentMap(){return w(this,v,"f").environmentMap}set environmentMap(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMap: Updating EnvironmentMap to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMap`,e,"cubeMap"),w(this,h,"f").viewers[this.id].environmentMapLoaded.then((()=>{w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMap: environmentMap was set to: ${e}`),this.update()})),w(this,v,"f").environmentMap=e}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMap`,e)}}get environmentMapAsBackground(){return w(this,v,"f").environmentMapAsBackground}set environmentMapAsBackground(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapAsBackground: Updating EnvironmentMapAsBackground to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapAsBackground`,e,"boolean"),w(this,v,"f").environmentMapAsBackground=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapAsBackground: environmentMapAsBackground was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapAsBackground`,e)}}get environmentMapResolution(){return w(this,v,"f").environmentMapResolution}set environmentMapResolution(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapResolution: Updating EnvironmentMapResolution to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapResolution`,e,"string"),w(this,v,"f").environmentMapResolution=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapResolution: environmentMapResolution was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).environmentMapResolution`,e)}}get gridColor(){return w(this,v,"f").gridColor}set gridColor(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridColor: Updating GridColor to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridColor`,e,"color"),w(this,v,"f").gridColor=w(this,i,"f").toColor(e),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridColor: gridColor was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridColor: Something unexpected happened.`,e)}}get gridVisibility(){return w(this,v,"f").gridVisibility}set gridVisibility(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridVisibility: Updating GridVisibility to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridVisibility`,e,"boolean"),w(this,v,"f").gridVisibility=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridVisibility: gridVisibility was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).gridVisibility`,e)}}get groundPlaneColor(){return w(this,v,"f").groundPlaneColor}set groundPlaneColor(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneColor: Updating groundPlaneColor to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneColor`,e,"color"),w(this,v,"f").groundPlaneColor=w(this,i,"f").toColor(e),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneColor: groundPlaneColor was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneColor: Something unexpected happened.`,e)}}get groundPlaneVisibility(){return w(this,v,"f").groundPlaneVisibility}set groundPlaneVisibility(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneVisibility: Updating GroundPlaneVisibility to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneVisibility`,e,"boolean"),w(this,v,"f").groundPlaneVisibility=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneVisibility: groundPlaneVisibility was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).groundPlaneVisibility`,e)}}get id(){return w(this,v,"f")?w(this,v,"f").id:""}get lightScene(){return w(this,v,"f").lightEngine.lightScene?this.lightScenes[w(this,v,"f").lightEngine.lightScene.id]:null}get lightSceneId(){return w(this,v,"f").lightEngine.lightScene?w(this,v,"f").lightEngine.lightScene.id:""}set lightSceneId(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).lightScene: Updating LightScene to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).lightScene`,e,"string"),this.assignLightScene(e)&&w(this,l,"f").debug(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).lightScene: lightScene was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).lightScene`,e)}}get lightScenes(){for(let e in w(this,v,"f").lightEngine.lightScenes)w(this,a,"f")[e]||(w(this,a,"f")[e]=new P.LightScene(w(this,v,"f").lightEngine.lightScenes[e],this));for(let e in w(this,a,"f"))w(this,v,"f").lightEngine.lightScenes[e]||delete w(this,a,"f")[e];return w(this,a,"f")}get outputEncoding(){return w(this,v,"f").outputEncoding}set outputEncoding(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).outputEncoding: Updating outputEncoding to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).outputEncoding`,e,"enum",!0,Object.values(T.TEXTURE_ENCODING)),w(this,v,"f").outputEncoding=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy: outputEncoding was set to: ${e}`),w(this,u,"f").root.updateVersion(),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).outputEncoding: Something unexpected happened.`,e)}}get physicallyCorrectLights(){return w(this,v,"f").physicallyCorrectLights}set physicallyCorrectLights(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).physicallyCorrectLights: Updating physicallyCorrectLights to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).physicallyCorrectLights`,e,"boolean"),w(this,v,"f").physicallyCorrectLights=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).physicallyCorrectLights: physicallyCorrectLights was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).physicallyCorrectLights`,e)}}get pointSize(){return w(this,v,"f").pointSize}set pointSize(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).pointSize: Updating PointSize to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).pointSize`,e,"positive"),w(this,v,"f").pointSize=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).pointSize: pointSize was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).pointSize: Something unexpected happened.`,e)}}get shadows(){return w(this,v,"f").shadows}set shadows(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).shadows: Updating Shadows to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).shadows`,e,"boolean"),w(this,v,"f").shadows=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).shadows: shadows was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).shadows`,e)}}get show(){return w(this,v,"f").show}set show(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).show: Updating Show to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).show`,e,"boolean"),w(this,v,"f").show=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).show: show was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).show`,e)}}get showStatistics(){return w(this,v,"f").showStatistics}set showStatistics(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).showStatistics: Updating ShowStatistics to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).showStatistics`,e,"boolean"),w(this,v,"f").showStatistics=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).showStatistics: showStatistics was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).showStatistics`,e)}}get textureEncoding(){return w(this,v,"f").textureEncoding}set textureEncoding(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).textureEncoding: Updating textureEncoding to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).textureEncoding`,e,"enum",!0,Object.values(T.TEXTURE_ENCODING)),w(this,v,"f").textureEncoding=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy: textureEncoding was set to: ${e}`),w(this,u,"f").root.updateVersion(),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).textureEncoding: Something unexpected happened.`,e)}}get toneMapping(){return w(this,v,"f").toneMapping}set toneMapping(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).toneMapping: Updating toneMapping to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).toneMapping`,e,"enum",!0,Object.values(T.TONE_MAPPING)),w(this,v,"f").toneMapping=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy: toneMapping was set to: ${e}`),w(this,u,"f").root.updateVersion(),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).toneMapping: Something unexpected happened.`,e)}}get toneMappingExposure(){return w(this,v,"f").toneMappingExposure}set toneMappingExposure(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).toneMappingExposure: Updating toneMappingExposure to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).toneMappingExposure`,e,"positive"),w(this,v,"f").toneMappingExposure=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).toneMappingExposure: toneMappingExposure was set to: ${e}`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).toneMappingExposure: Something unexpected happened.`,e)}}get type(){return w(this,v,"f").type}set type(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).type: Updating Type to ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).type`,e,"enum",!0,Object.values(T.RENDERERTYPE)),w(this,v,"f").type=e,w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy: type was set to: ${e}`),w(this,u,"f").root.updateVersion(),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).blurSceneWhenBusy`,e)}}addCameraFreezeFlag(){const e=w(this,d,"f").create();return w(this,p,"f").push(e),w(this,v,"f").cameraEngine.deactivateCameraEvents(),e}addCanvasEventListener(e){try{return w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).addCanvasEventListener: Adding new canvas event listener.`),w(this,v,"f").domEventEngine.addDomEventListener(e)}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).addCanvasEventListener`,e)}}addContinuousRenderingFlag(){const e=w(this,d,"f").create();return w(this,m,"f").push(e),w(this,v,"f").continuousRendering=!0,e}addShadowMapUpdateFlag(){const e=w(this,d,"f").create();return w(this,g,"f").push(e),w(this,v,"f").continuousShadowMapUpdate=!0,e}applySettings(e={camera:!0,light:!0,scene:!0,environment:!0}){w(this,v,"f").applySettings(e)}assignCamera(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).assignCamera: Assigning Camera with id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).assignCamera`,e,"string"),w(this,v,"f").cameraEngine.assignCamera(e),w(this,l,"f").debug(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).assignCamera: Camera with id ${e} assigned.`),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).assignCamera`,e)}}assignLightScene(e){try{if(w(this,l,"f").debugLow(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).assignLightScene: Assigning LightScene with id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).assignLightScene`,e,"string"),this.lightScene&&this.lightScene.id===e)return w(this,l,"f").warn(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).assignLightScene: The light scene with id ${e} was already assigned.`),!0;const t=w(this,v,"f").lightEngine.assignLightScene(e);if(t&&w(this,l,"f").debug(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).assignLightScene: Assigned light scene with id ${e}.`),!t){const e=new S.ShapeDiverViewerLightError(`Viewer(${this.id}).assignLightScene: Could not assign light scene.`);throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).assignLightScene`,e)}return this.update(),t}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).assignLightScene`,e)}}close(){return y(this,void 0,void 0,(function*(){const e=yield w(this,v,"f").close();return w(this,n,"f").emitEvent(S.EVENTTYPE.VIEWER.VIEWER_CLOSED,{viewerId:this.id}),e||w(this,l,"f").warn(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}): Was not able to close viewer completely, please disregard this viewer.`),e}))}createCamera(e,t){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createCamera: Creating Camera with id ${t} and type ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createCamera`,e,"enum",!0,Object.values(A.CAMERATYPE)),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createCamera`,t,"string",!1);const r=w(this,v,"f").cameraEngine.createCamera(e,t);return w(this,l,"f").debug(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createCamera: ${r.type===A.CAMERATYPE.ORTHOGRAPHIC?"Orthographic":"Perspective"} camera with id ${t} created.`),this.assignCamera(r.id),this.cameras[r.id]}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).createCamera`,e)}}createLightScene(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).createLightScene: Creating LightScene with properties ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).createLightScene`,e,"object",!1);const t=Object.assign({},e);w(this,o,"f").validateAndError(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).createLightScene`,t.name,"string",!1),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).createLightScene`,t.standard,"boolean",!1);const r=w(this,v,"f").lightEngine.createLightScene(t);return w(this,l,"f").debug(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).createLightScene: New light scene with id ${r.id} created.`),r.id&&this.assignLightScene(r.id),this.update(),this.lightScenes[r.id]}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).createLightScene`,e)}}createOrthographicCamera(e){try{return w(this,l,"f").debugLow(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createOrthographicCamera: Creating OrthographicCamera with id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createOrthographicCamera`,e,"string",!1),w(this,l,"f").debug(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createOrthographicCamera: Orthographic camera with id ${e} created.`),this.createCamera(A.CAMERATYPE.ORTHOGRAPHIC,e)}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).createOrthographicCamera`,e)}}createPerspectiveCamera(e){try{return w(this,l,"f").debugLow(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createPerspectiveCamera: Creating PerspectiveCamera with id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createPerspectiveCamera`,e,"string",!1),w(this,l,"f").debug(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).createPerspectiveCamera: Perspective camera with id ${e} created.`),this.createCamera(A.CAMERATYPE.PERSPECTIVE,e)}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).createPerspectiveCamera`,e)}}deregisterBusyMode(e){try{return w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).deregisterBusyMode: Deregistering busy mode for id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).deregisterBusyMode`,e,"string"),w(this,f,"f").includes(e)?(w(this,f,"f").splice(w(this,f,"f").indexOf(e),1),0===w(this,f,"f").length&&(w(this,v,"f").busy=!1),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).deregisterBusyMode: Busy mode was deregistered for id: ${e}`),this.update(),!0):!1}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).deregisterBusyMode`,e)}}displayErrorMessage(e){!1===this.show&&w(this,v,"f").displayErrorMessage(e)}getEnvironmentMapImageUrl(){return w(this,v,"f").getEnvironmentMapImageUrl()}getScreenshot(e,t){try{return w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).getScreenshot: Getting getScreenshot with type ${e} and quality ${t}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).getScreenshot`,e,"string",!1),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).getScreenshot`,t,"factor",!1),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).getScreenshot: screenshot was requested`),w(this,v,"f").getScreenshot(e,t)}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).getScreenshot`,e)}}registerBusyMode(e){try{return w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).registerBusyMode: Registering busy mode for id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).registerBusyMode`,e,"string"),w(this,f,"f").includes(e)?!1:(w(this,f,"f").push(e),!0===this.blurSceneWhenBusy&&(w(this,v,"f").busy=!0),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).registerBusyMode: Busy mode was registered for id: ${e}`),this.update(),!0)}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).registerBusyMode`,e)}}removeCamera(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).removeCamera: Removing Camera with id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).removeCamera`,e,"string");const t=w(this,v,"f").cameraEngine.removeCamera(e);return t&&w(this,l,"f").debug(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).removeCamera: Camera with id ${e} removed.`),t||w(this,l,"f").debug(S.LOGGINGTOPIC.CAMERA,`Viewer(${this.id}).removeCamera: Could not remove camera with id ${e}.`),this.update(),t}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).removeCamera`,e)}}removeCameraFreezeFlag(e){return!!w(this,p,"f").includes(e)&&(w(this,p,"f").splice(w(this,p,"f").indexOf(e),1),0===w(this,p,"f").length&&w(this,v,"f").cameraEngine.activateCameraEvents(),!0)}removeCanvasEventListener(e){try{return w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).removeCanvasEventListener: Removing canvas event listener.`),w(this,v,"f").domEventEngine.removeDomEventListener(e)}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).removeCanvasEventListener`,e)}}removeContinuousRenderingFlag(e){return!!w(this,m,"f").includes(e)&&(w(this,m,"f").splice(w(this,m,"f").indexOf(e),1),0===w(this,m,"f").length&&(w(this,v,"f").continuousRendering=!1),!0)}removeLightScene(e){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLightScene: Removing LightScene with id ${e}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLightScene`,e,"string");const t=w(this,v,"f").lightEngine.removeLightScene(e);return t&&w(this,l,"f").debug(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLightScene: Light scene with id ${e} removed.`),t||w(this,l,"f").debug(S.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLightScene: Could not remove light scene with id ${e}.`),this.update(),t}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).removeLightScene`,e)}}removeShadowMapUpdateFlag(e){return!!w(this,g,"f").includes(e)&&(w(this,g,"f").splice(w(this,g,"f").indexOf(e),1),0===w(this,g,"f").length&&(w(this,v,"f").continuousShadowMapUpdate=!1),!0)}render(){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).render: Rendering Viewer.`),w(this,v,"f").renderingManager.render(),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).render`,e)}}reset(){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).reset: Resetting Viewer.`),w(this,v,"f").reset(),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).reset`,e)}}resize(e,t){try{w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).resize: Resizing Viewer to ${e} / ${t}.`),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).resize`,e,"number"),w(this,o,"f").validateAndError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).resize`,t,"number"),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).resize: Resized Viewer to ${e} / ${t}.`),w(this,v,"f").resize(e,t),this.update()}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).resize`,e)}}update(){try{if(w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).update: Updating Viewer.`),!w(this,v,"f"))return;w(this,v,"f").update(),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).update: Updated viewer.`),w(this,n,"f").emitEvent(S.EVENTTYPE.VIEWER.VIEWER_UPDATED,{viewerId:this.id})}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).update`,e)}}updateNode(e){try{if(w(this,l,"f").debugLow(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).updateNode: Updating Node.`),!w(this,v,"f"))return;w(this,v,"f").sceneTreeManager.updateNode(e,e.transformedNodes[this.id]),w(this,l,"f").debug(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).updateNode: Updated Node.`)}catch(e){if(e instanceof S.ShapeDiverViewerError||e instanceof S.ShapeDiverBackendError)throw e;throw w(this,l,"f").handleError(S.LOGGINGTOPIC.VIEWER,`Viewer(${this.id}).updateNode`,e)}}};r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap,c=new WeakMap,u=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakMap,k=_([C.default(),b("design:paramtypes",[Object])],k),e.exports.Viewer=k})),s.register("5Ayxh",(function(e,t){var r,i,n,o,a,l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OrthographicCamera=void 0;var u=s("dk8Lz"),h=s("cTTbu");s("yoicn");var d=s("bJEmL"),f=s("8uSp9"),p=s("egF79");class m extends f.AbstractCamera{constructor(e,t){super(e,t),r.set(this,void 0),i.set(this,void 0),n.set(this,d.instance.resolve(h.InputValidator)),o.set(this,d.instance.resolve(h.Logger)),a.set(this,void 0);try{l(this,r,e,"f"),l(this,a,t,"f"),l(this,i,new p.OrthographicCameraControls(e.controls,t),"f")}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(h.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).constructor`,e)}}get controls(){return c(this,i,"f")}get direction(){return c(this,r,"f").direction}set direction(e){try{c(this,o,"f").debugLow(h.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).direction: Updating Direction to ${e}.`),c(this,n,"f").validateAndError(h.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).direction`,e,"enum",!0,Object.values(u.ORTHOGRAPHIC_CAMERA_DIRECTION)),c(this,r,"f").direction=e,c(this,r,"f").zoomTo(void 0,{duration:0}),c(this,a,"f").update(),c(this,o,"f").debug(h.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).direction: direction was set to: ${e}`)}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(h.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).direction`,e)}}}e.exports.OrthographicCamera=m,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap})),s.register("8uSp9",(function(e,t){var r,i,n,o,a,l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractCamera=void 0,s("yoicn");var u=s("bJEmL"),h=s("eIStk"),d=s("cTTbu"),f=s("6UMiq"),p=s("eYU63");e.exports.AbstractCamera=class{constructor(e,t){r.set(this,void 0),i.set(this,u.instance.resolve(d.InputValidator)),n.set(this,u.instance.resolve(d.Logger)),o.set(this,u.instance.resolve(p.Tree)),a.set(this,void 0);try{l(this,r,e,"f"),l(this,a,t,"f"),c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).constructor: Camera api created.`)}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).constructor`,e)}}get autoAdjust(){return c(this,r,"f").autoAdjust}set autoAdjust(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).autoAdjust: Updating AutoAdjust to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).autoAdjust`,e,"boolean"),c(this,r,"f").autoAdjust=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).autoAdjust: autoAdjust was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).autoAdjust`,e)}}get cameraMovementDuration(){return c(this,r,"f").cameraMovementDuration}set cameraMovementDuration(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).cameraMovementDuration: Updating CameraMovementDuration to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).cameraMovementDuration`,e,"positive"),c(this,r,"f").cameraMovementDuration=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).cameraMovementDuration: cameraMovementDuration was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).cameraMovementDuration`,e)}}get defaultPosition(){return c(this,r,"f").defaultPosition}set defaultPosition(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultPosition: Updating DefaultPosition to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultPosition`,e,"vec3"),c(this,r,"f").defaultPosition=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultPosition: defaultPosition was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultPosition`,e)}}get defaultTarget(){return c(this,r,"f").defaultTarget}set defaultTarget(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultTarget: Updating DefaultTarget to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultTarget`,e,"vec3"),c(this,r,"f").defaultTarget=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultTarget: defaultTarget was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).defaultTarget`,e)}}get enableCameraControls(){return c(this,r,"f").enableCameraControls}set enableCameraControls(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).enableCameraControls: Updating EnableCameraControls to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).enableCameraControls`,e,"boolean"),c(this,r,"f").enableCameraControls=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).enableCameraControls: enableCameraControls was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).enableCameraControls`,e)}}get id(){return c(this,r,"f").id}get order(){return c(this,r,"f").order}set order(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).order: Updating Order to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).order`,e,"number",!1),c(this,r,"f").order=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).order: order was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).order`,e)}}get position(){return c(this,r,"f").position}set position(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).position: Updating Position to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).position`,e,"vec3"),c(this,r,"f").position=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).position: position was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).position`,e)}}get revertAtMouseUp(){return c(this,r,"f").revertAtMouseUp}set revertAtMouseUp(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUp: Updating RevertAtMouseUp to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUp`,e,"boolean"),c(this,r,"f").revertAtMouseUp=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUp: revertAtMouseUp was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUp`,e)}}get revertAtMouseUpDuration(){return c(this,r,"f").revertAtMouseUpDuration}set revertAtMouseUpDuration(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUpDuration: Updating RevertAtMouseUpDuration to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUpDuration`,e,"positive"),c(this,r,"f").revertAtMouseUpDuration=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUpDuration: revertAtMouseUpDuration was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).revertAtMouseUpDuration`,e)}}get target(){return c(this,r,"f").target}set target(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).target: Updating Target to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).target`,e,"vec3"),c(this,r,"f").target=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).target: target was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).target`,e)}}get type(){return c(this,r,"f").type}get zoomExtentsFactor(){return c(this,r,"f").zoomExtentsFactor}set zoomExtentsFactor(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomExtentsFactor: Updating ZoomExtentsFactor to ${e}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomExtentsFactor`,e,"positive"),c(this,r,"f").zoomExtentsFactor=e,c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomExtentsFactor: zoomExtentsFactor was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomExtentsFactor`,e)}}animate(e,t){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate: Animating with path ${e} and options ${JSON.stringify(t)}.`);for(let t=0;t<e.length;t++)c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,e[t].position,"vec3"),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,e[t].target,"vec3");c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,t,"object",!1);const s=Object.assign({},t);return c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,s.easing,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,s.duration,"number",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,s.default,"boolean",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,s.coordinates,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,s.interpolation,"string",!1),c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate: Starting camera path animation.`),c(this,r,"f").animate(e,s)}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).animate`,e)}}project(e){try{return c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).project: Projecting point ${e}.`),c(this,r,"f").project(e)}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).project`,e)}}reset(e){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset: Resetting with options ${JSON.stringify(e)}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset`,e,"object",!1);const t=Object.assign({},e);return c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset`,t.easing,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset`,t.duration,"number",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset`,t.coordinates,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset`,t.interpolation,"string",!1),c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset: Resetting position and target.`),c(this,r,"f").reset(t)}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).reset`,e)}}set(e,t,s){try{c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set: Setting to position ${e} and target ${t} with options ${JSON.stringify(s)}.`),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,e,"vec3"),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,t,"vec3"),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,s,"object",!1);const o=Object.assign({},s);return c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,o.easing,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,o.duration,"number",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,o.coordinates,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,o.interpolation,"string",!1),c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set: Setting position to ${e} and target to ${t}.`),c(this,r,"f").set(h.fromValues(e[0],e[1],e[2]),h.fromValues(t[0],t[1],t[2]),o)}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).set`,e)}}unproject(e){try{return c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).unproject: Unprojecting point ${e}.`),c(this,r,"f").unproject(e)}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).unproject`,e)}}zoomTo(e,t){try{let s;if(c(this,n,"f").debugLow(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo: Zooming to ${e} with options ${JSON.stringify(t)}.`),e)if(Array.isArray(e)){c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,e,"stringArray"),s=new f.Box;for(let t=0;t<e.length;t++){const r=c(this,o,"f").getNodeAtPath(e[t]);r&&s.union(r.boundingBox)}}else{if(!(e instanceof f.Box)){const e=new d.ShapeDiverViewerCameraError(`Camera(${this.id}).zoomTo: No valid zoom target supplied.`);throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,e)}s=e.clone()}c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,t,"object",!1);const a=Object.assign({},t);return c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,a.easing,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,a.duration,"number",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,a.coordinates,"string",!1),c(this,i,"f").validateAndError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,a.interpolation,"string",!1),c(this,n,"f").debug(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo: Zooming in.`),c(this,r,"f").zoomTo(s,a)}catch(e){if(e instanceof d.ShapeDiverViewerError||e instanceof d.ShapeDiverBackendError)throw e;throw c(this,n,"f").handleError(d.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).zoomTo`,e)}}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap})),s.register("egF79",(function(e,t){var r,i,n,o,a=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},l=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OrthographicCameraControls=void 0;var c=s("cTTbu");s("yoicn");var u=s("bJEmL");e.exports.OrthographicCameraControls=class{constructor(e,t){r.set(this,void 0),i.set(this,u.instance.resolve(c.InputValidator)),n.set(this,u.instance.resolve(c.Logger)),o.set(this,void 0);try{a(this,r,e,"f"),a(this,o,t,"f"),l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).constructor: OrthographicCameraControlsLogic api created.`)}catch(t){if(t instanceof c.ShapeDiverViewerError||t instanceof c.ShapeDiverBackendError)throw t;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${e.camera.id}).constructor`,t)}}get damping(){return l(this,r,"f").damping}set damping(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).damping: Updating Damping to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).updateDamping`,e,"positive"),l(this,r,"f").damping=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).damping: damping was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).damping`,e)}}get enableKeyPan(){return l(this,r,"f").enableKeyPan}set enableKeyPan(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableKeyPan: Updating EnableKeyPan to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableKeyPan`,e,"boolean"),l(this,r,"f").enableKeyPan=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableKeyPan: enableKeyPan was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enableKeyPan`,e)}}get enablePan(){return l(this,r,"f").enablePan}set enablePan(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enablePan: Updating EnablePan to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enablePan`,e,"boolean"),l(this,r,"f").enablePan=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enablePan: enablePan was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enablePan`,e)}}get enableZoom(){return l(this,r,"f").enableZoom}set enableZoom(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableZoom: Updating EnableZoom to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableZoom`,e,"boolean"),l(this,r,"f").enableZoom=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableZoom: enableZoom was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enableZoom`,e)}}get enabled(){return l(this,r,"f").enabled}set enabled(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enabled: Updating Enabled to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enabled`,e,"boolean"),l(this,r,"f").enabled=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enabled: enabled was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enabled`,e)}}get input(){return l(this,r,"f").input}set input(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input: Updating Input to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.down,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.left,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.right,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.up,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.mouse.pan,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.mouse.rotate,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.mouse.zoom,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.touch.pan,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.touch.rotate,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.touch.zoom,"number"),l(this,r,"f").input=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input: input was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).input`,e)}}get keyPanSpeed(){return l(this,r,"f").keyPanSpeed}set keyPanSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).keyPanSpeed: Updating KeyPanSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).keyPanSpeed`,e,"factor"),l(this,r,"f").keyPanSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).keyPanSpeed: keyPanSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).keyPanSpeed`,e)}}get movementSmoothness(){return l(this,r,"f").movementSmoothness}set movementSmoothness(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).movementSmoothness: Updating MovementSmoothness to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).movementSmoothness`,e,"factor"),l(this,r,"f").movementSmoothness=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).movementSmoothness: movementSmoothness was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).movementSmoothness`,e)}}get panSpeed(){return l(this,r,"f").panSpeed}set panSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).panSpeed: Updating PanSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).panSpeed`,e,"factor"),l(this,r,"f").panSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).panSpeed: panSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).panSpeed`,e)}}get zoomSpeed(){return l(this,r,"f").zoomSpeed}set zoomSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomSpeed: ZoomSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomSpeed`,e,"factor"),l(this,r,"f").zoomSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomSpeed: zoomSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).zoomSpeed`,e)}}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap})),s.register("gtDbi",(function(e,t){var r,i,n,o,a,l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PerspectiveCamera=void 0;var u=s("cTTbu");s("yoicn");var h=s("bJEmL"),d=s("8uSp9"),f=s("kMmf7");class p extends d.AbstractCamera{constructor(e,t){super(e,t),r.set(this,void 0),i.set(this,void 0),n.set(this,h.instance.resolve(u.InputValidator)),o.set(this,h.instance.resolve(u.Logger)),a.set(this,void 0);try{l(this,r,e,"f"),l(this,a,t,"f"),l(this,i,new f.PerspectiveCameraControls(e.controls,t),"f")}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(u.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).constructor`,e)}}get controls(){return c(this,i,"f")}get fov(){return c(this,r,"f").fov}set fov(e){try{c(this,o,"f").debugLow(u.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).fov: Updating Fov to ${e}.`),c(this,n,"f").validateAndError(u.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).fov`,e,"positive"),c(this,r,"f").fov=e,c(this,a,"f").update(),c(this,o,"f").debug(u.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).fov: fov was set to: ${e}`)}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(u.LOGGINGTOPIC.CAMERA,`Camera(${this.id}).fov`,e)}}}e.exports.PerspectiveCamera=p,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap})),s.register("kMmf7",(function(e,t){var r,i,n,o,a=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},l=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PerspectiveCameraControls=void 0;var c=s("cTTbu");s("yoicn");var u=s("bJEmL");e.exports.PerspectiveCameraControls=class{constructor(e,t){r.set(this,void 0),i.set(this,u.instance.resolve(c.InputValidator)),n.set(this,u.instance.resolve(c.Logger)),o.set(this,void 0);try{a(this,r,e,"f"),a(this,o,t,"f"),l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).constructor: PerspectiveCameraControlsLogic api created.`)}catch(t){if(t instanceof c.ShapeDiverViewerError||t instanceof c.ShapeDiverBackendError)throw t;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${e.camera.id}).constructor`,t)}}get autoRotationSpeed(){return l(this,r,"f").autoRotationSpeed}set autoRotationSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).autoRotationSpeed: Updating AutoRotationSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).autoRotationSpeed`,e,"number"),l(this,r,"f").autoRotationSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).autoRotationSpeed: autoRotationSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).autoRotationSpeed`,e)}}get cubePositionRestriction(){return l(this,r,"f").cubePositionRestriction}set cubePositionRestriction(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubePositionRestriction: Updating CubePositionRestriction to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubePositionRestriction`,e.min,"vec3"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubePositionRestriction`,e.max,"vec3"),l(this,r,"f").cubePositionRestriction=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubePositionRestriction: cubePositionRestriction was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).cubePositionRestriction`,e)}}get cubeTargetRestriction(){return l(this,r,"f").cubeTargetRestriction}set cubeTargetRestriction(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubeTargetRestriction: Updating CubeTargetRestriction to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubeTargetRestriction`,e.min,"vec3"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubeTargetRestriction`,e.max,"vec3"),l(this,r,"f").cubeTargetRestriction=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).cubeTargetRestriction: cubeTargetRestriction was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).cubeTargetRestriction`,e)}}get damping(){return l(this,r,"f").damping}set damping(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).damping: Updating Damping to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).damping`,e,"positive"),l(this,r,"f").damping=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).damping: damping was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).damping`,e)}}get enableAutoRotation(){return l(this,r,"f").enableAutoRotation}set enableAutoRotation(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableAutoRotation: Updating EnableAutoRotation to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableAutoRotation`,e,"boolean"),l(this,r,"f").enableAutoRotation=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableAutoRotation: enableAutoRotation was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enableAutoRotation`,e)}}get enableKeyPan(){return l(this,r,"f").enableKeyPan}set enableKeyPan(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableKeyPan: Updating EnableKeyPan to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableKeyPan`,e,"boolean"),l(this,r,"f").enableKeyPan=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableKeyPan: enableKeyPan was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enableKeyPan`,e)}}get enablePan(){return l(this,r,"f").enablePan}set enablePan(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enablePan: Updating EnablePan to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enablePan`,e,"boolean"),l(this,r,"f").enablePan=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enablePan: enablePan was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enablePan`,e)}}get enableRotation(){return l(this,r,"f").enableRotation}set enableRotation(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableRotation: Updating EnableRotation to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableRotation`,e,"boolean"),l(this,r,"f").enableRotation=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableRotation: enableRotation was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enableRotation`,e)}}get enableZoom(){return l(this,r,"f").enableZoom}set enableZoom(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableZoom: Updating EnableZoom to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableZoom`,e,"boolean"),l(this,r,"f").enableZoom=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enableZoom: enableZoom was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enableZoom`,e)}}get enabled(){return l(this,r,"f").enabled}set enabled(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enabled: Updating Enabled to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enabled`,e,"boolean"),l(this,r,"f").enabled=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).enabled: enabled was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).enabled`,e)}}get input(){return l(this,r,"f").input}set input(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input: Updating Input to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.down,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.left,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.right,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.keys.up,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.mouse.pan,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.mouse.rotate,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.mouse.zoom,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.touch.pan,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.touch.rotate,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input`,e.touch.zoom,"number"),l(this,r,"f").input=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).input: input was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).input`,e)}}get keyPanSpeed(){return l(this,r,"f").keyPanSpeed}set keyPanSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).keyPanSpeed: Updating KeyPanSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).keyPanSpeed`,e,"factor"),l(this,r,"f").keyPanSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).keyPanSpeed: keyPanSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).keyPanSpeed`,e)}}get movementSmoothness(){return l(this,r,"f").movementSmoothness}set movementSmoothness(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).movementSmoothness: Updating MovementSmoothness to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).movementSmoothness`,e,"factor"),l(this,r,"f").movementSmoothness=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).movementSmoothness: movementSmoothness was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).movementSmoothness`,e)}}get panSpeed(){return l(this,r,"f").panSpeed}set panSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).panSpeed: Updating PanSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).panSpeed`,e,"factor"),l(this,r,"f").panSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).panSpeed: panSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).panSpeed`,e)}}get rotationRestriction(){return l(this,r,"f").rotationRestriction}set rotationRestriction(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationRestriction: Updating RotationRestriction to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationRestriction`,e.minPolarAngle,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationRestriction`,e.maxPolarAngle,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationRestriction`,e.minAzimuthAngle,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationRestriction`,e.maxAzimuthAngle,"number"),l(this,r,"f").rotationRestriction=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationRestriction: rotationRestriction was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).rotationRestriction`,e)}}get rotationSpeed(){return l(this,r,"f").rotationSpeed}set rotationSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationSpeed: Updating RotationSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationSpeed`,e,"factor"),l(this,r,"f").rotationSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).rotationSpeed: rotationSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).rotationSpeed`,e)}}get spherePositionRestriction(){return l(this,r,"f").spherePositionRestriction}set spherePositionRestriction(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).spherePositionRestriction: Updating SpherePositionRestriction to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).spherePositionRestriction`,e.center,"vec3"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).spherePositionRestriction`,e.radius,"positive"),l(this,r,"f").spherePositionRestriction=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).spherePositionRestriction: spherePositionRestriction was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).spherePositionRestriction`,e)}}get sphereTargetRestriction(){return l(this,r,"f").sphereTargetRestriction}set sphereTargetRestriction(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).sphereTargetRestriction: Updating SphereTargetRestriction to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).sphereTargetRestriction`,e.center,"vec3"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).sphereTargetRestriction`,e.radius,"positive"),l(this,r,"f").sphereTargetRestriction=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).sphereTargetRestriction: sphereTargetRestriction was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).sphereTargetRestriction`,e)}}get zoomRestriction(){return l(this,r,"f").zoomRestriction}set zoomRestriction(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomRestriction: Updating ZoomRestriction to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomRestriction`,e.minDistance,"number"),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomRestriction`,e.maxDistance,"number"),l(this,r,"f").zoomRestriction=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomRestriction: zoomRestriction was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).zoomRestriction`,e)}}get zoomSpeed(){return l(this,r,"f").zoomSpeed}set zoomSpeed(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomSpeed: Updating ZoomSpeed to ${e}.`),l(this,i,"f").validateAndError(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomSpeed`,e,"factor"),l(this,r,"f").zoomSpeed=e,l(this,n,"f").debug(c.LOGGINGTOPIC.CAMERA_CONTROL,`Controls(${l(this,r,"f").camera.id}).zoomSpeed: zoomSpeed was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.CAMERA,`Camera(${l(this,r,"f").camera.id}).zoomSpeed`,e)}}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap})),s.register("e1rbB",(function(e,t){var r,i,n,o,a,l,c=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},u=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.LightScene=void 0;var h=s("cTTbu");s("yoicn");var d=s("bJEmL"),f=s("eAhLl"),p=s("hTsEN"),m=s("lXtIC"),g=s("9Tlc8"),v=s("4ADnQ"),_=s("6BHFq");e.exports.LightScene=class{constructor(e,t){r.set(this,d.instance.resolve(h.Converter)),i.set(this,d.instance.resolve(h.InputValidator)),n.set(this,void 0),o.set(this,{}),a.set(this,d.instance.resolve(h.Logger)),l.set(this,void 0),c(this,n,e,"f"),c(this,l,t,"f"),u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`LightScene(${this.id}).constructor: LightScene api created.`)}get id(){return u(this,n,"f").id}get lights(){const e=u(this,n,"f").lights;for(let t in e)if(!u(this,o,"f")[t])switch(e[t].type){case f.LIGHTTYPE.AMBIENT:u(this,o,"f")[t]=new p.AmbientLight(e[t],u(this,l,"f"));break;case f.LIGHTTYPE.DIRECTIONAL:u(this,o,"f")[t]=new m.DirectionalLight(e[t],u(this,l,"f"));break;case f.LIGHTTYPE.HEMISPHERE:u(this,o,"f")[t]=new g.HemisphereLight(e[t],u(this,l,"f"));break;case f.LIGHTTYPE.POINT:u(this,o,"f")[t]=new v.PointLight(e[t],u(this,l,"f"));break;case f.LIGHTTYPE.SPOT:u(this,o,"f")[t]=new _.SpotLight(e[t],u(this,l,"f"))}for(let t in u(this,o,"f"))e[t]||delete u(this,o,"f")[t];return u(this,o,"f")}get name(){return u(this,n,"f").name}set name(e){try{u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`LightScene(${this.id}).name: Updating Name to ${e}.`),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`LightScene(${this.id}).name`,e,"string",!1),u(this,n,"f").name=e,u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`LightScene(${this.id}).name: name was set to: ${e}`),u(this,l,"f").update()}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,a,"f").handleError(h.LOGGINGTOPIC.LIGHT,`Light(${this.id}).name`,e)}}get node(){return u(this,n,"f").node}addAmbientLight(e){try{u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addAmbientLight: Adding light with properties ${e}.`),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addAmbientLight`,e,"object",!1);const t=Object.assign({},e);u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addAmbientLight`,t.color,"color",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addAmbientLight`,t.intensity,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addAmbientLight`,t.name,"string",!1),void 0!==t.color&&(t.color=u(this,r,"f").toColor(t.color));const s=u(this,n,"f").addAmbientLight(t),o=this.lights[s.id];return u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addAmbientLight: Ambient light with id ${o.id} created.`),u(this,l,"f").update(),o}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,a,"f").handleError(h.LOGGINGTOPIC.LIGHT,`Light(${this.id}).addAmbientLight`,e)}}addDirectionalLight(e){try{u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight: Adding light with properties ${e}.`),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,e,"object",!1);const t=Object.assign({},e);u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,t.color,"color",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,t.intensity,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,t.direction,"vec3",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,t.castShadow,"boolean",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,t.shadowMapResolution,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,t.shadowMapBias,"number",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight`,t.name,"string",!1),void 0!==t.color&&(t.color=u(this,r,"f").toColor(t.color));const s=u(this,n,"f").addDirectionalLight(t),o=this.lights[s.id];return u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addDirectionalLight: Directional light with id ${o.id} created.`),u(this,l,"f").update(),o}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,a,"f").handleError(h.LOGGINGTOPIC.LIGHT,`Light(${this.id}).addDirectionalLight`,e)}}addHemisphereLight(e){try{u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addHemisphereLight: Adding light with properties ${e}.`),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addHemisphereLight`,e,"object",!1);const t=Object.assign({},e);u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addHemisphereLight`,t.color,"color",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addHemisphereLight`,t.groundColor,"color",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addHemisphereLight`,t.intensity,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addHemisphereLight`,t.name,"string",!1),void 0!==t.color&&(t.color=u(this,r,"f").toColor(t.color)),void 0!==t.groundColor&&(t.groundColor=u(this,r,"f").toColor(t.groundColor));const s=u(this,n,"f").addHemisphereLight(t),o=this.lights[s.id];return u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addHemisphereLight: Hemisphere light with id ${o.id} created.`),u(this,l,"f").update(),o}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,a,"f").handleError(h.LOGGINGTOPIC.LIGHT,`Light(${this.id}).addHemisphereLight`,e)}}addPointLight(e){try{u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight: Adding light with properties ${e}.`),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight`,e,"object",!1);const t=Object.assign({},e);u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight`,t.color,"color",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight`,t.intensity,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight`,t.position,"vec3",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight`,t.distance,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight`,t.decay,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight`,t.name,"string",!1),void 0!==t.color&&(t.color=u(this,r,"f").toColor(t.color));const s=u(this,n,"f").addPointLight(t),o=this.lights[s.id];return u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addPointLight: Point light with id ${o.id} created.`),u(this,l,"f").update(),o}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,a,"f").handleError(h.LOGGINGTOPIC.LIGHT,`Light(${this.id}).addPointLight`,e)}}addSpotLight(e){try{u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight: Adding light with properties ${e}.`),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,e,"object",!1);const t=Object.assign({},e);u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.color,"color",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.intensity,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.position,"vec3",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.target,"vec3",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.distance,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.decay,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.angle,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.penumbra,"positive",!1),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight`,t.name,"string",!1),void 0!==t.color&&(t.color=u(this,r,"f").toColor(t.color));const s=u(this,n,"f").addSpotLight(t),o=this.lights[s.id];return u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).addSpotLight: Spot light with id ${o.id} created.`),u(this,l,"f").update(),o}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,a,"f").handleError(h.LOGGINGTOPIC.LIGHT,`Light(${this.id}).addSpotLight`,e)}}removeLight(e){try{u(this,a,"f").debugLow(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLight: Removing Light with id ${e}.`),u(this,i,"f").validateAndError(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLight`,e,"string");const t=u(this,n,"f").removeLight(e);return t&&u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLight: Light with id ${e} removed.`),t||u(this,a,"f").debug(h.LOGGINGTOPIC.LIGHT,`Viewer(${this.id}).removeLight: Could not remove light with id ${e}.`),u(this,l,"f").update(),t}catch(e){if(e instanceof h.ShapeDiverViewerError||e instanceof h.ShapeDiverBackendError)throw e;throw u(this,a,"f").handleError(h.LOGGINGTOPIC.LIGHT,`Light(${this.id}).removeLight`,e)}}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap,l=new WeakMap})),s.register("hTsEN",(function(e,t){var r,i=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AmbientLight=void 0;var n=s("lDtT6");class o extends n.AbstractLight{constructor(e,t){super(e,t),r.set(this,void 0),i(this,r,e,"f")}}e.exports.AmbientLight=o,r=new WeakMap})),s.register("lDtT6",(function(e,t){var r,i,n,o,a,l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AbstractLight=void 0;var u=s("cTTbu");s("yoicn");var h=s("bJEmL");e.exports.AbstractLight=class{constructor(e,t){r.set(this,h.instance.resolve(u.Converter)),i.set(this,h.instance.resolve(u.InputValidator)),n.set(this,void 0),o.set(this,h.instance.resolve(u.Logger)),a.set(this,void 0),l(this,n,e,"f"),l(this,a,t,"f"),c(this,o,"f").debugLow(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).constructor: Light api created.`)}get color(){return c(this,n,"f").color}set color(e){try{c(this,o,"f").debugLow(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).color: Updating Color to ${e}.`),c(this,i,"f").validateAndError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).color`,e,"color"),c(this,n,"f").color=c(this,r,"f").toColor(e),c(this,o,"f").debug(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).color: color was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).color`,e)}}get id(){return c(this,n,"f").id}get intensity(){return c(this,n,"f").intensity}set intensity(e){try{c(this,o,"f").debugLow(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).intensity: Updating Intensity to ${e}.`),c(this,i,"f").validateAndError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).intensity`,e,"positive"),c(this,n,"f").intensity=e,c(this,o,"f").debug(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).intensity: intensity was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).intensity`,e)}}get name(){return c(this,n,"f").name}set name(e){try{c(this,o,"f").debugLow(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).name: Updating Name to ${e}.`),c(this,i,"f").validateAndError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).name`,e,"string",!1),c(this,n,"f").name=e,c(this,o,"f").debug(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).name: name was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).name`,e)}}get order(){return c(this,n,"f").order}set order(e){try{c(this,o,"f").debugLow(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).order: Updating Order to ${e}.`),c(this,i,"f").validateAndError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).order`,e,"number",!1),c(this,n,"f").order=e,c(this,o,"f").debug(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).order: order was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).order`,e)}}get type(){return c(this,n,"f").type}},r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap})),s.register("lXtIC",(function(e,t){var r,i,n,o,a=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},l=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DirectionalLight=void 0;var c=s("cTTbu");s("yoicn");var u=s("bJEmL"),h=s("lDtT6");class d extends h.AbstractLight{constructor(e,t){super(e,t),r.set(this,u.instance.resolve(c.InputValidator)),i.set(this,void 0),n.set(this,u.instance.resolve(c.Logger)),o.set(this,void 0),a(this,i,e,"f"),a(this,o,t,"f")}get castShadow(){return l(this,i,"f").castShadow}set castShadow(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).castShadow: Updating CastShadow to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).castShadow`,e,"boolean"),l(this,i,"f").castShadow=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).castShadow: castShadow was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).castShadow`,e)}}get direction(){return l(this,i,"f").direction}set direction(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).direction: Updating Direction to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).direction`,e,"vec3"),l(this,i,"f").direction=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).direction: direction was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).direction`,e)}}get shadowMapBias(){return l(this,i,"f").shadowMapBias}set shadowMapBias(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapBias: Updating ShadowMapBias to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapBias`,e,"number"),l(this,i,"f").shadowMapBias=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapBias: shadowMapBias was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapBias`,e)}}get shadowMapResolution(){return l(this,i,"f").shadowMapResolution}set shadowMapResolution(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapResolution: Updating ShadowMapResolution to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapResolution`,e,"number"),l(this,i,"f").shadowMapResolution=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapResolution: shadowMapResolution was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).shadowMapResolution`,e)}}}e.exports.DirectionalLight=d,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap})),s.register("9Tlc8",(function(e,t){var r,i,n,o,a,l=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},c=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HemisphereLight=void 0;var u=s("cTTbu");s("yoicn");var h=s("bJEmL"),d=s("lDtT6");class f extends d.AbstractLight{constructor(e,t){super(e,t),r.set(this,h.instance.resolve(u.Converter)),i.set(this,h.instance.resolve(u.InputValidator)),n.set(this,void 0),o.set(this,h.instance.resolve(u.Logger)),a.set(this,void 0),l(this,n,e,"f"),l(this,a,t,"f")}get groundColor(){return c(this,n,"f").groundColor}set groundColor(e){try{c(this,o,"f").debugLow(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).groundColor: Updating GroundColor to ${e}.`),c(this,i,"f").validateAndError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).groundColor`,e,"color"),c(this,n,"f").groundColor=c(this,r,"f").toColor(e),c(this,o,"f").debug(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).groundColor: groundColor was set to: ${e}`),c(this,a,"f").update()}catch(e){if(e instanceof u.ShapeDiverViewerError||e instanceof u.ShapeDiverBackendError)throw e;throw c(this,o,"f").handleError(u.LOGGINGTOPIC.LIGHT,`Light(${this.id}).groundColor`,e)}}}e.exports.HemisphereLight=f,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap,a=new WeakMap})),s.register("4ADnQ",(function(e,t){var r,i,n,o,a=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},l=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PointLight=void 0;var c=s("cTTbu");s("yoicn");var u=s("bJEmL"),h=s("lDtT6");class d extends h.AbstractLight{constructor(e,t){super(e,t),r.set(this,u.instance.resolve(c.InputValidator)),i.set(this,void 0),n.set(this,u.instance.resolve(c.Logger)),o.set(this,void 0),a(this,i,e,"f"),a(this,o,t,"f")}get decay(){return l(this,i,"f").decay}set decay(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay: Updating Decay to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay`,e,"positive"),l(this,i,"f").decay=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay: decay was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay`,e)}}get distance(){return l(this,i,"f").distance}set distance(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance: Updating Distance to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance`,e,"positive"),l(this,i,"f").distance=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance: distance was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance`,e)}}get position(){return l(this,i,"f").position}set position(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position: Updating Position to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position`,e,"vec3"),l(this,i,"f").position=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position: position was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position`,e)}}}e.exports.PointLight=d,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap})),s.register("6BHFq",(function(e,t){var r,i,n,o,a=e.exports&&e.exports.__classPrivateFieldSet||function(e,t,r,i,n){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?n.call(e,r):n?n.value=r:t.set(e,r),r},l=e.exports&&e.exports.__classPrivateFieldGet||function(e,t,r,i){if("a"===r&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)};Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SpotLight=void 0;var c=s("cTTbu");s("yoicn");var u=s("bJEmL"),h=s("lDtT6");class d extends h.AbstractLight{constructor(e,t){super(e,t),r.set(this,u.instance.resolve(c.InputValidator)),i.set(this,void 0),n.set(this,u.instance.resolve(c.Logger)),o.set(this,void 0),a(this,i,e,"f"),a(this,o,t,"f")}get angle(){return l(this,i,"f").angle}set angle(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).angle: Updating Angle to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).angle`,e,"positive"),l(this,i,"f").angle=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).angle: angle was set to: ${e}`)}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).angle`,e)}}get decay(){return l(this,i,"f").decay}set decay(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay: Updating Decay to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay`,e,"positive"),l(this,i,"f").decay=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay: decay was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).decay`,e)}}get distance(){return l(this,i,"f").distance}set distance(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance: Updating Distance to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance`,e,"positive"),l(this,i,"f").distance=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance: distance was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).distance`,e)}}get penumbra(){return l(this,i,"f").penumbra}set penumbra(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).penumbra: Updating Penumbra to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).penumbra`,e,"positive"),l(this,i,"f").penumbra=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).penumbra: penumbra was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).penumbra`,e)}}get position(){return l(this,i,"f").position}set position(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position: Updating Position to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position`,e,"vec3"),l(this,i,"f").position=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position: position was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).position`,e)}}get target(){return l(this,i,"f").target}set target(e){try{l(this,n,"f").debugLow(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).target: Updating Target to ${e}.`),l(this,r,"f").validateAndError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).target`,e,"vec3"),l(this,i,"f").target=e,l(this,n,"f").debug(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).target: target was set to: ${e}`),l(this,o,"f").update()}catch(e){if(e instanceof c.ShapeDiverViewerError||e instanceof c.ShapeDiverBackendError)throw e;throw l(this,n,"f").handleError(c.LOGGINGTOPIC.LIGHT,`Light(${this.id}).target`,e)}}}e.exports.SpotLight=d,r=new WeakMap,i=new WeakMap,n=new WeakMap,o=new WeakMap})),s.register("fXOuZ",(function(e,r){t(e.exports,"initializeApp",(()=>s("7xvHX").initializeApp)),t(e.exports,"registerVersion",(()=>s("7xvHX").registerVersion));s("7xvHX");
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
s("7xvHX").registerVersion("firebase","9.6.11","app")})),s.register("7xvHX",(function(e,r){t(e.exports,"_registerComponent",(()=>g)),t(e.exports,"_getProvider",(()=>v)),t(e.exports,"SDK_VERSION",(()=>E)),t(e.exports,"initializeApp",(()=>w)),t(e.exports,"getApp",(()=>x)),t(e.exports,"registerVersion",(()=>A));var i=s("eryG9"),n=s("5Z2ef"),o=s("gMVVg");o=s("gMVVg");
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class a{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const l="@firebase/app",c="0.7.21",u=new n.Logger("@firebase/app"),h="[DEFAULT]",d={[l]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},f=new Map,p=new Map;function m(e,t){try{e.container.addComponent(t)}catch(r){u.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function g(e){const t=e.name;if(p.has(t))return u.debug(`There were multiple attempts to register component ${t}.`),!1;p.set(t,e);for(const t of f.values())m(t,e);return!0}function v(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const _={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},b=new o.ErrorFactory("app","Firebase",_);
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class y{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new i.Component("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw b.create("app-deleted",{appName:this._name})}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E="9.6.11";function w(e,t={}){if("object"!=typeof t){t={name:t}}const r=Object.assign({name:h,automaticDataCollectionEnabled:!1},t),n=r.name;if("string"!=typeof n||!n)throw b.create("bad-app-name",{appName:String(n)});const s=f.get(n);if(s){if(o.deepEqual(e,s.options)&&o.deepEqual(r,s.config))return s;throw b.create("duplicate-app",{appName:n})}const a=new i.ComponentContainer(n);for(const e of p.values())a.addComponent(e);const l=new y(e,r,a);return f.set(n,l),l}function x(e="[DEFAULT]"){const t=f.get(e);if(!t)throw b.create("no-app",{appName:e});return t}function A(e,t,r){var n;let s=null!==(n=d[e])&&void 0!==n?n:e;r&&(s+=`-${r}`);const o=s.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=[`Unable to register library "${s}" with version "${t}":`];return o&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void u.warn(e.join(" "))}g(new i.Component(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const T="firebase-heartbeat-store";let S=null;function M(){return S||(S=o.openDB("firebase-heartbeat-database",1,((e,t)=>{if(0===t)e.createObjectStore(T)})).catch((e=>{throw b.create("storage-open",{originalErrorMessage:e.message})}))),S}async function C(e,t){try{const r=(await M()).transaction(T,"readwrite"),i=r.objectStore(T);return await i.put(t,R(e)),r.complete}catch(e){throw b.create("storage-set",{originalErrorMessage:e.message})}}function R(e){return`${e.name}!${e.options.appId}`}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new P(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=O();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=O(),{heartbeatsToSend:t,unsentEntries:r}=function(e,t=1024){const r=[];let i=e.slice();for(const n of e){const e=r.find((e=>e.agent===n.agent));if(e){if(e.dates.push(n.date),k(r)>t){e.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),k(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=o.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function O(){return(new Date).toISOString().substring(0,10)}class P{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!o.isIndexedDBAvailable()&&o.validateIndexedDBOpenable().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{return(await M()).transaction(T).objectStore(T).get(R(e))}catch(e){throw b.create("storage-get",{originalErrorMessage:e.message})}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return C(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return C(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function k(e){return o.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var L;L="",g(new i.Component("platform-logger",(e=>new a(e)),"PRIVATE")),g(new i.Component("heartbeat",(e=>new I(e)),"PRIVATE")),A(l,c,L),A(l,c,"esm2017"),A("fire-js","")})),s.register("eryG9",(function(e,r){t(e.exports,"Component",(()=>n)),t(e.exports,"ComponentContainer",(()=>l));var i=s("gMVVg");class n{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o="[DEFAULT]";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new i.Deferred;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),i=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(e){if(i)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[e,t]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(e)&&t.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),n=null!==(r=this.onInitCallbacks.get(i))&&void 0!==r?r:new Set;n.add(e),this.onInitCallbacks.set(i,n);const s=this.instances.get(i);return s&&e(s,i),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=e,i===o?void 0:i),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch(e){}var i;return r||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:o:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class l{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}})),s.register("gMVVg",(function(e,r){t(e.exports,"assert",(()=>o)),t(e.exports,"assertionError",(()=>a)),t(e.exports,"base64",(()=>c)),t(e.exports,"base64Encode",(()=>u)),t(e.exports,"base64urlEncodeWithoutPadding",(()=>h)),t(e.exports,"deepCopy",(()=>f)),t(e.exports,"Deferred",(()=>m)),t(e.exports,"createMockUserToken",(()=>g)),t(e.exports,"isMobileCordova",(()=>_)),t(e.exports,"isReactNative",(()=>b)),t(e.exports,"isNodeSdk",(()=>y)),t(e.exports,"isIndexedDBAvailable",(()=>E)),t(e.exports,"validateIndexedDBOpenable",(()=>w)),t(e.exports,"ErrorFactory",(()=>A)),t(e.exports,"jsonEval",(()=>S)),t(e.exports,"stringify",(()=>M)),t(e.exports,"isValidFormat",(()=>R)),t(e.exports,"isAdmin",(()=>I)),t(e.exports,"contains",(()=>O)),t(e.exports,"safeGet",(()=>P)),t(e.exports,"isEmpty",(()=>k)),t(e.exports,"map",(()=>L)),t(e.exports,"deepEqual",(()=>N)),t(e.exports,"querystring",(()=>D)),t(e.exports,"Sha1",(()=>U)),t(e.exports,"errorPrefix",(()=>V)),t(e.exports,"stringToByteArray",(()=>B)),t(e.exports,"stringLength",(()=>F)),t(e.exports,"getModularInstance",(()=>j)),t(e.exports,"openDB",(()=>q));
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const i=!1,n=!1,s="${JSCORE_VERSION}",o=function(e,t){if(!e)throw a(t)},a=function(e){return new Error("Firebase Database ("+s+") INTERNAL ASSERT FAILED: "+e)},l=function(e){const t=[];let r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&i+1<e.length&&56320==(64512&e.charCodeAt(i+1))?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++i)),t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128)}return t},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){const n=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,c=n>>2,u=(3&n)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),i.push(r[c],r[u],r[h],r[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(l(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let r=0,i=0;for(;r<e.length;){const n=e[r++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){const s=e[r++];t[i++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){const s=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{const s=e[r++],o=e[r++];t[i++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){const n=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0;++t;const o=t<e.length?r[e.charAt(t)]:64;++t;const a=t<e.length?r[e.charAt(t)]:64;if(++t,null==n||null==s||null==o||null==a)throw Error();const l=n<<2|s>>4;if(i.push(l),64!==o){const e=s<<4&240|o>>2;if(i.push(e),64!==a){const e=o<<6&192|a;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},u=function(e){const t=l(e);return c.encodeByteArray(t,!0)},h=function(e){return u(e).replace(/\./g,"")},d=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function f(e){return p(void 0,e)}function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const r in t)t.hasOwnProperty(r)&&"__proto__"!==r&&(e[r]=p(e[r],t[r]));return e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,r))}}}
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",i=e.iat||0,n=e.sub||e.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},e);return[h(JSON.stringify({alg:"none",type:"JWT"})),h(JSON.stringify(s)),""].join(".")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(v())}function b(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function y(){return!0===i||!0===n}function E(){return"object"==typeof indexedDB}function w(){return new Promise(((e,t)=>{try{let r=!0;const i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var e;t((null===(e=n.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}class x extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,x.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,A.prototype.create)}}class A{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,n=this.errors[e],s=n?function(e,t){return e.replace(T,((e,r)=>{const i=t[r];return null!=i?String(i):`<${r}?>`}))}(n,r):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new x(i,o,r)}}const T=/\{\$([^}]+)}/g;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(e){return JSON.parse(e)}function M(e){return JSON.stringify(e)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C=function(e){let t={},r={},i={},n="";try{const s=e.split(".");t=S(d(s[0])||""),r=S(d(s[1])||""),n=s[2],i=r.d||{},delete r.d}catch(e){}return{header:t,claims:r,data:i,signature:n}},R=function(e){const t=C(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},I=function(e){const t=C(e).claims;return"object"==typeof t&&!0===t.admin};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function P(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function k(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function L(e,t,r){const i={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=t.call(r,e[n],n,e));return i}function N(e,t){if(e===t)return!0;const r=Object.keys(e),i=Object.keys(t);for(const n of r){if(!i.includes(n))return!1;const r=e[n],s=t[n];if(G(r)&&G(s)){if(!N(r,s))return!1}else if(r!==s)return!1}for(const e of i)if(!r.includes(e))return!1;return!0}function G(e){return null!==e&&"object"==typeof e}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D(e){const t=[];for(const[r,i]of Object.entries(e))Array.isArray(i)?i.forEach((e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(r)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class U{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if("string"==typeof e)for(let i=0;i<16;i++)r[i]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let i=0;i<16;i++)r[i]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=r[e-3]^r[e-8]^r[e-14]^r[e-16];r[e]=4294967295&(t<<1|t>>>31)}let i,n,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(i=l^o&(a^l),n=1518500249):(i=o^a^l,n=1859775393):e<60?(i=o&a|l&(o|a),n=2400959708):(i=o^a^l,n=3395469782);const t=(s<<5|s>>>27)+i+c+n+r[e]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const r=t-this.blockSize;let i=0;const n=this.buf_;let s=this.inbuf_;for(;i<t;){if(0===s)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(n[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(n),s=0;break}}else for(;i<t;)if(n[s]=e[i],++s,++i,s===this.blockSize){this.compress_(n),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let r=0;for(let t=0;t<5;t++)for(let i=24;i>=0;i-=8)e[r]=this.chain_[t]>>i&255,++r;return e}}function V(e,t){return`${e} failed: ${t} argument `}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const B=function(e){const t=[];let r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);if(n>=55296&&n<=56319){const t=n-55296;i++,o(i<e.length,"Surrogate pair missing trail surrogate.");n=65536+(t<<10)+(e.charCodeAt(i)-56320)}n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):n<65536?(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128)}return t},F=function(e){let t=0;for(let r=0;r<e.length;r++){const i=e.charCodeAt(r);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,r++):t+=3}return t};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function j(e){return e&&e._delegate?e._delegate:e}
/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z(e,t){return new Promise(((r,i)=>{e.onsuccess=e=>{r(e.target.result)},e.onerror=e=>{var r;i(`${t}: ${null===(r=e.target.error)||void 0===r?void 0:r.message}`)}}))}class W{constructor(e){this._db=e,this.objectStoreNames=this._db.objectStoreNames}transaction(e,t="readonly"){return new H(this._db.transaction.call(this._db,e,t))}createObjectStore(e,t){return new $(this._db.createObjectStore(e,t))}close(){this._db.close()}}class H{constructor(e){this._transaction=e,this.complete=new Promise(((e,t)=>{this._transaction.oncomplete=function(){e()},this._transaction.onerror=()=>{t(this._transaction.error)},this._transaction.onabort=()=>{t(this._transaction.error)}}))}objectStore(e){return new $(this._transaction.objectStore(e))}}class ${constructor(e){this._store=e}index(e){return new Y(this._store.index(e))}createIndex(e,t,r){return new Y(this._store.createIndex(e,t,r))}get(e){return z(this._store.get(e),"Error reading from IndexedDB")}put(e,t){return z(this._store.put(e,t),"Error writing to IndexedDB")}delete(e){return z(this._store.delete(e),"Error deleting from IndexedDB")}clear(){return z(this._store.clear(),"Error clearing IndexedDB object store")}}class Y{constructor(e){this._index=e}get(e){return z(this._index.get(e),"Error reading from IndexedDB")}}function q(e,t,r){return new Promise(((i,n)=>{try{const s=indexedDB.open(e,t);s.onsuccess=e=>{i(new W(e.target.result))},s.onerror=e=>{var t;n(`Error opening indexedDB: ${null===(t=e.target.error)||void 0===t?void 0:t.message}`)},s.onupgradeneeded=e=>{r(new W(s.result),e.oldVersion,e.newVersion,new H(s.transaction))}}catch(e){n(`Error opening indexedDB: ${e.message}`)}}))}})),s.register("5Z2ef",(function(e,r){t(e.exports,"LogLevel",(()=>n)),t(e.exports,"Logger",(()=>c)),t(e.exports,"setLogLevel",(()=>u)),t(e.exports,"setUserLogHandler",(()=>h));
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const i=[];var n;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(n||(n={}));const s={debug:n.DEBUG,verbose:n.VERBOSE,info:n.INFO,warn:n.WARN,error:n.ERROR,silent:n.SILENT},o=n.INFO,a={[n.DEBUG]:"log",[n.VERBOSE]:"log",[n.INFO]:"info",[n.WARN]:"warn",[n.ERROR]:"error"},l=(e,t,...r)=>{if(t<e.logLevel)return;const i=(new Date).toISOString(),n=a[t];if(!n)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[n](`[${i}]  ${e.name}:`,...r)};class c{constructor(e){this.name=e,this._logLevel=o,this._logHandler=l,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in n))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,n.DEBUG,...e),this._logHandler(this,n.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,n.VERBOSE,...e),this._logHandler(this,n.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,n.INFO,...e),this._logHandler(this,n.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,n.WARN,...e),this._logHandler(this,n.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,n.ERROR,...e),this._logHandler(this,n.ERROR,...e)}}function u(e){i.forEach((t=>{t.setLogLevel(e)}))}function h(e,t){for(const r of i){let i=null;t&&t.level&&(i=s[t.level]),r.userLogHandler=null===e?null:(t,r,...s)=>{const o=s.map((e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((e=>e)).join(" ");r>=(null!=i?i:t.logLevel)&&e({level:n[r].toLowerCase(),message:o,args:s,type:t.name})}}}})),s.register("8tedJ",(function(e,r){t(e.exports,"getDatabase",(()=>s("iJApx").getDatabase)),t(e.exports,"ref",(()=>s("iJApx").ref)),t(e.exports,"get",(()=>s("iJApx").get)),t(e.exports,"push",(()=>s("iJApx").push)),s("iJApx")})),s.register("iJApx",(function(e,r){t(e.exports,"get",(()=>sn)),t(e.exports,"ref",(()=>en)),t(e.exports,"push",(()=>rn)),t(e.exports,"getDatabase",(()=>un));var i=s("7xvHX"),n=s("eryG9"),o=s("gMVVg"),a=s("5Z2ef"),l=s("hPtJY");const c="@firebase/database",u="0.12.8";
/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h="";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class d{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),o.stringify(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:o.jsonEval(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return o.contains(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new d(t)}}catch(e){}return new f},m=p("localStorage"),g=p("sessionStorage"),v=new a.Logger("@firebase/database"),_=function(){let e=1;return function(){return e++}}(),b=function(e){const t=o.stringToByteArray(e),r=new o.Sha1;r.update(t);const i=r.digest();return o.base64.encodeByteArray(i)},y=function(...e){let t="";for(let r=0;r<e.length;r++){const i=e[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?t+=y.apply(null,i):t+="object"==typeof i?o.stringify(i):i,t+=" "}return t};let E=null,w=!0;const x=function(e,t){o.assert(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(v.logLevel=a.LogLevel.VERBOSE,E=v.log.bind(v),t&&g.set("logging_enabled",!0)):"function"==typeof e?E=e:(E=null,g.remove("logging_enabled"))},A=function(...e){if(!0===w&&(w=!1,null===E&&!0===g.get("logging_enabled")&&x(!0)),E){const t=y.apply(null,e);E(t)}},T=function(e){return function(...t){A(e,...t)}},S=function(...e){const t="FIREBASE INTERNAL ERROR: "+y(...e);v.error(t)},M=function(...e){const t=`FIREBASE FATAL ERROR: ${y(...e)}`;throw v.error(t),new Error(t)},C=function(...e){const t="FIREBASE WARNING: "+y(...e);v.warn(t)},R=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},I="[MIN_NAME]",O="[MAX_NAME]",P=function(e,t){if(e===t)return 0;if(e===I||t===O)return-1;if(t===I||e===O)return 1;{const r=j(e),i=j(t);return null!==r?null!==i?r-i==0?e.length-t.length:r-i:-1:null!==i?1:e<t?-1:1}},k=function(e,t){return e===t?0:e<t?-1:1},L=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+o.stringify(t))},N=function(e){if("object"!=typeof e||null===e)return o.stringify(e);const t=[];for(const r in e)t.push(r);t.sort();let r="{";for(let i=0;i<t.length;i++)0!==i&&(r+=","),r+=o.stringify(t[i]),r+=":",r+=N(e[t[i]]);return r+="}",r},G=function(e,t){const r=e.length;if(r<=t)return[e];const i=[];for(let n=0;n<r;n+=t)n+t>r?i.push(e.substring(n,r)):i.push(e.substring(n,n+t));return i};function D(e,t){for(const r in e)e.hasOwnProperty(r)&&t(r,e[r])}const U=function(e){o.assert(!R(e),"Invalid JSON number");const t=1023;let r,i,n,s,a;0===e?(i=0,n=0,r=1/e==-1/0?1:0):(r=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),i=s+t,n=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(i=0,n=Math.round(e/Math.pow(2,-1074))));const l=[];for(a=52;a;a-=1)l.push(n%2?1:0),n=Math.floor(n/2);for(a=11;a;a-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(r?1:0),l.reverse();const c=l.join("");let u="";for(a=0;a<64;a+=8){let e=parseInt(c.substr(a,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()};const V=new RegExp("^-?(0*)\\d{1,10}$"),B=-2147483648,F=2147483647,j=function(e){if(V.test(e)){const t=Number(e);if(t>=B&&t<=F)return t}return null},z=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw C("Exception was thrown by user callback.",t),e}),Math.floor(0))}},W=function(e,t){const r=setTimeout(e,t);return"object"==typeof r&&r.unref&&r.unref(),r};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class H{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,r)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,r):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){C(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(A("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,r)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,r):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(e)}}class Y{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Y.OWNER="owner";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const q="5",X=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Z="websocket",J="long_polling";
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class K{constructor(e,t,r,i,n=!1,s="",o=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=n,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=m.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&m.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function Q(e,t,r){let i;if(o.assert("string"==typeof t,"typeof type must == string"),o.assert("object"==typeof r,"typeof params must == object"),t===Z)i=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==J)throw new Error("Unknown connection type: "+t);i=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(r.ns=e.namespace);const n=[];return D(r,((e,t)=>{n.push(e+"="+t)})),i+n.join("&")}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(){this.counters_={}}incrementCounter(e,t=1){o.contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return o.deepCopy(this.counters_)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const te={},re={};function ie(e){const t=e.toString();return te[t]||(te[t]=new ee),te[t]}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ne{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&z((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se="start";class oe{constructor(e,t,r,i,n,s,o){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=n,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=T(e),this.stats_=ie(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),Q(t,J,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new ne(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(o.isNodeSdk()||"complete"===document.readyState)e();else{let t=!1;const r=function(){document.body?t||(t=!0,e()):setTimeout(r,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&r()})),window.attachEvent("onload",r))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new ae(((...e)=>{const[t,r,i,n,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===se)this.id=r,this.password=i;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);r?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(r,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,r]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,r)}),(()=>{this.onClosed_()}),this.urlFn);const e={start:"t"};e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=q,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&X.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){oe.forceAllow_=!0}static forceDisallow(){oe.forceDisallow_=!0}static isAvailable(){return!o.isNodeSdk()&&(!!oe.forceAllow_||!(oe.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=o.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=o.base64Encode(t),i=G(r,1840);for(let e=0;e<i.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(o.isNodeSdk())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=o.stringify(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class ae{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,o.isNodeSdk())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=_(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=ae.createIFrame_();let r="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){r='<script>document.domain="'+document.domain+'";<\/script>'}const i="<html><body>"+r+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(e){A("frame writing exception"),e.stack&&A(e.stack),A(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||A("No IE domain setting required")}catch(t){const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+r.length<=1870))break;{const e=this.pendingSegs.shift();r=r+"&seg"+i+"="+e.seg+"&ts"+i+"="+e.ts+"&d"+i+"="+e.d,i++}}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(i),r()}))}addTag(e,t){o.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{A("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch(e){}}),Math.floor(1))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let le=null;"undefined"!=typeof MozWebSocket?le=MozWebSocket:"undefined"!=typeof WebSocket&&(le=WebSocket);class ce{constructor(e,t,r,i,n,s,o){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=T(this.connId),this.stats_=ie(t),this.connURL=ce.connectionURL_(t,s,o,i),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,r,i){const n={};return n.v=q,!o.isNodeSdk()&&"undefined"!=typeof location&&location.hostname&&X.test(location.hostname)&&(n.r="f"),t&&(n.s=t),r&&(n.ls=r),i&&(n.ac=i),Q(e,Z,n)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,m.set("previous_websocket_failure",!0);try{if(o.isNodeSdk()){const e=this.nodeAdmin?"AdminNode":"Node",t={headers:{"User-Agent":`Firebase/5/${h}/${l.platform}/${e}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(t.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(t.headers["X-Firebase-AppCheck"]=this.appCheckToken);const r={},i=0===this.connURL.indexOf("wss://")?r.HTTPS_PROXY||r.https_proxy:r.HTTP_PROXY||r.http_proxy;i&&(t.proxy={origin:i}),this.mySock=new le(this.connURL,[],t)}else{const e={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new le(this.connURL,[],e)}}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){ce.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(t);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==le&&!ce.forceDisallow_}static previouslyFailed(){return m.isInMemoryStorage||!0===m.get("previous_websocket_failure")}markConnectionHealthy(){m.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=o.jsonEval(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(o.assert(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=o.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=G(t,16384);r.length>1&&this.sendString_(String(r.length));for(let e=0;e<r.length;e++)this.sendString_(r[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ce.responsesRequiredToBeHealthy=2,ce.healthyTimeout=3e4;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class ue{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[oe,ce]}initTransports_(e){const t=ce&&ce.isAvailable();let r=t&&!ce.previouslyFailed();if(e.webSocketOnly&&(t||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[ce];else{const e=this.transports_=[];for(const t of ue.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t)}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e,t,r,i,n,s,o,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=n,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=T("c:"+this.id+":"),this.transportManager_=new ue(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,r)}),Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=W((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=L("t",e),r=L("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=L("t",e),r=L("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=L("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?S("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),q!==r&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),W((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):W((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(m.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe{constructor(e){this.allowedEvents_=e,this.listeners_={},o.assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let e=0;e<r.length;e++)r[e].callback.apply(r[e].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let e=0;e<i.length;e++)if(i[e].callback===t&&(!r||r===i[e].context))return void i.splice(e,1)}validateEventType_(e){o.assert(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe extends fe{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||o.isMobileCordova()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new pe}getInitialEvent(e){return o.assert("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function ge(){return new me("")}function ve(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function _e(e){return e.pieces_.length-e.pieceNum_}function be(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new me(e.pieces_,t)}function ye(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Ee(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function we(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let r=e.pieceNum_;r<e.pieces_.length-1;r++)t.push(e.pieces_[r]);return new me(t,0)}function xe(e,t){const r=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)r.push(e.pieces_[t]);if(t instanceof me)for(let e=t.pieceNum_;e<t.pieces_.length;e++)r.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&r.push(e[t])}return new me(r,0)}function Ae(e){return e.pieceNum_>=e.pieces_.length}function Te(e,t){const r=ve(e),i=ve(t);if(null===r)return t;if(r===i)return Te(be(e),be(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Se(e,t){if(_e(e)!==_e(t))return!1;for(let r=e.pieceNum_,i=t.pieceNum_;r<=e.pieces_.length;r++,i++)if(e.pieces_[r]!==t.pieces_[i])return!1;return!0}function Me(e,t){let r=e.pieceNum_,i=t.pieceNum_;if(_e(e)>_e(t))return!1;for(;r<e.pieces_.length;){if(e.pieces_[r]!==t.pieces_[i])return!1;++r,++i}return!0}class Ce{constructor(e,t){this.errorPrefix_=t,this.parts_=Ee(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=o.stringLength(this.parts_[e]);Re(this)}}function Re(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Ie(e))}function Ie(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe extends fe{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Oe}getInitialEvent(e){return o.assert("visible"===e,"Unknown event type: "+e),[this.visible_]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe=1e3;class ke extends de{constructor(e,t,r,i,n,s,a,l){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=ke.nextPersistentConnectionId_++,this.log_=T("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Pe,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!o.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Oe.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&pe.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,r){const i=++this.requestNumber_,n={r:i,a:e,b:t};this.log_(o.stringify(n)),o.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(n),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const t=new o.Deferred,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:e=>{const i=e.d;"ok"===e.s?(this.onDataUpdate_(r.p,i,!1,null),t.resolve(i)):t.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const n=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const e=this.outstandingGets_[n];void 0!==e&&i===e&&(delete this.outstandingGets_[n],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+n+" timed out on connection"),t.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(n),t.promise}listen(e,t,r,i){this.initConnection_();const n=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+n),this.listens.has(s)||this.listens.set(s,new Map),o.assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),o.assert(!this.listens.get(s).has(n),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:t,query:e,tag:r};this.listens.get(s).set(n,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(r)}))}sendListen_(e){const t=e.query,r=t._path.toString(),i=t._queryIdentifier;this.log_("Listen on "+r+" for "+i);const n={p:r};e.tag&&(n.q=t._queryObject,n.t=e.tag),n.h=e.hashFn(),this.sendRequest("q",n,(n=>{const s=n.d,o=n.s;ke.warnOnListenWarnings_(s,t);(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",n),"ok"!==o&&this.removeListen_(r,i),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&o.contains(e,"w")){const r=o.safeGet(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',r=t._path.toString();C(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${r} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||o.isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=o.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(t,r,(t=>{const r=t.s,i=t.d||"error";this.authToken_===e&&("ok"===r?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(r,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,r=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,r)}))}unlisten(e,t){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),o.assert(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,t)}sendUnlisten_(e,t,r,i){this.log_("Unlisten on "+e+" for "+t);const n={p:e};i&&(n.q=r,n.t=i),this.sendRequest("n",n)}onDisconnectPut(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})}onDisconnectMerge(e,t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,r,i){const n={p:t,d:r};this.log_("onDisconnect "+e,n),this.sendRequest(e,n,(e=>{i&&setTimeout((()=>{i(e.s,e.d)}),Math.floor(0))}))}put(e,t,r,i){this.putInternal("p",e,t,r,i)}merge(e,t,r,i){this.putInternal("m",e,t,r,i)}putInternal(e,t,r,i,n){this.initConnection_();const s={p:t,d:r};void 0!==n&&(s.h=n),this.outstandingPuts_.push({action:e,request:s,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,r,(r=>{this.log_(t+" response",r),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(r.s,r.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+o.stringify(e));const t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):S("Unrecognized action received from server: "+o.stringify(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){o.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Pe),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+ke.nextConnectionId_++,n=this.lastSessionId;let s=!1,a=null;const l=function(){a?a.close():(s=!0,r())},c=function(e){o.assert(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(e)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[o,l]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);s?A("getToken() completed but was canceled"):(A("getToken() completed. Creating connection."),this.authToken_=o&&o.accessToken,this.appCheckToken_=l&&l.token,a=new he(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,r,(e=>{C(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),n))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&C(e),l())}}}interrupt(e){A("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){A("Resuming connection for reason: "+e),delete this.interruptReasons_[e],o.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=Pe,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let r;r=t?t.map((e=>N(e))).join("$"):"default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,t){const r=new me(e).toString();let i;if(this.listens.has(r)){const e=this.listens.get(r);i=e.get(t),e.delete(t),0===e.size&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,t){A("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){A("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";o.isNodeSdk()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+h.replace(/\./g,"-")]=1,o.isMobileCordova()?e["framework.cordova"]=1:o.isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=pe.getInstance().currentlyOnline();return o.isEmpty(this.interruptReasons_)&&e}}ke.nextPersistentConnectionId_=0,ke.nextConnectionId_=0;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Le{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Le(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Le(I,e),i=new Le(I,t);return 0!==this.compare(r,i)}minPost(){return Le.MIN}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ge;class De extends Ne{static get __EMPTY_NODE(){return Ge}static set __EMPTY_NODE(e){Ge=e}compare(e,t){return P(e.name,t.name)}isDefinedOn(e){throw o.assertionError("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Le.MIN}maxPost(){return new Le(O,Ge)}makePost(e,t){return o.assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new Le(e,Ge)}toString(){return".key"}}const Ue=new De;
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,t,r,i,n=null){this.isReverse_=i,this.resultGenerator_=n,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,i&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Be{constructor(e,t,r,i,n){this.key=e,this.value=t,this.color=null!=r?r:Be.RED,this.left=null!=i?i:Fe.EMPTY_NODE,this.right=null!=n?n:Fe.EMPTY_NODE}copy(e,t,r,i,n){return new Be(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=n?n:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const n=r(e,i.key);return i=n<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===n?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Fe.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let r,i;if(r=this,t(e,r.key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return Fe.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Be.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Be.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Be.RED=!0,Be.BLACK=!1;class Fe{constructor(e,t=Fe.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Fe(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Be.BLACK,null,null))}remove(e){return new Fe(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Be.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Ve(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Ve(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Ve(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Ve(this.root_,null,this.comparator_,!0,e)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function je(e,t){return P(e.name,t.name)}function ze(e,t){return P(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let We;Fe.EMPTY_NODE=new class{copy(e,t,r,i,n){return this}insert(e,t,r){return new Be(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const He=function(e){return"number"==typeof e?"number:"+U(e):"string:"+e},$e=function(e){if(e.isLeafNode()){const t=e.val();o.assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&o.contains(t,".sv"),"Priority must be a string or number.")}else o.assert(e===We||e.isEmpty(),"priority of unexpected type.");o.assert(e===We||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
let Ye,qe,Xe;class Ze{constructor(e,t=Ze.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,o.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),$e(this.priorityNode_)}static set __childrenNodeConstructor(e){Ye=e}static get __childrenNodeConstructor(){return Ye}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ze(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:Ze.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Ae(e)?this:".priority"===ve(e)?this.priorityNode_:Ze.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:Ze.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const r=ve(e);return null===r?t:t.isEmpty()&&".priority"!==r?this:(o.assert(".priority"!==r||1===_e(e),".priority must be the last token in a path"),this.updateImmediateChild(r,Ze.__childrenNodeConstructor.EMPTY_NODE.updateChild(be(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+He(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?U(this.value_):this.value_,this.lazyHash_=b(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ze.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ze.__childrenNodeConstructor?-1:(o.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,r=typeof this.value_,i=Ze.VALUE_TYPE_ORDER.indexOf(t),n=Ze.VALUE_TYPE_ORDER.indexOf(r);return o.assert(i>=0,"Unknown leaf type: "+t),o.assert(n>=0,"Unknown leaf type: "+r),i===n?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:n-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}Ze.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Je=new class extends Ne{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),n=r.compareTo(i);return 0===n?P(e.name,t.name):n}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Le.MIN}maxPost(){return new Le(O,new Ze("[PRIORITY-POST]",Xe))}makePost(e,t){const r=qe(e);return new Le(t,new Ze("[PRIORITY-POST]",r))}toString(){return".priority"}},Ke=Math.log(2);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/Ke,10)),this.current_=this.count-1;const r=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const et=function(e,t,r,i){e.sort(t);const n=function(t,i){const s=i-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=r?r(o):o,new Be(a,o.node,Be.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=n(t,l),u=n(l+1,i);return o=e[l],a=r?r(o):o,new Be(a,o.node,Be.BLACK,c,u)}},s=function(t){let i=null,s=null,o=e.length;const a=function(t,i){const s=o-t,a=o;o-=t;const c=n(s+1,a),u=e[s],h=r?r(u):u;l(new Be(h,u.node,i,null,c))},l=function(e){i?(i.left=e,i=e):(s=e,i=e)};for(let e=0;e<t.count;++e){const r=t.nextBitIsOne(),i=Math.pow(2,t.count-(e+1));r?a(i,Be.BLACK):(a(i,Be.BLACK),a(i,Be.RED))}return s}(new Qe(e.length));return new Fe(i||t,s)};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tt;const rt={};class it{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return o.assert(rt&&Je,"ChildrenNode.ts has not been loaded"),tt=tt||new it({".priority":rt},{".priority":Je}),tt}get(e){const t=o.safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Fe?t:null}hasIndex(e){return o.contains(this.indexSet_,e.toString())}addIndex(e,t){o.assert(e!==Ue,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const n=t.getIterator(Le.Wrap);let s,a=n.getNext();for(;a;)i=i||e.isDefinedOn(a.node),r.push(a),a=n.getNext();s=i?et(r,e.getCompare()):rt;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=s,new it(u,c)}addToIndexes(e,t){const r=o.map(this.indexes_,((r,i)=>{const n=o.safeGet(this.indexSet_,i);if(o.assert(n,"Missing index implementation for "+i),r===rt){if(n.isDefinedOn(e.node)){const r=[],i=t.getIterator(Le.Wrap);let s=i.getNext();for(;s;)s.name!==e.name&&r.push(s),s=i.getNext();return r.push(e),et(r,n.getCompare())}return rt}{const i=t.get(e.name);let n=r;return i&&(n=n.remove(new Le(e.name,i))),n.insert(e,e.node)}}));return new it(r,this.indexSet_)}removeFromIndexes(e,t){const r=o.map(this.indexes_,(r=>{if(r===rt)return r;{const i=t.get(e.name);return i?r.remove(new Le(e.name,i)):r}}));return new it(r,this.indexSet_)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nt;class st{constructor(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&$e(this.priorityNode_),this.children_.isEmpty()&&o.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return nt||(nt=new st(new Fe(ze),null,it.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||nt}updatePriority(e){return this.children_.isEmpty()?this:new st(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?nt:t}}getChild(e){const t=ve(e);return null===t?this:this.getImmediateChild(t).getChild(be(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(o.assert(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const r=new Le(e,t);let i,n;t.isEmpty()?(i=this.children_.remove(e),n=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,t),n=this.indexMap_.addToIndexes(r,this.children_));const s=i.isEmpty()?nt:this.priorityNode_;return new st(i,s,n)}}updateChild(e,t){const r=ve(e);if(null===r)return t;{o.assert(".priority"!==ve(e)||1===_e(e),".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(be(e),t);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let r=0,i=0,n=!0;if(this.forEachChild(Je,((s,o)=>{t[s]=o.val(e),r++,n&&st.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):n=!1})),!e&&n&&i<2*r){const e=[];for(const r in t)e[r]=t[r];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+He(this.getPriority().val())+":"),this.forEachChild(Je,((t,r)=>{const i=r.hash();""!==i&&(e+=":"+t+":"+i)})),this.lazyHash_=""===e?"":b(e)}return this.lazyHash_}getPredecessorChildName(e,t,r){const i=this.resolveIndex_(r);if(i){const r=i.getPredecessorKey(new Le(e,t));return r?r.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Le(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Le(t,this.children_.get(t)):null}forEachChild(e,t){const r=this.resolveIndex_(e);return r?r.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,(e=>e));{const r=this.children_.getIteratorFrom(e.name,Le.Wrap);let i=r.peek();for(;null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,(e=>e));{const r=this.children_.getReverseIteratorFrom(e.name,Le.Wrap);let i=r.peek();for(;null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===ot?-1:0}withIndex(e){if(e===Ue||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new st(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Ue||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(Je),r=t.getIterator(Je);let i=e.getNext(),n=r.getNext();for(;i&&n;){if(i.name!==n.name||!i.node.equals(n.node))return!1;i=e.getNext(),n=r.getNext()}return null===i&&null===n}return!1}return!1}}resolveIndex_(e){return e===Ue?null:this.indexMap_.get(e.toString())}}st.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const ot=new class extends st{constructor(){super(new Fe(ze),st.EMPTY_NODE,it.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return st.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Le,{MIN:{value:new Le(I,st.EMPTY_NODE)},MAX:{value:new Le(O,ot)}}),De.__EMPTY_NODE=st.EMPTY_NODE,Ze.__childrenNodeConstructor=st,We=ot,function(e){Xe=e}(ot);function at(e,t=null){if(null===e)return st.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),o.assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new Ze(e,at(t))}if(e instanceof Array){let r=st.EMPTY_NODE;return D(e,((t,i)=>{if(o.contains(e,t)&&"."!==t.substring(0,1)){const e=at(i);!e.isLeafNode()&&e.isEmpty()||(r=r.updateImmediateChild(t,e))}})),r.updatePriority(at(t))}{const r=[];let i=!1;if(D(e,((e,t)=>{if("."!==e.substring(0,1)){const n=at(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Le(e,n)))}})),0===r.length)return st.EMPTY_NODE;const n=et(r,je,(e=>e.name),ze);if(i){const e=et(r,Je.getCompare());return new st(n,at(t),new it({".priority":e},{".priority":Je}))}return new st(n,at(t),it.Default)}}!function(e){qe=e}(at);
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class lt extends Ne{constructor(e){super(),this.indexPath_=e,o.assert(!Ae(e)&&".priority"!==ve(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),n=r.compareTo(i);return 0===n?P(e.name,t.name):n}makePost(e,t){const r=at(e),i=st.EMPTY_NODE.updateChild(this.indexPath_,r);return new Le(t,i)}maxPost(){const e=st.EMPTY_NODE.updateChild(this.indexPath_,ot);return new Le(O,e)}toString(){return Ee(this.indexPath_,0).join("/")}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct=new class extends Ne{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?P(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Le.MIN}maxPost(){return Le.MAX}makePost(e,t){const r=at(e);return new Le(t,r)}toString(){return".value"}},ut="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ht=function(){let e=0;const t=[];return function(r){const i=r===e;let n;e=r;const s=new Array(8);for(n=7;n>=0;n--)s[n]=ut.charAt(r%64),r=Math.floor(r/64);o.assert(0===r,"Cannot push at time == 0");let a=s.join("");if(i){for(n=11;n>=0&&63===t[n];n--)t[n]=0;t[n]++}else for(n=0;n<12;n++)t[n]=Math.floor(64*Math.random());for(n=0;n<12;n++)a+=ut.charAt(t[n]);return o.assert(20===a.length,"nextPushId: Length should be 20."),a}}();
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
function dt(e){return{type:"value",snapshotNode:e}}function ft(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function pt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function mt(e,t,r){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:r}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class gt{constructor(e){this.index_=e}updateChild(e,t,r,i,n,s){o.assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()?e:(null!=s&&(r.isEmpty()?e.hasChild(t)?s.trackChildChange(pt(t,a)):o.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?s.trackChildChange(ft(t,r)):s.trackChildChange(mt(t,r,a))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Je,((e,i)=>{t.hasChild(e)||r.trackChildChange(pt(e,i))})),t.isLeafNode()||t.forEachChild(Je,((t,i)=>{if(e.hasChild(t)){const n=e.getImmediateChild(t);n.equals(i)||r.trackChildChange(mt(t,i,n))}else r.trackChildChange(ft(t,i))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?st.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.indexedFilter_=new gt(e.getIndex()),this.index_=e.getIndex(),this.startPost_=vt.getStartPost_(e),this.endPost_=vt.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,n,s){return this.matches(new Le(t,r))||(r=st.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,n,s)}updateFullNode(e,t,r){t.isLeafNode()&&(t=st.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(st.EMPTY_NODE);const n=this;return t.forEachChild(Je,((e,t)=>{n.matches(new Le(e,t))||(i=i.updateImmediateChild(e,st.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _t{constructor(e){this.rangedFilter_=new vt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,n,s){return this.rangedFilter_.matches(new Le(t,r))||(r=st.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,n,s):this.fullLimitUpdateChild_(e,t,r,n,s)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=st.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;i=st.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let r=0;for(;e.hasNext()&&r<this.limit_;){const t=e.getNext();let n;if(n=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),t)<=0:this.index_.compare(t,this.rangedFilter_.getEndPost())<=0,!n)break;i=i.updateImmediateChild(t.name,t.node),r++}}else{let e,r,n,s;if(i=t.withIndex(this.index_),i=i.updatePriority(st.EMPTY_NODE),this.reverse_){s=i.getReverseIterator(this.index_),e=this.rangedFilter_.getEndPost(),r=this.rangedFilter_.getStartPost();const t=this.index_.getCompare();n=(e,r)=>t(r,e)}else s=i.getIterator(this.index_),e=this.rangedFilter_.getStartPost(),r=this.rangedFilter_.getEndPost(),n=this.index_.getCompare();let o=0,a=!1;for(;s.hasNext();){const t=s.getNext();!a&&n(e,t)<=0&&(a=!0);a&&o<this.limit_&&n(t,r)<=0?o++:i=i.updateImmediateChild(t.name,st.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,n){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,r)=>e(r,t)}else s=this.index_.getCompare();const a=e;o.assert(a.numChildren()===this.limit_,"");const l=new Le(t,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(t)){const e=a.getImmediateChild(t);let o=i.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=o&&(o.name===t||a.hasChild(o.name));)o=i.getChildAfterChild(this.index_,o,this.reverse_);const h=null==o?1:s(o,l);if(u&&!r.isEmpty()&&h>=0)return null!=n&&n.trackChildChange(mt(t,r,e)),a.updateImmediateChild(t,r);{null!=n&&n.trackChildChange(pt(t,e));const r=a.updateImmediateChild(t,st.EMPTY_NODE);return null!=o&&this.rangedFilter_.matches(o)?(null!=n&&n.trackChildChange(ft(o.name,o.node)),r.updateImmediateChild(o.name,o.node)):r}}return r.isEmpty()?e:u&&s(c,l)>=0?(null!=n&&(n.trackChildChange(pt(c.name,c.node)),n.trackChildChange(ft(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(c.name,st.EMPTY_NODE)):e}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bt{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Je}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return o.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return o.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:I}hasEnd(){return this.endSet_}getIndexEndValue(){return o.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return o.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:O}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return o.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Je}copy(){const e=new bt;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function yt(e){const t={};if(e.isDefault())return t;let r;return e.index_===Je?r="$priority":e.index_===ct?r="$value":e.index_===Ue?r="$key":(o.assert(e.index_ instanceof lt,"Unrecognized index type!"),r=e.index_.toString()),t.orderBy=o.stringify(r),e.startSet_&&(t.startAt=o.stringify(e.indexStartValue_),e.startNameSet_&&(t.startAt+=","+o.stringify(e.indexStartName_))),e.endSet_&&(t.endAt=o.stringify(e.indexEndValue_),e.endNameSet_&&(t.endAt+=","+o.stringify(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Et(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;let r=e.viewFrom_;""===r&&(r=e.isViewFromLeft()?"l":"r"),t.vf=r}return e.index_!==Je&&(t.i=e.index_.toString()),t}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt extends de{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=T("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(o.assert(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const n=e._path.toString();this.log_("Listen called for "+n+" "+e._queryIdentifier);const s=wt.getListenId_(e,r),a={};this.listens_[s]=a;const l=yt(e._queryParams);this.restRequest_(n+".json",l,((e,t)=>{let l=t;if(404===e&&(l=null,e=null),null===e&&this.onDataUpdate_(n,l,!1,r),o.safeGet(this.listens_,s)===a){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",i(t,null)}}))}unlisten(e,t){const r=wt.getListenId_(e,t);delete this.listens_[r]}get(e){const t=yt(e._queryParams),r=e._path.toString(),i=new o.Deferred;return this.restRequest_(r+".json",t,((e,t)=>{let n=t;404===e&&(n=null,e=null),null===e?(this.onDataUpdate_(r,n,!1,null),i.resolve(n)):i.reject(new Error(n))})),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,n])=>{i&&i.accessToken&&(t.auth=i.accessToken),n&&n.token&&(t.ac=n.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+o.querystring(t);this.log_("Sending REST request for "+s);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=o.jsonEval(a.responseText)}catch(e){C("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,e)}else 401!==a.status&&404!==a.status&&C("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(){this.rootNode_=st.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(){return{value:null,children:new Map}}function Tt(e,t,r){if(Ae(t))e.value=r,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,r);else{const i=ve(t);e.children.has(i)||e.children.set(i,At());Tt(e.children.get(i),t=be(t),r)}}function St(e,t,r){null!==e.value?r(t,e.value):function(e,t){e.children.forEach(((e,r)=>{t(r,e)}))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,((e,i)=>{St(i,new me(t.toString()+"/"+e),r)}))}class Mt{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&D(this.last_,((e,r)=>{t[e]=t[e]-r})),this.last_=e,t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ct{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Mt(e);const r=1e4+2e4*Math.random();W(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;D(e,((e,i)=>{i>0&&o.contains(this.statsToReport_,e)&&(t[e]=i,r=!0)})),r&&this.server_.reportStats(t),W(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,It;function Ot(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(It=Rt||(Rt={}))[It.OVERWRITE=0]="OVERWRITE",It[It.MERGE=1]="MERGE",It[It.ACK_USER_WRITE=2]="ACK_USER_WRITE",It[It.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class Pt{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Rt.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Ae(this.path)){if(null!=this.affectedTree.value)return o.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new me(e));return new Pt(ge(),t,this.revert)}}return o.assert(ve(this.path)===e,"operationForChild called for unrelated child."),new Pt(be(this.path),this.affectedTree,this.revert)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class kt{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Rt.OVERWRITE}operationForChild(e){return Ae(this.path)?new kt(this.source,ge(),this.snap.getImmediateChild(e)):new kt(this.source,be(this.path),this.snap)}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lt{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Rt.MERGE}operationForChild(e){if(Ae(this.path)){const t=this.children.subtree(new me(e));return t.isEmpty()?null:t.value?new kt(this.source,ge(),t.value):new Lt(this.source,ge(),t)}return o.assert(ve(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Lt(this.source,be(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ae(e))return this.isFullyInitialized()&&!this.filtered_;const t=ve(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Dt(e,t,r,i,n,s){const a=i.filter((e=>e.type===r));a.sort(((t,r)=>function(e,t,r){if(null==t.childName||null==r.childName)throw o.assertionError("Should only compare child_ events.");const i=new Le(t.childName,t.snapshotNode),n=new Le(r.childName,r.snapshotNode);return e.index_.compare(i,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,r))),a.forEach((r=>{const i=function(e,t,r){return"value"===t.type||"child_removed"===t.type||(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,r,s);n.forEach((n=>{n.respondsTo(r.type)&&t.push(n.createEvent(i,e.query_))}))}))}function Ut(e,t){return{eventCache:e,serverCache:t}}function Vt(e,t,r,i){return Ut(new Nt(t,r,i),e.serverCache)}function Bt(e,t,r,i){return Ut(e.eventCache,new Nt(t,r,i))}function Ft(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function jt(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zt;class Wt{constructor(e,t=(()=>(zt||(zt=new Fe(k)),zt))()){this.value=e,this.children=t}static fromObject(e){let t=new Wt(null);return D(e,((e,r)=>{t=t.set(new me(e),r)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:ge(),value:this.value};if(Ae(e))return null;{const r=ve(e),i=this.children.get(r);if(null!==i){const n=i.findRootMostMatchingPathAndValue(be(e),t);if(null!=n){return{path:xe(new me(r),n.path),value:n.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Ae(e))return this;{const t=ve(e),r=this.children.get(t);return null!==r?r.subtree(be(e)):new Wt(null)}}set(e,t){if(Ae(e))return new Wt(t,this.children);{const r=ve(e),i=(this.children.get(r)||new Wt(null)).set(be(e),t),n=this.children.insert(r,i);return new Wt(this.value,n)}}remove(e){if(Ae(e))return this.children.isEmpty()?new Wt(null):new Wt(null,this.children);{const t=ve(e),r=this.children.get(t);if(r){const i=r.remove(be(e));let n;return n=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&n.isEmpty()?new Wt(null):new Wt(this.value,n)}return this}}get(e){if(Ae(e))return this.value;{const t=ve(e),r=this.children.get(t);return r?r.get(be(e)):null}}setTree(e,t){if(Ae(e))return t;{const r=ve(e),i=(this.children.get(r)||new Wt(null)).setTree(be(e),t);let n;return n=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new Wt(this.value,n)}}fold(e){return this.fold_(ge(),e)}fold_(e,t){const r={};return this.children.inorderTraversal(((i,n)=>{r[i]=n.fold_(xe(e,i),t)})),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,ge(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(Ae(e))return null;{const i=ve(e),n=this.children.get(i);return n?n.findOnPath_(be(e),xe(t,i),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ge(),t)}foreachOnPath_(e,t,r){if(Ae(e))return this;{this.value&&r(t,this.value);const i=ve(e),n=this.children.get(i);return n?n.foreachOnPath_(be(e),xe(t,i),r):new Wt(null)}}foreach(e){this.foreach_(ge(),e)}foreach_(e,t){this.children.inorderTraversal(((r,i)=>{i.foreach_(xe(e,r),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,r)=>{r.value&&e(t,r.value)}))}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.writeTree_=e}static empty(){return new Ht(new Wt(null))}}function $t(e,t,r){if(Ae(t))return new Ht(new Wt(r));{const i=e.writeTree_.findRootMostValueAndPath(t);if(null!=i){const n=i.path;let s=i.value;const o=Te(n,t);return s=s.updateChild(o,r),new Ht(e.writeTree_.set(n,s))}{const i=new Wt(r),n=e.writeTree_.setTree(t,i);return new Ht(n)}}}function Yt(e,t,r){let i=e;return D(r,((e,r)=>{i=$t(i,xe(t,e),r)})),i}function qt(e,t){if(Ae(t))return Ht.empty();{const r=e.writeTree_.setTree(t,new Wt(null));return new Ht(r)}}function Xt(e,t){return null!=Zt(e,t)}function Zt(e,t){const r=e.writeTree_.findRootMostValueAndPath(t);return null!=r?e.writeTree_.get(r.path).getChild(Te(r.path,t)):null}function Jt(e){const t=[],r=e.writeTree_.value;return null!=r?r.isLeafNode()||r.forEachChild(Je,((e,r)=>{t.push(new Le(e,r))})):e.writeTree_.children.inorderTraversal(((e,r)=>{null!=r.value&&t.push(new Le(e,r.value))})),t}function Kt(e,t){if(Ae(t))return e;{const r=Zt(e,t);return new Ht(null!=r?new Wt(r):e.writeTree_.subtree(t))}}function Qt(e){return e.writeTree_.isEmpty()}function er(e,t){return tr(ge(),e.writeTree_,t)}function tr(e,t,r){if(null!=t.value)return r.updateChild(e,t.value);{let i=null;return t.children.inorderTraversal(((t,n)=>{".priority"===t?(o.assert(null!==n.value,"Priority writes must always be leaf nodes"),i=n.value):r=tr(xe(e,t),n,r)})),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(xe(e,".priority"),i)),r}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(e,t){return mr(t,e)}function ir(e,t){const r=e.allWrites.findIndex((e=>e.writeId===t));o.assert(r>=0,"removeWrite called with nonexistent writeId.");const i=e.allWrites[r];e.allWrites.splice(r,1);let n=i.visible,s=!1,a=e.allWrites.length-1;for(;n&&a>=0;){const t=e.allWrites[a];t.visible&&(a>=r&&nr(t,i.path)?n=!1:Me(i.path,t.path)&&(s=!0)),a--}if(n){if(s)return function(e){e.visibleWrites=or(e.allWrites,sr,ge()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(i.snap)e.visibleWrites=qt(e.visibleWrites,i.path);else{D(i.children,(t=>{e.visibleWrites=qt(e.visibleWrites,xe(i.path,t))}))}return!0}return!1}function nr(e,t){if(e.snap)return Me(e.path,t);for(const r in e.children)if(e.children.hasOwnProperty(r)&&Me(xe(e.path,r),t))return!0;return!1}function sr(e){return e.visible}function or(e,t,r){let i=Ht.empty();for(let n=0;n<e.length;++n){const s=e[n];if(t(s)){const e=s.path;let t;if(s.snap)Me(r,e)?(t=Te(r,e),i=$t(i,t,s.snap)):Me(e,r)&&(t=Te(e,r),i=$t(i,ge(),s.snap.getChild(t)));else{if(!s.children)throw o.assertionError("WriteRecord should have .snap or .children");if(Me(r,e))t=Te(r,e),i=Yt(i,t,s.children);else if(Me(e,r))if(t=Te(e,r),Ae(t))i=Yt(i,ge(),s.children);else{const e=o.safeGet(s.children,ve(t));if(e){const r=e.getChild(be(t));i=$t(i,ge(),r)}}}}}return i}function ar(e,t,r,i,n){if(i||n){const s=Kt(e.visibleWrites,t);if(!n&&Qt(s))return r;if(n||null!=r||Xt(s,ge())){const s=function(e){return(e.visible||n)&&(!i||!~i.indexOf(e.writeId))&&(Me(e.path,t)||Me(t,e.path))};return er(or(e.allWrites,s,t),r||st.EMPTY_NODE)}return null}{const i=Zt(e.visibleWrites,t);if(null!=i)return i;{const i=Kt(e.visibleWrites,t);if(Qt(i))return r;if(null!=r||Xt(i,ge())){return er(i,r||st.EMPTY_NODE)}return null}}}function lr(e,t,r,i){return ar(e.writeTree,e.treePath,t,r,i)}function cr(e,t){return function(e,t,r){let i=st.EMPTY_NODE;const n=Zt(e.visibleWrites,t);if(n)return n.isLeafNode()||n.forEachChild(Je,((e,t)=>{i=i.updateImmediateChild(e,t)})),i;if(r){const n=Kt(e.visibleWrites,t);return r.forEachChild(Je,((e,t)=>{const r=er(Kt(n,new me(e)),t);i=i.updateImmediateChild(e,r)})),Jt(n).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}return Jt(Kt(e.visibleWrites,t)).forEach((e=>{i=i.updateImmediateChild(e.name,e.node)})),i}(e.writeTree,e.treePath,t)}function ur(e,t,r,i){return function(e,t,r,i,n){o.assert(i||n,"Either existingEventSnap or existingServerSnap must exist");const s=xe(t,r);if(Xt(e.visibleWrites,s))return null;{const t=Kt(e.visibleWrites,s);return Qt(t)?n.getChild(r):er(t,n.getChild(r))}}(e.writeTree,e.treePath,t,r,i)}function hr(e,t){return function(e,t){return Zt(e.visibleWrites,t)}(e.writeTree,xe(e.treePath,t))}function dr(e,t,r,i,n,s){return function(e,t,r,i,n,s,o){let a;const l=Kt(e.visibleWrites,t),c=Zt(l,ge());if(null!=c)a=c;else{if(null==r)return[];a=er(l,r)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),r=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let l=r.getNext();for(;l&&e.length<n;)0!==t(l,i)&&e.push(l),l=r.getNext();return e}}(e.writeTree,e.treePath,t,r,i,n,s)}function fr(e,t,r){return function(e,t,r,i){const n=xe(t,r),s=Zt(e.visibleWrites,n);if(null!=s)return s;if(i.isCompleteForChild(r))return er(Kt(e.visibleWrites,n),i.getNode().getImmediateChild(r));return null}(e.writeTree,e.treePath,t,r)}function pr(e,t){return mr(xe(e.treePath,t),e.writeTree)}function mr(e,t){return{treePath:e,writeTree:t}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;o.assert("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),o.assert(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const n=i.type;if("child_added"===t&&"child_removed"===n)this.changeMap.set(r,mt(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===n)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===n)this.changeMap.set(r,pt(r,i.oldSnap));else if("child_changed"===t&&"child_added"===n)this.changeMap.set(r,ft(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==n)throw o.assertionError("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,mt(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vr=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class _r{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Nt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return fr(this.writes_,e,t)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:jt(this.viewCache_),n=dr(this.writes_,i,t,1,r,e);return 0===n.length?null:n[0]}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(e,t,r,i,n){const s=new gr;let a,l;if(r.type===Rt.OVERWRITE){const c=r;c.source.fromUser?a=wr(e,t,c.path,c.snap,i,n,s):(o.assert(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered()&&!Ae(c.path),a=Er(e,t,c.path,c.snap,i,n,l,s))}else if(r.type===Rt.MERGE){const c=r;c.source.fromUser?a=function(e,t,r,i,n,s,o){let a=t;return i.foreach(((i,l)=>{const c=xe(r,i);xr(t,ve(c))&&(a=wr(e,a,c,l,n,s,o))})),i.foreach(((i,l)=>{const c=xe(r,i);xr(t,ve(c))||(a=wr(e,a,c,l,n,s,o))})),a}(e,t,c.path,c.children,i,n,s):(o.assert(c.source.fromServer,"Unknown source."),l=c.source.tagged||t.serverCache.isFiltered(),a=Tr(e,t,c.path,c.children,i,n,l,s))}else if(r.type===Rt.ACK_USER_WRITE){const l=r;a=l.revert?function(e,t,r,i,n,s){let a;if(null!=hr(i,r))return t;{const l=new _r(i,t,n),c=t.eventCache.getNode();let u;if(Ae(r)||".priority"===ve(r)){let r;if(t.serverCache.isFullyInitialized())r=lr(i,jt(t));else{const e=t.serverCache.getNode();o.assert(e instanceof st,"serverChildren would be complete if leaf node"),r=cr(i,e)}u=e.filter.updateFullNode(c,r,s)}else{const n=ve(r);let o=fr(i,n,t.serverCache);null==o&&t.serverCache.isCompleteForChild(n)&&(o=c.getImmediateChild(n)),u=null!=o?e.filter.updateChild(c,n,o,be(r),l,s):t.eventCache.getNode().hasChild(n)?e.filter.updateChild(c,n,st.EMPTY_NODE,be(r),l,s):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(a=lr(i,jt(t)),a.isLeafNode()&&(u=e.filter.updateFullNode(u,a,s)))}return a=t.serverCache.isFullyInitialized()||null!=hr(i,ge()),Vt(t,u,a,e.filter.filtersNodes())}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e,t,l.path,i,n,s):function(e,t,r,i,n,s,o){if(null!=hr(n,r))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=i.value){if(Ae(r)&&l.isFullyInitialized()||l.isCompleteForPath(r))return Er(e,t,r,l.getNode().getChild(r),n,s,a,o);if(Ae(r)){let i=new Wt(null);return l.getNode().forEachChild(Ue,((e,t)=>{i=i.set(new me(e),t)})),Tr(e,t,r,i,n,s,a,o)}return t}{let c=new Wt(null);return i.foreach(((e,t)=>{const i=xe(r,e);l.isCompleteForPath(i)&&(c=c.set(e,l.getNode().getChild(i)))})),Tr(e,t,r,c,n,s,a,o)}}(e,t,l.path,l.affectedTree,i,n,s)}else{if(r.type!==Rt.LISTEN_COMPLETE)throw o.assertionError("Unknown operation type: "+r.type);a=function(e,t,r,i,n){const s=t.serverCache,o=Bt(t,s.getNode(),s.isFullyInitialized()||Ae(r),s.isFiltered());return yr(e,o,r,i,vr,n)}(e,t,r.path,i,s)}const c=s.getChanges();return function(e,t,r){const i=t.eventCache;if(i.isFullyInitialized()){const n=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Ft(e);(r.length>0||!e.eventCache.isFullyInitialized()||n&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&r.push(dt(Ft(t)))}}(t,a,c),{viewCache:a,changes:c}}function yr(e,t,r,i,n,s){const a=t.eventCache;if(null!=hr(i,r))return t;{let l,c;if(Ae(r))if(o.assert(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const r=jt(t),n=cr(i,r instanceof st?r:st.EMPTY_NODE);l=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const r=lr(i,jt(t));l=e.filter.updateFullNode(t.eventCache.getNode(),r,s)}else{const u=ve(r);if(".priority"===u){o.assert(1===_e(r),"Can't have a priority with additional path components");const n=a.getNode();c=t.serverCache.getNode();const s=ur(i,r,n,c);l=null!=s?e.filter.updatePriority(n,s):a.getNode()}else{const o=be(r);let h;if(a.isCompleteForChild(u)){c=t.serverCache.getNode();const e=ur(i,r,a.getNode(),c);h=null!=e?a.getNode().getImmediateChild(u).updateChild(o,e):a.getNode().getImmediateChild(u)}else h=fr(i,u,t.serverCache);l=null!=h?e.filter.updateChild(a.getNode(),u,h,o,n,s):a.getNode()}}return Vt(t,l,a.isFullyInitialized()||Ae(r),e.filter.filtersNodes())}}function Er(e,t,r,i,n,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(Ae(r))c=u.updateFullNode(l.getNode(),i,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(r,i);c=u.updateFullNode(l.getNode(),e,null)}else{const e=ve(r);if(!l.isCompleteForPath(r)&&_e(r)>1)return t;const n=be(r),s=l.getNode().getImmediateChild(e).updateChild(n,i);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,n,vr,null)}const h=Bt(t,c,l.isFullyInitialized()||Ae(r),u.filtersNodes());return yr(e,h,r,n,new _r(n,h,s),a)}function wr(e,t,r,i,n,s,o){const a=t.eventCache;let l,c;const u=new _r(n,t,s);if(Ae(r))c=e.filter.updateFullNode(t.eventCache.getNode(),i,o),l=Vt(t,c,!0,e.filter.filtersNodes());else{const n=ve(r);if(".priority"===n)c=e.filter.updatePriority(t.eventCache.getNode(),i),l=Vt(t,c,a.isFullyInitialized(),a.isFiltered());else{const s=be(r),c=a.getNode().getImmediateChild(n);let h;if(Ae(s))h=i;else{const e=u.getCompleteChild(n);h=null!=e?".priority"===ye(s)&&e.getChild(we(s)).isEmpty()?e:e.updateChild(s,i):st.EMPTY_NODE}if(c.equals(h))l=t;else{l=Vt(t,e.filter.updateChild(a.getNode(),n,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function xr(e,t){return e.eventCache.isCompleteForChild(t)}function Ar(e,t,r){return r.foreach(((e,r)=>{t=t.updateChild(e,r)})),t}function Tr(e,t,r,i,n,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=Ae(r)?i:new Wt(null).setTree(r,i);const u=t.serverCache.getNode();return l.children.inorderTraversal(((r,i)=>{if(u.hasChild(r)){const l=Ar(0,t.serverCache.getNode().getImmediateChild(r),i);c=Er(e,c,new me(r),l,n,s,o,a)}})),l.children.inorderTraversal(((r,i)=>{const l=!t.serverCache.isCompleteForChild(r)&&void 0===i.value;if(!u.hasChild(r)&&!l){const l=Ar(0,t.serverCache.getNode().getImmediateChild(r),i);c=Er(e,c,new me(r),l,n,s,o,a)}})),c}class Sr{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new gt(r.getIndex()),n=(s=r).loadsAllData()?new gt(s.getIndex()):s.hasLimit()?new _t(s):new vt(s);var s;this.processor_=function(e){return{filter:e}}(n);const o=t.serverCache,a=t.eventCache,l=i.updateFullNode(st.EMPTY_NODE,o.getNode(),null),c=n.updateFullNode(st.EMPTY_NODE,a.getNode(),null),u=new Nt(l,o.isFullyInitialized(),i.filtersNodes()),h=new Nt(c,a.isFullyInitialized(),n.filtersNodes());this.viewCache_=Ut(h,u),this.eventGenerator_=new Gt(this.query_)}get query(){return this.query_}}function Mr(e,t){const r=jt(e.viewCache_);return r&&(e.query._queryParams.loadsAllData()||!Ae(t)&&!r.getImmediateChild(ve(t)).isEmpty())?r.getChild(t):null}function Cr(e,t,r,i){t.type===Rt.MERGE&&null!==t.source.queryId&&(o.assert(jt(e.viewCache_),"We should always have a full cache before handling merges"),o.assert(Ft(e.viewCache_),"Missing event cache, even though we have a server cache"));const n=e.viewCache_,s=br(e.processor_,n,t,r,i);var a,l;return a=e.processor_,l=s.viewCache,o.assert(l.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),o.assert(l.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),o.assert(s.viewCache.serverCache.isFullyInitialized()||!n.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,Rr(e,s.changes,s.viewCache.eventCache.getNode(),null)}function Rr(e,t,r,i){const n=i?[i]:e.eventRegistrations_;return function(e,t,r,i){const n=[],s=[];return t.forEach((t=>{var r;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((r=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:r}))})),Dt(e,n,"child_removed",t,i,r),Dt(e,n,"child_added",t,i,r),Dt(e,n,"child_moved",s,i,r),Dt(e,n,"child_changed",t,i,r),Dt(e,n,"value",t,i,r),n}(e.eventGenerator_,t,r,n)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ir,Or;class Pr{constructor(){this.views=new Map}}function kr(e,t,r,i){const n=t.source.queryId;if(null!==n){const s=e.views.get(n);return o.assert(null!=s,"SyncTree gave us an op for an invalid query."),Cr(s,t,r,i)}{let n=[];for(const s of e.views.values())n=n.concat(Cr(s,t,r,i));return n}}function Lr(e,t,r,i,n){const s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=lr(r,n?i:null),s=!1;e?s=!0:i instanceof st?(e=cr(r,i),s=!1):(e=st.EMPTY_NODE,s=!1);const o=Ut(new Nt(e,s,!1),new Nt(i,n,!1));return new Sr(t,o)}return o}function Nr(e,t){let r=null;for(const i of e.views.values())r=r||Mr(i,t);return r}class Gr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Wt(null),this.pendingWriteTree_={visibleWrites:Ht.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Dr(e,t,r,i,n){return function(e,t,r,i,n){o.assert(i>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===n&&(n=!0),e.allWrites.push({path:t,snap:r,writeId:i,visible:n}),n&&(e.visibleWrites=$t(e.visibleWrites,t,r)),e.lastWriteId=i}(e.pendingWriteTree_,t,r,i,n),n?jr(e,new kt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,r)):[]}function Ur(e,t,r=!1){const i=function(e,t){for(let r=0;r<e.allWrites.length;r++){const i=e.allWrites[r];if(i.writeId===t)return i}return null}(e.pendingWriteTree_,t);if(ir(e.pendingWriteTree_,t)){let t=new Wt(null);return null!=i.snap?t=t.set(ge(),!0):D(i.children,(e=>{t=t.set(new me(e),!0)})),jr(e,new Pt(i.path,t,r))}return[]}function Vr(e,t,r){return jr(e,new kt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}function Br(e,t,r){const i=e.pendingWriteTree_,n=e.syncPointTree_.findOnPath(t,((e,r)=>{const i=Nr(r,Te(e,t));if(i)return i}));return ar(i,t,n,r,!0)}function Fr(e,t){const r=t._path;let i=null;e.syncPointTree_.foreachOnPath(r,((e,t)=>{const n=Te(e,r);i=i||Nr(t,n)}));let n=e.syncPointTree_.get(r);n?i=i||Nr(n,ge()):(n=new Pr,e.syncPointTree_=e.syncPointTree_.set(r,n));const s=null!=i,o=s?new Nt(i,!0,!1):null;return function(e){return Ft(e.viewCache_)}(Lr(n,t,rr(e.pendingWriteTree_,t._path),s?o.getNode():st.EMPTY_NODE,s))}function jr(e,t){return zr(t,e.syncPointTree_,null,rr(e.pendingWriteTree_,ge()))}function zr(e,t,r,i){if(Ae(e.path))return Wr(e,t,r,i);{const n=t.get(ge());null==r&&null!=n&&(r=Nr(n,ge()));let s=[];const o=ve(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=r?r.getImmediateChild(o):null,t=pr(i,o);s=s.concat(zr(a,l,e,t))}return n&&(s=s.concat(kr(n,e,i,r))),s}}function Wr(e,t,r,i){const n=t.get(ge());null==r&&null!=n&&(r=Nr(n,ge()));let s=[];return t.children.inorderTraversal(((t,n)=>{const o=r?r.getImmediateChild(t):null,a=pr(i,t),l=e.operationForChild(t);l&&(s=s.concat(Wr(l,n,o,a)))})),n&&(s=s.concat(kr(n,e,i,r))),s}function Hr(e,t){return e.tagToQueryMap.get(t)}function $r(e){const t=e.indexOf("$");return o.assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new me(e.substr(0,t))}}function Yr(e,t,r){const i=e.syncPointTree_.get(t);o.assert(i,"Missing sync point for query tag that we're tracking");return kr(i,r,rr(e.pendingWriteTree_,t),null)}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class qr{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new qr(t)}node(){return this.node_}}class Xr{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=xe(this.path_,e);return new Xr(this.syncTree_,t)}node(){return Br(this.syncTree_,this.path_)}}const Zr=function(e,t,r){return e&&"object"==typeof e?(o.assert(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Jr(e[".sv"],t,r):"object"==typeof e[".sv"]?Kr(e[".sv"],t):void o.assert(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Jr=function(e,t,r){if("timestamp"===e)return r.timestamp;o.assert(!1,"Unexpected server value: "+e)},Kr=function(e,t,r){e.hasOwnProperty("increment")||o.assert(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const i=e.increment;"number"!=typeof i&&o.assert(!1,"Unexpected increment value: "+i);const n=t.node();if(o.assert(null!=n,"Expected ChildrenNode.EMPTY_NODE for nulls"),!n.isLeafNode())return i;const s=n.getValue();return"number"!=typeof s?i:s+i},Qr=function(e,t,r,i){return ti(t,new Xr(r,e),i)},ei=function(e,t,r){return ti(e,new qr(t),r)};function ti(e,t,r){const i=e.getPriority().val(),n=Zr(i,t.getImmediateChild(".priority"),r);let s;if(e.isLeafNode()){const i=e,s=Zr(i.getValue(),t,r);return s!==i.getValue()||n!==i.getPriority().val()?new Ze(s,at(n)):e}{const i=e;return s=i,n!==i.getPriority().val()&&(s=s.updatePriority(new Ze(n))),i.forEachChild(Je,((e,i)=>{const n=ti(i,t.getImmediateChild(e),r);n!==i&&(s=s.updateImmediateChild(e,n))})),s}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function ii(e,t){let r=t instanceof me?t:new me(t),i=e,n=ve(r);for(;null!==n;){const e=o.safeGet(i.node.children,n)||{children:{},childCount:0};i=new ri(n,i,e),r=be(r),n=ve(r)}return i}function ni(e){return e.node.value}function si(e,t){e.node.value=t,ui(e)}function oi(e){return e.node.childCount>0}function ai(e,t){D(e.node.children,((r,i)=>{t(new ri(r,e,i))}))}function li(e,t,r,i){r&&!i&&t(e),ai(e,(e=>{li(e,t,!0,i)})),r&&i&&t(e)}function ci(e){return new me(null===e.parent?e.name:ci(e.parent)+"/"+e.name)}function ui(e){null!==e.parent&&function(e,t,r){const i=function(e){return void 0===ni(e)&&!oi(e)}(r),n=o.contains(e.node.children,t);i&&n?(delete e.node.children[t],e.node.childCount--,ui(e)):i||n||(e.node.children[t]=r.node,e.node.childCount++,ui(e))}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(e.parent,e.name,e)}const hi=/[\[\].#$\/\u0000-\u001F\u007F]/,di=/[\[\].#$\u0000-\u001F\u007F]/,fi=10485760,pi=function(e){return"string"==typeof e&&0!==e.length&&!hi.test(e)},mi=function(e){return"string"==typeof e&&0!==e.length&&!di.test(e)},gi=function(e,t,r,i){i&&void 0===t||vi(o.errorPrefix(e,"value"),t,r)},vi=function(e,t,r){const i=r instanceof me?new Ce(r,e):r;if(void 0===t)throw new Error(e+"contains undefined "+Ie(i));if("function"==typeof t)throw new Error(e+"contains a function "+Ie(i)+" with contents = "+t.toString());if(R(t))throw new Error(e+"contains "+t.toString()+" "+Ie(i));if("string"==typeof t&&t.length>3495253.3333333335&&o.stringLength(t)>fi)throw new Error(e+"contains a string greater than "+"10485760 utf8 bytes "+Ie(i)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let r=!1,n=!1;if(D(t,((t,s)=>{if(".value"===t)r=!0;else if(".priority"!==t&&".sv"!==t&&(n=!0,!pi(t)))throw new Error(e+" contains an invalid key ("+t+") "+Ie(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=o.stringLength(t),Re(e)}(i,t),vi(e,s,i),function(e){const t=e.parts_.pop();e.byteLength_-=o.stringLength(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),r&&n)throw new Error(e+' contains ".value" child '+Ie(i)+" in addition to actual children.")}},_i=function(e,t,r,i){if(!(i&&void 0===r||mi(r)))throw new Error(o.errorPrefix(e,t)+'was an invalid path = "'+r+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},bi=function(e,t){if(".info"===ve(t))throw new Error(e+" failed = Can't modify data under /.info/")},yi=function(e,t){const r=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!pi(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==r.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),mi(e)}(r))throw new Error(o.errorPrefix(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ei{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function wi(e,t){let r=null;for(let i=0;i<t.length;i++){const n=t[i],s=n.getPath();null===r||Se(s,r.path)||(e.eventLists_.push(r),r=null),null===r&&(r={events:[],path:s}),r.events.push(n)}r&&e.eventLists_.push(r)}function xi(e,t,r){wi(e,r),Ti(e,(e=>Se(e,t)))}function Ai(e,t,r){wi(e,r),Ti(e,(e=>Me(e,t)||Me(t,e)))}function Ti(e,t){e.recursionDepth_++;let r=!0;for(let i=0;i<e.eventLists_.length;i++){const n=e.eventLists_[i];if(n){t(n.path)?(Si(e.eventLists_[i]),e.eventLists_[i]=null):r=!1}}r&&(e.eventLists_=[]),e.recursionDepth_--}function Si(e){for(let t=0;t<e.events.length;t++){const r=e.events[t];if(null!==r){e.events[t]=null;const i=r.getEventRunner();E&&A("event: "+r.toString()),z(i)}}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi="repo_interrupt";class Ci{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ei,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=At(),this.transactionQueueTree_=new ri,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Ri(e,t,r){if(e.stats_=ie(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new wt(e.repoInfo_,((t,r,i,n)=>{Pi(e,t,r,i,n)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>ki(e,!0)),0);else{if(null!=r){if("object"!=typeof r)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{o.stringify(r)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new ke(e.repoInfo_,t,((t,r,i,n)=>{Pi(e,t,r,i,n)}),(t=>{ki(e,t)}),(t=>{!function(e,t){D(t,((t,r)=>{Li(e,t,r)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,r),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const r=e.toString();return re[r]||(re[r]=t()),re[r]}(e.repoInfo_,(()=>new Ct(e.stats_,e.server_))),e.infoData_=new xt,e.infoSyncTree_=new Gr({startListening:(t,r,i,n)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Vr(e.infoSyncTree_,t._path,o),setTimeout((()=>{n("ok")}),0)),s},stopListening:()=>{}}),Li(e,"connected",!1),e.serverSyncTree_=new Gr({startListening:(t,r,i,n)=>(e.server_.listen(t,i,r,((r,i)=>{const s=n(r,i);Ai(e.eventQueue_,t._path,s)})),[]),stopListening:(t,r)=>{e.server_.unlisten(t,r)}})}function Ii(e){const t=e.infoData_.getNode(new me(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Oi(e){return(t=(t={timestamp:Ii(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function Pi(e,t,r,i,n){e.dataUpdateCount++;const s=new me(t);r=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,r):r;let a=[];if(n)if(i){const t=o.map(r,(e=>at(e)));a=function(e,t,r,i){const n=Hr(e,i);if(n){const i=$r(n),s=i.path,o=i.queryId,a=Te(s,t),l=Wt.fromObject(r);return Yr(e,s,new Lt(Ot(o),a,l))}return[]}(e.serverSyncTree_,s,t,n)}else{const t=at(r);a=function(e,t,r,i){const n=Hr(e,i);if(null!=n){const i=$r(n),s=i.path,o=i.queryId,a=Te(s,t);return Yr(e,s,new kt(Ot(o),a,r))}return[]}(e.serverSyncTree_,s,t,n)}else if(i){const t=o.map(r,(e=>at(e)));a=function(e,t,r){const i=Wt.fromObject(r);return jr(e,new Lt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,i))}(e.serverSyncTree_,s,t)}else{const t=at(r);a=Vr(e.serverSyncTree_,s,t)}let l=s;a.length>0&&(l=ji(e,s)),Ai(e.eventQueue_,l,a)}function ki(e,t){Li(e,"connected",t),!1===t&&function(e){Ui(e,"onDisconnectEvents");const t=Oi(e),r=At();St(e.onDisconnect_,ge(),((i,n)=>{const s=Qr(i,n,e.serverSyncTree_,t);Tt(r,i,s)}));let i=[];St(r,ge(),((t,r)=>{i=i.concat(Vr(e.serverSyncTree_,t,r));const n=Yi(e,t);ji(e,n)})),e.onDisconnect_=At(),Ai(e.eventQueue_,ge(),i)}(e)}function Li(e,t,r){const i=new me("/.info/"+t),n=at(r);e.infoData_.updateSnapshot(i,n);const s=Vr(e.infoSyncTree_,i,n);Ai(e.eventQueue_,i,s)}function Ni(e){return e.nextWriteId_++}function Gi(e,t,r,i,n){Ui(e,"set",{path:t.toString(),value:r,priority:i});const s=Oi(e),o=at(r,i),a=Br(e.serverSyncTree_,t),l=ei(o,a,s),c=Ni(e),u=Dr(e.serverSyncTree_,t,l,c,!0);wi(e.eventQueue_,u),e.server_.put(t.toString(),o.val(!0),((r,i)=>{const s="ok"===r;s||C("set at "+t+" failed: "+r);const o=Ur(e.serverSyncTree_,c,!s);Ai(e.eventQueue_,t,o),Vi(e,n,r,i)}));const h=Yi(e,t);ji(e,h),Ai(e.eventQueue_,h,[])}function Di(e){e.persistentConnection_&&e.persistentConnection_.interrupt(Mi)}function Ui(e,...t){let r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),A(r,...t)}function Vi(e,t,r,i){t&&z((()=>{if("ok"===r)t(null);else{const e=(r||"error").toUpperCase();let n=e;i&&(n+=": "+i);const s=new Error(n);s.code=e,t(s)}}))}function Bi(e,t,r){return Br(e.serverSyncTree_,t,r)||st.EMPTY_NODE}function Fi(e,t=e.transactionQueueTree_){if(t||$i(e,t),ni(t)){const r=Wi(e,t);o.assert(r.length>0,"Sending zero length transaction queue");r.every((e=>0===e.status))&&function(e,t,r){const i=r.map((e=>e.currentWriteId)),n=Bi(e,t,i);let s=n;const a=n.hash();for(let e=0;e<r.length;e++){const i=r[e];o.assert(0===i.status,"tryToSendTransactionQueue_: items in queue should all be run."),i.status=1,i.retryCount++;const n=Te(t,i.path);s=s.updateChild(n,i.currentOutputSnapshotRaw)}const l=s.val(!0),c=t;e.server_.put(c.toString(),l,(i=>{Ui(e,"transaction put response",{path:c.toString(),status:i});let n=[];if("ok"===i){const i=[];for(let t=0;t<r.length;t++)r[t].status=2,n=n.concat(Ur(e.serverSyncTree_,r[t].currentWriteId)),r[t].onComplete&&i.push((()=>r[t].onComplete(null,!0,r[t].currentOutputSnapshotResolved))),r[t].unwatcher();$i(e,ii(e.transactionQueueTree_,t)),Fi(e,e.transactionQueueTree_),Ai(e.eventQueue_,t,n);for(let e=0;e<i.length;e++)z(i[e])}else{if("datastale"===i)for(let e=0;e<r.length;e++)3===r[e].status?r[e].status=4:r[e].status=0;else{C("transaction at "+c.toString()+" failed: "+i);for(let e=0;e<r.length;e++)r[e].status=4,r[e].abortReason=i}ji(e,t)}}),a)}(e,ci(t),r)}else oi(t)&&ai(t,(t=>{Fi(e,t)}))}function ji(e,t){const r=zi(e,t),i=ci(r);return function(e,t,r){if(0===t.length)return;const i=[];let n=[];const s=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let l=0;l<t.length;l++){const c=t[l],u=Te(r,c.path);let h,d=!1;if(o.assert(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)d=!0,h=c.abortReason,n=n.concat(Ur(e.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=25)d=!0,h="maxretry",n=n.concat(Ur(e.serverSyncTree_,c.currentWriteId,!0));else{const r=Bi(e,c.path,s);c.currentInputSnapshot=r;const i=t[l].update(r.val());if(void 0!==i){vi("transaction failed: Data returned ",i,c.path);let t=at(i);"object"==typeof i&&null!=i&&o.contains(i,".priority")||(t=t.updatePriority(r.getPriority()));const a=c.currentWriteId,l=Oi(e),u=ei(t,r,l);c.currentOutputSnapshotRaw=t,c.currentOutputSnapshotResolved=u,c.currentWriteId=Ni(e),s.splice(s.indexOf(a),1),n=n.concat(Dr(e.serverSyncTree_,c.path,u,c.currentWriteId,c.applyLocally)),n=n.concat(Ur(e.serverSyncTree_,a,!0))}else d=!0,h="nodata",n=n.concat(Ur(e.serverSyncTree_,c.currentWriteId,!0))}Ai(e.eventQueue_,r,n),n=[],d&&(t[l].status=2,a=t[l].unwatcher,setTimeout(a,Math.floor(0)),t[l].onComplete&&("nodata"===h?i.push((()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot))):i.push((()=>t[l].onComplete(new Error(h),!1,null)))))}var a;$i(e,e.transactionQueueTree_);for(let e=0;e<i.length;e++)z(i[e]);Fi(e,e.transactionQueueTree_)}(e,Wi(e,r),i),i}function zi(e,t){let r,i=e.transactionQueueTree_;for(r=ve(t);null!==r&&void 0===ni(i);)i=ii(i,r),r=ve(t=be(t));return i}function Wi(e,t){const r=[];return Hi(e,t,r),r.sort(((e,t)=>e.order-t.order)),r}function Hi(e,t,r){const i=ni(t);if(i)for(let e=0;e<i.length;e++)r.push(i[e]);ai(t,(t=>{Hi(e,t,r)}))}function $i(e,t){const r=ni(t);if(r){let e=0;for(let t=0;t<r.length;t++)2!==r[t].status&&(r[e]=r[t],e++);r.length=e,si(t,r.length>0?r:void 0)}ai(t,(t=>{$i(e,t)}))}function Yi(e,t){const r=ci(zi(e,t)),i=ii(e.transactionQueueTree_,t);return function(e,t,r){let i=r?e:e.parent;for(;null!==i;){if(t(i))return!0;i=i.parent}}(i,(t=>{qi(e,t)})),qi(e,i),li(i,(t=>{qi(e,t)})),r}function qi(e,t){const r=ni(t);if(r){const i=[];let n=[],s=-1;for(let t=0;t<r.length;t++)3===r[t].status||(1===r[t].status?(o.assert(s===t-1,"All SENT items should be at beginning of queue."),s=t,r[t].status=3,r[t].abortReason="set"):(o.assert(0===r[t].status,"Unexpected transaction status in abort"),r[t].unwatcher(),n=n.concat(Ur(e.serverSyncTree_,r[t].currentWriteId,!0)),r[t].onComplete&&i.push(r[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?si(t,void 0):r.length=s+1,Ai(e.eventQueue_,ci(t),n);for(let e=0;e<i.length;e++)z(i[e])}}
/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi=function(e,t){const r=Zi(e),i=r.namespace;"firebase.com"===r.domain&&M(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===r.domain||M("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const n="ws"===r.scheme||"wss"===r.scheme;return{repoInfo:new K(r.host,r.secure,i,n,t,"",i!==r.subdomain),path:new me(r.pathString)}},Zi=function(e){let t="",r="",i="",n="",s="",o=!0,a="https",l=443;if("string"==typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(n=function(e){let t="";const r=e.split("/");for(let e=0;e<r.length;e++)if(r[e].length>0){let i=r[e];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const r of e.split("&")){if(0===r.length)continue;const i=r.split("=");2===i.length?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):C(`Invalid query segment '${r}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())r="localhost";else if(f.split(".").length<=2)r=f;else{const e=t.indexOf(".");i=t.substring(0,e).toLowerCase(),r=t.substring(e+1),s=i}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:r,subdomain:i,secure:o,scheme:a,pathString:n,namespace:s}};
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
class Ji{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Ae(this._path)?null:ye(this._path)}get ref(){return new Ki(this._repo,this._path)}get _queryIdentifier(){const e=Et(this._queryParams),t=N(e);return"{}"===t?"default":t}get _queryObject(){return Et(this._queryParams)}isEqual(e){if(!((e=o.getModularInstance(e))instanceof Ji))return!1;const t=this._repo===e._repo,r=Se(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let r=e.pieceNum_;r<e.pieces_.length;r++)""!==e.pieces_[r]&&(t+="/"+encodeURIComponent(String(e.pieces_[r])));return t||"/"}(this._path)}}class Ki extends Ji{constructor(e,t){super(e,t,new bt,!1)}get parent(){const e=we(this._path);return null===e?null:new Ki(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Qi{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new me(e),r=tn(this.ref,e);return new Qi(this._node.getChild(t),r,Je)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,r)=>e(new Qi(r,tn(this.ref,t),Je))))}hasChild(e){const t=new me(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function en(e,t){return(e=o.getModularInstance(e))._checkNotDeleted("ref"),void 0!==t?tn(e._root,t):e._root}function tn(e,t){var r,i,n,s;return null===ve((e=o.getModularInstance(e))._path)?(r="child",i="path",s=!1,(n=t)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),_i(r,i,n,s)):_i("child","path",t,!1),new Ki(e._repo,xe(e._path,t))}function rn(e,t){e=o.getModularInstance(e),bi("push",e._path),gi("push",t,e._path,!0);const r=Ii(e._repo),i=ht(r),n=tn(e,i),s=tn(e,i);let a;return a=null!=t?nn(s,t).then((()=>s)):Promise.resolve(s),n.then=a.then.bind(a),n.catch=a.then.bind(a,void 0),n}function nn(e,t){e=o.getModularInstance(e),bi("set",e._path),gi("set",t,e._path,!1);const r=new o.Deferred;return Gi(e._repo,e._path,t,null,r.wrapCallback((()=>{}))),r.promise}function sn(e){return function(e,t){const r=Fr(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=at(r).withIndex(t._queryParams.getIndex()),n=Vr(e.serverSyncTree_,t._path,i);return xi(e.eventQueue_,t._path,n),Promise.resolve(i)}),(r=>(Ui(e,"get for query "+o.stringify(t)+" failed: "+r),Promise.reject(new Error(r)))))}((e=o.getModularInstance(e))._repo,e).then((t=>new Qi(t,new Ki(e._repo,e._path),e._queryParams.getIndex())))}!function(e){o.assert(!Ir,"__referenceConstructor has already been defined"),Ir=e}(Ki),function(e){o.assert(!Or,"__referenceConstructor has already been defined"),Or=e}(Ki);
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
const on={};let an=!1;function ln(e,t,r,i,n){let s=i||e.options.databaseURL;void 0===s&&(e.options.projectId||M("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),A("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=Xi(s,n),u=c.repoInfo;void 0!==l&&l.env&&(a=l.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${u.namespace}`,c=Xi(s,n),u=c.repoInfo):o=!c.repoInfo.secure;const h=n&&o?new Y(Y.OWNER):new $(e.name,e.options,t);yi("Invalid Firebase Database URL",c),Ae(c.path)||M("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function(e,t,r,i){let n=on[t.name];n||(n={},on[t.name]=n);let s=n[e.toURLString()];s&&M("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new Ci(e,an,r,i),n[e.toURLString()]=s,s}(u,e,h,new H(e.name,r));return new cn(d,e)}class cn{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Ri(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ki(this._repo,ge())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const r=on[t];r&&r[e.key]===e||M(`Database ${t}(${e.repoInfo_}) has already been deleted.`),Di(e),delete r[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&M("Cannot call "+e+" on a deleted database.")}}function un(e=i.getApp(),t){return i._getProvider(e,"database").getImmediate({identifier:t})}ke.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},ke.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};
/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
var hn,dn;
/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dn=i.SDK_VERSION,h=dn,i._registerComponent(new n.Component("database",((e,{instanceIdentifier:t})=>ln(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),i.registerVersion(c,u,hn),i.registerVersion(c,u,"esm2017")}));
//# sourceMappingURL=index.8f670cb1.js.map
